/*! For license information please see 4a57aefef51a7a50883b.chunk.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[102,2,16,25,30,87,117,154,165,170,174],Array(443).concat([function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(2),s=n(4),a=n(513),r=n(153),l=n(84),c=n(26),d=Promise.all([n.e(19),n.e(0),n.e(1),n.e(2),n.e(121)]).then(n.t.bind(null,1750,7)).then((function(e){t=e.default})),u=s.Application.extend({region:"body",onStart:function(e,n){n=n||{},o("html").on("click",(function(e){c.getDGlobalChannel().trigger(c.EVENT.HTML_CLICK,e)})),d.then(i.bind((function(){var e=t.buildDBandJoinQnARoomLayoutView(n.bandNo,n.memberKey,n.memberAlready);this.showView(e)}),this))}});u.buildJoinQnAApp=function(){return new u};var h=function(e,t,n){a.openGet({windowURL:n.makeUrl({band_no:e,member_key:t}),windowName:"BAND_APPLICANT_QNA_"+t,width:400,height:644,resizable:1,centerBrowser:!0})};return u.openJoinQnAApp=function(e,t){h(e,t,r.GROUP_BAND_APPLICANT_JOIN_QNA)},u.openJoinQnAAppByUrl=function(e){var t=l.extractPageRouteData(r.GROUP_BAND_APPLICANT_JOIN_QNA,e).pathVariables||{};u.openJoinQnAApp(t.band_no,t.member_key)},u.openBandMemberJoinTimeQnAApp=function(e,t){h(e,t,r.GROUP_BAND_MEMBER_JOIN_QNA)},u}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(26),o=n(55);return new(t.Object.extend({initialize:function(){o.get$Window().resize((function(e){i.getDGlobalChannel().trigger(i.EVENT.WINDOW_RESIZE,e)}))},onDestroy:function(){o.get$Window().off("resize")}}))}.call(t,n,t,e))||(e.exports=i)},,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(210),a=n(13),r=n(53),l=n(572),c=n(26),d=n(2148),u=n(178),h=n(186),p=n(9),m=n(84),_=n(1610),g=n(486),f=n(170),b=n(1144),v=n(1611),A=n(933),E=n(155),T=n(1997),C=n(44),y=n(157),M=n(153),I=n(162),S=n(544),w=n(83),N=n(541),D=n(553),L=n(1109),O=n(57);n(1612),n(2149);var P=/[\?&]_escaped_fragment_=([^&]*)/g,x=function(){return Promise.all([n.e(12),n.e(131)]).then(n.t.bind(null,2946,7))},R=function(){return n.e(179).then(n.t.bind(null,2976,7))},k=function(){return Promise.all([n.e(14),n.e(120)]).then(n.t.bind(null,2977,7))},B=o.Application.extend({region:{el:"._bodyRegion",replaceElement:!0},initialize:function(){var e=i.bind(this._handleWindowFocusEvent,this);this._$body=t("body"),h.setLanguage(p.getLang()),t("html").on("click",(function(e){c.getDGlobalChannel().trigger(c.EVENT.HTML_CLICK,e)})),t(window).on("focus",e),this.listenTo(c.getDGlobalChannel(),c.EVENT.LIVE_VIEWER_OPENED,(function(){t(window).off("focus",e)})),this.listenTo(c.getDGlobalChannel(),c.EVENT.LIVE_VIEWER_CLOSED,(function(){t(window).on("focus",e)})),T.screenModeAddClass(T.getScreenMode())},onStart:function(e,n){var o=location.href;if(o.indexOf("#!")>0)return u.sendReferrerLog(),void location.replace(o.replace(/\/?#!\/?/gi,"/"));var s=P.exec(o);null!=s&&null!=s[1]?this._seoUri=s[1]:this._seoUri=null,this._initialBandNo=n.bandNo,a.ready().done(i.bind((function(){this._pageRouter=V(),t(document).on("contextmenu","._prevent_context",(function(){return!1})),t(document).on("dragstart","._prevent_context",(function(){return!1})),m.setPageRouter(this._pageRouter),d.bindAnchorTagClick(),this.listenTo(this._pageRouter,"route",this._onRoute),this.listenTo(c.getDGlobalChannel(),c.EVENT.REFRESH_CURRENT_ROUTE_INFO,(function(){var e=r.getCurrentRouteInfo();this._onRoute(e.routeInfo,e.pathVariables,e.params)})),u.sendReferrerLog(),_.startRouter(this._seoUri,this._initialBandNo,this._pageRouter)}),this))},onDestroy:function(){this._$body.off()},_onRoute:function(e,n,o){if(a.isLogedIn()||e!==y.GLOBAL_HOME){e===y.SHORTCUT&&(n.band_no=this._initialBandNo);var s=n.band_no;r.setCurrentRouteInfo(e,n,o),this._clearPageLayoutContent(),g.isStarted()&&g.closeAll(),c.getDGlobalChannel().trigger(c.EVENT.ROUTE_CHANGE),s&&(this._isCurrentBandDataExpired(e)||E.get(s).isForVirtualMember())&&E.get(s).resetBandDataState(),t.when(v.doRouteChangeAction(),s?E.get(s).loadBandData(e.extractVirtualMemberTokenParams(n),o.token).then((function(){var n=E.get(s),i=t.Deferred().resolve().promise();return n.isAccessAvailableState()&&!e.isLfgBandRoutingAreaRouteInfo()&&(i=A.fetchQuotaStatus(n)),i.then((function(){return n}))})):null).then(i.bind((function(t,i){e===y.SHORTCUT&&(e=i&&i.isGoingToPageBand()?I.PAGE_BAND_HOME:M.GROUP_BAND_HOME,r.replaceCurrentRouteInfo(e,n,o)),this._validateAccess(e,n,o,i)&&(r.triggerRouteInfoChangedEvent(),this._renderView(e,n,o,i))}),this))}else location.replace("/home")},_validateWrongRequest:function(e,t,n,o){if(this._isPageChanged(t))return!1;var s=i.has(t,"band_no")||e.isBandDataRequired();return!s||(s&&!o?(alert(IM("error.wrong_request")),location.replace(y.GLOBAL_HOME.makeUrl()),!1):e.getOption("routingArea")!==o.getBandCore().getRequiredRoutingArea()?e.isLfgBandRoutingAreaRouteInfo()?(e===S.LFG_BAND_CHAT?D.chat(o.getBandCore(),t.channel_id).go():D.home(o.getBandCore()).go(),!1):e===M.GROUP_BAND_CHATTING_ROOM&&O.isBandDesktopApp()?(location.replace(D.chat(o.getBandCore(),t.channel_id).url),!1):(alert(IM("error.wrong_request")),location.replace(y.GLOBAL_HOME.makeUrl()),!1):!o.isAccessAvailableState()&&e.isLfgBandRoutingAreaRouteInfo()?(alert(IM("band.alert.invalid_lfg")),y.GLOBAL_HOME.goDForced(),!1):!(!o.isAccessAvailableState()&&e===I.PAGE_BAND_MESSAGE_CHANNEL)||(L.closeWindow(),!1))},_validateAccessPermission:function(e,t,n,i){var o=e.getViolatedAccessPermissionType(t,n,i);return!o||(e===M.GROUP_BAND_CHATTING_ROOM?(alert(IM("channel_list.message.join_denied")),L.closeWindow(),!1):o!==C.ACCESS_PERMISSION_TYPE.LOGIN_USER||(f.goRefreshFallback(),!1))},_validateBlockedBand:function(e,t,n,o){return!o||(!o.isBlockedBand()||!!e.isPageBandRoutingAreaRouteInfo()&&(this._handleBlockedPageBand(e,o,bandNo).always(i.bind((function(){this._historyBackOrGoGlobalHome()}),this)),!1))},_validateAccess:function(e,t,n,i){return!!(this._validateWrongRequest(e,t,n,i)&&this._validateAccessPermission(e,t,n,i)&&this._validateBlockedBand(e,t,n,i))&&(!(i&&!i.isAccessAvailableState()&&i.getStateMessage())||(alert(i.getStateMessage()),y.GLOBAL_HOME.goDForced(),!1))},_handleBlockedPageBand:function(e,n,i){if(!e.isPageBandRoutingAreaRouteInfo()||!n||!n.isBlockedBand())return t.Deferred().reject();if(n.isBlockedBandWithLeader()){if(n.getReservedClosureAt()&&n.getReservedClosureAt().valueOf()<(new Date).getTime())return alert(IM("page_band.on_closing")),t.Deferred().resolve();if(confirm(IM("page_band.blocked_page.confirm.close_page")))return N.closePage(i).then((function(){return alert(IM("page_band.blocked_page.alert.page_close_requested")),t.Deferred().resolve()}))}return n.isBlockedBandWithMember()&&confirm(IM("page_band.blocked_page.confirm.unsubscribe"))?w.leaveBand(i,!0).then((function(){return alert(IM("ui.alert.request_completed")),t.Deferred().resolve()})):t.Deferred().reject()},_historyBackOrGoGlobalHome:function(){var e;if(r.hasExRouteInfo()){var t=r.getExRouteInfo();e=t.routeInfo.makeUrl(t.pathVariables,t.params)}else e=y.GLOBAL_HOME.makeUrl();m.go(e,{replace:!0})},_clearPageLayoutContent:function(){var e=this.getView();e&&"function"==typeof e.clearPageLayoutContent&&e.clearPageLayoutContent()},_renderView:function(e,n,o,s){this._resolveLayoutFilePath(e,n,o,s)().then(i.bind((function(i){var a=i.default,r=this.getView();this._isPageChanged(n)||(l.changePageTitle(b.newRoute(e,n,o),s?{bandName:s.getBandName()}:null),t("._defaultLoading").is(":visible")&&t("._defaultLoading").hide(),r instanceof a||this.showView(r=new a),r.renderWebLayout(e,n,o,s))}),this))},_resolveLayoutFilePath:function(e,t,n,i){if(e.isDesktopSimpleLayout())return R;if(e.isDesktopChatLayout())return k;switch(e){case S.LFG_BAND_CHAT:case M.GROUP_BAND_CHATTING_ROOM:return window.initPublicChatChannelId===t.channel_id&&i&&!i.canAccessChatMessage()?x:k}return x},_isPageChanged:function(e){return r.getCurrentRouteInfo().pathVariables!==e},_isCurrentBandDataExpired:function(e){var t=r.getExRouteInfo().routeInfo;if(!t||t.getDesktopLayout()!==e.getDesktopLayout())return!0;switch(e){case M.GROUP_BAND_HOME:case M.GROUP_BAND_CHATTING_ROOM:case I.PAGE_BAND_HOME:case I.PAGE_BAND_POST:case I.PAGE_BAND_MESSAGE:case S.LFG_BAND_HOME:case S.LFG_BAND_SETTING:return!0}return!1},_handleWindowFocusEvent:function(){c.getDGlobalChannel().trigger(c.EVENT.REFRESH_BADGE_REQUEST),t.browser.msie||t.browser.msedge||c.getDGlobalChannel().trigger(c.EVENT.CHAT_ROOM_LIST_UPDATED)}}),V=function(){var e=i.union(i.values(y),i.values(M),i.values(I),i.values(S)),t=i.filter(e,(function(e){return!e.isAccessRestricted()}));return s.build(t,y.GLOBAL_HOME)};return new B}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(721),s=n(583),a=n(154),r=n(779);var l={open:function(e){this._layerContainerView.openNewLayer(e,!0)},openWithoutHiding:function(e){this._layerContainerView.openNewLayer(e,!1)},closeAll:function(){for(;this._layerContainerView.hasLayer();)this._layerContainerView.closeLastLayer()},openPromiseView:function(e,t,n){var o=!t,r=s.buildLayer(n),l=function(e){return i.find([e,n?n.view:null],(function(e){return a.isView(e)}))};return this._layerContainerView.openNewLayer(r,o),e.then(i.bind((function(e){var t=l(e);if(r.destroy(),t)return this._layerContainerView.openNewLayer(t,o),t}),this),i.bind((function(e){var t=l(e);r.destroy(),t&&t.destroy()}),this))},closeTop:function(){this._layerContainerView.closeLastLayer()},setTopLevelElementOverflow:function(e){t(o.BODY).css({overflow:e})},start:function(e){this._layerContainerView=e},isStarted:function(){return!!this._layerContainerView},isTopLayerView:function(e){return this._layerContainerView.isTopLayerView(e)},isContainedInLayer:function(e){return this._layerContainerView.el.contains(e.el)},getActiveLayerView:function(){return!!this._layerContainerView&&this._layerContainerView.getActiveLayerView()},registerLayerEvent:function(e,t){this._layerContainerView&&this._layerContainerView.on(e,t)},startLayerHelper:function(e){var n=new r;e.getRegion("layerContainer").show(n),e.listenTo(n,{beforeLayerOpen:function(){if(!this.getChildView("layerContainer").hasLayer()){var e=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)-t("BODY").prop("clientWidth"),n=t(o.HEADER);n.data("_layerPreviousPaddingRight",n.css("padding-right")),n.css("padding-right",e);var i=t(o.BODY);i.data("_layerPreviousPaddingRight",i.css("padding-right")),i.css("padding-right",e);var s=t(o.LNB);s.data("_layerPreviousPaddingRight",s.css("padding-right")),s.css("padding-right",e),i.data("_layerPreviousOverflow",i.css("overflow")),i.css({overflow:"hidden"})}},afterLayerClose:function(){if(!this.getChildView("layerContainer").hasLayer()){var e=t(o.HEADER);e.data("_layerPreviousPaddingRight")&&(e.css("padding-right",e.data("_layerPreviousPaddingRight")),e.removeData("_layerPreviousPaddingRight"));var n=t(o.BODY);n.data("_layerPreviousOverflow")&&(n.css("overflow",n.data("_layerPreviousOverflow")),n.removeData("_layerPreviousOverflow"));var i=t(o.LNB);i.data("_layerPreviousPaddingRight")&&(i.css("padding-right",i.data("_layerPreviousPaddingRight")),i.removeData("_layerPreviousPaddingRight")),n.data("_layerPreviousPaddingRight")&&(n.css("padding-right",n.data("_layerPreviousPaddingRight")),n.removeData("_layerPreviousPaddingRight"))}}}),l.start(n)}};return l.EVENT=r.EVENT,l}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(){return{PAGE:{HOME:"home",NEWS:"news",BAND_CREATE:"create_band_list",CHATTING_CHANNEL_LIST:"chatting_channel_list",CHATTING_ROOM:"chat_room",DISCOVER:"discover",MORE:"more",BAND_HOME:"band_board",BAND_BOARD_SEARCH:"post_search",BAND_POST_DETAIL:"post",BAND_ALBUM:"album",BAND_CALENDAR:"calendar",BAND_MEMBER:"member",INVITE:"invite",SETTING:"setting",SETTING_PROFILE:"setting_profile",SETTING_ACCOUNT:"setting_account",SETTING_CONNECTED_DEVICE:"setting_connected_device",SETTING_LOGIN_BLOCKING:"setting_login_blocking",BAND_SETTING:"band_setting",BAND_SETTING_JOIN_TYPE:"band_setting_join"},LAYER:{POST_WRITE:"board_write",POST_WRITE_POLL:"board_write_attach",POST_WRITE_TODO:"board_write_attach",POST_WRITE_BILLSPLIT:"board_write_attach",ALBUM_SELECT_ITEM:"album_item",PHOTO_COMMENT:"photoCommentsInput",BAND_ALBUM_CREATE:"band_album_create",BAND_SETTING_BAND_TYPE:"band_setting_band_type",BAND_LEAVE_CONFIRM:"band_leave_confirm",BAND_SETTING_DELEGATE_LEADER:"band_setting_delegate_leader",CHATTING_ROOM_MEMBERS:"layer_chatting_member",COMMENT_MODIFY:"comment_modify",SCHEDULE_DETAIL:"schedule_detail",SCHEDULE_RSVP:"schedule_rsvp",OPTION_MENU_LIST:"modalWrap",DATE_PICKER:"date_select_layer",BAND_SELECTION:"band_selection",POST_MEMBER_LIST:"post_member_list"},ELEMENT:{FULL_SCREEN_LOADING:"-gLoading",ON:"-on",OFF:"-off",FIXED:"-fixed",ACTIVE:"-active",AREA_VERTICAL_MIDDLE:"cMiddle",SCREEN_VERTICAL_MIDDLE:"middle",DISABLE:"-disable",DISABLED:"-disabled",CONFIRM:"-confirm",SCROLL_X_DISABLED:"gScrollXDisabled",UP:"-up",FOCUS:"-focus",HASHTAG:"gHashTag",OVER_DIM:"dgOverDim"},ICON:{UP:"icon-select-up",DOWN:"icon-select-down",USELECT_UP_AFTER:"icon-a-uselect-up",USELECT_DOWN_AFTER:"icon-a-uselect-down"}}}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(490);return t.Model.extend({toJSON:function(){return i.toRecursiveJSON(this)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(34);return{toRecursiveJSON:function(e){var n=t.clone(e.attributes);for(var o in n)(n[o]instanceof i.Model||n[o]instanceof i.Collection)&&(n[o]=n[o].toJSON());return n},stringifyWithUndefined:function(e){return o.stringify(e,(function(e,t){return null==t?null:t}))},convertObjectToUriQueryJsonString:function(e){return encodeURIComponent(o.stringify(e))},convertUriQueryJsonToObject:function(e){try{return o.parse(decodeURIComponent(e))}catch(e){return null}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(155);return{getCachedBandData:function(e){var n=t.get(e);return n.loadBandData().then((function(){return n}))},resetBandData:function(e){t.get(e).resetBandDataState()}}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(21),o={GET_BAND_MEMBERS:"/v1/get_band_members",GET_MEMBERS_OF_BAND:"/v1.3.0/get_members_of_band",GET_MEMBERS_OF_BAND_WITH_FILTER:"/v2.0.0/get_members_of_band_with_filter",GET_MEMBERS_BY_ROLE:"/v1/get_members_by_role",SEARCH_MEMBER:"/v1.2.0/search_member",SEARCH_MEMBER_IN_BAND:"/v1.1/search_member_in_band",SET_MEMBER_ROLE:"/v1/set_member_role",WITHDRAW_MEMBER:"/v1.2.0/withdraw_member",WITHDRAW_MEMBERS:"/v2.0.0/withdraw_members",GET_BLOCK_MEMBERS:"/v1.1.0/get_block_members",RELEASE_BLOCK_MEMBER:"/v1.0.0/release_block_member",GET_VIRTUAL_MEMBERS:"/v1.0.0/get_virtual_members",ADD_VIRTUAL_MEMBER:"/v1.0.0/add_virtual_member",MODIFY_VIRTUAL_MEMBER:"/v1.0.0/modify_virtual_member",DELETE_VIRTUAL_MEMBER:"/v1.0.0/delete_virtual_member",ADD_CHILD_MEMBER:"/v2.1.0/add_child_member",ADD_CHILD_MEMBERS:"/v2.1.0/add_child_members",GET_MEMBER_ACTIVITY_HISTORIES:"/v2.0.0/get_member_activity_histories",ADD_MEMBER_RELATION:"/v2.0.0/add_member_relation",REMOVE_MEMBER_RELATION:"/v2.0.0/remove_member_relation",GET_MUTED_MEMBERS:"/v2.0.0/get_muted_members",GET_CHILD_MEMBER_LIST:"/v2.0.0/get_child_member_list",DELETE_CHILD_MEMBER:"/v2.0.0/delete_child_member",CREATE_MEMBER_GROUP:"/v2.0.0/create_member_group",DELETE_MEMBER_GROUP:"/v2.0.0/delete_member_group",UPDATE_MEMBER_GROUP:"/v2.0.0/update_member_group",ADD_MEMBERS_TO_MEMBER_GROUP:"/v2.0.0/add_members_to_member_group",DELETE_MEMBERS_FROM_MEMBER_GROUP:"/v2.0.0/delete_members_from_member_group",GET_MEMBER_GROUPS:"/v2.0.0/get_member_groups",GET_MEMBER_GROUP:"/v2.0.0/get_member_group"},s=null,a=function(){return s||(s=i.getLoginV1Client()),s},r={getBandMembers:function(e){return a().send({url:"https://api.band.us"+o.GET_BAND_MEMBERS,data:t.extend({band_no:"",member_offset:0,member_count:30},e)}).then((function(e,t,n){return e.result_data}))},getMembersOfBand:function(e,t){var n={band_no:e};return t&&(n.order=t),a().sendAndThenProcess({url:"https://api.band.us"+o.GET_MEMBERS_OF_BAND,data:n})},getBandMembersOfBandWithFilter:function(e,t,n){return a().send({url:"https://api.band.us"+o.GET_MEMBERS_OF_BAND_WITH_FILTER,data:{band_no:e,filter:t,param1:n}}).then((function(e){return e.result_data}))},getMembersByRole:function(e,t){return a().sendAndThenProcess({url:"https://api.band.us"+o.GET_MEMBERS_BY_ROLE,data:{band_no:e,member_role:t}})},searchMember:function(e,t,n,i){return a().send({url:"https://api.band.us"+o.SEARCH_MEMBER,data:{query:e,band_no:t,filter:n,param1:i}}).then((function(e){return e.result_data}))},searchMemberInBand:function(e,t){return a().sendAndThenProcess({url:"https://api.band.us"+o.SEARCH_MEMBER_IN_BAND,data:{query:e,band_no:t}})},setMemberRole:function(e,t,n){return a().sendAndThenProcess({url:"https://api.band.us"+o.SET_MEMBER_ROLE,data:{band_no:e,user_nos:t,member_role:n},method:"POST"})},doWithdrawBandMember:function(e,n,s,a){var r=a?i.getLoginV1ClientWithoutErrorAlert():i.getLoginV1Client(),l={band_no:e,is_block:s};return t.isNumeric(n)?l.user_no=n:l.member_key=n,r.sendAndThenProcess({url:"https://api.band.us"+o.WITHDRAW_MEMBER,data:l,method:"POST"})},doWithdrawBandMembers:function(e,t,n,s){var a={band_no:e,is_block:n,user_nos:t};return(s?i.getLoginV1ClientWithoutErrorAlert():i.getLoginV1Client()).sendAndThenProcess({url:"https://api.band.us"+o.WITHDRAW_MEMBERS,data:a,method:"POST"})},getBlockMemberList:function(e){return a().send({url:"https://api.band.us"+o.GET_BLOCK_MEMBERS,data:{band_no:e}}).then((function(e){return e.result_data}))},doReleaseBandBlockMember:function(e,t){return a().sendAndThenProcess({url:"https://api.band.us"+o.RELEASE_BLOCK_MEMBER,data:{band_no:e,user_no:t},method:"POST"})},getVirtualMembers:function(e){return a().sendAndThenProcess({url:"https://api.band.us"+o.GET_VIRTUAL_MEMBERS,data:{band_no:e}})},addVirtualMembers:function(e){return a().send({url:"https://api.band.us"+o.ADD_VIRTUAL_MEMBER,data:{band_no:e.bandNo,name:e.name,cellphone:e.cellphone,email:e.email},method:"POST"}).then((function(e){return e.result_data}))},modifyVirtualMembers:function(e){return a().send({url:"https://api.band.us"+o.MODIFY_VIRTUAL_MEMBER,data:{band_no:e.bandNo,virtual_member_id:e.virtualMemberId,name:e.name,cellphone:e.cellphone,email:e.email},method:"POST"}).then((function(e){return e.result_data}))},delVirtualMembers:function(e){return a().send({url:"https://api.band.us"+o.DELETE_VIRTUAL_MEMBER,data:{band_no:e.bandNo,virtual_member_id:e.virtualMemberId},method:"POST"}).then((function(e){return e.result_data}))},addChildMembers:function(e,t){return a().sendAndThenProcess({url:"https://api.band.us"+o.ADD_CHILD_MEMBERS,method:"POST",data:{band_no:e,names:JSON.stringify(t)}})},getMemberActivityHistories:function(e,t){var n={band_no:e};return t&&(n.after=t),a().sendAndThenProcess({url:"https://api.band.us"+o.GET_MEMBER_ACTIVITY_HISTORIES,data:n})},addMemberRelation:function(e,t,n){return a().sendAndThenProcess({url:"https://api.band.us"+o.ADD_MEMBER_RELATION,method:"POST",data:{type:e,target_user_no:t,band_no:n}})},muteMember:function(e,t){return this.addMemberRelation("mute",e,t)},removeMemberRelation:function(e,t,n){return a().sendAndThenProcess({url:"https://api.band.us"+o.REMOVE_MEMBER_RELATION,method:"POST",data:{type:e,target_user_no:t,band_no:n}})},unmuteMember:function(e,t){return this.removeMemberRelation("mute",e,t)},getMutedMembers:function(){return a().sendAndThenProcess({url:"https://api.band.us"+o.GET_MUTED_MEMBERS})},getChildMemberList:function(e){return a().sendAndThenProcess({url:"https://api.band.us"+o.GET_CHILD_MEMBER_LIST,method:"GET",data:{band_no:e}})},addChildMember:function(e,t){return a().sendAndThenProcess({url:"https://api.band.us"+o.ADD_CHILD_MEMBER,method:"POST",data:{band_no:e,name:t}})},deleteChildMember:function(e,t){return a().sendAndThenProcess({url:"https://api.band.us"+o.DELETE_CHILD_MEMBER,method:"POST",data:{band_no:e,child_membership_id:t}})},createMemberGroup:function(e,t){return a().sendAndThenProcess({url:"https://api.band.us"+o.CREATE_MEMBER_GROUP,method:"POST",data:{band_no:e,name:t}})},deleteMemberGroup:function(e,t){return a().sendAndThenProcess({url:"https://api.band.us"+o.DELETE_MEMBER_GROUP,method:"POST",data:{band_no:e,member_group_id:t}})},updateMemberGroup:function(e,t,n){return a().sendAndThenProcess({url:"https://api.band.us"+o.UPDATE_MEMBER_GROUP,method:"POST",data:{band_no:e,member_group_id:t,name:n}})},addMembersToMemberGroup:function(e,t,n){return a().sendAndThenProcess({url:"https://api.band.us"+o.ADD_MEMBERS_TO_MEMBER_GROUP,method:"POST",data:{band_no:e,member_group_id:t,user_nos:n}})},deleteMembersFromMemberGroup:function(e,t,n){return a().sendAndThenProcess({url:"https://api.band.us"+o.DELETE_MEMBERS_FROM_MEMBER_GROUP,method:"POST",data:{band_no:e,member_group_id:t,user_nos:n}})},getMemberGroups:function(e,t){var n={band_no:e};return _.isEmpty(t)||(n.include_roles=t.join(",")),a().sendAndThenProcess({url:"https://api.band.us"+o.GET_MEMBER_GROUPS,method:"GET",data:n})},getMemberGroup:function(e,t){return a().sendAndThenProcess({url:"https://api.band.us"+o.GET_MEMBER_GROUP,method:"GET",data:{band_no:e,member_group_id:t}})}};return r.PATHS=o,r}.call(t,n,t,e))||(e.exports=i)},,,,function(e,t,n){var i;void 0===(i=function(){var e={LEADER:"leader",CO_LEADER:"coleader",MEMBER:"member",parseRole:function(t){var n,i;switch(t){case e.LEADER:n=IM("web.band.member.role.leader"),i=t;break;case e.CO_LEADER:n=IM("web.band.member.role.coleader"),i=t;break;default:n=IM("web.band.member.role.member"),i=null}return{leader:t===e.LEADER,coleader:t===e.CO_LEADER,label:n,name:t,iconName:i}}};return e}.apply(t,[]))||(e.exports=i)},function(e,t){e.exports='<%\n/**\n-    middleClass 값 설명\n*   middle : 화면 정중앙!\n*  cMiddle : 해당 영역의 중앙!\n\n*/\nif ( typeof middleClass == \'undefined\' ) {\n    middleClass = \'\';\n}\n%>\n\n<p class="uLoading <%= middleClass %>">\n    <img src="data:image/gif;base64,R0lGODlhQABAAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnaOjo6urq7Ozs7u7u8DAwMTExMfHx8nJycvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc3Nzc7Ozs7Ozs/Pz8/Pz8/Pz8/Pz9DQ0NDQ0NPT09fX19nZ2dzc3N/f3+Li4uTk5Ofn5+rq6uvr6+zs7O3t7e3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vb29vf39/j4+Pr6+v39/f7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////////////yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJBAD5ACwAAAAAQABAAAAI/gDzCRxIsKDBgezIZbM2zZfDh9SqZQPH7qDFixgzrrvm7KHHjx6nXVuXsaRJgtyogVzJ0hc1cCdjGmSXrWPLmyClaaso8+Q4aTiDrnSmrWdGdtWEKl1JjafRgtxs4pRGzRo2btywYWMo1BnMpwOt4XRmbdxRcNeA3qwGNp/YltS4OT2Z8qa1p2+ZkmyLLi/IuzHZ+fXojFvbguOkfgRsMulKa3MPC0TKkjFGcCwNS7bILbNGxQ81b+Y8NHJBlSBFjyb996K2lapXs/5odiZoX2xllxzsS5rp1x+dmdZtGyQ2g2o91iaesfNHaQUxL2Z+ErXHrwKtP0RH3eQ6kLnz/n3/SK17dZB7r6U2b9K5x+P5GnqEzr4kO9DQ2YG8Vt8kb3bSXddfSeOANA42IA03YEHGOfbQNAuWlJxD1mjni2URHmShfO9liBFvxnl4EYI4xSbiQO61ZOKJ+aTIEnwsEkSiXTEWNOOD5NVI0GBVfQShjgJx6FA1NzoEZD76fYRNgbQBGeBDFLWmo3ofVTShL8LpOI41Uv1YpC8rnggOl/yJB1J5RyI0kIMP7ZUmSme+adBtYQL5ZZZyDnQlbnkOxORHderIZmh9InkbmIUCt16fIOKmYI2NOrPcm41eOOmRFpIXqIeC4YShjuAc6tCmIrKTKZaF5qMNaJ++yQ43Eclhl2o+4FDjzKwGuYlrjAEBACH5BAkEAPkALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnaCgoKSkpKqqqrGxsbi4uL29vcHBwcXFxcfHx8nJycrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc7Ozs/Pz9DQ0NHR0dLS0tLS0tLS0tjY2Nvb297e3uHh4ePj4+Tk5OXl5eXl5ebm5ufn5+np6erq6uvr6+zs7O3t7e7u7vDw8PHx8fPz8/T09PX19fb29vb29vb29vf39/f39/n5+fv7+/39/f39/f7+/v7+/v7+/v///////////////////////////////////////////////////wj+APMJHEiwoEGC5LRJkwasocOF2rixO0ixosWL6BQ63MhxIzRr4i6KHEnwG7SOKFMCg8bNHcmXBd1pY6ayJkpm2lzCJDnTps+bIXdaZMfwp9GO0iYKNSiOpk9p07JJ/SbVWlGbzIIuFajNJjRq33RWJJftaspvW/OZRUpOKDlqNa0thZuSmtKtRFVS22ktJTR0aQuKO4lS2stvKaeJDTzQHd2O2UaKS8mNccXHHLVSZOeUI1rLFRF3ZHb34NqGn0GHLlxxcse9qi9yQxnZoLvODmHHvjht9GKBfTlC+737oDvCG2s3xt1Qc/GK6EYXnM1x2nOSmFETRO6w9HXoHaH+DXS9Uff3i6cB5wu+se15keQ6Vs7HHZjh9yPrW2cHGf/I7MDkQ117/okkWnvZdFSgSPxxVBZH9y1okX5rmSfhQb1tdJpyFx6U4EbMAcNhhwV9WFNqJJbo04gpCjSgSiy2aCKMLRo0Y0NrWVcjQdlBJdyOBK0lzY3AeNciZPFlBmQ+SW5UWUdyAUnkREIuWZ94+RDpXotNOhRllzjumOFGWtVXZIsNelTSay2eNt9AIap3IXkOMfMbkcNdeFt/MYWo44KccWSnhyi9WaA7ZjkXJEooFvhhhAcF2lGj/qGT1EV0lrfkQexxZOimAo3pUJ6gFpSdnKUSxN6nqQ6E2J8PrTJFXKy01mrrrbjmWlxAACH5BAkEAPkALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnaOjo6urq7Ozs7q6ur+/v8PDw8bGxsjIyMrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc7Ozs/Pz9DQ0NHR0dHR0dLS0tLS0tTU1NbW1tjY2NnZ2dvb293d3d/f3+Hh4ePj4+Tk5OXl5ebm5ufn5+jo6Ojo6Onp6evr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09Pb29vn5+fv7+/z8/P39/f7+/v7+/v7+/v///////////////////////////////////////////////////wj+APMJHEiwoMGB7MBxo0btl8OHDLmlO0ixosWL+cplg/awo8eO1MCtw0iypDtwHD+qXAlNXMmXBt1lW7ayZs1l3NzBfFmOps2fK3HuvMiuIdCjK6WxG3qw59Fp2bZtEyd1mzVpR5eVY0pQ3E9p29ARFXctZU1uXPNls3lN7E5002xSY3qtprWladnVXXltp9GP0LamJbjOrMdsL7fx1Tm4oDtrK11iLMe3cUVwKwVXZOfTo2TLFL1+XIaXItaPn0GHVjmXouKP4FRj3OtRM0F3nR9ak02S9sNljAm+7ggtOO+KuD9uc5zb4cjjk0cbF92xL3SScT3GHmjYYenrFtn+AR647uM08CV9OxSM2aNb9BfRfUScL/tDaPBLdsef76P1/BcN9xA78nkGIEYFdgSOgA4ZdyBFykHWkTQPYmSfQ9Nc+MtuFVqknoa/LNdhRQyqJOKIB5WoHIquAZUaiwOp6NGJMMYIFI015sPgMhrSl6NAEj6UoUfn/ShQd9aUaGQ+4s3YXkfv1UjdQ+g02RGOLKq3zJEe8ZcjkgKp90uUKCb40HaUefQfi3899Fw+3f3yXYfldUnQkxDBKGZqydWGYp3EGVSilw+6EyeWfToEzZsPBvmbgwKl+Us2kOaH50NYDjSNVihO+RCFm1Wan6cOkbYkQWI6ROaP7qQa4qkmBIH4S5GwCsSZmrUWJOmkuRq01i8v9pqPO9PYJuyxyCar7LI/BgQAIfkECQQA+AAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2doKCgpKSkqqqqr6+vtbW1ubm5vr6+wsLCxcXFx8fHycnJysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzc3Nzc3Nzs7Ozs7Oz8/P0tLS1NTU1tbW2NjY2tra3d3d39/f4uLi5OTk5ubm6Ojo6enp6+vr6+vr7Ozs7u7u7+/v8PDw8fHx8vLy8/Pz8/Pz9PT09fX19vb2+Pj4+fn5+vr6/Pz8/f39/f39/f39/v7+/v7+////////////////////////////////////////////////////////CP4A8QkcSLCgwYHswGWrRg2Yw4fSrGUrx+6gxYsYM6q7Ju2hx48eoWVTl7GkSYLgGoJcybIauJMwDbLbBo2lTZvPslWMeXLbs5tAbUIbxzMjO5VBk66strNoQXA/g0bMls2bt2zWptUM+sybU4LWgEK7Bq6pxXHWotq09hVfWJvTvMZk523aTbZF3660hq4tPnV2WeKFqffjM6J+B3pT+3FwycIemSYuyA7yw2omwbGUO9mgN5YvMbJj/JBzZ88rn5k1WG2l6dOoQVK7OM417IyfQW47yG5r5NslWxtejS8bSNXAjZIGtrug79LJS9b+CO0pyGnRTVoOLVC4R5LZM/6ikz1QHUhp4U0G/i7wGsjX6Q/m9nhN4HNgyONnvI+eHUjH+lnk3kfsTOcRYgFepNlHCoGUoFEgYUXdgxl1FJmFD2FH4UWQrfcQgBsSZBxQ2YRo0Yg3wWciPtsEpaKJ89lU4ooFoSgjjQVZ5iEwIK64ozQ/4kjQfRKBRJyJES7oEXc0GvjQOP6F9CKFllXU0Vh9CYnPaBPiMw54WgoUo0MzhlkQhg+BaaZA5n2E2ZoEIfUQk2uOCUx1cArE5UdlwundQ9AcKaSdwCBY51554kNofofatiY7f3rUY5PLOTSpiehY9qGZ3sj5X5jo3PdpmFGy9AydQkZ6maA02vlMcxJ5lnrnNqxq2dE0qCb6ZaLRBQQAIfkECQQA+gAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6eoaGhpaWlq6urr6+vtbW1urq6vr6+wcHBxMTExsbGyMjIysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzs7Oz8/P0dHR09PT1dXV2NjY2dnZ3Nzc3d3d3t7e39/f4eHh4uLi4+Pj5OTk5eXl5eXl5ubm5ubm5+fn6Ojo6enp6enp6urq6+vr7Ozs7e3t7u7u8PDw8vLy9PT09fX19vb29/f3+fn5+/v7/Pz8/v7+/v7+/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////CP4A9QkcSLCgwYHtxG2r9uwZM2DAmjXctk1cu4MYM2rcmG5bM4ggQ4qE2Gxbuo0oUyLc9nCky5fMtl1USbPgNmUvc+ZUtq1mTXEtdQp1yUycz43rPg5d+rLZuqMHzeEc6szZtGxYs02rOlWnspNQB4oTyqxaOZTlqgV9aTTsNJ3TwNZM9zbnNKh1XTqTCzWds5zQfOYV2cxcWIPmlI6sRnOs3pmHC7b767LtRnMvGUfOODgk34Ppuoa0vBmjY5HKnmZUPLo0ytMhm2WEDVKz642dIZJGuBZi4NspKYdkdjDbyGaQgWtsxxpiNsmiIRpWnhIz6uTGRTqjTlM4yOcDe/4DU80dZbqRxAWeF3m3vMrcYLN7dq9yfchvApunp5+yt+x1i/GnUjUjJTTSWQKiNZI48oGUoEojYaXdg8GJlI13wGxH4UYYVsXehrhpFx14IGLUYERZVVPVbiUSdCIwLdL0YowqnSgbjSh1piGOGnXII4cW/qhRhEJiVM6CRR5EoEjJJSmQf04WZB9I+EU5EHxWqodelgI9Q2SW1oWkTJNFMvellV6KtF+UuQHDopC0kZRlnMCkZmWbwHz2YztpIulkYpk5mU6fI7UnJF062YZjWuKJ9KaA61A0TUPRufRVjGEy5RSNmZL1KIWdvqQMiTiGqmY2ZGLa1Dd68ohZMwdVYWVRaQEBACH5BAkEAPoALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5+fn6KioqioqK2trbKysra2trm5ub29vcHBwcTExMfHx8nJycrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc3Nzc7OztDQ0NHR0dLS0tTU1NbW1tfX19nZ2dvb293d3d/f3+Hh4eTk5Obm5unp6erq6uvr6+vr6+zs7Ozs7Ozs7O3t7e7u7u/v7/Dw8PHx8fHx8fLy8vX19fb29vj4+Pn5+fn5+fr6+vv7+/39/f7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////wj+APUJHEiwoMGB7MhZm+asl8OH0KRZA8fuoMWLGDOms8bsocePHp1RS5expEmC3KSBXMmyFzRwJ2MetKaspc2VzK5VlHmSXMebQEEqu8YzIzuVQZOChLazaMFrNYE6gzbNGjdu1hY2BKoMptOB024qm0bOKDhqP1tK+6ovbEto3Jqe5AbN5jSnbldCI8nWXF6Qd2Oyq7tSGTe2BclFBRzzr8dpchELPMoycEZwLA9Ltsgts9HFHjVv5lw4ckHCH0WPJs3Y4rWVqlez/ljWIDvQDtfKLum4FzPTrz/+3l3yNkhrBtM+rE08Y2fhBZ8/bn4S9UOvAq07NEfdZDqQuvX+pcMNrfvJrR75CgQ3LSp28xilP0RekB03y/AxGvfILD/i3qb51xNIzAnI03EGOqVcL/glWN1HzjjIU28SymQNSBXGJJ9DGc6FYYclXfgRiCF+SOJFjpV34kXo5baiRewg+KJBmH303owCUQNSgC8uGCGOKIFEDZAEadeLekCasxSRYIF044w18sekPvt5RBSTSHmkDI8kbujQlUB62Ut4OIq5JZFi9vIkiZSt1OCJ3OD20JsgpmPknC/a12Jr1JFDDUUZkdPeTXTKlpczVVmF1TTQLMiSYfnJqdRjXK4W5aTCFWheb5MyY02lu0kalDRrmscONXve5CmSErIDjjUK0hiJqDXkgGpSQAAh+QQJBAD6ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSpqamurq60tLS8vLzCwsLGxsbIyMjKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Pz8/Q0NDT09PU1NTW1tbY2Nja2trd3d3f39/j4+Pk5OTk5OTl5eXl5eXm5ubm5ubn5+fo6Ojp6enq6urs7Ozt7e3v7+/x8fHz8/P19fX29vb39/f4+Pj4+Pj5+fn7+/v9/f39/f39/f3+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////////8I/gD1CRxIsKBBguS2TZM2rKFDadK2eVN3sKLFixgTMnTIsaNDZ9XEYRxJkiA4Zx5TqhzmzBu7kjALstvGbKXNlMy2vYxZkubNnzhF8ryoDhrQoymlURxqUFzNn86mZZsKbiq1aECZCWUqsNpNaCGXWiSXDaVNcFz1TbMZjdxQctRsVmMaVyU1sUzVYbXL02tKZ+bSFhRn1qM0mOBUTtspmCC7uh6zkRSn0ltji5A7brXIbm1HtJctJvbIDK9FbxxBhxadElpJcyiprR6JOnJJdpZnj/TMkRlj3ZfZFXYoGfhqc6SNz87cULVywcg7Onseei/HwNQFk/OYO3va4cOm/nkXzHzY+LSjObo9P1SdbfZDwYuHz5N3w2j0eWbryCx/zP0d+QcTgBwJWFJtBRo4EoEOKbigRw5ixBx+EVpk3X0VWvRehgVt11F3HA7EYEOmhQjedCEi5NFcKQ5kX0ObheiedC0OtBFHIIZIGX+/ccjOUxwV12J5vtVY3jAxZpgeRxSmuKRDpbWIoGaCqdNjY52p5NxQPzqTJFewqcRiWjcqBd2RDckm2IjDULNeTOTcmFKTYK4EzTZvVqQOONSAt2FaRv0kDTXbSFSoQn7ilGdaeiHlqEPQlCiYU49mJaRu7GQDZKXSZXMlpt4kipQzW3onTjWiKuYNdgKq4002DNFcOAwz0Ui1KFcBAQAh+QQJBAD5ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWqqqqvr6+zs7O6urrAwMDFxcXIyMjKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Pz8/R0dHT09PW1tbY2Nja2trc3Nze3t7g4ODj4+Pk5OTl5eXl5eXm5ubm5ubm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3v7+/x8fHz8/P09PT29vb39/f5+fn7+/v8/Pz9/f3+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////////////8I/gDzCRxIsKDBgeq+bZMmjZjDh9KmbTN3sKLFixjzkav27KHHjx6nfUOXsaRJdt86glzJ8pk4kzANstvWjKVNm822sYsJk1zNm0BZ5uSJUV3DoEhZQlNHtCK7nzejWcuWTRzVbNOgIW1GrulBci2zUbzIThxHoNu8GrT2sdrYmOai3ZSmliA7ldGYqkVXzWa1ugPRPesKWKBgltYKKy7IbhrLl4sj5/vGkrBkxeJWNtN7uXBmkHQ7K+4L0rLouqQ9Ntt5uu5TkNlaAwb7cbXsunI/frutVh3IZ7zVpn5oOjhMcyATGyeq8iHw5TyzgeQMvSRy3dVjws4OM/fDaNxN/g4nBj58RukfzZ8HqR4jeo/tL75/GN/ifIf1K95vlv+gY4/l9UdQcw5NIyBBvn0U24ECfebRWweORwyDAxFIjIEUXufRbhQe5RFJDKLzG4X5SAjZgSJ+9FxGrBl313ZFSfPXcv+p1mJFPjk0I2+UwegUWx6d2JqDHkGDkXdBykbkQ5thRBtIHHYmoUMQWrTkQ9PcWBg7UxKzYElA/gZiYTmuFKB4fo3ZlFF+NYUkaFVaV+NKyjV132/ViEPdQeZsYyFIQjZVJlDQSLTNNgptU42HN3GlmDpaJSUpgHsClg1UkwLlaGfsZPNnpkxmo2Vn4nwq6TPfjNoaOt/MGdQzEtYUV505WEWDKXnRZPNNpUQFBAAh+QQJBAD6ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+ioqKmpqarq6uysrK3t7e9vb3BwcHExMTHx8fJycnKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Ozs7Pz8/Q0NDR0dHT09PV1dXW1tbZ2dnc3Nze3t7g4ODi4uLk5OTm5ubn5+fp6enq6urr6+vr6+vs7Ozt7e3t7e3u7u7w8PDx8fH09PT4+Pj7+/v9/f3+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////8I/gD1CRxIsKDBgejGZaM2LZjDh9GsZSuH7qDFixgz6iMX7aHHjx6hXTOnsaRJguZAqlRJbdzJlxmhrZwZMltFmDgHXqPJ0yE0cjlzpuzZk9rNoCebOYyYLdu3b9msTZPZs5lLpCa/jTtqkZw1pTStYR1rEN23jjPFkl070FzDlWrZsv0GFmRcuWTRUYOLV+63lVf7kv0LshlXwUgJf5yGeK1ij9sak9370bBkrOjqPox8Gek4kNA6Y7UGMrBomEM9Mj6d861HkqxhPnZ4LTZOqhBtw9z58bBujJ8/mv6NER3IbMRNon1ILXlJ0qqda8wGUnpG6h+tY9xWXbvF2cG8/lvE7lH8QejlzRd0vVR9QdwO77o/7n4gOZBAC6KDLR39w6Nm7RWadJl9NCBHH30jHXjI6ZPaQ6slt9xD/LHnEH+6PehQcwMF55F8sVkYzHDwOZSfbeANSBB3lfl2WYEfNUgQjB5xyBplIbnIYoKsgRfMiQaJGIyCnfkI4oyaPURkYz5aBtxKS/bl45Al4fiRNS4ipRdfJvnnUTNRYjVOkg8diZGXqmGIkzlolplTmxB+k+VF3wjpZlBwPtSMNUAelNA1Jdo1Fl1EQTONRE81Zc2EM1m11pZERQrSNHPmRE6gkjbKWV/oZINppg9Bs02la41jJajBTDNcZ+Z4mmk0DyM5hw45UTGaKjXZbEVWQAAh+QQJBAD6ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKoqKivr6+1tbW7u7vAwMDFxcXIyMjKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Pz8/R0dHS0tLU1NTV1dXX19fY2NjZ2dnc3Nze3t7f39/h4eHj4+Pk5OTl5eXm5ubn5+fn5+fo6Ojp6enr6+vs7Ozt7e3u7u7v7+/y8vL09PT29vb5+fn9/f3+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////////8I/gD1CRxIsKDBgwS1OZs2bdu2cOgQSpxIsaJBbcMyahwG7ds5iyBDUsS4saSzbelEqlRJraTLYcxQrpxJUdrLl87C0dxp0ObNl9A+8uQZTps1aT5/ZmRWbqjTgeSwOVM6TOfTq+esKcV2teu5pC6tde1aDtpNsWOfpmv50mpap1pfCn07NNxLZhHp1gWq1ym2tn2Hgs3oLDDPdGZLajO8s5xLZikZzxw8bLHkledcFr68Mu7GuZxBZi75LbTKqRuhmRb5t2Tk1RXJuXQLm6JLy7VrKs5dcbA03hQ9Z/wNXCJJjdDMKV+et/jxn7iBP8+YWGN03tOhDUZbXPgwpCWJ/hf3PV088MHapjMrLvC23ZLkissuGS6dS67AW29MWZ1wcdTICTTdMKCtNtpGpelzoEbcweYdgQMBqFGBnC3o30ADTlPbNLcRlA4zLjVlmmMlQVbQgNC8JhliHRokYUbUhMahSQi9VxJ+jD1YlUT9aUSbXjamNhE6IM4WWJAa4UURiffppSOEFSGp0TQqOpXOjEaC9CQ0IjpV1k04gsTWS9NQKNI5WIY105MZWWMmRVlttZOUJmETH0VRvZhlY0UqxQxD1jjkkDUMUbXUmyqd06OhjKbW3FPh6NmoUjnppU2fk97EzHVvpaNQppppU2Vg52izqFIdIcpYOkVpg1RiCNpJk159TgUEACH5BAkEAPkALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnaOjo6urq7Ozs7u7u8HBwcXFxcjIyMnJycrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc7OztDQ0NHR0dPT09TU1NbW1tjY2NnZ2dzc3N/f3+Hh4ePj4+Xl5ejo6Onp6erq6uzs7Ozs7O3t7e7u7u/v7/Dw8PDw8PHx8fHx8fLy8vb29vn5+fv7+/z8/P39/f7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////////wj+APMJHEiwoMGDCBMqXMiwocN85R5KnPhwWTRvFDNqHOjtl8dm285tHOlwmseTy7CRXInw3MmXv6KJZEkz3zaYL5dhrLnSJM6X1Wby3LgN2s+T0oauHOfz5zSlS5cdfQp15DlpU6uSvPlTpVaiP5cJ/UqRK8ykZDWafTkurUasMJu5zXhOKkxrc8viXJaXolGY2/pKLIcTbb6xghH+fRkxX7Vl03YmNrjWI958z1BOazt5YN24h3FW60yw6clzHWFKJp2arTWciDvjtAb35DPSBZvBnLbYI1XcAnv/ynwX+EDTRy8bf330ZGDjNps7hx5d+i/lwJlL/50dJ/GT0Kj+I4eG/Db07x6laT8J3eXdcTg542590pv7l9w7V4OdT3fO2IL5Z5tA63n0XGeV/TIaRDhFg1s0ODWWT20nSSgYOTiFN1CCDk6G3C+r5WPXSwfmRd9HBhX4i1h9fQaTVwSdI+BJ+ZFFoUcsGgQfTiV+leAvMBp0o4Fp/WjYQS4C5mNYABL04y891vRkiAh9mF6TGl2VVUlHLSPfViPuNpGVvpEzUjkQbjmmdNFEudA526CHU40PDRlXNfYtxFSYTpHkDZ9HPTONNdZss40100QzY3PLuEnROcJZJ+mcWGaEDaCTWtfMlzWdg82imf7UjDWVsuRNpKH+Ig2VX5VTjZwRmlpjoWCo0RapoNaMU2pDAQEAIfkECQQA+gAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6en5+foKCgoaGhoqKio6OjpKSkpaWlpqamqamprq6utra2vb29w8PDx8fHycnJysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzs7Oz8/P0NDQ0tLS1NTU1tbW19fX2dnZ29vb3t7e4eHh4+Pj5eXl5ubm5+fn6Ojo6enp6urq6+vr7Ozs7e3t7u7u7u7u7+/v8PDw8fHx8vLy8/Pz9PT09fX19vb29/f3+Pj4+Pj4+fn5+vr6/Pz8/f39/f39/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////CP4A9QkcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyJFjO3AdQw6MRoybyI7ZiKmkdlLjOZUwpbW82I4ZTJjRZlZMeRMmS50TpfWEOW7hOmfngBbkNpSYsnYKoanMppQg06HQEoK7CQ1qVX08e1Y72E5ZT2XrvuojedYrQWpDmblVWnPoWIJlh4JUq+9lT2YFw+LkO1BoT5MDbfZMS1jfurgDt/aU2Vig1J5F9cHFXFngOLsCFcN01nmgs55ZH4stLdDwTbBDM5e+evNctaGsBaq+me0yzKy59YlWGc33yuBrUYMOfvum2dXMmx5G3ly6yru5q1vHzlq7dO6lvf4TM04sZ3DXKqGRJx2cPDTxczvb/TydNX3e+oZSDj80LXnArA1HDIDiydbYfT4J5BdXpbF1017C9VfZbjABKBBtMVVGHjFUEfRcbYRJ5lx84smlVl7Q4fXhYF+hp9JTB4nHYVUuqgShQacNhdhMGP6m0DorwrSjSD2+yJhW0u2HknQ3JiQjMdLER5OD9TW0oUrMNFnROQImCFGNvx050TlgqqTkQ5slaaBD41zpI0VF/mUNOUZxI02XKVIETpDSQSONNdZkA6g10eA5lDJrUrSOm9Y12pQzYmK0p6OUNqUMeBq1Uw2flTbFTDVSepSNoZ0yMyRQ4FBDalPRZJPUhA3ZVKPeWdBEU02iEwUEACH5BAkEAPkALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKurq7CwsLW1tby8vMLCwsbGxsjIyMrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc7Ozs/Pz9HR0dTU1NbW1tjY2Nra2tzc3N/f3+Li4uTk5OXl5efn5+fn5+jo6Onp6enp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PLy8vT09Pb29vf39/n5+fv7+/39/f7+/v7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////////////wj+APMJHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Chx3LR1HEMOBHfsmDWRIa2VLDkOpcZqK0s6A+nS4rSYK6fVrIgN58pqNHdCHOezZDWhEtM5KwoOqcF16RRGY+q04DhnOhH29Nmt6sB1KlkeXLcUJzWvAs89iznT4NaYz4JWXYsTm8GyMc+hFUgUZ9uRPo/uFSiNK0G6MaMOzpfO57OB53xKWzwQJs6W+d6uLEdZYDmfJ/MVhtt5IOKSj/MFLi1Qc8l0n3E2ZR07ZjfXx+R29olt9MporAf6Lilt+LGzwfNZXmn8mN3kuHknz1y07vRu1WPODh7dOvTsK5/+c/drPHRwajiLp58+NSY13Mkb18WOkzNrkvXlxxTfeflKgacdAxxrASIXVkz2UVbbSl3l01dMglF2E056AeiTYoMtiBpB9LlHmX8lbZcPWT5hhlZkOKVGEG5xobVOgM49hddPaKHnl258FRWhUNHxV1Bzx4joEn44DYiQUlTVRCRbGCL0IE4NigTiZg0t6R6OFq0zZUk+KnRgihVidFV1k0G0pVFhTpTOhDpOBGROCT5Ujo3VmSdRdys9Uw04TR5kTjYwynbRmOCVFA012STaTaLVsAmeMyZalE57hVaanTR9XoTNjJZaCilK62zaaaXOYIMlR+AEOuoz3ZyK0jkW3dBp6TPWRJohNtRIw2lx2HSTqUQBAQAh+QQJBAD5ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKirq6uwsLC1tbW6urrAwMDExMTHx8fJycnKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Q0NDS0tLU1NTY2Njd3d3g4ODl5eXo6Ojq6urr6+vt7e3t7e3u7u7u7u7u7u7v7+/v7+/w8PDw8PDy8vLz8/P09PT19fX29vb4+Pj5+fn6+vr7+/v8/Pz9/f39/f3+/v7+/v7+/v7+/v7///////////////////////////////////////////////////8I/gDzCRxIsKDBgwgTKlzI8GC6cQ0jSpwoENw0ZNIoatw4kB22aMhCImPHsWREbNBEitRmsiVCdhdViqTmsuZAcCllqiRpsyU1nTKjnetpshpQkdNYEi1p9Gi1oUuZHoUGMapUoNR4Wt2o7ajSrRvZ5ZT5FazGnzrLmp04DqjatRHZgZRZDe5GazqhabUrcexKvhS7ypwGmGJMlekKS0ynk7DiiE1Vvn1M8KFAv8j0UjZ4rhrIjOx01t08UBtmdm1lViWdD5xOcHhlsu6o01rkkBlnC5QmkxpvlY5130Z2WORo3bGPhrSmW2By5ZMpY1P+t7lg6sybPz+aXXhjus3z/hXHiFZkbt1zjW8f2VwnNtcywelOrXJcaPCzh7P/LTLabLFBCaRfdHxdJ1J2jA3GGn8iJSbQeMhA9ViCKtF0k2ibQSgfQemJtBpgBobkX0HTyaQZYADK1F1HmCFjIV/l9bfXQCWSVSBQHxYEITIE9hRiSMcdlKKNYP2Y2YwGwZfWVkYis+FCMapUDZImsROlcRLpFxI0PU6Ek1MUaRnSNA5y1JlyQWZJXVJUKqTNjlhyJKZI0FSTo0HsgOMZdcikqZFpfIo4TTXWaKONNbYxqBw0T1Z5ZaCQztQmR+N0GGmg0GBjFTvWWHqpTtFgM6lN4Dx66TSNwpVOp59KU02ZDY+hlmhj1FgDzqgRBQQAIfkECQQA+AAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6en5+foKCgoaGhoqKio6OjpKSkpaWlpqamp6enrKystLS0u7u7wcHBxcXFyMjIysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nz8/P0NDQ0dHR0tLS1NTU19fX2tra3Nzc39/f4eHh5OTk5eXl5ubm5+fn6Ojo6enp6urq6+vr7Ozs7Ozs7e3t8PDw8vLy9fX19/f3+Pj4+fn5+/v7/Pz8/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////////////////////CP4A8QkcSLCgwYHnvF27Fi3aM2LhDkqcSLHiwXHXHhLbyBGixY8gKZ675qyjyY0RQ6oMOXLZyZcpV8qc6K3kS5gzcxYcp/EmTp06w7n0uXEZNGjTrFkrBzSnN6LEnFED17QqvmlEp42zalWaT2hMuVbF+vJZTLFAn76Udg5t1XA3qbmtOm6oSW9zq/bsiDdv2pdy/eo8Z7OjNMFArZ181hbxzHN2OZ51rFKxSWiUcxbmGDazynEnp3mWabnj1tEq90ZFrbLcycCsP6rtSDX2x9JFbYOkdln3R2i9fVcE3lG0cIqbiVk7TvHkcuYSnUPH563htIUkTT5njjsqcY7Gmf6T5Xg0OPPvG6Hx7ogZumqlJpdNdz6bY23h4E6CO/da/EmmqjnDXHLPCNQdMafpBppJ2gi0YHHCjcdRgskhqOBJAg50YDS6RSMdQpGhFBtc8TWm4WImZkbYhwStaNJho3llUoYG1ccRbI5JyFFfB6m2EY+C2ZgeReWE+CNiQhKzTIISkdhfXuudNJlESRITTYpVnePhS0BWpCNHZnEVjo8b4fiRjC9Fw6RM42z5UngqfVncmh+NIyd4OlXJkVT3TQQONRXe1ZRQUClpHXbXTNNQoUrSOVM5ZDIq6TOdWVWTpJhG1aVY1hiZaUfLbOfXOdYEiqkz1mCJ2DjaRHrTMxLaOOpZQkodpdEzRynljaoyBQQAIfkECQQA9wAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6en5+foKCgoaGhp6enrq6utra2vLy8wsLCxcXFyMjIycnJysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzs7Oz8/P0NDQ0tLS1NTU19fX2tra3Nzc4ODg4uLi4+Pj5OTk5ubm5+fn6Ojo6urq6urq6+vr7Ozs7e3t7e3t7u7u7+/v7+/v8fHx8/Pz9fX19/f3+Pj4+vr6+/v7/Pz8/f39/f39/v7+/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////////////////////////////CP4A7wkcSLCgwYHmwE17tuyXw4fNnE3zZu6gxYsYM5Kbpuyhx48el0GrmLGkyYHZmoFcuRLZyZcXzU1DxrLmx2cwcxIE19GmT4fedOY05+ynUZdCX2aj+XMZs2fTsmWbtrChQ5xJTT7ziewZuIzmvEH7mjXj1prMspEsy1bg2ZXMyLWde8/c24/IstGlW3Tls7V7y3pjqTdwW3JMPxY2zFYlyMWMs1pbCTmyUHOJHzqzzHYyXsCcdfb0SDa00ME3TWd17FGcaqHkQDJ7LRTaY9o6rT5UhnsoSGi9YaL2GDT4yWkgQRu/2PfhsuUnmaWGXhLkNOrVP17HjvE294vev/4ftC7eIkis5Qvqdjg7fcG7v3i7J4j84/ydIEvPN3f+/sDRDiGjXHDPqGWQbYphl02AzxQnUGwfNYMdawHKJZB0H1loHDiyEbRghNDB94uDAmXmUGWvcfiRfPSBJGBvmIWHEIBX9dbcQy8apGKCr3n2kTXMUabahx+1Z1GMMjJGpEc5XrSkRyjS9eRDJF4kokPODJgVUSwBd9KVvyCjX1lLsZQlTGD+8oxrWZFD4XQ5pflLM1FiZE5KNqGn040rKQMNRRl584yJ/QlG6ErLQBXVVM80QyNLec1lDoZGVXqTlklZc6ilLCkzJl3mWPMop0xuF5o3lJKKZZ2WkQPNehQ/KTONhsaFNY0zqTqU6DTgYPpSQAAh+QQJBAD3ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+ioqKmpqarq6uysrK5ubm+vr7Dw8PGxsbIyMjKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Pz8/Q0NDR0dHT09PV1dXY2Njc3Nzf39/h4eHj4+Pk5OTk5OTl5eXl5eXl5eXm5ubm5ubn5+fo6Ojp6enq6urq6urr6+vs7Ozu7u7w8PDx8fHy8vLz8/P09PT19fX39/f6+vr7+/v8/Pz8/Pz9/f3+/v7+/v7+/v7///////////////////////////////////////////////////////////////////8I/gDvCRxIsKBBguOuMWPWq6HDhde0nTtIsaLFi+YUOtzIcaMyaOAuihxJ0JuyjihT9lKmTR3JlwXVXTumsibKY9dcwiQ506bPmyF3Wjy37KdRlMwmCjUIjqbPZc2oSfUmFRrDp0sLXrOpzJk3nRXFUSua0lzWgVdTMhMnVJyzjtrOCnyb0pnSrOfSMpN7D1pKZWb5CgSn7BjYpd5SNjssWN3dpeBSxhVMeeA5pxy9Vd58L+1GzZwpR+7oLDRldZgdljYt2C9HZYxZC0XdMajss9o6NrvN9yTHx7x3jt64OvhSuhvZGl/q2+Gy5UvPdaQGXWhujsqrv6TWUftOz732/np/CR7a+JfTz5NMr15kR9DtLbKPX3E+/YP27xcEv1v/QfDP+WcQdxzF5p847wloEGkK7vdagwQRmByEApnTkXgUNucQcAImxlFxEKbWUGAQSugQbBTSxlF/0LVEkokOTWbcW4CRRFZmxnnYkIxDidgQfKzp6NBiIg33oWzX1TYSjKoZeJY6zaQE5EXgnWgbX+ZouJF5MCF3IYcwmePlkUK5Vld2L4lT5UYsCiUkSspcM85F53gDzY0pcXlWUz8x48w1gAbajJYpHYPmWXkdpehDTmbF56I+HUOdaepQ4yOkDSlDTaOnaUOoospMGRw40HyqEjPUHKrdOdpQsxBHCccw04w2JMoVEAAh+QQJBAD4ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6hoaGlpaWrq6uxsbG4uLi+vr7Dw8PGxsbJycnKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Pz8/Q0NDS0tLU1NTX19fZ2dnb29vc3Nzd3d3f39/g4ODi4uLj4+Pk5OTl5eXl5eXm5ubm5ubn5+fo6Ojo6Ojp6enq6urr6+vs7Ozt7e3v7+/x8fH09PT29vb4+Pj5+fn7+/v9/f3+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////////////////////////8I/gDxCRxIsKDBgea4YWPGrJfDhwyxjTtIsaLFi/jCSUv2sKPHjsy4kcNIsiQ6bhw/qlyZ7FvJlwbRSTu2smbNY9jQwXwZjqbNnytx7rxoriHQoyuVmRt6sOdRZtKsWfsm1ZozZUePhWNK8NtPZdbEEf0GLWVNbFzxSbMJTexOcUZXMmMKraazpWnN1V0JbWdcj8m2piVIzqxHaS+t8dU5uCA6ZytdYgzHt3FFbisFVzTn06NkyxS9fpxrEevHz6BDH2ZMUfFHbqkx7tV6EV3nh85ik4TGjHVF1x2T+dZNcXjx2w5HEgctumPf5aANO8QLfbC40dUtA3/oNnvav72S/nlv/PH5eKbXPZ/nut2h8fUkwSuDzxR8bvo7P1rDn9/jfv4v6QdggOoNSJKABmKEYIIWgYcYgw16RBqErX1E4WUfdXchQeYsuCFB0s33YUFreaThiJR5ZN6IAknXC3UsYubRfSziY9tHmrHYXnjvUXijijUKlCKQQYLnEGofcqYSkhsO6RFsNTY3Y48MlvhRMspZFg6WoO2lEjRZMlWUQ8KBZiRIJ5IkjpcOPajdT8lA8w2VAo2DjYsO5TiYU0Ap4ww2gCqEDW9AHUMnTOaYhtSiEMGoHXKM1hQYdOhYA2mkDx1jzaGWfYPnoslww2ls5HADGajS6MmfOFYxgxxDB9Zw4yhTAQEAIfkECQQA+AAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6eoaGhpaWlq6ursbGxuLi4vr6+w8PDxsbGycnJysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzs7Oz8/P0NDQ0dHR1NTU1tbW2dnZ3Nzc39/f4ODg4eHh4uLi4+Pj5OTk5eXl5eXl5ubm6Ojo6enp6urq6urq6+vr7Ozs7e3t7u7u7+/v8fHx8/Pz9fX19vb2+Pj4+fn5+/v7/Pz8/f39/v7+/v7+/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////////////////CP4A8QkcSLCgwYHpwmF75uyXw4fNoGEbl+6gxYsYM56b1uyhx48el2E7l7GkSYLhGoJcyfJZuJMwDabTtoylTZvJsFWMeVJbsptAbS4bx1OjyqBIVz7bWbRguJ9BI1675s3bNWjOagZN5q0pwmdAl00Lx9TiOGhQbULzig/aTWddY6bzdnTl2qJuWUIrxxbfubof78LMCzIZ0b4DvaUNPLhlWcT40hFmXNIby7iQDVpe+RJjusUPMWfWvDLZ44JgQYoeTRqks4vjVq5m3fqjtoPptHoUTPtiao+mDV4rfLp3wc8gbxcE/Wu2cYOxPy4ruNnj6+clJzvsLBDwL5LYM/6Wcz3wHPnwJb2Dn6YafeWPzg6DDu4+Y81n3pimA8m7vsVyp0Xn0WH+8TTcRwU2pV0zCRbVkXUN8sRfhDGBdA2FMLWHoUkabpiRhR6WBGKIGAHWH4mofcQgihYd6FFxLIYDEncsErTfR9PUeNCDD02nY0HsfeQci+bB92NB3vF1pEAyUrYkPro9ROCR2hD3JHIfPfMkPlV2eKR3zV3JXJhLNumljto9tNSSaTrEFZs2OQMemjc1kx+dNyUDzZS4hTMkbU8htYwzEnmjDTbYQPOgj+6l81tSLClZ3zhRQupRjgWmc02lljKaYDiPWjpng+dsamkzfEaYzjhX8fiQMwfPXEMWZAEBACH5BAkEAPcALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKampq2trbW1tby8vMLCwsbGxsjIyMrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM7Ozs/Pz9DQ0NLS0tPT09PT09XV1dbW1tfX19nZ2dvb293d3d/f3+Hh4eLi4uPj4+Xl5ebm5ufn5+jo6Onp6erq6uvr6+3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09Pf39/v7+/7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////////////////////////wj+AO8JHEiwoMGB6cBp0yZN2jNgwJ41XAgu3cGLGDNqRKftIcSPIENG1IZOo8mTCLUxE8myJTBm2iyinEkwnTZlLnOyVKaNJk1wK3UKFckMnM+NHocqDflM5tGC5XDqVNawWrar2ao1lJpTWcmnA8HpZHZNnElx14K6NAq2Ws5qX2mic+uy2lNqLqU5fYpOmktqPumKfFYOrMFySUNemymWJbW9hhH6ZclWY7mWiyNjFBwy7kV0XEFW1nyxcUhlkAsm/jiadGmWzzCaBpnZtUbOrA+mU/sRsO2Tk0EyO5htcOrfulcDy1YwXWiIhZGfvHx6b/GQ0qTPDP6R+UDeEI/+az+IjujA8iHtjkeJG9jX6yA9r8+IHmQ3gauHz0cJPnY6kbXtp9E1IiUkklkCniUSOPBBpEyCKD2XDYEgZQehSdwtl6GFF2a0YYbqdbgZduB5J+JFDUYkkoknGpQiSyy2WFM5NNZYoowogYgjcNjtaBKFH3HoI4oiDZnRbBAhaKRB/ym25EX5PUmcSPJJWd9HIUr5HZVaEvSikFo6J1J0Xd7zYlNlCgQeMGBKiSREAWqpHDCtPSnmgmleCVKWbrb0WJntQUQYoHlVOSSQLMGl5ZshkaXkkFENJVE12tTZITpz5jUkUEq1KWM2z8FoZzZrghSjkeh0M+epdopzVUMFzLDqWkAAOwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="\n         width="<%= _loading_size %>" height="<%= _loading_size %>" alt="loading">\n</p>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(498),o={forCollectionView:function(e){var t=e.collection;t.loadingSupport=!0;var n=new t.model({loading:!0});return t.on({loading:function(){t.length>0||t.add(n,{at:0})},loaded:function(){t.remove(n)}}),o},forItemView:function(e){var t=e.model;return t.set({loading:!0},{silent:!0}),t.on({loading:function(){t.set({loading:!0},{silent:!0}),e.render()},loaded:function(){t.set({loading:null},{silent:!0}),e.render()}}),o},template:function(e,n){n=n||o.Size.MEDIUM;var s="<% try { if (loading) { %>"+i.replace(/<%= _loading_size %>/g,n)+"<% return __p; } } catch (e) {}%>"+e;return t.template(s)},getTemplate:function(e,n,s){return s=s||o.Size.MEDIUM,e?t.template(n):t.template(i)({_loading_size:s})},createFetch:function(e){return function(){var t=this;t.trigger("loading");var n=e.apply(this,arguments);return $.when(n).then((function(){t.trigger("loaded")})),n}},addTrigger:function(e,t){var n=e[t];return e[t]=function(){var e=this;e.trigger("loading");var t=n.apply(this,arguments);return $.when(t).then((function(){e.trigger("loaded")})),t},o},Size:{EXTRA_SMALL:16,SMALL:22,MEDIUM:32,LARGE:64}};return o}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(82),o=n(13),s=n(497),a=n(52),r=n(163);return t.extend({parse:function(e,t){e=a.camelizeKeys(e);var n=i.makeProfileThumbnailUrl(e.profileImageUrl);return{bandNo:e.bandNo,userNo:e.userNo,name:e.name,desc:e.description||e.desc,profileImageUrl:e.profileImageUrl,faceThumb:n,profileInnerClass:i.makeProfileInnerClass(n),role:s.parseRole(e.role),childMembershipId:e.childMembershipId||null,memberType:e.memberType,realName:e.realName,memberCertified:e.memberCertified,isMuted:e.isMuted}},isChildMember:function(){return!!this.get("childMembershipId")},isMyself:function(){return!this.isChildMember()&&this.get("userNo")===o.getUserData().getUserNo()},getMemberProfile:function(){return new r({name:this.get("name"),profileImageUrl:this.get("profileImageUrl"),memberType:this.get("memberType")})},getUserNo:function(){return this.get("userNo")},isMutedAuthor:function(){return this.get("isMuted")},getRole:function(){return this.get("role")},hasLeaderRole:function(){return this.getRole().name===s.LEADER},hasColeaderRole:function(){return this.getRole().name===s.CO_LEADER},hasLeaderOrColeaderRole:function(){return this.hasLeaderRole()||this.hasColeaderRole()}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){!function(e){e.fn.setLoading=function(t){var n={tag:'<div style="position:absolute;left:0;top:0;width:100%;height:100%"> <div class="loading_icon1"> <div class="bar" id="bar1"></div> <div class="bar" id="bar2"></div> <div class="bar" id="bar3"></div> <div class="bar" id="bar4"></div> <div class="bar" id="bar5"></div> <div class="bar" id="bar6"></div> <div class="bar" id="bar7"></div> <div class="bar" id="bar8"></div> <div class="bar" id="bar9"></div> <div class="bar" id="bar10"></div> <div class="bar" id="bar11"></div> <div class="bar" id="bar12"></div> </div> </div>',useLoading:!0,timeout:1e3,retryCount:10};return window.isMobileView&&(n.tag='<div style="position:absolute;left:0;top:0;width:100%;height:100%"><div class="uLoading"></div></div>'),t=e.extend({},n,t),this.each((function(){var n=e(this),i=n.attr("src"),o=e(t.tag);function s(){n.off("error",r),n.off("load",s),t.useLoading&&o.hide(),n.trigger("setLoading:beforeShow"),n.css({position:"",visibility:""}),n.trigger("setLoading:done")}n.css({position:"absolute",visibility:"hidden"}),t.useLoading&&n.after(o),n.off("load",s),n.on("load",s);var a=1;function r(){if(a>t.retryCount)return n.trigger("setLoading:fail"),void(t.useLoading&&o.hide());setTimeout((function(){i.indexOf("?")>-1?n.attr("src",i+"&_="+(new Date).getTime()):n.attr("src",i+"?_="+(new Date).getTime()),a++}),t.timeout)}n.on("error",r)}))}}(jQuery)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(34),o=n(21),s=n(13),a=n(511);return{_getLoginOrNoLoginClientWithToken:function(e){return this.apiClient||(!s.isLogedIn()&&e?this.apiClient=o.getNoLoginV1Client():this.apiClient=o.getLoginV1Client()),this.apiClient},getSchedules:function(e){var n={band_no:e.bandNo,start_at:e.startAt.format("YYYYMMDD"),calendars:i.stringify(e.calendars)};return e.pastEndAt&&(n.past_end_at=e.pastEndAt.format("YYYYMMDD")),e.futureEndAt&&(n.future_end_at=e.futureEndAt.format("YYYYMMDD")),t.has(e,"rsvpOnly")&&t.isBoolean(e.rsvpOnly)&&(n.rsvp_only=e.rsvpOnly),o.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1.6.0/get_schedules",data:n})},getUpcomingSchedules:function(e){var t={band_no:e.bandNo,limit:e.limit||5};return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1.6.0/get_upcoming_schedules",data:t})},getUpcomingLocalMeetupSchedules:function(e){return(s.isLogedIn()?o.getLoginV1Client():o.getNoLoginV1Client()).sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_upcoming_local_meetup_schedules",data:{band_no:e}}).fail((function(e){if(1071!==e.result_code)throw new Error("[result code: "+e.result_code+"] "+e.result_data.message)}))},getSchedule:function(e,n,i,o,s){var a={band_no:e,schedule_id:n,for_print:i||!1,token:o||null};return t.isEmpty(s)||(a.purpose=s),this._getLoginOrNoLoginClientWithToken(o).sendAndThenProcess({url:"https://api.band.us/v1.6.0/get_schedule",data:a})},checkScheduleCreation:function(e,t){var n={band_no:e,schedule:i.stringify(t)};return o.createLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v1.6.0/check_schedule_creation",type:"POST",data:n})},createSchedule:function(e,n,s,a,r,l,c){var d={band_no:e,schedule:i.stringify(n),announceable:!!s,purpose:a};return r&&l&&(d.source_band_no=r,d.source_schedule_id=l,t.isEmpty(c)||(d.copy_to_band_nos=c.join(","))),o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/create_schedule",method:"POST",data:d})},updateSchedule:function(e,t,n,s,a){var r={band_no:e,schedule_id:t,schedule:i.stringify(n),notify_to_members:!!s};return a&&(r.recurring_edit_type=a),o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.2/update_schedule",method:"POST",data:r})},deleteSchedule:function(e,t,n,i){return o.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1/schedule/delete_schedule",data:{band_no:e,schedule_id:t,repeat_edit_type:n,notify_to_members:i}})},copySchedule:function(e,t,n){return o.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1/schedule/copy_schedule",data:{band_no:e,schedule_id:t,target_band_nos:n.join(",")}})},getRsvpMembers:function(e,t,n,i){var s={band_no:e,schedule_id:t,rsvp_state:n};return n==a.CUSTOM&&(s.custom_state_id=i),o.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1.1.0/get_schedule_rsvp_members",data:s})},setExternalScheduleAlarm:function(e,t,n){var s={band_no:e,schedule_id:t,alarms:i.stringify(n)};return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_external_schedule_alarms",method:"POST",data:s})},setSchedulePersonalAlarm:function(e,t,n){var s={band_no:e,schedule_id:t,alarms:i.stringify(n)};return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_schedule_personal_alarms",method:"POST",data:s})},fetchScheduleHistory:function(e,t){var n={band_no:e,schedule_id:t};return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_schedule_history",data:n})},getScheduleRsvpStatesOfMembers:function(e,t){var n={band_no:e,schedule_id:t};return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.1/get_schedule_rsvp_states_of_members",data:n})},setScheduleRsvpStates:function(e,n,s,r,l){var c=t.map(s,(function(e){return t.has(e,"childMembershipId")?{user_no:e.userNo,child_membership_id:e.childMembershipId}:{user_no:e.userNo}})),d={band_no:e,schedule_id:n,target_users:i.stringify(c),rsvp_state:r};return r==a.CUSTOM&&(d.custom_state_id=l),o.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/set_schedule_rsvp_states",method:"POST",data:d}).then((function(e,t,n){return e}))},getScheduleRsvpMyChildMembers:function(e,t){var n={band_no:e,schedule_id:t};return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_schedule_rsvp_my_child_members",data:n})},getImportMySchedules:function(e){return o.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/get_my_band_schedules",data:{band_no:e}}).then((function(e,t,n){return e.result_data.items}))},sendScheduleEmailToMembers:function(e){return o.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/send_schedule_email_to_members",type:"POST",data:e})},getScheduleRsvpReplyHistory:function(e,t,n,i){var s={band_no:e,schedule_id:t,user_no:n};return i&&(s.child_membership_id=i),o.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/get_schedule_rsvp_reply_history",type:"GET",data:s})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(52),i=n(6),o=n(82),s=n(497),a=n(13),r=n(163);return i.Model.extend({parse:function(e){e=t.camelizeKeys(e);var n=o.makeProfileThumbnailUrl(e.profileImageUrl);return{bandNo:e.bandNo,userNo:e.userNo,name:e.name,desc:e.description,profileImageUrl:e.profileImageUrl,memberType:e.memberType,faceThumb:n,profileInnerClass:o.makeProfileInnerClass(n),role:s.parseRole(e.role),childMembershipId:e.childMembershipId?e.childMembershipId:null,realName:e.realName,memberCertified:e.memberCertified,isMuted:e.isMuted}},getUserNo:function(){return this.get("userNo")},getRole:function(){return this.get("role")},isMyself:function(){return this.get("userNo")===a.getUserData().getUserNo()},getMemberProfile:function(){return new r({name:this.get("name"),profileImageUrl:this.get("profileImageUrl"),memberType:this.get("memberType")})},getMemberType:function(){return this.get("memberType")},getUserNo:function(){return this.get("userNo")},getMemberDescription:function(){return this.get("desc")},isMutedAuthor:function(){return this.get("isMuted")},getChildMembershipId:function(){return this.get("childMembershipId")},getUserName:function(){return this.get("name")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i=n(13),o=n(536);return{_getApiClient:function(e){return i.isLogedIn()?e?t.getLoginV1ClientWithoutErrorAlert():t.getLoginV1Client():t.getNoLoginV1Client()},getCommentList:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.3.0/get_comments",data:e,method:"GET"})},getComment:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.3.0/get_comment",data:e,method:"GET"})},createComment:function(e){var t={band_no:e.bandNo,member_type:e.memberType,body:e.contents,pack_no:e.packNo,sticker_id:e.stickerId,photos:e.photos,file:e.file,video:e.video,content_key:e.contentKey,is_secret:e.isSecret,resolution_type:o.RETINA_RESOLUTION_TYPE};return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.3.0/create_comment",data:t,method:"POST"})},getCommentAudioUrl:function(e,t,n){var i={url:"https://api.band.us/v2.0.0/get_audio_url_by_comment",data:{band_no:e,content_key:t,is_https_enabled:!0},method:"GET"},o=this._getApiClient(n);return n?o.sendAndThenProcess(i):o.sendAndThenProcessWithErrorAlert(i)},deleteComment:function(e,t){var n={band_no:e,content_key:t};return this._getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v2.0.0/delete_comment",data:n,method:"GET"})},deleteComments:function(e,t){var n={band_no:e,content_keys:t};return this._getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v2.0.0/delete_comments",data:n,method:"POST"})},editComment:function(e){var t={resolution_type:o.RETINA_RESOLUTION_TYPE,content_key:e.contentKey,is_secret:e.isSecret,member_type:e.memberType};return e.hasOwnProperty("bandNo")&&(t.band_no=e.bandNo),e.hasOwnProperty("contents")&&(t.body=e.contents),e.hasOwnProperty("photos")&&(t.photos=e.photos),e.hasOwnProperty("file")&&(t.file=e.file),e.hasOwnProperty("dropbox_file")&&(t.dropbox_file=e.dropbox_file),e.hasOwnProperty("external_file")&&(t.external_file=e.external_file),e.hasOwnProperty("packNo")&&(t.pack_no=e.packNo),e.hasOwnProperty("stickerId")&&(t.sticker_id=e.stickerId),e.hasOwnProperty("video")&&(t.video=e.video),this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.3.0/update_comment",data:t,method:"POST"})},searchCommentsWithAuthor:function(e,t,n){var i={band_no:e,author_key:t,limit:20};return null!=n&&(i.after=n),this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.2.0/search_for_comments_with_author",data:i})},searchForCommentsWithPage:function(e,t){var n={band_no:e,limit:20};return null!=t&&(n.after=t),this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/search_for_comments_with_page",data:n})},searchMyComments:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.2.0/search_my_bands_for_my_comments",data:e})},hideCommentFromOthers:function(e,t){var n={band_no:e,content_key:t};return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/hide_comment_from_others",data:n,method:"POST"})},showCommentFromOthers:function(e,t){var n={band_no:e,content_key:t};return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/show_comment_from_others",data:n,method:"POST"})},searchMyBandsForComments:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.2.1/search_my_bands_for_comments",data:e})},getCommentFileUrl:function(e,t,n){var i={url:"https://api.band.us/v2.0.0/get_file_url_by_comment",data:{band_no:e,content_key:t,is_https_enabled:!0},method:"GET"},o=this._getApiClient(n);return n?o.sendAndThenProcess(i):o.sendAndThenProcessWithErrorAlert(i)}}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){return{RESET:"reset",INPUT_CLICK:"inputClick",BEFORE_VALIDATE:"beforeValidate",SELECT_FILES:"selectFiles",BEFORE_UPLOAD:"beforeUpload",UPLOAD_COMPLETE:"uploadComplete",FILE_PROGRESS:"fileProgress",FILE_COMPLETE:"fileComplete",FILE_ERROR:"fileError",FILE_PREPARE:"filePrepare"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{MAX_LENGTH:1e4,MAX_MENTION_COUNT:100,PREVIOUS_MORE_BUTTON_ID:-999,NEXT_MORE_BUTTON_ID:4294967296}}.apply(t,[]))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(486),s=n(1108),a={CANCEL:"modal:cancel",CONFIRM:"modal:confirm"},r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DConfirmModalView"},template:t.template(s),ui:{btnCancel:"._btnCancel",btnConfirm:"._btnConfirm"},events:{click:function(e){this.options.stopPropagation&&e.stopPropagation()},"click @ui.btnCancel":"_cancel","click @ui.btnConfirm":"_confirm"},initialize:function(e){this._validateOptions(e),this.model=new Backbone.Model({headerTitle:e.headerTitle,bodyTitle:e.bodyTitle,bodyDesc:e.bodyDesc,alignCenter:e.alignCenter,breakWordKeepAll:e.breakWordKeepAll?"-keepAll":"",width:e.width,confirm:e.confirm||IM("ui.label.confirm"),cancel:e.cancel||IM("ui.label.cancel")})},layerOnEscKeyDown:function(){this.isDestroyed()||this._cancel()},_validateOptions:function(e){!e.bodyTitle&&t.isEmpty(e.bodyDesc)&&console.error("One of bodyTitle or bodyDesc is required!!")},onAttach:function(){this.ui.btnConfirm.focus()},_confirm:function(){this.trigger(a.CONFIRM),this.destroy()},_cancel:function(){this.trigger(a.CANCEL),this.destroy()}});return r.EVENTS=a,r.openLayer=function(e){var t=new r(e);return e.withoutHiding?o.openWithoutHiding(t):o.open(t),t},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){var e={ATTENDANCE:"ATTENDANCE",PENDING_ATTENDANCE:"PENDING_ATTENDANCE",ABSENCE:"ABSENCE",MAYBE:"MAYBE",NONRESPONSE:"NONRESPONSE",CUSTOM:"CUSTOM",getRsvpStateText:function(t){var n="";switch(t){case e.ATTENDANCE:n=IM("schedule.rsvp.attendance");break;case e.PENDING_ATTENDANCE:n=IM("schedule.rsvp.pending_attendance");break;case e.ABSENCE:n=IM("schedule.rsvp.absentee");break;case e.MAYBE:n=IM("schedule.rsvp.maybe");break;case e.NONRESPONSE:n=IM("schedule.rsvp.nonresponse");break;case e.CUSTOM:n=IM("rsvp.custom.desc")}return n},getRsvpStatusInfoList:function(t){var n=[];return _.each(t,(function(t){var i=null;switch(t){case e.ATTENDANCE:i={itemName:e.ATTENDANCE,text:e.getRsvpStateText(e.ATTENDANCE)};break;case e.PENDING_ATTENDANCE:i={itemName:e.PENDING_ATTENDANCE,text:e.getRsvpStateText(e.PENDING_ATTENDANCE)};break;case e.ABSENCE:i={itemName:e.ABSENCE,text:e.getRsvpStateText(e.ABSENCE)};break;case e.MAYBE:i={itemName:e.MAYBE,text:e.getRsvpStateText(e.MAYBE)};break;case e.NONRESPONSE:i={itemName:e.NONRESPONSE,text:e.getRsvpStateText(e.NONRESPONSE)};break;case e.CUSTOM:i={itemName:e.CUSTOM,text:e.getRsvpStateText(e.CUSTOM)}}n.push(i)})),n}};return e}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i,o;i=[n(0),n(2),n(4),n(56)],void 0===(o=function(e,t,n,i){return new(n.Object.extend({initialize:function(){this.win=t(window),this.doc=t(document),this.doDetection=!0,this._lastScrollTop=this.win.scrollTop();var n=0;t.browser.msie&&t.browser.versionNumber<=9&&(n=300),this.detectScroll=e.bind((function(t){this._scrollTimer&&clearTimeout(this._scrollTimer);var i=e.bind((function(){if(this.doDetection){var e=this.win.scrollTop(),n=e-this._lastScrollTop;n>0?this.trigger("window:scroll:down",e,t):n<0&&this.trigger("window:scroll:up",e,t),this.trigger("window:scroll",e,t),this.isWindowScrollBottom()&&this.trigger("window:scroll:bottom",e,t),this._lastScrollTop=e}}),this);n?this._scrollTimer=setTimeout(i,n):i()}),this),this.win.on("scroll",this.detectScroll)},isWindowScrollBottom:function(){var e=this.doc.height(),t=this.win.height();return this.win.scrollTop()>e-t-this.win.height()/2},onDestroy:function(){this.win.off(this.detectScroll)},pauseDetection:function(){this.doDetection=!1},resumeDetection:function(){this.doDetection=!0},scrollToWithoutEvent:function(e,t){this.pauseDetection(),window.scrollTo(e,t),this.resumeDetection()}}))}.apply(t,i))||(e.exports=o)},function(e,t,n){var i,o;i=[n(2),n(0),n(56),n(173)],void 0===(o=function(e,t,n,i){return{DEFAULT_POPUP_SETTTINGS:{centerBrowser:0,centerScreen:0,height:500,left:0,location:0,menubar:0,resizable:0,scrollbars:0,status:0,width:500,windowName:null,windowURL:null,top:0,toolbar:0,params:{}},openWindowXSSSafely:function(){var e=Array.prototype.slice.call(arguments);e[0]=i.convertToSafeURI(e[0]),window.open.apply(window,e)},_openPopup:function(t){var n=t.width,i=t.height;e.browser.msie&&(n-=4,i-=4);var o,s,a="height="+i+",width="+n+",toolbar="+t.toolbar+",scrollbars="+t.scrollbars+",status="+t.status+",resizable="+t.resizable+",location="+t.location+",menuBar="+t.menubar;if(t.centerBrowser){e.browser.msie||e.browser.msedge?(o=window.screenTop-120+((document.documentElement.clientHeight+120)/2-t.height/2),s=window.screenLeft+((document.body.offsetWidth+20)/2-t.width/2)):(o=window.screenY+(window.outerHeight/2-t.height/2),s=window.screenX+(window.outerWidth/2-t.width/2));var r=window.open(t.windowURL,t.windowName,a+",left="+s+",top="+o);try{r.focus()}catch(e){}return r}if(t.centerScreen){o=(screen.height-t.height)/2,s=(screen.width-t.width)/2;r=window.open(t.windowURL,t.windowName,a+",left="+s+",top="+o);try{r.focus()}catch(e){}return r}r=window.open(t.windowURL,t.windowName,a+",left="+t.left+",top="+t.top);try{r.focus()}catch(e){}return r},openGet:function(n){var i=e.extend({},this.DEFAULT_POPUP_SETTTINGS,n||{});t.isEmpty(i.params)||(i.windowURL.indexOf("?")<0?i.windowURL=i.windowURL+"?"+e.param(i.params):i.windowURL=i.windowURL+"&"+e.param(i.params));var o=this._openPopup(i);if(o||navigator.userAgent.match(/crios/i))return o;alert(IM("web.noui.alert.guide_popup_block"))},openPost:function(t){var n=e.extend({},this.DEFAULT_POPUP_SETTTINGS,t||{},{windowURL:""});n.windowName=n.windowName||"popupWindow_"+(new Date).getTime();var i=this._openPopup(n);if(i){try{if(i.location.href.indexOf(t.windowURL)>-1)return void i.focus()}catch(e){}n.windowURL=t.windowURL,this._doSubmitUntilSuccess(n)}else alert(IM("web.noui.alert.guide_popup_block"))},_doSubmitUntilSuccess:function(e){try{this._doSubmit(e)}catch(n){setTimeout(t.bind(this._doSubmitUntilSuccess,this,e),500)}},_doSubmit:function(t){var n=document,i=document.createElement("form");e(document.body).append(i),i.method="post",t.windowName&&(i.target=t.windowName),i.action=t.windowURL,e.each(t.params,(function(e,t){var o=n.createElement("input");o.type="hidden",o.name=e,o.value=t,i.appendChild(o)})),i.submit(),setTimeout((function(){e(i).remove()}),100)}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(17),o=n(604),s=n(9),a=n(26),r=n(594),l=location.protocol+"//"+window.reportDomain+"/report/content",c=location.protocol+"//"+window.reportDomain+"/report/invitation",d=location.protocol+"//"+window.reportDomain+"/report/chat3",u=location.protocol+"//"+window.reportDomain+"/report/band";return new(t.Object.extend({openPostReportPopup:function(e){this._onBeforeOpenReportPopup();var t={contentType:"POST",bandNo:e.bandNo,contentNo:e.postNo,country:s.countryCode};t=this.addIsMobileParam(t);var n=i.appendParamsToURL(l,t);this._openReportPopup(n),this.listenToOnce(a.getExternalReportChannel(),a.EXTERNAL_EVENT.REPORT.CONTENTS_REPORTED,(function(t){var n=i.queryStringToObject(t);e.fnCallback(n)}))},openScheduleReportPopup:function(e){this._onBeforeOpenReportPopup();var t={contentType:e.contentType,bandNo:e.bandNo,scheduleId:e.scheduleId,schedulePhotoUrl:e.schedulePhotoUrl||null};t=this.addIsMobileParam(t);var n=i.appendParamsToURL(l,t);this._openReportPopup(n),this.listenToOnce(a.getExternalReportChannel(),a.EXTERNAL_EVENT.REPORT.CONTENTS_REPORTED,(function(t){var n=i.queryStringToObject(t);e.fnCallback(n)}))},openPhotoReportPopup:function(e,t){this._onBeforeOpenReportPopup();var n={contentType:"PHOTO",bandNo:e,contentNo:t,country:s.countryCode};n=this.addIsMobileParam(n);var o=i.appendParamsToURL(l,n);this._openReportPopup(o)},openReportPopupByContentKey:function(e,t){this._onBeforeOpenReportPopup();var n=_.extend({bandNo:e,country:s.countryCode},t.extractReportParams());n=this.addIsMobileParam(n);var o=i.appendParamsToURL(l,n);this._openReportPopup(o)},openChatReportPopup:function(e){this._onBeforeOpenReportPopup(),this.listenTo(a.getExternalReportChannel(),a.EXTERNAL_EVENT.REPORT.GET_CHAT_REPORT_MESSAGES,(function(t,n){r.sendPostMessage(n,a.CHANNEL_NAME.EXTERNAL_REPORT,a.EXTERNAL_EVENT.REPORT.CHAT_REPORT_DATA,e.reportData)}));var t=_.pick(e,"bandNo","isPage","isPageOwner","channelId","messageId","channelDeletePermission","liveId","messageTime");t.country=s.countryCode,t=this.addIsMobileParam(t);var n=i.appendParamsToURL(d,t);this._openReportPopup(n),this.listenToOnce(a.getExternalReportChannel(),a.EXTERNAL_EVENT.REPORT.CHAT_REPORTED,(function(t){var n=i.queryStringToObject(t);e.fnCallback(n)}))},openInvitationReportPopup:function(e){this._onBeforeOpenReportPopup();var t={invitationId:e.invitationCardId};t=this.addIsMobileParam(t);var n=i.appendParamsToURL(c,t);this._openReportPopup(n),this.listenToOnce(a.getExternalReportChannel(),a.EXTERNAL_EVENT.REPORT.INVITATION_REPORTED,(function(t){var n=i.queryStringToObject(t);e.fnCallback(n)}))},openBandReportPopup:function(e,t){this._onBeforeOpenReportPopup();var n=_.extend({},t,{bandNo:e});n=this.addIsMobileParam(n);var o=i.appendParamsToURL(u,n);this._openReportPopup(o)},openLiveReportPopup:function(e,t){this._onBeforeOpenReportPopup();var n={contentType:"LIVE",bandNo:e,liveId:t};n=this.addIsMobileParam(n);var o=i.appendParamsToURL(l,n);this._openReportPopup(o)},openMemberProfileReportPopup:function(e,t){this._onBeforeOpenReportPopup();var n={contentType:"PROFILE",bandNo:e,memberKey:t};n=this.addIsMobileParam(n);var o=i.appendParamsToURL(l,n);this._openReportPopup(o)},openBandMissionReportPopup:function(e,t,n){this._onBeforeOpenReportPopup();var o={contentType:"MISSION",bandNo:e,isRecruiting:t,missionId:n};o=this.addIsMobileParam(o);var s=i.appendParamsToURL(l,o);this._openReportPopup(s)},openBandApplicationReportPopup:function(e){this._onBeforeOpenReportPopup();var t={contentType:"APPLICANT",bandNo:e.bandNo,memberKey:e.memberKey},n=i.appendParamsToURL(l,t);this._openReportPopup(n),this.listenToOnce(a.getExternalReportChannel(),a.EXTERNAL_EVENT.REPORT.APPLICATION_REPORTED,(function(t){var n=i.queryStringToObject(t);e.fnCallback(n)}))},openBandApplicationCommentReportPopup:function(e){this._onBeforeOpenReportPopup();var t={contentType:"APPLICANT_COMMENT",bandNo:e.bandNo,memberKey:e.memberKey,contentCommentNo:e.contentCommentNo},n=i.appendParamsToURL(l,t);this._openReportPopup(n),this.listenToOnce(a.getExternalReportChannel(),a.EXTERNAL_EVENT.REPORT.APPLICATION_COMMENT_REPORTED,(function(t){var n=i.queryStringToObject(t);e.fnCallback(n)}))},addIsMobileParam:function(e){return e.isMobile=window.isMobile,e},_onBeforeOpenReportPopup:function(){this.stopListening(a.getExternalReportChannel())},_openReportPopup:function(e){o.openPopup("2003",e,{windowName:"band_report",width:400,height:332})}}))}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i=n(550),o=n(13),s=n(554),a=(n(493),n(160),{LIVE_WATCHER:"liveWatcher",VIDEO_WATCHER:"videoWatcher",NON_WATCHER:"nonWatcher"}),r=function(e){return o.isLogedIn()?e?t.getLoginV1ClientWithoutErrorAlert():t.getLoginV1Client():t.getNoLoginV1Client()};return{getVideoUrlByPhotoNo:function(e,t){var n={band_no:e,photo_no:t,quality:i.QUALITY_480,is_https_enabled:!0};return r().sendAndThenProcess({url:"https://api.band.us/v1.2.0/get_video_url_by_photo",data:n})},getVideoUrlByMessage:function(e,t){var n={channel_id:e,msg_id:t,is_https_enabled:!0};return r().sendAndThenProcess({url:"https://api.band.us/v1.1.0/get_video_url_by_message",data:n})},getVideoUrlByPost:function(e,t,n){var i={band_no:e,post_no:t,video_id:n,is_https_enabled:!0};return r().sendAndThenProcess({url:"https://api.band.us/v1.2.0/get_video_url_by_post",data:i})},getVideoUrlByComment:function(e,t,n){var i={band_no:e,content_key:t,video_information_fields:"sos_id",is_https_enabled:!0};return r(n).sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_video_url_by_comment",data:i})},getVideoUrls:function(e,n){var i={band_no:e,video_ids:n,is_https_enabled:!0};return t.getLoginV1Client().send({url:"https://api.band.us/v1.0.0/get_video_urls",data:i}).then((function(e,t,n){return e.result_data}))},cloneChatMessageVideo:function(e,n,i){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/clone_chat_message_video",data:{band_no:e,channel_id:n,message_no:i}})},getVideoUrlByBandMediaId:function(e,t){var n={band_no:e,id:t,https_enabled:!0};return r().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_video_url_by_band_media_id",data:n})},getVideoUrlByMissionExample:function(e,t,n,i,o){var a,l;return i===s.EXAMPLE_TYPE.GOOD_EXAMPLE?a="good":i===s.EXAMPLE_TYPE.BAD_EXAMPLE&&(a="bad"),l=e?"https://api.band.us/v2.0.0/get_video_url_by_recruiting_band_mission_example":"https://api.band.us/v2.0.0/get_video_url_by_mission_example",r().sendAndThenProcess({url:l,data:{band_no:t,mission_id:n,type:a,seq:o}})},WATCHER_TYPE:a,getEndedLiveVideoWatchers:function(e,t,n,i,o){var s=[{path:"/v2.0.0/get_live_viewed_members",params:{band_no:e,live_id:n}}];return t&&s.push({path:"/v2.1.0/get_video_view_states_of_members",params:{band_no:e,post_no:i,photo_no:o,video_id:t}}),r().sendBandApiBatchRequest(s).then((function(e){var t=(e=e||[])[0]||{},n=e[1]||{},i={},o=(t.result_data||{}).view_video_watcher_roles;_.each(t.result_data.members,(function(e){var t={watcher_types:[],view_percentage:{},initially_viewed_at:{}};t.watcher_types=[a.LIVE_WATCHER],t.view_percentage[a.LIVE_WATCHER]=e.view_time_percent,t.initially_viewed_at[a.LIVE_WATCHER]=e.initially_viewed_at,t.member=e,i[e.user_no]=t}));var s=(n.result_data||{}).view_video_watcher_roles,r=(n.result_data||{}).view_states||{},l=(n.result_data||{}).members;return _.each(l,(function(e){var t=e.user_no,n=i[t]||{watcher_types:[],view_percentage:{},initially_viewed_at:{}},o=r[t];!_.isEmpty(o)&&o.view_percentage>0&&(n.watcher_types.push(a.VIDEO_WATCHER),n.view_percentage[a.VIDEO_WATCHER]=o.view_percentage,n.initially_viewed_at[a.VIDEO_WATCHER]=o.initially_viewed_at),_.isEmpty(n.watcher_types)&&(n.watcher_types.push(a.NON_WATCHER),n.view_percentage[a.NON_WATCHER]=0),n.member=e,i[t]=n})),{is_every_member_included:(n.result_data||{}).is_every_member_included,view_video_watcher_roles:s,view_live_watcher_roles:o,watchers:_.values(i)}}))},getVideoWatchers:function(e,t,n,i){return r().sendAndThenProcess({url:"https://api.band.us/v2.1.0/get_video_view_states_of_members",data:{band_no:e,post_no:n,photo_no:i,video_id:t}}).then((function(e){var t=e.view_video_watcher_roles,n=e.view_states,i=e.members,o=_.map(i,(function(e){var t=[],i={},o={},s=n[e.user_no];return!_.isEmpty(s)&&s.view_percentage>0&&(t.push(a.VIDEO_WATCHER),i[a.VIDEO_WATCHER]=s.view_percentage,o[a.VIDEO_WATCHER]=s.initially_viewed_at),_.isEmpty(t)&&(t.push(a.NON_WATCHER),i[a.NON_WATCHER]=0),{watcher_types:t,view_percentage:i,initially_viewed_at:o,member:e}}));return{is_every_member_included:e.is_every_member_included,view_video_watcher_roles:t,watchers:o}}))},viewVideo:function(e){var n={band_no:e.bandNo,video_id:e.videoId,percentage:e.percentage,this_time_percentage:e.thisTimePercentage};return e.postNo?n.post_no=e.postNo:n.photo_no=e.photoNo,t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v2.0.1/view_video",data:n})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(52),s=n(490),a=n(152),r=(n(599),n(179)),l=n(520),c=n(504),d=n(161),u=n(806),h=n(807),p=n(808),m=n(809),_=n(810),g=n(811),f=n(812),b=n(813),v=n(814),A=n(616),E=n(815),T=n(816),C=n(707),y=n(818),M=n(819),I=n(820),S=n(821),w=n(822),N=n(823),D=n(824),L=(n(22),n(688)),O=n(825),P=n(689),x=n(602),R=n(13);function k(e,t){return[e,t].join("_")}var B=a.POST_ATTACHMENT_TYPE,V=i.Model.extend({defaults:function(){return{band:null,postNo:null,author:null,attention:null,viewType:!1,emotionCount:0,commonEmotionType:null,emotionTypeByViewer:null,commentCount:0,readCount:0,memberReadCount:0,photoCount:0,videoCount:0,sharedCount:0,fileAllCount:0,fileCount:0,dropboxFileCount:0,externalFileCount:0,addonCount:0,audioCount:0,todoCount:0,todoV2Count:0,todoAllCount:0,pollCount:0,pollV2Count:0,pollAllCount:0,isMajorNotice:!1,isNotice:!1,isLinkedBandNotice:!1,copiableState:null,isBookmarked:!1,isRestricted:!1,isShareable:!1,isTranslatable:!1,writtenIn:null,webUrl:null,createdAt:(new Date).getTime(),shouldDisableComment:!1,content:null,attachment:this._makeDefaultAttachment(),featuredComment:null,mission:null,bandNoticeUnsetAt:null,bandNoticeTimeZoneId:null,isVisibleOnlyToAuthor:null,isRecoverableByViewer:null,punishedAt:null}},_makeDefaultAttachment:function(){return{billSplit:null,todo:null,poll:null,sharedPostSnippet:null,photoAlbum:null,subpost:null,sticker:new i.Collection(null,{model:g}),mediaAll:new i.Collection,video:new i.Collection(null,{model:h}),photo:new i.Collection(null,{model:u}),promotionPhoto:new i.Collection(null,{model:y}),fileAll:new i.Collection,file:new i.Collection(null,{model:f}),dropboxFile:new i.Collection(null,{model:b}),externalFile:new i.Collection(null,{model:v}),snippet:new i.Collection(null,{model:E}),attendanceCheck:new i.Collection(null,{model:w}),location:new i.Collection(null,{model:A}),todoV2:new i.Collection(null,{model:m}),todoAll:new i.Collection(null,{model:m}),pollV2:new i.Collection(null,{model:p}),pollAll:new i.Collection(null,{model:p}),signup:new i.Collection(null,{model:N}),addon:new i.Collection(null,{model:D}),audio:new i.Collection(null,{model:O}),scheduleGroup:new i.Collection(null,{model:C}),quiz:new i.Collection(null,{model:P}),survey:new i.Collection(null,{model:x})}},parse:function(e,n){e=o.camelizeKeys(e);var i=a.findPriorRestriction({isRestricted:e.isRestricted,isVisibleOnlyToAuthor:e.isVisibleOnlyToAuthor,isMutedAuthorPost:!!e.author&&e.author.isMuted});i&&(i===a.RESTRICTION_TYPE.HIDE_POST&&(e.content=IM("post.hidden_post.guide_message"),e.attachment={}),i===a.RESTRICTION_TYPE.MUTE_AUTHOR&&(e.content=IM("post.muted_author_post.guide_message"),e.attachment={}));var s=t.extend(this.defaults(),{id:k(e.band.bandNo,e.postNo),postNo:e.postNo,attention:e.attention,viewType:e.viewType||!1,emotionCount:e.emotionCount||0,commonEmotionType:e.commonEmotionType,commentCount:e.commentCount||0,readCount:e.readCount||0,memberReadCount:e.memberReadCount||0,photoCount:e.photoCount||0,videoCount:e.videoCount||0,sharedCount:e.sharedCount||0,isMajorNotice:e.isMajorNotice||!1,isNotice:e.isNotice||!1,isLinkedBandNotice:e.isLinkedBandNotice||null,isBookmarked:e.isBookmarked||!1,isRestricted:e.isRestricted||!1,isShareable:e.isShareable||!1,copiableState:e.copiableState,isTranslatable:e.isTranslatable||!1,writtenIn:e.writtenIn,webUrl:e.webUrl,createdAt:e.createdAt,content:e.content,featuredComment:e.featuredComment,isRecommendedFeed:e.isRecommendedFeed||!1,contentLineage:e.contentLineage,bandNoticeUnsetAt:e.bandNoticeUnsetAt,bandNoticeTimeZoneId:e.bandNoticeTimeZoneId||null,shouldDisableComment:e.shouldDisableComment,isVisibleOnlyToAuthor:e.isVisibleOnlyToAuthor,isRecoverableByViewer:e.isRecoverableByViewer,punishedAt:e.punishedAt});return e.band&&(e.band.name?s.band=d.createBandCoreWithAction(e.band):s.band=d.createUnreachableBandCoreWithAction(e.band.bandNo)),e.author?(s.author=new c(e.author,{parse:!0}),s.isAuthor=R.getUserData().getUserNo()===s.author.get("userNo")):s.author=new c({faceThumb:r.PROFILE_DEFAULT_R1.make()}),e.viewType?e.viewType===a.VIEW_TYPE_BIRTHDAY?(s.authorName=IM("web.post.author.label.type_birthday",{userName:s.author.get("name")}),s.authorFaceThumb=r.PROFILE_BIRTHDAY.make()):(s.authorName=IM("web.post.author.label.type_anniversary"),s.authorFaceThumb=r.PROFILE_BIRTHDAY.make()):(s.authorName=s.author.get("name"),s.authorDesc=s.author.get("desc"),s.authorFaceThumb=s.author.get("faceThumb")),e.emotionByViewer&&(s.emotionTypeByViewer=e.emotionByViewer.type),t.isEmpty(e.attachment)||(s.attachment=t.extend(s.attachment,this._parseAttachment(e.attachment,{bandNo:e.band.bandNo,postNo:s.postNo,isAuthor:s.isAuthor}))),e.mission&&(s.mission=new L(e.mission,{parse:!0})),s.fileCount=s.attachment.file.length,s.dropboxFileCount=s.attachment.dropboxFile.length,s.externalFileCount=s.attachment.externalFile.length,s.fileAllCount=s.attachment.fileAll.length,s.todoCount=s.attachment.todo?1:0,s.todoV2Count=s.attachment.todoV2.length,s.todoAllCount=s.attachment.todoAll.length,s.pollCount=s.attachment.poll?1:0,s.pollV2Count=s.attachment.pollV2.length,s.pollAllCount=s.attachment.pollAll.length,s.addonCount=s.attachment.addon.length,s.audioCount=s.attachment.audio.length,s},_parseAttachment:function(e,n){var o={};if(e.billSplit&&(o.billSplit=new _(t.extend(e.billSplit,n),{parse:!0})),this._parseScheduleAttachment(e,n,o),this._parseTodoAttachment(e,n,o),this._parsePollAttachment(e,n,o),e.sharedPostSnippet&&(o.sharedPostSnippet=new I(e.sharedPostSnippet,{parse:!0})),e.sharedPagePostSnippet&&(o.sharedPagePostSnippet=new S(e.sharedPagePostSnippet,{parse:!0})),e.photoAlbum&&(o.photoAlbum=new M(e.photoAlbum,{parse:!0})),e.subpost&&(o.subpost=new T(e.subpost,{parse:!0})),t.isEmpty(e.sticker)||(o.sticker=new i.Collection(e.sticker,{model:g,parse:!0})),t.isEmpty(e.video)||(o.video=new i.Collection(e.video,{model:h,parse:!0}),o.mediaAll=o.mediaAll||new i.Collection,o.mediaAll.add(o.video.models)),t.isEmpty(e.promotionPhoto)||(o.promotionPhoto=new i.Collection(e.promotionPhoto,{model:y}),o.mediaAll=o.mediaAll||new i.Collection,o.mediaAll.add(o.promotionPhoto.models)),t.isEmpty(e.photo)||(o.photo=new i.Collection(e.photo,{model:u,parse:!0}),o.mediaAll=o.mediaAll||new i.Collection,o.mediaAll.add(o.photo.models)),t.isEmpty(e.file)||(o.file=new i.Collection(e.file,{model:f,parse:!0}),o.fileAll=o.fileAll||new i.Collection,o.fileAll.add(o.file.models)),t.isEmpty(e.dropboxFile)||(o.dropboxFile=new i.Collection(e.dropboxFile,{model:b,parse:!0,validate:!0}),o.fileAll=o.fileAll||new i.Collection,o.fileAll.add(o.dropboxFile.models)),t.isEmpty(e.externalFile)||(o.externalFile=new i.Collection(e.externalFile,{model:v,parse:!0,validate:!0}),o.fileAll=o.fileAll||new i.Collection,o.fileAll.add(o.externalFile.models)),t.isEmpty(e.snippet)||(o.snippet=new i.Collection(e.snippet,{model:E,parse:!0})),t.isEmpty(e.attendanceCheck)||(o.attendanceCheck=new i.Collection(e.attendanceCheck,{model:w,parse:!0})),t.isEmpty(e.location)||(o.location=new i.Collection(e.location,{model:A,parse:!0})),t.isEmpty(e.signup)||(o[B.SIGNUP]=new i.Collection(t.map(e.signup,(function(e){return t.extend(e,n)})),{model:N,parse:!0})),t.isEmpty(e.addon)||(o.addon=new i.Collection(e.addon,{model:D,parse:!0})),!t.isEmpty(e.audio)){var s=t.sortBy(e.audio,"seq");o[B.AUDIO]=new i.Collection(t.map(s,(function(e){return t.extend(e,n)})),{model:O,parse:!0})}return t.isEmpty(e.quiz)||(o.quiz=new i.Collection(e.quiz,{model:P,parse:!0})),t.isEmpty(e.survey)||(o.survey=new i.Collection(e.survey,{model:x,parse:!0})),o},_parsePollAttachment:function(e,n,o){e.poll&&(o.poll=new p(t.extend(e.poll,n),{parse:!0}),o.pollAll=o.pollAll||new i.Collection,o.pollAll.add([o.poll])),t.isEmpty(e.pollV2)||(o.pollV2=new i.Collection(e.pollV2,{model:p,parse:!0}),o.pollAll=o.pollAll||new i.Collection,o.pollAll.add(o.pollV2.models))},_parseTodoAttachment:function(e,n,o){e.todo&&(o.todo=new m(t.extend(e.todo,n),{parse:!0}),o.todoAll=o.todoAll||new i.Collection,o.todoAll.add([o.todo])),t.isEmpty(e.todoV2)||(o.todoV2=new i.Collection(e.todoV2,{model:m,parse:!0}),o.todoAll=o.todoAll||new i.Collection,o.todoAll.add(o.todoV2.models))},_parseScheduleAttachment:function(e,n,o){if(e.schedule&&(e.scheduleGroup=e.scheduleGroup||[],e.scheduleGroup.splice(0,0,{schedules:[e.schedule],seq:0})),e.scheduleGroup){var s=t.map(e.scheduleGroup,(function(e){return t.extend(e,{schedules:t.map(e.schedules,(function(e){return t.extend(e,{bandNo:n.bandNo})}))},n)}));o.scheduleGroup=new i.Collection(s,{model:C,parse:!0})}},isMutedAuthorPost:function(){var e=this.getAuthor();return!!e&&e.isMutedAuthor()},isRestricted:function(){return this.get("isRestricted")},toJSON:function(){var e=s.toRecursiveJSON(this),n={};return t.each(e.attachment,(function(t,i){n[i]=e.attachment[i]?t.toJSON():null})),e.attachment=n,e},fetchPostListItem:function(){return l.getPostsItem(this.getBandNo(),this.getPostNo()).then(t.bind((function(e){e.post.contentLineage=this.get("contentLineage"),this.set(this.parse(e.post))}),this))},fetchPostWithoutPostNo:function(e){return l.findPostWithoutPostNo(e).then(t.bind((function(e){e.post&&this.set(this.parse(e.post))}),this))},destroyPost:function(){return l.deletePost(this.get("band").bandNo,this.get("postNo"))},getBand:function(){return this.get("band")},getBandCore:function(){return this.get("band")},getBandNo:function(){return this.getBand().bandNo},getBandName:function(){return this.getBand().name},getPostNo:function(){return this.get("postNo")},getAuthor:function(){return this.get("author")},getAttachment:function(e){return this.get("attachment")[e]},getTodoAll:function(){return this.get("attachment").todoAll},getPollAll:function(){return this.get("attachment").pollAll},getFileAll:function(){return this.get("attachment").fileAll},getMediaAll:function(){return this.get("attachment").mediaAll},getAddon:function(){return this.get("attachment").addon},getCommentCount:function(){return this.get("commentCount")},getEmotionCount:function(){return this.get("emotionCount")},getFeaturedComment:function(){return this.get("featuredComment")},countOccupatingAttachmentType:function(){return t.filter([this.hasPollAll(),this.hasTodoAll(),this.hasFileAll(),this.hasBillSplit(),this.hasLocation(),this.hasScheduleGroup(),this.hasPhotoAlbum(),this.hasMediaAll(),this.hasAddon(),this.hasPromotionPhoto(),this.hasSnippet(),this.hasSharedPostSnippet(),this.hasAttendanceCheck(),this.hasSignup(),this.hasAudio()],t.identity).length},isAuthorProfileExist:function(){return this.get("viewType")!==a.VIEW_TYPE_ANNIVERSARY},hasAttachment:function(e){if(!e)return t.some(t.values(B),t.bind((function(e){return this.hasAttachment(e)}),this));var n=this.getAttachment(e);return!!n&&(!(n instanceof i.Collection)||n.length>0)},getAttendanceCheckCount:function(){return this.getAttachment(B.ATTENDANCE_CHECK).length},hasPhotoAlbum:function(){return this.hasAttachment(B.PHOTO_ALBUM)},hasScheduleGroup:function(){return this.hasAttachment(B.SCHEDULE_GROUP)},hasBillSplit:function(){return this.hasAttachment(B.BILL_SPLIT)},hasSharedPostSnippet:function(){return this.hasAttachment(B.SHARED_POST_SNIPPET)},hasSticker:function(){return this.hasAttachment(B.STICKER)},hasPhoto:function(){return this.hasAttachment(B.PHOTO)},hasPromotionPhoto:function(){return this.hasAttachment(B.PROMOTION_PHOTO)},hasVideo:function(){return this.hasAttachment(B.VIDEO)},hasMediaAll:function(){return this.getMediaAll().length>0},hasFileAll:function(){return this.getFileAll().length>0},hasPollAll:function(){return this.getPollAll().length>0},hasPollV2:function(){return this.hasAttachment(B.POLL_V2)},hasPoll:function(){return!!this.getAttachment(B.POLL)},hasTodoAll:function(){return this.getTodoAll().length>0},hasTodoV2:function(){return this.hasAttachment(B.TODO_V2)},hasTodo:function(){return this.hasAttachment(B.TODO)},hasAddon:function(){return this.getAddon().length>0},hasAttendanceCheck:function(){return this.hasAttachment(B.ATTENDANCE_CHECK)},hasSnippet:function(){return this.hasAttachment(B.SNIPPET)},hasSubpost:function(){return this.hasAttachment(B.SUBPOST)},hasLocation:function(){return this.hasAttachment(B.LOCATION)},hasSignup:function(){return this.hasAttachment(B.SIGNUP)},hasAudio:function(){return this.hasAttachment(B.AUDIO)},getSignupCount:function(){return this.getAttachment(B.SIGNUP).size()},isMissionCertifiedPost:function(){return!!this.get("mission")},getMissionInfoForPost:function(){return this.get("mission")},getCopiableState:function(){return this.get("copiableState")}});return V.makeModelId=k,V}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(607),a=n(168),r=n(34),l=n(13),c=n(26),d=n(521),u=o.Collection.extend({model:s,fetchProfileSets:function(e,t){var n="user_profile_set_id,name,profile_image_url,is_default,is_page_default";return e&&(n+=",bands"),a.getProfileSets({fields:n}).then(i.bind((function(e){var n=e.items;return t&&(n=i.chain(n).each((function(e,t){e._order=(e.is_default?-1:1)*t})).sortBy("_order").value()),this.reset(n,{parse:!0}),this}),this))},getBandProfileSets:function(e,t){return this.chain().map((function(e){var t=e.toJSON(),n=i.omit(t,"bands"),o=t.userProfileSetId,s=o===this.after?3:o===this.before?1:2;return n.changeable=3!==s,i.map(t.bands,(function(e){return i.extend({bandNo:e.bandNo,bandName:e.name,cover:e.cover,certified:e.certified,bandType:e.type,bandProfileImage:e.profileImage,order:this.order+e.name},this.profile)}),{order:s,profile:n})}),{before:e.get("userProfileSetId"),after:t.get("userProfileSetId")}).flatten().sortBy("order").value()},setProfileSet:function(e,t){var n=this.get(e.get("userProfileSetId")).attributes,o=i.pluck(n.bands,"bandNo"),s=n.profileImageUrl,r={name:n.name,band_nos:i.union(o,t).join(",")};return s&&(r.profile_image_url=s),a.setProfileSet(r)},setProfileSets:function(){var e=this.chain().map((function(e){return i.size(e.get("bands"))>0||e.get("isDefault")?e.getSubmitParams():null})).compact().value();return a.setProfileSets({profile_set_relations:r.stringify(e)}).then(i.bind((function(){d.buildPersonalInfoAgreementData().setPersonalInfoAgreements(d.AGREE_TARGET.PROFILE_IMAGE).then(i.bind((function(){var e=l.getUserData(),t=this.getDefaultProfileSet().get("profileImageUrl");e.get("face")!==t&&(e.set("face",t),c.getDGlobalChannel().trigger(c.EVENT.REFRESH_GLOBAL_PROFILE,t))}),this))}),this))},hasDifference:function(){return this.some((function(e){return e.hasDifference()}))},getDefaultProfileSet:function(){return this.find((function(e){return e.get("isDefault")}))},getPageDefaultProfileSet:function(){return this.find((function(e){return e.get("isPageDefault")}))},hasOtherProfiles:function(e){return this.some((function(e){return e.get("userProfileSetId")!==this.userProfileSetId&&i.size(e.get("bands"))>0}),{userProfileSetId:e.get("userProfileSetId")})}});return u.fetchProfileSetCount=function(){var e=t.Deferred();return a.getProfileSets({fields:"user_profile_set_id"}).then((function(t){e.resolve(i.size(t.items))}),(function(){e.resolve(0)})),e.promise()},u.fetchProfileSets=function(e,t){return(new u).fetchProfileSets(e,t)},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(34),o=n(21),s=n(506),a=n(536);function r(e){e.done((function(e){e.result_data.message&&alert(e.result_data.message)})),e.fail((function(t){return e}))}var l={syncChannel:function(e,t){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.2/sync_chat_channel",data:{channel_id:e,since:t,resolution_type:a.RETINA_RESOLUTION_TYPE}})},quitChannel:function(e){return o.getLoginV1Client().send({url:"https://api.band.us/v1/chat/quit_channel",data:{channel_id:e}})},leaveChannel:function(e){return o.getLoginV1Client().send({url:"https://api.band.us/v1.1/chat/leave_channel",data:{channel_id:e}})},joinChannel:function(e,t){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/join_chat_channel",data:{band_no:e,channel_id:t}})},banChat:function(e){return o.getLoginV1Client().send({url:"https://api.band.us/v1.0.0/ban_chat",data:e}).then((function(e){return e.result_data}))},getAllChatChannels:function(){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_all_chat_channels"})},getChatChannels:function(e){return o.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_chat_channels",data:{band_no:e}})},getOpenChatChannels:function(e){return o.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_open_chat_channels",data:{band_no:e}})},_MAX_READCOUNT_REQUEST_COUNT:200,sendMessageWithExtras:function(e,t,n,a){var r={channel_id:e,message_type:t,extras:i.stringify(n)};return a&&(r.message_tid=a),o.getLoginV1Client().send({url:"https://api.band.us/v1/chat/send_message",data:r}).then((function(e){return s.get(e,"result_data.message")}))},createChannel:function(e,t){var n=o.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/create_chat_channel",data:{band_no:e,invitee_nos:t.join(",")}});return r(n),n.then((function(e){return e.result_data}))},createOpenChatChannel:function(e,t,n,i){var s={band_no:e,name:t};n&&(s.description=n),i&&(s.profile_image_url=i);var a=o.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/create_open_chat_channel",data:s});return r(a),a.then((function(e){return e.result_data}))},inviteUsers:function(e,t,n){var i=o.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/invite_chat_users",data:{band_no:e,channel_id:t,invitee_nos:n.join(",")}});return r(i),i.then((function(e){return e.result_data}))},getAudioUrl:function(e,t){return o.getLoginV1Client().send({url:"https://api.band.us/v1.0.0/get_audio_url_by_message",data:{channel_id:e,msg_id:t,is_https_enabled:!0}}).then((function(e){return e.result_data}))},getChannelMembers:function(e,t){return o.getLoginV1Client().send({url:"https://api.band.us/v1/get_channel_members",data:{channel_id:e,user_nos:t.join(",")}}).then((function(e){return e.result_data}))},deleteMessages:function(e){return o.getLoginV1Client().send({url:"https://api.band.us/v1/chat/delete_messages",data:{channel_id:e}})},deleteChat:function(e){return o.getLoginV1Client().send({url:"https://api.band.us/v1.0.0/delete_chat_channel",data:{channel_id:e}})},setChatChannelNotice:function(e,t,n,i){return o.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1.1.0/set_chat_channel_notice",type:"POST",data:{channel_id:e,band_no:t,user_notice:n,message_no:i}})},unsetChatChannelNotice:function(e,t){return o.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1.0.0/unset_chat_channel_notice",type:"POST",data:{channel_id:e,band_no:t}})},hideChatMessage:function(e){return o.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v1.0.0/hide_chat_message",data:{band_no:e.bandNo,channel_id:e.channelId,message_no:e.messageNo}})},showChatMessage:function(e){return o.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v1.0.0/show_chat_message",data:{band_no:e.bandNo,channel_id:e.channelId,message_no:e.messageNo}})},getMessagePunishment:function(e,t,n){return o.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_message_punishment",data:{channel_id:e,band_no:t,message_no:n}})},getPageChatChannels:function(e){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_page_chat_channels",data:e})},talkToPage:function(e){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/talk_to_page",data:{band_no:e}})},talkToPageSubscriber:function(e,n){var i={band_no:e};return t.isNumeric(n)?i.subscriber_no=n:i.subscriber_key=n,o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/talk_to_page_subscriber",data:i})},pinPageChatChannel:function(e,t){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/pin_page_chat_channel",data:{band_no:e,channel_id:t}})},unpinPageChatChannel:function(e,t){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/unpin_page_chat_channel",data:{band_no:e,channel_id:t}})},getMessageReaders:function(e,t,n){return o.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_message_readers",data:{band_no:e,channel_id:t,message_no:n}})},recallChatMessage:function(e,t,n){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/recall_chat_message",data:{band_no:e,channel_id:t,message_no:n}})},getChatMembers:function(e){return o.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_chat_members",data:{channel_id:e}})},searchMemberWithChannel:function(e,t,n){return o.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v2.0.0/search_member_with_channel",data:{band_no:e,channel_id:t,query:n}})}};return l.SettingApi={setChatMessagePeriod:function(e,t){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1/set_chat_message_period",data:{channel_id:e,period:t}})},block:function(e){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1/block_chat",data:e})},unblock:function(e){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1/unblock_chat",data:e})},setChatChannelInfo:function(e,t,n,i,s){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1.0.0/set_chat_channel_info",data:{band_no:e,channel_id:t,name:n,description:i,profile_image_url:s}})},setMessageReadersVisibleState:function(e,t,n){return o.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_message_readers_visible_state",data:{band_no:e,channel_id:t,state:n}})}},l.ChannelList={setPinChatChannel:function(e){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/pin_chat_channel",data:{channel_id:e.channelId}})},setUnpinChatChannel:function(e){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/unpin_chat_channel",data:{channel_id:e.channelId}})},setReadedMessage:function(e){return o.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1/chat/ack_message",data:{channel_id:e.channelId,message_no:e.messageNo}})}},l.Config={DEFAULT_MESSAGE_RETRIEVING_COUNT:20,GET_MESSAGE_RETRIEVING_COUNT:20},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i=n(13),o=n(157),s=n(153),a=n(170),r=n(525),l=n(87),c=n(191),d=n(509),u={CREATE_POST:"/v2.0.1/create_post",UPDATE_POST:"/v2.0.1/update_post",DELETE_POST:"/v1.5.0/delete_post?version=20140508",DELETE_POSTS:"/v1.0.0/delete_posts",COPY_POST:"/v1.6.0/copy_post",GET_POST:"/v2.0.0/get_post",GET_POSTS:"/v2.0.0/get_posts",GET_RECENT_POSTS:"/v2.0.0/get_recent_posts",GET_POPULAR_POSTS:"/v2.0.0/get_popular_posts",GET_POSTS_ITEM:"/v2.0.0/get_posts_item",GET_POSTS_WITH_CREATED_AT:"/v2.0.0/get_posts_with_created_at",GET_POSTS_WITH_SCHEDULE:"/v2.0.0/get_posts_with_schedule",SEARCH_POSTS:"/v2.0.0/search_posts",SEARCH_FOR_POSTS_WITH_AUTHOR:"/v2.0.0/search_for_posts_with_author",SEARCH_MY_BANDS_FOR_MY_POSTS:"/v2.1.0/search_my_bands_for_my_posts",SEARCH_MY_BANDS_FOR_POSTS:"/v2.0.1/search_my_bands_for_posts",SEARCH_POSTS_WITH_PAGE:"/v2.0.0/search_for_posts_with_page",GET_HASHTAGS:"/v1.1.1/get_hashtags",SET_PINNED_HASHTAGS:"/v1.1.0/set_pinned_hashtags",SET_HASHTAGS_INTO_POST:"/v2.0.0/set_hashtags_into_post",SEARCH_FOR_POSTS_WITH_HASHTAG:"/v2.0.0/search_for_posts_with_hashtag",GET_POST_READERS:"/v1.0.0/get_post_readers",GET_BAND_NOTICE_READERS:"/v1.0.0/get_band_notice_readers",SEND_POST_EMAIL_TO_MEMBERS:"/v2.0.0/send_post_email_to_members",FIND_POST:"/v2.0.0/find_post",FIND_POSTS_ITEM:"/v2.0.1/find_posts_item",GET_ATTACHMENTS:"/v2.0.0/get_attachments",GET_ATTACHMENTS_WITH_CREATED_AT:"/v2.0.0/get_attachments_with_created_at",SEARCH_ATTACHMENTS:"/v2.0.0/search_attachments",SHOW_POST_FROM_OTHERS:"/v2.0.0/show_post_from_others",HIDE_POST_FROM_OTHERS:"/v2.0.0/hide_post_from_others"},h="top_notice",p={getApiClient:function(){return this.apiClient||(i.isLogedIn()?this.apiClient=t.getLoginV1Client():this.apiClient=t.getNoLoginV1Client()),this.apiClient},getResponseHandler:function(){return i.isLogedIn()?l:c},getPosts:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.GET_POSTS,data:e}).fail((function(){i.isLogedIn()?window.location.href=o.GLOBAL_HOME.makeUrl():a.goRefreshFallback()}))},getRecentPosts:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.GET_RECENT_POSTS,data:{band_no:e}})},getPopularPosts:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.GET_POPULAR_POSTS,data:e}).fail((function(){i.isLogedIn()?window.location.href=o.GLOBAL_HOME.makeUrl():a.goRefreshFallback()}))},getPostsWithSchedule:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.GET_POSTS_WITH_SCHEDULE,data:e}).fail((function(){i.isLogedIn()?window.location.href=o.GLOBAL_HOME.makeUrl():a.goRefreshFallback()}))},getPostsItem:function(e,t){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.GET_POSTS_ITEM,data:{band_no:e,post_no:t,resolution_type:4}})},searchPostWithComment:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.SEARCH_POSTS,data:e})},searchPostsWithAuthor:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.SEARCH_FOR_POSTS_WITH_AUTHOR,data:e})},searchMyPosts:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.SEARCH_MY_BANDS_FOR_MY_POSTS,data:e})},getPostWithCreatedAt:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.GET_POSTS_WITH_CREATED_AT,data:e})},getHashTagsWithPinned:function(e,t,n){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.GET_HASHTAGS,data:{band_no:e,is_only_pinned:t||!1,is_max_count:n||!0}}).then(m)},setPinnedHashtags:function(e,n){var i={band_no:e,hashtags:n};return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.SET_PINNED_HASHTAGS,data:i})},deletePost:function(e,n){var i={band_no:e,post_no:n};return t.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us"+u.DELETE_POST,type:"POST",data:i})},deletePosts:function(e,n){var i={band_no:e,post_nos:n.join(",")};return t.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us"+u.DELETE_POSTS,type:"POST",data:i})},copyPost:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.COPY_POST,type:"POST",data:e})},getRichPost:function(e,t,n){var o={band_no:e,post_no:t,resolution_type:4};return n&&(o.purpose=n),this.getApiClient().send({url:"https://api.band.us"+u.GET_POST,data:o}).then((function(e){return e.result_data.post}),(function(){i.isLogedIn()?s.GROUP_BAND_HOME.historyBackOrGoTargetUrl({band_no:e}):a.goRefreshFallback()}))},getRichPostQuietly:function(e,n){return(i.isLogedIn()?t.getLoginV1ClientWithoutErrorAlert():t.getNoLoginV1Client()).sendAndThenProcess({url:"https://api.band.us"+u.GET_POST,data:{band_no:e,post_no:n,resolution_type:4}})},getRichPostDetail:function(e,t,n,o){return this.getApiClient().sendBandApiBatchRequest([{path:u.GET_POST,params:{band_no:e,post_no:t,resolution_type:4,token:o}},{path:r.PATHS.GET_EMOTIONS,params:{band_no:e,content_key:d.buildPostKey(t).toApiParams(!0),token:o,post_no:t}}]).then(_.bind((function(e){return{post:e[0].result_data.post,emotions:e[1].result_data.emotions}}),this)).fail((function(t){i.isLogedIn()?n||s.GROUP_BAND_HOME.historyBackOrGoTargetUrl({band_no:e}):n||a.goRefreshFallback()}))},createRichPost:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.CREATE_POST,type:"POST",data:e})},updateRichPost:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.UPDATE_POST,type:"POST",data:e})},searchPostsWithHashtag:function(e,t,n){var i={band_no:e,hashtag:t};return n&&n.next_params&&(i.after=n.next_params.after),this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.SEARCH_FOR_POSTS_WITH_HASHTAG,data:i})},getPostReaders:function(e,n){var i={band_no:e,post_no:n};return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.GET_POST_READERS,data:i})},fetchBandNoticeReaders:function(e,n){var i={band_no:e,post_no:n};return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.GET_BAND_NOTICE_READERS,data:i})},findPostWithoutPostNo:function(e){var t={band_no:e,purpose:h};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+u.FIND_POSTS_ITEM,data:t}).fail((function(e){1e3==e.result_code&&alert(e.result_data.message)}))},searchMyBandsForPosts:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.SEARCH_MY_BANDS_FOR_POSTS,data:e})},sendPostEmailToMembers:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.SEND_POST_EMAIL_TO_MEMBERS,type:"POST",data:e})},searchPostsWithPage:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.SEARCH_POSTS_WITH_PAGE,data:e})},getAttachments:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.GET_ATTACHMENTS,data:e})},getAttachmentsWithCreatedAt:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.GET_ATTACHMENTS_WITH_CREATED_AT,data:e})},searchAttachments:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.SEARCH_ATTACHMENTS,data:e})},setHashtagsIntoPost:function(e,n,i){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.SET_HASHTAGS_INTO_POST,data:{band_no:e,post_no:n,hashtags:i}})},showPostFromOthers:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.SHOW_POST_FROM_OTHERS,data:{band_no:e,post_no:n}})},hidePostFromOthers:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u.HIDE_POST_FROM_OTHERS,data:{band_no:e,post_no:n}})}};p.PATHS=u;var m=function(e){return _.each(e,(function(e){e.hashtag=e.hashtag.replace(/</g,"").replace(/>/g,"")})),e};return p}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){var e=n(2),t=n(0),i=n(6),o=n(54),s=i.Model.extend({defaults:{birthday:!1,contacts:!1,email:!1,gender:!1,location:!1,phone_number:!1,profile_image:!1},initialize:function(){this._fetched=!1},fetchAgreementData:function(){return this._fetched?e.Deferred().resolve(this).promise():o.getPersonalInfoAgreements().then(t.bind((function(e){return this.set(e),this._fetched=!0,this}),this))},setPersonalInfoAgreements:function(e){return o.setPersonalInfoAgreements(e).then(t.bind((function(){return this._fetched=!1,this.fetchAgreementData()}),this))},cancelPersonalInfoAgreements:function(e,n){return o.cancelPersonalInfoAgreements(e,n).then(t.bind((function(){return this._fetched=!1,this.fetchAgreementData()}),this))},isContactsCollectable:function(){return this.get("contacts")},isEmailCollectable:function(){return this.get("email")},isGenderCollectable:function(){return this.get("gender")},isLocationCollectable:function(){return this.get("location")},isPhoneNumberCollectable:function(){return this.get("phone_number")},isProfileImageCollectable:function(){return this.get("profile_image")}});return s.AGREE_TARGET={BIRTHDAY:"birthday",CONTACTS:"contacts",EMAIL:"email",GENDER:"gender",LOCATION:"location",PHONE_NUMBER:"phone_number",PROFILE_IMAGE:"profile_image"},s.buildPersonalInfoAgreementData=function(){return new s},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i={none:"none",great:"great",funny:"funny",like:"like",shocked:"shocked",sad:"sad",angry:"angry",getLabel:function(e){switch(e){case i.great:return IM("emotion.facelist.btn.like");case i.funny:return IM("emotion.facelist.btn.smile");case i.like:return IM("emotion.facelist.btn.best");case i.shocked:return IM("emotion.facelist.btn.surprise");case i.sad:return IM("emotion.facelist.btn.sad");case i.angry:return IM("emotion.facelist.btn.angry");default:return null}},getIconName:function(e){switch(e){case i.great:return"like";case i.funny:return"smile";case i.like:return"best";case i.shocked:return"surprise";case i.sad:return"sad";case i.angry:return"angry";default:return null}},getDetailAttribute:function(e){var t=i.getIconName(e);return null==t?null:{type:e,iconName:t,label:i.getLabel(e)}},getDetailAttributes:function(e){return t.chain(e).map(i.getDetailAttribute,i).compact().value()},getChatEmotionTypeCode:function(e){switch(e){case i.none:return 0;case i.great:return 1;case i.funny:return 2;case i.like:return 3;case i.shocked:return 5;case i.sad:return 6;case i.angry:return 7;default:return null}},getChatEmotionType:function(e){switch(e){case 1:return i.great;case 2:return i.funny;case 3:return i.like;case 5:return i.shocked;case 6:return i.sad;case 7:return i.angry;default:return null}}};return i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(16),i=n(567),o=n(609),s=n(182);return{toISO:function(e){return e.isValid()?e.format("YYYY-MM-DD[T]HH:mm:ssZZ"):null},extractISODateString:function(e){return e.isValid()?e.format("YYYY-MM-DD"):null},getCalendarRange:function(e,n){null==n&&(n=i.DAYS.SUNDAY.getDayNumber());var s=t(e).startOf("month"),a=t(s).endOf("month"),r=i.getFirstDateOfWeek(s,n),l=i.getEndDateOfWeek(a,n);return new o(r,l)},countWeeksOf:function(e){var n=t(e).startOf("month").week();return t(e).endOf("month").week()-n+1},momentsBy:function(e,n,i,o){for(var s=t(e),a=t(n),r=[];s.isBefore(a);)r.push(t(s)),s.add(i,o);return r},getWeekOfMonth:function(e){var n=t(e),i=t(e).startOf("month");return n.diff(i,"week")+1},isLastWeekOfMonth:function(e){var n=t(e),i=t(n).endOf("month");return n.isSame(i,"week")},isLastDayOfMonth:function(e){return t(e).endOf("month").isSame(e,"day")},isSameOrBefore:function(e,t,n){return e.isSame(t,n)||e.isBefore(t,n)},isSameOrAfter:function(e,t,n){return e.isSame(t,n)||e.isAfter(t,n)},getRemainingTime:function(e,n,i,o,a){if(!e)return null;var r={format:null,value:null,close:!0},l=n?t.tz(t(e),n):t(e),c=n?t.tz(t(),n):t(),d=l-c,u=null,h=null;return d<=0||(d<36e5||1===a?(u="min",h=d<=6e4?1:s.nomalizeDecimal(d/6e4,i)):d<864e5||2===a?(u="hour",h=s.nomalizeDecimal(d/36e5,o)):(u="day",h=l.startOf("day").diff(c.startOf("day"),"days")),r.format=u,r.value=h,r.close=!1),r},startOfMinuteOfUnit:function(e,n){return(e=t(e).startOf("minute")).minute(Math.ceil(e.minute()/n)*n)},createMoment:function(e,n){if(!e||!n)throw new Error("invalid parameters");if(!(e.date+" "+e.time).trim())return null;var i=e.date+"T"+e.time,o=e.dateFormat+"T"+e.timeFormat;return n?t.tz(i,o,n):t(i,o)}}}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i;void 0===(i=function(e){var t={NORMAL:"NORMAL",BIRTHDAY:"BIRTHDAY",BAND_OPEN:"BAND_OPEN",HOLIDAY:"subscribed_calendar",EXTERNAL:"external",isNormal:function(e){return t.NORMAL==e},isBirthday:function(e){return t.BIRTHDAY==e},isBandOpen:function(e){return t.BAND_OPEN==e},isHoliday:function(e){return t.HOLIDAY==e},isExternal:function(e){return t.EXTERNAL==e}};return t}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(493),s=n(82),a=n(581),r=(n(160),t.Model.extend({defaults:{name:null,desc:null,profileImageUrl:null,userNo:0,selected:!1,mentionThumbnail:null,profileInnerClass:"",isKid:!1},idAttribute:"userNo",parse:function(e){var t=s.makeProfileThumbnailUrl(e.profile_image_url);return{name:e.name,desc:e.description,profileImageUrl:e.profile_image_url,userNo:e.user_no,selected:this.collection.selectedMembers.where({userNo:e.user_no}).length>0,mentionThumbnail:t,profileInnerClass:s.makeProfileInnerClass(t),isKid:e.is_kid}},getUserNo:function(){return this.get("userNo")},getName:function(){return this.get("name")},getDesc:function(){return this.get("desc")},getProfileImageUrl:function(){return this.get("profileImageUrl")},isKid:function(){return this.get("isKid")}})),l=t.Collection.extend({model:r,initialize:function(e,t){t&&(this.bandNo=t.bandNo,this.memberFilter=t.filter,this._memberCountLimit=t.memberCountLimit,this._param1=t.param1),this._hasMoreMember=!1,this._hasMemberGroup=!1},setMemberFilter:function(e){this.memberFilter=e},fetchBandMemberWithFilterDataCollection:function(){return o.getBandMembersOfBandWithFilter(this.bandNo,this.memberFilter,this._param1).then(i.bind((function(e){this._hasMoreMember=!1,e.member_count>this._memberCountLimit&&(this._hasMoreMember=!0),this._hasMemberGroup=e.has_member_group,this._resetCollectionAndTotalCount(e)}),this))},searchBandMemberWithFilterDataCollection:function(e){return o.searchMember(e,this.bandNo,this.memberFilter,this._param1).then(i.bind((function(e){this._hasMoreMember=!1,this._resetBandMemberWithFilterDataCollection(e)}),this))},_resetCollectionAndTotalCount:function(e){this._totalMemberCount=e.member_count,this._resetBandMemberWithFilterDataCollection(e)},_resetBandMemberWithFilterDataCollection:function(e){this.hasMoreMember()?this.reset(e.members.slice(0,this._memberCountLimit),{parse:!0}):this.reset(e.members,{parse:!0})},hasMoreMember:function(){return this._hasMoreMember},hasMemberGroup:function(){return this._hasMemberGroup},setSelectedMember:function(e,t){var n=this.get(e);t?this._selectMember(n):this._unselectMember(e,n)},setSelectedMemberGroupsMember:function(e){i.each(e,(function(e){this.get(e.userNo)?this._selectMember(this.get(e.userNo)):this._selectMember(new r(e))}),this)},toMemberSelectionViewModels:function(){return this.map((function(e){return a.buildMemberSelectionViewModelBy(e)}))},_selectMember:function(e){e&&(e.set("selected",!0),this.selectedMembers.add(e,{at:0}))},_unselectMember:function(e,t){this.selectedMembers.remove(e),t&&t.set("selected",!1)}});return l.Model=r,l.buildBandMemberWithFilterDataCollection=function(e,n,i,o){var s=new l([],{bandNo:e,filter:n,memberCountLimit:i=i||1e3,param1:o});return s.selectedMembers=new t.Collection(void 0,{model:r}),s},l}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(52),i=n(6),o=n(82),s=n(497),a=n(13),r=n(163),l=n(22),c=i.Model.extend({parse:function(e){e=t.camelizeKeys(e);var n=o.makeProfileThumbnailUrl(e.profileImageUrl);return{bandNo:e.bandNo,userNo:e.userNo,memberKey:e.memberKey,name:e.name,desc:e.description,profileImageUrl:e.profileImageUrl,memberType:e.memberType,faceThumb:n,profileInnerClass:o.makeProfileInnerClass(n),role:s.parseRole(e.role),childMembershipId:e.childMembershipId?e.childMembershipId:null,realName:e.realName,memberCertified:e.memberCertified,isMember:e.isMember,permittedOperation:e.permittedOperation,me:e.me||!1,isDeleted:e.isDeleted}},getUserNo:function(){return this.get("userNo")},getRole:function(){return this.get("role")},getBandNo:function(){return this.get("bandNo")},getName:function(){return this.get("name")},isMyself:function(){return this.get("userNo")===a.getUserData().getUserNo()},getMemberProfile:function(){return new r({name:this.get("name"),profileImageUrl:this.get("profileImageUrl"),memberType:this.get("memberType")})},getMemberType:function(){return this.get("memberType")},getContentAuthorMemberProfile:function(){return new r({name:this.getContentAuthorName(),profileImageUrl:this.getContentAuthorProfileImageUrl(),memberType:this.getContentAuthorMemberType()})},getContentAuthorMemberKey:function(){return this.get("memberKey")},getContentAuthorName:function(){return this.get("name")},getContentAuthorDescription:function(){return this.get("desc")},getContentAuthorProfileImageUrl:function(){return this.get("profileImageUrl")},getContentAuthorMemberType:function(){return this.get("memberType")},getContentAuthorRole:function(){return(this.get("role")||{}).name},getContentAuthorChildMembershipId:function(){return this.get("childMembershipId")},getContentAuthorRealName:function(){return this.get("realName")},isMemberCertifiedContentAuthor:function(){return this.get("memberCertified")},isMemberContentAuthor:function(){return this.get("isMember")},isContentAuthorMe:function(){return this.get("me")},isContentAuthorDeleted:function(){return this.get("isDeleted")},isPageProfileContentAuthor:function(){return this.getContentAuthorMemberType()==l.MEMBER_TYPE.PAGE_PROFILE},isLeaderContentAuthor:function(){return"leader"==this.getContentAuthorRole()},isColeaderContentAuthor:function(){return"coleader"==this.getContentAuthorRole()},isSameMemberKeyContentAuthor:function(e){return!!e&&this.getContentAuthorMemberKey()==e.getContentAuthorMemberKey()},_isPermittedOperation:function(e){return _.contains(this.get("permittedOperation"),e)},isOffLivePermittedContentAuthor:function(){return this._isPermittedOperation("off_live")},isUploadLivePermittedContentAuthor:function(){return this._isPermittedOperation("upload_live")},isPinLiveChatMessagePermittedContentAuthor:function(){return this._isPermittedOperation("pin_live_chat_message")},isHideLiveChatMessagePermittedContentAuthor:function(){return this._isPermittedOperation("hide_live_chat_message")},isViewLiveViewingMemberPermittedContentAuthor:function(){return this._isPermittedOperation("view_live_viewing_member")}});return c.buildContentAuthorModel=function(e){return new c(e,{parse:!0})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(523),o=n(43),s=n(53),a=n(153),r={not_taken_yet:"quiz.grade.graded_state.not_taken_yet",needed:"quiz.grade.graded_state.needed",finished:"quiz.grade.graded_state.finished",opened:"quiz.grade.graded_state.opened"},l={min:"remaining_time_before_start.by_min",hour:"remaining_time_before_start.by_hour",day:"remaining_time_before_start.by_day"},c={min:"remaining_time_before_end.by_min",hour:"remaining_time_before_end.by_hour",day:"remaining_time_before_end.by_day"},d={MAX_START_DAY_FROM_NOW_BY_DAY:60,DEFAULT_PERIOD_RANGE_BY_DAY:30,MAX_PERIOD_RANGE_BY_DAY:60,QUESTION_MAX_COUNT:50,POINT_DEFAULT_VALUE:1,POINT_MIM_VALUE:1,POINT_MAX_VALUE:100,CHOICE_DEFAULT_COUNT:2,CHOICE_MAX_COUNT:10,QUESTION_TITLE_MAX_LENGTH:500,CHOICE_TITLE_MAX_LENGTH:200,CORRECT_ESSAY_ANSWER_DEFAULT_COUNT:1,CORRECT_ESSAY_ANSWER_MAX_COUNT:10,CORRECT_ESSAY_ANSWER_MAX_LENGTH:30,ANSWERED_IMAGE_MAX_COUNT:5,ANSWERED_FILE_MAX_COUNT:1,ANSWERED_FILE_MAX_SIZE:52428800,VIEWER_STATES:{NOT_TAKEN_YET:"not_taken_yet",ALREADY_TAKEN:"already_taken",GRADED:"graded"},GRADED_STATE:{NOT_TAKEN_YET:"not_taken_yet",NEEDED:"needed",FINISHED:"finished",OPENED:"opened"},getRemainingTimeMessage:function(e,t,n){var i=o(Date.now());return i.isAfter(t)?IM("quiz.msg.ended"):i.isBefore(e)?d.getRemainingTimeMessageBeforeStart(e,n):t&&i.isBefore(t)?d.getRemainingTimeMessageBeforeEnd(t,n):""},getRemainingTimeMessageBeforeStart:function(e,t){var n=i.getRemainingTime(e,t);return IM(l[n.format],{value:n.value})},getRemainingTimeMessageBeforeEnd:function(e,t){var n=i.getRemainingTime(e,t,"ceil");return IM(c[n.format],{value:n.value})},getGradedStateText:function(e){return IM(r[e])},getOpenTakerDetailBtnLabel:_.memoize((function(e){var t={};return t[d.VIEWER_STATES.NOT_TAKEN_YET]=IM("post.quiz.take_quiz.btn"),t[d.VIEWER_STATES.ALREADY_TAKEN]=IM("post.quiz.show_my_answer.btn"),t[d.VIEWER_STATES.GRADED]=IM("post.quiz.show_my_grade.btn"),t[e]||""})),getTakerCountText:function(e,t){return IM("post.quiz.taker_count",{count:String(e),max:String(t)})},isReviewMode:function(e,t){return!(s.getCurrentRouteInfo().routeInfo!==a.GROUP_BAND_QUIZ_TAKER_DETAIL)&&(!!e.isReviewable()&&e.getQuestions().some(_.bind((function(e){return!e.isEssayQuestion()&&t.getGrade(e.getQuestionId()).getTakerPoint()!==e.getPoint()}),this)))}};e.exports=d},function(e,t,n){var i;void 0===(i=function(){return{NEW_TERM:86400,NAME_MAX_LENGTH:50,DESCRIPTION_MAX_LENGTH:250,REPEAT_OPTIONS_LIMIT_RANGE_YEAR:5,DATE_PICKER_WIDTH:173,MAX_SHARER_NUMBER:1e3,BAND_SCHEDULE_TIME_FORMAT:"YYYY-MM-DDTHH:mm:ssZZ",SCHEDULE_NAME_MAX_LENGTH:200,SCHEDULE_DESCRIPTION_MAX_LENGTH:1500,SCHEDULE_PHOTO_TYPE:"SCHEDULE_PHOTO",MAX_COUNT_FOR_PERSONAL_ALARM:2,MAX_COUNT_FOR_COMMON_ALARM:3,REPORT:{TYPE:{SCHEDULE:"SCHEDULE",PHOTO:"SCHEDULE_PHOTO",COMMENT:"SCHEDULE_COMMENT"}},RSVP:{CHILD_MEMBER_NAME_MAX_LENGTH:30,ATTENDEE_MAX_COUNT:1e3,EXPORT_TYPE:{DOWNLOAD:"download",PRINT:"print"}},SUPPORT_RANGE:{FROM:"1900-01-01T00:00:00.000Z",TO:"2037-12-30T23:59:59.999Z"},API_CONSTANT:{SCHEDULE_COPY:"copy",SCHEDULE_CREATE:"create"},RSVP_VISIBLE_QUALIFICATION:{ALL:"all",ONLY_MANAGER:"only_manager"}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{ATTENDANCE_VISIBLE_QUALIFICATION:{ALL:"all",ONLY_MANAGER:"only_manager"},MAXIMUM_PREVIEW_ATTENDEE_LIST:5,ATTENDANCE_CHECK_STATE:{CHECKED:"checked",TARDY:"tardy",EARLY_LEFT:"early_left",ABSENT:"absent",UNCHECKED:"unchecked"}}}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(13),s=n(21),a=n(34),r=n(568),l=n(525),c=n(509),d=n(153),u=n(170),h=null,p=function(){return h||(h=s.getLoginV1Client()),h},m={getPhotos:function(e,t,n,i){var o={band_no:e,limit:n};return o=g(o,t),i&&i.next_params&&(o.after=i.next_params.after),p().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1.6.2/get_photos",data:o,timeout:5e3})},getPhotosWithCreatedAt:function(e,t,n,i,o){var s={band_no:e,from:t,limit:o};return s=g(s,n),i&&i.next_params&&(s.after=i.next_params.after),p().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_photos_with_created_at",data:s,timeout:5e3})},getPhotoStatus:function(e){return p().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_photo_status",data:{band_no:e}})},createPhotos:function(e,t,n){return _(e,t,n)},createVideo:function(e,t,n){return _(e,t,null,n)},createPhotosOrVideos:function(e,n,i){var o={band_no:e,album_no:n,photos_or_videos:a.stringify(i)};return t.isNumeric(o.album_no)||delete o.album_no,p().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v2.0.0/create_photos_or_videos",data:o,type:"POST"})},deletePhotos:function(e,t){return p().sendAndThenProcess({url:"https://api.band.us/v1/delete_photos",data:{band_no:e,photo_nos:t.join(",")}})},deletePhoto:function(e,t){return p().sendAndThenProcess({url:"https://api.band.us/v1.1/delete_photo",data:{band_no:e,photo_no:t}}).then((function(){return[t]}))},movePhotos:function(e,t,n){var i={band_no:e,album_no:t,photo_nos:n.join(",")};return p().sendAndThenProcess({url:"https://api.band.us/v1/move_photos",data:i,type:"POST"})},getPhotoDetail:function(e,t,n){return p().sendBandApiBatchRequest([{path:"/v1.5.2/get_photo",params:{band_no:e,photo_no:t}},{path:l.PATHS.GET_EMOTIONS,params:{band_no:e,content_key:c.buildPhotoKey(t).toApiParams(!0)}}]).then(i.bind((function(e,t,n){return{photo:e[0].result_data.photo,emotions:e[1].result_data.emotions}}),this)).fail((function(t){o.isLogedIn()?n||d.GROUP_BAND_HOME.historyBackOrGoTargetUrl({band_no:e}):n||u.goRefreshFallback()}))},getPhoto:function(e,t){var n={band_no:e,photo_no:t};return p().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1.5.2/get_photo",data:n})},searchPhotosWithAuthor:function(e,t,n){var i={band_no:e,author_key:t,limit:20};return null!=n&&(i.after=n),p().sendAndThenProcess({url:"https://api.band.us/v1.5.2/search_photos_with_author",data:i})},getPhotosWithId:function(e,t){return p().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_photos_with_id",data:{band_no:e,photo_nos:t.join(",")}})},setSavableStateForPhoto:function(e,t,n){return p().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_savable_state_for_photo",data:{band_no:e,photo_no:t,savable_state:n}})}},_=function(e,n,i,o){var s={band_no:e,photo_album_no:n};return null!=i?s.photos=a.stringify(i):s.video=a.stringify(o),t.isNumeric(s.photo_album_no)||delete s.photo_album_no,p().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1/create_photo",data:s,type:"POST"})},g=function(e,n){return t.isNumeric(n)&&n!=r.TOTAL_ALBUM_NO?(e.album_no=n,e):e};return m}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=2,n=2,i=4,o={transformInternationalPhoneNumber:function(e){if(!e)return null;if(/[(]?.*[0-9]?.*[)]/.test(e)){var t=[],n=e.match(/[^\)]+\)?|\)/g);return(i=n[1].split("-")).forEach((function(e){var n=o.getTransformedNumber(e);t.push(n)})),n[1]=t.join("-"),n.join("")}var i;t=[];return(i=e.split("-")).forEach((function(e,n){if(1==n||2==n){var s=o.getTransformedNumber(e);t.push(s)}else t.push(i[n])})),t.join("-")},getTransformedNumber:function(e){var n=1;switch(e.length){case 2:case 3:n=e.length-t;break;case 4:n=e.length-t-1}return e.replace(new RegExp(".(?=.{0,"+n+"}$)","g"),"*")},transformNationalNumber:function(e){if(!e)return null;var n=(e=e.toString()).substr(0,e.length-4),i=e.substr(e.length-4),o=i.length-t-1,s=n.replace(new RegExp(".(?=.{0,"+o+"}$)","g"),"*"),a=i.replace(new RegExp(".(?=.{0,"+o+"}$)","g"),"*");return s.concat(a)},transformEmail:function(e){if(!e)return null;var t=e.lastIndexOf("@"),i=e.substr(0,t),o=e.substr(t),s=i.length-n-1;return(i=i.replace(new RegExp(".(?=.{0,"+s+"}$)","g"),"*")).concat(o)},transformNaverId:function(e){if(!e)return null;var t=e.length>i?e.length-i-1:e.length-i+1;return e.replace(new RegExp(".(?=.{0,"+t+"}$)","g"),"*")}};return o}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(){return{RETINA_RESOLUTION_TYPE:4}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(177),o=n(156),s=function(e){window.isMobileView?n.e(164).then(n.t.bind(null,500,7)).then((function(t){t.openMAlertLayer({desc:e})})):alert(e)},a={PHOTO_VALIDATOR:function(e,t,n,r,l){if(t=t||0,n=n||i.PHOTO.COUNT_LIMIT,r=r||IM("web.upload.validation.alert.photo_count",{count:n}),l=l||i.PHOTO.SIZE_LIMIT,e.length>n-t)return s(r),!1;for(var c=0;c<e.length;c++){var d=e[c];if(0===d.size)return s(IM("web.upload.validation.alert.file_zero_size")),!1;if(!a.isImageType(d))return s(IM("web.upload.validation.alert.photo_format",{formats:i.PHOTO.FORMAT.join(", ")})),!1;if(d.size>l)return s(IM("web.upload.validation.alert.photo_size",{size:o.toStringFileSize(l)})),!1}return!0},SINGLE_PHOTO_WITHOUT_GIF_VALIDATOR:function(e){if(e.length>1)return s(IM("web.upload.validation.alert.photo_count",{count:1})),!1;for(var t=0;t<e.length;t++){var n=e[t];if(!a.isImageType(n)||a.isGifType(n))return s(IM("web.upload.validation.alert.photo_format",{formats:i.PHOTO.FORMAT_WITHOUT_GIF.join(", ")})),!1;if(n.size>i.PHOTO.SIZE_LIMIT)return s(IM("web.upload.validation.alert.photo_size",{size:o.toStringFileSize(i.PHOTO.SIZE_LIMIT)})),!1}return!0},VIDEO_VALIDATOR:function(e,t,n,r){if(n||(n=window.isMobile?i.VIDEO.COUNT_LIMIT:i.VIDEO.PC_COUNT_LIMIT),t=t||0,r=r||IM("web.upload.validation.alert.only_one_video",{count:n}),e.length>n-t)return s(r),!1;for(var l=0;l<e.length;l++){var c=e[l];if(!a.isVideoType(c))return s(IM("web.upload.validation.alert.file_format")),!1;if(c.size>i.VIDEO.SIZE_LIMIT)return s(IM("web.upload.validation.alert.video_size",{size:o.toStringFileSize(i.VIDEO.SIZE_LIMIT)})),!1}return!0},PHOTO_OR_VIDEO_VALIDATOR:function(e,n){n=n||{};var o=t.groupBy(e,(function(e){return a.isVideoType(e)?"videoFiles":a.isGifType(e)?"gifFiles":a.isImageType(e)?"photoFiles":"otherFiles"}));if((o.otherFiles||[]).length>0)return s(IM("web.upload.validation.alert.file_format")),!1;var r=o.videoFiles||[],l=o.gifFiles||[],c=o.photoFiles||[];if(r.length>0&&l.length+c.length>0)return s(IM("web.upload.validation.alert.impossible_photo_video_same_time")),!1;var d=window.isMobileView?i.VIDEO.COUNT_LIMIT:i.VIDEO.PC_COUNT_LIMIT,u=n.photoCount||0,h=n.maxPhotoCount||i.PHOTO.COUNT_LIMIT,p=n.photoExcessMessage,m=n.videoCount||0,_=n.maxVideoCount||d,g=n.videoExcessMessage,f=n.gifCount||0,b=n.maxGifCount||d,v=n.gifExcessMessage||IM("upload.gif.up_to_n",{n:b});return!(r.length>0&&!a.VIDEO_VALIDATOR(r,m,_,g))&&(!(l.length>0&&!a.PHOTO_VALIDATOR(l,f,b,v))&&!(c.length>0&&!a.PHOTO_VALIDATOR(c,u,h,p)))},PHOTO_AND_GIF_VALIDATOR:function(e,n){n=n||{};var o=t.groupBy(e,(function(e){return a.isGifType(e)?"gifFiles":a.isImageType(e)?"photoFiles":"otherFiles"}));if((o.otherFiles||[]).length>0)return s(IM("web.upload.validation.alert.file_format")),!1;var r=o.gifFiles||[],l=o.photoFiles||[],c=window.isMobileView?i.VIDEO.COUNT_LIMIT:i.VIDEO.PC_COUNT_LIMIT,d=n.photoCount||0,u=n.maxPhotoCount||i.PHOTO.COUNT_LIMIT,h=n.photoExcessMessage,p=n.gifCount||0,m=n.maxGifCount||c,_=n.gifExcessMessage||IM("upload.gif.up_to_n",{n:m});return!(r.length>0&&!a.PHOTO_VALIDATOR(r,p,m,_))&&!(l.length>0&&!a.PHOTO_VALIDATOR(l,d,u,h))},MISSION_PHOTO_OR_VIDEO_VALIDATOR:function(e,n){if(e.length+n.mediaCount>n.maxMediaCount){var i=IM("editor.limitation.attach_count",{count:n.maxMediaCount});return s(i),!1}var o=t.groupBy(e,(function(e){return a.isVideoType(e)?"video":a.isGifType(e)?"gif":"photo"})),r=o.video,l=o.gif,c=o.photo,d=t.size(r),u=t.size(l),h=t.size(c);return!(d>0&&u+h>0)||(s(IM("web.upload.validation.alert.impossible_photo_video_same_time")),!1)},PAGE_INTRO_ATTACHED_MEDIA_VALIDATOR:function(e,n){var o=t.groupBy(e,(function(e){return a.isVideoType(e)?"video":a.isGifType(e)?"gif":"photo"})),r=o.video,l=o.gif,c=o.photo,d=t.size(r),u=t.size(l),h=t.size(c),p=t.extend({photoCount:0,maxPhotoCount:i.PHOTO.COUNT_LIMIT,gifCount:0,maxGifCount:i.VIDEO.POST_COUNT_LIMIT,videoCount:0,maxVideoCount:i.VIDEO.POST_COUNT_LIMIT,gifExcessMessage:IM("upload.gif.up_to_n",{n:i.VIDEO.POST_COUNT_LIMIT})},n);return d>0&&u+h>0?(s(IM("web.upload.validation.alert.impossible_photo_video_same_time")),!1):d>0?a.VIDEO_VALIDATOR(e,p.videoCount,p.maxVideoCount,p.videoExcessMessage):!(u>0&&!a.PHOTO_VALIDATOR(l,p.gifCount,p.maxGifCount,p.gifExcessMessage,i.PHOTO.PAGE_INTRO_SIZE_LIMIT))&&!(h>0&&!a.PHOTO_VALIDATOR(c,p.photoCount,p.maxPhotoCount,p.photoExcessMessage,i.PHOTO.PAGE_INTRO_SIZE_LIMIT))},FILE_VALIDATOR:function(e,t,n,r,l,c){t=t||0,n=n||i.FILE.COUNT_LIMIT,r=r||i.FILE.SIZE_LIMIT;var d=0;if(e.length>n-t)return s(IM("web.upload.validation.alert.file_count",{count:n})),!1;for(var u=0;u<e.length;u++){var h=e[u];if(0===h.size)return s(IM("web.upload.validation.alert.file_zero_size")),!1;if(h.size>r)return s(IM("web.upload.validation.alert.total_file_size",{size:o.toStringFileSize(r)})),!1;if(a.isApk(h))return s(IM("web.upload.validation.alert.not_support_file_type")),!1;d+=h.size}return!(l&&d+c>l)||(s(IM("web.upload.validation.alert.total_file_size",{size:o.toStringFileSize(r)})),!1)},AUDIO_VALIDATOR:function(e,t,n,o,r,l){for(var c=0,d=e.length;c<d;c++)if(!a.isAudioType(e[c]))return s(IM("web.upload.validation.alert.file_format")),!1;return n||(n=i.AUDIO.COUNT_LIMIT),o||(o=i.AUDIO.SIZE_LIMIT),a.FILE_VALIDATOR(e,t,n,o,r,l)},SCHEDULE_IMPORT_VALIDATOR:function(e){for(var t=0;t<e.length;t++){var n=e[t];if(!a.isScheduleFile(n))return s(IM("web.upload.validation.alert.not_support_file_type",{formats:i.SCHEDULE.FORMAT.join(", ")})),!1;if(0===n.size)return s(IM("web.upload.validation.alert.file_zero_size")),!1;if(n.size>i.SCHEDULE.SIZE_LIMIT)return s(IM("web.upload.validation.alert.total_file_size",{size:"2MB"})),!1}return!0},BROWSER_VALIDATOR:function(){return!window.navigator.userAgent.match(/iemobile/i)||(s(IM("web.upload.validation.alert.not_support_browser")),!1)},isImageType:function(e){var n=e.type;if(n)return n.match(/^image/);var s=o.getFileExtension(e.name);return t.contains(i.PHOTO.FORMAT,s)},isVideoType:function(e){var n=e.type;if(n)return n.match(/^video/);var s=o.getFileExtension(e.name);return t.contains(i.VIDEO.FORMAT,s)},isAudioType:function(e){var n=o.getFileExtension(e.name);return t.contains(i.AUDIO.UPLOAD_FORMAT,n)},isGifType:function(e){var t=e.type;return t?t.match(/gif/):o.isGif(e.name)},isApk:function(e){return"apk"==o.getFileExtension(e.name)},isScheduleFile:function(e){var n=o.getFileExtension(e.name);return t.contains(i.SCHEDULE.FORMAT,n)},getChatPhotoValidator:function(e,n){return function(i){var o=t.groupBy(i,(function(e){return a.isGifType(e)?"gif":"photo"})),s=o.gif||[],r=o.photo||[],l=IM("upload.gif.only_one");return n>1&&(l=IM("upload.gif.up_to_n",{n:n})),!!a.PHOTO_VALIDATOR(s,0,n,l)&&a.PHOTO_VALIDATOR(r,0,e)}},getMWChatPhotoValidator:function(){return function(e){return t.filter(e,a.isGifType,a).length>=1&&e.length>1?(s(IM("upload.gif.only_one")),!1):a.PHOTO_VALIDATOR(e,0,1)}},getPhotoValidator:function(e){return function(n){var o=t.groupBy(n,(function(e){return a.isGifType(e)?"gif":"photo"})),s=o.gif,r=o.photo,l=e.maxGifCount||i.PHOTO.GIF_COUNT_LIMIT;return!(s&&!a.PHOTO_VALIDATOR(s,e.gifCount,l,e.gifExcessMessage||IM("upload.gif.up_to_n",{n:l})))&&!(r&&!a.PHOTO_VALIDATOR(r,e.photoCount,e.maxPhotoCount,e.photoExcessMessage))}},getVideoValidator:function(e){return t.partial(a.VIDEO_VALIDATOR,t,e.videoCount,e.maxVideoCount,e.videoExcessMessage)},getPhotoOrVideoValidator:function(e){return t.partial(a.PHOTO_OR_VIDEO_VALIDATOR,t,e)},getSchedulePhotoValidator:function(e){return function(n){return t.filter(n,(function(e){var n=(e.type||o.getFileExtension(e.name)).replace(/^(?:image\/)?(.+?)$/,"$1");return!t.has(this.formats,n)}),{formats:t.indexBy(i.SCHEDULE.PHOTO_FORMAT)}).length>0?(s(IM("web.upload.validation.alert.photo_format",{formats:i.SCHEDULE.PHOTO_FORMAT.join(", ")})),!1):a.PHOTO_VALIDATOR(n,e.photoCount,e.maxPhotoCount||i.SCHEDULE.PHOTO_COUNT_LIMIT)}},makeCommentMediaValidator:function(e){return function(n){var o=t.groupBy(n,(function(e){return a.isVideoType(e)?"video":a.isGifType(e)?"gif":"photo"})),r=o.video,l=t.size(r),c=o.gif,d=t.size(c),u=o.photo;return t.size(u)+(e.photoCount||0)>0&&l+d>0?(s(IM("web.upload.validation.alert.impossible_photo_video_same_time")),!1):l>0?a.VIDEO_VALIDATOR(n,0,i.COMMENT.VIDEO_COUNT_LIMIT):d>0?a.PHOTO_VALIDATOR(c,0,i.COMMENT.GIF_COUNT_LIMIT,IM("upload.gif.up_to_n",{n:1})):a.PHOTO_VALIDATOR(u,e.photoCount,i.COMMENT.PHOTO_COUNT_LIMIT)}},makeCommentPhotoValidator:function(e){return function(t){return a.PHOTO_VALIDATOR(t,e.photoCount,i.COMMENT.PHOTO_COUNT_LIMIT)}},makeProfilePhotoValidators:function(){return[function(e){return a.PHOTO_VALIDATOR(e,0,i.PROFILE.PHOTO_COUNT_LIMIT)}]},getStillImageValidator:function(e){return function(n){return t.every(n,(function(e){return a.isImageType(e)&&!a.isGifType(e)}))?a.PHOTO_VALIDATOR(n,e.count,e.limit):(s(IM("web.upload.validation.alert.photo_format",{formats:i.PHOTO.FORMAT_WITHOUT_GIF.join(", ")})),!1)}},getSchedulePhotoAccept:function(){return t.map(i.SCHEDULE.PHOTO_FORMAT,(function(e){return"image/"+e})).join(",")},getCommentMultiplePhotoAccept:function(){return t.map(i.COMMENT.MULTIPLE_PHOTO_FORMAT,(function(e){return"image/"+e})).join(",")},getStillImageAccept:function(){return t.map(i.PHOTO.FORMAT_WITHOUT_GIF,(function(e){return"image/"+e})).join(",")}};return a}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=(n(9),n(543)),s=n(497),a=n(160),r=n(493),l=n(784),c=n(83),d=n(181),u=n(541),h=o.OPTIONS_TYPES,p=o.OPTIONS,m=o.BAND,_=i.Model.extend({idAttribute:"band_no",fetchBandOption:function(e){return u.getBandOption(e,[o.OPTIONS_TYPES.BAND,o.OPTIONS_TYPES.OPTIONS]).then(t.bind((function(e){return this.bandOptions=e,this}),this))},_isPermittedOperation:function(e){if(null==e)return!1;var n=this.bandOptions.options.permitted_operation;return null!=n&&(t.isArray(n)?t.contains(n,e):n==e)},_isExistProperty:function(e){return this.bandOptions.options.hasOwnProperty(e)},_getRole:function(e){return this.bandOptions.options[e]||[]},getPermittedMemberGroupIds:function(e){return t.has(o.OPTIONS.MEMBER_GROUP_IDS,e.toUpperCase())&&this.bandOptions.options[e]||[]},_getInfo:function(e,t){switch(e){case h.BAND:return this.bandOptions.band[t];case h.OPTIONS:return this.bandOptions.options[t]}},_hasInfoKey:function(e,n){switch(e){case o.OPTIONS_TYPES.BAND:return t.has(this.bandOptions.band,n);case o.OPTIONS_TYPES.OPTIONS:return t.has(this.bandOptions.options,n)}},isPermittedConfigureMemberJoinPost:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.CONFIGURE_MEMBER_JOIN_POST)},isPermittedManageNameCover:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_NAME_COVER)},isPermittedManageDescription:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_DESCRIPTION)},isPermittedManageIntroContent:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_INTRO_CONTENT)},isPermittedManageLocation:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_LOCATION)},isPermittedManageIntroMediaList:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_INTRO_MEDIA_LIST)},isPermittedManageShortcut:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_SHORTCUT)},isPermittedManageKeyword:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_KEYWORD)},isPermittedAccessMemberActivityHistories:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.ACCESS_MEMBER_ACTIVITY_HISTORIES)},isPermittedConfigureChat:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.CONFIGURE_CHAT)},isPermittedConfigureMemberPermission:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.CONFIGURE_MEMBER_PERMISSION)},isPermittedManageCoLeader:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_COLEADER)},isPermittedViewManagers:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.VIEW_MANAGERS)},isPermittedDelegateLeader:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.DELEGATE_LEADER)},isPermittedConfigureContentsQuota:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.CONFIGURE_CONTENTS_QUOTA)},isPermittedManageMember:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_MEMBER)},isPermittedDeleteBand:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.DELETE_BAND)},isPermittedDelegateCoLeader:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.DELEGATE_COLEADER)},isPermittedConfigureSchedule:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.CONFIGURE_SCHEDULE)},isPermittedManageUpcomingSchedulePeriod:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_UPCOMING_SCHEDULE_PERIOD)},isPermittedImportSchedule:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.IMPORT_SCHEDULE)},isPermittedManagePinnedHashTag:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_PINNED_HASHTAG)},isPermittedAccessBandStats:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.ACCESS_BAND_STATS)},isPermittedApplyPageLink:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.APPLY_PAGE_LINK)},isPermittedAddPageLink:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.ADD_PAGE_LINK)},isPermittedRemovePageLink:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.REMOVE_PAGE_LINK)},isPermittedManageBandConnection:function(){return this.isPermittedAddPageLink()||this.isPermittedRemovePageLink()||this.isPermittedApplyPageLink()},isPermittedBlockCommentAndChat:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.BLOCK_COMMENT_AND_CHAT)},isPermittedRegisterCalendar:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.REGISTER_CALENDAR)},isExistPropsUnfixQuota:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.UNFIX_QUOTA)},isPermittedManageJoinAssertion:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_JOIN_ASSERTION)},isPermittedManageBusinessRegistration:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_BUSINESS_REGISTRATION)},isPermittedSetPageAdpost:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.SET_PAGE_ADPOST)},isPermittedManagerMission:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_MISSION)},isPermittedConvertRecruitingBand:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.CONVERT_RECRUITING_BAND)},isPermittedManageBandDoNotDisturb:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_BAND_DO_NOT_DISTURB)},isPermittedReserveClosingBand:function(){return this._isPermittedOperation("reserve_closing_band")},isExistPropsOpenBirthday:function(){return this._isExistProperty("open_birthday")},isExistPropsOpenCellphone:function(){return this._isExistProperty("open_cellphone")},isExistPropsPostMembersBirthday:function(){return this._isExistProperty("post_members_birthday")},isExistPropsOpenType:function(){return this._isExistProperty("open_type")},isRecruitingMemberCapacity:function(){return this._isExistProperty("recruiting_member_capacity")},isRecruitingOpenType:function(){return this._isExistProperty("recruiting_open_type")},isRecruitingBandForKidsEnabled:function(){return this._isExistProperty("recruiting_band_for_kids_enabled")},isExistPropsJoinMethod:function(){return this._isExistProperty("join_method")},isExistPropsIsSecretCommentEnabled:function(){return this._isExistProperty("is_secret_comment_enabled")},isExistPropsAskJoinQuestion:function(){return this._isExistProperty("ask_join_question")},isExistAttributeMemberMediaDownloadEnabled:function(){return this._isExistProperty(o.OPTIONS.MEDIA_SAVABLE)},isExistCommentRolesForNonManager:function(){return this._isExistProperty("comment_roles_for_non_manager")},isExistCommentWithUrl:function(){return this._isExistProperty("comment_with_url")},isExistContentCleanFilterLevel:function(){return this._isExistProperty("content_clean_filter_level")},isExistOpenMission:function(){return this._isExistProperty("open_mission")},isExistBandForKidsEnabled:function(){return this._isExistProperty("band_for_kids_enabled")},isExistDefaultAllowBandInvitation:function(){return this._isExistProperty("default_allow_band_invitation")},isDefaultAllowBandInvitation:function(){return this._getInfo(h.OPTIONS,"default_allow_band_invitation")},isSecretCommentEnabled:function(){return this._getInfo(h.OPTIONS,"is_secret_comment_enabled")},canRegisterBusinessIdentificationInfo:function(){return this.isPermittedManageBusinessRegistration()},getEditNameCoverRoles:function(){return this._getRole("edit_name_cover_roles")},getAccessBandStatsRoles:function(){return this._getRole("access_band_stats_roles")},getEditNoticeRoles:function(){return this._getRole("edit_notice_roles")},getViewPostReaderRoles:function(){return this._getRole("view_post_reader_roles")},getPostContentsRoles:function(){return this._getRole("post_contents_roles")},getPostApproverRoles:function(){return this._getRole("post_approver_roles")},getCreateReservedPostRoles:function(){return this._getRole("create_reserved_post_roles")},getCommentRoles:function(){return this._getRole("comment_roles")},getRegisterScheduleRoles:function(){return this._getRole("register_schedule_roles")},getModifyScheduleRoles:function(){return this._getRole("modify_schedule_roles")},getRegisterCalendarRoles:function(){return this._getRole("register_calendar_roles")},getCreateAlbumRoles:function(){return this._getRole("create_album_roles")},getCreateOpenChatRoles:function(){return this._getRole("create_open_chat_roles")},getInviteChatRoles:function(){return this._getRole("invite_chat_roles")},getChatToManagerRoles:function(){return this._getRole("chat_to_manager")},getInviteMemberRoles:function(){return this._getRole("invite_member_roles")},getAcceptApplicationRoles:function(){return this._getRole("accept_application_roles")},getDeleteContentsRoles:function(){return this._getRole("delete_contents_roles")},getDeleteCommentRoles:function(){return this._getRole("delete_comment_roles")},getHideCommentRoles:function(){return this._getRole("hide_comment_roles")},getBanMemberRoles:function(){return this._getRole("ban_member_roles")},getUploadPhotoToAlbumRoles:function(){return this._getRole("upload_photo_to_album_roles")},getAddPageLinkRoles:function(){return this._getRole("add_page_link_roles")},getRemovePageLinkRoles:function(){return this._getRole("remove_page_link_roles")},getBlockCommentAndChatRoles:function(){return this._getRole("block_comment_and_chat_roles")},getManagePinnedHashtagsRoles:function(){return this._getRole("manage_pinned_hashtags_roles")},getDeleteOpenChatRoles:function(){return this._getRole("delete_open_chat_roles")},getDisableDefaultChatRoles:function(){return this._getRole("disable_default_chat_roles")},getManagePostingOnBandJoinRoles:function(){return this._getRole("manage_posting_on_band_join_roles")},getManageOpenCellphoneAndBirthdayRoles:function(){return this._getRole("manage_open_cellphone_and_birthday_roles")},getManageJoinRoles:function(){return this._getRole("manage_join_roles")},getCommentRolesForManager:function(){return this._getRole("comment_roles_for_manager")},getCommentRolesForNonManager:function(){return this._getRole("comment_roles_for_non_manager")},getPageChatAsManagerRoles:function(){return this._getRole("page_chat_as_manager_roles")},getCreateLiveRoles:function(){return this._getRole("create_live_roles")},getOpenCellphoneRoles:function(){return this._getRole("open_cellphone_roles")},getRegion:function(){return this._getInfo(h.BAND,m.REGION)},isLocalBand:function(){return!!this.getRegion()&&!t.isEmpty(this.getBandKeywords())},getKeywordCountrySet:function(){return this._getInfo(h.OPTIONS,"keyword_country_set")},getBandKeywords:function(){return this._getInfo(h.OPTIONS,"keywords")},getBandKeywordsWithKeywordGroups:function(){return this._getInfo(h.OPTIONS,"keywords_with_keyword_groups")},getRecruitingMemberCapacity:function(){return this._getInfo(h.OPTIONS,"recruiting_member_capacity")},getRecruitingBandForKidBand:function(){return this._getInfo(h.OPTIONS,"recruiting_band_for_kids_enabled")},getOpenType:function(){return this._getInfo(h.OPTIONS,"open_type")},isPublicBand:function(){return this.getOpenType()==o.BAND_OPEN_TYPE.PUBLIC},isClosedBand:function(){return this.getOpenType()==o.BAND_OPEN_TYPE.CLOSED},isSecretBand:function(){return this.getOpenType()==o.BAND_OPEN_TYPE.SECRET},getRecruitingOpenType:function(){return this._getInfo(h.OPTIONS,"recruiting_open_type")},isPublicRecruitingBand:function(){return this.getRecruitingOpenType()==o.BAND_OPEN_TYPE.PUBLIC},isClosedRecruitingBand:function(){return this.getRecruitingOpenType()==o.BAND_OPEN_TYPE.CLOSED},isSecretRecruitingBand:function(){return this.getRecruitingOpenType()==o.BAND_OPEN_TYPE.SECRET},getBandShortcut:function(){var e=this._getInfo(h.OPTIONS,"shortcut");return t.isEmpty(e)?"":o.BAND_SHORTCUT_URL_DOMAIN+e},isQuotaUnfixed:function(){return this._getInfo(h.OPTIONS,"is_quota_unfixed")},getAllowedGender:function(){return this._getInfo(h.OPTIONS,"allowed_gender")},getMinBirthYear:function(){return this._getInfo(h.OPTIONS,"min_birth_year")},getMaxBirthYear:function(){return this._getInfo(h.OPTIONS,"max_birth_year")},isEmailVerificationEnabled:function(){return this._getInfo(h.OPTIONS,"email_verification_enabled")},getJoinQuestion:function(){return this._getInfo(h.OPTIONS,"join_question")},isPostBandJoinEnabled:function(){return this._getInfo(h.OPTIONS,"is_post_band_join_enabled")},isBandAllMembersChatEnabled:function(){return this._getInfo(h.OPTIONS,"is_band_chat_enabled")},isBandChatEnabled:function(){return this._getInfo(h.OPTIONS,"chat_enabled")},getChatNotice:function(){return this._getInfo(h.OPTIONS,"chat_notice")},isMemberMediaDownloadEnabled:function(){return this._getInfo(h.OPTIONS,o.OPTIONS.MEDIA_SAVABLE)},getDefaultChatMessagePeriod:function(){return this._getInfo(h.OPTIONS,"default_chat_message_period")},isApplyPageLinkEnabled:function(){return this._getInfo(h.OPTIONS,"apply_page_link")},isPermittedSetApplyPageLinkEnabled:function(){return this._hasInfoKey("options","apply_page_link")},isCommentWithUrl:function(){return this._getInfo(h.OPTIONS,"comment_with_url")},getContentCleanFilterLevel:function(){return this._getInfo(h.OPTIONS,"content_clean_filter_level")},isOpenBirthday:function(){return this._getInfo(h.OPTIONS,"open_birthday")},isPostMembersBirthday:function(){return this._getInfo(h.OPTIONS,"post_members_birthday")},getContentsQuota:function(){return this._getInfo(h.OPTIONS,"contents_quota")},hasBoughtQuota:function(){return this.getContentsQuota()&&this.getContentsQuota().has_bought_quota},getScheduleImport:function(){return this._getInfo(h.OPTIONS,"schedule_import")},isNeedJoinApproval:function(){return this._getInfo(h.OPTIONS,"join_method")==o.JOIN_METHOD.APPLICATION},isAskJoinQuestion:function(){return this._getInfo(h.OPTIONS,"ask_join_question")},isPostWithoutApproval:function(){return this._getInfo(h.OPTIONS,"post_without_approval")},isBandForKidsEnabled:function(){return this._getInfo(h.OPTIONS,"band_for_kids_enabled")},getBandNosOfPageLink:function(){return this._getInfo(h.BAND,m.BAND_NOS_OF_PAGE_LINK)},getBandNosOfPageLinkApplication:function(){return this._getInfo(h.BAND,m.BAND_NOS_OF_PAGE_LINK_APPLICATION)},isExistPageLink:function(){return this.getBandNosOfPageLink()&&this.getBandNosOfPageLink().length>0||this.getBandNosOfPageLinkApplication()&&this.getBandNosOfPageLinkApplication().length>0},getBandCoverUrl:function(){return this._getInfo(h.OPTIONS,"cover")},getBandName:function(){return this._getInfo(h.OPTIONS,"name")},getDescription:function(){return this._getInfo(h.OPTIONS,"description")},getMemberCount:function(){return this._getInfo(h.BAND,m.MEMBER_COUNT)},getBandProfileImage:function(){return this._getInfo(h.OPTIONS,"profile_image")},isShowPopularPost:function(){return this._getInfo(h.OPTIONS,"show_popular_post")},isOpenMission:function(){return this._getInfo(h.OPTIONS,"open_mission")},isShowOnlineMember:function(){return this._getInfo(h.OPTIONS,"show_online_member")},isShowOnlineMemberOnPosts:function(){return this._getInfo(h.OPTIONS,"show_online_member_on_posts")},getShareLocationRoles:function(){return this._getRole("share_location_roles")},getManageBandDoNotDisturbMemberRoles:function(){return this._getRole("manage_band_do_not_disturb_roles")},getManageMemberGroupRoles:function(){return this._getRole("manage_member_group_roles")},isPermittedManageMemberGroup:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.MANAGE_MEMBER_GROUP)},isPermittedCopyBandOption:function(){return this._isPermittedOperation(p.PERMITTED_OPERATION.COPY_BAND_OPTION)},getNotEndedMissionCount:function(){return this._getInfo(h.OPTIONS,"not_ended_mission_count")},isPinnedHashtagsRequiredOnPost:function(){return this._getInfo(h.OPTIONS,"is_pinned_hashtags_required_on_post")},getReservedBandForKidsOffAt:function(){return this._getInfo(h.OPTIONS,"reserved_band_for_kids_off_at")},showRecentPost:function(){return this._getInfo(h.OPTIONS,p.SHOW_RECENT_POST)}});return _.SETTING={setLeaderPermissions:function(e,t){return u.setBandPermissionRoles(e,t)},setCommentPermission:function(e,t){return u.setBandPermissionRoles(e,t)},setChatPermission:function(e,t){return u.setBandPermissionRoles(e,t)},setSchedulePermission:function(e,t){return u.setBandPermissionRoles(e,t)},setPostWritingRoles:function(e,t){return u.setBandPermissionRolesWithoutErrorAlert(e,t)},setPostWithoutApproval:function(e,t){return u.setPostWithoutApproval(e,t)},setCommentWithUrl:function(e,t){return u.setCommentWithUrl(e,t.isCommentWithUrl)},setMemberMediaDownloadEnabled:function(e,t){return u.setMemberMediaDownloadEnabled(e,t)},setChatIntroMessage:function(e,t){return c.setBandInfo({bandNo:e,chatNotice:t.chatNotice})},setCoLeader:function(e,t){return r.setMemberRole(e,t,s.CO_LEADER)},deleteCoLeader:function(e,t){return c.delegateCoLeader(e,t)},removeCoLeader:function(e,t){return r.setMemberRole(e,t,s.MEMBER)},getMemberActivityHistories:function(e,t){return r.getMemberActivityHistories(e,t)},getMembersByRole:function(e,t){return r.getMembersByRole(e,t)},delegateLeader:function(e,t,n){return u.delegateLeader(e,t,n)},getConnectionRequestedBandCount:function(e){return d.getConnectionRequestedBandCount(e)},getBandMembersForDelegateLeader:function(e){return r.getBandMembersOfBandWithFilter(e,a.DELEGATE_PAGE_LEADER)},closePage:function(e){return u.closePage(e).then((function(e){return e.reserved_closure_at}))},cancelPageClosure:function(e){return u.cancelPageClosure(e)},getPenaltyMembers:function(e){return l.getPenaltyMembers(e,l.PENALTY_TYPE.BLOCK_COMMENT_AND_CHAT)},removePenaltyMember:function(e,t){return l.removePenaltyMember(e,t,l.PENALTY_TYPE.BLOCK_COMMENT_AND_CHAT)},setChatInvitation:function(e,t){return c.setChatInvitation(e,!t)},setBandInvitation:function(e,t){return c.setBandInvitation(e,!t)},setBandJoinMethod:function(e,t){return u.setBandJoinMethod(e,t)},setAskJoinQuestion:function(e,t){return u.setAskJoinQuestionOnOff(e,!t)},setJoinQuestion:function(e,t){return u.setJoinQuestion(e,t)},enableMemberJoinPost:function(e,t){return u.enableMemberJoinPost(e,!t)},setBandForKidsEnabled:function(e,t){var n={band_no:e,band_for_kids_enabled:t};return c.setBandConfig(n)},setBandOpenOptions:function(e,t){return u.setBandOpenOptions(e,t)},setShowRecentPost:function(e,t){return u.setShowRecentPost(e,t)},setBandIntroDescription:function(e,t){return c.setBandInfo({bandNo:e,description:t})},setBandLocation:function(e,t){return c.setBandLocation(e,t)},setBandBusinessRegistration:function(e){return u.setBandBusinessRegistration(e)},unsetBandBusinessRegistration:function(e){return u.unsetBandBusinessRegistration(e)},setChatToManager:function(e,t){return u.setChatToManager(e,t)},setDefaultChatMessagePeriod:function(e,t){return c.setDefaultChatMessagePeriod(e,t)},setBandChatEnabled:function(e,t){return u.setBandChatEnabled(e,t)},setBandDefaultChat:function(e,t){return c.setBandDefaultChat(e,t)},setBandPopularPostShow:function(e,t){return u.setBandPopularPostShow(e,t)},setOpenMission:function(e,t){return u.setOpenMission(e,t)},setIsSecretCommentEnabled:function(e,t){return u.setIsSecretCommentEnabled(e,t)},setDefaultAllowBandInvitation:function(e,t){return u.setDefaultAllowBandInvitation(e,t)},setIsPinnedHashtagsRequiredOnPost:function(e,t){var n={band_no:e,is_pinned_hashtags_required_on_post:t};return c.setBandConfig(n)},setLocalBand:function(e,t,n){return c.setBandConfig({band_no:e,rcode:t,local_keyword:n})},clearLocalBand:function(e){return c.setBandConfig({band_no:e,rcode:""})}},_.getBandOption=function(e){return(new _).fetchBandOption(e)},_}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(52),o=n(21),s="/v2.3.0/get_band_option",a="/v2.1.0/set_band_permission";return{getApiClient:function(e){return e?this._silentApiClient||(this._silentApiClient=o.createLoginV1ClientWithoutErrorAlert()):(this.apiClient||(this.apiClient=o.getLoginV1Client()),this.apiClient)},getBandOption:function(e,t){var n={band_no:e,types:t.toString()};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+s,data:n,method:"GET"})},getMyPageInfo:function(){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_my_page_info",method:"GET"})},getBandNewsConfigs:function(){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_band_news_configs",data:{without_post_news:!0},method:"GET"})},getBandNotificationOption:function(e){var t={band_no:e,without_post_news:!0};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.4.0/get_band_notification",data:t,method:"GET"})},setBandNotificationOption:function(e){var t={band_no:e.bandNo,comment_news_option:e.newsLevel,receive_email_notification:e.receiveEmailNotification};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.4.0/set_band_notification",data:t,method:"GET"})},_setBandJoinOptions:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.3.0/set_band_join_options",data:e,method:"POST"})},setBandJoinMethod:function(e,t){return this._setBandJoinOptions({band_no:e,join_method:t})},setAskJoinQuestionOnOff:function(e,t){return this._setBandJoinOptions({band_no:e,ask_join_question:t})},setJoinQuestion:function(e,t){return this._setBandJoinOptions({band_no:e,join_question:t})},setGender:function(e,t){return this._setBandJoinOptions({band_no:e,allowed_gender:t})},setAge:function(e,t,n){return this._setBandJoinOptions({band_no:e,min_birth_year:t,max_birth_year:n})},setBandJoinCondition:function(e,n,i,o,s){var a={band_no:e,allowed_gender:n,min_birth_year:i,max_birth_year:o};return t.isBoolean(s)&&(a.email_verification_enabled=s),this._setBandJoinOptions(a)},setBandJoinConditionWithoutEmail:function(e,t,n,i){return this._setBandJoinOptions({band_no:e,allowed_gender:t,min_birth_year:n,max_birth_year:i})},setBandPermissionRoles:function(e,n){var o={band_no:e};return t.map(n,(function(e,t){o[t]=e})),o=i.decamelizeKeys(o),this.getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us"+a,data:o,method:"POST"})},setBandPermissionRolesWithoutErrorAlert:function(e,n){var o={band_no:e};return t.map(n,(function(e,t){o[t]=e})),o=i.decamelizeKeys(o),this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+a,data:o,method:"POST"})},setPostWritingSettingWithoutErrorAlert:function(e,t,n){var i={band_no:e};return i[t]=n,this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.2/set_band_permission",data:i,method:"POST"})},setMemberOpenCellphoneAndBirthday:function(e,t,n,i){return this._setBandOptions({band_no:e,open_cellphone_roles:t,open_birthday:n,post_members_birthday:i})},enableMemberJoinPost:function(e,t){return this._setBandOptions({band_no:e,post_band_join:t})},setCommentWithUrl:function(e,t){return this._setBandOptions({band_no:e,comment_with_url:t})},setMemberMediaDownloadEnabled:function(e,t){return this._setBandOptions({band_no:e,media_savable:t})},setApplyPageLinkEnabled:function(e,t){return this._setBandOptions({band_no:e,apply_page_link:t})},setOpenMission:function(e,t){return this._setBandOptions({band_no:e,open_mission:t})},setIsSecretCommentEnabled:function(e,t){return this._setBandOptions({band_no:e,is_secret_comment_enabled:t})},_setBandOptions:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.1.1/set_band_option",data:e,method:"POST"})},_setBandOpenOptions:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_band_open_options",data:e,method:"POST"})},setBandOpenType:function(e,t){return this._setBandOpenOptions({band_no:e,open_type:t})},setBandPopularPostShow:function(e,t){return this._setBandOpenOptions({band_no:e,show_popular_post:t})},setBandOpenOptions:function(e,t){var n={band_no:e,open_type:t};return this._setBandOpenOptions(n)},setBandUrlShortcut:function(e,t,n){var i={band_no:e};return n?i.shortcut_by_force=t:i.shortcut=t,this._setBandOptions(i)},setShowRecentPost:function(e,t){return this._setBandOpenOptions({band_no:e,show_recent_post:t})},setShowPopularPost:function(e,t){return this._setBandOpenOptions({band_no:e,show_popular_post:t})},setBandMemberCountLimit:function(e,t){var n={band_no:e,is_quota_unfixed:t};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1/set_band_quota_unfixed",data:n,method:"POST"})},setBandLeaderOptions:function(e,t,n,i){var o={band_no:e,open_cellphone:t,open_birthday:n,post_members_birthday:i};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1/set_band_leader_options",data:o,method:"POST"})},createIcalUrlMW:function(e){var t={band_no:e};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.0.0/create_ical_url",data:t})},deleteIcalUrlMW:function(e){var t={band_no:e};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.0.0/delete_ical_url",data:t})},createIcalUrl:function(e,t,n){var i={band_no:e,is_default_calendar:t,calendar_id:n};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/create_ical_url",data:i})},deleteIcalUrl:function(e,t,n){var i={band_no:e,is_default_calendar:t,calendar_id:n};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/delete_ical_url",data:i})},getQuotaInfo:function(e,t){return this.getApiClient(t).sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_quota_info",data:{band_no:e}})},setFileIntoQuota:function(e,t){var n={band_no:e,file_id:t};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_file_into_quota",data:n})},setVideoIntoQuota:function(e,t){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_video_into_quota",data:{band_no:e,video_id:t}})},setQuotaInfo:function(e){var t={band_no:e.bandNo,is_status_announceable:e.receive,file_quota_policy:e.quota};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_quota_info",data:t})},getVideosForQuota:function(e){e.after,e.band_no,e.order_by;return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_videos_for_quota",data:e})},deleteVideos:function(e){var t={band_no:e.bandNo,video_ids:e.videoIds.join(",")};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.0.0/delete_videos",data:t})},getStorageInfo:function(e){var t={band_no:e};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_quota_purchase_info",data:t})},getMemberConfig:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.1.1/get_member_config",data:{band_no:e}})},setMemberConfig:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.1.0/set_member_config",data:e})},delegateLeader:function(e,t,n){var i={band_no:e,user_no:t};return n&&(i.agreements=n.toString()),this.getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1.1.0/delegate_leader",data:i,method:"POST"})},closePage:function(e){return this.getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v2.0.0/close_page",data:{band_no:e},method:"POST"})},cancelPageClosure:function(e){return this.getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v2.0.0/cancel_page_closure",data:{band_no:e},method:"POST"})},getBandBusinessRegistration:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_band_business_registration",data:{band_no:e}})},setBandBusinessRegistration:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_band_business_registration",data:e,method:"POST"})},unsetBandBusinessRegistration:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/unset_band_business_registration",data:{band_no:e},method:"POST"})},setChatToManager:function(e,t){return this._setBandOptions({band_no:e,chat_to_manager:t})},setPostWithoutApproval:function(e,t){return this._setBandOptions({band_no:e,post_without_approval:t})},setBandChatEnabled:function(e,t){return this._setBandOptions({band_no:e,chat_enabled:t})},setDefaultAllowBandInvitation:function(e,t){return this._setBandOptions({band_no:e,default_allow_band_invitation:t})},setCopyBandOption:function(e,t,n){var i={band_no:e,target_band_nos:t.toString(),target_options:n.toString()};return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/copy_band_option",data:i,method:"POST"})},reserveBandForKidsOff:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/reserve_band_for_kids_off",data:{band_no:e},method:"POST"})},cancelBandForKidsOff:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/cancel_band_for_kids_off",data:{band_no:e},method:"POST"})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=t.create({isUserMessage:function(e){return t.isNumber(e)&&e>0&&e<100},isHidingSupport:function(e){return t.contains(o,e)},isGroupCall:function(e){return t.contains(a,e)},isReplySupport:function(e){return t.contains(s,e)}},{TEXT:1,STICKER:10,PHOTO:11,THIRD_PARTY_GIFT:12,THIRD_PARTY:13,AUDIO:14,VOICE_CALL_START:15,VIDEO_CALL_START:16,PHOTO_LIST:17,VIDEO:50,LOCATION:51,FILE:52,CONTACT:53,GIF_VIDEO:54,GIPHY:55,INVITE:101,QUIT:102,CHANGE_MESSAGE_PERIOD:103,CHANGE_CHANNEL_PROFILE:104,CHANGE_CHANNEL_NAME:105,KICK:106,VOICE_CALL_END:107,VIDEO_CALL_END:108,RECLAIM:114}),o=[i.TEXT,i.PHOTO,i.VIDEO,i.GIF_VIDEO,i.AUDIO,i.FILE,i.GIPHY,i.PHOTO_LIST],s=[i.TEXT,i.STICKER,i.PHOTO,i.AUDIO,i.VIDEO,i.LOCATION,i.GIF_VIDEO,i.GIPHY,i.PHOTO_LIST],a=[i.VOICE_CALL_START,i.VOICE_CALL_END,i.VIDEO_CALL_START,i.VIDEO_CALL_END];return i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(22),i=n(90);return{COMMON:{BASE_MEMBER_COUNT_FOR_DESCRIPTION:1e3,BASE_MEMBER_COUNT_FOR_CHANGE:5e3},BAND_TYPE_CONDITION:{BAND_MEMBER_MAX_COUNT:1e3,BAND_SHORTCUT_MAX_LENGTH:20,BAND_SHORTCUT_MIN_LENGTH:2},BAND_JOIN_CONDITION:{MAX_YEAR_FOR_AGE:(new Date).getFullYear(),MIN_YEAR_FOR_AGE:(new Date).getFullYear()-100,JOIN_QUESTION_MAX_LENGTH:100,ALLOWED_GENDER:{MALE:"male",FEMALE:"female",NONE:"none"}},BAND_KEYWORD:{KEYWORD_MAX_COUNT:3,LOCAL_BAND_KEYWORD_MAX_COUNT:1},JOIN_METHOD:{APPLICATION:"application",NORMAL:"normal"},BAND_SHORTCUT_URL_DOMAIN:location.protocol+"//band.us/@",BAND_OPEN_TYPE:t.OPEN_TYPE,OPTIONS_TYPES:{BAND:"band",MEMBER:"member",OPTIONS:"options"},PERMISSION_ROLES:{LEADER:"leader",COLEADER:"coleader",MEMBER:"member",GUEST:"guest"},PERMISSION_KNOWN_MEMBER_GROUP_IDS:{LEADER:{name:IM("web.band.member.role.leader"),memberGroupId:-10},COLEADER:{name:IM("web.band.member.role.coleader"),memberGroupId:-20}},PERMISSION_ROLE_SELECTINGS:{ANYONE:"leader,coleader,member",UNTIL_COLEADER:"leader,coleader",ONLY_LEADER:"leader"},PAGE_OPTIONS:{CHAT_INTRO_MESSAGE_MAX_LENGTH:200,ADD_COLEADER_MEMBER_MAX_COUNT:50},getBandViewPostReaderLevelAuthority:function(e){switch(e){case"only_leader":return IM("bandsetting.member_permission.only_leader");case"until_coleader":return IM("bandsetting.member_permission.only_until_coleader");case"anyone":return IM("bandsetting.member_permission.with_anyone");default:return""}},getBandOpenTypeText:function(e){return i.GROUP_BAND_OPEN_TYPE_NAME_SHORT[e]},BAND:{BAND_NOS_OF_PAGE_LINK:"band_nos_of_page_link",BAND_NOS_OF_PAGE_LINK_APPLICATION:"band_nos_of_page_link_application",MEMBER_COUNT:"member_count",REGION:"region"},MEMBER:{NAME:"name",PROFILE_IMAGE_URL:"profile_image_url",IS_OPEN_BIRTHDAY:"is_open_birthday",IS_OPEN_CELLPHONE:"is_open_cellphone",ALLOW_CHAT_INVITATION:"allow_chat_invitation",ALLOW_OTHER_BAND_INVITATION:"allow_other_band_invitation",PERMITTED_OPERATION:{MODIFY_OPEN_CELLPHONE:"modify_open_cellphone",MODIFY_OPEN_BIRTHDAY:"modify_open_birthday",MODIFY_ALLOW_OTHER_BAND_INVITATION:"modify_allow_other_band_invitation",MODIFY_ALLOW_CHAT_INVITATION:"modify_allow_chat_invitation"}},OPTIONS:{COVER:"cover",OPEN_TYPE:"open_type",OPEN_BIRTHDAY:"open_birthday",OPEN_CELLPHONE:"open_cellphone",POST_MEMBERS_BIRTHDAY:"post_members_birthday",COMMENT_WITH_URL:"comment_with_url",COMMENT_LANGUAGE_FILTER:"comment_language_filter",MEDIA_SAVABLE:"media_savable",CHAT_NOTICE:"chat_notice",APPLY_PAGE_LINK:"apply_page_link",CONTENTS_QUOTA:"contents_quota",DEFAULT_CHAT_MESSAGE_PERIOD:"default_chat_message_period",IS_BAND_CHAT_ENABLED:"is_band_chat_enabled",SHORTCUT:"shortcut",IS_QUOTA_UNFIXED:"is_quota_unfixed",JOIN_METHOD:"join_method",ASK_JOIN_QUESTION:"ask_join_question",JOIN_QUESTION:"join_question",DESCRIPTION:"description",ALLOWED_GENDER:"allowed_gender",MIN_BIRTH_YEAR:"min_birth_year",MAX_BIRTH_YEAR:"max_birth_year",IS_POST_BAND_JOIN_ENABLED:"is_post_band_join_enabled",KEYWORD_COUNTRY_SET:"keyword_country_set",KEYWORDS:"keywords",KEYWORDS_WITH_KEYWORD_GROUPS:"keywords_with_keyword_groups",SCHEDULE_IMPORT:"schedule_import",POST_WITHOUT_APPROVAL:"post_without_approval",BAND_DO_NOT_DISTURB:"band_do_not_disturb",EMAIL_VERIFICATION_ENABLED:"email_verification_enabled",EMAIL_VERIFICATION_DOMAINS:"email_verification_domains",POST_BAND_JOIN:"post_band_join",BAND_FOR_KIDS_ENABLED:"band_for_kids_enabled",CHAT_TO_MANAGER:"chat_to_manager",OPEN_CELLPHONE_ROLES:"open_cellphone_roles",SHOW_ONLINE_MEMBER:"show_online_member",SHOW_ONLINE_MEMBER_ON_POSTS:"show_online_member_on_posts",DEFAULT_ALLOW_BAND_INVITATION:"default_allow_band_invitation",IS_SECRET_COMMENT_ENABLED:"is_secret_comment_enabled",CHAT_ENABLED:"chat_enabled",FILE_QUOTA_POLICY:"file_quota_policy",IS_STATUS_ANNOUNCEABLE:"is_status_announceable",SHOW_RECENT_POST:"show_recent_post",ROLES:{EDIT_NAME_COVER_ROLES:"edit_name_cover_roles",EDIT_NOTICE_ROLES:"edit_notice_roles",VIEW_POST_READER_ROLES:"view_post_reader_roles",POST_CONTENTS_ROLES:"post_contents_roles",COMMENT_ROLES:"comment_roles",REGISTER_SCHEDULE_ROLES:"register_schedule_roles",MODIFY_SCHEDULE_ROLES:"modify_schedule_roles",REGISTER_CALENDAR_ROLES:"register_calendar_roles",CREATE_ALBUM_ROLES:"create_album_roles",CREATE_OPEN_CHAT_ROLES:"create_open_chat_roles",INVITE_CHAT_ROLES:"invite_chat_roles",INVITE_MEMBER_ROLES:"invite_member_roles",ACCEPT_APPLICATION_ROLES:"accept_application_roles",DELETE_CONTENTS_ROLES:"delete_contents_roles",DELETE_COMMENT_ROLES:"delete_comment_roles",HIDE_COMMENT_ROLES:"hide_comment_roles",BAN_MEMBER_ROLES:"ban_member_roles",UPLOAD_PHOTO_TO_ALBUM_ROLES:"upload_photo_to_album_roles",EDIT_PAGE_INTRO_ROLES:"edit_page_intro_roles",ADD_PAGE_LINK_ROLES:"add_page_link_roles",REMOVE_PAGE_LINK_ROLES:"remove_page_link_roles",BLOCK_COMMENT_AND_CHAT_ROLES:"block_comment_and_chat_roles",COMMENT_ROLES_FOR_MANAGER:"comment_roles_for_manager",COMMENT_ROLES_FOR_NON_MANAGER:"comment_roles_for_non_manager",MANAGER_COMMENT_ROLES:"manager_comment_roles",NON_MANAGER_COMMENT_ROLES:"non_manager_comment_roles",PAGE_CHAT_AS_MANAGER_ROLES:"page_chat_as_manager_roles",ACCESS_BAND_STATS_ROLES:"access_band_stats_roles",MANAGE_PINNED_HASHTAGS_ROLES:"manage_pinned_hashtags_roles",DELETE_OPEN_CHAT_ROLES:"delete_open_chat_roles",DISABLE_DEFAULT_CHAT_ROLES:"disable_default_chat_roles",MANAGE_POSTING_ON_BAND_JOIN_ROLES:"manage_posting_on_band_join_roles",MANAGE_OPEN_CELLPHONE_AND_BIRTHDAY_ROLES:"manage_open_cellphone_and_birthday_roles",MANAGE_JOIN_ROLES:"manage_join_roles",POST_APPROVER_ROLES:"post_approver_roles",CREATE_RESERVED_POST_ROLES:"create_reserved_post_roles",CREATE_LIVE_ROLES:"create_live_roles",MANAGE_BAND_DO_NOT_DISTURB_ROLES:"manage_band_do_not_disturb_roles",MANAGE_MEMBER_GROUP_ROLES:"manage_member_group_roles",SHARE_LOCATION_ROLES:"share_location_roles"},MEMBER_GROUP_IDS:{EDIT_NAME_COVER_MEMBER_GROUP_IDS:"edit_name_cover_member_group_ids",EDIT_NOTICE_MEMBER_GROUP_IDS:"edit_notice_member_group_ids",VIEW_POST_READER_MEMBER_GROUP_IDS:"view_post_reader_member_group_ids",POST_CONTENTS_MEMBER_GROUP_IDS:"post_contents_member_group_ids",COMMENT_MEMBER_GROUP_IDS:"comment_member_group_ids",REGISTER_SCHEDULE_MEMBER_GROUP_IDS:"register_schedule_member_group_ids",MODIFY_SCHEDULE_MEMBER_GROUP_IDS:"modify_schedule_member_group_ids",REGISTER_CALENDAR_MEMBER_GROUP_IDS:"register_calendar_member_group_ids",CREATE_ALBUM_MEMBER_GROUP_IDS:"create_album_member_group_ids",CREATE_OPEN_CHAT_MEMBER_GROUP_IDS:"create_open_chat_member_group_ids",INVITE_CHAT_MEMBER_GROUP_IDS:"invite_chat_member_group_ids",INVITE_MEMBER_MEMBER_GROUP_IDS:"invite_member_member_group_ids",ACCEPT_APPLICATION_MEMBER_GROUP_IDS:"accept_application_member_group_ids",DELETE_CONTENTS_MEMBER_GROUP_IDS:"delete_contents_member_group_ids",DELETE_COMMENT_MEMBER_GROUP_IDS:"delete_comment_member_group_ids",HIDE_COMMENT_MEMBER_GROUP_IDS:"hide_comment_member_group_ids",BAN_MEMBER_MEMBER_GROUP_IDS:"ban_member_member_group_ids",UPLOAD_PHOTO_TO_ALBUM_MEMBER_GROUP_IDS:"upload_photo_to_album_member_group_ids",EDIT_PAGE_INTRO_MEMBER_GROUP_IDS:"edit_page_intro_member_group_ids",ADD_PAGE_LINK_MEMBER_GROUP_IDS:"add_page_link_member_group_ids",REMOVE_PAGE_LINK_MEMBER_GROUP_IDS:"remove_page_link_member_group_ids",BLOCK_COMMENT_AND_CHAT_MEMBER_GROUP_IDS:"block_comment_and_chat_member_group_ids",COMMENT_MEMBER_GROUP_IDS_FOR_MANAGER:"comment_member_group_ids_for_manager",COMMENT_MEMBER_GROUP_IDS_FOR_NON_MANAGER:"comment_member_group_ids_for_non_manager",MANAGER_COMMENT_MEMBER_GROUP_IDS:"manager_comment_member_group_ids",NON_MANAGER_COMMENT_MEMBER_GROUP_IDS:"non_manager_comment_member_group_ids",PAGE_CHAT_AS_MANAGER_MEMBER_GROUP_IDS:"page_chat_as_manager_member_group_ids",ACCESS_BAND_STATS_MEMBER_GROUP_IDS:"access_band_stats_member_group_ids",MANAGE_PINNED_HASHTAGS_MEMBER_GROUP_IDS:"manage_pinned_hashtags_member_group_ids",DELETE_OPEN_CHAT_MEMBER_GROUP_IDS:"delete_open_chat_member_group_ids",DISABLE_DEFAULT_CHAT_MEMBER_GROUP_IDS:"disable_default_chat_member_group_ids",MANAGE_POSTING_ON_BAND_JOIN_MEMBER_GROUP_IDS:"manage_posting_on_band_join_member_group_ids",MANAGE_OPEN_CELLPHONE_AND_BIRTHDAY_MEMBER_GROUP_IDS:"manage_open_cellphone_and_birthday_member_group_ids",MANAGE_JOIN_MEMBER_GROUP_IDS:"manage_join_member_group_ids",POST_APPROVER_MEMBER_GROUP_IDS:"post_approver_member_group_ids",CREATE_RESERVED_POST_MEMBER_GROUP_IDS:"create_reserved_post_member_group_ids",CREATE_LIVE_MEMBER_GROUP_IDS:"create_live_member_group_ids",MANAGE_BAND_DO_NOT_DISTURB_MEMBER_GROUP_IDS:"manage_band_do_not_disturb_member_group_ids",MANAGE_MEMBER_GROUP_MEMBER_GROUP_IDS:"manage_member_group_member_group_ids",SHARE_LOCATION_MEMBER_GROUP_IDS:"share_location_member_group_ids"},PERMITTED_OPERATION:{DELEGATE_LEADER:"delegate_leader",UNFIX_QUOTA:"unfix_quota",DELETE_BAND:"delete_band",CONFIGURE_CHAT:"configure_chat",MANAGE_COLEADER:"manage_coleader",VIEW_MANAGERS:"view_managers",CONFIGURE_MEMBER_PERMISSION:"configure_member_permission",DELEGATE_COLEADER:"delegate_coleader",ACCESS_HOTLINE:"access_hotline",MANAGE_NAME_COVER:"manage_name_cover",MANAGE_MEMBER:"manage_member",MANAGE_PINNED_HASHTAG:"manage_pinned_hashtag",MANAGE_SHORTCUT:"manage_shortcut",ACCESS_BAND_STATS:"access_band_stats",CONFIGURE_SHOW_POPULAR_POST:"configure_show_popular_post",MANAGE_KEYWORD:"manage_keyword",MANAGE_DESCRIPTION:"manage_description",MANAGE_INTRO_CONTENT:"manage_intro_content",MANAGE_LOCATION:"manage_location",MANAGE_INTRO_MEDIA_LIST:"manage_intro_media_list",MANAGE_BUSINESS_REGISTRATION:"manage_business_registration",SET_PAGE_ADPOST:"set_page_adpost",MANAGE_JOIN_ASSERTION:"manage_join_assertion",CONFIGURE_MEMBER_JOIN_POST:"configure_member_join_post",CONFIGURE_CONTENTS_QUOTA:"configure_contents_quota",IMPORT_SCHEDULE:"import_schedule",CONFIGURE_SCHEDULE:"configure_schedule",CONFIGURE_SPAM_FILTER:"configure_spam_filter",ACCESS_MEMBER_ACTIVITY_HISTORIES:"access_member_activity_histories",REGISTER_CALENDAR:"register_calendar",MANAGE_UPCOMING_SCHEDULE_PERIOD:"manage_upcoming_schedule_period",ADD_PAGE_LINK:"add_page_link",REMOVE_PAGE_LINK:"remove_page_link",APPLY_PAGE_LINK:"apply_page_link",BLOCK_COMMENT_AND_CHAT:"block_comment_and_chat",REPORT_BAND:"report_band",MANAGE_BAND_DO_NOT_DISTURB:"manage_band_do_not_disturb",MANAGE_MEMBER_GROUP:"manage_member_group",COPY_BAND_OPTION:"copy_band_option"}},LEAVE_STATE_CODE:{LEADER_CAN_LEAVE:1030,COLEADER_CAN_LEAVE:1031,MEMBER_CAN_LEAVE:1032,PAGE_BAND_REQUIRE_DELEGATE:1029,GROUP_BAND_LEADER_REQUIRE_DELEGATE:1005,COLEADER_REQUIRE_DELEGATE:1006},DO_NOT_DISTURB_INFO:{DEFAULT_START_AT:"00:00",DEFAULT_END_AT:"08:00",DEFAULT_START_OF_THE_WEEK:1,DAILY:{LABEL:IM("band.setting.do_not_disturb.daily"),VALUE:"daily"},DAYS_OF_WEEK:{LABEL:IM("band.setting.do_not_disturb.days_of_week"),VALUE:"days_of_week"}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=(n(9),n(44)),s=n(58);function a(e){return function(t){var n=t&&t.bandName?t.bandName:null;return i.compact([e,n]).join(" : ")}}var r=o.ACCESS_PERMISSION_TYPE,l={routingArea:o.WEB_MAIN_ROUTING_AREA.LFG_BAND,dLayout:o.D_LAYOUT.RECRUITING_BAND,mLoader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(112)]).then(n.t.bind(null,738,7))},mPageBuilder:function(e,t,n){return e.buildMRecruitingBandLayoutView(t.band_no)}},c={LFG_BAND_HOME:new o("/lfg/:band_no",a(),i.extend({},l,{accessPermissionType:r.ANYONE})),LFG_BAND_CHAT:new o("/lfg/:band_no/chat/:channel_id",a(),i.extend({},l,{accessPermissionType:r.ANYONE})),LFG_BAND_CHAT_VIDEO_CALL:new o("/lfg/:band_no/chat/:channel_id/video-call",null,i.extend({},l,{accessPermissionType:r.BAND_MEMBER,localBand:!0,dLayout:o.D_LAYOUT.SIMPLE,skipChangePageTitle:!0})),LFG_BAND_CHAT_VOICE_CALL:new o("/lfg/:band_no/chat/:channel_id/voice-call",null,i.extend({},l,{accessPermissionType:r.BAND_MEMBER,localBand:!0,dLayout:o.D_LAYOUT.SIMPLE,skipChangePageTitle:!0})),LFG_BAND_MEMBER:new o("/lfg/:band_no/member",a(),i.extend({},l,{accessPermissionType:r.BAND_MEMBER})),LFG_BAND_MEMBER_PRINT:new o("/lfg/:band_no/member-print",a(),i.extend({},l,{accessPermissionType:r.BAND_MEMBER,dLayout:o.D_LAYOUT.SIMPLE})),LFG_BAND_SETTING:new o("/lfg/:band_no/setting",a(IM("setting.band_setting")),i.extend({},l,{accessPermissionType:r.BAND_MEMBER})),LFG_BAND_SETTING_UPDATE:new o("/lfg/:band_no/setting/update",a(IM("setting.band_setting")),i.extend({},l,{accessPermissionType:r.BAND_MEMBER,dLayout:o.D_LAYOUT.GLOBAL_HOME,dElClass:s.EL.FULL_WIDE})),LFG_BAND_SETTING_COVER_UPDATE:new o("/lfg/:band_no/setting/cover-update",a(IM("setting.band_setting")),i.extend({},l,{accessPermissionType:r.BAND_MEMBER,dLayout:o.D_LAYOUT.GLOBAL_HOME,dElClass:s.EL.FULL_WIDE})),LFG_BAND_SETTING_MEMBER_WITHDRAWAL:new o("/lfg/:band_no/setting/member-withdrawal",a(IM("setting.band_setting")),i.extend({},l,{accessPermissionType:r.BAND_MEMBER})),LFG_BAND_SETTING_JOIN_CONDITION:new o("/lfg/:band_no/setting/join-condition",a(IM("setting.band_setting")),i.extend({},l,{accessPermissionType:r.BAND_MEMBER})),LFG_BAND_SETTING_BAND_TYPE:new o("/lfg/:band_no/setting/type",a(IM("setting.band_setting")),i.extend({},l,{accessPermissionType:r.BAND_MEMBER})),LFG_BAND_SETTING_INTRO:new o("/lfg/:band_no/setting/intro",a(IM("groupband.band_intro_description.title")),i.extend({},l,{accessPermissionType:r.BAND_MEMBER}))};e.exports=c},function(e,t,n){var i;void 0===(i=function(){return{TYPE:{INTERNAL:"internal",EXTERNAL:"external"},MAX_LENGTH_OF_CALENDAR_NAME:100,MAX_CALENDAR_COUNT:30,STATUS:{PROCESSING:"processing",SUCCESS:"success",ERROR:"error"},CALENDAR_PERSONAL_NOTICE_STATUS:{READY:"READY",SUCCESS:"SUCCESS",FAIL:"FAIL"},CALENDAR_IMPORT_STATUS:{PROCESSING:"processing",FINISHED:"finished",ERROR:"error"},CALENDAR_COLOR:["25b808","00b994","32b0e5","9370f0","ff5b72","ff703d","fdb00d","999999","5471d8","525a62","f875c0"]}}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(83),s=n(82),a=n(161),r=n(22),l=i.Model.extend({defaults:{bandNo:0,cover:null,memberCount:0,name:null,themeColor:null,isRecruiting:!1,recruitingMemberCapacity:0,currentUserPostingPermitted:!1},idAttribute:"bandNo",parse:function(e){var n=e.band,i={bandNo:n.band_no,name:n.name,themeColor:n.theme_color,type:"group"},o=a.createBandCore(i).getSkinColorClass(),s=1==((e.band||{}).properties||{})[r.PROPERTIES.POST_WITHOUT_APPROVAL],l=(e.member||{}).permitted_operation,c=t.contains(l,r.PERMITTED_OPERATION.POSTING),d=t.contains(l,r.PERMITTED_OPERATION.APPROVE_POST),u=c&&(s||d);return{bandNo:n.band_no,cover:n.cover,memberCount:n.member_count,name:n.name,themeColor:n.theme_color,isRecruiting:n.is_recruiting,recruitingMemberCapacity:n.recruiting_member_capacity,currentUserPostingPermitted:u,skinColorClassWithFilterDataBandCore:o}},getBandNo:function(){return this.get("bandNo")},getCoverThumbnail:function(){return s.make(this.get("cover"),s.TYPE.s75)},getMemberCount:function(){return this.get("memberCount")},getBandName:function(){return this.get("name")},getThemeColor:function(){return this.get("themeColor")},getBandWithFilterDataBandCore:function(){var e={bandNo:this.get("bandNo"),name:this.get("name"),themeColor:this.get("themeColor"),type:"group"};return a.createBandCore(e)}}),c=i.Collection.extend({model:l,initialize:function(e,t){this.filterName=t.filterName,this.returnFieldsWithBandFilter=t.returnFieldsWithBandFilter,this.excludeBandNos=t.excludeBandNos,this.includeRestricted=t.includeRestricted},fetchBandWithFilterDataCollection:function(){return o.getBandListWithFilter(this.filterName,this.returnFieldsWithBandFilter,this.includeRestricted).then(t.bind(this._setResultData,this))},_setResultData:function(e){var n=t.filter(e,(function(e){return null==this.excludeBandNos||0==this.excludeBandNos.length||this.excludeBandNos.indexOf(e.band.band_no)<0}),this);return this.reset(n,{parse:!0}),this}});return c.buildWithData=function(e){return new c(e,{parse:!0})},c.build=function(e,t,n,i){return new c([],{filterName:e,returnFieldsWithBandFilter:t,excludeBandNos:n||[],includeRestricted:i||!1})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(21),o=null,s=function(){return o||(o=i.getLoginV1Client()),o};return{getJoinForm:function(e,t){return i.getLoginV1ClientWithoutErrorAlert().send({url:"https://api.band.us/v1.6.2/get_join_form",data:{join_value:t,join_type:e}}).then((function(e){return e.result_data}))},makeApplication:function(e){return s().sendAndThenProcess({url:"https://api.band.us/v1.5.0/make_application",data:e,type:"post"})},joinBand:function(e){return s().sendAndThenProcess({url:"https://api.band.us/v1.6.0/join_band",data:e,type:"post"})},cancelApplication:function(e){return s().sendAndThenProcess({url:"https://api.band.us/v2.0.0/cancel_application",data:{band_no:e},type:"POST"})},getApplicationOfUser:function(e){return s().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_application_of_user",data:e})},getApplicationOfBand:function(e,n){return n=n||{},s().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_application_of_band",data:t.extend({band_no:e},n)})},getApplicationDetailInfo:function(e,t){return s().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_application_detail_info",data:{band_no:e,member_key:t}})},acceptApplication:function(e,t){return s().sendAndThenProcess({url:"https://api.band.us/v2.0.0/accept_application",data:{band_no:e,member_key:t},type:"POST"})},denyApplication:function(e,t){return s().sendAndThenProcess({url:"https://api.band.us/v2.0.0/deny_application",data:{band_no:e,member_key:t},type:"POST"})},setApplicantProfile:function(e,t,n){var i={band_no:e,applicant_name:t};return null!=n&&(i.applicant_profile_image_url=n),s().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_applicant_profile",data:i,type:"POST"})},getJoinInfo:function(e,t){var n={band_no:e};return t&&(n.member_key=t),s().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_join_info",data:n})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(2),n(0),n(21),n(506),n(17)],void 0===(o=function(e,t,n,i,o){return{getApiClient:function(){return this.apiClient||(this.apiClient=n.getLoginV1Client()),this.apiClient},_handleAcceptResult:function(e){if(1!=e.result_code){var t={ACCEPT_FAIL:1e3,CHANGE_JOIN_TYPE:1015};return e.result_data&&e.result_data.message&&alert(e.result_data.message),e.result_code===t.ACCEPT_FAIL?{resultType:"acceptFail",failInfo:o.queryStringToObject(e.result_data.url)}:e.result_code===t.CHANGE_JOIN_TYPE?{resultType:"changeJoinType"}:{resultType:"error"}}return{resultType:"success"}},deleteInvitationCard:function(e,t){return t=t||!1,this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.2.0/delete_invitation_card",data:{invitation_card_id:e,is_deny:t}})},deleteInvitationUrl:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.2.0/delete_invitation_url",data:{invitation_url_id:e}})},getInvitationCards:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.1.0/get_invitation_cards",data:{band_no:e}})},getInvitationUrls:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_invitation_urls",data:{band_no:e}})},getApplicationCount:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1/invitation/get_application_count",data:{band_no:e}})},reinvite:function(e,t){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.2.0/reinvite",data:{band_no:e,invitation_card_id:t}})},makeInvitationMessage:function(e,t){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.4.0/make_invitation_message",data:{band_no:e,type:t||"user_email"}})},inviteByBandMembers:function(e,t,n){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.2.0/invite_by_band_members",data:{band_no:e,invitee_user_nos:t,source_band_no:n}})},getPinCode:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.1.0/get_pin_code",data:{band_no:e}})},generatePinCode:function(e,t){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.2.0/generate_pin_code",data:{band_no:e,valid_hour:t}})},getInvitationCardDetailInfo:function(e){return this.getApiClient().send({url:"https://api.band.us/v1.5.0/get_invitation_detail_info",data:{invitation_card_id:e}}).then((function(e){return e.result_data}),(function(e){return e&&e.result_data&&e.result_data.message&&(e.result_code<200||e.result_code>=300)&&alert(e.result_data.message),e}))},getInvitationUrlDetailInfo:function(t){return n.getNoLoginV1Client().send({url:"https://api.band.us/v1.0.0/get_invitation_url_detail_info",data:{invitation_url_id:t}}).then((function(t){return 200==t.result_code?e.Deferred().reject(t).promise():t.result_data}))},makeInvitation:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.6.0/make_invitation",data:{key:e}})},verifyPinCode:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.3.0/verify_pin_code",type:"post",data:{code:e}}).fail((function(e){200!=e.result_code&&e.result_data&&e.result_data.message&&alert(e.result_data.message)}))}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(503),s=n(161),a=n(529),r=n(616),l=n(490),c=n(526),d=n(13),u=n(531),h=n(651),p=n(610),m=n(740),_=n(666),g=n(731),f=n(722),b=n(733),v=n(734),A=n(735),E=n(43),T=n(165),C=n(723),y=n(52);function M(e,t){return t=t||T.getCurrentTimezoneId(),e?E.tz(e,t):E.invalid()}var I=i.Model.extend({idAttribute:"scheduleId",defaults:function(){return{bandNo:null,scheduleId:null,scheduleType:c.NORMAL,band:null,owner:null,name:null,description:null,calendar:null,startAt:null,endAt:null,scheduleTimeZoneId:null,isAllDay:!1,isDelete:!1,isNew:!1,isUpdated:!1,updateNotificationAvailable:!1,isLunar:!1,lunarDateString:null,lunarEndDateString:null,startAtAsLunar:null,endAtAsLunar:null,birthdayUsers:new i.Collection([],{model:a}),photos:g.buildSchedulePhotoCollection([]),files:b.buildScheduleFileCollection([]),dropboxFiles:v.buildScheduleDropboxFileCollection([]),externalFiles:A.buildScheduleExternalFileCollection([]),alarms:new C([]),personalAlarms:new C([]),rsvp:null,location:null,recurrence:null,linkedPost:null,hasMoreLinkedPosts:!1,isLocalMeetup:!1,isSecret:!1,secretSharers:null}},toJSON:function(){return l.toRecursiveJSON(this)},parse:function(e,n){var o={};return e=y.camelizeKeys(e),n=n||{},o.bandNo=n.bandNo||e.bandNo||this.getBandNo(),o.scheduleType=e.scheduleType,o.scheduleId=e.scheduleId,e.band&&(o.band=s.createBandCoreWithAction(e.band)),e.owner&&(o.owner=new a(e.owner,{parse:!0})),o.name=e.name,o.description=e.description,e.calendar&&!t.isEmpty(e.calendar)&&(o.calendar=new _(e.calendar,{parse:!0})),o.startAt=e.startAt,o.endAt=e.endAt,o.scheduleTimeZoneId=e.scheduleTimeZoneId,o.isAllDay=e.isAllDay,o.isDelete=e.isDelete,o.isNew=e.isNew,o.isUpdated=e.isUpdated,o.updateNotificationAvailable=e.updateNotificationAvailable,o.isLunar=e.isLunar,o.lunarDateString=e.lunarDateString,o.lunarEndDateString=e.lunarEndDateString,o.startAtAsLunar=e.startAtAsLunar,o.endAtAsLunar=e.endAtAsLunar,o.isLocalMeetup=e.isLocalMeetup,o.isSecret=e.isSecret,o.secretSharers=f.buildScheduleSharerCollection(e.secretSharers),o.commentCount=e.commentCount,e.birthdayUsers&&!t.isEmpty(e.birthdayUsers)&&(o.birthdayUsers=new i.Collection(e.birthdayUsers,{model:a,parse:!0})),e.photos&&!t.isEmpty(e.photos)&&(o.photos=g.buildSchedulePhotoCollection(e.photos)),t.isEmpty(e.files)||(o.files=b.buildScheduleFileCollection(e.files||[])),t.isEmpty(e.dropboxFiles)||(o.dropboxFiles=v.buildScheduleDropboxFileCollection(e.dropboxFiles||[])),t.isEmpty(e.externalFiles)||(o.externalFiles=A.buildScheduleExternalFileCollection(e.externalFiles||[])),o.alarms=new C(e.alarms,{parse:!0}),o.personalAlarms=new C(e.personalAlarms,{parse:!0}),e.rsvp&&(o.rsvp=new p(e.rsvp,{parse:!0})),e.location&&(o.location=new r(e.location,{parse:!0})),e.recurrence&&(o.recurrence=new h(e.recurrence,{parse:!0})),e.linkedPost&&(o.linkedPost=new m(e.linkedPost,{parse:!0}),o.hasMoreLinkedPosts=e.hasMoreLinkedPosts),o},getScheduleId:function(){return this.get("scheduleId")},setScheduleId:function(e){this.set("scheduleId",e)},setScheduleIdSilently:function(e){this.set("scheduleId",e,{silent:!0})},isScheduleIdExist:function(){return!t.isEmpty(this.getScheduleId())},getName:function(){return this.get("name")},getDescription:function(){return this.get("description")},setStartAt:function(e){this.set("startAt",e)},getStartAtMoment:function(){return M(this.getStartAt(),this.getScheduleTimeZoneId())},getStartAtAsLunarMoment:function(){return M(this.getStartAtAsLunar(),this.getScheduleTimeZoneId())},getEndAtMoment:function(){return M(this.get("endAt"),this.getScheduleTimeZoneId())},setEndAt:function(e){this.set("endAt",e)},getEndAtAsLunar:function(){return this.get("endAtAsLunar")},setEndAtAsLunar:function(e){this.set("endAtAsLunar",e)},getEndAtAsLunarMoment:function(){return M(this.getEndAtAsLunar(),this.getScheduleTimeZoneId())},getStartAt:function(){return this.get("startAt")},getStartAtAsLunar:function(){return this.get("startAtAsLunar")},setStartAtAsLunar:function(e){this.set("startAtAsLunar",e)},getScheduleTimeZoneId:function(){return this.get("scheduleTimeZoneId")||T.getCurrentTimezoneId()},setScheduleTimeZoneId:function(e){this.set("scheduleTimeZoneId",e)},getCommentCount:function(){return this.get("commentCount")},setCommentCountSilently:function(e){this.set("commentCount",e,{silent:!0})},getPhotoCount:function(){return this.get("photos").length},getFileCount:function(){return this.getFiles().length},getPhotos:function(){return this.get("photos")},setPhotos:function(e){this.set("photos",e)},isDelete:function(){return!!this.get("isDelete")},isAllDay:function(){return 1==this.get("isAllDay")},setIsAllDay:function(e){this.set("isAllDay",e)},isLunar:function(){return 1==this.get("isLunar")},setIsLunar:function(e){this.set("isLunar",e)},getFiles:function(){return this.get("files")},setFiles:function(e){this.set("files",e)},getDropboxFiles:function(){return this.get("dropboxFiles")},setDropboxFiles:function(e){this.set("dropboxFiles",e)},getExternalFiles:function(){return this.get("externalFiles")},setExternalFiles:function(e){this.set("externalFiles",e)},isNotEmptyPhotos:function(){return!this.getPhotos().isEmpty()},_isNotEmptyFiles:function(){return!this.getFiles().isEmpty()},_isNotEmptyDropboxFiles:function(){return!this.getDropboxFiles().isEmpty()},_isNotEmptyExternalFiles:function(){return!this.getExternalFiles().isEmpty()},isEmptyPhotos:function(){return this.getPhotos().isEmpty()},isNotEmptyAllFiles:function(){return this._isNotEmptyFiles()||this._isNotEmptyDropboxFiles()||this._isNotEmptyExternalFiles()},hasRsvp:function(){return this.has("rsvp")},hasDifferentTimezone:function(){if(this.has("scheduleTimeZoneId")){var e=T.getCurrentTimezone();return this.get("scheduleTimeZoneId")!=e.id}return!1},isLocalMeetup:function(){return this.get("isLocalMeetup")},setIsLocalMeetup:function(e){this.set("isLocalMeetup",e)},isSecret:function(){return this.get("isSecret")},setIsSecret:function(e){this.set("isSecret",e)},getSecretSharers:function(){return this.get("secretSharers")},setSecretSharers:function(e){this.set("secretSharers",e)},createSecretSharers:function(e){this.setSecretSharers(f.buildScheduleSharerCollection(e))},getSafeSecretSharers:function(){return this.getSecretSharers()||this.createSecretSharers(),this.getSecretSharers()},fetchSchedule:function(e){var n=this.get("bandNo"),i=this.get("scheduleId"),s=this.get("purpose");return o.getSchedule(n,i,!1,e,s).then(t.bind((function(e){this.set(this.parse(e))}),this))},toJSONForSave:function(e){var t={};if(e&&e.isPostAttached&&this.isScheduleIdExist())return t.schedule_id=this.get("scheduleId"),t;t.name=this.get("name"),t.is_local_meetup=this.isLocalMeetup(),this.has("description")&&(t.description=this.get("description")),this.has("calendar")&&(t.calendar={calendar_id:this.get("calendar").get("calendarId"),is_default:this.get("calendar").get("isDefault")}),this.get("isLunar")?(t.start_at=this.get("startAtAsLunar"),this.has("endAtAsLunar")&&(t.end_at=this.get("endAtAsLunar"))):(t.start_at=this.getStartAt(),this.has("endAt")&&(t.end_at=this.get("endAt"))),t.is_all_day=!!this.get("isAllDay"),t.is_lunar=!!this.get("isLunar"),t.is_secret=this.isSecret(),this.getSecretSharers()&&0!==this.getSecretSharers().length&&(t.secret_sharers=this.getSecretSharers().map((function(e){return{user_no:e.getUserNo()}}))),this.has("scheduleTimeZoneId")&&(t.schedule_time_zone_id=this.get("scheduleTimeZoneId")),this.isNotEmptyPhotos()?t.photos=this.get("photos").map((function(e){return e.toJSONForSave()})):t.photos=[];var n=(e||{}).isPostAttached||!1;return this._isNotEmptyFiles()?t.files=this.getFiles().map((function(e){return e.toJSONForSave(n)})):t.files=[],this._isNotEmptyDropboxFiles()?t.dropbox_files=this.getDropboxFiles().map((function(e){return e.toJSONForDropboxFileSave(n)})):t.dropbox_files=[],this._isNotEmptyExternalFiles()?t.external_files=this.getExternalFiles().map((function(e){return e.toJSONForExternalFileSave(n)})):t.external_files=[],this.get("alarms").isEmpty()?t.alarms=[]:t.alarms=this.get("alarms").map((function(e){return e.toJSONForSave()})),this.has("location")&&(t.location={name:this.get("location").get("name"),latitude:this.get("location").get("latitude"),longitude:this.get("location").get("longitude")}),this.has("recurrence")&&(t.recurrence=this.get("recurrence").toJSONForSave()),this.has("rsvp")&&(t.rsvp=this.get("rsvp").toJSONForSave(),e&&e.isPostAttached&&(t.has_rsvp=!0)),t},createSchedule:function(e){return o.createSchedule(this.get("bandNo"),this.toJSONForSave(),e,u.API_CONSTANT.SCHEDULE_CREATE).then(t.bind((function(e){this.set(this.parse(e.schedule))}),this))},copyEditedSchedule:function(e,t,n,i,s){return o.createSchedule(i,this.toJSONForSave(),e,u.API_CONSTANT.SCHEDULE_COPY,t,n,s)},updateSchedule:function(e,n){var i=this.get("bandNo"),s=this.toJSONForSave(),a=this.get("scheduleId");return o.updateSchedule(i,a,s,e,n).then(t.bind((function(e){this.set(this.parse(e.schedule))}),this))},checkScheduleCreation:function(){var e=this.get("bandNo"),t=this.toJSONForSave({isPostAttached:!0});return o.checkScheduleCreation(e,t)},deleteSchedule:function(e,n){var i=this.get("bandNo"),s=this.get("scheduleId");return o.deleteSchedule(i,s,e,n).then(t.bind((function(){this.set("isDelete",!0)}),this))},copySchedule:function(e){return o.copySchedule(this.get("bandNo"),this.get("scheduleId"),e)},getScheduleType:function(){return this.get("scheduleType")},isNormalScheduleType:function(){return this.getScheduleType()==c.NORMAL},isExternalScheduleType:function(){return this.getScheduleType()==c.EXTERNAL},getOwner:function(){return this.get("owner")},setOwner:function(e){return this.set("owner",e)},getOwnerName:function(){var e=this.getOwner();return e&&e.getName()},getBandCore:function(){return this.get("band")},getBandNo:function(){return this.get("bandNo")},getCreatedAt:function(){return this.get("createdAt")},getAlarms:function(){return this.get("alarms")},setAlarms:function(e){this.set("alarms",e)},getCalendar:function(){return this.get("calendar")},getRsvp:function(){return this.get("rsvp")},setRsvp:function(e){this.set("rsvp",e)},getRecurrence:function(){return this.get("recurrence")},setRecurrence:function(e){this.set("recurrence",e)},getLocation:function(){return this.get("location")},setLocation:function(e){this.set("location",e)},isMySchedule:function(){var e=this.getOwner();return!!e&&e.isMyself()},setName:function(e){this.set("name",e)},setDescription:function(e){this.set("description",e)},setCalendar:function(e){this.set("calendar",e)},clearEditableAttrsSilently:function(){this.set({name:null,description:null,calendar:null,isLunar:!1,startAt:null,endAt:null,startAtAsLunar:null,endAtAsLunar:null,isAllDay:!1,scheduleTimeZoneId:null,photos:g.buildSchedulePhotoCollection([]),files:b.buildScheduleFileCollection([]),dropboxFiles:v.buildScheduleDropboxFileCollection([]),externalFiles:A.buildScheduleExternalFileCollection([]),alarms:new C([]),location:null,recurrence:null,rsvp:null},{silent:!0})}});return I.createScheduleModel=function(e,t){return new I({bandNo:e,purpose:t})},I.createExistingScheduleModel=function(e,t,n){var i=I.createScheduleModel(e,n);return i.setScheduleId(t),i},I.createScheduleModelByJSON=function(e){return new I(e,{parse:!0})},I.prepareApiResponseForCopySchedule=function(e){delete e.schedule_id,delete e.band_no,delete e.calendar,delete e.created_at,delete e.owner,delete e.is_secret,e.secret_sharers=[],e.owner={user_no:d.getUserData().getUserNo()},t.isEmpty(e.files)||t.each(e.files,(function(e){e.id=e.sos_id,delete e.schedule_id})),t.isEmpty(e.dropbox_files)||t.each(e.dropbox_files,(function(e){delete e.file_id,delete e.schedule_no})),t.isEmpty(e.external_files)||t.each(e.external_files,(function(e){delete e.file_id,delete e.schedule_no}))},I.prepareApiResponseForEditingReservedPostSchedule=function(e){t.isEmpty(e.files)||t.each(e.files,(function(e){e.id=e.sos_id}))},I}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{QUALITY_360:"360p",QUALITY_480:"480p"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(694),s=n(525),a=(n(509),i.Collection.extend({model:o,fetchEmotions:function(e){var t=e.emotionType?e.emotionType:null;return this._beforeFetchEmotions(s.getEmotions({band_no:e.bandNo,content_key:e.contentKey.toApiParams(!0),type:t}))},fetchChatMessageEmotions:function(e,t,n,i){return this._beforeFetchEmotions(s.getMessageEmotions(e,t,n,i))},_beforeFetchEmotions:function(e){return this._loading=!0,this.reset(),this.totalCount=0,e.then(t.bind((function(e){return this._countMap=e.count,this.totalCount=this._sumUpCounts(this._countMap),this._emotions=e.emotions||[],window.isDesktopView?this.addNextPage():this.add(this._emotions,{parse:!0}),this.trigger("EmotionCollection:fetchComplete"),this._loading=!1,this}),this),t.bind((function(){this._loading=!1}),this))},addNextPage:function(){this._emotions.length>0&&this.add(this._emotions.splice(0,20),{parse:!0})},hasMorePages:function(){return this._emotions.length>0},_sumUpCounts:function(e){return t.chain(e).values().reduce((function(e,t){return e+t}),0).value()},isLoading:function(){return!!this._loading},getCountMap:function(){return t.clone(this._countMap)},getTotalCount:function(){return this.totalCount||this.size()},getActorUserNo:function(e){var t=this.at(e);return null!=t?t.get("actorUserNo"):null}}));return a.buildByResponse=function(e){return new a(e,{parse:!0})},a.build=function(){return new a},a}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{BAND_JOIN_APPLICANT_COMMENT_MAX_LENGTH:500,INPUT_PHOTO_DATA_KEY:"photo-url",INPUT_PHOTO_IMG_SELECTOR:"._inputPhotoImg",INPUT_PHOTO_DELETE_BUTTON_SELECTOR:"._deleteAttachedPhoto",INPUT_PHOTO_SELECTOR:"._inputPhoto"}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(){var e=864e5,t={EVERYDAY:"everyday",WEEKDAY:"weekday",SIX_TIMES_A_WEEK:"six_times_a_week",FIVE_TIMES_A_WEEK:"five_times_a_week",FOUR_TIMES_A_WEEK:"four_times_a_week",THREE_TIMES_A_WEEK:"three_times_a_week",TWICE_A_WEEK:"twice_a_week",ONCE_A_WEEK:"once_a_week"};return{MISSION_DURATIONS:[7*e,14*e,30*e,50*e,60*e,90*e,100*e,200*e,300*e,365*e],MISSION_FREQUENCY:[t.EVERYDAY,t.WEEKDAY,t.SIX_TIMES_A_WEEK,t.FIVE_TIMES_A_WEEK,t.FOUR_TIMES_A_WEEK,t.THREE_TIMES_A_WEEK,t.TWICE_A_WEEK,t.ONCE_A_WEEK],MISSION_SETTING:{DIRECT_PERIOD_MAX_LENGTH:365},MISSION_FREQUENCY_ITEM:t,DAY_MS:e,EXAMPLE_TYPE:{GOOD_EXAMPLE:"GOOD_EXAMPLE",BAD_EXAMPLE:"BAD_EXAMPLE"},CONFIRM_STATUS:{NOT_YET_CONFIRMED:"not_yet_confirmed",ALREADY_CONFIRMED:"already_confirmed",CONFIRM_DISABLED:"confirm_disabled"},CONFIRM_PERIOD_TYPE:{ALL:"ALL",WEEKLY:"WEEKLY",DAILY:"DAILY"},REMIND_STATE:{REMIND_DISABLED:"remind_disabled",REMIND_ENABLED:"remind_enabled"},MEMBERS_FILTER_URL_PARAM_NAME:"filter"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,IME:229,FORWARD_SLASH:191,QUESTION_MARK:191,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90}}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(10),i=n(0),o=n(2),s=n(16),a=n(52),r=n(489),l=n(520),c=n(783),d=n(805),u=n(855),h=n(501),p=n(563),m=n(517),_=n(152),g=n(176),f=n(158),b=n(652),v=(n(625),n(713)),A=(n(615),n(712)),E=n(549),T=n(617),C=n(658),y=n(602),M=n(161),I=n(22),S=n(688),w=n(57),N=n(787),D=_.POST_ATTACHMENT_TYPE,L="off",O="notice",P="major_notice",x=r.extend({idAttribute:"postNo",defaults:function(){var e={postNo:null,createdAt:null,publishesAt:null,reservationTimeZoneId:null,reservedPostId:null,bandNoticeUnsetAt:null,bandNoticeTimeZoneId:null,hasFailed:!1,content:null,attention:null,viewType:null,webUrl:null,readCount:0,memberReadCount:0,commentCount:0,emotionCount:0,sharedCount:0,isAuthor:!1,isRestricted:!1,isNotice:!1,isMajorNotice:!1,isLinkedBandNotice:!1,isShareable:!1,isBookmarked:!1,copiableState:null,band:null,author:null,featuredComment:null,emotionByViewer:null,sharedPost:null,sharedPagePost:null,album:null,commonEmotionType:null,emotionTypeByViewer:null,isTranslatable:!1,writtenIn:null,approvablePostId:null,attachment:this._defaultAttachment(),mission:null,shouldDisableComment:!1,setHashtags:null,pinnedHashtagsInContent:null,isVisibleOnlyToAuthor:null,isRecoverableByViewer:null,punishedAt:null};return this.originAttach={photoAlbum:!1,poll:!1,todo:!1,billSplit:!1,schedule:!1,sharedPostSnippet:!1,sharedPagePostSnippet:!1,subpost:!1,pollV2:!1,todoV2:!1,attendanceCheck:!1,sticker:!1,promotionPhoto:!1,photo:!1,video:!1,file:!1,dropboxFile:!1,externalFile:!1,location:!1,snippet:!1,addon:!1,signup:!1,audio:!1,quiz:!1,survey:!1},e},_defaultAttachment:function(){return{todoV1:null,pollV1:null,billSplit:null,sharedPostSnippet:null,sharedPagePostSnippet:null,photoAlbum:null,subpost:null,sticker:new u,video:new u,photo:new u,promotionPhoto:new u,file:new u,dropboxFile:new u,externalFile:new u,snippet:new u,attendanceCheck:new u,location:new u,todoV2:new u,pollV2:new u,signup:new u,addon:new u,audio:new u,scheduleGroup:new u,quiz:new u,survey:new u}},parse:function(e,t){e=a.camelizeKeys(e);var n=i.extend(this.defaults(),{postNo:e.postNo,createdAt:e.createdAt,publishesAt:e.publishesAt,reservedPostId:e.reservedPostId,approvablePostId:e.approvablePostId,hasFailed:e.hasFailed||!1,content:e.content&&e.content.replace('<band:attachment type="schedule" />','<band:attachment type="schedule_group" id="1" />'),attention:e.attention,viewType:e.viewType,webUrl:e.webUrl,readCount:e.readCount||0,memberReadCount:e.memberReadCount||0,commentCount:e.commentCount||0,emotionCount:e.emotionCount||0,sharedCount:e.sharedCount||0,isRestricted:e.isRestricted||!1,isNotice:e.isNotice||!1,isMajorNotice:e.isMajorNotice||!1,isShareable:e.isShareable||!1,isBookmarked:e.isBookmarked||!1,copiableState:e.copiableState,commonEmotionType:e.commonEmotionType,isTranslatable:e.isTranslatable||!1,writtenIn:e.writtenIn,isLinkedBandNotice:e.isLinkedBandNotice||null,reservationTimeZoneId:e.reservationTimeZoneId||null,bandNoticeUnsetAt:e.bandNoticeUnsetAt,bandNoticeTimeZoneId:e.bandNoticeTimeZoneId||null,shouldDisableComment:e.shouldDisableComment,setHashtags:e.setHashtags||[],pinnedHashtagsInContent:e.pinnedHashtagsInContent||[],isVisibleOnlyToAuthor:e.isVisibleOnlyToAuthor,isRecoverableByViewer:e.isRecoverableByViewer,punishedAt:e.punishedAt});e.band&&(n.band=M.createBandCoreWithAction(e.band)),e.author&&(n.author=new h(e.author,{parse:!0}),n.isAuthor=n.author.isMyself()),e.emotionByViewer&&(n.emotionTypeByViewer=e.emotionByViewer.type),i.isEmpty(e.attachment)||(n.attachment=i.extend(n.attachment,this._parseAttachmentResponse(e.attachment,{bandNo:n.band.bandNo,postNo:n.postNo,isAuthor:!!n.author&&n.author.isMyself()}))),e.mission&&(n.mission=new S(e.mission,{parse:!0}));var o=_.findPriorRestriction({isRestricted:e.isRestricted,isVisibleOnlyToAuthor:e.isVisibleOnlyToAuthor,isMutedAuthorPost:!!e.author&&e.author.isMuted});return o&&(this._originalRestriction=o,this._originalContent=n.content,this._originalAttachment=n.attachment,o===_.RESTRICTION_TYPE.HIDE_POST&&(n.content=IM("post.hidden_post.guide_message")),o===_.RESTRICTION_TYPE.MUTE_AUTHOR&&(n.content=IM("post.muted_author_post.guide_message")),n.attachment=this._defaultAttachment()),this.originAttach={photoAlbum:!!n.attachment.photoAlbum,poll:!!n.attachment.poll,todo:!!n.attachment.todo,billSplit:!!n.attachment.billSplit,sharedPostSnippet:!!n.attachment.sharedPostSnippet,sharedPagePostSnippet:!!n.attachment.sharedPagePostSnippet,subpost:!!n.attachment.subpost,pollV2:n.attachment.pollV2.length()>0,todoV2:n.attachment.todoV2.length()>0,attendanceCheck:n.attachment.attendanceCheck.length()>0,sticker:n.attachment.sticker.length()>0,promotionPhoto:n.attachment.promotionPhoto.length()>0,photo:n.attachment.photo.length()>0,video:n.attachment.video.length()>0,file:n.attachment.file.length()>0,dropboxFile:n.attachment.dropboxFile.length()>0,externalFile:n.attachment.externalFile.length()>0,location:n.attachment.location.length()>0,snippet:n.attachment.snippet.length()>0,addon:n.attachment.addon.length()>0,signup:n.attachment.signup.length()>0,audio:n.attachment.audio.length()>0,scheduleGroup:n.attachment.scheduleGroup.length()>0,quiz:n.attachment.quiz.length()>0,survey:n.attachment.survey.length()>0},n},_parseAttachmentResponse:function(e,t){var n={};if(e.billSplit&&(n.billSplit=p.createBillSplit(i.extend(e.billSplit,t))),this._parseScheduleAttachment(e,t,n),e.todo&&(n.todo=p.createTodoV1(i.extend(e.todo,t))),e.poll&&(n.poll=p.createPollV1(i.extend(e.poll,t))),e.sharedPostSnippet&&(e.sharedPostSnippet.band.type=I.BAND_TYPE.GROUP,n.sharedPostSnippet=p.createSharedPostSnippetModel(e.sharedPostSnippet)),e.sharedPagePostSnippet&&(n.sharedPagePostSnippet=p.createSharedPagePostSnippetModel(e.sharedPagePostSnippet)),e.photoAlbum&&(n.photoAlbum=p.createPhotoAlbum(e.photoAlbum)),e.subpost&&(n.subpost=p.createSubpost(e.subpost)),e.sticker&&(n.sticker=new u(e.sticker,{factoryFunction:p.createSticker})),e.video&&(n.video=new u(e.video,{factoryFunction:p.createVideo})),e.photo&&(n.photo=new u(e.photo,{factoryFunction:p.createPhoto})),e.promotionPhoto&&(n.promotionPhoto=new u(e.promotionPhoto,{factoryFunction:p.createPromotionPhoto})),e.file&&(n.file=new u(e.file,{factoryFunction:p.createFile})),e.dropboxFile&&(n.dropboxFile=new u(e.dropboxFile,{factoryFunction:p.createDropboxFile})),e.externalFile&&(n.externalFile=new u(e.externalFile,{factoryFunction:p.createExternalFile})),e.snippet&&(n.snippet=new u(e.snippet,{factoryFunction:p.createSnippet})),e.attendanceCheck&&(n.attendanceCheck=new u(e.attendanceCheck,{factoryFunction:p.createAttendanceCheck})),e.location&&(n.location=new u(e.location,{factoryFunction:p.createLocation})),e.todoV2){var o=i.mapObject(e.todoV2,(function(e){return i.extend(e,t)}));n.todoV2=new u(o,{factoryFunction:p.createTodoV2})}if(e.pollV2){var s=i.mapObject(e.pollV2,(function(e){return i.extend(e,t)}));n.pollV2=new u(s,{factoryFunction:p.createPollV2})}if(e.signup){var a=i.mapObject(e.signup,(function(e){return i.extend(e,t)}));n.signup=new u(a,{factoryFunction:p.createSignup})}if(e.addon){var r=i.mapObject(e.addon,(function(e){return i.extend(e,t)}));n.addon=new u(r,{factoryFunction:p.createAddon})}if(e.audio){var l=i.mapObject(e.audio,(function(e){return i.extend(e,t)}));n.audio=new u(l,{factoryFunction:p.createAudio})}if(e.quiz){var c=i.mapObject(e.quiz,(function(e){return i.extend(e,t)}));n.quiz=new u(c,{factoryFunction:p.createRichQuiz})}if(e.survey){var d=i.mapObject(e.survey,(function(e){return i.extend(e,t)}));n.survey=new u(d,{factoryFunction:p.createRichSurvey})}return n},_parseScheduleAttachment:function(e,t,n){if(e.schedule&&(e.scheduleGroup={1:{schedules:[e.schedule],seq:1}}),e.scheduleGroup){var o=i.mapObject(e.scheduleGroup,(function(e){return i.each(e.schedules,(function(e){e.bandNo=t.bandNo})),i.extend(e,t)}));n.scheduleGroup=new u(o,{factoryFunction:p.createScheduleGroup})}},resetUncoveredOnce:function(){this._uncoveredOnce=!1},uncoverOnce:function(){this._uncoveredOnce=!0,this._originalRestriction===_.RESTRICTION_TYPE.HIDE_POST?this.set("isVisibleOnlyToAuthor",!1,{silent:!0}):this._originalRestriction===_.RESTRICTION_TYPE.MUTE_AUTHOR&&this.getAuthor().set("isMuted",!1,{silent:!0}),this._originalContent&&this.set("content",this._originalContent,{silent:!0}),this._originalAttachment&&this.set("attachment",this._originalAttachment,{silent:!0})},getOriginalRestriction:function(){return this._originalRestriction},getBand:function(){return this.get("band")},getBandCore:function(){return this.get("band")},getBandNo:function(){return this.getBand()?this.getBand().bandNo:null},getBandName:function(){return this.getBand()?this.getBand().name:null},getPostNo:function(){return this.get("postNo")},getPostModelId:function(){return m.makeModelId(this.getBandNo(),this.getPostNo())},getAuthor:function(){return this.get("author")},isMutedAuthorPost:function(){var e=this.getAuthor();return!!e&&e.isMutedAuthor()},isRestricted:function(){return this.get("isRestricted")},isUncoveredOnce:function(){return this._uncoveredOnce},getAttachment:function(e){return this.get("attachment")[e]},getCommentCount:function(){return this.get("commentCount")},getEmotionCount:function(){return this.get("emotionCount")},getTodoCount:function(){var e=this.getAttachment(D.TODO_V2).length();return this.hasTodoV1()&&(e+=1),e},getPollCount:function(){var e=this.getAttachment(D.POLL_V2).length();return this.hasPollV1()&&(e+=1),e},getSignupCount:function(){return this.getAttachment(D.SIGNUP).length()},getInternalFileCount:function(){return this.getAttachment(_.POST_ATTACHMENT_TYPE.FILE)?this.getAttachment(_.POST_ATTACHMENT_TYPE.FILE).length():0},getDropboxFileCount:function(){return this.getAttachment(_.POST_ATTACHMENT_TYPE.DROPBOX_FILE)?this.getAttachment(_.POST_ATTACHMENT_TYPE.DROPBOX_FILE).length():0},getExternalFileCount:function(){return this.getAttachment(_.POST_ATTACHMENT_TYPE.EXTERNAL_FILE)?this.getAttachment(_.POST_ATTACHMENT_TYPE.EXTERNAL_FILE).length():0},getFileCount:function(){return this.getInternalFileCount()+this.getDropboxFileCount()+this.getExternalFileCount()},getAddonCount:function(){return this.getAttachment(_.POST_ATTACHMENT_TYPE.ADDON).length()},getScheduleGroupCount:function(){return this.getAttachment(_.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP).length()},getApprovablePostId:function(){return this.get("approvablePostId")},validate:function(e,t){if(this.hasUnmatchedAttachments())return IM("web.postwrite.alert.not_allowed_attach");if(!this.hasAttachment()&&!o.trim(e.content))return IM("web.postwrite.alert.input_body");if(e.content&&f.extractRichPostContentText(e.content).length>_.BODY_MAX_LENGTH)return IM("web.postwrite.alert.body_length_too_long",{limit:_.BODY_MAX_LENGTH});if(e.publishesAt&&e.reservedPostId)if(e.hasFailed){if(s(e.publishesAt).isBefore(this.getMinimumReserveTime()))return IM("web.postwrite.alert.reservation_time_min")}else if(s(e.publishesAt).isBefore(s()))return IM("web.postwrite.alert.already_posted")},getMinimumReserveTime:function(){var e=s().add(30,"m").startOf("minute");return e.add(10-e.minute()%10,"m").second(0)},isModifiableInMW:function(){if(i.some(_.MW_NON_EDITABLE_ATTACHMENT_TYPES,i.bind((function(e){return this.hasAttachment(e)}),this)))return!1;var e=R(this.get("content"));if(i.findLastIndex(e,(function(e){return"string"==typeof e}))>0)return!1;var t=i.map(e,(function(e){return"string"==typeof e?"text":a.camelize(e.type)})),n=i.sortBy(t,(function(e){return"text"==e?-1:_.MW_EDITABLE_ATTACHMENT_TYPES.indexOf(e)}));if(!i.isEqual(t,n))return!1;if(this.getAttachment(D.STICKER).length()>1)return!1;var o=this.getAttachment(D.VIDEO).length(),s=this.getAttachment(D.PHOTO).length();return!(o>1||s>100)},hasUnmatchedAttachments:function(){var e=R(this.get("content")),t=i.groupBy(e,(function(e){return e.type})),n=i.some(_.SINGLE_ATTACHMENT_TYPES,i.bind((function(e){var n=(t[e]||[])[0],i=this.getAttachment(e);return!(!n||i)||!(n||!i)}),this));return!!n||(n=i.some(_.MAP_ATTACHMENT_TYPES,i.bind((function(e){var n=(t[e]||[]).map((function(e){return e.id})),o=this.getAttachment(e).keys(),s=i.difference(n,o);if(!i.isEmpty(s))return!0;var a=i.difference(o,n);return!i.isEmpty(a)}),this)))},removeUnmatchedAttachments:function(){var e=R(this.get("content")),t=i.groupBy(e,(function(e){return e.type}));i.each(_.SINGLE_ATTACHMENT_TYPES,i.bind((function(e){var n=(t[e]||[])[0],i=this.getAttachment(e);if(!n&&i&&this.setAttachment(e,this._defaultAttachment()[e]),n&&!i){var o=b.makeAttachmentTag(n.type,n.id);this.set("content",this.get("content").replace(o,""))}}),this)),i.each(_.MAP_ATTACHMENT_TYPES,i.bind((function(e){var n=(t[e]||[]).map((function(e){return e.id})),o=this.getAttachment(e).keys(),s=i.difference(n,o);i.each(s,i.bind((function(t){var n=b.makeAttachmentTag(e,t);this.set("content",this.get("content").replace(n,""))}),this));var a=i.difference(o,n);i.each(a,i.bind((function(t){this.getAttachment(e).unset(t)}),this))}),this))},toJSONForSave:function(e){this.hasUnmatchedAttachments()&&this.removeUnmatchedAttachments(),this.hasSignup()&&this._setSignupSeq();var n=this.get("content"),o={band_no:this.getBandNo(),content:w.isMac()?n.normalize("NFC"):n,set_band_notice:this.get("isNotice"),set_major_band_notice:this.get("isMajorNotice"),set_linked_band_notice:this.get("isLinkedBandNotice"),copiable_state:this.get("copiableState"),should_disable_comment:!0===this.get("shouldDisableComment")};e||(delete o.set_band_notice,delete o.set_major_band_notice,o.notice_state=this._setNoticeState()),this.get("publishesAt")&&(o.publishes_at=this.get("publishesAt"),this.get("reservedPostId")&&(o.reserved_post_id=this.get("reservedPostId")),this.get("reservationTimeZoneId")&&(o.reservation_time_zone_id=this.get("reservationTimeZoneId"))),this.get("bandNoticeUnsetAt")?(o.band_notice_unset_at=this.get("bandNoticeUnsetAt"),this.get("bandNoticeTimeZoneId")&&(o.band_notice_time_zone_id=this.get("bandNoticeTimeZoneId"))):o.band_notice_unset_at=null,this.get("approvablePostId")&&(o.approvable_post_id=this.get("approvablePostId"));var s=this.get("album");return s&&this.isNew()&&this.hasPhotoOrVideo()&&(o.album_no=s.get("albumNo")),i.each(_.SINGLE_ATTACHMENT_SYSTEM_CREATED_TYPES,i.bind((function(e){!this.hasAttachment(e)&&this.originAttach[e]&&(o[t.underscored(e)]=null)}),this)),i.each(_.SINGLE_ATTACHMENT_USER_CREATED_TYPES,i.bind((function(e){if(this.hasAttachment(e)){var n=this.getAttachment(e).toJSONForSave();n&&(o[t.underscored(e)]="string"==typeof n?n:JSON.stringify(n))}else this.originAttach[e]&&(o[t.underscored(e)]=null)}),this)),i.each(_.MAP_ATTACHMENT_TYPES,i.bind((function(n){this.hasAttachment(n)?o[t.underscored(n)]=this.getAttachment(n).toJSONForSave(e):this.originAttach[n]&&(o[t.underscored(n)]=null)}),this)),o},fetchPost:function(e,t,n){return e=e||this.getBandNo(),t=t||this.getPostNo(),o.when(l.getRichPost(e,t,n),g.fetchBandJoin()).then(i.bind((function(e){return"copy"===n?this._prepareApiResponseForCopy(e):(this.set(this.parse(e)),this)}),this))},_setSignupSeq:function(){var e=(this.get("content")||"").match(/<band:attachment type="signup" id=".+?".*?>/g),t=i.map(e,(function(e){return e.match(/id="(.+?)"/,"$1")[1]}));i.each(t,(function(e){var t=e?this.attachment.get(e):null;t&&(t.setSignupSeq(this.seq),this.seq+=1)}),{seq:0,attachment:this.getAttachment(D.SIGNUP)})},_setNoticeState:function(){return this.get("isNotice")&&this.get("isMajorNotice")?P:this.get("isNotice")?O:L},_prepareApiResponseForCopy:function(e){var t=e.attachment;if(i.isEmpty(t.schedule)||E.prepareApiResponseForCopySchedule(t.schedule),!i.isEmpty(t.schedule_group)){var n=t.schedule_group;i.each(n,(function(e){e.schedules=i.filter(e.schedules,(function(e){return!e.is_delete})),i.each(e.schedules,(function(e){E.prepareApiResponseForCopySchedule(e)}))})),i.each(i.keys(n),(function(e){var t=n[e];t&&!i.isEmpty(t.schedules)||delete n[e]}))}return i.isEmpty(e.attachment.todo_v2)||i.each(e.attachment.todo_v2,(function(e){v.prepareApiResponseForCopy(e)})),i.isEmpty(e.attachment.poll_v2)||i.each(e.attachment.poll_v2,(function(e){A.prepareApiResponseForCopy(e)})),i.isEmpty(e.attachment.addon)||i.each(e.attachment.addon,(function(e){T.prepareApiResponseForCopy(e)})),i.isEmpty(e.attachment.quiz)||i.each(e.attachment.quiz,(function(e){C.prepareApiResponseForCopy(e)})),i.isEmpty(e.attachment.survey)||i.each(e.attachment.survey,(function(e){y.prepareApiResponseForCopy(e)})),b.prepareSnippetForCopying(e).then(i.bind((function(){return this.set(this.parse(e)),this}),this))},fetchPostDetail:function(e,t,n,s){return e=e||this.getBandNo(),t=t||this.getPostNo(),o.when(l.getRichPostDetail(e,t,n,s),g.fetchBandJoin()).then(i.bind((function(e){return this.emotions=e.emotions,this.set(this.parse(e.post)),this}),this))},fetchReservedPost:function(e,t,n){return e=e||this.getBandNo(),t=t||this.get("reservedPostId"),o.when(c.getReservedPost(e,t),g.fetchBandJoin()).then(i.bind((function(e){var t=e.attachment||{},o=t.schedule;return n&&(i.isEmpty(o)||E.prepareApiResponseForEditingReservedPostSchedule(o),i.each(t.schedule_group,(function(e){i.each(e.schedules,(function(e){E.prepareApiResponseForEditingReservedPostSchedule(e)}))}))),this.set(this.parse(e)),this}),this))},fetchMyApprovablePost:function(e,t){return e=e||this.getBandNo(),t=t||this.get("approvablePostId"),N.getMyApprovablePost(e,t).then(i.bind((function(e){return this.set(this.parse(e)),this}),this))},fetchApprovablePost:function(e,t){return e=e||this.getBandNo(),t=t||this.get("approvablePostId"),N.getApprovablePost(e,t).then(i.bind((function(e){return this.set(this.parse(e)),this}),this))},destroyPost:function(){return l.deletePost(this.getBandNo(),this.getPostNo())},savePost:function(e){var t=this.toJSONForSave(!0),n=this.getAttachment(D.SHARED_POST_SNIPPET);this.get("reservedPostId")&&n&&n.get("band")&&n.get("postNo")?(t.purpose="share",t.source_band_no=n.get("band").bandNo,t.source_post_no=n.get("postNo")):t.purpose="create",e&&e.length>0&&(t.copy_to_band_nos=e.join(","));var o=this.getMissionInfoForPost();return o&&(t.mission_id=o.getMissionId()),l.createRichPost(t).done(i.bind((function(){if(this.get("reservedPostId")&&!this.get("publishesAt"))return c.deleteReservedPost(this.getBandNo(),this.get("reservedPostId"))}),this))},savePostForMultiBands:function(e){var t=e.shift(),n=e.join(","),i=this.toJSONForSave(!0);return i.band_no=t,i.purpose="create",n&&(i.copy_to_band_nos=n),l.createRichPost(i)},copyPost:function(e,t){var n=this.toJSONForSave(!0);return n.purpose="copy",n.source_band_no=e,n.source_post_no=this.getPostNo(),t&&t.length>0&&(n.copy_to_band_nos=t.join(",")),l.createRichPost(n)},sharePost:function(e,t){var n=this.toJSONForSave(!0);return n.purpose="share",n.source_band_no=e,n.source_post_no=this.getPostNo(),t&&t.length>0&&(n.copy_to_band_nos=t.join(",")),l.createRichPost(n)},updatePost:function(){var e=this.toJSONForSave();e.post_no=this.getPostNo();var t=this.getMissionInfoForPost();return t&&(e.mission_id=t.getMissionId()),l.updateRichPost(e)},showPostFromOthers:function(){return l.showPostFromOthers(this.getBandNo(),this.getPostNo()).then(i.bind((function(){this.resetUncoveredOnce()}),this))},fetchSharedPostSnippet:function(e,t){return d.getSharedPostSnippet(e,t).then(i.bind((function(e){var t=p.createSharedPostSnippetModel(e);return this.setAttachment(D.SHARED_POST_SNIPPET,t),this}),this))},fetchSharedPagePostSnippet:function(e,t){return d.getSharedPostSnippet(e,t).then(i.bind((function(e){var t=p.createSharedPagePostSnippetModel(e);return this.setAttachment(D.SHARED_PAGE_POST_SNIPPET,t),this}),this))},setAlbum:function(e){this.set("album",e)},unsetAlbum:function(){this.unset("album")},setAttachment:function(e,t){this.get("attachment")[e]=t},unsetAttachment:function(e){this.get("attachment")[e]=this._defaultAttachment()[e]},setBillSplit:function(e){this.setAttachment(D.BILL_SPLIT,e)},unsetBillSplit:function(){this.unsetAttachment(D.BILL_SPLIT)},setTodo:function(e){this.setAttachment(D.TODO,e)},unsetTodo:function(){this.unsetAttachment(D.TODO)},setPoll:function(e){this.setAttachment(D.POLL,e)},unsetPoll:function(){this.unsetAttachment(D.POLL)},addAttachment:function(e,t,n){this.get("attachment")[e].set(t,n)},removeAttachment:function(e,t){this.get("attachment")[e].unset(t)},hasAttachment:function(e,t){if(!e)return i.some(i.values(_.POST_ATTACHMENT_TYPE),i.bind((function(e){return this.hasAttachment(e)}),this));var n=this.getAttachment(e);return!!n&&(!(n instanceof u)||(t?!!n.get(t):n.length()>0))},hasAttendanceCheck:function(e){return this.hasAttachment(D.ATTENDANCE_CHECK,e)},checkAttendanceCheckMaxAddCount:function(e){return this.getAttachment(D.ATTENDANCE_CHECK).length()===e},hasSubpost:function(){return this.hasAttachment(D.SUBPOST)},hasSticker:function(){return this.hasAttachment(D.STICKER)},hasScheduleGroup:function(){return this.hasAttachment(D.SCHEDULE_GROUP)},hasTodo:function(){return this.hasTodoV1()||this.hasTodoV2()},hasTodoV2:function(){return this.hasAttachment(D.TODO_V2)},hasTodoV1:function(){return this.hasAttachment(D.TODO)},hasSignup:function(){return this.hasAttachment(D.SIGNUP)},hasPoll:function(){return this.hasPollV1()||this.hasPollV2()},hasPollV2:function(){return this.hasAttachment(D.POLL_V2)},hasPollV1:function(){return this.hasAttachment(D.POLL)},hasPhotoAlbum:function(){return this.hasAttachment(D.PHOTO_ALBUM)},hasVideo:function(){return this.hasAttachment(D.VIDEO)},hasPhoto:function(){return this.hasAttachment(D.PHOTO)},hasPhotoOrVideo:function(){return this.hasPhoto()||this.hasVideo()},hasPromotionPhoto:function(){return this.hasAttachment(D.PROMOTION_PHOTO)},hasBillSplit:function(){return this.hasAttachment(D.BILL_SPLIT)},hasFile:function(){return this.getFileCount()>0},isAuthorProfileExist:function(){return this.get("viewType")!==_.VIEW_TYPE_ANNIVERSARY},isApprovablePost:function(){return!!this.get("approvablePostId")},isReservedPost:function(){return!!this.get("publishesAt")||!!this.get("reservedPostId")},getReservedPostId:function(){return this.get("reservedPostId")},getAudioCount:function(){return this.getAttachment(_.POST_ATTACHMENT_TYPE.AUDIO).length()},isMissionCertifiedPost:function(){return!!this.get("mission")},getMissionInfoForPost:function(){return this.get("mission")},getCopiableState:function(){return this.get("copiableState")},getCopiableBandTypes:function(){return this.hasBillSplit()||this.hasScheduleGroup()||this.hasAttendanceCheck()?[I.BAND_TYPE.GROUP]:[I.BAND_TYPE.GROUP,I.BAND_TYPE.PAGE]},toContentModels:function(){return i.chain(R(this.get("content"))).map((function(e){if(i.isString(e)&&!i.isEmpty(e))return new r({content:e});var t=this.getAttachment(e.type);return t?e.id?t.get(e.id):t:p.createUnknownModel()}),this).compact().value()},changePropsForCopy:function(e,t){if(this.set({band:e.getBandCore(),isNotice:!1,isMajorNotice:!1,copiableState:null},{silent:!0}),!e.canCreateQuiz()||!i.isEmpty(t)){var n=this.get("content");i.each(this.getAttachment(_.POST_ATTACHMENT_TYPE.QUIZ).attributes,(function(e,t){var i=b.makeAttachmentTag(_.POST_ATTACHMENT_TYPE.QUIZ,t);n=n.replace(i,""),this.removeAttachment(_.POST_ATTACHMENT_TYPE.QUIZ,t)}),this),this.set("content",n,{silent:!0})}if(!e.canCreateSurvey()||!i.isEmpty(t)){n=this.get("content");i.each(this.getAttachment(_.POST_ATTACHMENT_TYPE.SURVEY).attributes,(function(e,t){var i=b.makeAttachmentTag(_.POST_ATTACHMENT_TYPE.SURVEY,t);n=n.replace(i,""),this.removeAttachment(_.POST_ATTACHMENT_TYPE.SURVEY,t)}),this),this.set("content",n,{silent:!0})}var o=this.getAttachment(_.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP);return o.isEmpty()||i.each(o.values(),(function(e){e.getSchedules().each((function(e){e.setIsLocalMeetup(!1)}))})),C.setModelsDefaultTakers(this.getAttachment(_.POST_ATTACHMENT_TYPE.QUIZ).attributes,e).then(i.bind((function(){return y.setModelsDefaultManagers(this.getAttachment(_.POST_ATTACHMENT_TYPE.SURVEY).attributes,e)}),this))},getSetHashtags:function(){return this.get("setHashtags")},getPinnedHashtagsInContent:function(){return this.get("pinnedHashtagsInContent")}});function R(e){return i.compact(i.map(e.split(x.CONTENT_SPLIT_REGEXP),(function(e){var n=x.ATTACH_REGEXP.exec(e);return i.isEmpty(n)?e:n[2]?{type:t.camelize(n[1]),id:n[2]}:{type:t.camelize(n[1])}}),this))}return x.createAndFetchBandPostModel=function(e,t){return(new x).fetchPost(e,t)},x.newPostModelWithBandCore=function(e){if(!(e instanceof M))throw new Error("BandCore required");return new x({band:e},{parse:!0})},x.newPostModelWithBandCoreAndMissionInfo=function(e,t,n){if(!(e instanceof M))throw new Error("BandCore required");if(!t)throw new Error("BandMissionModel required");if(!n)throw new Error("BandMissionConfirmSummaryModel required");var i=S.convertBandMissionModelToMissionInfoForPostModelObj(t),o=n.getBandMissionConfirmSummaryConfirmCount(),s=IM("band_mission.confirm_post.hashtag",{dayCount:o+1}).replace(/\s/g,"");return new x({band:e,mission:i,content:"<band:hashtag>#"+s+"</band:hashtag>"},{parse:!0})},x.saveLiveVideoPost=function(e,t){var n=new x({band:e},{parse:!0}),i=p.createVideo({id:t.id,logoImage:t.url,width:t.width,height:t.height,title:"",isLive:!0,liveId:t.liveId,liveDescription:t.liveDescription});return n.addAttachment(_.POST_ATTACHMENT_TYPE.VIDEO,i.cid,i),n.set("content",i.get("liveDescription")+'<band:attachment type="video" id="'+i.cid+'" />'),n.savePost()},x.ATTACH_REGEXP=/<band:attachment type=\"([a-z0-9_]+)\"(?: id=\"([a-z0-9]+)\")? \/>/gi,x.CONTENT_SPLIT_REGEXP=/(<band:attachment[^/]+\/>)/i,x.POST_ATTACHMENT_TYPE=D,x.fetchRichPostQuietly=function(e,t){return l.getRichPostQuietly(e,t).then((function(e){return new x(e.post,{parse:!0})}))},x}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(2),s=n(6),a=n(168),r=n(174),l=n(572),c=n(497),d=n(13),u=s.Model.extend({defaults:function(){return{userNo:null,bandNo:null,bandName:null,name:null,description:null,originProfileImageUrl:"",profileImageUrl:"",profileImageWidth:"",profileImageHeight:"",cellphone:null,memberCreatedAt:null,role:{},birthdayLabel:null,isOpenCellphone:null,isOpenBirthday:null,isMemberSelectableForChat:!1,isDeleted:!1,userProfileSetId:null,profileImageUpdatedAt:null}},parse:function(e,n){var i=this.defaults();return t.extend(i,{userNo:e.member.user_no,bandNo:e.band.band_no,bandName:e.band.name,name:e.member.name,description:e.member.description,originProfileImageUrl:e.member.profile_image_url,profileImageUrl:e.member.profile_image_url,cellphone:r.toDisplayPhoneNumber(e.member.cellphone),memberCreatedAt:e.member.member_created_at,role:c.parseRole(e.member.role),birthdayLabel:this._makeBirthdayLabel(e.member.birthday,e.member.is_lunar),isOpenCellphone:e.member.is_open_cellphone,isOpenBirthday:e.member.is_open_birthday,isModifyOpenBirthday:-1!=t.indexOf(e.member.permitted_operation,"modify_open_birthday"),isModifyOpenCellphone:-1!=t.indexOf(e.member.permitted_operation,"modify_open_cellphone"),isMemberSelectableForChat:-1!=t.indexOf(e.member.permitted_operation,"send_message"),canBanChat:-1!=t.indexOf(e.member.permitted_operation,"ban_chat"),canBanMember:-1!=t.indexOf(e.member.permitted_operation,"ban_member"),canBlockCommentAndChat:-1!=t.indexOf(e.member.permitted_operation,"block_comment_and_chat"),isDeleted:!!e.member.is_deleted,userProfileSetId:e.member.user_profile_set_id,profileImageUpdatedAt:e.member.profile_image_updated_at})},isMyProfile:function(){return this._isMyProfile(this.get("userNo"))},_isMyProfile:function(e){return d.getUserData().getUserNo()===e},fetchMemberWithChannel:function(e,n){return a.getMemberWithChannel(e,n).then(t.bind((function(e){return this.set(this.parse(e)),this}),this))},fetchMemberWithBand:function(e,n){var i={band_no:e};return n&&(i.user_no=n),a.getMemberWithBand(i).then(t.bind((function(e){return this.set(this.parse(e)),this}),this))},_makeBirthdayLabel:function(e,t){return l.makeBirthdayLabel(e,t)},isOpenBirthdayModifiable:function(){return this.get("isModifyOpenBirthday")&&this.get("birthdayLabel")},isOpenCellphoneModifiable:function(){return this.get("isModifyOpenCellphone")&&this.get("cellphone")},setMemberProfile:function(e,t,n){try{return a.setMemberProfile(this._getSubmitParams(e,t,n))}catch(e){return o.Deferred().reject(e)}},_getSubmitParams:function(e,n,o){var s=this._parseSubmitParams(this);if(e&&t.every(["name","profileImageUrl"],(function(t){return i.trim(this.get(t))===i.trim(e.get(t))}),this))s=t.extend(t.omit(s,"name","profile_image_url"),{user_profile_set_id:e.get("userProfileSetId")});else if(!s.name)throw"name";return n&&o&&(s.profile_image_width=o.width,s.profile_image_height=o.height,s.create_profile_image_change_post=!0),s},hasDifference:function(e){return!t.isEqual(this._parseSubmitParams(e),this._parseSubmitParams(this))},hasProfileSetDifference:function(e){return!t.isEqual(this._parseProfileSetObject(e),this._parseProfileSetObject(this))},_parseProfileSetObject:function(e){var t=e.attributes;return{name:i.trim(t.name),profile_image_url:t.profileImageUrl}},_parseSubmitParams:function(e){var t=e.attributes,n={band_no:t.bandNo,name:i.trim(t.name),profile_image_url:t.profileImageUrl,description:i.trim(t.description)};return e.isOpenBirthdayModifiable()&&(n.open_birthday=t.isOpenBirthday||!1),e.isOpenCellphoneModifiable()&&(n.open_cellphone=t.isOpenCellphone||!1),n},isUndefinedOpenBirthday:function(){return t.isUndefined(this.get("isOpenBirthday"))},isUndefinedOpenCellphone:function(){return t.isUndefined(this.get("isOpenCellphone"))},createSubmitModel:function(e,t,n,i,o){return new u(this.toJSON()).set({name:e,description:t,profileImageUrl:n,isOpenBirthday:i,isOpenCellphone:o})}});return u.fetchMemberWithBand=function(e,t){return(new u).fetchMemberWithBand(e,t)},u.fetchMemberWithChannel=function(e,t){return(new u).fetchMemberWithChannel(e,t)},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{NONE:0,ENTER:1,SHIFT_ENTER:2,CONTROL_ENTER:3}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(505),i=n(154);return{_convertLineSeparatorToEmpty:function(e){return e.replace(/[\u2028|\u2029]/g,"")},writeComment:function(e,n,o,s,a,r){var l={bandNo:e,memberType:a,contentKey:n,isSecret:o,contents:this._convertLineSeparatorToEmpty(s.getMessage()),packNo:s.getPackNo(),stickerId:s.getStickerId(),photos:s.getPhotosJson(),file:s.getFileJson(),video:s.getVideoJson()};return i.wrapActivePromise(t.createComment(l),r)},modifyComment:function(e,n,o){var s={bandNo:e,contentKey:n.contentKey.toApiParams(!0),isSecret:n.isSecret,contents:this._convertLineSeparatorToEmpty(n.message),memberType:n.memberType};return n.submitData.isSameAttachInfoWith(n.originalSubmitData)||(n.submitData.isAttachmentExist()?n.submitData.isStickerExist()?(s.packNo=n.submitData.getPackNo(),s.stickerId=n.submitData.getStickerId()):n.submitData.isPhotoExist()?s.photos=n.submitData.getPhotosJson():n.submitData.isFileExist()?s.file=n.submitData.getFileJson():n.submitData.isDropboxFileExist()?s.dropbox_file=n.submitData.getDropboxFileJson():n.submitData.isExternalFileExist()?s.external_file=n.submitData.getExternalFileJson():n.submitData.isVideoExist()&&(s.video=n.submitData.getVideoJson()):n.originalSubmitData.isStickerExist()?(s.packNo=null,s.stickerId=null):n.originalSubmitData.isPhotoExist()?s.photos=null:n.originalSubmitData.isFileExist()?s.file=null:n.originalSubmitData.isDropboxFileExist()?s.dropbox_file=null:n.originalSubmitData.isExternalFileExist()?s.external_file=null:n.originalSubmitData.isVideoExist()&&(s.video=null)),i.wrapActivePromise(t.editComment(s),o)}}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(486),s=n(1175),a={CONFIRM:"modal:confirm"},r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DAlertModalView"},template:t.template(s),ui:{btnConfirm:"._btnConfirm"},events:{"click @ui.btnConfirm":function(){this._confirmModalView()}},initialize:function(e){this._validateOptions(e),this.model=new Backbone.Model({headerTitle:e.headerTitle,bodyTitle:e.bodyTitle,bodyDesc:e.bodyDesc,confirm:e.confirm||IM("ui.label.confirm")})},layerOnEscKeyDown:function(){this.isDestroyed()||this._confirmModalView()},_confirmModalView:function(){this.trigger(a.CONFIRM),this.destroy()},_validateOptions:function(e){!e.bodyTitle&&t.isEmpty(e.bodyDesc)&&console.error("One of bodyTitle or bodyDesc is required!!")},onAttach:function(){this.ui.btnConfirm.focus()}});return r.EVENTS=a,r.openLayer=function(e){var t=new r(e);return e.withoutHiding?o.openWithoutHiding(t):o.open(t),t},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(856),i=n(857),o=n(858),s=n(859),a=n(728),r=n(729),l=n(730),c=n(860),d=n(861),u=n(862),h=n(863),p=n(864),m=n(615),_=n(712),g=n(625),f=n(713),b=n(847),v=n(865),A=n(866),E=n(867),T=n(667),C=n(617),y=n(832),M=n(869),I=n(658),S=n(707),w=n(602);return{createSticker:function(e){return new t(e,{parse:!0})},createStickerByJSON:function(e){return new t(e)},createPhoto:function(e){return new i(e,{parse:!0})},createPhotoByJSON:function(e){return new i(e)},createPromotionPhoto:function(e){return new o(e,{parse:!0})},createPromotionPhotoByJSON:function(e){return new o(e)},createVideo:function(e){return new s(e,{parse:!0})},createVideoByJSON:function(e){return new s(e)},createFile:function(e){return new a(e,{parse:!0})},createFileByJSON:function(e){return new a(e)},createDropboxFile:function(e){return new r(e,{parse:!0})},createDropboxFileByJSON:function(e){return new r(e)},createExternalFile:function(e){return new l(e,{parse:!0})},createExternalFileByJSON:function(e){return new l(e)},createLocation:function(e){return new c(e,{parse:!0})},createLocationByJSON:function(e){return new c(e)},createSnippet:function(e){return new d(e,{parse:!0})},createSnippetByJSON:function(e){return new d(e)},createAlbum:function(e){return new u(e,{parse:!0})},createAlbumByJSON:function(e){return new u(e)},createPhotoAlbum:function(e){return new h(e,{parse:!0})},createPhotoAlbumByJSON:function(e){return new h(e)},createSubpost:function(e){return new p(e,{parse:!0})},createSubpostByJSON:function(e){return new p(e)},createPollV1:function(e){return new m(e,{parse:!0})},createPollV1ByJSON:function(e){var t=new m;return t.setJSON(e),t},createPollV2:function(e){return new _(e,{parse:!0})},createPollV2ByJSON:function(e){var t=new _;return t.setJSON(e),t},createTodoV1:function(e){return new g(e,{parse:!0})},createTodoV1ByJSON:function(e){var t=new g;return t.setJSON(e),t},createTodoV2:function(e){return new f(e,{parse:!0})},createTodoV2ByJSON:function(e){var t=new f;return t.setJSON(e),t},createBillSplit:function(e){return new b(e,{parse:!0})},createBillSplitByJSON:function(e){var t=new b;return t.setJSON(e),t},createAttendanceCheck:function(e){return new T(e)},createScheduleGroup:function(e){return S.createRichScheduleGroupByApiResponse(e)},createScheduleGroupByJSON:function(e){return S.createRichScheduleGroupByJSON(e)},createScheduleGroupByScheduleModel:function(e){return S.createRichScheduleGroupByScheduleModel(e)},createSharedPostSnippetModel:function(e){return new v(e,{parse:!0})},createSharedPostSnippetModelByJSON:function(e){var t=new v;return t.setJSON(e),t},createSharedPagePostSnippetModel:function(e){return new A(e,{parse:!0})},createSharedPagePostSnippetModelByJSON:function(e){var t=new A;return t.setJSON(e),t},createUnknownModel:function(){return new E},createSignup:function(e){return y.buildRichSignupModel(e)},createAddon:function(e){return new C(e,{parse:!0})},createAddonByJSON:function(e){var t=new C;return t.setJSON(e),t},createAudio:function(e){return new M(e,{parse:!0})},createAudioByJSON:function(e){return new M(e)},createRichQuiz:function(e){return new I(e,{parse:!0})},createRichQuizModelByJSON:function(e){var t=new I;return t.setJSON(e||{}),t},createRichSurvey:function(e){return new w(e,{parse:!0})},createRichSurveyModelByJSON:function(e){var t=new w;return t.setJSON(e||{}),t}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(6),s=n(519),a=n(575),r=n(155),l=o.Collection.extend({model:a,fetchChattingChannels:function(){return s.getAllChatChannels().then(t.bind((function(e){var n=t.chain(e.channels).filter((function(e){return!!e.band})).sortBy((function(e){return!e.is_pinned})).value();return this.newChatCount=t.reduce(n,(function(e,t){return e+(t.new_message_count||0)}),0),this.reset(n,{parse:!0}),this}),this))},fetchBandChattingChannels:function(e){return i.when(this._fetchChatChannels(e),this._fetchOpenChatChannels(e)).then(t.bind((function(e,n){var i=t.indexBy(e,"channel_id"),o=t.filter(n,(function(e){return!i[e.channel_id]})),s=this._sortByPinned(e).concat(o);return this.reset(s,{parse:!0}),this}),this))},fetchBandChatChannels:function(e){return this._fetchChatChannels(e).then(t.bind((function(e){return this.reset(this._sortByPinned(e),{parse:!0}),this}),this))},fetchOpenChatChannels:function(e){return this._fetchOpenChatChannels(e).then(t.bind((function(e){return this.reset(e,{parse:!0}),this}),this))},removeDuplicateChatChannels:function(e){var t=this.filter((function(t){return e.get(t.getChatChannelId())}));this.remove(t)},_sortByPinned:function(e){return t.sortBy(e,(function(e){return!e.is_pinned}))},_fetchChatChannels:function(e){return s.getChatChannels(e).then((function(e){return e.channels}))},_fetchOpenChatChannels:function(e){var n=r.get(e);return i.when(s.getOpenChatChannels(e),n.loadBandData()).then((function(e){var i=n.getBandCore(),o=e.open_channels,s={type:i.type,band_no:i.bandNo,name:i.name,cover:i.cover,theme_color:i.themeColor};return t.each(o,(function(e){e.band=s,e.is_open=!0,e.is_group=!0,e.is_default_channel&&(e.name=s.name)})),o}))}});return l.build=function(){return new l([])},l.Commands={createChannel:function(e,t){return s.createChannel(t,e).then((function(e){var t=e.channel,n=t.band;return{channelId:t.channel_id,bandNo:n.band_no}}))},createOpenChatChannel:function(e,t,n,i){return s.createOpenChatChannel(e,t,n,i).then((function(e){var t=e.channel,n=t.band;return{channelId:t.channel_id,bandNo:n.band_no}}))}},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=function(e){this._memberGroupMentionPossible=e.memberGroupMentionPossible,this._fixedTargetMemberMentionArray=e.fixedTargetMemberMentionArray,this._leaderColeaderMentionAsWell=e.leaderColeaderMentionAsWell,this._dynamicSearchPossible=e.dynamicSearchPossible};return t.prototype.isMemberGroupMentionPossible=function(){return this._memberGroupMentionPossible},t.prototype.getFixedTargetMemberMentionArray=function(){return this._fixedTargetMemberMentionArray},t.prototype.canMentionLeaderAndColeaderAsWell=function(){return this._leaderColeaderMentionAsWell},t.prototype.isDynamicSearchPossible=function(){return this._dynamicSearchPossible},t.buildMentionOption=function(e){return new t(e)},t}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(43),o={DAYS:{SUNDAY:new s(IM("calendar.sunday"),"Sunday",0),MONDAY:new s(IM("calendar.monday"),"Monday",1),TUESDAY:new s(IM("calendar.tuesday"),"Tuesday",2),WEDNESDAY:new s(IM("calendar.wednesday"),"Wednesday",3),THURSDAY:new s(IM("calendar.thursday"),"Thursday",4),FRIDAY:new s(IM("calendar.friday"),"Friday",5),SATURDAY:new s(IM("calendar.saturday"),"Saturday",6)},getAllDaysOfWeek:function(){return o.DAYS},findDayOfWeekByString:function(e){if(t.isEmpty(e))return o.DAYS.SUNDAY;var n=t.chain(t.values(o.getAllDaysOfWeek())).find((function(t){return t instanceof s&&t.getApiValue().toUpperCase()==e.toUpperCase()})).value();return null==n?o.DAYS.SUNDAY:n},findDayOfWeekByNumber:function(e){return t.find(o.DAYS,(function(t){return t.getDayNumber()==e}))},getFirstDateOfWeek:function(e,n,o){var s=(t.isEmpty(o)?i(e):i.tz(e,o)).startOf("day"),a=s.day()-n;return a<0&&(a+=7),i(s).subtract(a,"day")},getEndDateOfWeek:function(e,n,o){var s=(t.isEmpty(o)?i(e):i.tz(e,o)).endOf("day"),a=n-s.day()-1;return a<0&&(a+=7),i(s).add(a,"day")},makeDayOfWeekListOrderBy:function(e){return null==e&&(e=o.DAYS.SUNDAY.getDayNumber()),t.map(t.range(e,e+7),(function(e){var t=i().day(e).day();return o.findDayOfWeekByNumber(t)}))},makeDayNameArrayOrderBy:function(e,n){return t.map(o.makeDayOfWeekListOrderBy(e),(function(e){return i().day(e.getDayNumber()).format(n)}))}};function s(e,t,n){this._localizedText=e,this._apiValue=t,this._dayNumber=n}return s.prototype.getApiValue=function(){return this._apiValue},s.prototype.getDayNumber=function(){return this._dayNumber},s.prototype.getLocalizedText=function(){return this._localizedText},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(0)],void 0===(o=function(e){var t={TOTAL_ALBUM_NO:0,MAX_ALBUM_NAME_LENGTH:50,ALBUM_PAGE_SIZE:20,ALBUM_SORT_TYPE:{UPDATE_AT_DESC:{ID:1,API_PARAM:"updated_at_desc",TEXT:IM("album.sort.update_order")},CREATED_AT_ASC:{ID:2,API_PARAM:"created_at_asc",TEXT:IM("album.sort.album_creation_date")},NAME_ASC:{ID:3,API_PARAM:"name_asc",TEXT:IM("album.sort.album_name_asc")},NAME_DESC:{ID:4,API_PARAM:"name_desc",TEXT:IM("album.sort.album_name_desc")},findById:function(e){return n(t.ALBUM_SORT_TYPE,e,t.ALBUM_SORT_TYPE.UPDATE_AT_DESC)}},ALBUM_DETAIL_SORT_TYPE:{RECENT_PHOTO:{ID:1,TEXT:IM("album_detail.sort.latest_order")},MONTHLY_DATE:{ID:2,TEXT:IM("album_detail.sort.date_order")},isRecentPhotoType:function(e){return e==t.ALBUM_DETAIL_SORT_TYPE.RECENT_PHOTO},isMonthlyDateType:function(e){return e==t.ALBUM_DETAIL_SORT_TYPE.MONTHLY_DATE},findById:function(e){return n(t.ALBUM_DETAIL_SORT_TYPE,e,t.ALBUM_DETAIL_SORT_TYPE.RECENT_PHOTO)}}},n=function(t,n,i){var o=e.chain(e.values(t)).filter((function(e){return"function"!=typeof e&&e.ID==n})).value();return o.length>0?o[0]:i};return t}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(4),a=n(52),r=n(527),l=n(493),c=n(160),d=n(82),u=n(491),h=n(85),p=n(546),m=n(172),_=n(155),g=new(o.Model.extend({getBandMembersFetchPromise:function(e){return this.get(""+e)},setBandMembersFetchPromise:function(e,t){this.set(""+e,t)},expireBandMembersFetchPromise:function(e){this.unset(""+e)}})),f=new(o.Model.extend({getBandMemberGroupsFetchPromise:function(e){return this.get(""+e)},setBandMemberGroupsFetchPromise:function(e,t){this.set(""+e,t)},expireBandMemberGroupsFetchPromise:function(e){this.unset(""+e)}}));return new(s.Object.extend({fetchMentionMembersAndMemberGroups:function(e){return u.getCachedBandData(e).then(i.bind((function(n){if(!n.canMention())return{mentionArray:[],memberCollection:[],hasMoreMember:!1,canMentionMemberGroup:!1};var o=t.Deferred().resolve([]);return n.canMentionToCurrentBandMemberGroup()&&(o=this.fetchCachedBandMemberGroups(e)),t.when(this.fetchCachedBandMembers(e),o).then(i.bind((function(e,t){return this.listenTo(n,_.UPDATE_EVENT.MEMBER,(function(){this._resetMembersAtHolder(n)})),this.listenTo(n,_.UPDATE_EVENT.BAND,(function(){this._resetMembersAtHolder(n)})),{memberCollection:e.memberCollection,leaderColeaderCollection:e.leaderColeaderCollection,hasMoreMember:e.hasMoreMember,memberGroupMentionArray:t,canMentionMemberGroup:n.canMentionToCurrentBandMemberGroup()}}),this))}),this))},fetchCachedBandMembers:function(e){var t=g.getBandMembersFetchPromise(e);return t||(t=this._fetchBandMembers(e),g.setBandMembersFetchPromise(e,t),t)},fetchCachedBandMemberGroups:function(e){var t=f.getBandMemberGroupsFetchPromise(e);return t||(t=this._fetchBandMemberGroups(e),f.setBandMemberGroupsFetchPromise(e,t),t)},debouncedFetchMemberList:function(e,n,o){clearTimeout(o);var s=t.Deferred(),a=setTimeout(i.bind((function(){this._fetchMultipleMemberList(e,n).then((function(e){s.resolve(e)}))}),this),500);return{promise:s,timer:a}},convertCollectionToMentionArray:function(e,t){return i.isEmpty(e)?[]:e.map((function(e){return m.buildBandMemberMention(e.getUserNo(),e.getName(),t,d.makeProfileThumbnailUrl(e.getProfileImageUrl()),e.getDesc())}))},concatMentionArrayAndSort:function(e,t){var n=[].concat(e||[]).concat(t||[]);return i.sortBy(n,(function(e){return e.getLowerCaseMentionName()}))},extractMatchingMentionsButEmptyQuery:function(e,t){return i.isEmpty(e)||null==t||""==t?[]:i.filter(e,(function(e){return e.getLowerCaseMentionName().indexOf(t.toLowerCase())>-1}))},fetchBandListForMention:function(e,t){var n=p.build(h.MENTION,h.getFieldsWithFilterType(h.MENTION),[t]);return n.fetchBandWithFilterDataCollection().then((function(){return n}))},_fetchMultipleMemberList:function(e,n){var o=[];i.each(this._generateTypingStringArray(n),(function(t){o.push(this._fetchMentionMemberListByQuery(e,t))}),this);var s={query:n,firstMatchingList:[],secondMatchingList:[]};return i.isEmpty(o)?t.Deferred().resolve(s):t.when.apply(t,o).then((function(e,t){return s.firstMatchingList=e.models||[],t&&!i.isEmpty(t.models)&&(s.secondMatchingList=t.models),s}))},_fetchMentionMemberListByQuery:function(e,t){return u.getCachedBandData(e).then((function(n){if(!n.canMention())return[];var i=r.buildBandMemberWithFilterDataCollection(e,c.MENTION,1e3);return i.searchBandMemberWithFilterDataCollection(t).then((function(){return i}))}))},_fetchBandMembers:function(e){var n=r.buildBandMemberWithFilterDataCollection(e,c.MENTION,1e3),o=r.buildBandMemberWithFilterDataCollection(e,c.SECRET_SCHEDULE_MANAGER,1e3),s=_.get(e);return s.loadBandData().then((function(){var e=t.Deferred().resolve();return s.getBandCore().supportSecretScheduleManagerFetch()&&(e=o.fetchBandMemberWithFilterDataCollection()),t.when(n.fetchBandMemberWithFilterDataCollection(),e).then(i.bind((function(){return{memberCollection:n,leaderColeaderCollection:o,hasMoreMember:n.hasMoreMember()}}),this))}))},_fetchBandMemberGroups:function(e){return l.getMemberGroups(e).then(i.bind((function(e){var t=a.camelizeKeys(e.items);return i.map(t,(function(e){return m.buildBandMemberGroup(e.memberGroupId,e.name,e.memberCount)}))}),this))},_generateTypingStringArray:function(e){var t=e.slice(0,-1);return i.compact([e,t])},_resetMembersAtHolder:function(e){g.expireBandMembersFetchPromise(e.getBandNo()),f.expireBandMemberGroupsFetchPromise(e.getBandNo()),this.stopListening(e,_.UPDATE_EVENT.MEMBER),this.stopListening(e,_.UPDATE_EVENT.BAND)}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(16),s=n(609),a=n(526),r=n(545),l=n(567),c=n(9),d={GOOGLE:{NAME:"google",EXPORT_URL:"https://www.google.com/calendar/render?cid={iCalUrl}"},YAHOO:{NAME:"yahoo",EXPORT_URL:"https://calendar.yahoo.com/subscribe?ics={iCalUrl}&name={title}"},OUTLOOK:{NAME:"outlook",EXPORT_URL:"https://outlook.live.com/owa/?path=%2Fcalendar%2Faction%2Fsubscribe&name={title}&url={iCalUrl}"},NAVER:{NAME:"naver",EXPORT_URL:"http://calendar.naver.com/popup/importAndExport.nhn?hideExportTab=true&iCalUrl={iCalUrl}&serviceCode=89"}},u="0",h="1",p="2",m="3",_="4",g="5",f="6",b={0:"continuousEventList",1:"allDayEventList",2:"normalEventList",3:"birthdayEventList",4:"subscribedEventList",5:"bandAnniversaryEventList",6:"extraEventList"},v={forceMergeDateRanges:function(){var e=o.min.apply(o,i.pluck(arguments,"start")),t=o.max.apply(o,i.pluck(arguments,"end"));return new s(e,t)},extractOccuredUnitInDateRange:function(e,t,n){var i=o(e),a=o(t),r=[];return i.startOf(n),a.endOf(n),new s(i,a).by(n,(function(e){r.push(e)}),!0),r},extractWeekStartDatesInDateRange:function(e,t,n){var i=o(e),a=o(t),r=[],c=l.getFirstDateOfWeek(i,n),d=l.getEndDateOfWeek(a,n);return new s(c,d).by("week",(function(e){r.push(e)}),!0),r},isContinuous:function(e,t){return e.start<=t.end&&t.start<=e.end},getWeekOfMonth:function(e){var t=o(e),n=o(e).startOf("month");return t.diff(n,"week")+1},makeExportCalndarUrl:function(e){var t=encodeURIComponent(e.title||""),n=encodeURIComponent(e.iCalUrl);return{google:d.GOOGLE.EXPORT_URL.replace("{iCalUrl}",n),yahoo:d.YAHOO.EXPORT_URL.replace("{title}",t).replace("{iCalUrl}",n),outlook:d.OUTLOOK.EXPORT_URL.replace("{title}",t).replace("{iCalUrl}",n),naver:d.NAVER.EXPORT_URL.replace("{iCalUrl}",n)}},adjustEventListOrder:function(e,n){var s={continuousEventList:[],allDayEventList:[],normalEventList:[],birthdayEventList:[],subscribedEventList:[],bandAnniversaryEventList:[],extraEventList:[]},a=n.startOf("day"),r=o();return i.each(e,(function(e){var o=v.getDays({startAt:e.get("startAt"),endAt:e.get("endAt")}),l=v.getScheduleSort({endAt:e.get("endAt"),startAt:e.get("startAt"),isAllDay:e.get("isAllDay"),scheduleType:e.get("scheduleType"),scheduleDayStartAt:n}),c=i.last(o),d=!1,u=!1,h=o.length>1;h&&(a.isAfter(i.first(o))&&(d=!0),a.diff(c,"day")<=-1&&(u=!0));var p={isMoreOneDay:h,dailyScheduleTimeMessage:v.getMessageByEventType(o,e,a),passedEvent:r.isAfter(c,"day"),prevDayExist:d,nextDayExist:u};s[b[parseInt(l)]].push(t.extend(e,{moreOptions:p}))})),s.continuousEventList.concat(s.allDayEventList,s.normalEventList,s.birthdayEventList,s.subscribedEventList,s.bandAnniversaryEventList,s.extraEventList)},getDays:function(e){var t,n=o(e.startAt);return t=e.endAt?o(e.endAt):o(n),this.extractOccuredUnitInDateRange(n,t,"day")},getScheduleSort:function(e){var t=this.getContinuationSchedulesLength({endAt:e.endAt,startAt:e.startAt}),n=e.isAllDay,i=e.scheduleType,o=f;return(a.isNormal(i)||a.isExternal(i))&&(o=p),n&&(o=h),t>=1&&(o=u+"."+e.scheduleDayStartAt.format("X")),a.isBirthday(i)&&(o=m),a.isHoliday(i)&&(o=_),a.isBandOpen(i)&&(o=g),o},getMessageByEventType:function(e,t,n){var i=t.get("scheduleType"),s=t.get("isAllDay"),r=o(t.get("startAt")),l=o(t.get("endAt"));return a.isBirthday(i)?IM("web.bandcalendar.schedulelist.label.scheduletype_birth"):a.isHoliday(i)?IM("schedule.holiday"):a.isBandOpen(i)?IM("schedule.anniversary"):1==e.length?s?IM("web.bandcalendar.schedulelist.label.scheduletime_allday"):c.message("web.bandcalendar.schedulelist.label.scheduletime_start_at",{start_at:r}):n.isSame(r,"day")?s?IM("web.scheduleedit.date.start"):c.message("web.bandcalendar.schedulelist.label.scheduletime_start_at",{start_at:r}):n.isSame(l,"day")?IM("web.scheduleedit.date.end"):IM("web.bandcalendar.schedulelist.label.scheduletime_allday")},getCalendarColor:function(){var e,n=t("body").attr("class");return n&&(e=parseInt(n.split("skin")[1],10),i.isNumber(e))?r.CALENDAR_COLOR[e-1]:null},getCalendarSkin:function(e,t){var n=e.get("calendar");return i.isEmpty(n)?null:n.color?{"25b808":"skin1","00b994":"skin2","32b0e5":"skin3","9370f0":"skin4",ff5b72:"skin5",ff703d:"skin6",fdb00d:"skin7",959799:"skin8","5471d8":"skin9","525a62":"skin10",f875c0:"skin11"}[n.color]:t},getContinuationSchedulesLength:function(e){var t=o(e.endAt),n=o(e.startAt),i=e.endAt?t.diff(n,"days"):0;return 0==i&&e.endAt&&n.format("YYYYMMDD")!==t.format("YYYYMMDD")&&(i=1),i}};return v}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(16),o=n(9);return{changePageTitle:function(e,n){if(!e.routeInfo.isSkipChangePageTitle()){var i=e.routeInfo.PAGE_TITLE;t.isFunction(i)&&(i=i.call(e,n)),document.title=IM("page.title",{title:t.unescape(i)})}},makeBirthdayLabel:function(e,t){if(!e)return null;var n=i(e,"MMDD");if(!n.isValid())return null;var s=o.format.date(n,"month_day");return t&&(s=s+"("+IM("web.profile.label.lunar")+")"),s}}}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(6),s=n(603),a=n(161),r=n(519),l=n(52),c=n(506),d=n(587),u="joinable",h="join_denied",p="talking_to_page",m={ENABLED:"enabled",DISABLED:"disabled"},_="min",g="on",f="membership",b="public",v="private",A=o.Model.extend({_initialized:!1,idAttribute:"channel_id",defaults:function(){return{channel_id:null,band:{},bandCore:null,bandInfo:{},bandNo:0,channelId:null,isDefaultChannel:!1,isOpen:!1,notification:!1,createdAt:0,channelName:"",channelDescription:"",creator:{},latestMessage:{},messagePeriod:_,newMessageCount:0,notice:null,profileUrl:"",userCount:1,updatedAt:0,type:b,userStatus:null,permittedOperation:null,joinStatus:null,joinDeniedReason:null,userLastMessageNo:0,userNotice:null,isPinned:!1,isGroup:!1,messageReadersVisibleState:m.DISABLED,oldestReadableMessageNo:0,oldestServerMessageNo:0,unreadCountVisible:!1,purpose:null,participants:[],isMessagingDisabled:!1,isBig:!1,groupCall:{}}},_parseUserNotice:function(e){return e?l.camelizeKeys(e):null},_parseGroupCall:function(e){return null==e?null:l.camelizeKeys(e)},parse:function(e){var n=e.band||{},i=n.band_no||e.band_no,o=l.camelizeKeys(e.creator||{}),r=e.latest_message||{},d=e.is_group||!1,u=e.channel_id;return{channel_id:u,band:n,bandCore:t.isEmpty(n)?null:a.createBandCore(n),bandInfo:{bandCover:n.cover,bandName:n.name,certified:n.certified,bandNo:n.band_no,themeColor:n.theme_color,type:n.type,isRecruiting:n.is_recruiting},bandNo:i,channelId:u,isDefaultChannel:e.is_default_channel||!1,isOpen:e.is_open||!1,notification:e.notification==g,createdAt:e.created_at,channelName:e.name,channelDescription:e.description,creator:o,latestMessage:{textBody:s.toTextMessage(r.message_type,r.content),body:r.content||null,no:r.message_no,type:r.message_type,userName:c.get(r,"creator.name","")},messagePeriod:e.message_period,newMessageCount:e.new_message_count||0,notice:e.notice,profileUrl:e.profile_url,userCount:e.participant_count,updatedAt:e.updated_at||e.latest_message_received_at,type:d?b:v,userStatus:e.user_status||null,permittedOperation:e.permitted_operation,joinStatus:e.join_status,joinDeniedReason:e.join_denied_reason,userLastMessageNo:e.latest_read_message_no,userNotice:this._parseUserNotice(e.user_notice),isPinned:e.is_pinned||!1,isGroup:d,messageReadersVisibleState:e.message_readers_visible_state,oldestReadableMessageNo:e.oldest_readable_message_no,oldestServerMessageNo:e.oldest_server_message_no,unreadCountVisible:e.unread_count_visible,purpose:e.purpose,participants:l.camelizeKeys(e.participants||[]),isMessagingDisabled:e.is_messaging_disabled||!1,isBig:e.is_big||!1,groupCall:this._parseGroupCall(e.group_call)}},setWithParse:function(e){this._initialized=!0,this.set(this.parse(e))},isInitialized:function(){return this._initialized},setUserNotice:function(e){this.set("userNotice",this._parseUserNotice(e))},hasUserNotice:function(){return!!this.get("userNotice")},getBand:function(){return this.get("band")},getChannelBandInfo:function(){return this.get("bandInfo")},hasChannelBandInfo:function(){return!!this.get("bandInfo").bandNo},getChannelId:function(){return this.get("channelId")},isDefaultChannel:function(){return this.get("isDefaultChannel")},getLatestMessageNo:function(){return this.getChatChannelLatestMessage().no},hasLatestMessage:function(){return!!this.getLatestMessageNo()},getChatChannelLatestMessage:function(){return this.get("latestMessage")},getChannelName:function(){return this.get("channelName")},getNewMessageCount:function(){return this.get("newMessageCount")},isPrivateChannel:function(){return!this.get("isGroup")},isOpenChannel:function(){return!!this.get("isOpen")},isRecruitingChannel:function(){return this.getChannelBandInfo().isRecruiting},getChannelType:function(){return this.get("type")},getLookType:function(){return this.isPrivateChannel()?"personLook":this.isDefaultChannel()?"bandLook":"groupLook"},getUserCount:function(){return this.get("userCount")},getUpdatedAt:function(){return this.get("updatedAt")},getBandNo:function(){return this.get("bandNo")},getMessagePeriod:function(){return this.get("messagePeriod")},setMessagePeriod:function(e){this.set("messagePeriod",e)},isJoinDenied:function(){return this.get("joinStatus")==h},isJoinable:function(){return this.get("joinStatus")==u},setChatChannelInfo:function(e,n,o){var s={name:this.get("channelName")||null,description:this.get("channelDescription")||null,profile:this.get("profileUrl")||null},a={name:e||null,description:n||null,profile:o||null},l=this.getChatChannelBandNo(),c=this.getChatChannelId();return e?t.isEqual(s,a)?i.Deferred().resolve():r.SettingApi.setChatChannelInfo(l,c,e,n,o).then(t.bind((function(e){var t=e.channel;this.set({channelName:t.name,channelDescription:t.description,profileUrl:t.profile_url})}),this)):i.Deferred().reject()},getNotice:function(){return this.get("notice")},hasNotice:function(){return!!this.getNotice()},isPermitted:function(e){return this.get("permittedOperation")&&this.get("permittedOperation").indexOf(e)>-1},getChatChannelDisplayMessage:function(){var e=this.get("channelDescription"),n=this.getChatChannelLatestMessage();return this.isJoinDenied()?"exceed_limit"===this.get("joinDeniedReason")?IM("web.chatting.exceed_limit"):IM("channel_list.message.join_denied"):this.hasLatestMessage()?t.isEmpty(n.textBody)?"":this.isPrivateChannel()||this.isPageBandChatChannel()?n.textBody:[n.userName||IM("chat.unknown_writer_name"),n.textBody].join(" : "):this.isOpenChannel()?e||(this.isDefaultChannel()?this.isRecruitingBandChatChannel()?IM("recruiting_band.chatting_message.default"):IM("chat.setting.txt.default_channel_description"):IM("web.chatting.start_talking_to_your_group")):""},isPageBandChatChannel:function(){return this.get("purpose")==p},isRecruitingBandChatChannel:function(){var e=this.getChatChannelBandCore();return!!e&&e.isChatRoomRecruiting()},getChatChannelCreator:function(){return t.clone(this.get("creator"))},getChatChannelCreatorUserNo:function(){return this.get("creator").userNo},getChatChannelDescription:function(){return this.get("channelDescription")},getChatChannelCreatedAt:function(){return this.get("createdAt")},isMessageReadersVisibleChatChannel:function(){return this.get("messageReadersVisibleState")==m.ENABLED},setMessageReadersVisibleState:function(e){this.set("messageReadersVisibleState",e)},getChatChannelDisplayNewMessageCount:function(){var e=this.getNewMessageCount();return e>999?"999+":e},initChatChannelNewMessageCount:function(){this.set("newMessageCount",0)},isPinnedChatChannel:function(){return this.get("isPinned")||!1},togglePageChatChannelPinned:function(){var e=!this.isPinnedChatChannel();return this._togglePageChatChannelPinned(e).then(t.bind((function(){this.set("isPinned",e)}),this))},_togglePageChatChannelPinned:function(e){var t=this.getChatChannelBandNo(),n=this.getChatChannelId();return e?r.pinPageChatChannel(t,n):r.unpinPageChatChannel(t,n)},getChatChannelBandCore:function(){return this.get("bandCore")},isMessagingDisabledChatChannel:function(){return this.get("isMessagingDisabled")||!1},getChatChannelPageBandSubscriber:function(){var e=this.isPageBandChatChannel()?t.findWhere(this.get("participants"),{memberType:f}):null;return e?t.clone(e):null},getChatChannelProfileUrl:function(){return this.get("profileUrl")},getChatChannelBandNo:function(){return this.get("bandNo")},getChatChannelId:function(){return this.get("channelId")},getParticipants:function(){return this.get("participants")},isGroupChatChannel:function(){return this.get("isGroup")},isCertifiedBandChatChannel:function(){return this.getChannelBandInfo().certified||!1},isJoinableChatChannel:function(){return this.get("joinStatus")==u},isBigChatChannel:function(){return this.get("isBig")},isInvitePermittedChatChannel:function(){return this.isPermitted(A.OPERATIONS.INVITE_CHAT)},canSetMessageReadersVisibleState:function(){return!this.isPageBandChatChannel()&&this.isPermitted(A.OPERATIONS.SET_MESSAGE_READERS_VISIBLE_STATE)},getGroupCall:function(){return this.get("groupCall")},getGroupCallKey:function(){return(this.getGroupCall()||{}).groupCallKey},setGroupCall:function(e){this.set("groupCall",this._parseGroupCall(e))},isGroupCallExistAndNotClosed:function(){var e=this.getGroupCall();return!t.isEmpty(e)&&e.status!=d.CALL_STATUS_CLOSE},isVoiceCallOpen:function(){return!!this.isGroupCallExistAndNotClosed()&&0==this.getGroupCall().isVideo},isVideoCallOpen:function(){return!!this.isGroupCallExistAndNotClosed()&&1==this.getGroupCall().isVideo}});return A.OPERATIONS={CHANGE_MESSAGE_PERIOD:"change_message_period",DELETE_CHAT:"delete_chat",BAN_MEMBER:"ban_member",BAN_CHAT:"ban_chat",EDIT_CHAT_INFO:"edit_chat_info",SET_USER_NOTICE:"set_user_notice",HIDE_MESSAGE:"hide_message",INVITE_CHAT:"invite_chat",ACCEPT_APPLICATION:"accept_application",SET_MESSAGE_READERS_VISIBLE_STATE:"set_message_readers_visible_state"},A.STATE=m,A.create=function(e){return new A({channelId:e})},A}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(55);function a(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}return new(o.Object.extend({initialize:function(){s.get$Window().on(this.FULLSCREEN_EVENT_NAME,i.bind((function(){this.trigger(this.FULLSCREEN_CHANGE_EVENT,this.isFullScreenMode())}),this))},FULLSCREEN_EVENT_NAME:"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",FULLSCREEN_CHANGE_EVENT:"FULLSCREEN_CHANGE_EVENT",isEnableFullScreen:function(){var e;return document.fullscreenEnabled?e=document.fullscreenEnabled:document.msFullscreenEnabled?e=document.msFullscreenEnabled:document.mozFullScreenEnabled?e=document.mozFullScreenEnabled:document.webkitFullscreenEnabled&&(e=document.webkitFullscreenEnabled),e},isFullScreenMode:function(){return!!a()},isFullScreenElementIn:function(e){var n=a();return!!n&&e===n||t.contains(e,n)},closeFullScreen:function(){return this.isFullScreenMode()?(document.exitFullscreen?e=document.exitFullscreen():document.cancelFullScreen?e=document.cancelFullScreen():document.mozCancelFullScreen?e=document.mozCancelFullScreen():document.webkitCancelFullScreen?e=document.webkitCancelFullScreen():document.msExitFullscreen&&(e=document.msExitFullscreen()),e&&i.isFunction(e.then)?e:t.Deferred().resolve().promise()):t.Deferred().resolve().promise();var e},openFullScreen:function(e){var n;return e||(e=document.documentElement),e.requestFullscreen?n=e.requestFullscreen():e.mozRequestFullScreen?n=e.mozRequestFullScreen():e.webkitRequestFullscreen?n=e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):e.msRequestFullscreen&&(n=e.msRequestFullscreen()),n&&i.isFunction(n.then)?n:t.Deferred().resolve().promise()}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(0)],void 0===(o=function(e){var t={AU:"AUD",CC:"AUD",CX:"AUD",HM:"AUD",KI:"AUD",NF:"AUD",NR:"AUD",TV:"AUD",BR:"BRL",CA:"CAD",CN:"CNY",AD:"EUR",AT:"EUR",BE:"EUR",CY:"EUR",DE:"EUR",EE:"EUR",ES:"EUR",EU:"EUR",FI:"EUR",FR:"EUR",GF:"EUR",GP:"EUR",GR:"EUR",IE:"EUR",IT:"EUR",LU:"EUR",MC:"EUR",ME:"EUR",MQ:"EUR",MT:"EUR",NL:"EUR",PM:"EUR",PT:"EUR",RE:"EUR",SI:"EUR",SK:"EUR",SM:"EUR",TF:"EUR",VA:"EUR",YT:"EUR",IO:"GBP",UK:"GBP",HK:"HKD",IL:"ILS",IN:"INR",JP:"JPY",KR:"KRW",MX:"MXN",CK:"NZD",NU:"NZD",NZ:"NZD",PN:"NZD",TK:"NZD",TH:"THB",TW:"TWD",AS:"USD",EC:"USD",FM:"USD",GU:"USD",PR:"USD",PW:"USD",TC:"USD",UM:"USD",US:"USD",VG:"USD",VI:"USD",ZW:"USD",VN:"VND",CF:"XAF",CM:"XAF",CG:"XAF",TD:"XAF",GQ:"XAF",GA:"XAF",AI:"XCD",AG:"XCD",DM:"XCD",GD:"XCD",MS:"XCD",KN:"XCD",LC:"XCD",VC:"XCD",BJ:"XOF",BF:"XOF",CI:"XOF",GW:"XOF",ML:"XOF",NE:"XOF",SN:"XOF",TG:"XOF",PF:"XPF",NC:"XPF",WF:"XPF"},n=[{value:"AUD",label:"AUD(AU＄)",selectedLabel:"AU＄"},{value:"BRL",label:"BRL(R＄)",selectedLabel:"R＄"},{value:"CAD",label:"CAD(CA＄)",selectedLabel:"CA＄"},{value:"CNY",label:"CNY(CN￥)",selectedLabel:"CN￥"},{value:"EUR",label:"EUR(€)",selectedLabel:"€"},{value:"GBP",label:"GBP(￡)",selectedLabel:"￡"},{value:"HKD",label:"HKD(HK＄)",selectedLabel:"HK＄"},{value:"ILS",label:"ILS(₪)",selectedLabel:"₪"},{value:"INR",label:"INR(Rs)",selectedLabel:"Rs"},{value:"JPY",label:"JPY(JP￥)",selectedLabel:"JP￥"},{value:"KRW",label:"KRW(￦)",selectedLabel:"&#8361;"},{value:"MXN",label:"MXN(MX＄)",selectedLabel:"MX＄"},{value:"NZD",label:"NZD(NZ＄)",selectedLabel:"NZ＄"},{value:"THB",label:"THB(฿)",selectedLabel:"฿"},{value:"TWD",label:"TWD(NT＄)",selectedLabel:"NT＄"},{value:"USD",label:"USD(US＄)",selectedLabel:"US＄"},{value:"VND",label:"VND(₫)",selectedLabel:"₫"},{value:"XAF",label:"XAF(FCFA)",selectedLabel:"FCFA"},{value:"XCD",label:"XCD(EC＄)",selectedLabel:"EC＄"},{value:"XOF",label:"XOF(CFA)",selectedLabel:"CFA"},{value:"XPF",label:"XPF(CFPF)",selectedLabel:"CFPF"}];return{getSelectItemList:function(){return n},getCurrencyCode:function(e){return t[e]},getCurrencyLabel:function(t){var i=e.findWhere(n,{value:t});return i?i.selectedLabel:null},getDecimal:function(e){return"JPY"===e||"KRW"===e?0:2},getPriceLimit:function(e){var t=this.getDecimal(e),n=13-(t>0?t+1:0);n-=Math.floor((n-1)/4);var i=Math.pow(10,n)-1;return i=i<0?0:i,t>0&&(i=1-Math.pow(10,-Math.abs(t))+i),i},getSplitPriceArray:function(t,n,i){if(!n)return null;var o=Math.pow(10,i),s=Math.floor(t*o),a=s%n,r=Math.floor(s/n),l=[];l.push(this.numberWithCommas((r+a)/o));for(var c=1;c<n;c++)l.push(this.numberWithCommas(r/o));return e.shuffle(l)},numberWithCommas:function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i,o;i=[n(21),n(13)],void 0===(o=function(e,t){return{getApiClient:function(){return this.apiClient||(t.isLogedIn()?this.apiClient=e.getLoginV1Client():this.apiClient=e.getNoLoginV1Client()),this.apiClient},getUsingPack:function(){return e.createLoginClient().send({url:"https://sapi.band.us/v1/me/get_using_pack"}).then((function(e){return e.result_data.my_using_pack}))},getSprite:function(t){return e.createLoginClient().send({url:"https://sapi.band.us/v1/shop/get_sprite",data:{pack_no:t}}).then((function(e){return e}))},getStickerInfo:function(e){return this.getApiClient().sendAndThenProcess({url:"https://sapi.band.us/v1.0.0/get_sticker_info",type:"GET",data:{pack_no:e}})}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(505),s=n(52),a=n(660),r=i.Model.extend(t.extend({},a,{getFileName:function(){return this._getFile().title},getFileId:function(){return this._getFile().id},getFileSize:function(){return this._getFile().fileSize},getDropboxFileLink:function(){return this._getDropboxFile().link},getDropboxFileName:function(){return this._getDropboxFile().name},getDropboxFileId:function(){return this._getDropboxFile().fileId},getDropboxFileSize:function(){return this._getDropboxFile().size},getExternalFileLink:function(){return this._getExternalFile().link},getExternalFileName:function(){return this._getExternalFile().name},getExternalFileId:function(){return this._getExternalFile().fileId},getExternalFileSize:function(){return this._getExternalFile().size},getExternalFileSource:function(){return this._getExternalFile().source},getExpires:function(){return this._getFile().expiresAt||this._getDropboxFile().expiresAt||this._getExternalFile().expiresAt},getPunisherName:function(){return this._getPunisher().name},getPunishedAt:function(){return this.get("punishedAt")},getPunishment:function(){return this.get("punishment")},isTranslatable:function(){return this.get("isTranslatable")},getWrittenIn:function(){return this.get("writtenIn")},getLatestComment:function(){return this.get("latestComment")},getCommentCount:function(){return this.get("commentCount")},getVideoId:function(){return this.getVideo().id},_getFile:function(){return this.get("file")||{}},_getDropboxFile:function(){return this.get("dropboxFile")||{}},_getExternalFile:function(){return this.get("externalFile")||{}},_getVideo:function(){return this.get("video")||{}},_getPunisher:function(){return this.get("punisher")||{}}}));return r.fetchComment=function(e,t){var n={band_no:e,content_key:t.toApiParams(!0)};return o.getComment(n).then((function(e){return new r(s.camelizeKeys(e.comment))}))},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(82),s=t.Model.extend({idAttribute:"userNo",getUserNo:function(){return this.get("userNo")},getUserName:function(){return this.get("userName")},getDescription:function(){return this.get("description")},isDescriptionExist:function(){return!i.isEmpty(this.getDescription())},getExtraText:function(){return this.get("extraText")},setExtraText:function(e){this.set("extraText",e)},isExtraTextExist:function(){return!i.isEmpty(this.getExtraText())},isDisabled:function(){return 1==this.get("disabled")},setDisabled:function(e){this.set("disabled",e)},getProfileImageUrl:function(){return this.get("profileImageUrl")},getProfileThumbnail:function(){return this.get("profileThumbnail")},getProfileInnerClass:function(){return this.get("profileInnerClass")},isKid:function(){return 1==this.get("isKid")},isSelected:function(){return 1==this.get("selected")},setSelected:function(e){this.set("selected",e)},isSelectAllBtn:function(){return 1==this.get("selectAllBtn")}});function a(e){return new s({userNo:e.userNo,userName:e.userName,profileImageUrl:e.profileImageUrl,profileThumbnail:e.profileThumbnail,profileInnerClass:o.makeProfileInnerClass(e.profileThumbnail),selectAllBtn:e.selectAllBtn,description:e.description,isKid:e.isKid||!1,selected:e.selected||!1,extraText:e.extraText||null,disabled:e.disabled||!1})}return s.NONE_EXIST_USER_NO=-99999,s.buildMemberSelectionViewModelBy=function(e){return s.buildMemberSelectionViewModel({userNo:e.getUserNo(),userName:e.getName(),description:e.getDesc(),profileImageUrl:e.getProfileImageUrl(),isKid:e.isKid()})},s.buildMemberSelectionViewModel=function(e){return a({userNo:e.userNo,userName:e.userName,profileImageUrl:e.profileImageUrl,profileThumbnail:o.makeProfileThumbnailUrl(e.profileImageUrl),selectAllBtn:!1,description:e.description,isKid:e.isKid,selected:e.selected,extraText:e.extraText,disabled:e.disabled})},s.buildSelectAllBtnModel=function(e){return a({userNo:s.NONE_EXIST_USER_NO,userName:e.btnName,profileImageUrl:e.btnImageUrl,profileThumbnail:o.makeMediumSquareCoverUrl(e.btnImageUrl),selectAllBtn:!0,description:e.description})},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(34),a=n(177),r=o.Object.extend({initialize:function(e){e=e||{},this.message=e.message,this.packNo=null,this.stickerId=null,this.photos=[],this.videoId=null,this.videoUrl=null,this.videoWidth=null,this.videoHeight=null,this.videoName=null,this.gifVideo=!1,this.videoPlaytime=null,this.fileName=null,this.fileId=null,this.fileSize=null},setStickerInfo:function(e,t){this.packNo=e,this.stickerId=t},getPhotoCount:function(){return this.photos.length},isMaxPhotoCount:function(){return this.getPhotoCount()>=a.COMMENT.PHOTO_COUNT_LIMIT},addInputPhoto:function(e,t,n){this.photos.push({url:e,width:t,height:n})},getInputPhotos:function(){return this.photos},removePhotoInfoByUrl:function(e){this.photos=t.reject(this.photos,(function(t){return t.url==e}))},setInputPhotos:function(e){this.photos=e||[]},setVideoInfo:function(e,t,n,i,o,s,a){this.videoId=e,this.videoUrl=t,this.videoWidth=n,this.videoHeight=i,this.videoName=o,this.gifVideo=s,this.videoPlaytime=a||null},setFileInfo:function(e,t,n){this.fileName=e,this.fileId=t,this.fileSize=n},setDropboxFileInfo:function(e,t,n){this.dropboxFileName=e,this.dropboxFileId=t,this.dropboxFileSize=n},setExternalFileInfo:function(e,t,n){this.externalFileName=e,this.externalFileId=t,this.externalFileSize=n},isPhotoExist:function(){return!t.isEmpty(this.photos)},isVideoExist:function(){return null!=this.videoId},isFileExist:function(){return null!=this.fileName},isDropboxFileExist:function(){return null!=this.dropboxFileName},isExternalFileExist:function(){return null!=this.externalFileName},isStickerExist:function(){return null!=this.stickerId},isAttachedDataExist:function(){return this.isAttachmentExist()},isMessageExist:function(){return null!=this.message&&""!=i.trim(this.message)},resetSticker:function(){this.setStickerInfo(null,null)},setMessage:function(e){this.message=e},resetPhoto:function(){this.photos=[]},resetVideo:function(){this.setVideoInfo(null,null,null,null,null,null,null)},resetFile:function(){this.setFileInfo(null,null,null)},resetDropboxFile:function(){this.setDropboxFileInfo(null,null,null)},resetExternalFile:function(){this.setExternalFileInfo(null,null,null)},resetCommentInput:function(){this.resetPhoto(),this.resetSticker(),this.resetFile(),this.resetDropboxFile(),this.resetExternalFile(),this.resetVideo()},getPackNo:function(){return this.packNo},getStickerId:function(){return this.stickerId},getMessage:function(){return this.message},getVideoId:function(){return this.videoId},getVideoUrl:function(){return this.videoUrl},getVideoWidth:function(){return this.videoWidth},getVideoHeight:function(){return this.videoHeight},isGifVideo:function(){return this.gifVideo},isAbleToSubmit:function(){return this.isMessageExist()||this.isAttachmentExist()},isAttachmentExist:function(){return this.isStickerExist()||this.isPhotoExist()||this.isFileExist()||this.isDropboxFileExist()||this.isExternalFileExist()||this.isVideoExist()},getPhotosJson:function(){return this.isPhotoExist()?s.stringify(this.photos):null},getFileJson:function(){return this.isFileExist()?s.stringify({file_name:this.fileName,id:this.fileId,file_size:this.fileSize}):null},getFileName:function(){return this.fileName},getDropboxFileJson:function(){return this.isDropboxFileExist()?s.stringify({file_name:this.dropboxFileName,id:this.dropboxFileId,file_size:this.dropboxFileSize}):null},getDropboxFileName:function(){return this.dropboxFileName},getExternalFileJson:function(){return this.isExternalFileExist()?s.stringify({file_name:this.externalFileName,id:this.externalFileId,file_size:this.externalFileSize}):null},getExternalFileName:function(){return this.externalFileName},getVideoJson:function(){return this.isVideoExist()?s.stringify({id:this.videoId,url:this.videoUrl,width:this.videoWidth,height:this.videoHeight,title:this.videoName,is_gif:this.gifVideo}):null},isSameAttachInfoWith:function(e){function t(e){var t=["none"];return e.isAttachmentExist()&&(e.isStickerExist()?t=["sticker",e.getPackNo(),e.getStickerId()]:e.isPhotoExist()?t=["photos",e.getPhotosJson()]:e.isFileExist()?t=["file",e.getFileJson()]:e.isDropboxFileExist()?t=["dropboxFile",e.getDropboxFileJson()]:e.isExternalFileExist()?t=["externalFile",e.getExternalFileJson()]:e.isVideoExist()&&(t=["video",e.getVideoJson()])),t.join("_")}return t(this)===t(e)},makeJackpotExtra:function(){var e=null;return this.isPhotoExist()?e="photo":this.isVideoExist()?e="video":this.isFileExist()&&(e="file"),t.isEmpty(e)?{}:{attached_item_type:e}}});return r.buildCommentOrJoinQnAInputData=function(e){e=e||{};var n=new r;return n.setStickerInfo(e.stickerPackNo,e.stickerId),n.setInputPhotos(t.clone(e.photos)),n.setFileInfo(e.fileName,e.fileId,e.fileSize),n.setDropboxFileInfo(e.dropboxFileName,e.dropboxFileId,e.dropboxFileSize),n.setExternalFileInfo(e.externalFileName,e.externalFileId,e.externalFileSize),n.setVideoInfo(e.videoId,e.videoUrl,e.videoWidth,e.videoHeight,null,e.gifVideo),n},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(0),n(2),n(6),n(4),n(498),n(499),n(488)],void 0===(o=function(e,t,n,i,o,s,a){var r=i.View.extend({tagName:"section",className:"lyWrap",template:e.template('<div class="lyContent _wrap"><header class="header -noTitlebar"><h1 class="gSrOnly"><%= IM("ui.message.loading") %></h1></header><div class="main _main"></div></div>'),ui:{wrap:"._wrap",main:"._main"},onRender:function(){this.ui.main.html(e.template(o)({_loading_size:s.Size.MEDIUM,middleClass:a.ELEMENT.AREA_VERTICAL_MIDDLE})).css({height:this.options.height||340}),this.ui.wrap.css({width:this.options.width||340})}}),l=i.View.extend({initialize:function(e){this._loadingSize=e.loadingSize,this._middleClass=e.middleClass},template:e.template(o),serializeData:function(){return{_loading_size:this._loadingSize,middleClass:this._middleClass}},addClassName:function(e){this.$el.addClass(e)}});return l.Size=s.Size,l.MiddleClass=a.ELEMENT,l.build=function(e,t){return new l({loadingSize:e||l.Size.MEDIUM,middleClass:t})},l.buildAsMediumAreaMiddle=function(){return new l({loadingSize:l.Size.MEDIUM,middleClass:l.MiddleClass.AREA_VERTICAL_MIDDLE})},l.buildAsMediumScreenMiddle=function(){return new l({loadingSize:l.Size.MEDIUM,middleClass:l.MiddleClass.SCREEN_VERTICAL_MIDDLE})},l.buildListBottomLoadingBar=function(){return new l({loadingSize:l.Size.EXTRA_SMALL,middleClass:void 0})},l.buildListBottomMediumLoadingBar=function(){return new l({loadingSize:l.Size.MEDIUM,middleClass:void 0})},l.buildLayer=function(e){return new r(e||{})},l}.apply(t,i))||(e.exports=o)},function(e,t,n){var i=n(21),o="/v2.0.0/get_survey",s="/v2.0.0/get_surveyees",a="/v2.0.0/get_my_surveys",r="/v2.0.0/get_my_survey_response",l="/v2.0.0/get_survey_response",c="/v2.0.0/respond_survey",d="/v2.0.0/get_my_file_url_by_survey",u="/v2.0.0/get_file_url_by_survey",h="/v2.0.0/end_survey",p="/v2.0.0/get_survey_statistics",m="/v2.0.0/get_surveyees_with_choice",_="/v2.0.0/get_survey_other_choice_contents",g="/v2.0.0/get_survey_essays";t.getSurvey=function(e,t,n){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o,data:{band_no:e,post_no:t,survey_id:n}})},t.getSurveyees=function(e,t,n){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+s,data:{band_no:e,post_no:t,survey_id:n}})},t.getMySurveys=function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+a,data:{band_no:e}})},t.getMySurveyResponse=function(e,t,n){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+r,data:{band_no:e,post_no:t,survey_id:n}})},t.getSurveyResponse=function(e,t,n,o){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+l,data:{band_no:e,post_no:t,survey_id:n,surveyee_no:o}})},t.respondSurvey=function(e,t,n,o){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+c,method:"POST",data:{band_no:e,post_no:t,survey_id:n,do_finish:!0,response:JSON.stringify(o)}})},t.respondSurveyTemporarily=function(e,t,n,o){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+c,method:"POST",data:{band_no:e,post_no:t,survey_id:n,do_finish:!1,response:JSON.stringify(o)}})},t.getMyFileUrlBySurvey=function(e,t,n,o){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+d,data:{band_no:e,post_no:t,survey_id:n,question_id:o}})},t.getFileUrlBySurvey=function(e,t,n,o,s){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u,data:{band_no:e,post_no:t,survey_id:n,question_id:o,surveyee_no:s}})},t.endSurvey=function(e,t,n){return i.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+h,data:{band_no:e,post_no:t,survey_id:n}})},t.getSurveyStatistics=function(e,t,n,o){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+p,data:{band_no:e,post_no:t,survey_id:n,question_id:o}})},t.getSurveyeesWithChoice=function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+m,data:e})},t.getSurveyOtherChoiceContents=function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+_,data:e})},t.getSurveyEssays=function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+g,data:e})}},,function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i={VOTE_V1:"/v1.2/vote",CANCEL_VOTE_V1:"/v1/cancel_vote",SET_VOTE_STATE_V2:"/v2.0.0/set_vote_state",STOP_POLL_V1:"/v1.1/stop_poll",STOP_POLL_V2:"/v2.0.0/stop_poll",ADD_POLL_SUBJECT_V1:"/v1.1/add_poll_subject",ADD_POLL_SUBJECT_V2:"/v2.0.0/add_poll_subject",GET_REMAINED_VOTERS_V1:"/v1.0.0/get_remained_voters",GET_REMAINED_VOTERS_V2:"/v2.0.0/get_remained_voters",GET_POLL_VOTERS_V1:"/v1.0.0/get_poll_voters",GET_POLL_VOTERS_V2:"/v2.0.0/get_poll_voters",GET_MY_POLLS:"/v2.0.0/get_my_polls",GET_POLL:"/v2.0.0/get_poll"},o={voteV1:function(e,n,o){return t.createLoginV1ClientWithoutErrorAlert().send({url:"https://api.band.us"+i.VOTE_V1,data:{band_no:e,post_no:n,poll_subject_id:o}}).then((function(e,t,n){return e.result_data.message}))},cancelVoteV1:function(e,n,o){return t.getLoginV1Client().send({url:"https://api.band.us"+i.CANCEL_VOTE_V1,data:{band_no:e,post_no:n,poll_subject_id:o}}).then((function(e,t,n){return e.result_data.message}))},voteV2:function(e,t,n,i){return this._setVoteState(e,t,n,i,!0)},cancelVoteV2:function(e,t,n,i){return this._setVoteState(e,t,n,i,!1)},_setVoteState:function(e,n,o,s,a){return t.createLoginV1ClientWithoutErrorAlert().send({url:"https://api.band.us"+i.SET_VOTE_STATE_V2,data:{band_no:e,post_no:n,poll_id:o,poll_subject_id:s,state:a?"checked":"unchecked"}}).then((function(e,t,n){return e.result_data.message}))},stopPollV1:function(e,n){return t.getLoginV1Client().send({url:"https://api.band.us"+i.STOP_POLL_V1,data:{band_no:e,post_no:n}}).then((function(e,t,n){return e.result_data.message}))},stopPollV2:function(e,n,o){return t.getLoginV1Client().send({url:"https://api.band.us"+i.STOP_POLL_V2,data:{band_no:e,post_no:n,poll_id:o}}).then((function(e,t,n){return e.result_data.message}))},addPollSubjectV1:function(e,n,o){return t.getLoginV1Client().send({url:"https://api.band.us"+i.ADD_POLL_SUBJECT_V1,data:{band_no:e,post_no:n,subject:o}}).then((function(e,t,n){return e.result_data.message}))},addPollSubjectV2:function(e,n,o,s){return t.getLoginV1Client().send({url:"https://api.band.us"+i.ADD_POLL_SUBJECT_V2,data:{band_no:e,post_no:n,poll_id:o,subject:s}}).then((function(e,t,n){return e.result_data.message}))},getRemainedVotersV1:function(e,n){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_REMAINED_VOTERS_V1,data:{band_no:e,post_no:n}}).then((function(e,t,n){return e.result_data}))},getRemainedVotersV2:function(e,n,o){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_REMAINED_VOTERS_V2,data:{band_no:e,post_no:n,poll_id:o}}).then((function(e,t,n){return e.result_data}))},getPollSubjectVotersV1:function(e,n,o){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_POLL_VOTERS_V1,data:{band_no:e,post_no:n,poll_subject_id:o}}).then((function(e,t,n){return e.result_data.voters}))},getPollSubjectVotersV2:function(e,n,o,s){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_POLL_VOTERS_V2,data:{band_no:e,post_no:n,poll_id:o,poll_subject_id:s}}).then((function(e,t,n){return e.result_data.voters}))},getImportPoll:function(e){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_MY_POLLS,data:{band_no:e}}).then((function(e,t,n){return e.result_data.items}))},getPoll:function(e,n,o){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_POLL,data:{band_no:e,post_no:n,poll_id:o}}).then((function(e,t,n){return e.result_data.poll}))}};return o.PATHS=i,o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{CALL_STATUS_OPEN:"open",CALL_STATUS_CLOSE:"close",MAX_CALL_USER_COUNT:50,MAX_GALLERY_PEER_COUNT_PER_PAGE:25,GROUP_CALL_PROFILE_CLASS:"_groupCallProfile",MAX_VGA_RESOLUTION_USER_COUNT:4,PLANET_CAMERA_WIDTH:1280,PLANET_CAMERA_HEIGHT:720,PERMIT:{RENEW_GROUP_CALL_EXPIRATION:"renew_group_call_expiration",CLOSE_GROUP_CALL:"close_group_call"}}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(1242),i=n(1291),o=n(486),s=n(720),a=n(26),r=n(153),l=n(162),c=n(155),d=n(1033),u=n(1057),h=n(510),p=n(158),m=n(798),g=n(84),f=n(163),b=n(22),v=n(1113),A=n(514),E=n(493),T=n(1114),C={openMemberProfileLayer:function(e,t,n){if(!(e instanceof f))throw new Error("memberProfile is not instanceof MemberProfile");this._openProfileLayer({name:e.name,profileImageUrl:e.profileImageUrl},n,t)},_sendMessageToPageBandSubscriber:function(e,t){var n=e.getBandCore().bandNo,i=t.getBandMemberProfileMemberKey(),o=t.get("name");t.isAlreadyBlockedCommentAndChat()?h.openLayer({bodyDesc:p.nl2br(IM("page_band.unblock_and_start_chatting_confirm_desc")),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no")}).once(h.EVENTS.CONFIRM,(function(){t.togglePenaltyBlockCommentAndChat().then((function(){s.talkToPageBandSubscriber(n,i,o),t.fetchBandMember()}))})):s.talkToPageBandSubscriber(n,i,o)},_createProfileView:function(e,n){var i=n.getBandCore().bandNo,c=e.getBandMemberProfileUserNo(),d=e.getBandMemberProfileMemberKey(),p=new t({model:e,bandData:n,availableFunctions:[t.AVAILABLE_FUNCTIONS.EDIT_PROFILE,t.AVAILABLE_FUNCTIONS.SEND_MESSAGE,t.AVAILABLE_FUNCTIONS.BAN_MEMBER,t.AVAILABLE_FUNCTIONS.BLOCK_COMMENT_AND_CHAT,t.AVAILABLE_FUNCTIONS.GOTO_SEARCH_MEMBER_CONTENTS,t.AVAILABLE_FUNCTIONS.UNMUTE_MEMBER,t.AVAILABLE_FUNCTIONS.VIEW_JOIN_INFO,t.AVAILABLE_FUNCTIONS.REPORT_MEMBER_PROFILE]}),f={};return f[t.AVAILABLE_FUNCTIONS.SEND_MESSAGE]=_.bind((function(){var t=[{userNo:c,name:e.get("name")}];n.isPageChatAsManagerPermitted()?this._sendMessageToPageBandSubscriber(n,e):s.startChattingWithUsers(t,i)}),this),f[t.AVAILABLE_FUNCTIONS.GOTO_SEARCH_MEMBER_CONTENTS]=function(){o.closeAll(),n.canAccessSearchMemberPostWebPage()?r.GROUP_BAND_MEMBER_CONTENT.goDForced({band_no:i,member_key:d,type:"post"}):l.PAGE_BAND_MEMBER_COMMENT.goDForced({band_no:i,member_key:d})},f[t.AVAILABLE_FUNCTIONS.UNMUTE_MEMBER]=function(){h.openLayer({bodyTitle:IM("member.unmute.confirm.title"),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no")}).once(h.EVENTS.CONFIRM,(function(){E.unmuteMember(c,i).then(_.bind((function(){e.fetchBandMember(),g.refreshCurrentPage()}),this))}))},f[t.AVAILABLE_FUNCTIONS.EDIT_PROFILE]=function(){n.canStartJoinInsteadEditProfile()?(o.closeAll(),m.build({onBandJoinCompleted:function(e){e&&alert(e),g.refreshCurrentPage()}}).subscribePageFromEditProfile(i)):C.openEditProfileView(i)},f[t.AVAILABLE_FUNCTIONS.BAN_MEMBER]=function(){u.openLayer({bandData:n,userNo:c,memberKey:d,isDeleted:!e.get("isMember")}).on("memberWithdrawal:updateMember",(function(){n.fetchBandData(),a.getDGlobalChannel().trigger(a.EVENT.MEMBER_REMOVED,i,c),o.closeAll()}))},f[t.AVAILABLE_FUNCTIONS.BLOCK_COMMENT_AND_CHAT]=function(){(e.get("isAlreadyBlockedCommentAndChat")?T.openPenaltyRemoveConfirm():T.openPenaltyAddConfirm()).confirm((function(){e.togglePenaltyBlockCommentAndChat().then((function(){e.fetchBandMember()}))}))},f[t.AVAILABLE_FUNCTIONS.VIEW_JOIN_INFO]=function(){v.openDGroupBandJoinHistoryView({bandNo:e.getBandNo(),name:e.getName(),createdAt:e.getCreatedAt(),memberKey:e.getBandMemberProfileMemberKey()})},f[t.AVAILABLE_FUNCTIONS.REPORT_MEMBER_PROFILE]=function(){A.openMemberProfileReportPopup(i,d)},p.on(f),p},openProfileView:function(e,t){this._openProfileLayer({},e,t)},openMembershipProfileLayer:function(e){var t=f.buildMemberProfile({name:e.name,profileImageUrl:e.profileImageUrl,memberType:b.MEMBER_TYPE.MEMBERSHIP});this.openMemberProfileLayer(t,e.userNo,e.bandNo)},_openProfileLayer:function(e,t,n){var i=c.get(t);i.loadBandData().then((function(){var o=d.createBandMemberProfileModel(e,t,n);return i.canFetchMemberProfile()?o.fetchBandMember().then((function(){return o})):o})).then(_.bind((function(e){var t=this._createProfileView(e,i);o.open(t)}),this))},openEditProfileView:function(e,t){i.openLayer(_.extend({bandNo:e,bandData:c.get(e)},t))}};return C}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1343),s=n(9),a=n(655),r=n(486),l=i.View.extend({tagName:"section",className:"lyWrap ",attributes:{"data-viewname":"DContentCreationPunishmentInfoView"},template:t.template(o),templateContext:function(){return{penaltyStart:s.format.date(new Date(this.model.get("penaltyStart")),"short_date_time"),penaltyEnd:s.format.date(new Date(this.model.get("penaltyEnd")),"short_date_time")}},events:{"click ._confirmBtn":"destroy"}});return new(i.Object.extend({initialize:function(){this._currentlyOpenLayer=null},isContentCreationPunished:function(e){var t=a.isContentCreationPunished();return t&&!1!==e&&null==this._currentlyOpenLayer&&(this._currentlyOpenLayer=new l({model:a.getContentCreationPunishmentInfo()}),this.listenTo(this._currentlyOpenLayer,"destroy",(function(){this._currentlyOpenLayer=null})),r.openWithoutHiding(this._currentlyOpenLayer)),t}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t){!function(e){"use strict";if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(e){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},i=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},o=n.prototype,s=i.prototype,a=e.FileReaderSync,r=function(e){this.code=this[this.name=e]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=l.length,d=e.URL||e.webkitURL||e,u=d.createObjectURL,h=d.revokeObjectURL,p=d,m=e.btoa,_=e.atob,g=e.ArrayBuffer,f=e.Uint8Array,b=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(i.fake=s.fake=!0;c--;)r.prototype[l[c]]=c+1;return d.createObjectURL||(p=e.URL=function(e){var t,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=e,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(t=e.match(b),n.origin=t&&t[1])),n}),p.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof i?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):m?t+";base64,"+m(e.data):t+","+encodeURIComponent(e.data)):u?u.call(d,e):void 0},p.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&h&&h.call(d,e)},o.append=function(e){var n=this.data;if(f&&(e instanceof g||e instanceof f)){for(var o="",s=new f(e),l=0,c=s.length;l<c;l++)o+=String.fromCharCode(s[l]);n.push(o)}else if("Blob"===t(e)||"File"===t(e)){if(!a)throw new r("NOT_READABLE_ERR");var d=new a;n.push(d.readAsBinaryString(e))}else e instanceof i?"base64"===e.encoding&&_?n.push(_(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},o.getBlob=function(e){return arguments.length||(e=null),new i(this.data.join(""),e,"raw")},o.toString=function(){return"[object BlobBuilder]"},s.slice=function(e,t,n){var o=arguments.length;return o<3&&(n=null),new i(this.data.slice(e,o>1?t:this.data.length),n,this.encoding)},s.toString=function(){return"[object Blob]"},s.close=function(){this.size=0,delete this.data},n}(e);e.Blob=function(e,n){var i=n&&n.type||"",o=new t;if(e)for(var s=0,a=e.length;s<a;s++)Uint8Array&&e[s]instanceof Uint8Array?o.append(e[s].buffer):o.append(e[s]);var r=o.getBlob(i);return!r.slice&&r.webkitSlice&&(r.slice=r.webkitSlice),r};var n=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=n(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4).Object.extend({initialize:function(){this._timer=null},startDetecting:function(e,n,o,s){clearInterval(this._timer),this._$el=t(e),this._count=1,this._totalCount=o,this._checkScroll=!!s,this._checkScroll?this._domHeight=this._$el.prop("scrollHeight"):this._domHeight=this._$el.height(),this._timer=setInterval(i.bind(this._heightCheck,this),n)},_heightCheck:function(){this._count>this._totalCount&&clearInterval(this._timer),this._count++;var e=0;e=this._checkScroll?this._$el.prop("scrollHeight"):this._$el.height(),this._domHeight!=e&&this.trigger(o.EVENT.HEIGHT_CHANGED),this._domHeight=e}});return o.EVENT={HEIGHT_CHANGED:"domHeightDetector:changed"},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(9),s=n(16),a={MINUTE:{value:"minute",message:o.message("web.duration_type.minute"),beforeMessage:o.message("web.duration_type.minute.before"),momentUnit:"minutes"},HOUR:{value:"hour",message:o.message("web.duration_type.hour"),beforeMessage:o.message("web.duration_type.hour.before"),momentUnit:"hours"},DAY:{value:"day",message:o.message("web.duration_type.day"),beforeMessage:o.message("web.duration_type.day.before"),momentUnit:"days"},WEEK:{value:"week",message:o.message("web.duration_type.week"),beforeMessage:o.message("web.duration_type.week.before"),momentUnit:"weeks"}},r={MINUTE:i.range(1,61),HOUR:i.range(1,25),DAY:i.range(1,32),WEEK:i.range(1,5)},l={DAY:i.range(0,32),WEEK:i.range(1,5)},c=[{duration_type:a.MINUTE.value,amount:10,alarm_time:""},{duration_type:a.MINUTE.value,amount:30,alarm_time:""},{duration_type:a.HOUR.value,amount:1,alarm_time:""},{duration_type:a.HOUR.value,amount:2,alarm_time:""},{duration_type:a.HOUR.value,amount:3,alarm_time:""},{duration_type:a.DAY.value,amount:1,alarm_time:""},{duration_type:a.DAY.value,amount:2,alarm_time:""}],d=[{duration_type:a.DAY.value,amount:0,alarm_time:"09:00"},{duration_type:a.DAY.value,amount:1,alarm_time:"09:00"},{duration_type:a.DAY.value,amount:2,alarm_time:"09:00"},{duration_type:a.DAY.value,amount:3,alarm_time:"09:00"}],u={getFullMessage:function(e,t){return t?e?this.getAlldayScheduleAlarmDayMessage(t.get("durationType"),t.get("amount"))+" ("+this.getAlldayScheduleAlarmTimeMessage(t.get("alarmTime"))+")":t.get("durationType")?IM("web.schedule.alarm.normal."+t.get("durationType"),{amount:t.get("amount")}):"":this.getNoneAlarmMessage()},getMessage:function(e,t){return t?e?this.isPredefinedAlarm(e,t)?this.getAlldayScheduleAlarmDayMessage(t.duration_type,t.amount)+" ("+this.getAlldayScheduleAlarmTimeMessage(t.alarm_time)+")":this.getCustomAlarmMessage():t.duration_type?o.message("web.schedule.alarm.normal."+t.duration_type,{amount:t.amount}):"":this.getNoneAlarmMessage()},getAlldayScheduleAlarmDayMessage:function(e,t){return 0==t?dayMessage=o.message("web.schedule.alarm.allday.d-day"):o.message("web.schedule.alarm.allday."+e,{amount:t})},getAlldayScheduleAlarmTimeMessage:function(e){return s(e,"HH:mm").format("a h:mm")},getNoneAlarmMessage:function(){return o.message("web.schedule.alarm.none")},getCustomAlarmMessage:function(){return o.message("web.schedule.alarm.custom")},getPredefinedAlarms:function(e){return e?d:c},isPredefinedAlarm:function(e,t){return!!t&&(n=e?d:c,i.find(n,(function(n){return e?i.isEqual(t,n):t.duration_type==n.duration_type&&t.amount==n.amount}),this));var n},getAllDurationAmounts:function(e){return e?l:r},getDurationAmounts:function(e,t){return t?l[e.toUpperCase()]:r[e.toUpperCase()]},getDurationTypes:function(e){return e?[a.DAY,a.WEEK]:i.values(a)},isValidAlarm:function(e){return!!e&&!!(e.get("durationType")||i.isNumber(e.get("amount"))||e.get("alarmTime"))},isExistingAlarm:function(e,t){return!!i.find(e,(function(e){return(t.key?t.key:t.get("durationType")+"_"+t.get("amount"))==e.get("durationType")+"_"+e.get("amount")}))},getMomentUnitByDurationType:function(e){switch(e){case a.MINUTE.value:return a.MINUTE.momentUnit;case a.HOUR.value:return a.HOUR.momentUnit;case a.DAY.value:return a.DAY.momentUnit;case a.WEEK.value:return a.WEEK.momentUnit}}};u.DURATION_TYPE=a,e.exports=u},function(e,t,n){var i;void 0===(i=function(e){var t=n(0);return{sendPostMessage:function(e,n,i,o,s){!e||t.isEmpty(n)||t.isEmpty(i)||e.postMessage({channel:n,message:i,data:o},s||"*")}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(2),n(0),n(21)],void 0===(o=function(e,t,n){var i=null,o=function(){return i||(i=n.getLoginV1Client()),i};return{getPhotoAlbums:function(t){return o().send({url:"https://api.band.us/v1.5.0/get_photo_albums",data:e.extend({band_no:"",all_cover_count:6,album_cover_count:4,album_count:10,is_with_all:!0},t)}).then((function(e){return e.result_data}))},getPhotoAlbum:function(e,t){return o().send({url:"https://api.band.us/v1.5.0/get_photo_album",data:{band_no:e,album_no:t}}).then((function(e){return e.result_data}))},createPhotoAlbum:function(e,t,n){return o().sendAndThenProcess({url:"https://api.band.us/v1.5.0/create_photo_album",type:"POST",data:{band_no:e,album_name:t,announceable:n}})},setPhotoAlbumName:function(e,t,n){var i={band_no:e,album_no:t,album_name:n};return o().sendAndThenProcess({url:"https://api.band.us/v1.5.0/set_photo_album_name",type:"POST",data:i})},deletePhotoAlbum:function(e,t){var n={band_no:e,album_no:t};return o().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1/delete_photo_album",data:n})}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(182),i=function(e,t){this.maxWidth=e,this.maxHeight=t};return i.prototype.maxRatio=function(){return this.maxWidth/this.maxHeight},i.prototype.calcurate=function(e){var n,i=e.width,o=e.height,s=e.nomalizeDecimalMethod||"round";return i/o>this.maxRatio()?i>this.maxWidth&&(n="width",o=(i=this.maxWidth)*e.height/e.width):o>this.maxHeight&&(n="height",i=(o=this.maxHeight)*e.width/e.height),{filledSide:n,width:i=t.nomalizeDecimal(i,s),height:o=t.nomalizeDecimal(o,s)}},i}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(152);return{FEED_VERSION:window.isMobileView?"1.0.0":"2.1.0",PUBLIC_FEED_VERSION:window.isMobileView?"1.0.0":"1.1.0",FEED_TYPE:{FEED:"feed",OPEN_FEED:"open_feed"},PUBLIC_FEED_LOCATION:{OPENBAND_FEEDS:"openband_feeds",MAIN_FEED:"main_feed",BAND_LIST:"band_list"},ITEM_TYPE:{POST:"post",RECOMMENDED_POSTS:"recommendedPosts",PHOTO:"photo",PHOTOS:"photos",BOOKMARK:"bookmark",SCHEDULE:"schedule",SCHEDULES:"schedules",BANDS:"bands",LIVE:"live",FILES:"files",MISSIONS:"missions"},FEEDBACK_TYPE:{MY_COMMENTED_POST:"my_commented_post",MY_COMMENT_COMMENTED_POST:"my_comment_commented_post",MY_EMOTED_POST:"my_emoted_post",MY_COMMENTED_COMMENT:"my_commented_comment",REFERRED_POST:"referred_post",REFERRED_COMMENT:"referred_comment",REFERRED_COMMENT_COMMENT:"referred_comment_comment",COMMENT_FOR_MEMORY:"comment_for_memory",MISSED_POPULAR_POST:"missed_popular_post",COMMENT_FOR_POST_OF_MY_COMMENT:"comment_for_post_of_my_comment",POST_CHOSEN_BY_FRIEND:"post_chosen_by_friend",RSVP_SCHEDULE_CREATION:"rsvp_schedule_creation"},FEED_MORE_OPTION_TYPES:[t.MORE_OPTION_TYPE.MODIFY_POST,t.MORE_OPTION_TYPE.SHOW_POST_URL,t.MORE_OPTION_TYPE.SHARE_POST,t.MORE_OPTION_TYPE.BOOKMARK_POST,t.MORE_OPTION_TYPE.REPORT_POST,t.MORE_OPTION_TYPE.DELETE_POST,t.MORE_OPTION_TYPE.HIDE_POST_FROM_FEED,t.MORE_OPTION_TYPE.HIDE_BAND_FROM_FEED],RECOMMENDED_FEED_MORE_OPTION_TYPES:[t.MORE_OPTION_TYPE.SHOW_POST_URL,t.MORE_OPTION_TYPE.SHARE_POST,t.MORE_OPTION_TYPE.BOOKMARK_POST,t.MORE_OPTION_TYPE.REPORT_POST,t.MORE_OPTION_TYPE.HIDE_POST_FROM_FEED,t.MORE_OPTION_TYPE.HIDE_BAND_FROM_FEED]}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(1293),a=n(177),r=n(537),l=n(198),c=n(533),d=n(57),u=n(507);n(56);var h=o.Object.extend({createPhotoUploader:function(e,t){return new s(this._generatePhotoDefaultOption(e,t))},createSinglePhotoUploader:function(e,n){return new s(t.extend(this._generatePhotoDefaultOption(),{multiple:!1,autoUpload:!1,validators:[r.SINGLE_PHOTO_WITHOUT_GIF_VALIDATOR]},n,{el:e,urlCreator:function(){return l.makeApiBaseUrl(p.PHOTO)}}))},createProfilePhotoUploader:function(e,n){return new s(t.extend(this._generatePhotoDefaultOption(),{multiple:!1,autoUpload:!0,title:IM("web.upload.title.profile_photo"),validators:r.makeProfilePhotoValidators(),data:{keep_ani_gif:!0},fileInputTitle:window.webkitURL?" ":""},n,{el:e,urlCreator:function(){return l.makeApiBaseUrl(p.PHOTO)}}))},createVideoUploader:function(e,t){return new s(this._generateVideoDefaultOption(e,t))},createFileUploader:function(e,n){var i=t.extend({multiple:!0,autoUpload:!0,maxSize:0,maxFiles:0,showProgress:!0,title:IM("web.upload.title.attach"),accept:"*/*",validators:[r.FILE_VALIDATOR]},n,{el:e,urlCreator:function(){return l.makeApiBaseUrl(p.FILE)}});return new s(i)},createBandCoverImageUploader:function(e,n){var i=this._generatePhotoDefaultOption();return new s(t.extend(i,{multiple:!1,autoUpload:!1,title:IM("web.upload.title.band_cover_image"),validators:[r.SINGLE_PHOTO_WITHOUT_GIF_VALIDATOR]},n,{el:e,urlCreator:function(){return l.makeApiBaseUrl(p.PHOTO)}}))},createPhotoOrVideoUploader:function(e,n){var i=new s(this._generatePhotoOrVideoOption(e,n));return this.listenTo(i,u.SELECT_FILES,(function(o){if(r.isVideoType(o.files[0])){var s=t.extend({},i.getOption(),this._generateVideoDefaultOption(e,n),{validators:[r.PHOTO_OR_VIDEO_VALIDATOR]});i.setOption(s)}})),this.listenTo(i,u.RESET,(function(){var o=t.extend({},i.getOption(),this._generatePhotoOrVideoOption(e,n));i.setOption(o)})),i},createAudioUploader:function(e,n){return n=t.extend({multiple:!1,autoUpload:!0,maxSize:0,maxFiles:0,showProgress:!0,title:IM("web.upload.title.attach"),accept:"."+a.AUDIO.UPLOAD_FORMAT.join(",."),validators:[r.AUDIO_VALIDATOR]},n,{el:e,urlCreator:function(){return l.makeApiBaseUrl(p.AUDIO)}}),new s(n)},createPageIntroMediaUploader:function(e){var n={multiple:!1,autoUpload:!0,duplicate:!0,data:{maxRunningSecs:a.VIDEO.MAX_RUNNING_SECS.BAND_MISSION},elements:{dnd:{el:e}},accept:this._generatePhotoOrVideoAcceptOption(a.PHOTO.FORMAT_WITHOUT_GIF,a.VIDEO.FORMAT),validators:[r.PAGE_INTRO_ATTACHED_MEDIA_VALIDATOR]},i=new s(this._generatePhotoDefaultOption(e,n));return this.listenTo(i,u.SELECT_FILES,(function(o){if(r.isVideoType(o.files[0])){var s=t.extend({},i.getOption(),this._generateVideoDefaultOption(e,n));i.setOption(s)}})),this.listenTo(i,u.RESET,(function(){var o=t.extend({},i.getOption(),this._generatePhotoDefaultOption(e,n));i.setOption(o)})),i},addUploadResultListToBandAlbum:function(e,t,n){var o=i.map(n,(function(e){return e.isVideo||e.isGifVideo?{video:{id:e.id,url:e.url,width:e.width,height:e.height,title:e.name,is_gif:e.isGifVideo}}:{photo:{url:e.url,width:e.width,height:e.height}}}));return c.createPhotosOrVideos(e,t,o)},_generatePhotoOrVideoOption:function(e,n){var i=t.extend({},n,{accept:this._generatePhotoOrVideoAcceptOption(a.PHOTO.FORMAT,a.VIDEO.FORMAT),validators:[r.PHOTO_OR_VIDEO_VALIDATOR]});return this._generatePhotoDefaultOption(e,i)},_generatePhotoOrVideoAcceptOption:function(e,n){var i="image/"+e.join(",image/")+",image/*,video/"+n.join(",video/")+",video/*";return(d.isWindows8Or8_1IE()||t.browser.mozilla)&&(i="."+e.join(",.")+",."+n.join(",.")),i},_generatePhotoDefaultOption:function(e,n){return t.extend({multiple:!0,autoUpload:!1,maxSize:0,maxFiles:0,showProgress:!0,title:IM("web.upload.title.photo"),accept:"image/*",photoUpload:!0,videoUpload:!1,validators:[r.PHOTO_VALIDATOR],readPhotographedAt:!1},n,{el:e,urlCreator:function(){return l.makeApiBaseUrl(p.PHOTO)}})},_generateVideoDefaultOption:function(e,n){var i="video/*,.ts,.mts";return d.isWindows8Or8_1IE()?i="."+a.VIDEO.FORMAT.join(",."):t.browser.safari&&(i="video/"+a.VIDEO.FORMAT.join(",video/")+",video/*"),t.extend({multiple:!1,autoUpload:!0,maxSize:0,maxFiles:0,showProgress:!0,title:IM("upload_video"),accept:i,photoUpload:!1,videoUpload:!0,validators:[r.VIDEO_VALIDATOR]},n,{el:e,urlCreator:function(){return l.makeApiBaseUrl(p.VIDEO)}})}}),p={FILE:"https://up.band.us/v1/uploader/upload_file",PHOTO:"https://up.band.us/v2/uploader/upload_photo",VIDEO:"https://up.band.us/v1/uploader/upload_video",AUDIO:"https://up.band.us/v1/uploader/upload_audio"};return new h}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i=n(0),o=n(10),s=n(2),a=n(52),r=n(43),l=n(6),c=n(490),d=n(828),u=n(165),h=n(830),p=n(501),m=n(152),_=n(584),g=n(13),f=n(831),b=n(493),v=n(160),A=n(683),E=n(622),T=l.Model.extend({attachmentType:m.POST_ATTACHMENT_TYPE.SURVEY,idAttribute:"surveyId",defaults:function(){return{surveyId:null,title:"",description:"",questions:d.build(),startAt:void 0,endAt:r(Date.now()).add(E.DEFAULT_PERIOD_RANGE_BY_DAY,"day").valueOf(),timeZoneId:u.getCurrentTimezoneId(),managers:new l.Collection(null,{model:p}),isSurveyeeQualified:!1,surveyees:h.createFromJSON([]),author:null}},parse:function(e){var t={postNo:(e=a.camelizeKeys(e)).postNo,surveyId:e.surveyId,title:e.title,description:e.description,startAt:e.startAt,endAt:e.endAt,timeZoneId:e.timeZoneId,questions:d.build(e.questions),surveyees:h.createFromAPI(e.surveyees),managers:new l.Collection(e.managers||[],{model:p,parse:!0}),isSurveyeeQualified:e.isSurveyeeQualified,author:new p(e.author,{parse:!0}),viewerRespondedAt:e.viewerRespondedAt,viewerResponseStoredAt:e.viewerResponseStoredAt,respondedMemberCount:e.respondedMemberCount};return e.bandNo&&(t.bandNo=e.bandNo),t},importAPIJson:function(e,t){return _.getSurvey(t,e.post_no,e.survey_id).then(i.bind((function(e){var t=e.survey;if(T.deleteNeedlessForWriteFromAPIJSON(t),i.each(t.questions,A.prepareApiResponseForCopy),t.start_at<Date.now()){var n=r(t.start_at),o=r(t.end_at).diff(n);t.start_at=r().add(1,"day").second(n.second()).minute(n.minute()).hour(n.hour()).valueOf(),t.end_at=r(t.start_at).add(o).valueOf()}var s=this.parse(t);this.set(s)}),this))},setJSON:function(e){(e=i.clone(e)).surveyees=h.createFromAPI(e.surveyees),e.managers=new l.Collection(e.managers,{model:p}),e.questions=d.build(e.questions),this.set(e)},toJSON:function(){return c.toRecursiveJSON(this)},toJSONForSave:function(){var e={survey_id:this.get("surveyId"),title:this.get("title"),description:this.get("description"),questions:this.get("questions").toJSONForSave(),start_at:this.get("startAt")||Date.now(),end_at:this.get("endAt"),time_zone_id:this.get("timeZoneId"),is_surveyee_qualified:this.get("isSurveyeeQualified"),surveyees:this.get("isSurveyeeQualified")?this.get("surveyees").toJSONForSave():[]};return this.get("managers").length>0&&(e.managers=this.get("managers").map((function(e){return{user_no:e.getUserNo()}}))),e},isValid:function(){var e=this.toJSONForSave();return!o.isBlank(e.title)&&!i.isEmpty(e.questions)},fetchSurveyModel:function(){var e=this.get("bandNo"),t=this.get("postNo"),n=this.get("surveyId");return _.getSurvey(e,t,n).then(i.bind((function(e){return this.set(this.parse(e.survey)),this}),this))},fetchSurveyModelWithSurveyeeList:function(){return this.fetchSurveyModel().then(i.bind((function(){return this.getSurveyListCollection().fetchSurveyeeListCollection()}),this)).then(i.bind((function(){this.trigger("change")}),this))},endSurvey:function(){var e=this.get("bandNo"),t=this.get("postNo"),n=this.get("surveyId");return _.endSurvey(e,t,n)},getSurveyListCollection:function(){var e=this.get("bandNo"),t=this.get("postNo"),n=this.get("surveyId");return this._surveyeeListCollection||(this._surveyeeListCollection=f.createSurveyeeListCollection(e,t,n)),this._surveyeeListCollection},setSurveyees:function(e){e instanceof l.Collection&&(e=e.map(i.identity)),this.get("surveyees").addSurveyees(e),this.trigger("changeSurveyees")},removeSurveyee:function(e){this.get("surveyees").removeSurveyee(e),this.trigger("changeSurveyees")},removeAllSurveyees:function(){this.get("surveyees").reset([]),this.trigger("changeSurveyees")},addManagers:function(e){this.get("managers").add(e,{parse:!0}),this.trigger("changeManagers")},removeManager:function(e){i.isNumber(e)&&(e=this.get("managers").where({userNo:e})),this.get("managers").remove(e),this.trigger("changeManagers")},removeAllManagers:function(){this.get("managers").reset([]),this.trigger("changeManagers")},isRespondedMemberExist:function(){return this.get("respondedMemberCount")>0},isAuthor:function(){return g.isMe(this.get("author").getUserNo())},getStartAt:function(){return this.get("startAt")},getEndAt:function(){return this.get("endAt")},getTimeZoneId:function(){return this.get("timeZoneId")},isEnded:function(){return Number(this.get("endAt"))<Date.now()},isTargetSurveyee:function(e){if(!e)throw new Error("bandData is required");return e.canRespondSurvey()&&(!this.get("isSurveyeeQualified")||!!this.get("surveyees").find(i.bind((function(e){return g.isMe(e.get("surveyee").getUserNo())}),this)))},hasNoTargetSurveyees:function(){return this.get("isSurveyeeQualified")&&this.get("surveyees").isEmpty()},getSurveyees:function(){return this.get("surveyees")},getSurveyee:function(e){return this.getSurveyees().get(e)},isManagerViewer:function(){return!!this.isAuthor()||!!this.get("managers").find(i.bind((function(e){return g.isMe(e.getUserNo())}),this))},canAccessSurveyeeList:function(){return this.isManagerViewer()},canEndSurvey:function(){return!this.isEnded()&&this.isAuthor()},canAccessDetailAsSurveyee:function(e){return!!this.isTargetSurveyee(e)&&(!this.isEnded()||!!this.isViewerResponded())},getViewerRespondedAt:function(){return this.get("viewerRespondedAt")},isViewerResponded:function(){return!!this.getViewerRespondedAt()},isResponseStoredTemporarily:function(){return!!this.get("viewerResponseStoredAt")},isBeforeStart:function(){return Date.now()<this.get("startAt")},isResponseAllowed:function(e){return!this.isBeforeStart()&&(!this.isEnded()&&(!!this.isTargetSurveyee(e)&&!this.isViewerResponded()))},getQuestions:function(){return this.get("questions")},getQuestionCount:function(){return this.getQuestions().length}});T.deleteNeedlessForWriteFromAPIJSON=function(e){delete e.survey_id,delete e.post_no,delete e.viewer_responded_at,delete e.viewer_response_stored_at,delete e.responded_member_count,delete e.author},T.prepareApiResponseForCopy=function(e){T.deleteNeedlessForWriteFromAPIJSON(e),delete e.start_at,e.end_at=r().add(E.DEFAULT_PERIOD_RANGE_BY_DAY,"day").valueOf(),e.is_surveyee_qualified=!1,e.surveyees=[],i.each(e.questions,A.prepareApiResponseForCopy)},T.setModelsDefaultManagers=function(e,t){return i.reduce(e,(function(e,n){return n.removeAllManagers(),e.then((function(){if(t.getBandCore().isSurveyManagerDefaultIsAll())return b.getBandMembersOfBandWithFilter(t.getBandNo(),v.SURVEY_MANAGER_PAGE).then((function(e){n.addManagers(e.members)}));n.removeAllManagers()}))}),s.when().promise())},T.createSurveyModel=function(e,t,n){return new T({bandNo:e,postNo:t,surveyId:n})},e.exports=T},function(e,t,n){var i;void 0===(i=function(e){var t=n(9),i=n(542),o={};return o[i.TEXT]=function(e){return e},o[i.STICKER]=function(e){return t.message("chat.message.sticker_body")},o[i.PHOTO]=function(e){return t.message("chat.message.photoType_body")},o[i.GIPHY]=function(e){return t.message("chat.message.gif_body")},o[i.AUDIO]=function(e){return t.message("chat.message.audio_body")},o[i.VOICE_CALL_START]=function(e){return t.message("group_call.voice_call_started")},o[i.VIDEO_CALL_START]=function(e){return t.message("group_call.video_call_started")},o[i.VIDEO]=function(e){return t.message("chat.message.video_body")},o[i.LOCATION]=function(e){return t.message("chat.message.location_body")},o[i.FILE]=function(e){return t.message("chat.message.file_body")},o[i.CONTACT]=function(e){return t.message("chat.message.contact_body")},o[i.GIF_VIDEO]=function(e){return t.message("chat.message.gif_body")},o[i.RECLAIM]=function(e){return t.message("chat.message.reclaim_body")},o[i.PHOTO_LIST]=function(e){return t.message("chat.message.photo_list_body")},{toTextMessage:function(e,n){return e in o?o[e](n):t.message("chat.message.unknown_body")}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(513);return new(t.Object.extend({openPopup:function(e,t,n){n=n||{},i.openGet({windowURL:"https://"+window.authDomain+"/oauth2/authorize",windowName:n.windowName||null,width:n.width||450,height:n.height||450,centerBrowser:1,params:{response_type:"token",client_id:e,redirect_uri:t}})}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(2),o={resolve:function(){return i.Deferred().resolve().promise()},resolveValue:function(e){return i.Deferred().resolve(e).promise()},reject:function(){return i.Deferred().reject().promise()},rejectValue:function(e){return i.Deferred().reject(e).promise()}};e.exports=o},function(e,t,n){var i,o,s;o=[t],void 0===(s="function"==typeof(i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=e.saveAs=t||function(e){if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},i=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in i,s=/constructor/i.test(e.HTMLElement)||e.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),r=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},l=function(e){setTimeout((function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()}),4e4)},c=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,d,u){u||(t=c(t));var h,p=this,m="application/octet-stream"===t.type,_=function(){!function(e,t,n){for(var i=(t=[].concat(t)).length;i--;){var o=e["on"+t[i]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){r(e)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,o)return h=n().createObjectURL(t),void setTimeout((function(){i.href=h,i.download=d,function(e){var t=new MouseEvent("click");e.dispatchEvent(t)}(i),_(),l(h),p.readyState=p.DONE}));!function(){if((a||m&&s)&&e.FileReader){var i=new FileReader;return i.onloadend=function(){var t=a?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,p.readyState=p.DONE,_()},i.readAsDataURL(t),void(p.readyState=p.INIT)}h||(h=n().createObjectURL(t)),m?e.location.href=h:e.open(h,"_blank")||(e.location.href=h),p.readyState=p.DONE,_(),l(h)}()},u=d.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=c(e)),navigator.msSaveOrOpenBlob(e,t)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(e,t,n){return new d(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||void 0)})?i.apply(t,o):i)||(e.exports=s)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0);return n(6).Model.extend({idAttribute:"userProfileSetId",defaults:{userProfileSetId:null,name:null,profileImageUrl:null,isPageDefault:!1,isDefault:null,bands:null},parse:function(e){var n={userProfileSetId:e.user_profile_set_id,name:e.name,profileImageUrl:e.profile_image_url,isDefault:e.is_default,isPageDefault:!!e.is_page_default,bands:t.map(e.bands,(function(e){return{bandNo:e.band_no,name:e.name,cover:e.cover,certified:e.certified,type:e.type,profileImage:e.profile_image}}))};return this._previous=this.getSubmitParams(n),n},addBand:function(e){this.set({bands:t.union(this.get("bands"),[e])})},removeBand:function(e){this.set({bands:t.reject(this.get("bands"),(function(e){return e.bandNo===this.bandNo}),{bandNo:e})})},getSubmitParams:function(e){return{name:(e=e||this.attributes).name||null,profile_image_url:e.profileImageUrl||null,is_default:e.isDefault||!1,band_nos:t.chain(e.bands).pluck("bandNo").sortBy().value()}},hasDifference:function(){return!t.isEqual(this._previous,this.getSubmitParams())}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){!function e(t,n,i){function o(a,r){if(!n[a]){if(!t[a]){if(s)return s(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=n[a]={exports:{}};t[a][0].call(l.exports,(function(e){var n=t[a][1][e];return o(n||e)}),l,l.exports,e,t,n,i)}return n[a].exports}for(var s=!1,a=0;a<i.length;a++)o(i[a]);return o}({2:[function(e,t,n){"use strict";t.exports=function(){this.width=0,this.height=0,this.numPlays=0,this.playTime=0,this.frames=[],this.fixedWidth=null,this.fixedHeight=null,this.play=function(){o||s||(this.rewind(),o=!0,requestAnimationFrame(r))},this.stop=function(){o=!1},this.rewind=function(){t=0,n=0,i=null,o=!1,s=!1},this.addContext=function(e){if(a.length>0){var t=a[0].getImageData(0,0,this.width,this.height);e.putImageData(t,0,0)}a.push(e),e._apng_animation=this},this.removeContext=function(e){var t=a.indexOf(e);-1!==t&&(a.splice(t,1),0===a.length&&this.rewind(),"_apng_animation"in e&&delete e._apng_animation)},this.isPlayed=function(){return o},this.isFinished=function(){return s},this.isFixedSize=function(){return null!=this.fixedWidth&&null!=this.fixedHeight};var e=this,t=0,n=0,i=null,o=!1,s=!1,a=[],r=function(e){for(;o&&t<=e;)l(e);o&&requestAnimationFrame(r)},l=function(r){var l=n++%e.frames.length,c=e.frames[l];if(0==e.numPlays||n/e.frames.length<=e.numPlays){for(0==l&&(a.forEach((function(t){t.clearRect(0,0,e.width,e.height)})),i=null,2==c.disposeOp&&(c.disposeOp=1)),i&&1==i.disposeOp?a.forEach((function(e){e.clearRect(i.left,i.top,i.width,i.height)})):i&&2==i.disposeOp&&a.forEach((function(e){e.putImageData(i.iData,i.left,i.top)})),(i=c).iData=null,2==i.disposeOp&&(i.iData=a[0].getImageData(c.left,c.top,c.width,c.height)),0==c.blendOp&&a.forEach((function(e){e.clearRect(c.left,c.top,c.width,c.height)})),a.forEach((function(e){e.drawImage(c.img,c.left,c.top)})),0==t&&(t=r);r>t+e.playTime;)t+=e.playTime;t+=c.delay}else if(o=!1,s=!0,e.isFixedSize()){var d=e.frames[0];a.forEach((function(t){t.clearRect(0,0,e.width,e.height),t.drawImage(d.img,d.left,d.top)}))}}}},{}],3:[function(e,t,n){"use strict";for(var i=new Uint32Array(256),o=0;o<256;o++){for(var s=o,a=0;a<8;a++)s=1&s?3988292384^s>>>1:s>>>1;i[o]=s}t.exports=function(e,t,n){for(var o=-1,s=t=t||0,a=t+(n=n||e.length-t);s<a;s++)o=o>>>8^i[255&(o^e[s])];return-1^o}},{}],4:[function(e,t,n){(function(t){"use strict";var n=e("./support-test"),i=e("./parser"),o=e("./loader"),s=t.APNG={};s.checkNativeFeatures=n.checkNativeFeatures,s.ifNeeded=n.ifNeeded,s.parseBuffer=function(e){return i(e)};var a={};s.parseURL=function(e){return e in a||(a[e]=o(e)),a[e]},s.animateContext=function(e,t){return s.parseURL(e).then((function(e){return i(e)})).then((function(e){return e.addContext(t),e.play(),e}))},s.animateImage=function(e,t,n,o,a){var r=$(e).data("apng-url");return e.setAttribute("data-is-apng","progress"),s.parseURL(r).then((function(e){return i(e)})).then((function(i){i.fixedWidth=t,i.fixedHeight=o,e.setAttribute("data-is-apng","yes");var s=document.createElement("canvas");if(Array.prototype.slice.call(e.attributes).forEach((function(e){["alt","src","usemap","ismap","data-is-apng","width","height","class"].indexOf(e.nodeName)>-1&&s.setAttributeNode(e.cloneNode(!1))})),s.setAttribute("data-apng-src",r),""!=e.alt&&s.appendChild(document.createTextNode(e.alt)),i.isFixedSize()){var l=t/n,c=o/a;s.style.transform="scale("+l+", "+c+")",s.style.position="relative",s.style.left=-(n-i.fixedWidth)/2+"px",s.style.top=-(a-i.fixedHeight)/2+"px",$(e).closest("._apngParent").css({width:i.fixedWidth,height:i.fixedHeight,overflow:"hidden"}),s.width=n,s.height=a,s.style.width=n,s.style.height=a,s.style.cursor="pointer"}else{var d="",u="",h=0,p="";""!=e.style.width&&"auto"!=e.style.width?d=e.style.width:e.hasAttribute("width")&&(d=e.getAttribute("width")+"px"),""!=e.style.height&&"auto"!=e.style.height?u=e.style.height:e.hasAttribute("height")&&(u=e.getAttribute("height")+"px"),""!=d&&""==u&&(h=parseFloat(d),p=d.match(/\D+$/)[0],u=Math.round(s.height*h/s.width)+p),""!=u&&""==d&&(h=parseFloat(u),p=u.match(/\D+$/)[0],d=Math.round(s.width*h/s.height)+p),s.width=i.width,s.height=i.height,s.style.width=d,s.style.height=u}var m=e.parentNode;return m.insertBefore(s,e),m.removeChild(e),i.addContext(s.getContext("2d")),i.play(),i}),(function(){e.setAttribute("data-is-apng","no")}))},s.releaseCanvas=function(e){var t=e.getContext("2d");"_apng_animation"in t&&t._apng_animation.removeContext(t)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./loader":5,"./parser":6,"./support-test":7}],5:[function(e,t,n){"use strict";t.exports=function(e){return new Promise((function(t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="arraybuffer",i.onload=function(){200==this.status?t(this.response):n(this)},i.send()}))}}],6:[function(e,t,n){"use strict";var i=e("./animation"),o=e("./crc32"),s=new Uint8Array([137,80,78,71,13,10,26,10]);t.exports=function(e){var t=new Uint8Array(e);return new Promise((function(e,n){for(var o=0;o<s.length;o++)if(s[o]!=t[o])return void n("Not a PNG file (invalid file signature)");var u=!1;if(a(t,(function(e){return"acTL"!=e||(u=!0,!1)})),u){var m=[],_=[],g=null,f=null,b=new i;if(a(t,(function(e,t,n,i){switch(e){case"IHDR":g=t.subarray(n+8,n+8+i),b.width=r(t,n+8),b.height=r(t,n+12);break;case"acTL":b.numPlays=r(t,n+8+4);break;case"fcTL":f&&b.frames.push(f),(f={}).width=r(t,n+8+4),f.height=r(t,n+8+8),f.left=r(t,n+8+12),f.top=r(t,n+8+16);var o=l(t,n+8+20),s=l(t,n+8+22);0==s&&(s=100),f.delay=1e3*o/s,f.delay<=10&&(f.delay=100),b.playTime+=f.delay,f.disposeOp=c(t,n+8+24),f.blendOp=c(t,n+8+25),f.dataParts=[];break;case"fdAT":f&&f.dataParts.push(t.subarray(n+8+4,n+8+i));break;case"IDAT":f&&f.dataParts.push(t.subarray(n+8,n+8+i));break;case"IEND":_.push(d(t,n,12+i));break;default:m.push(d(t,n,12+i))}})),f&&b.frames.push(f),0!=b.frames.length)for(var v=0,A=new Blob(m),E=new Blob(_),T=0;T<b.frames.length;T++){f=b.frames[T];var C=[];C.push(s),g.set(h(f.width),0),g.set(h(f.height),4),C.push(p("IHDR",g)),C.push(A);for(var y=0;y<f.dataParts.length;y++)C.push(p("IDAT",f.dataParts[y]));C.push(E);var M=URL.createObjectURL(new Blob(C,{type:"image/png"}));delete f.dataParts,C=null,f.img=document.createElement("img"),f.img.onload=function(){URL.revokeObjectURL(this.src),++v==b.frames.length&&e(b)},f.img.onerror=function(){n("Image creation error")},f.img.src=M}else n("Not an animated PNG")}else n("Not an animated PNG")}))};var a=function(e,t){var n=8;do{var i=r(e,n),o=u(e,n+4,4),s=t(o,e,n,i);n+=12+i}while(!1!==s&&"IEND"!=o&&n<e.length)},r=function(e,t){var n=0;n+=e[0+t]<<24>>>0;for(var i=1;i<4;i++)n+=e[i+t]<<8*(3-i);return n},l=function(e,t){for(var n=0,i=0;i<2;i++)n+=e[i+t]<<8*(1-i);return n},c=function(e,t){return e[t]},d=function(e,t,n){var i=new Uint8Array(n);return i.set(e.subarray(t,t+n)),i},u=function(e,t,n){var i=Array.prototype.slice.call(e.subarray(t,t+n));return String.fromCharCode.apply(String,i)},h=function(e){return[e>>>24&255,e>>>16&255,e>>>8&255,255&e]},p=function(e,t){var n=e.length+t.length,i=new Uint8Array(new ArrayBuffer(n+8));i.set(h(t.length),0),i.set(function(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n));return t}(e),4),i.set(t,8);var s=o(i,4,n);return i.set(h(s),n+4),i}},{"./animation":2,"./crc32":3}],7:[function(e,t,n){(function(e){"use strict";var n,i,o=(n=function(t){var n=document.createElement("canvas"),i={TypedArrays:"ArrayBuffer"in e,BlobURLs:"URL"in e,requestAnimationFrame:"requestAnimationFrame"in e,pageProtocol:"http:"==location.protocol||"https:"==location.protocol,canvas:"getContext"in document.createElement("canvas"),APNG:!1};if(i.canvas){var o=new Image;o.onload=function(){var e=n.getContext("2d");e.drawImage(o,0,0),i.APNG=0===e.getImageData(0,0,1,1).data[3],t(i)},o.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACGFjVEwAAAABAAAAAcMq2TYAAAANSURBVAiZY2BgYPgPAAEEAQB9ssjfAAAAGmZjVEwAAAAAAAAAAQAAAAEAAAAAAAAAAAD6A+gBAbNU+2sAAAARZmRBVAAAAAEImWNgYGBgAAAABQAB6MzFdgAAAABJRU5ErkJggg=="}else t(i)},i=null,function(e){return i||(i=new Promise(n)),e&&i.then(e),i});t.exports={checkNativeFeatures:o,ifNeeded:function(e){return void 0===e&&(e=!1),o().then((function(t){if(t.APNG&&!e)reject();else{var n=!0;for(var i in t)t.hasOwnProperty(i)&&"APNG"!=i&&(n=n&&t[i])}}))}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}]},{},[4])},function(e,t,n){var i,o,s;s=this,i=[n(16)],void 0===(o=function(e){return s.DateRange=function(e){var t={year:!0,month:!0,week:!0,day:!0,hour:!0,minute:!0,second:!0};function n(t,n){var i,o=t,s=n;1!==arguments.length&&void 0!==n||("object"==typeof t&&2===t.length?(o=t[0],s=t[1]):"string"==typeof t&&(o=(i=t.split("/"))[0],s=i[1])),this.start=e(o),this.end=e(s)}function i(t,n,i){for(var o=e(this.start);this.contains(o,i);)n.call(this,o.clone()),o.add(1,t)}function o(t,n,i){var o=this/t,s=Math.floor(o);if(s!==1/0){s===o&&i&&s--;for(var a=0;a<=s;a++)n.call(this,e(this.start.valueOf()+t.valueOf()*a))}}return n.prototype.constructor=n,n.prototype.clone=function(){return e().range(this.start,this.end)},n.prototype.contains=function(e,t){var i=this.start,o=this.end;return e instanceof n?i<=e.start&&(o>e.end||o.isSame(e.end)&&!t):i<=e&&(o>e||o.isSame(e)&&!t)},n.prototype.overlaps=function(e){return null!==this.intersect(e)},n.prototype.intersect=function(e){var t=this.start,i=this.end;return t<=e.start&&e.start<i&&i<e.end?new n(e.start,i):e.start<t&&t<e.end&&e.end<=i?new n(t,e.end):e.start<t&&t<=i&&i<e.end?this:t<=e.start&&e.start<=e.end&&e.end<=i?e:null},n.prototype.add=function(t){return this.overlaps(t)?new n(e.min(this.start,t.start),e.max(this.end,t.end)):null},n.prototype.subtract=function(e){var t=this.start,i=this.end;return null===this.intersect(e)?[this]:e.start<=t&&t<i&&i<=e.end?[]:e.start<=t&&t<e.end&&e.end<i?[new n(e.end,i)]:t<e.start&&e.start<i&&i<=e.end?[new n(t,e.start)]:t<e.start&&e.start<e.end&&e.end<i?[new n(t,e.start),new n(e.end,i)]:void 0},n.prototype.by=function(e,t,n){return"string"==typeof e?i.call(this,e,t,n):o.call(this,e,t,n),this},n.prototype.toString=function(){return this.start.format()+"/"+this.end.format()},n.prototype.valueOf=function(){return this.end-this.start},n.prototype.center=function(){var t=this.start+this.diff()/2;return e(t)},n.prototype.toDate=function(){return[this.start.toDate(),this.end.toDate()]},n.prototype.isSame=function(e){return this.start.isSame(e.start)&&this.end.isSame(e.end)},n.prototype.diff=function(e){return this.end.diff(this.start,e)},e.range=function(i,o){return i in t?new n(e(this).startOf(i),e(this).endOf(i)):new n(i,o)},e.range.constructor=n,e.fn.range=e.range,e.fn.within=function(e){return e.contains(this._d)},n}(e)}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(503),s=n(52),a=n(511),r=n(531),l=t.Model.extend({defaults:{attendeeLimit:null,endedAt:null,isChildMemberAddible:!1,childMemberLimit:null,attendeeList:[],pendingAttendeeList:[],absenteeList:[],maybeList:[],isMaybeEnabled:!1,customStates:null,viewerCustomStateId:null,rsvpVisibleQualification:null,isRsvpVisibleToViewer:!1},parse:function(e){return{viewerRsvpState:(e=s.camelizeKeys(e)).viewerRsvpState,attendeeCount:e.attendeeCount,pendingAttendeeCount:e.pendingAttendeeCount,absenteeCount:e.absenteeCount,maybeCount:e.maybeCount,nonresponseCount:e.nonresponseCount,attendeeLimit:e.attendeeLimit,endedAt:e.endedAt,isChildMemberAddible:e.isChildMemberAddible,childMemberLimit:e.childMemberLimit,viewerPendingNumber:e.viewerPendingNumber,isViewerPendingNumberCountless:e.isViewerPendingNumberCountless,attendeeList:e.attendeeList,pendingAttendeeList:e.pendingAttendeeList,absenteeList:e.absenteeList,maybeList:e.maybeList,isMaybeEnabled:e.isMaybeEnabled,customStates:e.customStates,viewerCustomStateId:e.viewerCustomStateId,rsvpVisibleQualification:e.rsvpVisibleQualification,isRsvpVisibleToViewer:e.isRsvpVisibleToViewer}},toJSONForSave:function(){var e={};if(this.has("attendeeLimit")&&(e.attendee_limit=this.get("attendeeLimit")),this.has("endedAt")&&(e.ended_at=this.get("endedAt")),this.has("isChildMemberAddible")&&(e.is_child_member_addible=this.get("isChildMemberAddible")),this.has("childMemberLimit")&&(e.child_member_limit=this.get("childMemberLimit")),this.has("customStates")){var t=i.map(this.get("customStates"),(function(e){var t={title:e.title};return e.customStateId&&(t.customStateId=e.customStateId),t}));e.custom_states=s.decamelizeKeys(t)}return e.rsvp_visible_qualification=this.get("rsvpVisibleQualification"),e.is_maybe_enabled=this.get("isMaybeEnabled"),e},getMyRsvpChildMemberList:function(e){var t=e.bandNo,n=e.scheduleId;return o.getScheduleRsvpMyChildMembers(t,n).then((function(e){return e.child_members}))},isRsvpVisibleQualificationOnlyManager:function(){return this.get("rsvpVisibleQualification")==r.RSVP_VISIBLE_QUALIFICATION.ONLY_MANAGER},setRsvpVisibleQualification:function(e){this.set("rsvpVisibleQualification",e)},isRsvpVisibleToViewer:function(){return this.get("isRsvpVisibleToViewer")},getEndedAt:function(){return this.get("endedAt")},getAttendeeLimit:function(){return this.get("attendeeLimit")},isAttendeeLimitExist:function(){return null!=this.getAttendeeLimit()},isAttendeeExist:function(){return this.get("attendeeCount")>0},isPendingAttendeeExist:function(){return this.get("pendingAttendeeCount")>0},isAbsenteeExist:function(){return this.get("absenteeCount")>0},isMaybeExist:function(){return this.get("maybeCount")>0},isNonresponseExist:function(){return this.get("nonresponseCount")>0},isChildMemberAddible:function(){return 1==this.get("isChildMemberAddible")},isViewerAttendanceState:function(){return this.get("viewerRsvpState")==a.ATTENDANCE},isMaybeEnabled:function(){return!!this.get("isMaybeEnabled")},isAttendanceExcess:function(){return!!this.isAttendeeLimitExist()&&this.getAttendeeCount()>=this.getAttendeeLimit()},getPendingAttendeeList:function(){return this.get("pendingAttendeeList")},getMemberSelectableRsvpStatus:function(){var e=[];this.isAttendanceExcess()?e.push(a.PENDING_ATTENDANCE):e.push(a.ATTENDANCE),e.push(a.ABSENCE),this.isMaybeEnabled()&&e.push(a.MAYBE);var t=a.getRsvpStatusInfoList(e),n=this.getCustomRsvpStatusList();return n&&i.each(n,(function(e){t.push({itemName:e.rsvpState,text:e.title,customStateId:e.customStateId})})),t},getRsvpStatusListForAttendeeViewTab:function(){var e=[a.ATTENDANCE,a.PENDING_ATTENDANCE,a.ABSENCE,a.MAYBE];return this.isMaybeEnabled()||(e=i.filter(e,(function(e){return e!=a.MAYBE}))),this.isAttendanceExcess()||(e=i.filter(e,(function(e){return e!=a.PENDING_ATTENDANCE}))),this.hasCustomRsvpStatus()&&e.push(a.CUSTOM),e},getRsvpStatusListForNotifySort:function(){var e=[a.NONRESPONSE,a.ATTENDANCE,a.PENDING_ATTENDANCE,a.ABSENCE,a.MAYBE];this.isMaybeEnabled()||(e=i.filter(e,(function(e){return e!=a.MAYBE})));var t=a.getRsvpStatusInfoList(e),n=this.getCustomRsvpStatusList();return n&&i.each(n,(function(e){t.push({itemName:e.rsvpState,text:e.title,customStateId:e.customStateId})})),t},getCustomRsvpStatusList:function(){return this.get("customStates")?this.get("customStates"):null},getViewerCustomStateId:function(){return this.get("viewerCustomStateId")},hasCustomRsvpStatus:function(){return!i.isEmpty(this.get("customStates"))},getRsvpCustomTotalCount:function(){if(!this.hasCustomRsvpStatus())return 0;var e=0,t=this.getCustomRsvpStatusList();return i.each(t,(function(t){t.count&&(e+=t.count)})),e},getCustomStateTitle:function(e){var t,n=this.getCustomRsvpStatusList();if(n)return i.each(n,(function(n){n.customStateId==e&&(t=n.title)})),t},getViewerRsvpState:function(){return this.get("viewerRsvpState")},getAttendeeCount:function(){return this.get("attendeeCount")},getPendingAttendeeCount:function(){return this.get("pendingAttendeeCount")},getAbsenteeCount:function(){return this.get("absenteeCount")},getMaybeCount:function(){return this.get("maybeCount")},getNonResponseCount:function(){return this.get("nonresponseCount")},getCustomStateItem:function(e){var t=i.find(this.getCustomRsvpStatusList(),(function(t){return t.customStateId==e}));return t?(null==t.count&&(t.count=0),t):null},getRsvpCountInfo:function(){return{attendeeCount:this.getAttendeeCount(),absenteeCount:this.getAbsenteeCount(),maybeCount:this.getMaybeCount(),nonResponseCount:this.getNonResponseCount(),customStateTotalCount:this.getRsvpCustomTotalCount(),pendingAttendeeCount:this.getPendingAttendeeCount()}},refreshRsvpData:function(e){this.set(e,{parse:!0})}});return l.isSameRsvpInput=function(e,t,n){if(!e&&!t)return!0;if(!e||!t)return!1;if(e.get("attendeeLimit")!==t.get("attendeeLimit"))return!1;if(e.get("endedAt")!==t.get("endedAt"))return!1;if(e.get("isChildMemberAddible")!==t.get("isChildMemberAddible"))return!1;if(e.get("childMemberLimit")!==t.get("childMemberLimit"))return!1;if(e.get("isMaybeEnabled")!==t.get("isMaybeEnabled"))return!1;if(e.get("rsvpVisibleQualification")!==t.get("rsvpVisibleQualification"))return!1;var o=e.get("customStates"),s=t.get("customStates");if(n){if((i.isEmpty(o)?null:o)!==(i.isEmpty(s)?null:s))return!1}else if(o!==s)return!1;return!0},l.createScheduleRsvpModel=function(e){return new l({attendeeLimit:e.attendeeLimit,endedAt:e.endedAt,isChildMemberAddible:e.isChildMemberAddible,childMemberLimit:e.childMemberLimit,isMaybeEnabled:e.isMaybeEnabled,customStates:e.customStates,rsvpVisibleQualification:e.rsvpVisibleQualification})},l.createDefaultScheduleRsvpModel=function(){return l.createScheduleRsvpModel({rsvpVisibleQualification:r.RSVP_VISIBLE_QUALIFICATION.ALL,isMaybeEnabled:!0})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(1328),a=n(486),r=n(154),l=n(1249),c=n(155),d=n(1330),u=n(498),h=n(499),p=n(488),m=n(13),_=n(84),g=n(26),f=n(513),b=n(156),v=n(1398),A=n(82),E=n(577),T=n(888),C=n(516),y=n(1051),M=n(697),I=n(53),S=n(153),w=n(162),N=n(495),D=n(487),L=n(833),O=n(529),P=n(555),x=n(1152),R=n(1126),k=n(889),B=n(1127);n(445),n(936);var V=565,U=459,F=640,H=644,z=180,W=565,G=459,K=200,Y=80,j=42,Q=0,q={PHOTO_LIST:{id:"PHOTO_LIST",title:IM("media_viewer.menu.download_photo_list")},THIS_PHOTO:{id:"THIS_PHOTO",title:IM("media_viewer.menu.download_this_photo")}};function J(e){return t.find([S.GROUP_BAND_MEDIA_DETAIL,S.GROUP_BAND_MEDIA_DETAIL_COMMENT,S.GROUP_BAND_MEDIA_DETAIL_COMMENT_REPLY,w.PAGE_BAND_MEDIA_DETAIL,w.PAGE_BAND_MEDIA_DETAIL_COMMENT,w.PAGE_BAND_MEDIA_DETAIL_COMMENT_REPLY],(function(t){return t.isMatched(e)}))}var X=o.View.extend({behaviors:function(){var e=[{behaviorClass:N,sceneId:N.SCENE.PHOTO_DETAIL_VIEW},D];return e.push({behaviorClass:L,moreOptionListRegionName:"moreOptionListRegion",moreOptionList:this.options.moreOptionList,channelId:this.options.channelId}),e},attributes:function(){return{"data-viewname":"DImageViewerLayoutView","data-imageViewer":"imageViewer","data-cid":this.cid}},ui:{imageSectionArea:"._imageSectionArea",directCloseButton:"._directCloseButton",emotionCommentRegion:"._emotionCommentRegion",fullScreenButton:"._fullScreenButton",viewerFooterArea:"._viewerFooterArea",expiresText:"._expiresText",mediaWrap:"._mediaWrap",videoWrap:"._videoWrap",videoElement:"[data-uiselector=videoElement]",imageWrap:"._imageWrap",downloadButton:"._downloadButton",downloadMenu:"._downloadMenu",btnCopyImage:"._btnCopyImage",goAlbumButton:"._goAlbumButton",goPostButton:"._goPostButton",moreButton:"._moreButton",moreOptionListRegion:"._moreOptionListRegion",previousImageButton:"._previousImageButton",nextImageButton:"._nextImageButton",footerInfoBox:"._footerInfoBox",footerInfoComment:"._footerInfoComment",emotionCountViewRegion:"._emotionCountViewRegion",sliderWrapper:"._sliderWrapper",sliderRange:"._sliderRange",sliderHandle:"._sliderHandle",sliderZoomIn:"._sliderZoomIn",sliderZoomOut:"._sliderZoomOut",originSizeButton:"._originSizeButton",fitSizeButton:"._fitSizeButton"},regions:{moreOptionListRegion:"@ui.moreOptionListRegion",emotionCommentRegion:"@ui.emotionCommentRegion",emotionCountViewRegion:{el:"@ui.emotionCountViewRegion",replaceElement:!0},downloadMenu:"@ui.downloadMenu",videoWrap:"@ui.videoWrap"},childViewEvents:function(){var e={"emotionCommentView:fetchedPhotoInfo":function(e,t,n){if(t==this.model.getImageIndex()){var i=n.photo&&n.photo.comment_count?n.photo.comment_count:0;this.getUI("footerInfoComment").find("em").text(i),this.model.setCommentCount(i),this.model.setSavableState(n.photo.savable_state),this._toggleDownloadButton(),e.drawView(n,this._initCommentId,this._initCommentReplyId),this._initCommentId=null,this._initCommentReplyId=null}},"emotionCommentView:resetEmotionCount":function(e){this.model.set(e),this._renderEmotionCount()},"emotionCommentView:resetCommentCount":function(e,t){this.ui.footerInfoComment.find("em").text(t),this.model.set("comment_count",t)},"DEmotionCountView:clickView":"_toggleEmotionCommentView"};return e[y.EVENTS.VIDEO_PLAYER_PLAY]=function(e,t){this.model.setPlaying(!0),this.jplOccur(D.CLASSIFIER.VIDEO_PLAY_START,{band_no:this.model.getBandNo(),photo_no:this.model.getPhotoNo(),is_auto:!1,type:"uploaded",video_url:this.model.getVideoUrl(),total_duration_ms:1e3*t.duration,start_position_ms:1e3*t.currentTime})},e[y.EVENTS.VIDEO_PLAYER_PAUSE]=function(e,t){this.model.setPlaying(!1),this.jplOccur(D.CLASSIFIER.VIDEO_PLAY_STOP,{band_no:this.model.getBandNo(),photo_no:this.model.getPhotoNo(),is_auto:!1,type:"uploaded",video_url:this.model.getVideoUrl(),total_duration_ms:1e3*t.duration,stop_position_ms:1e3*t.currentTime})},e[y.EVENTS.VIDEO_PLAYER_ENTERED_FULL_SCREEN]="_updateUIVisibility",e[y.EVENTS.VIDEO_PLAYER_EXITED_FULL_SCREEN]="_updateUIVisibility",e[y.EVENTS.VIDEO_PLAYER_VOLUME_CHANGED]=function(e){this._muted=e.muted,this._volume=e.volume},e},events:{"click @ui.mediaWrap":function(e){var t=this.ui.mediaWrap.innerWidth()/2;return e.clientX<t?this._goToPreviousImage():this._goToNextImage(),!1},"click @ui.directCloseButton":function(){return E.isFullScreenMode()?E.closeFullScreen():this._destroy(),!1},"click @ui.fullScreenButton":function(){return E.openFullScreen(),!1},"click @ui.footerInfoComment":"_toggleEmotionCommentView","click @ui.downloadButton":"_handleDownloadBtnClick","click @ui.goPostButton":function(){return E.closeFullScreen(),this._hideMoreOptionList(),this.trigger(X.EVENT.SHOW_POST,this.model.getPostNo()),!1},"click @ui.goAlbumButton":function(){return E.closeFullScreen(),this._hideMoreOptionList(),this.destroy(),this.trigger(X.EVENT.GO_ALBUM,this.model.getAlbumNo()),!1},"click @ui.previousImageButton":"_goToPreviousImage","click @ui.nextImageButton":"_goToNextImage","click @ui.moreButton":function(){this.getRegion("moreOptionListRegion").hasView()||t.defer(t.bind(this._showMoreOptionList,this))},"click @ui.originSizeButton":function(){this._zoomableImage&&!this.ui.originSizeButton.hasClass("-disabled")&&this._zoomableImage.zoom(100)},"click @ui.sliderZoomIn":function(){if(this._zoomableImage){var e=this._zoomableImage.zoomValue+(this._zoomableImage.maxZoom-100)/5;this._zoomableImage.zoom(e)}},"click @ui.sliderZoomOut":function(){if(this._zoomableImage){var e=this._zoomableImage.zoomValue-(this._zoomableImage.maxZoom-100)/5;this._zoomableImage.zoom(e)}},"click @ui.fitSizeButton":function(){this._zoomableImage&&this._zoomableImage.zoom(this._zoomableImage.minZoom)},"click @ui.videoWrap":function(){return this.model.isEncodingProgress()&&(alert(IM("web.imageviewer.alert.txt.encoding_progress_video")),this.render()),!1},click:function(){g.getDGlobalChannel().trigger(g.EVENT.HTML_CLICK)},"click @ui.btnCopyImage":"_clipboardImageCopy"},initialize:function(e){this.collection=e.collection,this.model=this.collection.at(e.openIndex||0),this._bandNo=e.bandNo,this._bandData=null,this._fetchNextPhotosOnShow=e.fetchNextPhotosOnShow,this._initCommentId=e.initCommentId,this._initCommentReplyId=e.initCommentReplyId,this._isPreviewBand=!1,this._isGuideBand=!1,this._popupOpen=1==e.popupOpen,this._hidePageIndex=1==e.hidePageIndex,this._expandSupport=0!=e.expandSupport,this._isAnyoneMediaDownloadable=1==e.isAnyoneMediaDownloadable,this._moreOptionList=e.moreOptionList,this._schedulePhotoReportBaseOptions=e.schedulePhotoReportBaseOptions||null,this._goPostSupport=e.goPostSupport,this._goAlbumSupport=e.goAlbumSupport||!1,this._finalIndex=Number.MAX_VALUE,this._channelId=e.channelId,this._isUserOpenAside=!0,this._autoPlayOnOpening=e.autoPlayOnOpening||void 0,this._muted=!1,this._volume=null,this._disableCommentInput=!0===e.disableCommentInput,this.listenTo(g.getDGlobalChannel(),g.EVENT.SCHEDULE_DELETED,t.bind((function(){this._destroy(!0)}),this)),this._bindVideoUrlFetchEvent()},_canWriteComment:function(){return!(this._disableCommentInput||!this._bandData)&&this._bandData.canWriteComment()},_clipboardImageCopy:function(){var e=this.getUI("btnCopyImage"),t=this.getUI("viewerFooterArea"),n=this.getUI("mediaWrap").children("img"),o=i("<p>"+IM("media_viewer.clipboard_image_copy.ing_tooltip")+"</p>"),s={width:n.prop("naturalWidth"),height:n.prop("naturalHeight"),useCORS:!0,logging:!1,scrollX:0,scrollY:0,scale:1,onclone:function(e){i(e.body).find("._clipboardCopyImage").css({width:s.width,height:s.height})}};o.css({position:"absolute",display:"block",left:"50%",top:0,marginTop:"-47px",padding:"11px 24px",borderRadius:"20px",background:"rgba(68, 68, 68, .55)",opacity:1,whiteSpace:"nowrap",color:"rgba(255,255,255, .5)",fontSize:"13px",lineHeight:1,transform:"translateX(-50%)"}),e.prop("disabled",!0),n.addClass("_clipboardCopyImage"),t.append(o),setTimeout((function(){R(n.get(0),s).then((function(t){t.toBlob((function(t){navigator.clipboard.write([new ClipboardItem({"image/png":t})]),n.removeClass("_clipboardCopyImage"),o.text(IM("media_viewer.clipboard_image_copy.success_tooltip")).delay(2e3).animate({opacity:0},500,(function(){o.remove(),e.prop("disabled",!1)}))}),"image/png",1)}))}),0)},_initMoreOptionButton:function(){t.isEmpty(this._moreOptionList)||(this.on(L.TRIGGERING_EVENTS.PHOTO_INFO_UPDATED,(function(e){t.isEmpty(e)||!this._canShowFunctionButtonForPhotoViewer?this.getUI("moreButton").hide():this.getUI("moreButton").show()})),this.on(L.TRIGGERING_EVENTS.MENU_CLICKED,(function(e){e!=L.MEDIA_MORE_OPTION.DELETE&&e!=L.MEDIA_MORE_OPTION.REPORT||E.closeFullScreen()})),this._videoDownloadUrl=null,this._resetMoreOptionBehavior())},_resetMoreOptionBehavior:function(){if(!t.isEmpty(this._moreOptionList)||this._isCurrentMediaDownloadable()){this._mediaAuthor=O.buildContentAuthorModel(this.model.getAuthor());var e=this.model,n={bandNo:e.getBandNo(),photoNo:e.getPhotoNo(),mediaAuthor:this._mediaAuthor,photoUrl:e.getPhotoUrl(),width:e.getWidth(),height:e.getHeight(),isRestrictedMedia:e.isRestricted(),isVideoExist:e.isVideoExist(),sosId:e.getSosId(),videoId:e.getVideoId(),isGifVideo:e.isGifVideo(),messageId:e.getMessageId(),downloadFileName:e.getDownloadFileName(),isGiphy:e.isGiphy(),videoDownloadUrl:t.bind(e.requestVideoUrl,e),isVideoExpired:e.isVideoExpired(),videoExpiresAt:e.getVideoExpiresAt(),videoFileSize:e.getVideoFileSize(),isLive:e.isLive(),liveId:e.getLiveId(),isSourceAtPhoto:"photo"===e.get("source"),getSavableState:function(){return e.getSavableState()},setSavableState:function(t){e.setSavableState(t)}};this._schedulePhotoReportBaseOptions&&(n.schedulePhotoReportOptions=t.extend({photoUrl:this.model.getPhotoUrl()},this._schedulePhotoReportBaseOptions)),this.trigger(L.LISTENING_EVENTS.RESET_PHOTO_INFO,n)}},_showMoreOptionList:function(){this.ui.moreButton.addClass("-active"),this.ui.moreOptionListRegion.css("display",""),this.trigger(L.LISTENING_EVENTS.OPTION_LIST_OPEN)},_hideMoreOptionList:function(){this.ui.moreButton.removeClass("-active"),this.trigger(L.LISTENING_EVENTS.OPTION_LIST_CLOSE),this.ui.moreOptionListRegion.css("display","none")},onBeforeRender:function(){this._bandData&&(this._isAnyoneMediaDownloadable?this.model.setDownloadable(!0):this.model.setDownloadable(this._bandData.canSaveBandMedia(this._isUserAuthor(),this.model.getSavableState())))},getTemplate:function(){return this._bandData?t.template(s):t.template(u)},serializeData:function(){if(this._bandData){var e=this.model.get("source"),t="post"===e||!(!this._goPostSupport||!this.model.isPostMedia()),n="photo"===e||!t&&!!this._goAlbumSupport,o=this.collection.getTotalCount(),s=this._hidePageIndex||this.model.isHidePageNumber(),a=this.model.getPageNumber()||this.model.getImageIndex()+1,r=this.model.getPageCount()||o;return i.extend(this.model.toJSON(),{msg_popupOpen:this._popupOpen,msg_useEmotionOrComment:this._isShowAsideEmotionOrCommentArea()&&this._canShowFunctionButtonForPhotoViewer,showPrevNextButtons:this.collection.getTotalCount()>1,hidePageIndex:s,totalCount:o,expandSupport:this._canExpandSupport(),canGoPost:t&&this._canShowFunctionButtonForPhotoViewer,canGoAlbum:n&&this._canShowFunctionButtonForPhotoViewer,isPreviewBand:this._isPreviewBand,isGuideBand:this._isGuideBand,finalIndex:this._finalIndex,msg_posterUrl:A.make(this.model.getPhotoUrl(),A.TYPE.original),isMediaDownloadPermitted:this._isCurrentMediaDownloadable(),isVideoExpiredClass:this.model.isVideoExpired()?"-disabled":"",isLive:this.model.isLive(),isVideoExpired:this.model.isVideoExpired(),canClipboardImageCopy:this._canClipboardImageCopy(),expiresAt:b.makeRemainExpiresForStorageQuotaMessage(this.model.getVideoExpiresAt()),pageNumber:a,pageCount:r})}return{_loading_size:h.Size.MEDIUM,middleClass:p.ELEMENT.AREA_VERTICAL_MIDDLE}},_canClipboardImageCopy:function(){return this._isCurrentMediaDownloadable()&&(!this.model.isVideoExist()||this.model.isVideoExpired())&&!t.isUndefined(navigator.clipboard)&&t.isFunction(navigator.clipboard.write)},_canExpandSupport:function(){return!this.model.isVideoExist()&&(!(!this._expandSupport||this._isPreviewBand)||!(!this._isGuideBand||!this._canShowFunctionButtonForPhotoViewer))},_updateUIVisibility:function(){var e=this._isShowAsideEmotionOrCommentArea()&&this._bandData.canShowMediaViewerAside();this._isUserOpenAside&&e&&!this.model.isRestricted()?(this.ui.imageSectionArea.addClass("-asideOn"),this.getUI("emotionCommentRegion").show()):(this.ui.imageSectionArea.removeClass("-asideOn"),this.getUI("emotionCommentRegion").hide()),this.model.isVideoExist()||!E.isEnableFullScreen()||E.isFullScreenMode()?this.getUI("fullScreenButton").hide():this.getUI("fullScreenButton").show(),this.model.isVideoExist()&&E.isFullScreenMode()?(this.ui.directCloseButton.hide(),this.ui.viewerFooterArea.hide()):(this.ui.directCloseButton.show(),this.ui.viewerFooterArea.show()),this._zoomableImageRefresh(),this.ui.footerInfoBox.toggle(E.isFullScreenMode()&&e)},onRender:function(){this._bandData&&this.isAttached()&&(this._videoPlayerView=null,this.$el.addClass(this._bandData.getBandCore().getSkinColorClass()),this._updateUIVisibility(),this._renderVideo(),this._renderPhoto(),this._isShowAsideEmotionOrCommentArea()&&this._bandData.canShowMediaViewerAside()&&(this._emotionCommentView=d.buildDEmotionCommentView({bandData:this._bandData,isCommentingPermitted:this._canWriteComment(),disableEmotionComment:this.model.isLive()}),this.showChildView("emotionCommentRegion",this._emotionCommentView),this._emotionCommentView.fetchDataAndShowLoadingView({bandNo:this.model.getBandNo(),photoNo:this.model.getPhotoNo(),imageIndex:this.model.getImageIndex()})))},onAttach:function(){this.listenTo(g.getDGlobalChannel(),g.EVENT.HTML_CLICK,this._handleHtmlClick),this._bandData=c.get(this._bandNo),this._bandData.loadBandData().then(t.bind((function(){this._isPreviewBand=this._bandData.isPreview(),this._isGuideBand=this._bandData.isGuide(),this._canShowFunctionButtonForPhotoViewer=this._bandData.canShowFunctionButtonForPhotoViewer(),this.jplSceneEnter(D.CLASSIFIER.PHOTO_DETAIL_VIEW),this._initMoreOptionButton(),this._bandData.touchContentAccess(),this.render(),this._bindTriggerEvent(),this._fetchNextPhotosOnShow&&r.wrapDeferPromise(this).then(t.bind(this._fetchNextPhotos,this))}),this))},onBeforeDetach:function(e){this.listenTo(g.getDGlobalChannel()),this._zoomableImage&&this._zoomableImage.destroy(),this.ui.sliderWrapper&&this.ui.sliderWrapper.off(),this.ui.mediaWrap&&this.ui.mediaWrap.off(),"clickedNextPrevButton"!==e&&E.isFullScreenMode()&&E.closeFullScreen()},setFinalIndex:function(e){this._finalIndex=e},setVideoUrlFromAPI:function(e,n){if(!this.isDestroyed()&&!t.isEmpty(e)&&null!=n){var i=this.collection.get(n);null!=i&&i.resolveVideoFetchPromise(e)}},layerOnEscKeyDown:function(){this._popupOpen||a.isTopLayerView(this)&&this._canExecuteKeyboardNavigation().then(t.bind(this._destroy,this)).fail(t.bind((function(){this._isPlayingExceptGifVideo()&&this.getChildView("videoWrap").pause()}),this))},_bindTriggerEvent:function(){this.listenTo(this.collection,"add",(function(){this._fetchProgress=!1})),this.listenTo(g.getDGlobalChannel(),g.EVENT.DOCUMENT_LEFT_KEY_UP,t.bind((function(){if(a.isTopLayerView(this)){if(this.model.isPlaying()||this.model.isGifVideo())return void this._videoPlayerView.seekBackwardOrBeginning(0==this.model.getImageIndex()).then(t.bind((function(e){e&&this._canExecuteKeyboardNavigation().then(t.bind(this._goToPreviousImage,this))}),this));this._canExecuteKeyboardNavigation().then(t.bind(this._goToPreviousImage,this))}}),this)),this.listenTo(g.getDGlobalChannel(),g.EVENT.DOCUMENT_RIGHT_KEY_UP,t.bind((function(){if(a.isTopLayerView(this)){if(this.model.isPlaying()||this.model.isGifVideo())return void this._videoPlayerView.seekForwardOrEnd().then(t.bind((function(e){e&&this._canExecuteKeyboardNavigation().then(t.bind(this._goToNextImage,this))}),this));this._canExecuteKeyboardNavigation().then(t.bind(this._goToNextImage,this))}}),this))},layerOnWindowResize:function(){this._zoomableImageRefresh(),this.isDestroyed()||!this.model.isVideoExist()||this.model.isVideoExpired()||E.isFullScreenMode()||this._resizeVideoPlayerVIew()},layerOnWindowFullScreen:function(){this._isUserOpenAside=!E.isFullScreenMode(),this._updateUIVisibility(),this._resizeVideoPlayerVIew()},_resizeVideoPlayerVIew:function(){if(this._videoPlayerView&&!this._videoPlayerView.isDestroyed()&&!E.isFullScreenMode()){var e=this._calculateVideoElementSize();this._videoPlayerView.setPlayerSize({width:e.width,height:e.height})}},_zoomableImageRefresh:function(){this._zoomableImage&&(this._zoomableImage.refresh(),this.ui.sliderWrapper.is(":visible")&&(this.sliderWidth=this.ui.sliderWrapper.width(),this.sliderOffsetLeft=this.ui.sliderWrapper.offset().left))},_isShowAsideEmotionOrCommentArea:function(){return!this._isPreviewBand&&!this._isGuideBand&&this.model.isShowEmotionOrComment()},_canExecuteKeyboardNavigation:function(){var e=i.Deferred();return!this._bandData||this._isPlayingExceptGifVideo()||this.model.isVideoExist()&&E.isFullScreenMode()||this._isCommentTyping()?e.reject():e.resolve()},_isPlayingExceptGifVideo:function(){return!this.model.isGifVideo()&&this.model.isPlaying()},_isCommentTyping:function(){return!!this._isShowAsideEmotionOrCommentArea()&&(!!this._emotionCommentView.isMessageInputFocused()||(!!this._emotionCommentView.isModificationMode()||this._emotionCommentView.hasFocusingInput()))},_goToPreviousImage:function(){if(0!=this.model.getImageIndex()&&this._confirmComments())return this.model=this.collection.at(this.model.get("imageIndex")-1),this._bindVideoUrlFetchEvent(),this.onBeforeDetach("clickedNextPrevButton"),this._videoDownloadUrl=null,this._resetMoreOptionBehavior(),this.render(),!1},_goToNextImage:function(){if(this.model.getImageIndex()!=this.collection.last().getImageIndex()&&this._confirmComments())return this.model=this.collection.at(this.model.get("imageIndex")+1),this._bindVideoUrlFetchEvent(),this.onBeforeDetach("clickedNextPrevButton"),this._videoDownloadUrl=null,this._resetMoreOptionBehavior(),this.render(),this._fetchNextPhotos(),!1},_isUserAuthor:function(){var e=this.model.getAuthorNo();return t.isEmpty(e)&&this.options.owner&&(e=this.options.owner.get("userNo")),null!=e&&e==m.getUserData().getUserNo()},_fetchNextPhotos:function(){this.collection.isAllFetched()||this._fetchProgress||this.model.getImageIndex()<this.collection.length-10||(this._fetchProgress=!0,this.trigger(X.EVENT.FETCH_NEXT_PHOTOS,this.collection.last().getPhotoNo(),this.collection.last().getImageIndex()))},_calculateVideoElementSize:function(){var e=this._popupOpen?j:Y,t=this._popupOpen?Q:K,n=Math.min(this.ui.mediaWrap.width()-t,this.ui.mediaWrap.width()),i=Math.min(this.ui.mediaWrap.height()-e,this.ui.mediaWrap.height());this._popupOpen&&(n=Math.min(n,F),i=Math.min(i,H)),n=Math.max(n,V),i=Math.max(i,U);var o=this.model.getWidth()||W,s=this.model.getHeight()||G,a=Math.max(Math.min(n*s/o,i),z),r=o<s?Math.max(a,V):n;return{width:r>n?n:r,height:a}},_renderVideo:function(){this.model.isVideoExist()&&!this.model.isVideoExpired()&&(E.isFullScreenMode()&&E.closeFullScreen(),this.model.isGifVideo()?this._videoPlayerView=this._buildGifVideoPlayerView():this._videoPlayerView=this._buildMediaVideoPlayerView(),this.showChildView("videoWrap",this._videoPlayerView),this._autoPlayOnOpening=void 0,this.getUI("expiresText").hide(),this.listenTo(this._videoPlayerView,"showPlayerControls",(function(e){e?this.getUI("expiresText").show():this.getUI("expiresText").hide()})))},_buildGifVideoPlayerView:function(){var e=this._calculateVideoElementSize();return y.buildGifVideoPlayer({model:this._createVideoPlayerModel(),poster:A.make(this.model.getPhotoUrl(),A.TYPE.original),videoWidth:e.width,videoHeight:e.height,disabledKeys:[P.LEFT,P.RIGHT],seekInterval:10})},_buildMediaVideoPlayerView:function(){var e=this._calculateVideoElementSize();return y.buildMediaPlayer({model:this._createVideoPlayerModel(),poster:A.make(this.model.getPhotoUrl(),A.TYPE.original),videoWidth:e.width,videoHeight:e.height,enableKeyboard:!0,disabledKeys:[P.LEFT,P.RIGHT],seekInterval:10,muted:this._muted,startVolume:this._volume,autoplay:this._autoPlayOnOpening,isLive:this.model.isLive()})},_createVideoPlayerModel:function(){var e=this._bandNo,t=this.model,n=t.getPhotoNo(),i=t.getVideoId(),o=M.createVideoPlayerModel({videoId:i,expiresAt:t.getVideoExpiresAt(),sources:function(){return t.requestVideoUrl()}});return n&&!t.isGifVideo()&&o.enablePhotoVideoViewingProgressLogging(e,n,i),o},_bindVideoUrlFetchEvent:function(){this.stopListening(this.model,"model_fetchVideoUrl"),this.listenTo(this.model,"model_fetchVideoUrl",(function(e,t,n,i){this.trigger(X.EVENT.FETCH_VIDEO_URL,e,t,n,i)}))},_getPhotoThumbnailType:function(){var e=b.getFileExtension(this.model.getPhotoUrl()).toUpperCase();return"JPG"==e||"JPEG"==e?this._bandData.canUseOfficeBandThumbnailType()?A.TYPE.e1920_office:A.TYPE.e1920_std:A.TYPE.original},_renderPhoto:function(){if(!this.model.isVideoExist()||this.model.isVideoExpired()){if(!this._popupOpen){this.ui.mediaWrap.css({padding:"40px 100px"})}var e=this,n=this._canExpandSupport(),o=this._canClipboardImageCopy(),s=A.make(this.model.getPhotoUrl(),this._getPhotoThumbnailType(),null,o),a=this._zoomableImage=new v({wrapEl:this.ui.mediaWrap,imageSrc:s,imageWidth:this.model.getWidth()<=10||!this.model.getWidth()?640:this.model.getWidth(),imageHeight:this.model.getHeight()<=10||!this.model.getHeight()?480:this.model.getHeight(),maxZoom:200,useZoom:n,useCORS:o,onZoom:function(t){if(n&&!e.isDestroyed()){var i=e.sliderWidth*(t-a.minZoom)/(a.maxZoom-a.minZoom),o=r.width()-l.width(),s=Math.max(0,Math.min(i-l.width()/2,o));c.css("width",s),l.css("left",s);var d=a.wrapElSize.width<a.$imageEl.width()||a.wrapElSize.height<a.$imageEl.height();a.minZoom<t&&d?(e.ui.originSizeButton.hide(),e.ui.fitSizeButton.show()):(e.ui.originSizeButton.show(),e.ui.fitSizeButton.hide())}}});if(a.$imageEl.on(a.EVENT.IMG_CORS_ERROR,t.bind((function(){o&&this.getUI("btnCopyImage").remove()}),this)),n){var r=this.ui.sliderWrapper,l=this.ui.sliderHandle,c=this.ui.sliderRange;this.sliderWidth=r.width(),this.sliderOffsetLeft=r.offset().left;var d=i(document),u=this.sliderWidth-l.width();c.css("width",0),l.css("left",0);var h=function(t){var n=t.clientX-e.sliderOffsetLeft||(t.touches?t.touches[0].clientX-e.sliderOffsetLeft:0),i=Math.max(0,Math.min(u,n)),o=i;o>e.sliderWidth/2&&(o+=l.width());var s=a.minZoom+(a.maxZoom-a.minZoom)*o/e.sliderWidth;c.css("width",i),l.css("left",i),a.zoom(s,!0)};r.on("touchstart mousedown",(function(e){var t=e.originalEvent;if(!(t.touches&&t.touches[0]&&t.touches[1])){e.preventDefault();var n="touchstart"==e.type?"touchmove":"mousemove",i="touchstart"==e.type?"touchend":"mouseup",o=function(e){e.preventDefault(),h(e.originalEvent)},s=function(e){h(e.originalEvent),d.off(n,o),d.off(i,s)};d.on(n,o),d.on(i,s)}})),this.model.getWidth()<=this._zoomableImage.initWidth||this.model.getHeight()<=this._zoomableImage.initHeight?this.ui.originSizeButton.addClass("-disabled"):this.ui.originSizeButton.removeClass("-disabled")}}},_toggleEmotionCommentView:function(){return this._isUserOpenAside=!this._isUserOpenAside,this._updateUIVisibility(),!1},_renderEmotionCount:function(){var e=this.getRegion("emotionCountViewRegion"),t=this.model.get("emotionCount");null!=e&&(t>0?e.show(T.buildImageViewerEmotionCountView(this.model.get("commonEmotionType"),this.model.get("emotionCount"),this.model.get("emotionTypeByViewer"),!0)):e.empty())},_isOpenedByUrl:function(){var e=I.get("currentRouteInfo").routeInfo;return t.some([S.GROUP_BAND_MEDIA_DETAIL,S.GROUP_BAND_MEDIA_DETAIL_COMMENT,S.GROUP_BAND_MEDIA_DETAIL_COMMENT_REPLY,w.PAGE_BAND_MEDIA_DETAIL,w.PAGE_BAND_MEDIA_DETAIL_COMMENT,w.PAGE_BAND_MEDIA_DETAIL_COMMENT_REPLY],(function(t){return t===e}))},_historyBackOrGoHome:function(){if(I.hasExRouteInfo())history.back();else{var e=this._bandData.getBandCore().makeBandRouteUrl(S.GROUP_BAND_HOME,w.PAGE_BAND_HOME,{band_no:this._bandData.getBandNo()});_.go(e,{replace:!0})}},_destroy:function(e){return!(!e&&!this._confirmComments())&&(this._isOpenedByUrl()?(this._historyBackOrGoHome(),!1):(this.destroy(),!1))},_confirmComments:function(){return!this._emotionCommentView||(!this._emotionCommentView.isModificationMode()&&!this._emotionCommentView.hasWritingComment()||confirm(IM("comment.cancel_writing_comment")))},_isCurrentMediaDownloadable:function(){if(this.model.isRestricted())return!1;if(this.model.isGiphy())return!1;if(!this._bandData.canDownloadFileOnMediaViewer())return!1;if(this._isAnyoneMediaDownloadable)return!0;var e=!t.isEmpty(this._mediaAuthor)&&this._mediaAuthor.isMyself();return this._bandData.canSaveBandMedia(e,this.model.getSavableState())},_toggleDownloadButton:function(){var e=this._isCurrentMediaDownloadable();this.getUI("downloadButton").toggle(e).prop("disabled",!e)},_handleHtmlClick:function(){this._hideMoreOptionList(),this._hideDownloadMenu()},_handleDownloadBtnClick:function(){this._getDownloadMenuRegion().hasView()||(this.model.getPhotoListDownloadParams()?t.defer(t.bind(this._showDownloadMenu,this)):this._downloadCurrentMedia())},_downloadCurrentMedia:function(){this._resetMoreOptionBehavior(),this.trigger(L.LISTENING_EVENTS.DO_ACTION,L.MEDIA_MORE_OPTION.DOWNLOAD.id)},_showDownloadMenu:function(){var e=k.build([q.PHOTO_LIST,q.THIS_PHOTO]);this.listenTo(e,k.EVENTS.MENU_SELECTED,(function(e){switch(this._hideDownloadMenu(),e){case q.PHOTO_LIST.id:B.downloadPhotoList(this.model.getPhotoListDownloadParams());break;case q.THIS_PHOTO.id:this._downloadCurrentMedia()}})),this.ui.downloadMenu.css("display","block"),this._getDownloadMenuRegion().show(e)},_hideDownloadMenu:function(){this._getDownloadMenuRegion().empty(),this.ui.downloadMenu.css("display","none")},_getDownloadMenuRegion:function(){return this.getRegion("downloadMenu")}});return X.EVENT={FETCH_NEXT_PHOTOS:"imageViewer:fetchNextPhotos",SHOW_POST:"imageViewer:showPost",FETCH_VIDEO_URL:"imageViewer_fetchVideoUrl",GO_ALBUM:"imageViewer:goAlbum"},X.openDPromotionImageViewer=function(e,t,n,i){var o={result_data:{photos:[{photo_url:t,width:n,height:i}],total_count:1},profileViewSupport:!1,moreOptionList:[L.MEDIA_MORE_OPTION.SAVE_TO_ALBUM],bandNo:e};return X.openDPhotoVideoImageViewer(o)},X.openDImageViewerAsPopup=function(e){var n=x.getMediaViewerOptionsRemovedFromHolder();e.popupOpen=!0,n.isAutoPlayOnOpening()&&(e.autoPlayOnOpening=!0),window.mediaViewerInfo={openOptions:e};var i={windowURL:"/media-viewer",windowName:e.popupName||"mediaViewer",width:565,height:762,resizable:1,centerBrowser:!0};window.screen.availHeight<=728&&(i=t.extend(i,{height:window.screen.availHeight-50,centerBrowser:!1,left:(window.screen.width-565)/2,top:0})),f.openGet(i)},X.openDPhotoVideoImageViewer=function(e){var t=X.buildImageViewer(e);return t.on(X.EVENT.FETCH_VIDEO_URL,(function(n,i,o,s){C.getVideoUrlByPhotoNo(e.bandNo,o).then((function(e){t.setVideoUrlFromAPI(e,n)}))})),a.open(t),t},X.buildImageViewer=function(e){var n={photoInfo:e.result_data,bandNo:e.bandNo,lastImageIndex:void 0,postNo:e.postNo,profileViewSupport:1==e.profileViewSupport,showUserInfo:1==e.showUserInfo},i=l.build([],n),o=t.extend({collection:i},e);return x.getMediaViewerOptionsRemovedFromHolder().isAutoPlayOnOpening()&&(o.autoPlayOnOpening=!0),new X(o)},X.getMatchedMediaViewerRouteInfo=J,X.isMediaViewerOpenUrl=function(e){return!!J(e)},X}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(2),o=n(0),s={addGradually:function(e,t,n){var a=i.Deferred();return n=i.extend({},n,{unitSize:3}),o.defer(s.__addGraduallyDeferBody,e,t,n,a),a},__addGraduallyDeferBody:function(e,t,n,i){var a=t.slice(0,n.unitSize);e.add(a,n),"pending"==i.state()&&(t&&0!=t.length||i.resolve(e),o.defer(s.__addGraduallyDeferBody,e,t.slice(n.unitSize),n,i))},changeModelIndex:function(e,t,n,i){var o=e.models,s=o[t];!s||n<0||n>=o.length||(i||(i={}),o.splice(t,1),o.splice(n,0,s),i.silent||e.trigger("sort",e,i))}};e.exports=s},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(52),s=n(6),a=n(489),r=n(152),l=n(586),c=a.extend({attachmentType:r.POST_ATTACHMENT_TYPE.POLL,defaults:function(){return{title:"",isAnonymous:!1,isSubjectAddible:!1,isMultipleSelect:!0,isOpen:!0,isSubjectCountless:!1,orderBy:r.POLL_ORDER_BY_SEQ,subjects:new s.Collection([],{model:d}),remainMember:new u,endedAt:null,voteVisibleQualification:null,isVoteVisibleToViewer:!1,isVoteLimited:!1,votableLimit:null}},parse:function(e,t){var n={bandNo:(e=o.camelizeKeys(e)).bandNo,postNo:e.postNo,isAuthor:e.isAuthor,pollId:e.id,title:e.title,count:e.count,isOpen:e.isOpen,isAnonymous:e.isAnonymous,isSubjectAddible:e.isSubjectAddible,isMultipleSelect:!e.isSingleSelect,orderBy:e.orderBy,isVoted:e.isVoted,subjects:null,remainMember:null,endedAt:e.endedAt,voteVisibleQualification:e.voteVisibleQualification,isVoteVisibleToViewer:e.isVoteVisibleToViewer,isVoteLimited:e.isVoteLimited,votableLimit:e.votableLimit,createdAt:e.createdAt};return e.subjects?(n.subjects=new s.Collection(e.subjects,{model:d,parse:!0}),n.subjects.length>=r.POLL_SUBJECT_LIMIT&&(n.isSubjectAddible=!1)):delete n.subjects,e.remainMember&&(n.remainMember=new u(e.remainMember,{parse:!0})),n},setJSON:function(e){e.subjects&&(e.subjects=new s.Collection(e.subjects,{model:d,parse:!0,validate:!0})),e.remainMember&&(e.remainMember=new u(e.remainMember)),this.set(e)},setImportJSON:function(e){var t={title:(e=o.camelizeKeys(e)).title,count:e.count,isOpen:e.isOpen,isAnonymous:e.isAnonymous,isSubjectAddible:e.isSubjectAddible,isMultipleSelect:!e.isSingleSelect,orderBy:e.orderBy,isVoted:e.isVoted,subjects:e.subjects,remainMember:null,endedAt:null,voteVisibleQualification:e.voteVisibleQualification,isVoteVisibleToViewer:e.isVoteVisibleToViewer,isVoteLimited:e.isVoteLimited,votableLimit:e.votableLimit};t.subjects?t.subjects=new s.Collection(t.subjects,{model:function(e,t){return new d({title:e.title},{parse:!0,validate:!0})}}):delete t.subjects,this.set(t)},isV1:function(){return!0},isV2:function(){return!1},saveVote:function(e,t){return t?l.voteV1(this.get("bandNo"),this.get("postNo"),e):l.cancelVoteV1(this.get("bandNo"),this.get("postNo"),e)},closePoll:function(){return l.stopPollV1(this.get("bandNo"),this.get("postNo"))},addSubject:function(e){if(e.length>r.POLL_SUBJECT_MAX_LENGTH){alert(IM("web.postwrite.poll.alert.subject_length",{maxlength:r.POLL_SUBJECT_MAX_LENGTH}));var n=t.Deferred();return n.reject(),n.promise()}return l.addPollSubjectV1(this.get("bandNo"),this.get("postNo"),e)},_getAvailableSubjects:function(){return this.get("subjects").filter((function(e){return e.isValid()}))},getVotedMemberCount:function(){return this.get("count")},hasVotedMember:function(){return this.getVotedMemberCount()>0},validate:function(e,n){var i=t.trim(e.title);if(!i)return IM("web.postwrite.poll.alert.enter_title");if(i.length>r.POLL_TITLE_MAX_LENGTH)return IM("web.postwrite.poll.alert.title_length",{maxlength:r.POLL_TITLE_MAX_LENGTH});var o=this._getAvailableSubjects();if(!o||0===o.length)return IM("web.postwrite.poll.alert.enter_subject");var s=o.filter((function(e){return e.get("title").length>r.POLL_SUBJECT_MAX_LENGTH}));return s&&s.length>0?IM("web.postwrite.poll.alert.subject_length",{maxlength:r.POLL_SUBJECT_MAX_LENGTH}):void 0},toJSONForSave:function(){if(this.isValid()){var e=this._getAvailableSubjects(),t={type:"poll",title:this.get("title"),is_anonymous:this.get("isAnonymous"),is_subject_addible:this.get("isSubjectAddible"),is_single_select:!this.get("isMultipleSelect"),vote_visible_qualification:this.get("voteVisibleQualification"),order_by:this.get("orderBy"),poll_items:i.map(e,(function(e){return e.get("pollSubjectId")?{subject:e.get("title"),poll_subject_id:e.get("pollSubjectId")}:{subject:e.get("title")}})),ended_at:this.get("endedAt")};return this.get("isMultipleSelect")&&(i.extend(t,{is_vote_limited:this.get("isVoteLimited"),votable_limit:this.get("votableLimit")}),this.get("isVoteLimited")&&i.extend(t,{votable_limit:this.get("votableLimit")})),JSON.stringify(t)}return null}}),d=a.extend({parse:function(e,t){var n={pollSubjectId:(e=o.camelizeKeys(e)).pollSubjectId,title:e.title,voters:null,voterCount:e.voterCount,isVoted:e.isVoted,isUpdated:e.isUpdated,isAdded:e.isAdded};return e.voters&&(n.voters=e.voters),n},validate:function(e,t){if(!e.title)return"Subject title is mandatory"}}),u=a.extend({defaults:{voterCount:0,voters:null},parse:function(e,t){var n={voterCount:(e=o.camelizeKeys(e)).voterCount||0,voters:null};return e.voters&&(n.voters=e.voters),n}});return c.prepareApiResponseForCopy=function(e){i.each(e.subjects,(function(e){delete e.poll_subject_id}))},c.buildForGetPoll=function(e){return l.getPoll(e.bandNo,e.postNo,e.pollId).then(i.bind((function(e){return new c(e,{parse:!0})}),this))},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(10),i=n(6),o=n(52),s=i.Model.extend({parse:function(e,t){return{name:(e=o.camelizeKeys(e)).name,address:e.address,latitude:e.latitude,longitude:e.longitude}},isEmptyLocation:function(){return t.isBlank(this.get("name"))&&t.isBlank(this.get("address"))&&t.isBlank(this.get("latitude"))&&t.isBlank(this.get("longitude"))}});return s.buildLocationModel=function(e){return new s(e)},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(152),o=n(52),s=t.extend({attachmentType:i.POST_ATTACHMENT_TYPE.ADDON,defaults:function(){return{postAddonId:null,summary:new a}},parse:function(e,t){return{postAddonId:(e=o.camelizeKeys(e)).postAddonId,summary:new a(e.summary,{parse:!0})}},setJSON:function(e){e.summary&&(e.summary=new a(e.summary)),this.set(e)},toJSONForSave:function(){var e=this.get("postAddonId");return null!=e?{post_addon_id:e}:{summary:{addonType:this.getAddonType(),oneTimeToken:this.getAddonSummaryModel().getOneTimeToken()}}},getAddonSummaryModel:function(){return this.get("summary")},getPostAddonId:function(){return this.get("postAddonId")},getAddonType:function(){return this.getAddonSummaryModel().getAddonType()},getDescription:function(){return this.getAddonSummaryModel().getDescription()},getOneTimeToken:function(){return this.getAddonSummaryModel().getOneTimeToken()},setOneTimeToken:function(e){this.getAddonSummaryModel().setOneTimeToken(e)},isSupportVersion:function(){return this.getAddonSummaryModel().isSupportVersion()}}),a=t.extend({defaults:function(){return{addonType:null,description:null,oneTimeToken:null}},parse:function(e,t){var n=o.camelizeKeys(e);return{addonType:n.addonType,description:n.description,oneTimeToken:n.oneTimeToken,version:n.version,name:n.name}},getAddonType:function(){return this.get("addonType")},getDescription:function(){return this.get("description")},getNameMap:function(){return this.get("name")},getOneTimeToken:function(){return this.get("oneTimeToken")},setOneTimeToken:function(e){this.set("oneTimeToken",e)},isSupportVersion:function(){return(this.get("version")||0)<=s.MAX_ADDON_SUPPORT_VERSION}});return s.MAX_ADDON_SUPPORT_VERSION=1,s.prepareApiResponseForCopy=function(e){delete e.post_addon_id},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1288),s=n(22),a=n(82),r=n(497),l=n(1145),c=n(487),d={21:"-size21",24:"-size24",25:"-size25",30:"-size30",34:"-size34",40:"-size40",50:"-size50",60:"-size60"},u=i.View.extend({options:{size:40,disableClick:!1,useCORS:!1,lazyLoading:!0},tagName:function(){return this.options.disableClick?"span":"a"},attributes:function(){var e={"data-viewname":"DProfileImageView"};return this.options.disableClick||(e=t.extend(e,{href:"#",role:"button"})),e},className:function(){var e=["uProfile",this._getSizeClass(),this._getIconClass()];return this.options.withoutBorder||e.push("-border"),e.join(" ")},triggers:function(){return this.options.disableClick?{}:{click:"clickProfileImageView"}},behaviors:[c],_hasProfileImage:function(){return!!this.options.memberProfile.profileImageUrl&&!this._isImageLoadErrorOccured},_getSizeClass:function(){return d[this.options.size]},_getIconClass:function(){if(this.options.bandCore.showBandLeaderTermAsManager()){if(this.options.memberProfile.memberType===s.MEMBER_TYPE.PAGE_PROFILE)return"-pageIcon -pageProfile"}else switch(this.options.role){case r.LEADER:return"-leader";case r.CO_LEADER:return"-coleader";default:return null}},initialize:function(){this._isImageLoadErrorOccured=void 0},template:t.template(o),serializeData:function(){var e=a.makeProfileThumbnailUrl(this.options.memberProfile.profileImageUrl,this.options.useCORS);return{imageSize:this.options.size,name:this.options.memberProfile.name,hasProfileImage:this._hasProfileImage(),profileImageThumbnail:e,profileInnerClass:this._hasProfileImage()?a.makeProfileInnerClass(e):"",roleLabel:this._getRoleLabel(),useCORS:this.options.useCORS,lazyLoading:this.options.lazyLoading}},_getRoleLabel:function(){if(!this.options.bandCore.showBandLeaderTermAsManager())switch(this.options.role){case r.LEADER:return IM("web.band.member.role.leader");case r.CO_LEADER:return IM("web.band.member.role.coleader");case r.MEMBER:return IM("web.band.member.role.member");default:return null}},ui:{image:"._image"},onRender:function(){this.$el.attr("class",this.className()),this.getUI("image").one("error",t.bind((function(){this._isImageLoadErrorOccured=!0,this.render()}),this))}});return u.buildDProfileImageView=function(e){var t={memberProfile:e.memberProfile,bandCore:e.bandCore,role:e.role};if(e.size){if(!d[e.size])throw new Error("Invalid options.size");t.size=e.size}return t.lazyLoading=void 0===e.lazyLoading||!!e.lazyLoading,t.useCORS=!!e.useCORS,t.disableClick=!!e.disableClick,t.withoutBorder=1==e.withoutBorder,new u(t)},u.buildContentCreatorProfileImageView=function(e){var t=new l(e.memberProfile,e.userNoOrMemberKey,e.bandCore),n={memberProfile:e.memberProfile,bandCore:e.bandCore,role:e.role};if(e.size){if(!d[e.size])throw new Error("Invalid options.size");n.size=e.size}return e.useCORS&&(n.useCORS=!!e.useCORS),e.lazyLoading&&(n.lazyLoading=!!e.lazyLoading),n.disableClick=!t.canClickMemberProfile(),n.events=function(){return t.canClickMemberProfile()?{click:function(n){if(n.preventDefault(),n.stopPropagation(),t.isGotoBandOnClick()){var i=e.bandCore.bandNo;this.jplClick(c.CLASSIFIER.PAGE_PROFILE_NAME,{band_no:i},i)}t.clickMemberProfileAction()}}:{}},n.triggers={},new u(n)},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(520),o=n(154),s=n(533),a=n(503),r=n(505);return{fetchPostTotalCommentCount:t.throttle((function(e,t,n){return o.wrapActivePromise(i.getRichPost(e,t),n).then((function(e){return e&&null!=e.comment_count?e.comment_count:null}))}),200,{trailing:!1}),fetchPhotoTotalCommentCount:t.throttle((function(e,n,i){return o.wrapActivePromise(s.getPhoto(e,n),i).then(t.bind((function(e){return e&&e.photo&&null!=e.photo.comment_count?e.photo.comment_count:null}),this))}),200,{trailing:!1}),fetchScheduleTotalCommentCount:t.throttle((function(e,n,i){return o.wrapActivePromise(a.getSchedule(e,n),i).then(t.bind((function(e){return e&&null!=e.comment_count?e.comment_count:null}),this))}),200,{trailing:!1}),fetchCommentReplyCount:function(e,t,n){var i={band_no:e,content_key:t.toApiParams(!0)};return o.wrapActivePromise(r.getComment(i),n).then((function(e){return e&&e.comment&&null!=e.comment.comment_count?e.comment.comment_count:0}))}}}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i=n(523),o=n(43),s={min:"remaining_time_before_start.by_min",hour:"remaining_time_before_start.by_hour",day:"remaining_time_before_start.by_day"},a={min:"remaining_time_before_end.by_min",hour:"remaining_time_before_end.by_hour",day:"remaining_time_before_end.by_day"},r={MAX_START_DAY_FROM_NOW_BY_DAY:60,DEFAULT_PERIOD_RANGE_BY_DAY:30,MAX_PERIOD_RANGE_BY_DAY:60,MAX_PREVIOUS_CONTENT_COUNT:30,QUESTION_MAX_COUNT:50,CHOICE_DEFAULT_COUNT:2,CHOICE_MAX_COUNT:10,QUESTION_TITLE_MAX_LENGTH:500,CHOICE_TITLE_MAX_LENGTH:200,RESPONDED_IMAGE_MAX_COUNT:5,RESPONDED_FILE_MAX_COUNT:1,RESPONDED_FILE_MAX_SIZE:52428800,getSurveyeeCountText:function(e,t){return e=e||0,_.isNumber(t)?IM("post.survey.surveyee_count.with_denominator",{count:String(e),max:String(t)}):IM("post.survey.surveyee_count",{count:String(e)})},getRemainingTimeMessage:function(e,t,n){var r=o(Date.now());if(r.isAfter(t))return IM("survey.msg.ended");if(r.isBefore(e)){var l=i.getRemainingTime(e,n);return IM(s[l.format],{value:l.value})}if(t&&r.isBefore(t)){var c=i.getRemainingTime(t,n);return IM(a[c.format],{value:c.value})}return""},getRemainingTimeMessageBeforeStart:function(e,t){var n=i.getRemainingTime(e,t);return IM(s[n.format],{value:n.value})},getRemainingTimeMessageBeforeEnd:function(e,t){var n=i.getRemainingTime(e,t);return IM(a[n.format],{value:n.value})}};e.exports=r},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(6),s=n(505),a=n(580),r=n(52),l=n(536),c=o.Collection.extend({model:a,initialize:function(e,t){this._bandNo=t.bandNo,this._ownerContentKey=t.ownerContentKey,this._contentKeyButCommentId=t.contentKeyButCommentId,this._pagingData={},this._totalCount=0},fetchLastCommentList:function(e){var t={band_no:this._bandNo,content_key:this._ownerContentKey.toApiParams(!0),resolution_type:l.RETINA_RESOLUTION_TYPE};return e&&(t.token=e,t.post_no=this._ownerContentKey.getPostNo()),this.fetchCommentList(t)},fetchAroundCommentList:function(e){if(isNaN(e))return i.Deferred().resolve(this);var t=this._contentKeyButCommentId.clone();t.setCommentId(e);var n={band_no:this._bandNo,content_key:this._ownerContentKey.toApiParams(!0),around:t.toApiParams(!0),resolution_type:l.RETINA_RESOLUTION_TYPE};return this.fetchCommentList(n)},fetchCommentList:function(e){return s.getCommentList(e).then(t.bind((function(e){return e.items=r.camelizeKeys(e.items),this.populateDetailCommentData(e)}),this))},getTotalCount:function(){return this._totalCount},getPagingData:function(){return this._pagingData},populateDetailCommentData:function(e){return e?(this._totalCount=e.totalCount||e.total,this.reset(e.comments||e.items),this._pagingData=e.paging||{},this._pagingData.update_param=e.update_param,this):this},getContentKeyButCommentId:function(){return this._contentKeyButCommentId}});return c.buildDetailCommentCollection=function(e){return new c([],e)},c}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=n(52),a=n(6),r=n(489),l=n(501),c=n(706),d=n(152),u=r.extend({attachmentType:d.POST_ATTACHMENT_TYPE.TODO,defaults:function(){return{title:"",numberOfTasks:0,isTaskAddible:!1,isCheckableOnlyByAuthor:!1,tasks:new a.Collection([],{model:h}),endedAt:null}},parse:function(e,t){var n={isAuthor:(e=s.camelizeKeys(e)).isAuthor,bandNo:e.bandNo,postNo:e.postNo,title:e.title,numberOfTasks:e.numberOfTasks||0,numberOfDone:e.numberOfDone||0,isTaskAddible:e.isTaskAddible,isCheckableOnlyByAuthor:e.isCheckableOnlyByAuthor,tasks:new a.Collection(e.tasks,{model:h,parse:!0}),endedAt:e.endedAt};return n.tasks.length>=d.TODO_TASK_LIMIT&&(n.isTaskAddible=!1),n},setJSON:function(e){e.tasks&&(e.tasks=new a.Collection(e.tasks,{model:h,parse:!0,validate:!0})),this.set(e)},setImportJSON:function(e){var t={endedAt:null,title:(e=s.camelizeKeys(e)).title,isCheckableOnlyByAuthor:e.isCheckableOnlyByAuthor,isTaskAddible:e.isTaskAddible,numberOfDone:0,numberOfTasks:e.numberOfTasks,tasks:e.tasks,todoExtra:e.todoExtra};t.tasks&&(t.tasks=new a.Collection(t.tasks,{model:function(e,t){return new h({subject:e.subject},{parse:!0,validate:!0})}})),this.set(t)},isV1:function(){return!0},isV2:function(){return!1},getTask:function(e){return this.get("tasks").find({taskId:e})},checkTask:function(e){var t=this.get("bandNo"),n=this.get("postNo"),o=this.get("isAuthor");return c.checkTodoV1(t,n,e).then(i.bind((function(e){this.set(this.parse(i.extend(e,{bandNo:t,postNo:n,isAuthor:o})))}),this))},uncheckTask:function(e){var t=this.get("bandNo"),n=this.get("postNo"),o=this.get("isAuthor");return c.uncheckTodoV1(t,n,e).then(i.bind((function(e){this.set(this.parse(i.extend(e,{bandNo:t,postNo:n,isAuthor:o})))}),this))},addTask:function(e){if(o.isBlank(e))return alert(IM("todo.add_task.alert.blank_subject")),t.Deferred().reject();if(e.length>d.TODO_TASK_MAX_LENGTH)return alert(IM("web.postwrite.todo.alert.task_length",{maxlength:d.TODO_TASK_MAX_LENGTH})),t.Deferred().reject();var n=this.get("bandNo"),i=this.get("postNo");return c.addTodoTaskV1(n,i,e)},_getAvailableTasks:function(){return this.get("tasks").filter((function(e){return e.isValid()}))},validate:function(e,n){var i=t.trim(e.title);if(!i)return IM("web.postwrite.todo.alert.enter_title");if(i.length>d.TODO_TITLE_MAX_LENGTH)return IM("web.postwrite.todo.alert.title_length",{maxlength:d.TODO_TITLE_MAX_LENGTH});var o=this._getAvailableTasks();if(!o||0===o.length)return IM("web.postwrite.todo.alert.enter_task");var s=o.filter((function(e){return e.get("subject").length>d.TODO_TASK_MAX_LENGTH}));return s&&s.length>0?IM("web.postwrite.todo.alert.task_length",{maxlength:d.TODO_TASK_MAX_LENGTH}):void 0},toJSONForSave:function(){if(this.isValid()){var e=this._getAvailableTasks();return JSON.stringify({title:this.get("title"),is_task_addible:this.get("isTaskAddible"),is_checkable_only_by_author:this.get("isCheckableOnlyByAuthor"),tasks:i.map(e,(function(e){return{task_id:e.get("taskId")||null,subject:e.get("subject")}})),ended_at:this.get("endedAt")})}return null}}),h=r.extend({parse:function(e,t){var n={taskId:(e=s.camelizeKeys(e)).taskId,subject:e.subject,isChecked:e.isChecked,isUpdated:e.isUpdated,isAdded:e.isAdded,checkedAt:e.checkedAt,actor:null};return e.actor&&(n.actor=new l(e.actor,{parse:!0})),n},isCheckedByMe:function(){return!!this.get("actor")&&this.get("actor").isMyself()},setJSON:function(e){e.actor&&(e.actor=new l(e.actor)),this.set(e)},validate:function(e,t){if(o.isBlank(e.subject))return"Task subject is mandatory"}});return u.prepareApiResponseForCopy=function(e){i.each(e.tasks,(function(e){delete e.task_id}))},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o={getCursorLineNum:function(e){return e.value.substr(0,e.selectionStart).split("\n").length},adjustLayerPosition:function(e,t,n){var i=e.height(),o=e.offset()||{},s=t.offset().top+t.outerHeight()-(o.top||0),a=n||"lyTop";t.hasClass(a)&&t.removeClass(a),i<s&&t.addClass(a)},adjustLayerPositionX:function(e,t){var n=e.width(),i=t.offset().left,o=i+t.outerWidth();t.hasClass("lyRight")&&t.removeClass("lyRight"),n<o&&t.addClass("lyRight"),t.offset().left<0&&(t.removeClass("lyRight"),t.css({left:-1*(o-Math.abs(i)-Math.abs(t.offset().left)),right:"auto"}))},adjustSelectboxPosition:function(e,t,n){var i=e.height(),o=t.offset().top+t.outerHeight()-e.offset().top,s=n||"-up";t.hasClass(s)&&t.removeClass(s),i<o&&t.addClass(s)},isElementDocument:function(e){return null!=e&&e[0].nodeType==Node.DOCUMENT_NODE},isContaining:function(e,t){return t&&t.length>0&&(t=t[0]),t instanceof Node&&(i.isArray(e)||(e=[e]),i.some(e,(function(e){return e&&e.length>0&&(e=e[0]),e instanceof Node&&e.contains(t)})))}};e.exports=o},function(e,t,n){var i=n(21),o={getFileUrl:function(e,t){var n={band_no:e,file_id:t};return i.getLoginV1Client().send({url:"https://api.band.us/v1.1/get_file_url",data:n}).then((function(e,t,n){return e.result_data.url}))},getChatFileUrl:function(e,t){var n={channel_id:e,msg_id:t};return i.getLoginV1Client().send({url:"https://api.band.us/v1.0.0/get_chat_file_url",data:n}).then((function(e){return e.result_data.file_url}))},getBandIntroFileUrl:function(e,t){var n={band_no:e,file_id:t};return i.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/get_file_url_of_band_intro",method:"POST",data:n}).then((function(e,t,n){return e.result_data.file_url}))},createFolder:function(e,t){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/create_folder",method:"POST",data:{band_no:e,name:t}})},setFolderName:function(e,t,n){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_folder_name",method:"POST",data:{band_no:e,folder_id:t,name:n}})},deleteFolder:function(e,t){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/delete_folder",method:"POST",data:{band_no:e,folder_id:t}})},searchFolders:function(e,t){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/search_folders",data:{band_no:e,query:t}})},getFolders:function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_folders",data:{band_no:e}})},getFolder:function(e,t){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_folder",data:{band_no:e,folder_id:t}})},createFiles:function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/create_files",method:"POST",data:e})},moveFiles:function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/move_files",method:"POST",data:e})},deleteFiles:function(e){var t={band_no:e.bandNo,file_ids:e.fileIds.join(",")};return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1.0.0/delete_files",method:"POST",data:t})},getFiles:function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.1/get_files",data:e})},getFilesForQuota:function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_files_for_quota",data:e})},searchFiles:function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/search_files",data:e})}};e.exports=o},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=t.Model.extend({idAttribute:"attachId",defaults:{attachId:null,id:null,sosId:null,title:null,fileSize:null,expiresAt:null,_newFileForSave:!1},parse:function(e,t){return{attachId:(e=i.camelizeKeys(e)).id+"_"+e.sosId,id:e.id,sosId:e.sosId,title:e.title,fileSize:e.fileSize,expiresAt:e.expiresAt,_newFileForSave:(t||{}).newFileForSave}},getAttachId:function(){return this.get("attachId")},getId:function(){return this.get("id")},getSosId:function(){return this.get("sosId")},getTitle:function(){return this.get("title")},getFileSize:function(){return this.get("fileSize")},getExpiresAt:function(){return this.get("expiresAt")},toJSONForSave:function(e){return this._isNewFileForSave()||e?{id:this.getSosId()||this.getId(),file_name:this.getTitle(),file_size:this.getFileSize()}:{file_id:this.getSosId()||this.getId(),file_name:this.getTitle(),file_size:this.getFileSize()}},_isNewFileForSave:function(){return 1==this.get("_newFileForSave")}});return o.buildNewUploadedFile=function(e){return new o({sosId:e.id,file_size:e.file_size,title:e.name},{parse:!0,newFileForSave:!0})},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52);return t.Model.extend({idAttribute:"fileId",defaults:{fileId:null,link:null,name:null,size:null,origin:null,_newFileForSave:!1},parse:function(e,t){return{fileId:(e=i.camelizeKeys(e)).fileId,link:e.link,name:e.name,size:e.size,origin:e.origin,_newFileForSave:(t||{}).newFileForSave}},getFileId:function(){return this.get("fileId")},getLink:function(){return this.get("link")},getName:function(){return this.get("name")},getSize:function(){return this.get("size")},toJSONForDropboxFileSave:function(e){return this._isNewFileForSave()||e?{link:this.getLink(),name:this.getName(),size:this.getSize()}:{file_id:this.getFileId(),file_name:this.getName(),file_size:this.getSize()}},_isNewFileForSave:function(){return 1==this.get("_newFileForSave")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52);return t.Model.extend({idAttribute:"fileId",defaults:{fileId:null,link:null,name:null,origin:null,size:null,source:null,_newFileForSave:!1},parse:function(e,t){return{fileId:(e=i.camelizeKeys(e)).fileId,link:e.link,name:e.name,origin:e.origin,size:e.size,source:e.source,_newFileForSave:(t||{}).newFileForSave}},getFileId:function(){return this.get("fileId")},getLink:function(){return this.get("link")},getSource:function(){return this.get("source")},getName:function(){return this.get("name")},getSize:function(){return this.get("size")},toJSONForExternalFileSave:function(e){return this._isNewFileForSave()||e?{link:this.getLink(),source:this.getSource(),name:this.getName(),size:this.getSize()}:{file_id:this.getFileId(),file_name:this.getName(),file_size:this.getSize()}},_isNewFileForSave:function(){return 1==this.get("_newFileForSave")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t={THUMB_MIN_SIZE:200,TYPE_NO_IMAGE:"false",TYPE_SQUARE:"type1",TYPE_HEIGHT_IS_LONGER:"type2",TYPE_WIDTH_IS_LONGER:"type3",SNIPPET_VIEW_TYPE:{NORMAL:"normal",SMALL:"small"},getSnippetThumbnailTypeOfImage:function(e){return e.url?e.width>t.THUMB_MIN_SIZE&&e.height>t.THUMB_MIN_SIZE?e.width<e.height?t.TYPE_HEIGHT_IS_LONGER:e.width===e.height?t.TYPE_SQUARE:t.TYPE_WIDTH_IS_LONGER:t.TYPE_SQUARE:t.TYPE_NO_IMAGE}};return t}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(34),i=n(21);n(511);return{getCalendars:function(e,t){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_calendars",data:{band_no:e,calendar_types:t}})},createCalendar:function(e,n){var o={band_no:e,calendar:t.stringify(n)};return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/create_calendar",method:"POST",data:o})},updateCalendar:function(e,n,o,s){var a={band_no:e,calendar_id:n,is_default_calendar:o,calendar:t.stringify(s)};return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/update_calendar",method:"POST",data:a})},deleteCalendar:function(e,t){var n={band_no:e,calendar_id:t};return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/delete_calendar",method:"POST",data:n})},clearDefaultCalendar:function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/clear_default_calendar",method:"POST",data:{band_no:e}})},getCalendarPersonalNotice:function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_calendar_personal_notice",method:"GET",data:{band_no:e}})},getSubscribableCalendars:function(e){return i.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1.0.0/get_subscribable_calendars",data:{band_no:e}})},getBandScheduleConfig:function(e){return i.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v1.0.0/get_band_schedule_config",data:{band_no:e}})},setBandScheduleConfigSubscribedCalendarIds:function(e,t){return i.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v2.0.0/set_band_subscribed_calendar_config",data:{band_no:e,type:"POST",subscribed_calendar_ids:t.join(",")}})},setBandScheduleConfigUpcomingSchedule:function(e,t,n){return i.getLoginV1Client().sendAndThenProcessWithErrorAlert({url:"https://api.band.us/v2.0.0/set_band_upcoming_schedule_config",data:{band_no:e,type:"POST",is_upcoming_schedule_visible:t,upcoming_schedule_period:n}})},refreshExternalCalendar:function(e,t){var n={band_no:e,calendar_id:t};return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/refresh_external_calendar",method:"POST",data:n})},getCalendarsWithSubscribed:function(e){return i.getLoginV1Client().sendBandApiBatchRequest([{path:"/v2.0.0/get_calendars",params:{band_no:e,calendar_types:"internal,external"}},{path:"/v1.0.0/get_band_schedule_config",params:{band_no:e}}]).then(_.bind((function(e,t,n){return{externalCalendars:e[0].result_data.external_calendars,internalCalendars:e[0].result_data.internal_calendars,subscribedCalendars:e[1].result_data.subscribed_calendars}}),this))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(172),o=n(13),s=n(82),a=n(569);return{makeCommentMentionTargets:function(e){var n=e.withMemberGroupMention,i=e.memberGroupMentionArray,s=e.mentionLeaderAndColeaderAsWell,r=e.leaderColeaderMentionArray,l=e.bandMemberMentionArray,c=e.fixedTargetMemberMentionArray,d=[];return n&&(d=d.concat(i||[])),s&&(d=d.concat(r||[])),d=!s&&t.isEmpty(c)?d.concat(l||[]):d.concat(c||[]),d=t.chain(d).uniq((function(e){return e.getUniqueIdGroupByType()})).filter((function(e){return e.getUserNo()!=o.getUserData().getUserNo()})).value(),a.concatMentionArrayAndSort(d)},makeScheduleCommentMentionTargets:function(e,n){if(null==n||n.isEmpty())return null;var a=n.chain().filter((function(e){return!e.isDeleted()})).map((function(e){return i.buildBandMemberMention(e.getUserNo(),e.getName(),null,e.getFaceThumb(),e.getDescription())})).value();return null==e||e.isContentAuthorDeleted()||a.push(i.buildBandMemberMention(e.getUserNo(),e.getName(),null,s.makeProfileThumbnailUrl(e.getContentAuthorProfileImageUrl()),e.getContentAuthorDescription())),t.filter(a,(function(e){return e.getUserNo()!=o.getUserData().getUserNo()}))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2);n(196);var o="AIzaSyCr8e_1uYiVB7NXxF1JPo3m98BwzB-4420";return{GOOGLE_MAP_API_KEY:o,getStaticMapUrl:function(e,n,s){return s=t.extend({width:520,height:290,scale:window.devicePixelRatio},s),void 0===e&&void 0===n?null:(r=n,33<=(a=e)&&a<=38.9&&124.5<=r&&r<=132&&!(32.8>=a&&128.7<=r||34.8>=a&&129<=r||36.6>=a&&130<=r)?function(e,t,n,o,s){var a={caller:"band_map",center:[t,e].join(","),markers:"viewSizeRatio:0.7|pos:"+[t,e].join(" "),level:14,w:n,h:o,scale:s>1?2:1};return"https://simg.pstatic.net/static.map/v2/map/staticmap.bin?"+i.param(a)}(e,n,s.width,s.height,s.scale):function(e,t,n,s,a){var r=e+","+t,l={key:o,center:r,markers:r,size:[n,s].join("x"),zoom:15,sensor:!1,region:window.countryCode,scale:a>1?2:1};return"https://maps.googleapis.com/maps/api/staticmap?"+i.param(l)}(e,n,s.width,s.height,s.scale));var a,r},getLargeMapUrl:function(e,t){return"https://www.google.com/maps/search/?api=1&query="+e+","+t}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{MAX_EMOTION_COUNT_FOR_SUMMARY_VIEW:20,EMOTION_COUNT_VIEW_CLASS:"_emotionCountView"}}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(43),s=n(523),a=n(52),r=i.Model.extend({defaults:{freq:null,interval:null,byMonthDay:null,byDay:null,until:null,since:null},parse:function(e){var t={freq:(e=a.camelizeKeys(e)).freq};return e.interval&&(t.interval=e.interval),e.byMonthDay&&(t.byMonthDay=e.byMonthDay),e.byDay&&(t.byDay=e.byDay),e.until&&(t.until=e.until),e.since&&(t.since=e.since),t},getSince:function(){return this.get("since")},toJSONForSave:function(){var e={freq:this.get("freq")};return this.has("interval")&&(e.interval=this.get("interval")),this.has("byMonthDay")&&(e.by_month_day=this.get("byMonthDay")),this.has("byDay")&&(e.by_day=this.get("byDay")),this.has("until")&&(e.until=this.get("until")),e},getMessage:function(e,t){var n=r.PREDEFINED_CONTAINER.findByScheduleRecurrenceModel(this,e,t);return n?n.makeName(e):r.FREQ_SPEC[this.get("freq")].makeMessage(this.toJSON(),e)}});function l(e,n){return!e&&!n||!(!e||!n)&&t.isEqual(e,n)}return r.isSameRecurrence=function(e,n){return!e&&!n||!(!e||!n)&&(!!t.isEqual(e.pick("byDay","byMonthDay","freq","interval"),n.pick("byDay","byMonthDay","freq","interval"))&&(!e.get("until")&&!n.get("until")||!(!e.get("until")||!n.get("until"))&&o(e.get("until")).isSame(n.get("until"),"day")))},r.FREQ_SPEC={DAILY:{MAX_INTERVAL:60,defaultUntilDuration:"P90D",maxUntilDuration:o.duration(5,"years"),makeMessage:function(e){return IM("schedule.recurrence.custom_message.daily",{interval:e.interval})},isRequireUntilSelectDirect:function(e){return e>30}},WEEKLY:{MAX_INTERVAL:24,defaultUntilDuration:"P90D",maxUntilDuration:o.duration(5,"years"),makeMessage:function(e){var n=t.map(e.byDay,(function(t){var n=r.WeekDayKey.indexOf(t.day),i=o().day(n);return IM("schedule.recurrence.custom_message.weekly.weekdayName",{count:e.byDay.length,d:i.format("d"),dd:i.format("dd"),ddd:i.format("ddd"),dddd:i.format("dddd")})})).join(", ");return IM("schedule.recurrence.custom_message.weekly",{interval:e.interval,weekdayNames:n})},isRequireUntilSelectDirect:function(e){return e>4}},MONTHLY:{MAX_INTERVAL:31,defaultUntilDuration:"P5Y",maxUntilDuration:null,makeMessage:function(e,t){var n;return n=e.byMonthDay?-1===e.byMonthDay[0]?"byLastMonthDay":"byMonthDay":-1===e.byDay[0].offset?"byLastMonthWeekDay":"byMonthWeekDay",IM("schedule.recurrence.custom_message.monthly",{interval:e.interval,monthdayName:r.MonthDayName[n](t)})},isRequireUntilSelectDirect:function(){return!1}},YEARLY:{MAX_INTERVAL:1,defaultUntilDuration:"P5Y",maxUntilDuration:null,makeMessage:function(){return IM("schedule.recurrence.predefined_message.year")},isRequireUntilSelectDirect:function(){return!1}}},r.WeekDayKey=["SU","MO","TU","WE","TH","FR","SA"],r.makeWeekByDay=function(e){return{day:r.WeekDayKey[e]}},r.MonthlyDayType={byMonthDay:"byMonthDay",byMonthWeekDay:"byMonthWeekDay",byLastMonthWeekDay:"byLastMonthWeekDay",byLastMonthDay:"byLastMonthDay"},r.matchedMonthlyDayType=function(e){return"MONTHLY"!==e.get("freq")?null:e.has("byMonthDay")?-1===e.get("byMonthDay")[0]?"byLastMonthDay":"byMonthDay":-1===e.get("byDay")[0].offset?"byLastMonthWeekDay":"byMonthWeekDay"},r.makeMonthlyByDay=function(e,t){switch(t){case r.MonthlyDayType.byMonthDay:return{byMonthDay:[e.date()]};case r.MonthlyDayType.byMonthWeekDay:return{byDay:[{day:r.WeekDayKey[e.day()],offset:s.getWeekOfMonth(e)}]};case r.MonthlyDayType.byLastMonthWeekDay:return{byDay:[{day:r.WeekDayKey[e.day()],offset:-1}]};case r.MonthlyDayType.byLastMonthDay:return{byMonthDay:[-1]}}},r.MonthDayName={byMonthDay:function(e){return IM("schedule.recurrence.custom_message.monthly.monthdayName.by_monthday",{D:e.format("D"),DD:e.format("DD"),Do:e.format("Do")})},byMonthWeekDay:function(e){return IM("schedule.recurrence.custom_message.monthly.monthdayName.by_weekday",{nthWeek:s.getWeekOfMonth(e),d:e.format("d"),dd:e.format("dd"),ddd:e.format("ddd"),dddd:e.format("dddd")})},byLastMonthWeekDay:function(e){return IM("schedule.recurrence.custom_message.monthly.monthdayName.by_last_weekday",{d:e.format("d"),dd:e.format("dd"),ddd:e.format("ddd"),dddd:e.format("dddd")})},byLastMonthDay:function(){return IM("schedule.recurrence.custom_message.monthly.monthdayName.by_last_monthday")}},r.LUNAR_PREDEFINEDS=[{key:"YEAR",defaultUntil:function(){return null},MATCH_FREQ:"YEARLY",makeName:function(){return IM("schedule.recurrence.predefined_message.year")},recurrence:function(){return{freq:"YEARLY"}}}],r.PREDEFINEDS=[{key:"DAY",defaultUntil:function(e){return o(e).add(o.duration(r.FREQ_SPEC.DAILY.defaultUntilDuration))},MATCH_FREQ:"DAILY",makeName:function(){return IM("schedule.recurrence.predefined_message.day")},recurrence:function(){return{freq:"DAILY"}}},{key:"WEEK",defaultUntil:function(e){return o(e).add(o.duration(r.FREQ_SPEC.WEEKLY.defaultUntilDuration))},MATCH_FREQ:"WEEKLY",makeName:function(){return IM("schedule.recurrence.predefined_message.week")},recurrence:function(){return{freq:"WEEKLY"}}},{key:"WEEKS_2",defaultUntil:function(e){return o(e).add(o.duration(r.FREQ_SPEC.WEEKLY.defaultUntilDuration))},MATCH_FREQ:"WEEKLY",makeName:function(){return IM("schedule.recurrence.predefined_message.weeks_2")},recurrence:function(){return{freq:"WEEKLY",interval:2}}},{key:"MONTH",defaultUntil:function(e){return o(e).add(o.duration(r.FREQ_SPEC.MONTHLY.defaultUntilDuration))},MATCH_FREQ:"MONTHLY",makeName:function(e){return IM("schedule.recurrence.predefined_message.month",{Do:e.format("Do"),D:e.format("D"),DD:e.format("DD")})},recurrence:function(){return{freq:"MONTHLY"}}},{key:"MONTH_WEEK",defaultUntil:function(e){return o(e).add(o.duration(r.FREQ_SPEC.MONTHLY.defaultUntilDuration))},MATCH_FREQ:"MONTHLY",makeName:function(e){var t=s.getWeekOfMonth(e);return IM("schedule.recurrence.predefined_message.month_week",{nthWeek:t,d:e.format("d"),dd:e.format("dd"),ddd:e.format("ddd"),dddd:e.format("dddd")})},recurrence:function(e){return t.extend({freq:"MONTHLY"},r.makeMonthlyByDay(e,r.MonthlyDayType.byMonthWeekDay))}},{key:"YEAR",defaultUntil:function(e){return o(e).add(o.duration(r.FREQ_SPEC.YEARLY.defaultUntilDuration))},MATCH_FREQ:"YEARLY",makeName:function(){return IM("schedule.recurrence.predefined_message.year")},recurrence:function(){return{freq:"YEARLY"}}}],r.PREDEFINED_CONTAINER={findByKey:function(e,n){var i;return i=n?r.LUNAR_PREDEFINEDS:r.PREDEFINEDS,t.findWhere(i,{key:e})},findByScheduleRecurrenceModel:function(e,n,i){return t.find(i?r.LUNAR_PREDEFINEDS:r.PREDEFINEDS,(function(i){var s=t.extend({interval:1},i.recurrence(o(n))),a=e.toJSON();return a.interval||(a.interval=1),s.freq===a.freq&&s.interval===a.interval&&l(s.byMonthDay,a.byMonthDay)&&l(s.byDay,a.byDay)}))},createPredefined:function(e,n,i){var o=t.findWhere(r.PREDEFINEDS,{key:e});return o?new r(t.extend({},o.recurrence(n),{until:i})):null}},r.EDIT_TYPE={ONE_ONLY:"ONE_ONLY",FUTURE:"FUTURE",ALL:"ALL"},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(52),s=n(153),a=n(540),r=[s.GROUP_BAND_POST_DETAIL,s.GROUP_BAND_ATTACHMENT_FOLDER];return{makeAttachmentTag:function(e,t){return e=o.decamelize(e),i.template('<band:attachment type="<%= type %>"<% if(!!id) { %> id="<%= id %>"<% } %> />')({type:e,id:t})},prepareSnippetForCopying:function(e){var n=(e.attachment||{}).snippet,o=[];return i.each(n,(function(e,t){var s=e.url;if(i.some(r,(function(e){return e.isMatched(s)}))){var l=a.getSnippet(s).then((function(e){n[t]=e}));o.push(l)}}),this),t.when.apply(t,o)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(16),o=n(9),s=n(570);function a(e,t){return t?!!e.endAt&&i.tz(e.endAt,t).isValid():!!e.endAt&&i(e.endAt).isValid()}function r(e,t){return!!a(e,t)&&(t?!i.tz(e.startAt,t).isSame(i.tz(e.endAt,t),"day"):!i(e.startAt).isSame(i(e.endAt),"day"))}function l(e,t,n,i){return n=n||"short_weekday",(i?o.format.dateByTimezone(e,n,i):o.format.date(e,n))+(t?" ("+t+")":"")}function c(e,t){return t?o.format.timeByTimezone(e,"hour_minute",t):o.format.time(e,"hour_minute")}return{makeScheduleTimeOfDailyMessage:function(e,t){var n=i(e.startAt||e.start_at),a=e.endAt||e.end_at,r=e.isAllDay||e.is_all_day;return a&&(a=i(a)),r?o.message("web.bandcalendar.schedulelist.label.scheduletime_allday"):s.getContinuationSchedulesLength({startAt:e.startAt||e.start_at,endAt:e.endAt||e.end_at})>=1?t.isSame(n,"day")?o.message("web.bandcalendar.schedulelist.label.scheduletime_start_at",{start_at:n}):t.isSame(a,"day")?o.message("web.bandcalendar.schedulelist.label.scheduletime_end_at",{end_at:a}):o.message("web.bandcalendar.schedulelist.label.scheduletime_allday"):a&&t.isSame(n,"day")&&t.isSame(a,"day")?o.message("web.bandcalendar.schedulelist.label.scheduletime_start_at.widthout_text",{start_at:n})+" - "+o.message("web.bandcalendar.schedulelist.label.scheduletime_end_at.widthout_text",{end_at:a}):t.isSame(n,"day")?o.message("web.bandcalendar.schedulelist.label.scheduletime_start_at.widthout_text",{start_at:n}):void 0},multilineMessage:function(e,n){n=n||{},t.defaults(n,{showAllDayTextWhenSingleDay:!1,dateFormatType:"year_month_day"});var s,d,u,h,p=n.timeZone,m=a(e,p),_=r(e,p),g=function(e){return e.isAllDay}(e),f=function(e){return e.isLunar}(e);p?(s=i.tz(e.startAt,p),d=i.tz(e.endAt,p)):(s=i(e.startAt),d=i(e.endAt));var b=e.lunarDateString,v=e.lunarEndDateString;return m?_?g?(u=l(s,f?b:null,n.dateFormatType,p)+" -",h=l(d,f?v:null,n.dateFormatType,p)):(u=l(s,f?b:null,n.dateFormatType,p)+" "+c(s,p)+" -",h=l(d,f?v:null,n.dateFormatType,p)+" "+c(d,p)):g?(u=l(s,f?b:null,n.dateFormatType,p)+" "+(n.showAllDayTextWhenSingleDay?o.message("web.schedule.time.text.allday"):""),h=""):(u=l(s,f?b:null,n.dateFormatType,p),h=c(s,p)+" - "+c(d,p)):g?(u=l(s,f?b:null,n.dateFormatType,p)+" "+(n.showAllDayTextWhenSingleDay?o.message("web.schedule.time.text.allday"):""),h=""):(u=l(s,f?b:null,n.dateFormatType,p)+" "+c(s,p),h=""),[u,h]},multilineMessageForString:function(e,t){if(e.isDelete)return"";var n=this.multilineMessage(e,t);return n?n.join(" "):""},upcomingMessage:function(e,t,n){return t&&r({startAt:e,endAt:t})?n?[IM("web.schedule.time.text.allday"),o.format.date(i(t),"month_day")].join(" - "):[o.format.time(i(e),"hour_minute"),o.format.date(i(t),"month_day_time")].join(" - "):n?IM("web.schedule.time.text.allday"):o.format.time(i(e),"hour_minute")},formatScheduleTime:function(e){var t=e.get("startAt"),n=e.get("endAt"),s=e.get("isAllDay"),l=r({startAt:t,endAt:n}),c=a({endAt:n});return l?s?[IM("web.schedule.time.text.allday"),o.format.date(i(n),"month_day")].join(" - "):[o.format.time(i(t),"hour_minute"),o.format.date(i(n),"month_day_time")].join(" - "):s?IM("web.schedule.time.text.allday"):c?[o.format.time(i(t),"hour_minute"),o.format.time(i(n),"hour_minute")].join(" - "):o.format.time(i(t),"hour_minute")}}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(664),a=n(665),r=n(13);return new(o.Object.extend({initialize:function(){this._contentCreationPunishmentInfo=null,this._expires=0},fetchContentCreationPunishmentInfo:function(){var e=(new Date).getTime();return!r.isLogedIn()||this._contentCreationPunishmentInfo&&this._expires>e?t.when():s.getContentCreationPunishmentInfo().then(i.bind((function(t){this._contentCreationPunishmentInfo=new a(t,{parse:!0}),this._expires=e+3e5}),this))},isContentCreationPunished:function(){return null!=this._contentCreationPunishmentInfo&&this._contentCreationPunishmentInfo.isPunished()},getContentCreationPunishmentInfo:function(){return this._contentCreationPunishmentInfo.clone()}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(152);function o(e){return i.isDimRequired({isRestricted:e.get("isRestricted"),isMutedAuthorPost:e.isMutedAuthorPost(),isVisibleOnlyToAuthor:e.get("isVisibleOnlyToAuthor")})}t.hasRestriction=function(e){return e.get("isRestricted")||e.isMutedAuthorPost()||e.get("isVisibleOnlyToAuthor")},t.isStateDimCovered=o,t.hideAllMoreOption=o},,function(e,t,n){var i=n(10),o=n(43),s=n(6),a=n(152),r=n(501),l=n(742),c=n(530),d=n(709),u=n(708),h=n(689),p=n(490),m=n(690),g=n(493),f=n(160),b=n(803),v=c.VIEWER_STATES,A=h.extend({attachmentType:a.POST_ATTACHMENT_TYPE.QUIZ,initialize:function(){_.isFunction(h.prototype.initialize)&&h.prototype.initialize.apply(this,arguments)},setJSON:function(e){(e=_.clone(e)).takers=u.createFromAPI(e.takers),e.managers=new s.Collection(e.managers,{model:r}),e.questions=d.build(e.questions),this.set(e)},toJSON:function(){return p.toRecursiveJSON(this)},toJSONForSave:function(){var e={quiz_id:this.get("quizId"),title:this.get("title"),questions:this.get("questions").toJSONForSave(),start_at:this.get("startAt")||Date.now(),end_at:this.get("endAt"),time_zone_id:this.get("timeZoneId"),is_random_order_test:this.get("isRandomOrderTest"),is_answer_essential:this.get("isAnswerEssential"),takers:this.get("takers").toJSONForSave()};return this.getManagers().length>0&&(e.managers=this.getManagers().map((function(e){return{user_no:e.getUserNo()}}))),e},isValid:function(){var e=this.toJSONForSave();return!i.isBlank(e.title)&&!_.isEmpty(e.questions)},isTakenMemberExist:function(){return this.get("takenMemberCount")>0},getTimeZoneId:function(){return this.get("timeZoneId")},getStartAt:function(){return this.get("startAt")},getEndAt:function(){return this.get("endAt")},isBeforeStart:function(){return Date.now()<this.get("startAt")},getQuestions:function(){return this.get("questions")},getQuestionCount:function(){return this.getQuestions().length},getAuthor:function(){return this.get("author")},getTakers:function(){return this.get("takers")},getViewingTakerModel:function(){return this.get("takers").find(_.bind((function(e){return e.get("taker").getUserNo()===this._loginUserNo}),this))},addTakers:function(e){e instanceof s.Collection&&(e=e.map(_.identity)),this.get("takers").addTakers(e),this.trigger("changeTakers")},removeTaker:function(e){this.get("takers").removeTaker(e),this.trigger("changeTakers")},removeAllTakers:function(){this.get("takers").reset([]),this.trigger("changeTakers")},resetAsDefaultTakers:function(e){return this.removeAllTakers(),g.getBandMembersOfBandWithFilter(e.getBandNo(),f.QUIZ).then(_.bind((function(e){this.addTakers(_.map(e.members,(function(e){return new r(e,{parse:!0})})))}),this))},getManagers:function(){return this.get("managers")},addManagers:function(e){this.get("managers").add(e,{parse:!0}),this.trigger("changeManagers")},removeManager:function(e){_.isNumber(e)&&(e=this.get("managers").where({userNo:e})),this.get("managers").remove(e),this.trigger("changeManagers")},getViewerState:function(){return this.get("viewerState")},getViewerTakenAt:function(){return this.get("viewerTakenAt")},isViewerStateNotTaken:function(){return this.getViewerState()===v.NOT_TAKEN_YET},isViewerStateTaken:function(){return this.getViewerState()===v.ALREADY_TAKEN},isViewerStateGraded:function(){return this.getViewerState()===v.GRADED},isTakable:function(){return this.isTakerViewer()&&this.isViewerStateNotTaken()&&!this.isQuizStateEnded()},isPossibleToOpenGradeWithReview:function(){return this.getQuestions().some((function(e){return!e.isEssayQuestion()}))},isReviewable:function(){return this.isTakerViewer()&&this.isViewerStateGraded()&&this.isReviewEnabled()&&!this.isReviewOfViewerDisabled()},isTakersEmpty:function(){return this.get("takers").isEmpty()},fetchQuizModel:function(){var e=this.get("bandNo"),t=this.get("postNo"),n=this.get("quizId");return l.getQuiz(e,t,n).then(_.bind((function(e){return this.set(this.parse(e.quiz)),this}),this))},openQuizGrade:function(e){var t=this.get("bandNo"),n=this.get("postNo"),i=this.get("quizId");return l.openQuizGrade(t,n,i,e).then(_.bind(this.fetchQuizModel,this))},endQuiz:function(){var e=this.get("bandNo"),t=this.get("postNo"),n=this.get("quizId");return l.endQuiz(e,t,n)}});A.deleteNeedlessForWriteFromAPIJSON=function(e){delete e.quiz_id,delete e.post_no,delete e.viewer_state,delete e.viewer_taken_at,delete e.taken_member_count,delete e.grade_opened_at,delete e.author},A.prepareApiResponseForCopy=function(e){A.deleteNeedlessForWriteFromAPIJSON(e),delete e.start_at,e.end_at=o().add(c.DEFAULT_PERIOD_RANGE_BY_DAY,"day").valueOf(),e.takers=[],delete e.managers,_.each(e.questions,m.prepareApiResponseForCopy)},A.setModelsDefaultTakers=function(e,t){return b.doAsyncJobsSequencial(e,(function(e){return e.resetAsDefaultTakers(t)}))},A.createQuizModel=function(e,t,n){return new A({bandNo:e,postNo:t,quizId:n})},e.exports=A},function(e,t,n){var i;void 0===(i=function(e){n(0);var t=n(21),i="/v2.0.0/get_band_email_verification",o="/v2.0.0/set_band_email_verification",s="/v2.0.0/check_band_email_verification_domains",a="/v2.0.0/resend_band_email_verification",r="/v2.0.0/verify_member_email",l="/v2.0.0/get_member_email",c="/v2.0.0/check_member_email";return{getBandEmailVerification:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+i,data:{band_no:e}})},checkBandEmailVerificationDomains:function(e){return e=e||[],t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+s,data:{email_verification_domains:e.join(",")}})},setBandEmailVerification:function(e,n){return n=n||[],t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o,data:{band_no:e,email_verification_domains:n.join(",")},method:"POST"})},resendBandEmailVerification:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+a,data:{band_no:e,days_passed:n},method:"POST"})},verifyMemberEmail:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+r,data:{band_no:e,email_verification_token:n},method:"POST"})},getMemberEmail:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+l,data:{band_no:e}})},checkMemberEmail:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+c,data:{band_no:e,email:n}})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0);return{idAttribute:"commentId",getPostNo:function(){return this.get("postNo")},getPhotoNo:function(){return this.get("photoNo")},getScheduleId:function(){return this.get("scheduleId")},getContentType:function(){return this.get("contentType")},getOriginCommentId:function(){return this.get("originCommentId")},getCommentId:function(){return this.get("commentId")},getAuthorName:function(){return this._getAuthor().name},isCertifiedAuthor:function(){return this._getAuthor().memberCertified},isMutedAuthorComment:function(){return this._getAuthor().isMuted},getAuthorRealName:function(){return this._getAuthor().realName},getAuthorNickname:function(){return this._getAuthor().description},getAuthorThumbnail:function(){return this._getAuthor().profileImageUrl},getAuthorMemberType:function(){return this._getAuthor().memberType},getAuthorUserNo:function(){return this._getAuthor().userNo},getAuthorRole:function(){return this._getAuthor().role},getBody:function(){return this.get("body")},isRestricted:function(){return this.get("isRestricted")},isVisibleOnlyToAuthor:function(){return this.get("isVisibleOnlyToAuthor")||!1},isSecret:function(){return this.get("isSecret")},isSecretKnownToViewer:function(){return this.get("isSecretKnownToViewer")},getCreatedAt:function(){return this.get("createdAt")},getStickerImageUrl:function(){return this._getSticker().imageUrl},getStickerImageWidth:function(){return this._getSticker().imageWidth},getStickerImageHeight:function(){return this._getSticker().imageHeight},getStickerPackNo:function(){return this._getSticker().packNo},getStickerId:function(){return this._getSticker().stickerId},getStickerResourceType:function(){return this._getSticker().resourceType},getSnippetDescription:function(){return this._getSnippet().description},getSnippetDomain:function(){return this._getSnippet().domain},getSnippetImage:function(){return this._getSnippet().image},getSnippetTitle:function(){return this._getSnippet().title},getSnippetType:function(){return this._getSnippet().type},getSnippetUrl:function(){return this._getSnippet().url},isSnippetExist:function(){return!t.isEmpty(this._getSnippet())},getAudioDuration:function(){return this.get("audioDuration")},getVideoThumbnail:function(){return this.getVideo().logoImage},getVideoWidth:function(){return this.getVideo().width},getVideoHeight:function(){return this.getVideo().height},isGifVideo:function(){return 1==this.getVideo().isGif},getVideoExpiresAt:function(){return this.getVideo().expiresAt},getVideo:function(){return this.get("video")||{}},getPhotos:function(){return this.get("photos")||[]},getPhotoCount:function(){return this.getPhotos().length},getEmotionCount:function(){return this.get("emotionCount")},getCommonEmotionType:function(){return this.get("commonEmotionType")},getEmotionTypeByViewer:function(){return t.propertyOf(this.get("emotionByViewer"))("type")},_getAuthor:function(){return this.get("author")||{}},_getSticker:function(){return this.get("sticker")||{}},_getImage:function(){return this.get("image")||{}},_getSnippet:function(){return this.get("snippet")||{}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(10),s=n(82),a=n(156),r=n(606),l=n(175),c=n(84),d=n(605),u=n(550),h=n(173);function p(e,t){if(e)if(e=b(e),e=s.makeDownloadUrl(e),t){var n=new XMLHttpRequest;n.open("GET",s.makeOriginalCorsUrl(e),!0),n.timeout=6e4,n.responseType="blob",n.onload=function(){if(200===this.status){var i=n.getResponseHeader("Content-Type"),o=new Blob([this.response],{type:i});r.saveAs(o,f(e,t))}else _(e)},n.onerror=function(){_(e)},n.ontimeout=function(){_(e)},n.send()}else _(e)}function m(e,t,o){e&&(i.isFunction(e)&&(e=e()),i.isString(e)?_(g(e,o)):e.then((function(e){var s=e.download||{},a=s.gif,r=s[u.QUALITY_480];if(a)p(a,o);else if(i.isEmpty(r))!function(e){if(window.isDesktopView)return void alert(e);n.e(17).then(n.t.bind(null,614,7)).then((function(t){t.openSimpleAlert(e)}))}(IM("web.imageviewer.alert.txt.encoding_progress_video"));else{var l=g(r,o);t?function(e){if(window.isDesktopView)return confirm(e)?d.resolve():d.reject();return n.e(17).then(n.t.bind(null,614,7)).then((function(t){return t.openPromiseTypeSimpleConfirm(e)}))}(IM("ui.confirm.download_gif_video")).then((function(){_(l)}),(function(){})):_(l)}})))}function _(e){window.isMobileView?l.go(e):c.download(e)}function g(e,t){t=f(e=b(e),t,"BandVideo");var n=-1===e.indexOf("?")?"?":"&";return e+n+"ctype=down&filename="+encodeURIComponent(encodeURIComponent(t))}function f(e,t,n){t=function(e,t){if(e=o.trim(e))return a.convertToSafeFileNameAgainstOS(e);return t}(t,n);var i=a.getFileExtension(e);return i&&(i="."+i,!o.endsWith(t.toLowerCase(),i))?t+i:t}function b(e){return h.convertToSafeURI(e)}n(591);var v={downloadPhoto:function(e,t){p(e,t)},downloadVideo:function(e,t,n){m(e,t,n)}};e.exports=v},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(21);return{getContentCreationPunishmentInfo:function(){return t.createLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_content_creation_punishment_info"})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0);return n(6).Model.extend({defaults:{code:null,message:null,description:null,penaltyStart:null,penaltyEnd:null,penaltyReason:null,penaltyContent:null,reportedBand:null,language:null},parse:function(e){var n=e.content_punishment_detail_payload;return t.extend({code:n.code,message:n.message},n.result)},isPunished:function(){var e=(new Date).getTime();return 0===this.get("code")&&this.get("penaltyStart")<=e&&e<this.get("penaltyEnd")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(13),s=n(545),a=n(635),r=n(52),l=t.Model.extend({idAttribute:"calendar_id",defaults:{bandNo:null,type:"internal",calendarId:null,color:"",name:"",url:null,isDefault:!1,status:null,serviceProvider:null,refreshedAt:null,isCalendarOwner:!1},parse:function(e){e=r.camelizeKeys(e);var t={};return t.bandNo=e.bandNo,t.type=e.type,t.calendarId=e.calendarId,t.color=e.color,t.name=e.name,e.url&&(t.url=e.url),e.isDefault&&(t.isDefault=e.isDefault),e.status&&(t.status=e.status),e.serviceProvider&&(t.serviceProvider=e.serviceProvider),e.refreshedAt&&(t.refreshedAt=e.refreshedAt),e.owner&&(t.isCalendarOwner=o.getUserData().getUserNo()===e.owner.userNo),t},setStatusError:function(){this.set({status:"error"})},toJSONForSave:function(){var e={band_no:this.get("bandNo"),type:this.get("type"),calendar_id:this.get("calendarId"),color:this.get("color"),name:this.get("name"),is_default:this.get("isDefault")};return this.get("status")&&(e.status=this.get("status")),this.get("serviceProvider")&&(e.service_provider=this.get("serviceProvider")),e},createCalendar:function(e){var t={type:e.type?e.type:this.get("type"),name:e.name,color:e.color};return e.type==s.TYPE.EXTERNAL&&(t=i.extend(t,{url:e.url})),a.createCalendar(this.get("bandNo"),t).then(i.bind((function(e){var t=e.calendar;return this.set(this.parse(t)),this}),this))},updateCalendar:function(e){var t=this.get("bandNo"),n=this.get("calendarId"),o=this.get("isDefault"),s={type:e.type?e.type:this.get("type"),name:e.name,color:e.color};return a.updateCalendar(t,n,o,s).then(i.bind((function(e){var t=e.calendar;this.set(this.parse(t))}),this))},deleteCalendar:function(e){return a.deleteCalendar(this.get("bandNo"),e).then(i.bind((function(){this.destroy()}),this))},clearDefaultCalendar:function(){return a.clearDefaultCalendar(this.get("bandNo")).then(i.bind((function(){return this.getCalendarPersonalNotice()}),this))},getCalendarPersonalNotice:function(){return a.getCalendarPersonalNotice(this.get("bandNo")).then(i.bind((function(e){return e.calendar_personal_notice}),this))},getType:function(){return this.get("type")},isInternalCalendar:function(){return this.getType()===s.TYPE.INTERNAL},isExternalCalendar:function(){return this.getType()===s.TYPE.EXTERNAL},getServiceProvider:function(){return this.get("serviceProvider")}});return l.createNewCalendar=function(e){return new l({bandNo:e,parse:!0})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(52),o=n(6),s=n(489),a=n(714),r=n(501),l=n(868),c=n(13),d=n(152),u=n(532),h=u.ATTENDANCE_CHECK_STATE,p=s.extend({constructor:function(e,t){(t=t||{}).parse=!0,s.apply(this,[e,t])},attachmentType:d.POST_ATTACHMENT_TYPE.ATTENDANCE_CHECK,idAttribute:"attendanceCheckId",defaults:function(){return{title:"",attendees:new l(null),managers:new o.Collection(null,{model:r}),isCheckableOnlyByManagers:!1,orderBy:"name",supportedStates:[h.CHECKED,h.UNCHECKED],attendanceVisibleQualification:u.ATTENDANCE_VISIBLE_QUALIFICATION.ALL,isAttendanceVisibleToViewer:null,attendanceCheckId:"",attendeeCount:0,managerCount:0,checkedAttendeeCount:0,postNo:null,endedAt:null,createdAt:null,startAt:null,timeZoneId:null}},parse:function(e,n){var s=(e=i.camelizeKeys(e)).managers||[],a=e.attendees||[],c={title:e.title,isCheckableOnlyByManagers:e.isCheckableOnlyByManagers,orderBy:e.orderBy,attendanceVisibleQualification:e.attendanceVisibleQualification,isAttendanceVisibleToViewer:e.isAttendanceVisibleToViewer,attendanceCheckId:e.attendanceCheckId,attendeeCount:e.attendeeCount,checkedAttendeeCount:e.checkedAttendeeCount,postNo:e.postNo,createdAt:e.createdAt,endedAt:e.endedAt,startAt:e.startAt,timeZoneId:e.timeZoneId,managerCount:s.length,managers:new o.Collection(s,{model:r,parse:!0}),attendees:new l(a,{parse:!0})};return t.isEmpty(e.supportedStates)||(c.supportedStates=t.intersection(t.values(h),e.supportedStates)),c},setJSONForUpdate:function(e,n){n=i.camelizeKeys(n);this.set("title",n.title),this.set("orderBy",this.defaults().orderBy),this.set("supportedStates",n.supportedStates),this.set("isCheckableOnlyByManagers",n.isCheckableOnlyByManagers),this.set("attendanceVisibleQualification",n.attendanceVisibleQualification);var s=n.attendees||[];this.set("attendeeCount",n.attendeeCount),this.set("attendees",new l(s,{parse:!0}));var a=n.managers||[];if(t.isEmpty(a)){var d=e.getMembershipMemberProfile();a.push({bandNo:e.getBandCore().bandNo,userNo:c.getUserData().getUserNo(),name:d.name,profileImageUrl:d.profileImageUrl,memberType:d.memberType})}this.set("managerCount",a.length),this.set("managers",new o.Collection(a,{model:r,parse:!0}))},validate:function(e,t){return e.title&&0!=e.title.trim().length?0==e.attendees.length?"More than one attendee is required.":0==e.managers.length?"More than one manager is required.":e.startAt&&t.startDateTimeValidation()?"Start date setting error":e.endedAt&&t.endDateTimeValidation()?"End date setting error":void 0:"Title is mandatory."},toJSONForSave:function(e){var n={};return e||(n.attendance_check_id=this.get("attendanceCheckId")),(n=t.extend(n,{title:this.get("title"),order_by:this.get("orderBy"),is_checkable_only_by_managers:this.get("isCheckableOnlyByManagers"),ended_at:this.get("endedAt"),start_at:this.get("startAt"),time_zone_id:this.get("timeZoneId"),attendance_visible_qualification:this.get("attendanceVisibleQualification"),supported_states:this.get("supportedStates")})).managers=this.get("managers").map((function(e){return{user_no:e.get("userNo")}})),n.attendees=this.get("attendees").map((function(e){return e.toJSONForSave()})),n},hasCheckedMember:function(){return!!this.getAttendees().find((function(e){return e.isCheckStatus()}))},isAttendanceCheckManager:function(){return!(!c.isLogedIn()||t.isEmpty(this.get("managers")))&&null!=this.getManagers().findWhere({userNo:c.getUserData().getUserNo()})},isCheckableByAttendee:function(){var e=this.get("endedAt"),n=!e||e>t.now();return!this.get("isCheckableOnlyByManagers")&&n},getTitle:function(){return this.get("title")},getPostNo:function(){return this.get("postNo")},getAttendees:function(){return this.get("attendees")},getManagers:function(){return this.get("managers")},getAttendanceCheckId:function(){return this.get("attendanceCheckId")},getEndedAt:function(){return this.get("endedAt")},getStartAt:function(){return this.get("startAt")},getTimeZoneId:function(){return this.get("timeZoneId")},getAttendeeCount:function(){return this.get("attendeeCount")},getCheckedAttendeeCount:function(){return this.get("checkedAttendeeCount")},addCheckedAttendeeCount:function(e){this.set("checkedAttendeeCount",parseInt(this.getCheckedAttendeeCount())+e)},getAttendanceVisibleQualification:function(){return this.get("attendanceVisibleQualification")},setAttendanceVisibleQualification:function(e){return this.set("attendanceVisibleQualification",e)},isAttendanceVisibleToViewer:function(){return this.get("isAttendanceVisibleToViewer")},getSupportedStates:function(){return this.get("supportedStates")},getSupportedStatesExceptUnchecked:function(){return t.reject(this.getSupportedStates(),(function(e){return e===h.UNCHECKED}))},isOnlyCheckedStateSupported:function(){return 0===t.difference(this.getSupportedStates(),[h.CHECKED,h.UNCHECKED]).length}});return p.CONSTANTS={MAX_ATTENDEE_COUNT:1e3,MAX_MANAGER_COUNT:30},p.fetchAttendanceCheck=function(e,t,n){var i={band_no:e,post_no:t,attendance_check_id:n};return a.getAttendanceCheck(i).then((function(e){return new p(e.attendance_check)}))},p}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(2),o=n(1091),s=n(510),a=n(562),r=n(158),l=s.EVENTS,c=a.EVENTS,d={openConfirm:function(e){return o.create({modal:s.openLayer(e),confirm:l.CONFIRM,cancel:l.CANCEL})},openSimpleConfirm:function(e){return o.create({modal:this._createSimpleConfirm(e),confirm:l.CONFIRM,cancel:l.CANCEL})},openPromiseTypeSimpleConfirm:function(e){var t=i.Deferred();return this._createSimpleConfirm(e).once(l.CONFIRM,(function(){t.resolve()})).once(l.CANCEL,(function(){t.reject()})),t.promise()},_createSimpleConfirm:function(e){return s.openLayer({bodyTitle:r.nl2br(e),withoutHiding:!0})},_createSimpleAlert:function(e){return a.openLayer({bodyTitle:r.nl2br(e),withoutHiding:!0})},openSimpleAlert:function(e){return o.create({modal:this._createSimpleAlert(e),confirm:c.CONFIRM})},openPromiseTypeSimpleAlert:function(e){var t=i.Deferred();return this._createSimpleAlert(e).once(c.CONFIRM,(function(){t.resolve()})),t.promise()},openApiErrorAlert:function(e){var t=e?e.result_data:null,n=t?t.message:null;n&&this.openSimpleAlert(n)}};e.exports=d},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(155),s=n(516),a={PLAYING:"playing",TIMEUPDATE:"timeupdate",PAUSE:"pause",ENDED:"ended",WAITING:"waiting",SEEKING:"seeking",SEEKED:"seeked"},r=t.values(a).join(" "),l={};return i.Behavior.extend({initialize:function(e){this._videoSelector=e.videoSelector,this._bandNo=e.bandNo,this._videoId=e.videoId,this._postNo=e.postNo,this._photoNo=e.photoNo,this._bandData=o.get(this._bandNo),this._video=null,this._videoEventHandler=t.bind(this._handleVideoEvent,this),this._viewingId=this._bandNo+"_"+this._videoId,this._videoState=null,this._videoCurrentTime=null,this._videoDuration=null,this._loggingInterval=6e4,this._nextLoggingTime=0,this._intervalStartTime=0,this._videoEventTime=0},onDomRefresh:function(){this._startLogging()},onBeforeRender:function(){this._stopLogging()},onBeforeDetach:function(){this._stopLogging()},_stopLogging:function(){this._video&&(this._handlePause(),this._video.off(r,this._videoEventHandler),this._video=null)},_startLogging:function(){this._bandData.loadBandData().then(t.bind((function(){if(this._isLoggable()){var e=this.view.$(this._videoSelector);e.length>0&&(this._video=e,this._video.on(r,this._videoEventHandler))}}),this))},_isLoggable:function(){return!!this._bandData.canLogVideoWatchingProgress()&&(!!this._videoId&&!(!this._postNo&&!this._photoNo))},_handleVideoEvent:function(e){this._videoEventTime=t.now();var n=e.target;switch(this._videoCurrentTime=n.currentTime||0,this._videoDuration=n.duration||0,e.type){case a.PLAYING:this._handlePlaying();break;case a.TIMEUPDATE:this._handleTimeupdate();break;case a.PAUSE:this._handlePause();break;case a.ENDED:this._handleEnded();break;case a.WAITING:case a.SEEKING:this._handleWaiting();break;case a.SEEKED:this._handleSeeked()}},_handlePlaying:function(){if(!this._isPlaying()){this._videoState=a.PLAYING;var e=this._restoreViewingTime();this._intervalStartTime=this._videoEventTime-e,this._nextLoggingTime=this._intervalStartTime+this._loggingInterval}},_handleTimeupdate:function(){this._isSeeked()&&this._handlePlaying(),this._isPlaying()&&(this._videoCurrentTime<=0||this._videoDuration<=0||this._videoCurrentTime>=this._videoDuration||this._nextLoggingTime<=this._videoEventTime&&(this._sendLog(),this._intervalStartTime=this._nextLoggingTime,this._nextLoggingTime=this._intervalStartTime+this._loggingInterval))},_handlePause:function(){this._isPlaying()&&(this._videoCurrentTime>=this._videoDuration?this._handleEnded():(this._videoState=a.PAUSE,this._saveViewingTime(),this._sendLog()))},_handleEnded:function(){this._isPlaying()&&(this._videoState=a.ENDED,this._videoCurrentTime=this._videoDuration,this._sendLog(),this._clearViewingTime())},_handleWaiting:function(){this._isPlaying()&&(this._videoState=a.WAITING,this._saveViewingTime())},_handleSeeked:function(){this._isWaiting()&&(this._videoState=a.SEEKED)},_isPlaying:function(){return this._videoState===a.PLAYING},_isEnded:function(){return this._videoState===a.ENDED},_isWaiting:function(){return this._videoState===a.WAITING},_isSeeked:function(){return this._videoState===a.SEEKED},_sendLog:function(){if(!(this._videoCurrentTime<=0||this._videoDuration<=0)){var e={bandNo:this._bandNo,postNo:this._postNo,photoNo:this._photoNo,videoId:this._videoId,percentage:this._getPercentage(),thisTimePercentage:this._getThisTimePercentage()};s.viewVideo(e).fail((function(){s.viewVideo(e)}))}},_getPercentage:function(){if(this._isEnded())return 100;var e=Math.floor(this._videoCurrentTime/this._videoDuration*100);return Math.min(e,100)},_getThisTimePercentage:function(){var e=1e3*this._videoDuration,t=0;if(this._isPlaying())t=Math.ceil(this._loggingInterval/e*100);else if(this._isEnded()){var n=this._videoEventTime-this._intervalStartTime+300;t=Math.floor(n/e*100)}return Math.min(t,100)},_restoreViewingTime:function(){var e=l[this._viewingId];return this._clearViewingTime(),e||0},_clearViewingTime:function(){delete l[this._viewingId]},_saveViewingTime:function(){var e=this._videoEventTime-this._intervalStartTime;this._clearViewingTime(),e>0&&(l[this._viewingId]=e)}})}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(52),o=n(6),s=n(829),a=n(490),r=n(692),l="multiple_choice",c="essay",d=o.Model.extend({initialize:function(e,t){},parse:function(e,t){var n=i.camelizeKeys(e);return n.type===l&&(n.choices=s.build(e.choices)),n},toJSON:function(){return a.toRecursiveJSON(this)},toJSONForSave:function(e){e=e||{};var t={type:this.getType(),title:this.getTitle(),is_response_essential:this.isResponseEssential()},n=this.getQuestionId();!e.copy&&n&&(t.question_id=n);var i=this.getImage();return i&&(t.image=i),this.isMultipleChoiceType()&&(t.choices=this.getChoices().toJSONForSave(e),t.is_other_choice_enabled=this.isOtherChoiceEnabled(),t.is_multiple_choices_enabled=this.isMultipleChoicesEnabled()),this.isEssayType()&&(t.is_attachment_enabled=this.isAttachmentEnabled()),t},getQuestionId:function(){return this.get("questionId")},getType:function(){return this.get("type")},getTitle:function(){return this.get("title")},getImage:function(){return this.get("image")},getChoices:function(){return this.get("choices")},isAttachmentEnabled:function(){return!0===this.get("isAttachmentEnabled")},isOtherChoiceEnabled:function(){return!0===this.get("isOtherChoiceEnabled")},isMultipleChoicesEnabled:function(){return!0===this.get("isMultipleChoicesEnabled")},isResponseEssential:function(){return!0===this.get("isResponseEssential")},isMultipleChoiceType:function(){return this.getType()===l},isEssayType:function(){return this.getType()===c},getQuestionNumber:function(){return this._questionNumber},setQuestionNumber:function(e){this._questionNumber!==e&&(this._questionNumber=e,this.trigger("survey-question:number"))},copyQuestion:function(){var e=this.toJSONForSave({copy:!0});return new d(e,{parse:!0})},setMultipleChoiceValues:function(e){this.set({title:e.title,image:e.image,isOtherChoiceEnabled:e.isOtherChoiceEnabled,isMultipleChoicesEnabled:e.isMultipleChoicesEnabled,isResponseEssential:e.isResponseEssential}),this.getChoices().reset(e.choices.toJSONForSave(),{parse:!0}),this.trigger("survey-question:update")},setEssayValues:function(e){this.set({title:e.title,image:e.image,isAttachmentEnabled:e.isAttachmentEnabled,isResponseEssential:e.isResponseEssential}),this.trigger("survey-question:update")}});return d.prepareApiResponseForCopy=function(e){delete e.question_id,t.each(e.choices,r.prepareApiResponseForCopy)},d.buildChoiceType=function(){return new d({type:l,title:""},{parse:!0})},d.buildEssayType=function(){return new d({type:c,title:""},{parse:!0})},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(0),n(2),n(6),n(4),n(579)],void 0===(o=function(e,t,n,i,o){var s=n.Model.extend({idAttribute:"no",getNo:function(){return this.get("no")},getName:function(){return this.get("name")},getDescription:function(){return this.get("description")},getType:function(){return this.get("type")},isActive:function(){return this.get("isActive")},isNew:function(){return this.get("isActive")},getDisplayOrder:function(){return this.get("displayOrder")}});s.buildStickerPackData=function(e){return new s({no:e.basic.no,name:e.basic.name,description:e.basic.description,type:e.basic.type,isActive:e.user.is_active||!1,isNew:e.user.is_new||!1,displayOrder:e.user.display_order||99999})};var a=n.Collection.extend({comparator:"displayOrder",model:s,initialize:function(){this._fetched=!1,this._loadingPromise=null},sync:function(){throw new Error("direct fetch(), save(), destroy() are not allowed.")},fetchStickerPackCollection:function(){return o.getUsingPack().then(e.bind((function(e){return this.setUsingPacks(e),this._fetched=!0,this}),this))},isLoading:function(){return!this._loadingPromise||"pending"===this._loadingPromise.state()},fetchCachedStickerPackCollection2:function(){return this._loadingPromise||(this._loadingPromise=this.fetchStickerPackCollection(),this.trigger("loading"),this._loadingPromise.then(e.bind((function(){this.trigger("loaded")}),this))),this._loadingPromise},fetchCachedStickerPackCollection:function(){return this._fetched?t.Deferred().resolve(this).promise():this.fetchStickerPackCollection()},setUsingPacks:function(t){var n=e.map(t,(function(e){return s.buildStickerPackData(e)}));this.set(n)}});return a.singletonBuildStickerUsingPackDataCollection=function(){return this._stickerUsingPackDataCollection||(this._stickerUsingPackDataCollection=new a),this._stickerUsingPackDataCollection},a}.apply(t,i))||(e.exports=o)},,,function(e,t,n){var i,o;i=[n(21)],void 0===(o=function(e){return{payBill:function(t,n,i){var o={band_no:t,post_no:n,target_user_no:i};return e.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/pay_bill",data:o}).then((function(e,t,n){return e.result_data.message}))},getBillSplit:function(t,n){return e.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_bill_split",data:{band_no:t,post_no:n}})}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(529),s=t.Model.extend({idAttribute:"missionId",defaults:{creator:null,title:null,description:null,missionId:null,startAt:null,timeZoneId:null,confirmFrequency:null,isManuallyEnded:null,goodExample:null,badExample:null,isDeleted:!1,isRestricted:!1},parse:function(e){return e=i.camelizeKeys(e),{creator:o.buildContentAuthorModel(e.creator),title:e.title,description:e.description,missionId:e.missionId,startAt:e.startAt,timeZoneId:e.timeZoneId,confirmFrequency:e.confirmFrequency,isManuallyEnded:e.isManuallyEnded,isDeleted:e.isDeleted,goodExample:e.goodExample,badExample:e.badExample,isRestricted:e.isRestricted}},getMissionId:function(){return this.get("missionId")},getMissionTitle:function(){return this.get("title")},isRestrictedPostMission:function(){return this.get("isRestricted")||!1},getPostMissionText:function(){return this.isRestrictedPostMission()?IM("band_mission.restricted"):this.getMissionTitle()},getPostMissionConfirmCompleteText:function(){return this.isRestrictedPostMission()?IM("band_mission.restricted"):IM("global_search.mission_proof_text",{title:this.getMissionTitle()})}});return s.convertBandMissionModelToMissionInfoForPostModelObj=function(e){var t=e.toJSON();return{creator:t.creator,title:t.title,description:t.description,missionId:t.missionId,startAt:t.startAt,timeZoneId:t.timeZoneId,confirmFrequency:t.confirmFrequency,isManuallyEnded:t.isManuallyEnded,isDeleted:t.isDeleted,goodExample:t.goodExample,badExample:t.badExample}},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(6),o=n(52),s=n(43),a=n(501),r=n(13),l=n(708),c=n(709),d=n(165),u=n(530),h=i.Model.extend({idAttribute:"quizId",defaults:function(){return{quizId:null,title:"",isRandomOrderTest:!1,isAnswerEssential:!1,isReviewOfViewerDisabled:!1,isReviewEnabled:!1,startAt:void 0,endAt:s().add(u.DEFAULT_PERIOD_RANGE_BY_DAY,"day").valueOf(),takers:l.createFromJSON([]),managers:new i.Collection(null,{model:a}),timeZoneId:d.getCurrentTimezoneId(),questions:c.build(),author:null,viewerState:null,takenMemberCount:0,gradeOpenedAt:null}},parse:function(e){var t={postNo:(e=o.camelizeKeys(e)).postNo,quizId:e.quizId,title:e.title,isRandomOrderTest:e.isRandomOrderTest,isAnswerEssential:e.isAnswerEssential,isReviewOfViewerDisabled:e.isReviewOfViewerDisabled,isReviewEnabled:e.isReviewEnabled,startAt:e.startAt,endAt:e.endAt,timeZoneId:e.timeZoneId,questions:c.build(e.questions),takers:l.createFromAPI(e.takers),managers:new i.Collection(e.managers||[],{model:a,parse:!0}),author:new a(e.author,{parse:!0}),viewerState:e.viewerState,viewerTakenAt:e.viewerTakenAt,takenMemberCount:e.takenMemberCount||0,gradeOpenedAt:e.gradeOpenedAt};return e.bandNo&&(t.bandNo=e.bandNo),t},isReviewOfViewerDisabled:function(){return this.get("isReviewOfViewerDisabled")},isReviewEnabled:function(){return this.get("isReviewEnabled")},isTakerViewer:function(){return!!this.get("takers").find(_.bind((function(e){return e.get("taker").getUserNo()===r.getUserData().getUserNo()}),this))},isAuthor:function(){return this.get("author").getUserNo()===r.getUserData().getUserNo()},isManagerViewer:function(){return!!this.isAuthor()||!!this.get("managers").find(_.bind((function(e){return e.getUserNo()===r.getUserData().getUserNo()}),this))},isQuizStateEnded:function(){return Number(this.get("endAt"))<Date.now()},isQuizStateOpened:function(){return _.isNumber(this.get("gradeOpenedAt"))&&this.get("gradeOpenedAt")<Date.now()},canEndQuiz:function(){return!this.isQuizStateEnded()&&this.isAuthor()},canAccessDetailAsTaker:function(){return!!this.isTakerViewer()&&(!this.isQuizStateEnded()||_.contains([u.VIEWER_STATES.ALREADY_TAKEN,u.VIEWER_STATES.GRADED],this.get("viewerState")))}});e.exports=h},function(e,t,n){var i=n(0),o=n(52),s=n(6),a=n(827),r=n(530),l=n(490),c=n(691),d="multiple_choice",u="essay",h=s.Model.extend({initialize:function(e,t){t=t||{},this._isShortAnswerType=!0===t.isShortAnswerType||!i.isEmpty(this.getCorrectEssayAnswers())},parse:function(e,t){var n=o.camelizeKeys(e);return n.choices=a.build(e.choices),n},toJSON:function(){return l.toRecursiveJSON(this)},toJSONForSave:function(e){e=e||{};var t={type:this.getType(),title:this.getTitle(),point:this.getPoint(),image:this._generateImageParameter(),video:this._generateVideoParameter(),file:this._generateFileParameter(),audio:this._generateAudioParameter()},n=this.getQuestionId();return!e.copy&&n&&(t.question_id=n),this.isMultipleChoiceQuestion()&&(t.choices=this.getChoices().toJSONForSave(e),t.has_multiple_correct_answers=this.hasMultipleCorrectAnswers()),this.isShortAnswerQuestion()&&(t.correct_essay_answers=this.getCorrectEssayAnswers()),this.isEssayQuestion()&&(t.is_attachment_enabled=this.isAttachmentEnabled()),t},_generateImageParameter:function(){return this._generateObjectParameter(this.getImage(),["url","width","height"])},_generateVideoParameter:function(){return this._generateObjectParameter(this.getVideo(),["sos_id","url","width","height","is_gif"])},_generateFileParameter:function(){return this._generateObjectParameter(this.getFile(),["file_name","file_size","sos_id","external_source","external_link"])},_generateAudioParameter:function(){return this._generateObjectParameter(this.getAudio(),["sos_id","audio_duration"])},_generateObjectParameter:function(e,t){if(i.isEmpty(e))return null;e=o.decamelizeKeys(e);for(var n={},s=0,a=t.length;s<a;s++){var r=t[s],l=e[r];null!=l&&(n[r]=l)}return i.isEmpty(n)?null:n},getQuestionId:function(){return this.get("questionId")},getType:function(){return this.get("type")},getTitle:function(){return this.get("title")},getImage:function(){return this.get("image")},getVideo:function(){return this.get("video")},getFile:function(){return this.get("file")},getAudio:function(){return this.get("audio")},getPoint:function(){return this.get("point")},getChoices:function(){return this.get("choices")},hasMultipleCorrectAnswers:function(){return!0===this.get("hasMultipleCorrectAnswers")},isAttachmentEnabled:function(){return!0===this.get("isAttachmentEnabled")},getCorrectEssayAnswers:function(){return this.get("correctEssayAnswers")},isMultipleChoiceQuestion:function(){return this.getType()===d},isShortAnswerQuestion:function(){return this.getType()===u&&this._isShortAnswerType},isEssayQuestion:function(){return this.getType()===u&&!this._isShortAnswerType},getQuestionNumber:function(){return this._questionNumber},setQuestionNumber:function(e){this._questionNumber!==e&&(this._questionNumber=e,this.trigger("question:number"))},copyQuestion:function(){return new h(this.toJSONForSave({copy:!0}),{parse:!0})},setValues:function(e){this.set({title:e.title,image:e.image,video:e.video,file:e.file,audio:e.audio,point:e.point,hasMultipleCorrectAnswers:e.hasMultipleCorrectAnswers,isAttachmentEnabled:e.isAttachmentEnabled,correctEssayAnswers:e.correctEssayAnswers}),this.isMultipleChoiceQuestion()&&this.getChoices().resetChoices(e.choices),this.trigger("question:update")},getCorrectAnswerNos:function(){var e=[];return this.getChoices().each((function(t,n){t.isCorrectAnswer()&&e.push(n+1)})),e},isCorrectChoiceIds:function(e){return i.isEmpty(i.difference(e,this._getCorrectChoiceIds()))},_getCorrectChoiceIds:function(){return this.getChoices().chain().filter((function(e){return e.isCorrectAnswer()})).map((function(e){return e.getChoiceId()})).value()},isCorrectShortAnswer:function(e){return i.contains(this.getCorrectEssayAnswers(),e)}});h.prepareApiResponseForCopy=function(e){delete e.question_id,i.each(e.choices,c.prepareApiResponseForCopy)},h.createChoiceType=function(){return new h({type:d,title:"",point:r.POINT_DEFAULT_VALUE,choices:[]},{parse:!0})},h.createShortAnswerType=function(){return new h({type:u,title:"",point:r.POINT_DEFAULT_VALUE,correct_essay_answers:[]},{parse:!0,isShortAnswerType:!0})},h.createEssayType=function(){return new h({type:u,title:"",point:r.POINT_DEFAULT_VALUE},{parse:!0})},e.exports=h},function(e,t,n){var i=n(52),o=n(6).Model.extend({idAttribute:"choiceId",initialize:function(e,t){},parse:function(e,t){return i.camelizeKeys(e)},toJSONForSave:function(e){e=e||{};var t={is_correct_answer:this.isCorrectAnswer()},n=this.getChoiceId();!e.copy&&n&&(t.choice_id=n);var o=this.getTitle();o&&(t.title=o);var s=this.getImage();return s&&(t.image=i.decamelizeKeys(s)),t},getChoiceId:function(){return this.get("choiceId")},getTitle:function(){return this.get("title")},setTitle:function(e){this.set("title",e)},getImage:function(){return this.get("image")},setImage:function(e){this.set("image",e)},isCorrectAnswer:function(){return!0===this.get("isCorrectAnswer")},setCorrectAnswer:function(e){this.set("isCorrectAnswer",e)},hasContent:function(){return!!this.getTitle()||!!this.getImage()}});o.prepareApiResponseForCopy=function(e){delete e.choice_id},e.exports=o},function(e,t,n){var i;void 0===(i=function(e){var t=n(52),i=n(6).Model.extend({idAttribute:"choiceId",initialize:function(e,t){this._other=!!t&&t.other},parse:function(e,n){return t.camelizeKeys(e)},toJSONForSave:function(e){e=e||{};var t={},n=this.getChoiceId();!e.copy&&n&&(t.choice_id=n);var i=this.getTitle();i&&(t.title=i);var o=this.getImage();return o&&(t.image=o),t},getChoiceId:function(){return this.get("choiceId")},getTitle:function(){return this.get("title")},setTitle:function(e){this.set("title",e)},getImage:function(){return this.get("image")},setImage:function(e){this.set("image",e)},hasContent:function(){return!!this.getTitle()||!!this.getImage()},isOtherChoice:function(){return!0===this._other}});return i.prepareApiResponseForCopy=function(e){delete e.choice_id},i.buildEmptyChoice=function(){return new i},i.buildOtherChoice=function(){return new i(null,{other:!0})},i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(6),o=n(501),s=n(490),a=n(52),r=i.Model.extend({parse:function(e){return{id:(e=a.camelizeKeys(e)).surveyee.userNo,respondedAt:e.respondedAt,surveyee:new o(e.surveyee,{parse:!0})}},toJSONForSave:function(){return{surveyee:{user_no:this.get("surveyee").getUserNo()}}},toJSON:function(){return s.toRecursiveJSON(this)},getRespondedAt:function(){return this.get("respondedAt")},isResponded:function(){return!!this.getRespondedAt()}});r.createFromSimpleMemberViewModel=function(e){return new r({surveyee:new o(e.toJSON())})},e.exports=r},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(13),o=n(82),s=n(163);return t.Model.extend({parse:function(e,t){var n=o.makeProfileThumbnailUrl(e.actor.profile_image_url);return{emotionIndex:e.index,emotionType:e.type,actorFaceThumb:n,profileInnerClass:o.makeProfileInnerClass(n),profileImageUrl:e.actor.profile_image_url,actorMemberType:e.actor.member_type,actorUserNo:e.actor.user_no,actorName:e.actor.name,actorRole:e.actor.role,isMutedActorEmotion:e.actor.is_muted,isMyEmotion:!!i.getUserData()&&i.getUserData().getUserNo()==e.actor.user_no}},isMutedActorEmotion:function(){return this.get("isMutedActorEmotion")},getActorMemberProfile:function(){return new s({name:this.get("actorName"),profileImageUrl:this.get("profileImageUrl"),memberType:this.get("actorMemberType")})},getActorUserNo:function(){return this.get("actorUserNo")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(0),n(2),n(6),n(4),n(579)],void 0===(o=function(e,t,n,i,o){var s=n.Model.extend({getPackNo:function(){return this.get("packNo")},getHeight:function(){return this.get("height")},getSpriteImgUrl:function(){return this.get("spriteImgUrl")},getStickerIdList:function(){return this.get("stickerIdList")},getWidth:function(){return this.get("width")},getSpriteBgSize:function(){return this.get("spriteBgSize")}});s.buildAsyncStickerSpritesData=function(e){return o.getSprite(e).then((function(e){return new s({packNo:e.packNo,width:e.width,height:e.height,spriteImgUrl:e.spriteImgUrl,stickerIdList:e.stickerIdList,spriteBgSize:Math.ceil(e.width/2)+"px auto"})}))};var a=n.Collection.extend({model:s,asyncFetchStickerSpritesData:function(n){var i=this.find((function(e){return e.getPackNo()==n}));return i?t.Deferred().resolve(i).promise():s.buildAsyncStickerSpritesData(n).then(e.bind((function(e){return this.add(e,{silent:!0}),e}),this))}});return a.singletonBuildStickerSpritesDataCollection=function(){return this._stickerSpritesDataCollection||(this._stickerSpritesDataCollection=new a),this._stickerSpritesDataCollection},a}.apply(t,i))||(e.exports=o)},function(e,t,n){var i,o;i=[n(2),n(0),n(4),n(192)],void 0===(o=function(e,t,n,i){var o=n.Object.extend({_SWF_PATH:window.scriptBaseUrl+"/_libs/jquery/plugin/jquery.jplayer.swf",initialize:function(e){this.el=e.element,this.audioFileUrl=e.audioFileUrl},bindAsyncEventListeners:function(){var n=e.Deferred(),i=this,o=this.audioFileUrl;return this.el.jPlayer({ready:t.bind((function(){this.el.jPlayer("setMedia",{m4a:o}),n.resolve(i)}),this),swfPath:this._SWF_PATH,supplied:"m4a"}),this._attachEventListener(),n},_attachEventListener:function(){this.el.on(e.jPlayer.event.play,t.bind((function(e){this.el.jPlayer("pauseOthers"),this.trigger("play",e.jPlayer)}),this)),this.el.on(e.jPlayer.event.pause,t.bind((function(e){this.trigger("pause",e.jPlayer)}),this)),this.el.on(e.jPlayer.event.stop,t.bind((function(e){this.trigger("stop",e.jPlayer)}),this)),this.el.on(e.jPlayer.event.ended,t.bind((function(e){this.trigger("ended",e.jPlayer)}),this)),this.el.on(e.jPlayer.event.timeupdate,t.bind((function(e){this.trigger("timeupdate",e.jPlayer)}),this)),this.el.on(e.jPlayer.event.error,t.bind((function(e){this.trigger("error",e.jPlayer)}),this))},play:function(){this.el.jPlayer("pauseOthers"),this.el.jPlayer("play")},pause:function(){this.el.jPlayer("pause")},stop:function(){this.el.jPlayer("stop")},onDestroy:function(){this.el&&(this.el.jPlayer("destroy"),this.el.off())}});return o.buildAsyncAudioPlayer=function(e,t){return new o({element:e,audioFileUrl:t}).bindAsyncEventListeners()},o}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(6),s=n(156),a="720p",r="480p",l=o.Model.extend({defaults:{videoId:null,sources:null,source:null,waitForEncoding:!1,waitForEncodingRetried:0,hasHighQuality:!1,isHighQuality:!1},initialize:function(e,t){this._fnSources=t.fnSources,this._sourceFetching=null,this._waitForEncodingRetryInterval=5e3,this._waitForEncodingRetryCount=3},_isEncodingCompletedSources:function(e){return!!e.download&&!!e.download[r]},isExpired:function(){return s.isExpiredFile(this.get("expiresAt"))},getExpiresAt:function(){return this.get("expiresAt")},getVideoId:function(){return this.get("videoId")},hasVideoId:function(){return!!this.getVideoId()},getSource:function(){return this.get("source")},hasSource:function(){return!i.isBlank(this.getSource())},hasHighQuality:function(){return!0===this.get("hasHighQuality")},isHighQuality:function(){return!0===this.get("isHighQuality")},resetSources:function(){this.set("source",null)},fetchSources:function(e){var t=e?a:r;this._fetchSources(t)},_fetchSources:function(e){this.isExpired()||this._sourceFetching||(this._sourceFetching=!0,this._fnSources().then(t.bind((function(n){if(this._isEncodingCompletedSources(n)){var i=n.download,o=i[e],s=!!o,l=!!i[a],c=e===a&&s;s||(o=i[r]),this.set({waitForEncodingRetried:0,waitForEncoding:!1,source:o,hasHighQuality:l,isHighQuality:c})}else this.get("waitForEncodingRetried")>this._waitForEncodingRetryCount?(this.set({waitForEncoding:!1,waitForEncodingRetried:0}),this.trigger("waitForEncodingAborted")):(this.set({waitForEncoding:!0,waitForEncodingRetried:this.get("waitForEncodingRetried")+1}),t.delay(t.bind(this._fetchSources,this,e),this._waitForEncodingRetryInterval))}),this)).always(t.bind((function(){this._sourceFetching=!1}),this)))},getVideoViewingProgressLoggingParameters:function(){return this._videoViewingProgressLoggingParameters},_setVideoViewingProgressLoggingParameters:function(e){this._videoViewingProgressLoggingParameters=e},enablePostVideoViewingProgressLogging:function(e,t,n){this._setVideoViewingProgressLoggingParameters({bandNo:e,postNo:t,videoId:n})},enablePhotoVideoViewingProgressLogging:function(e,t,n){this._setVideoViewingProgressLoggingParameters({bandNo:e,photoNo:t,videoId:n})}});return l.createVideoPlayerModel=function(e){return new l({videoId:e.videoId,expiresAt:e.expiresAt},{fnSources:e.sources})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(156);return{simpleCommentAttachFileAttrs:function(e){var n="sos"==e.getFileSource(),o="dropbox"==e.getFileSource(),s=t.contains(["one_drive","google_drive","icloud"],e.getFileSource()),a={isFileExist:n,isDropboxFileExist:o,isExternalFileExist:s};return n&&t.extend(a,{expiresAt:e.getExpires(),fileName:e.getFileName(),fileSiUnit:i.toStringFileSize(e.getFileSize()),fileSize:e.getFileSize()}),o&&t.extend(a,{isDropboxFileExist:o,dropboxFileLink:e.getFileLink(),dropboxFileName:e.getFileName(),dropboxFileSize:i.toStringFileSize(e.getFileSize())}),s&&t.extend(a,{isExternalFileExist:s,externalFileLink:e.getFileLink(),externalFileName:e.getFileName(),externalFileSize:i.toStringFileSize(e.getFileSize()),externalFileSource:e.getFileSource()}),a},makePunishTitle:function(e){switch(e.getPunishment()){case"punisher":return e.getPunisherName();case"prohibited_words":return IM("comment.hidden_by_prohibited_words")}return null}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0);return{removeAttrsIfMuteComment:function(e,n){return n?t.extend(e,{contents:IM("comment.muted_author_comment.guide_message"),isAudioExist:!1,audioDuration:null,showEmotionArea:!1,emotionCount:0,commonEmotionType:null,emotionTypeByViewer:null,translatable:!1,isPhotoExist:!1,photoUrl:null,originalPhotoUrl:null,isGif:!1,photoWidth:null,photoHeight:null,isFileExist:!1,expiresAt:null,fileName:null,fileId:null,fileSiUnit:null,fileSize:null,isDropboxFileExist:!1,dropboxFileLink:null,dropboxFileName:null,dropboxFileId:null,dropboxFileSize:null,isVideoExist:!1,videoThumbnail:null,videoId:null,videoWidth:null,videoHeight:null,isGifVideo:null,videoExpiresAt:null,isExternalFileExist:!1,externalFileLink:null,externalFileName:null,externalFileId:null,externalFileSize:null,externalFileSource:null,isStickerExist:!1,stickerImageUrl:null,aniStickerImageUrl:null,stickerPackNo:null,stickerId:null,stickerImageWidth:null,stickerImageHeight:null,stickerResourceType:null,convertedStickerWidth:null,convertedStickerHeight:null,isSnippetExist:!1,snippetDescription:null,snippetDomain:null,snippetImage:null,snippetTitle:null,snippetType:null,snippetUrl:null}):e}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(16);return function(){"use strict";var e=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n",n=[],i=[],o=["BEGIN:VCALENDAR","VERSION:2.0","CALSCALE:GREGORIAN"].join(e),s="END:VCALENDAR";return{addEvent:function(o){if(void 0===o.subject||void 0===o.description||void 0===o.location||void 0===o.timestamp||void 0===o.timezone||void 0===o.begin||void 0===o.end||void 0===o.uid||void 0===o.isAllDAy||void 0===o.recurrence)return!1;var s,a,r=null,l=this.makeRecurrence(o.recurrence);return r=o.isAllDAy?["DTSTART;VALUE=DATE:"+t(o.begin,"YYYYMMDD").format("YYYYMMDD"),"DTEND;VALUE=DATE:"+t(o.end,"YYYYMMDD").add(1,"days").format("YYYYMMDD")].join(e):["DTSTART;TZID="+o.timezone+":"+o.begin,"DTEND;TZID="+o.timezone+":"+o.end].join(e),s=["BEGIN:VEVENT","UID:"+o.uid+"@band.us","CLASS:PUBLIC","DESCRIPTION:"+o.description,"DTSTAMP:"+o.timestamp,r,l,"LOCATION:"+o.location,"SUMMARY:"+o.subject,"TRANSP:TRANSPARENT","END:VEVENT"].join(e),a={uid:o.uid,description:o.description,start:o.begin,end:o.end,location:o.location,subject:o.subject},n.push(a),i.push(s),s},makeRecurrence:function(e,n){if(!e)return"";var i="",o=null,s=e.get("until");return e.get("byDay")&&(o=[],_.each(e.get("byDay"),(function(e){e.offset?o.push(e.offset+e.day):o.push(e.day)})),o.join(","),o=";BYDAY="+o),e.get("interval")&&(i=";INTERVAL="+e.get("interval")),n&&(s=t(s).format(n)),["RRULE:FREQ="+e.get("freq"),";UNTIL="+s,i,o].join("")},download:function(t,n){if(i.length<1)return!1;n=void 0!==n?n:".ics",t=void 0!==t?t+n:"calendar"+n;var a=/MSIE|Trident/.test(navigator.userAgent),r=[o,i.join(e),s].join(e),l="data:text/calendar;charset=utf8,"+encodeURIComponent(r);a&&this.isBlobSupported()?this.makeDownloadBlobObject(r,t):a?alert(IM("schedule.download.unsupported")):this.makeDownloadAnchorTag(l,t)},makeDownloadAnchorTag:function(e,t){var n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.addEventListener("click",(function(e){e.stopPropagation(),document.body.removeChild(n)})),n.click()},makeDownloadBlobObject:function(e,t){var n=new Blob([e]);window.navigator.msSaveBlob(n,t)},isBlobSupported:function(){return this.blobConstructor()&&this.msSaveOrOpenBlobSupported()},blobConstructor:function(){return!!window.Blob},msSaveOrOpenBlobSupported:function(){return!!window.navigator.msSaveOrOpenBlob}}}}.call(t,n,t,e))||(e.exports=i)},,,,,function(e,t,n){var i,o;i=[n(21)],void 0===(o=function(e){return{getFileUrl:function(t,n){var i={band_no:t,file_id:n};return e.getLoginV1Client().send({url:"https://api.band.us/v1.1/get_file_url",data:i}).then((function(e,t,n){return e.result_data.url}))}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21);return{checkTodoV1:function(e,n,i){var o={band_no:e,post_no:n,task_id:i};return t.getLoginV1Client().send({url:"https://api.band.us/v1.5.0/check_todo",data:o}).then((function(e,t,n){return e.result_data.todo}))},uncheckTodoV1:function(e,n,i){var o={band_no:e,post_no:n,task_id:i};return t.getLoginV1Client().send({url:"https://api.band.us/v1.5.0/uncheck_todo",data:o}).then((function(e,t,n){return e.result_data.todo}))},checkTodoV2:function(e,t,n,i){return this._setTodoState(e,t,n,i,!0)},uncheckTodoV2:function(e,t,n,i){return this._setTodoState(e,t,n,i,!1)},_setTodoState:function(e,n,i,o,s){return t.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/set_todo_state",data:{band_no:e,post_no:n,todo_id:i,task_id:o,state:s?"checked":"unchecked"}}).then((function(e,t,n){return e.result_data.todo}))},addTodoTaskV1:function(e,n,i){var o={band_no:e,post_no:n,subject:i};return t.getLoginV1Client().send({url:"https://api.band.us/v1/add_todo_task",data:o}).then((function(e,t,n){return e.result_data.message}))},addTodoTaskV2:function(e,n,i,o){return t.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/add_todo_task",data:{band_no:e,post_no:n,todo_id:i,subject:o}}).then((function(e,t,n){return e.result_data.message}))},getImportTodo:function(e){return t.getLoginV1Client().send({url:"https://api.band.us/v2.0.0/get_my_todos",data:{band_no:e}}).then((function(e,t,n){return e.result_data.items}))},getTodo:function(e,n,i){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_todo",data:{band_no:e,post_no:n,todo_id:i}})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(152),s=n(52),a=n(490),r=n(817),l=n(549),c=i.Model.extend({attachmentType:o.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP,idAttribute:"seq",defaults:function(){return{title:null,schedules:new i.Collection(null,{model:r})}},parse:function(e,t){e=s.camelizeKeys(e);var n=new i.Collection(e.schedules,{model:function(e){return t.rich?l.createScheduleModelByJSON(s.decamelizeKeys(e)):new r(e,{parse:!0})}});return{title:e.title||null,schedules:n}},toJSON:function(){return a.toRecursiveJSON(this)},getScheduleGroupTitle:function(){return this.get("title")},getSchedules:function(){return this.get("schedules")},hasSingleSchedule:function(){return 1===this.getSchedules().length},getFirstScheduleModel:function(){return this.getSchedules()&&this.getSchedules().at(0)},getScheduleModelAt:function(e){return this.getSchedules().at(e)},getScheduleCount:function(){return this.getSchedules().length},hasCopyableSchedule:function(){return this.getSchedules().some((function(e){return!e.get("isDelete")}))},isAllScheduleDeleted:function(){return this.getSchedules().every((function(e){return e.get("isDelete")}))},toJSONForSave:function(){return{title:this.get("title"),schedules:this.getSchedules().map((function(e){return e.toJSONForSave({isPostAttached:!0})}))}}});function d(e){return new c(e||{},{parse:!0,rich:!0})}return c.createRichScheduleGroupByApiResponse=function(e){return d(e)},c.createRichScheduleGroupByJSON=function(e){var n=d(),i=t.map(e.schedules,(function(e){return l.createScheduleModelByJSON(s.decamelizeKeys(e))}));return n.set(t.omit(e,"schedules")),n.getSchedules().reset(i),n},c.createRichScheduleGroupByScheduleModel=function(e){var t=d();return t.getSchedules().reset(e),t},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(6),o=n(826),s=i.Collection.extend({model:o,addTakers:function(e){this.add(_.map(e,o.createFromSimpleMemberViewModel))},removeTaker:function(e){if(!_.isNumber(e))throw new Error("takerUserNo must be number, but "+e);var t=this.find((function(t){return t.get("taker").getUserNo()===e}));if(!t)throw new Error("not expected");this.remove(t)},toJSONForSave:function(){return this.map((function(e){return e.toJSONForSave()}))}});s.createFromJSON=function(e){return new s(e)},s.createFromAPI=function(e){return new s(e,{parse:!0})},e.exports=s},function(e,t,n){var i=n(6),o=n(690),s=i.Collection.extend({model:o,modelId:function(e){return e.questionId||e.question_id},initialize:function(e,t){},toJSON:function(){return this.toJSONForSave()},toJSONForSave:function(e){return this.map((function(t){return t.toJSONForSave(e)}))},resetQuestionNumbers:function(){this.each((function(e,t){e.setQuestionNumber(t+1)}))},getTotalPoints:function(){return this.reduce((function(e,t){return e+t.getPoint()}),0)}});s.build=function(e){return new s(e,{parse:!0})},e.exports=s},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(52),s=(n(6),n(152)),a=n(586),r=n(615).extend({attachmentType:s.POST_ATTACHMENT_TYPE.POLL_V2,defaults:function(){var e=this.constructor.__super__.defaults.apply(this);return e.pollId=null,e},parse:function(e,t){e=o.camelizeKeys(e);var n=this.constructor.__super__.parse.apply(this,arguments);return n.pollId=e.pollId,n},isV1:function(){return!1},isV2:function(){return!0},saveVote:function(e,t){var n=this.get("bandNo"),i=this.get("postNo"),o=this.get("pollId");return t?a.voteV2(n,i,o,e):a.cancelVoteV2(n,i,o,e)},closePoll:function(){return a.stopPollV2(this.get("bandNo"),this.get("postNo"),this.get("pollId"))},addSubject:function(e){if(e.length>s.POLL_SUBJECT_MAX_LENGTH){alert(IM("web.postwrite.poll.alert.subject_length",{maxlength:s.POLL_SUBJECT_MAX_LENGTH}));var n=t.Deferred();return n.reject(),n.promise()}return a.addPollSubjectV2(this.get("bandNo"),this.get("postNo"),this.get("pollId"),e)},toJSONForSave:function(e){if(!this.isValid())return null;var t=this._getAvailableSubjects(),n={};return e||(n.poll_id=this.get("pollId")),n=i.extend(n,{type:"poll",title:this.get("title"),is_anonymous:this.get("isAnonymous"),is_subject_addible:this.get("isSubjectAddible"),is_single_select:!this.get("isMultipleSelect"),vote_visible_qualification:this.get("voteVisibleQualification"),order_by:this.get("orderBy"),poll_items:i.map(t,(function(e){return e.get("pollSubjectId")?{subject:e.get("title"),poll_subject_id:e.get("pollSubjectId")}:{subject:e.get("title")}})),ended_at:this.get("endedAt")}),this.get("isMultipleSelect")&&(i.extend(n,{is_vote_limited:this.get("isVoteLimited"),votable_limit:this.get("votableLimit")}),this.get("isVoteLimited")&&i.extend(n,{votable_limit:this.get("votableLimit")})),n}});return r.CONSTANTS={MAX_ATTACH_COUNT:10},r.prepareApiResponseForCopy=function(e){delete e.poll_id,i.each(e.subjects,(function(e){delete e.poll_subject_id}))},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=(n(6),n(625)),a=n(706),r=n(52),l=n(152),c=s.extend({attachmentType:l.POST_ATTACHMENT_TYPE.TODO_V2,defaults:function(){var e=this.constructor.__super__.defaults.apply(this);return e.todoId=null,e},parse:function(e,t){e=r.camelizeKeys(e);var n=this.constructor.__super__.parse.apply(this,arguments);return n.todoId=e.todoId,n},isV1:function(){return!1},isV2:function(){return!0},checkTask:function(e){var t=this.get("bandNo"),n=this.get("postNo"),o=this.get("todoId"),s=this.get("isAuthor");return a.checkTodoV2(t,n,o,e).then(i.bind((function(e){var a=i.extend(e,{bandNo:t,postNo:n,todoId:o,isAuthor:s});this.set(this.parse(a))}),this))},uncheckTask:function(e){var t=this.get("bandNo"),n=this.get("postNo"),o=this.get("todoId"),s=this.get("isAuthor");return a.uncheckTodoV2(t,n,o,e).then(i.bind((function(e){var a=i.extend(e,{bandNo:t,postNo:n,todoId:o,isAuthor:s});this.set(this.parse(a))}),this))},addTask:function(e){if(o.isBlank(e))return alert(IM("todo.add_task.alert.blank_subject")),t.Deferred().reject();if(e.length>l.TODO_TASK_MAX_LENGTH)return alert(IM("web.postwrite.todo.alert.task_length",{maxlength:l.TODO_TASK_MAX_LENGTH})),t.Deferred().reject();var n=this.get("bandNo"),i=this.get("postNo"),s=this.get("todoId");return a.addTodoTaskV2(n,i,s,e)},toJSONForSave:function(e){if(!this.isValid())return null;var t=this._getAvailableTasks(),n={};return e||(n.todo_id=this.get("todoId")),n=i.extend(n,{title:this.get("title"),is_task_addible:this.get("isTaskAddible"),is_checkable_only_by_author:this.get("isCheckableOnlyByAuthor"),tasks:i.map(t,(function(e){return{task_id:e.get("taskId")||null,subject:e.get("subject")}})),ended_at:this.get("endedAt")})}});return c.CONSTANTS={MAX_ATTACH_COUNT:10},c.prepareApiResponseForCopy=function(e){delete e.todo_id,i.each(e.tasks,(function(e){delete e.task_id}))},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21);return{setAttendanceCheckState:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_attendance_check_state",type:"POST",data:e})},setAttendanceCheckStates:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/set_attendance_check_states",type:"POST",data:e})},getMyAttendanceChecks:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_my_attendance_checks",data:{band_no:e}})},getAttendanceCheck:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_attendance_check",data:e})}}}.call(t,n,t,e))||(e.exports=i)},,,,function(e,t,n){var i;void 0===(i=function(){var e={EDIT_MODE:{NEW:1,MODIFY:2,COPY:3,SHARE:4},PLACE_HOLDER_CLASS:"_placeholder",RICH_EDITOR_CLASS:"_richEditor",preventMention:function(t,n){return!(t!==e.EDIT_MODE.COPY&&t!==e.EDIT_MODE.SHARE||!n||!(n.length>0))},postSettingEnabled:function(t){return t===e.EDIT_MODE.NEW||t===e.EDIT_MODE.COPY||t===e.EDIT_MODE.SHARE},createReservedPostEnabled:function(t){return t!=e.EDIT_MODE.MODIFY},isNewOrModifyMode:function(t){return t==e.EDIT_MODE.NEW||t==e.EDIT_MODE.MODIFY}};return e}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(21),o=(n(87),"/v2.0.0/get_signup_attendees");return{getMySignups:function(e){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_my_signups",data:{band_no:e}})},setSignupStates:function(e){var n=[{id:"set_signup_states",svc_id:"API",path:"/v2.0.0/set_signup_states",params:e,method:"GET"},{svc_id:"API",path:o,params:_.pick(e,"band_no","post_no","signup_id","task_id"),method:"GET",wait_for:"set_signup_states"}],s=t.Deferred();return i.getLoginV1Client().sendBatchApiBatchRequest(n).then((function(e){s.resolve(e[1].result_data)})),s.promise()},getSignupAttendees:function(e,t,n,s){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o,data:{band_no:e,post_no:t,signup_id:n,task_id:s}})},getSignup:function(e,t,n){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_signup",data:{band_no:e,post_no:t,signup_id:n}})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return new(n(1244))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{BODY:"body",HEADER:"#header",LNB:"#lnb",LAYER_CONTAINER:"#layerContainer"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(6),o=n(732),s=i.Collection.extend({});s.buildScheduleSharerCollection=function(e){return new s(e,{model:o,parse:!0})},e.exports=s},function(e,t,n){var i=n(6),o=n(724),s=n(593),a=i.Collection.extend({model:o,getSortedInTimeList:function(e){return this.sortBy((function(t){return t.calculateAlarmTimeStamp(e)}))},getSortedAlarmMessage:function(e,t){var n=this.getSortedInTimeList(e),i=[];return _.each(n,_.bind((function(e){i.push(s.getFullMessage(t,e))}),this)),i.join(", ")},findAlarmItemByCid:function(e){return this.get({cid:e})},hasAlarm:function(){return this.length>0}});e.exports=a},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(503),s=n(593),a=n(52),r=n(16),l=t.Model.extend({defaults:{durationType:null,amount:null,alarmTime:null},parse:function(e){var t={durationType:(e=a.camelizeKeys(e)).durationType,amount:e.amount};return e.alarmTime&&(t.alarmTime=e.alarmTime),t},toJSONForSave:function(){var e={duration_type:this.get("durationType"),amount:this.get("amount")};return this.has("alarmTime")&&(e.alarm_time=this.get("alarmTime")),e},checkValidValueWithAlarmTime:function(){return null!=this.get("amount")&&null!=this.get("durationType")&&null!=this.get("alarmTime")},checkValidValueWithoutAlarmTime:function(){return null!=this.get("amount")&&null!=this.get("durationType")},setAlarm:function(e){e?this.set(this.parse(e),{validate:!0}):this.set(i.clone(this.defaults))},isValidWith:function(e){return!(!this.has("durationType")||!this.has("amount"))&&(!(e&&!this.has("alarmTime"))&&(!!i.contains(i.pluck(s.getDurationTypes(e),"value"),this.get("durationType"))&&(!!i.contains(s.getDurationAmounts(this.get("durationType"),e),this.get("amount"))&&!(e&&!this.has("alarmTime")))))},clone:function(){return new l(i.clone(this.attributes))},setExternalScheduleAlarm:function(e,t,n){return o.setExternalScheduleAlarm(e,t,n)},setSchedulePersonalAlarm:function(e,t,n){return o.setSchedulePersonalAlarm(e,t,n)},calculateAlarmTimeStamp:function(e){var t=r(e).subtract(this.get("amount"),s.getMomentUnitByDurationType(this.get("durationType")));if(this.get("alarmTime")){var n=t.format("YYYY-MM-DD ");return(t=r(n+this.get("alarmTime"))).unix()}return t.unix()}});return l.isSameValue=function(e,t){return e.get("durationType")==t.get("durationType")&&e.get("amount")==t.get("amount")&&e.get("alarmTime")==t.get("alarmTime")},l.buildScheduleAlarmModel=function(e){return new l(e)},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(520);return i.Model.extend({defaults:{count:0,isPinnedCount:0,bandTags:[]},parse:function(e){var n=e||[];return t.extend(this.defaults,{count:n.length,isPinnedCount:t.where(n,{is_pinned:!0}).length,bandTags:n})},getCount:function(){return this.get("count")},fetchBandTagsWithPinned:function(e){return o.getHashTagsWithPinned(e,!0,!0).then(t.bind((function(e){return this.set(this.parse(e)),this}),this))},fetchBandTags:function(e){return o.getHashTagsWithPinned(e,!1,!0).then(t.bind((function(e){return this.set(this.parse(e)),this}),this))}})}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(16),o=n(705),s=n(156),a=n(52),r=n(152);return t.extend({attachmentType:r.POST_ATTACHMENT_TYPE.FILE,defaults:{isNew:!0},parse:function(e,t){return{type:"ndrive",isNew:(e=a.camelizeKeys(e)).isNew||!1,sosId:e.sosId,id:e.id,title:e.title,fileSize:e.fileSize,fileSizeText:s.toStringFileSize(e.fileSize),extension:e.extension,createdAt:e.createdAt,expiresAt:e.expiresAt,isExpired:i().isAfter(i(e.expiresAt)),isRestricted:e.isRestricted,folderId:e.folderId}},getFileUrl:function(e){return o.getFileUrl(e,this.get("id"))},makeExpirationText:function(){return s.makeExpirationText(this.get("expiresAt"))},isExpired:function(){return s.isExpiredFile(this.get("expiresAt"))},toJSONForSave:function(e){var t,n=this.get("folderId");return t=e||this.get("isNew")?{id:this.get("sosId")?this.get("sosId"):this.get("id"),file_name:this.get("title"),file_size:this.get("fileSize")}:{file_id:this.get("id")},n&&(t.folder_id=n),t}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(156),o=n(52),s=n(152);return t.extend({defaults:{dropboxFile:!0},attachmentType:s.POST_ATTACHMENT_TYPE.DROPBOX_FILE,parse:function(e,t){return{type:"dropbox",fileId:(e=o.camelizeKeys(e)).fileId,spec:e.spec,name:e.name,title:e.name,link:e.link,fileSize:e.size,extension:i.getFileExtension(e.name),fileSizeText:i.toStringFileSize(e.size),title:e.name,folderId:e.folderId}},validate:function(e,t){if(!e.name||!e.link)return"It's not valid"},toJSONForSave:function(e){var t,n=this.get("folderId");return t=e?{size:this.get("fileSize"),name:this.get("name"),link:this.get("link")}:{file_id:this.get("fileId")},n&&(t.folder_id=n),t}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(156),o=n(52),s=n(152);return t.extend({defaults:{externalFile:!0},attachmentType:s.POST_ATTACHMENT_TYPE.EXTERNAL_FILE,parse:function(e,t){return{type:(e=o.camelizeKeys(e)).source,fileId:e.fileId,id:e.fileId,name:e.name,title:e.name,link:e.link,fileSize:e.size,extension:i.getFileExtension(e.name),fileSizeText:i.toStringFileSize(e.size),folderId:e.folderId}},validate:function(e,t){if(!e.name||!e.link)return"It's not valid"},toJSONForSave:function(e){var t,n=this.get("folderId");return t=e?{size:this.get("fileSize"),name:this.get("name"),link:this.get("link"),source:this.get("type")}:{file_id:this.get("fileId")},n&&(t.folder_id=n),t}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(741),o=t.Collection.extend({model:i});return o.buildSchedulePhotoCollection=function(e){return new o(e,{parse:!0})},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(6),o=n(163),s=n(82),a=n(497),r=i.Model.extend({parse:function(e){var t=e.profileImageUrl,n=s.makeProfileThumbnailUrl(t);return{userNo:e.userNo,name:e.name,description:e.description,profileImageUrl:t,faceThumb:n,memberType:e.memberType,role:a.parseRole(e.role),profileInnerClass:s.makeProfileInnerClass(t),isDeleted:e.isDeleted}},getUserNo:function(){return this.get("userNo")},setUserNo:function(e){this.set("userNo",e)},getName:function(){return this.get("name")},setName:function(){this.set("name")},getDescription:function(){return this.get("description")},setDescription:function(e){this.set("description",e)},getProfileImageUrl:function(){return this.get("profileImageUrl")},setProfileImageUrl:function(e){this.set("profileImageUrl",e)},getMemberType:function(){return this.get("memberType")},setMemberType:function(e){this.set("memberType",e)},getRole:function(){return this.get("role")},setRole:function(e){this.set("role",e)},getFaceThumb:function(){return this.get("faceThumb")},setFaceThumb:function(e){this.set("faceThumb",e)},getMemberProfile:function(){return new o({name:this.getName(),profileImageUrl:this.getProfileImageUrl(),memberType:this.getMemberType()})},isDeleted:function(){return this.get("isDeleted")}});r.createScheduleSharerModel=function(e){return new r(e,{parse:!0})},e.exports=r},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(630),s=i.Collection.extend({model:o});return s.buildScheduleFileCollection=function(e,n){return new s(e,t.extend({parse:!0},n))},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(631),s=i.Collection.extend({model:o});return s.buildScheduleDropboxFileCollection=function(e,n){return new s(e,t.extend({parse:!0},n))},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(632),s=i.Collection.extend({model:o});return s.buildScheduleExternalFileCollection=function(e,n){return new s(e,t.extend({parse:!0},n))},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=new IntersectionObserver((function(e){t.each(e,(function(e){var t=i(e.target),n=t.data("SIB_VIEW");n&&(n.trigger("intersect",e),e.isIntersecting?t.trigger("ScreenIntersectionBehavior:exposed",e):t.trigger("ScreenIntersectionBehavior:hidden",e))}))}));return o.Behavior.extend({options:{observeDelay:0},onAttach:function(){var e=this.view;e.$el.data("SIB_VIEW",e),setTimeout((function(){e.isAttached()&&s.observe(e.el)}),this.options.observeDelay)},onBeforeDetach:function(){s.unobserve(this.view.el),this.view.$el.removeData("SIB_VIEW")},onDestroy:function(){this.view.off("intersect")}})}.call(t,n,t,e))||(e.exports=i)},,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52);return t.Model.extend({defaults:function(){return{postNo:null,emotionCount:null,commentCount:null,commonEmotionType:[]}},parse:function(e){e=i.camelizeKeys(e);var t={};return t.postNo=e.postNo,t.emotionCount=e.emotionCount,t.commentCount=e.commentCount,t.commonEmotionType=e.commonEmotionType,t}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return n(6).Model.extend({defaults:{url:"",height:0,width:0},parse:function(e){var t={};return t.url=e.url,t.height=e.height,t.width=e.width,t},getUrl:function(){return this.get("url")},toJSONForSave:function(){return{url:this.get("url"),height:this.get("height"),width:this.get("width")}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i="/v2.0.0/get_quiz",o="/v2.0.0/take_quiz",s="/v2.0.0/get_my_quiz_answer",a="/v2.0.0/get_my_quiz_grade",r="/v2.0.0/get_my_file_url_by_quiz",l="/v2.0.0/grade_quiz",c="/v2.0.0/get_file_url_by_quiz",d="/v2.0.0/get_quiz_grade",u="/v2.0.0/open_quiz_grade",h="/v2.0.0/end_quiz",p="/v2.0.0/get_quiz_statistics",m="/v2.0.0/set_quiz_review_disabled",_="/v2.0.0/get_video_url_by_quiz_question",g="/v2.0.0/get_file_url_by_quiz_question",f="/v2.0.0/get_audio_url_by_quiz_question";return{getQuiz:function(e,n,o){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+i,data:{band_no:e,post_no:n,quiz_id:o}})},takeQuiz:function(e,n,i,s){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o,data:{band_no:e,post_no:n,quiz_id:i,do_finish:!0,answer:JSON.stringify(s)},method:"POST"})},takeQuizTemporarily:function(e,n,i,s){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o,data:{band_no:e,post_no:n,quiz_id:i,do_finish:!1,answer:JSON.stringify(s)},method:"POST"})},getMyQuizAnswer:function(e,n,i){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+s,data:{band_no:e,post_no:n,quiz_id:i}})},getMyQuizGrade:function(e,n,i){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+a,data:{band_no:e,post_no:n,quiz_id:i}})},getMyFileUrlByQuiz:function(e,n,i,o){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+r,data:{band_no:e,post_no:n,quiz_id:i,question_id:o}})},gradeQuiz:function(e,n,i,o,s){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+l,data:{band_no:e,post_no:n,quiz_id:i,taker_no:o,grade:JSON.stringify(s)},method:"POST"})},getFileUrlByQuiz:function(e,n,i,o,s){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+c,data:{band_no:e,post_no:n,quiz_id:i,question_id:o,taker_no:s}})},getQuizGrade:function(e,n,i,o){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+d,data:{band_no:e,post_no:n,quiz_id:i,taker_no:o}})},openQuizGrade:function(e,n,i,o){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u,data:{band_no:e,post_no:n,quiz_id:i,is_review_enabled:o}})},endQuiz:function(e,n,i){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+h,data:{band_no:e,post_no:n,quiz_id:i}})},getQuizStatistics:function(e,n,o){return t.getLoginV1Client().sendBandApiBatchRequest([{path:i,params:{band_no:e,post_no:n,quiz_id:o}},{path:p,params:{band_no:e,post_no:n,quiz_id:o}}]).then((function(e,t,n){return{quiz:e[0].result_data.quiz?e[0].result_data.quiz:{},stats:e[1].result_data?e[1].result_data:{}}}))},setQuizReviewDisabled:function(e,n,i){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+m,data:{band_no:e,post_no:n,quiz_id:i}})},getVideoUrlByQuizQuestion:function(e,n,i,o){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+_,data:{band_no:e,post_no:n,quiz_id:i,question_id:o,is_https_enabled:!0}})},getFileUrlByQuizQuestion:function(e,n,i,o){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+g,data:{band_no:e,post_no:n,quiz_id:i,question_id:o}})},getAudioUrlByQuizQuestion:function(e,n,i,o){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+f,data:{band_no:e,post_no:n,quiz_id:i,question_id:o,is_https_enabled:!0}})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(52),s=n(547),a=n(158);return i.Model.extend({defaults:function(){return{bandNo:"",name:"",joinMethod:"",joinQuestion:"",needAdAgreement:!1,emailVerificationEnabled:!1}},parse:function(e){return{bandNo:(e=o.camelizeKeys(e)).bandNo,name:e.name,joinMethod:e.joinMethod,joinQuestion:e.joinQuestion,needAdAgreement:e.needAdAgreement,emailVerificationEnabled:e.emailVerificationEnabled,joinQuestionAsHtml:a.nl2br(t.escape(e.joinQuestion))}},fetchByInvitationCardId:function(e){return this.set({invitationCardId:e}),s.getJoinForm("invitation_card_id",e).then(t.bind((function(e){return this.set(this.parse(e)),this}),this))},fetchMemberFormByBandNo:function(e){return this.set({bandNo:e}),s.getJoinForm("band_no",e).then(t.bind((function(e){return this.set(this.parse(e)),this}),this))},getBandNo:function(){return this.get("bandNo")},getBandName:function(){return this.get("name")},getJoinQuestionAsHtml:function(){return this.get("joinQuestionAsHtml")},isEmailVerificationEnabled:function(){return this.get("emailVerificationEnabled")},hasJoinQuestion:function(){return!!this.get("joinQuestion")},isJoinMethodNormal:function(){return"normal"===this.get("joinMethod")},isJoinMethodApplication:function(){return"application"===this.get("joinMethod")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(6),s=n(547),a=o.Model.extend({defaults:function(){return{}},submit:function(){var e=this.toJSON();return!i.isEmpty(e.name)&&i.isEmpty(e.profile_image_url)&&(e.profile_image_url=null),i.isEmpty(e.join_answer_images)||(e.join_answer_images=JSON.stringify(e.join_answer_images)),s.joinBand(e)},setJoinAnswer:function(e){this.set({join_answer:e})},setJoinAnswerImages:function(e){this.set("join_answer_images",e)},setNewProfile:function(e,t){this.set({name:e,profile_image_url:t}),this.unset("user_profile_set_id")},setUserProfileSetId:function(e){this.set({user_profile_set_id:e}),this.unset("name"),this.unset("profile_image_url")},setSetDefaultProfileSetOfPage:function(e){this.set({set_default_profile_set_of_page:e})},setEmailVerificationToken:function(e){this.set("email_verification_token",e)}});a.buildJoinTypeBandNo=function(e){var t=new a(null);return t.set({join_type:"band_no",join_value:e}),t},a.buildJoinTypeInvitationCardId=function(e){var t=new a(null);return t.set({join_type:"invitation_card_id",join_value:e}),t},e.exports=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(2),s=n(26),a=n(796),r=n(169),l=n(577),c=n(718),d=function(e){e.each((function(e,t){var n=o(t);n.data("_scrollBeforeHide",n.scrollTop())}))},u=function(e){e.each((function(e,t){var n=o(t);n.data("_scrollBeforeHide")&&(n.scrollTop(n.data("_scrollBeforeHide")),n.removeData("_scrollBeforeHide"))}))},h={layerRegionTemplate:i.template('<div class="<%=className%>"></div>'),addRegionWithDOM:function(e,t){var n="_"+t,i="."+n;e.$el.append(this.layerRegionTemplate({className:n})),e.addRegion(t,{el:i,replaceElement:!0})},removeRegionWithDOM:function(e,t){var n=e.getRegion(t);e.removeRegion(t),e.$(n.el).remove()}},p=t.View.extend({attributes:{"data-viewname":"DLayerContainerView"},className:"layerContainerView",template:function(){return""},initialize:function(){this._layerContainer=[],this._layerWrapScrollClassName=".lyWrap",this._activeLayerViewClassName="activeLayerView",this.listenTo(s.getDGlobalChannel(),s.EVENT.DOCUMENT_ESC_KEY_DOWN,this._onEscKeyDown),this.listenTo(s.getDGlobalChannel(),s.EVENT.WINDOW_RESIZE,i.throttle(this._onWindowResize,300)),this._$window=o(window),this._onWindowFullscreen=i.bind(this._onWindowFullscreen,this),this._$window.on(l.FULLSCREEN_EVENT_NAME,this._onWindowFullscreen)},onDestroy:function(){this._$window.off(l.FULLSCREEN_EVENT_NAME,this._onWindowFullscreen)},_onEscKeyDown:function(e){if(this.hasLayer()){o.browser.msie&&e.preventDefault();var t=this._getLastLayerInnerView();i.isFunction(t.options.layerView.layerOnEscKeyDown)?t.options.layerView.layerOnEscKeyDown():this.closeLastLayer()}},_onWindowResize:function(){if(this.hasLayer()){var e=this._getLastLayerInnerView();i.isFunction(e.options.layerView.layerOnWindowResize)&&e.options.layerView.layerOnWindowResize()}},_onWindowFullscreen:function(e){if(this.hasLayer()){var t=this._getLastLayerInnerView();i.isFunction(t.options.layerView.layerOnWindowFullScreen)&&t.options.layerView.layerOnWindowFullScreen(e)}},childViewEvents:{detach:function(e){i.contains(this._layerContainer,e.cid)&&this._closeLayer(e.cid)}},openNewLayer:function(e,t){o(window).scrollTop();var n=this._findLayerCallElement(),i=new a({layerView:e,layerCallElement:n});if(this.trigger(p.EVENT.BEFORE_LAYER_OPEN,i),this.hasLayer()&&t){var s=this._getLastLayerInnerView();d(s.$(this._layerWrapScrollClassName)),s.$el.hide()}e.$el.addClass("layer_wrap"),o("body").addClass(this._activeLayerViewClassName),h.addRegionWithDOM(this,i.cid),this.showChildView(i.cid,i),this._layerContainer=this._layerContainer.concat(i.cid)},getActiveLayerView:function(){var e=this._getLastLayerInnerView();return e&&e.getLayerView()},hasLayer:function(){return this._layerContainer.length>0},closeLastLayer:function(){this.hasLayer()&&this._closeLayer(i.last(this._layerContainer))},_getLastLayerInnerView:function(){if(this.hasLayer())return this.getChildView(i.last(this._layerContainer))},isTopLayerView:function(e){var t=this._getLastLayerInnerView();return t&&t.getLayerView()==e},_closeLayer:function(e){var t=this.getChildView(e);if(this._layerContainer=i.without(this._layerContainer,e),h.removeRegionWithDOM(this,e),this.hasLayer()){var n=this._getLastLayerInnerView();n.$el.show(0,i.bind((function(){u(n.$(this._layerWrapScrollClassName))}),this))}else o("body").removeClass(this._activeLayerViewClassName);this.trigger(p.EVENT.AFTER_LAYER_CLOSE,t),this._restoreFocus(t)},_restoreFocus:function(e){var t=e.getLayerCallElement(),n=o(t);if(t&&o(t).hasClass(c.RICH_EDITOR_CLASS)){var i=n.parent().scrollTop();n.focus(),n.parent().scrollTo(i)}else t&&n.focus()},_findLayerCallElement:function(){var e=document.activeElement;if(e&&o(e).clone().wrap("<div/>").filter(r.FOCUSABLE_ELEMENTS_STRING).length)document.querySelector&&(e=document.querySelector(":focus"));else{if(/MSIE|Trident/.test(navigator.userAgent)&&(e=o(e).closest(r.FOCUSABLE_ELEMENTS_STRING)).length)return e;e=null}return e||null}});return p.EVENT={BEFORE_LAYER_OPEN:"beforeLayerOpen",AFTER_LAYER_CLOSE:"afterLayerClose"},p}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(52),i=n(6),o=n(497),s=n(13),a=n(22),r=n(163),l=i.Model.extend({parse:function(e){return{id:(e=t.camelizeKeys(e)).userNo,userNo:e.userNo,name:e.name,desc:e.description,profileImageUrl:e.profileImageUrl,role:o.parseRole(e.role),memberType:e.memberType||a.MEMBER_TYPE.MEMBERSHIP,me:e.me||e.userNo===s.getUserData().getUserNo(),selected:e.selected||!1}},getUserNo:function(){return this.get("userNo")},getRole:function(){return this.get("role")},getBandNo:function(){return this.get("bandNo")},getName:function(){return this.get("name")},getDescription:function(){return this.get("desc")},getProfileImageUrl:function(){return this.get("profileImageUrl")},getMemberProfile:function(){return new r({name:this.getName(),profileImageUrl:this.getProfileImageUrl(),memberType:this.get("memberType")})},getMemberType:function(){return this.get("memberType")},setSelected:function(e){this.set("selected",e)},isSelected:function(){return this.get("selected")}});return l.getUserNoForSelectAll=function(){return-1},l.createVirtualMemberForAllMemberSelection=function(e,t){var n={profileImageUrl:e,name:IM("web.bandmemberselection.select_all_members")+" ("+t+")",userNo:-1};return new l(n,{parse:!0})},l.createSimpleMemberViewModel=function(e,t,n,i,s){return new l({id:e,userNo:e,name:t,desc:n,profileImageUrl:i,role:o.parseRole(s)})},l}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i=n(153),o={GET_RESERVED_POST_COUNT:"/v1.0.0/get_reserved_post_count",GET_RESERVED_POST:"/v2.0.0/get_reserved_post",GET_RESERVED_POSTS:"/v1.0.0/get_reserved_posts",DELETE_RESERVED_POST:"/v1.0.0/delete_reserved_post",PUBLISH_RESERVED_POST:"/v2.0.0/publish_reserved_post"},s={getReservedPostCount:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o.GET_RESERVED_POST_COUNT,data:{band_no:e}}).then((function(e){return e.reserved_post_count}))},getReservedPost:function(e,n){var s={band_no:e,reserved_post_id:n};return t.getLoginV1Client().send({url:"https://api.band.us"+o.GET_RESERVED_POST,data:s}).then((function(e){return e.result_data.reserved_post}),(function(){i.GROUP_BAND_HOME.historyBackOrGoTargetUrl({band_no:e})}))},getReservedPosts:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o.GET_RESERVED_POSTS,data:{band_no:e}})},deleteReservedPost:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o.DELETE_RESERVED_POST,data:{band_no:e,reserved_post_id:n}})},publishReservedPost:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o.PUBLISH_RESERVED_POST,data:{band_no:e,reserved_post_id:n}})}};return s.PATHS=o,s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(21);return{PENALTY_TYPE:{BLOCK_COMMENT_AND_CHAT:"block_comment_and_chat"},addPenaltyMember:function(e,n,o,s){var a=s?i.getLoginV1ClientWithoutErrorAlert():i.getLoginV1Client(),r={band_no:e,type:o};return t.isNumeric(n)?r.user_no=n:r.member_key=n,a.sendAndThenProcess({url:"https://api.band.us/v2.0.0/add_penalty_member",method:"POST",data:r})},removePenaltyMember:function(e,n,o,s){var a=s?i.getLoginV1ClientWithoutErrorAlert():i.getLoginV1Client(),r={band_no:e,type:o};return t.isNumeric(n)?r.user_no=n:r.member_key=n,a.sendAndThenProcess({url:"https://api.band.us/v2.0.0/remove_penalty_member",method:"POST",data:r})},getPenaltyMembers:function(e,t,n){var o={band_no:e,type:t};return n&&(o.limit=n),i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_penalty_members",data:o})},checkPenaltyMembers:function(e,t,n){return i.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/check_penalty_members",data:{band_no:e,user_nos:t.join(","),type:n}})}}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(486),s=n(556),a=n(1613),r=n(26),l=n(2675),c=n(795),d=n(495),u=n(487),h=n(592),p=n(159),m=n(154),_=n(153),g=n(162),f=n(82),b=n(155),v=a.extend({tagName:"div",className:function(){return"postDetailView "+this.model.getBandCore().getSkinColorClass()},attributes:{"data-viewname":"DPostDetailLayerView"},template:i.template(l),templateContext:function(){return{showBtnSubscribe:this._isPageSubscribedRecently||this.model.getBand().isSubscribingAvailable(),isApprovablePost:this.model.isApprovablePost(),printBandCover:f.makeSmallCoverUrl(this.model.getBandCore().showProfileAsPageStyle()?this.model.getBandCore().profileImage:this.model.getBandCore().cover),printBandName:this.model.getBandCore().name}},behaviors:function(){if(!i.isArray(a.prototype.parentBehaviors))throw new Error("parentBehaviors is required");var e=a.prototype.parentBehaviors.concat([u]);return this.options.model.isApprovablePost()&&(e=i.reject(e,(function(e){return e.behaviorClass===d}))),e},ui:i.extend({},a.prototype.ui,{scrollContainer:"._scrollContainer",postCard:"._postCard",btnPrevPost:"._btnPrevPost",btnNextPost:"._btnNextPost",btnClose:"._btnClose",feedTitBand:"._feedTitBand",btnGoToTop:"._btnGoToTop",deleteApprovalPost:"._deleteApprovalPost",approvePost:"._approvePost"}),onMessages:(t={},t[p.MSG.ADDON_HEIGHT_CHANGED]=function(){m.wrapDeferPromise(this).then(i.bind(this._adaptScrollArea,this))},t[p.MSG.COMMENTLIST_CHANGE_COLLECTION]=function(){m.wrapActivePromise(this.changeCommentCountOnCommentListChange(),this).then(i.bind((function(){this._topButtonFloating()}),this))},i.extend({},a.prototype.onMessages,t)),events:i.extend({},a.prototype.events,{"click @ui.btnPrevPost":"_showPrevPost","click @ui.btnNextPost":"_showNextPost","click @ui.btnClose":"_destroy",click:function(e){if(0==$(e.target).parents("._lyContent:first").length){if(!i.isEmpty(window.getSelection().toString()))return;this._destroy()}},"click @ui.btnGoToTop":"_onClickBtnGoToTop","click @ui.approvePost":function(){r.getApprovablePostChannel().trigger(r.APPROVABLE_POST_EVENT.APPROVE_POST,this.model.getApprovablePostId())},"click @ui.deleteApprovalPost":function(){r.getApprovablePostChannel().trigger(r.APPROVABLE_POST_EVENT.REMOVE_POST,this.model.getApprovablePostId())}}),initialize:function(e){a.prototype.initialize.call(this,e),this._body=$("body"),this.onLoading=!1,this.hasBandHeader=e.hasBandHeader,this.postTopMargin=30,this.postCollection=e.postCollection,this.listenTo(r.getDGlobalChannel(),r.EVENT.DOCUMENT_LEFT_KEY_UP,(function(){this._canExecuteKeyboardNavigation()&&"none"!=this.ui.btnPrevPost.css("display")&&this.ui.btnPrevPost.trigger("click")})),this.listenTo(r.getDGlobalChannel(),r.EVENT.DOCUMENT_RIGHT_KEY_UP,(function(){this._canExecuteKeyboardNavigation()&&"none"!=this.ui.btnNextPost.css("display")&&this.ui.btnNextPost.trigger("click")})),this.listenTo(this,"complete:_renderContents",(function(e){e.renderedOtherPost&&(this._renderLayerHeader(),this._initScrollArea(),this._sendSceneEnterLog()),this._adaptShortCutFloating(),this._domHeightDetect(),this._renderPostListNavigation(),this._topButtonFloating()})),this.listenTo(r.getDGlobalChannel(),r.EVENT.WINDOW_RESIZE,(function(){this._adaptShortCutFloating(),this._topButtonFloating()})),e.closeOnReported&&this.listenTo(r.getPostChannel(),r.EVENT.POST_REPORTED,(function(e){e.bandNo==this.model.getBandNo()&&e.postNo==this.model.getPostNo()&&this._destroy(!0)})),this.listenTo(r.getApprovablePostChannel(),r.APPROVABLE_POST_EVENT.POST_DELETED,(function(){this._destroy()})),this.listenTo(r.getApprovablePostChannel(),r.APPROVABLE_POST_EVENT.POST_UPLOADED,(function(){this._destroy()}))},serializeData:function(){return this.model.toJSON()},layerOnEscKeyDown:function(){if(this.getChildView("moreOptionListRegion")&&this.getChildView("moreOptionListRegion").isPostMoreMenuVisible()||this._translationChannel.hasShownLayer())return!1;this._destroy()},onAttach:function(){r.getPostChannel().trigger(r.EVENT.POST_DETAIL_LAYER_OPEN,{bandNo:this.model.getBandNo(),postNo:this.model.getPostNo()})},onBeforeDetach:function(){this.stopListening(this.domHeightDetector),this.ui.scrollContainer.off("scroll")},_isLayerHeaderVisible:function(){return this.hasBandHeader&&this.model.getBandCore().showBandNameMultipleBandPostCard()},_domHeightDetect:function(){this.domHeightDetector&&(this.stopListening(this.domHeightDetector),this.domHeightDetector=null),this.domHeightDetector=new h,this.domHeightDetector.startDetecting(this.getUI("scrollContainer"),200,10,!0),this.listenTo(this.domHeightDetector,h.EVENT.HEIGHT_CHANGED,(function(){this._adaptShortCutFloating()}))},_canExecuteKeyboardNavigation:function(){if(!this._isOnTopLayerNow())return!1;var e=this.getCommentMainView();return!e||!(e.isMessageInputFocused()||e.isModificationStatus()||e.hasFocusingInput())},_renderLayerHeader:function(){if(!this._isLayerHeaderVisible())return this.ui.postCard.removeClass("cCard -extension").addClass("cPostCard"),void this.ui.feedTitBand.empty();this.ui.postCard.removeClass("cPostCard").addClass("cCard -extension");var e=i.template('<a href="<%= bandLink %>" class="tit _linkBand"><% if (certifiedBand) { %><span class="uOfficialBand -sizeS">'+IM("ui.official_band")+" </span><% } %><%- bandName %></a>"),t=_.GROUP_BAND_HOME.makeUrl({band_no:this.model.getBandCore().bandNo});this.ui.feedTitBand.html(e({bandLink:t,certifiedBand:this.model.getBandCore().certified,bandName:this.model.getBandCore().name})),this.ui.feedTitBand.find("._linkBand").click(i.bind((function(){var e=this.model.getBandNo(),t=this.model.getBandCore().makeBandRouteUrl(_.GROUP_BAND_HOME,g.PAGE_BAND_HOME,{band_no:e});return c.openPreviewBandWindowByClick(t),!1}),this))},_renderPostListNavigation:function(){if(this.postCollection){var e=i.first(this.postCollection.models).get("postNo")==this.model.getPostNo(),t=i.last(this.postCollection.models).get("postNo")==this.model.getPostNo();this.ui.btnPrevPost.toggle(!e),this.ui.btnNextPost.toggle(!t)}},_initScrollArea:function(){this.ui.scrollContainer.scrollTop(0),this.ui.scrollContainer.off("scroll").on("scroll",i.bind(this._adaptScrollArea,this))},_adaptScrollArea:function(){this._adaptAuthorFloating(),this._adaptShortCutFloating()},_adaptAuthorFloating:function(){this.getUI("scrollContainer").scrollTop()<=this.postTopMargin?(this.getUI("postCard").removeClass("-postWriterOn"),this._isLayerHeaderVisible()&&this.getChildView("postAuthorRegion").setTop("")):(this.getUI("postCard").addClass("-postWriterOn"),this._isLayerHeaderVisible()&&this.getChildView("postAuthorRegion").setTop(this.getUI("feedTitBand").outerHeight()))},_adaptShortCutFloating:function(){if(this._isOnTopLayerNow()){var e=this.$el.find("._postAdded").position(),t=e?e.top:0;this.ui.scrollContainer.scrollTop()+this.ui.scrollContainer.height()>=t?this.ui.postCard.removeClass("-postCountLayerOn"):this.ui.postCard.addClass("-postCountLayerOn")}},_topButtonFloating:function(){var e=this.getUI("scrollContainer");e.prop("scrollHeight")>e.prop("clientHeight")?this.getUI("btnGoToTop").addClass("-active"):this.getUI("btnGoToTop").removeClass("-active")},_findPrevPostModel:function(){var e=this.postCollection.get(this.model.getPostModelId()),t=this.postCollection.indexOf(e);return this.postCollection.at(t-1)},_findNextPostModel:function(){var e=this.postCollection.get(this.model.getPostModelId()),t=this.postCollection.indexOf(e);return this.postCollection.at(t+1)},_showPrevPost:function(e){if(e.stopPropagation(),!this.onLoading&&this._confirmComments()){this._uncoveredOnce=!1,this.onLoading=!0;var t=this._findPrevPostModel();this.model.resetUncoveredOnce(),this.model.fetchPostDetail(t.getBandNo(),t.getPostNo(),!0).always(i.bind((function(){this.onLoading=!1}),this))}},_showNextPost:function(e){if(e.stopPropagation(),!this.onLoading&&this._confirmComments()){this._uncoveredOnce=!1,this.onLoading=!0;var t=this._findNextPostModel();this.model.resetUncoveredOnce(),(t.get("postNo")===i.last(this.postCollection.models).get("postNo")&&this.postCollection.hasMore()?this.postCollection.fetchNextPostList().then(i.bind((function(){return this.model.fetchPostDetail(t.getBandNo(),t.getPostNo(),!0)}),this)):this.model.fetchPostDetail(t.getBandNo(),t.getPostNo(),!0)).always(i.bind((function(){this.onLoading=!1}),this))}},_isOnTopLayerNow:function(){return this.$el.is(".layer_wrap:last")},_destroy:function(e){return(!0===e||this._confirmComments())&&this.destroy(),!1},_confirmComments:function(){var e=this.getCommentMainView();return!e||(!e.isModificationStatus()&&!e.hasWritingComment()||confirm(IM("comment.cancel_writing_comment")))},_sendSceneEnterLog:function(){this._getBandData().then(i.bind((function(){this.jplSceneEnter(u.CLASSIFIER.POST_DETAIL,{band_no:this.model.getBandCore().bandNo,post_no:this.model.getPostNo(),writer_no:this.model.getAuthor().get("userNo"),band_type:this.model.getBandCore().type,is_preview:this.bandData.isPreviewForJplExtra()})}),this))},_getBandData:function(){return this.bandData?$.Deferred().resolve():b.get(this.model.getBandCore().bandNo).loadBandData().then(i.bind((function(){this.bandData=b.get(this.model.getBandCore().bandNo)}),this))},_onClickBtnGoToTop:function(e){e.stopPropagation(),this.getUI("scrollContainer").scrollTop(0)}});return v.buildPostDetailAsLayer=function(e){var t=new s;t.fetchPostDetail(e.bandNo,e.postNo,!0).done((function(){if(t.get("isRestricted"))alert(IM("post.msg.post_is_restricted"));else{var n=new v({model:t,postNo:e.postNo,postCollection:e.postCollection,hasBandHeader:e.hasBandHeader||!1,initCommentId:e.initCommentId,initCommentReplyId:e.initCommentReplyId,approachedPostListType:e.approachedPostListType,uncoverOnce:e.uncoverOnce});o.open(n)}})).fail((function(t){1e3===t.result_code&&r.getPostChannel().trigger(r.EVENT.POST_DELETED,{bandNo:e.bandNo,postNo:e.postNo})}))},v.buildFeedPostDetailAsLayer=function(e){var t=new s;t.fetchPostDetail(e.bandNo,e.postNo,!0).done((function(){if(t.get("isRestricted"))alert(IM("post.msg.post_is_restricted"));else{var n=new v({model:t,postNo:e.postNo,postCollection:e.postCollection,hasBandHeader:!0,closeOnReported:!0,initCommentId:e.initCommentId,initCommentReplyId:e.initCommentReplyId,uncoverOnce:e.uncoverOnce});o.open(n)}})).fail((function(t){1e3===t.result_code&&r.getPostChannel().trigger(r.EVENT.POST_DELETED,{bandNo:e.bandNo,postNo:e.postNo})}))},v.buildApprovablePostDetailAsLayer=function(e){var t=new s;t.fetchApprovablePost(e.bandNo,e.approvablePostId).done((function(){var n=new v({model:t,uncoverOnce:e.uncoverOnce});o.open(n)})).fail((function(e){1e3===e.result_code&&alert(IM("approvable.alert.already_removed"))}))},v}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i="/v2.0.0/get_my_approvable_post_count",o="/v2.0.0/get_approvable_post_count",s="/v2.0.0/get_approvable_posts",a="/v2.0.0/get_my_approvable_posts",r="/v2.0.0/get_my_approvable_post",l="/v2.0.0/delete_my_approvable_posts",c="/v2.0.0/delete_approvable_posts",d="/v2.0.0/get_approvable_post",u="/v2.0.0/approve_posts";return{getMyApprovablePostCount:function(e){return t.createLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+i,data:{band_no:e}}).then((function(e){return e.my_approvable_post_count}))},getApprovablePostCount:function(e){return t.createLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+o,data:{band_no:e}}).then((function(e){return e.approvable_post_count}))},getApprovablePosts:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+s,data:e})},getMyApprovablePosts:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+a,data:e})},deleteApprovablePosts:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+c,data:{band_no:e,approvable_post_ids:n}})},postApprovePosts:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+u,method:"POST",data:{band_no:e,approvable_post_ids:n}})},deleteMyApprovablePosts:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+l,data:{band_no:e,approvable_post_ids:n}})},getMyApprovablePost:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+r,data:{band_no:e,approvable_post_id:n}})},getApprovablePost:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+d,data:{band_no:e,approvable_post_id:n}})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(4),s=n(488),a=n(154),r=n(656),l=o.Behavior.extend({options:{dimUI:void 0,runOnDomRefresh:!1,containerUI:void 0,clickDimTrigger:void 0,modelFunction:function(){return this.model}},initialize:function(){if(!this.options.dimUI)throw new Error("dimUI required");this.view.dimUpdateArea=i.bind(this._updateDimArea,this)},ui:{undimArea:"."+s.ELEMENT.OVER_DIM},events:function(){if(!this.options.clickDimTrigger)return{};var e={};return e["click @ui."+this.options.dimUI]=function(){return this.view.trigger(this.options.clickDimTrigger),!1},e},onDomRefresh:function(){this.options.runOnDomRefresh&&this._updateDimArea()},_getViewUI:function(e){if(this.view.ui)return this.view.getUI(e)},_updateDimArea:function(e){var t,n=this._getModel(),o=!(!n||!r.isStateDimCovered(n));this._getViewUI(this.options.dimUI).toggleClass("gDimmed",o),this.options.containerUI&&"static"===(t="@"===this.options.containerUI?this.view.$el:this._getViewUI(this.options.containerUI)).css("position")&&t.css("position","relative"),this.getUI("undimArea")&&this.getUI("undimArea").length>0&&(o?a.wrapDeferPromise(this.view).then(i.bind((function(){var e=parseInt(this._getViewUI(this.options.dimUI).css("z-index")),t=this.getUI("undimArea");t.css("z-index",e+1),t.each((function(){var e=$(this);"static"===e.css("position")&&e.css("position","relative")}))}),this)):this.getUI("undimArea").css("z-index","").css("position","")),i.isFunction(e)&&e.call(this.view,o)},_getModel:function(){return this.options.modelFunction.call(this.view)}});l.with=function(e){return i.extend({behaviorClass:l},e)},e.exports=l},,,,,,,function(e,t,n){var i;void 0===(i=function(e){n(2),n(0);var t=n(155),i=n(513),o=(n(17),n(153)),s=n(162);return{goToBandByClick:function(e,n){t.get(e).loadBandData().then((function(){var i=t.get(e);n?i.getBandCore().goBandDForced(o.GROUP_BAND_POST_DETAIL,s.PAGE_BAND_POST_DETAIL,{band_no:e,post_no:n}):i.getBandCore().goBandDForced(o.GROUP_BAND_HOME,s.PAGE_BAND_HOME,{band_no:e})}))},openPreviewBandWindowByClick:function(e){i.openWindowXSSSafely(location.protocol+"//"+location.host+e,"_blank")}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=(n(0),n(2)),o=n(169);return t.View.extend({attributes:{"view-name":"DLayerContainerInnerView",role:"dialog","aria-live":"polite"},template:function(){return'<button type="button" aria-hidden="true" class="_layerFirstElement" style="position:fixed;left:0;top:0;width:1px;height:1px;overflow:hidden;background:transparent;color:transparent">layer focus check first element</button><div aria-hidden="true" class="_layerTmpFocusElement" tabindex="-1" style="position:fixed;left:0;top:0;width:1px;height:1px;overflow:hidden;background:transparent;color:transparent"></div><div class="_layerContent"></div><button type="button" aria-hidden="true" class="_layerLastElement" style="position:fixed;left:0;top:0;width:1px;height:1px;overflow:hidden;background:transparent;color:transparent">layer focus check last element</button>'},ui:{layerFirstElement:"._layerFirstElement",layerLastElement:"._layerLastElement",layerTmpFocusElement:"._layerTmpFocusElement"},regions:{layerContent:{el:"._layerContent",replaceElement:!0}},events:{"focus @ui.layerFirstElement":"_layerFocusCheck","focus @ui.layerLastElement":"_layerFocusCheck","blur @ui.layerTmpFocusElement":"_removeLayerTmpFocusElement"},initialize:function(e){this._layerView=e.layerView,this._layerCallElement=e.layerCallElement},onAttach:function(){this.getUI("layerTmpFocusElement").focus(),this.getRegion("layerContent").show(this._layerView),this.listenTo(this._layerView,"detach",(function(){this.destroy()}))},_removeLayerTmpFocusElement:function(){this.getUI("layerTmpFocusElement").remove()},_findFocusableElement:function(){return this._layerView.$el.find(o.FOCUSABLE_ELEMENTS_STRING).filter(":visible")},_layerFocusCheck:function(e){var t=i(e.target),n=null,o=this._findFocusableElement();t.get(0)==this.getUI("layerFirstElement").get(0)?n=o.last():t.get(0)==this.getUI("layerLastElement").get(0)&&(n=o.first()),n.length?n.focus():this.getUI("layerFirstElement").next().attr("tabindex",-1).focus()},getLayerView:function(){return this._layerView},getLayerCallElement:function(){return this._layerCallElement}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(504),i=n(152),o=n(501),s=n(179),a=n(163),r=n(22);return{getAuthorInfo:function(e,n){var l="",c="",d="",u="",h=r.MEMBER_TYPE.MEMBERSHIP;if(n){if(!(n instanceof t||n instanceof o))throw new Error("not supported UserModel");h=n.get("memberType"),e===i.VIEW_TYPE_BIRTHDAY?(l=IM("web.post.author.label.type_birthday",{userName:n.get("name")}),d=s.PROFILE_BIRTHDAY.make()):e===i.VIEW_TYPE_ANNIVERSARY?(l=IM("web.post.author.label.type_anniversary"),d=s.PROFILE_BIRTHDAY.make(),h=r.MEMBER_TYPE.PAGE_PROFILE):(l=n.get("name"),c=n.get("desc"),d=n.get("profileImageUrl"),u=n.get("role"))}else d=s.PROFILE_DEFAULT_R1.make();return{name:l,desc:c,profileImageUrl:d,role:u||{},memberProfile:new a({name:l,profileImageUrl:d,memberType:h})}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1301),s=n(157),a=n(153),r=n(162),l=n(84),c=n(13),d=n(170),u=n(510),h=n(547),p=n(1112),m=n(1246),_=n(521),g=n(155),f=n(743),b=n(491),v=n(518),A=n(744),E=n(486),T=n(1176),C=n(548),y=n(562),M=n(53),I=n(87),S=i.Object.extend({formModel:void 0,submitModel:void 0,bandCore:void 0,initialize:function(){this._subscribePageFromEditProfile=!1,this.formModel=new f,this.submitModel=void 0},_goLoginIfneeded:function(){if(!c.isLogedIn())return d.goLoginPage(this.options.nextUrlAfterLogin),!0},subscribePageFromEditProfile:function(e){this._subscribePageFromEditProfile=!0,this.startJoinFromBand(e)},startJoinFromBand:function(e){this._goLoginIfneeded()||b.getCachedBandData(e).then(t.bind((function(n){n.isUserJoinApplied()?this._openAlreadyAppliedModal(e):(this.bandCore=n.getBandCore(),this.submitModel=A.buildJoinTypeBandNo(e),this.formModel.fetchMemberFormByBandNo(e).then(t.bind(this._openVerificationEmailSendLayerView,this)).fail(this._onFormSelectFail()))}),this))},startJoinFromInvitationCard:function(e,n){this._goLoginIfneeded()||(this.bandCore=n,this.submitModel=A.buildJoinTypeInvitationCardId(e),this.formModel.fetchByInvitationCardId(e).then(t.bind(this._openVerificationEmailSendLayerView,this)).fail(this._onFormSelectFail(e)))},_openAlreadyAppliedModal:function(e){u.openLayer({bodyDesc:IM("band.already_applied.modal.msg"),confirm:IM("web.modal.btn.confirm"),cancel:IM("band.cancel_applied.btn.label")}).once(u.EVENTS.CANCEL,t.bind((function(){g.get(e).resetBandDataState(),h.cancelApplication(e).then(t.bind((function(){this.getOption("onRefreshPage").call(this)}),this))}),this))},_openVerificationEmailSendLayerView:function(){if(this.formModel.isEmailVerificationEnabled()){var e=T.openAsLayer(this.bandCore.bandNo);this.listenToOnce(e,"apply:next",(function(e){this.submitModel.setEmailVerificationToken(e),this._openBandJoinFormView()}))}else this._openBandJoinFormView()},_openBandJoinFormView:function(){this.formModel.hasJoinQuestion()?this.listenToOnce(o.openLayer(this.formModel),"DBandJoinFormView",(function(e,t){e===o.EVENTS.CONFIRM&&(this.submitModel.setJoinAnswer(t.joinAnswer),this.submitModel.setJoinAnswerImages(t.joinAnswerImages),this._openProfileSetSelectView())})):this._openProfileSetSelectView()},_openProfileSetSelectView:function(){v.fetchProfileSets().then(t.bind((function(e){var n=this.formModel.get("needAdAgreement");if(!this._subscribePageFromEditProfile&&this.bandCore.supportDefaultProfileForPage()){var i=e.getPageDefaultProfileSet();if(i){var o=$.Deferred();return n?u.openLayer({bodyTitle:IM("bandjoin.desc.ad_agreement.page_band"),bodyDesc:IM("bandjoin.confirm_desc.ad_agreement.page_band"),withoutHiding:!0}).once(u.EVENTS.CONFIRM,(function(){o.resolve()})):o.resolve(),void o.then(t.bind((function(){this.submitModel.setUserProfileSetId(i.get("userProfileSetId")),this.onApplyComplete()}),this))}}var s=p.openBandJoinLayer(e,this.bandCore,this._subscribePageFromEditProfile,n);this.listenToOnce(s,"DProfileSetSelectView",(function(e,t,n){var i=p.EVENTS;switch(e){case i.PROFILE_SET_SELECTED:this.submitModel.setUserProfileSetId(t.get("userProfileSetId")),n&&this.submitModel.setSetDefaultProfileSetOfPage(!0),this.onApplyComplete();break;case i.NEW_PROFILE:this._openProfileSetInputView(n)}}))}),this))},_openProfileSetInputView:function(e){this.listenTo(m.openBandJoinLayer(this.bandCore,e),"DProfileSetInputView",(function(e,t){e===m.EVENTS.CONFIRM&&(this.submitModel.setNewProfile(t.name,t.profileImageUrl),t.setDefaultProfileSetOfPage&&this.submitModel.setSetDefaultProfileSetOfPage(!0),this.onApplyComplete((function(){E.closeTop()})))}))},_handleInvitationForKids:function(e){y.openLayer({bodyDesc:IM("invitation.error.kids.user.approach.to.not.kids.band")}).once(y.EVENTS.CONFIRM,t.bind((function(){if(e){C.deleteInvitationCard(e,!1).then(t.bind((function(){M.getCurrentRouteInfo(),M.getCurrentRouteInfo().routeInfo!=s.GLOBAL_INVITE?M.getCurrentRouteInfo().routeInfo!=s.GLOBAL_FINDING_INVITATION?M.getCurrentRouteInfo().routeInfo==s.GLOBAL_HOME&&this.getOption("onRefreshPage").call():this.getOption("onRefreshPage").call():s.GLOBAL_HOME.goDForced()}),this))}}),this))},_onFormSelectFail:function(e){return t.bind((function(n){var i=t.propertyOf(n)("result_code"),o=t.property("message")(t.propertyOf(n)("result_data"));1060!=i?I.isUserAlertResultCode(i)?alert(o):i>=300&&(o&&alert(o),1016!==i&&1017!==i||s.GLOBAL_MY_PROFILE.goDForced({},{invitationId:this.submitModel.get("invitation_card_id"),bandNo:this.submitModel.get("band_no")})):this._handleInvitationForKids(e)}),this)},onApplyComplete:function(e){t.isFunction(e)||(e=t.noop),this.submitModel.submit().then(t.bind((function(n){_.buildPersonalInfoAgreementData().setPersonalInfoAgreements(_.AGREE_TARGET.PROFILE_IMAGE).then(t.bind((function(){g.get(this.bandCore.bandNo).resetBandDataState(),e(),this.formModel.isJoinMethodNormal()?this.getOption("onBandJoinCompleted").call(this,t.propertyOf(n)("message")):this.getOption("onRefreshPage").call(this,t.propertyOf(n)("message"))}),this))}),this)).fail(t.bind((function(t){"1011"==t.result_code?(e(),this.getOption("onBandJoinCompleted").call(this)):"1014"==t.result_code&&(e(),this.getOption("onRefreshPage").call(this,t.result_data.message))}),this))}});return S.build=function(e){return e=t.extend({nextUrlAfterLogin:location.href,onBandJoinCompleted:function(e){e&&alert(e),this.bandCore.goBandDForced(a.GROUP_BAND_HOME,r.PAGE_BAND_HOME,{band_no:this.bandCore.bandNo})},onRefreshPage:function(e){e&&alert(e),l.refreshCurrentPage()}},e),new S(e)},S}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(1998),o=n(152),s=n(2),a=n(906);t.widgetViewCreator=function(e){return function(t,n){return new e({model:n,el:t})}},t.createLayoutModify=function(e){return function(t,n,i){var o=e(t);o.once(a.EVENT.ATTACH,_.bind(n,this)),o.once(a.EVENT.CANCEL,_.bind(i,this))}};t.injectAttachmentWidget=function(e,t,n){var r=o.isSingleAttachmentType(e.postSpecType),l=(r?'<band:attachment type="{attachmentType}"></band:attachment>':'<band:attachment type="{attachmentType}" id="{id}"></band:attachment>').replace("{attachmentType}",e.apiType);t.widgets.add(e.postSpecType,{template:l,init:function(){var o=s(this.element.$),l=o.attr("id");if(this.model=r?n.getAttachment(e.postSpecType):n.getAttachment(e.postSpecType).get(l),this.model)s(this.element.$).attr("data-model",encodeURIComponent(JSON.stringify(this.model.toJSON())));else{var c=s(this.element.$).attr("data-model"),d=s.parseJSON(decodeURIComponent(c));this.model=e.createModelFromJSON(d),r?n.setAttachment(e.postSpecType,this.model):n.addAttachment(e.postSpecType,l,this.model)}if(this.view=e.createWidgetView.call(this,o,this.model),this.view.render(),this.view.on("remove",_.bind((function(){t.widgets.del(this),t.fire(a.EVENT.WIDGET_CHANGED)}),this)),e.onWidgetModify){var u=_.bind((function(i){if(t.focusManager.unlock(),this.model=i,r)n.setAttachment(e.postSpecType,i);else{var s=o.attr("id");n.addAttachment(e.postSpecType,s,i)}this.view.model=i,this.view.render()}),this),h=_.bind((function(){t.focusManager.unlock(),n.hasAttachment(e.postSpecType,r?void 0:l)||t.widgets.del(this)}),this);this.view.on("modify",_.bind((function(){t.focusManager.lock();var n=e.createModelFromJSON(this.model.toJSON());_.defer(_.bind(e.onWidgetModify,this),n,u,h)}),this))}if(!1!==e.dragHandlerWidth){var p=e.dragHandlerWidth?_.isFunction(e.dragHandlerWidth)?e.dragHandlerWidth(this):e.dragHandlerWidth:"100%";i(this,p)}_.isFunction(e.callback)&&e.callback(this),this._bindWidgetStatusChangeEvents(this)},destroy:function(){if(this.view&&this.view.destroy(),r)n.unsetAttachment(e.postSpecType);else{var t=s(this.element.$).attr("id");n.removeAttachment(e.postSpecType,t)}},upcast:function(t){return"band:attachment"===t.name&&t.attributes.type===e.apiType},_bindWidgetStatusChangeEvents:function(e){var n=s(e.element.$).parent(),i={justAdjustPosition:!0};n.on("mouseover",(function(){t.fire(a.EVENT.WIDGET_CHANGED,i)})),n.on("mouseout",(function(){t.fire(a.EVENT.WIDGET_CHANGED,i)})),e.view.on(a.EVENT.WIDGET_MEDIA_LOADED,(function(){t.fire(a.EVENT.WIDGET_CHANGED,i)})),e.on("blur",(function(){t.fire(a.EVENT.WIDGET_CHANGED,i)}))}})}},function(e,t,n){var i=n(0),o=n(4),s=n(1318),a=n(486),r=o.View.extend({EVENT:{CONFIRM:"modal:confirm",CANCEL:"modal:cancel",RADIO_CLICK:"RADIO_CLICK"},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DRadioButtonListModalView"},template:i.template(s),templateContext:function(){return i.extend({viewId:this.cid,initialCheckedValue:""},this.options)},ui:{btnConfirm:'[data-uiselector="btnConfirm"]',btnCancel:'[data-uiselector="btnCancel"]',inputRadios:'[data-uiselector="inputRadio"]'},events:{"click @ui.btnConfirm":"_confirm","click @ui.btnCancel":"_cancel","click @ui.inputRadios":"_onRadioClick","change @ui.inputRadios":"_check"},_confirm:function(){var e=this.ui.inputRadios.filter(":checked").val();e?(this.destroy(),this.trigger(this.EVENT.CONFIRM,e)):this._check()},_cancel:function(){this.destroy(),this.trigger(this.EVENT.CANCEL)},_onRadioClick:function(e){this.trigger(this.EVENT.RADIO_CLICK,e)},_check:function(){1==this.ui.inputRadios.filter(":checked").length?this.ui.btnConfirm.removeAttr("data-status").addClass("uButtonPoint"):this.ui.btnConfirm.attr("data-status","off").removeClass("uButtonPoint")},onRender:function(){this._check()},layerOnEscKeyDown:function(){this._cancel()}});r.openAsLayer=function(e){e.description=e.description||null;var t=new r(e);return e.withoutHiding?a.openWithoutHiding(t):a.open(t),t},e.exports=r},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(9);return{MAX_LENGTH_AUTH_CODE:4,PHONE_VERIFY_AUTHENTICATION_TIMER:30,BIRTH_YEAR_RANGE:(t=(new Date).getFullYear(),{min:t-100,max:t-i.spec.getBandAccessibleAge()}),MESSAGE_SEND_KEY:{API_KEY_NAME:{CHAT:"chat_enter",COMMENT:"comment_enter"},VIEW_TYPE:{GNB_CHAT_LIST:"gnb:chat:list",SETTING_HOME:"setting:home"}},AUTH_TYPE_2FA:"auth:type:2fa",LOGIN_FACTOR_2FA:{PHONE_NUMBER:"phone_number",TOTP:"totp"},SMS_AUTH_COMPLETE:"sms:auth:complete"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){n(0);var t=n(52),i=n(6),o=n(501),s=n(490),a=n(532).ATTENDANCE_CHECK_STATE;return i.Model.extend({constructor:function(e,t){(t=t||{}).parse=!0,i.Model.apply(this,[e,t])},parse:function(e,n){var i=(e=t.camelizeKeys(e)).state;i||e.isChecked||(i=a.UNCHECKED);var s={isChecked:e.isChecked,checkedAt:e.checkedAt,state:i,stateDescription:e.stateDescription,attendee:new o(e.attendee,{parse:!0})};return e.attendeeOwner&&(s.attendeeOwner=new o(e.attendeeOwner,{parse:!0})),s},isUserNoSame:function(e){return!!e&&e==this.getAttendeeUserNo()},getAttendeeUserNo:function(){return this.getAttendee().get("userNo")},getChildMembershipId:function(){return this.getAttendee().get("childMembershipId")},getAttendee:function(){return this.get("attendee")},getAttendeeOwner:function(){return this.get("attendeeOwner")},isOwnerUserNoSame:function(e){return!(!e||!this.getAttendeeOwner()||this.getAttendeeOwner().get("userNo")!=e)},isCheckStatus:function(){return this.get("isChecked")},getCheckedAt:function(){return this.get("checkedAt")},getLowerCaseName:function(){return this.getAttendee().get("name")?this.getAttendee().get("name").toLowerCase():null},getState:function(){return this.get("state")},getStateDescription:function(){return this.get("stateDescription")},toJSON:function(){return s.toRecursiveJSON(this)},toJSONForSave:function(){var e={};e.user_no=this.get("attendee").get("userNo");var t=this.get("attendee").get("childMembershipId");return t&&(e.child_membership_id=t),{attendee:e}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0);t.doAsyncJobsSequencial=function(e,t,n){return i.reduce(e,(function(e,n,i){return e.then((function(e){return t(n,i,e)}))}),$.Deferred().resolve(n))}},function(e,t,n){var i;void 0===(i=function(e){n(0);var t=n(13),i=n(21),o="/v2.0.0/create_mission",s="/v2.0.0/update_mission",a="/v2.0.0/get_ongoing_missions",r="/v2.0.0/get_not_ended_missions",l="/v2.0.0/get_ended_missions",c="/v2.0.0/get_ended_mission_count",d="/v2.1.0/end_mission",u="/v2.0.0/delete_mission",h="/v2.0.0/get_my_missions",p="/v2.0.0/get_participated_missions",m="/v2.0.0/get_participated_mission_count",_="/v2.0.0/get_mission",g="/v2.0.1/get_mission_for_recruiting_band",f="/v2.0.0/update_mission_for_recruiting_band",b="/v2.0.0/get_mission_confirm_summary",v="/v2.0.0/get_mission_confirm_summaries",A="/v2.0.0/set_mission_remind_state";return{_getApiClient:function(){return this.apiClient||(t.isLogedIn()?this.apiClient=i.getLoginV1Client():this.apiClient=i.getNoLoginV1Client()),this.apiClient},_getApiV1ClientWithoutErrorAlert:function(){return this._apiV1ClientWithoutErrorAlert||(this._apiV1ClientWithoutErrorAlert=i.createLoginV1ClientWithoutErrorAlert())},createMission:function(e,t){e=JSON.stringify(e);return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+o,data:{mission:e,band_no:t},method:"POST"})},updateMission:function(e,t){e=JSON.stringify(e);return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+s,data:{mission:e,band_no:t},method:"POST"})},getOnGoingMissions:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+a,data:{band_no:e},method:"GET"})},getNotEndedMissions:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+r,data:e,method:"GET"})},getEndedMissions:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+l,data:e,method:"GET"})},getEndedMissionCount:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+c,data:{band_no:e},method:"GET"})},endMission:function(e,t){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+d,data:{band_no:e,mission_id:t},method:"GET"})},deleteMission:function(e,t){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+u,data:{band_no:e,mission_id:t},method:"GET"})},getMyMissions:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+h,data:{band_no:e},method:"GET"})},getParticipatedMissions:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+p,data:e,method:"GET"})},getParticipatedMissionCount:function(e){return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+m,data:{band_no:e},method:"GET"})},getMissionForRecruitingBand:function(e,t){var n={band_no:e};return t&&(n.purpose="copy"),this._getApiV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+g,data:n,method:"GET"})},updateMissionForRecruitingBand:function(e,t){e=JSON.stringify(e);return this._getApiClient().sendAndThenProcess({url:"https://api.band.us"+f,data:{mission:e,band_no:t},method:"GET"})},getMissionConfirmSummary:function(e,t,n){return this._getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us"+b,data:{band_no:e,mission_id:t,user_no:n},method:"GET"})},getMission:function(e,t,n){var i={band_no:e,mission_id:t};return n&&(i.purpose="copy"),this._getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us"+_,data:i})},getMissionConfirmSummaries:function(e){var t=!1;return e.orderBy===e.sortType.NEVER_CONFIRMED&&(t=!0,e.orderBy=null),this._getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us"+v,data:{band_no:e.bandNo,mission_id:e.missionId,order_by:e.orderBy,never_confirmed:t,start_at:e.startAt,end_at:e.endAt}})},setMissionRemindState:function(e,t,n){return this._getApiClient().sendAndThenProcessWithErrorAlert({url:"https://api.band.us"+A,data:{band_no:e,mission_id:t,remind_state:n}})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21);return{getSharedPostSnippet:function(e,n){var i={source_band_no:e,source_post_no:n};return t.getLoginV1Client().send({url:"https://api.band.us/v1.0.0/get_shared_post_snippet",data:i}).then((function(e,t,n){return e.result_data}))},sharePost:function(e){return t.getLoginV1Client().send({url:"https://api.band.us/v1.0.0/share_post",type:"POST",data:e}).then((function(e,t,n){return e.result_data}))},getSharedPostCount:function(e,n){var i={band_no:e,post_no:n};return t.getLoginV1Client().send({url:"https://api.band.us/v1.0.0/get_shared_post_count",data:i}).then((function(e,t,n){return e.result_data}))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(156);return t.Model.extend({defaults:function(){return{id:this.cid,isVideo:!1,savableState:null}},parse:function(e,t){var n=(e=i.camelizeKeys(e)).video,s={photoNo:e.photoNo,photoUrl:e.photoUrl,width:e.width,height:e.height,contentType:e.contentType,isVideo:!1,videoId:null,videoTitle:null,isExpiredVideo:!1,savableState:e.savableState||null,expiresAt:null,isGifVideo:!1,emotionCount:e.emotionCount,commentCount:e.commentCount};return n&&(s.isVideo=!0,s.videoId=n.videoId,s.videoTitle=n.title,s.isExpiredVideo=o.isExpiredFile(n.expiresAt),s.expiresAt=n.expiresAt,s.isGifVideo=n.isGif),s},getSavableState:function(){return this.get("savableState")},getPhotoNo:function(){return this.get("photoNo")},getPhotoUrl:function(){return this.get("photoUrl")},getWidth:function(){return this.get("width")},getHeight:function(){return this.get("height")},isVideo:function(){return this.get("isVideo")},getCommentCount:function(){return this.get("commentCount")},getEmotionCount:function(){return this.get("emotionCount")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(52),s=n(156),a=n(504);return i.Model.extend({defaults:function(){return{id:this.cid,photoNo:null,postNo:null,author:null,width:0,height:0,commentCount:0,emotionCount:0,isGif:!1,isRestricted:!1,logoImage:null,isVideo:!0,savableState:null,createdAt:null,expiresAt:null,isLive:!1}},parse:function(e){e=o.camelizeKeys(e);var n=t.extend(this.defaults(),{id:e.id,photoNo:e.photoNo,postNo:e.postNo,width:e.width,height:e.height,commentCount:e.commentCount||0,emotionCount:e.emotionCount||0,isGif:e.isGif||!1,isRestricted:e.isRestricted||!1,logoImage:e.logoImage,isVideo:!0,savableState:e.savableState||null,createdAt:e.createdAt||null,expiresAt:e.expiresAt||null,isLive:e.isLive||!1});return n.isExpiredVideo=s.isExpiredFile(n.expiresAt),e.author&&(n.author=new a(e.author,{parse:!0})),n},getSavableState:function(){return this.get("savableState")},getPhotoNo:function(){return this.get("photoNo")},isGif:function(){return this.get("isGif")},getWidth:function(){return this.get("width")},getHeight:function(){return this.get("height")},getLogoImage:function(){return this.get("logoImage")},getExpiresAt:function(){return this.get("expiresAt")},isVideo:function(){return this.get("isVideo")},getCommentCount:function(){return this.get("commentCount")},getEmotionCount:function(){return this.get("emotionCount")},isLive:function(){return this.get("isLive")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){n(2),n(0);var t=n(52),i=n(6),o=n(152),s=n(490),a=i.Model.extend({defaults:function(){return{pollId:null,title:null,isAnonymous:!1,isSubjectAddible:!1,isMultipleSelect:!0,isSubjectCountless:!1,orderBy:o.POLL_ORDER_BY_SEQ,subjects:new i.Collection([],{model:r}),remainMember:new l,endedAt:null,voteVisibleQualification:null,isVoteVisibleToViewer:!1,isVoteLimited:!1,votableLimit:null,isVoted:!1,isOpen:!1}},parse:function(e,n){var s={pollId:(e=t.camelizeKeys(e)).id,bandNo:e.bandNo,postNo:e.postNo,isAuthor:e.isAuthor,title:e.title,count:e.count,isOpen:e.isOpen,isAnonymous:e.isAnonymous,isSubjectAddible:e.isSubjectAddible,isMultipleSelect:!e.isSingleSelect,isSubjectCountless:e.isSubjectCountless,orderBy:e.orderBy,isVoted:e.isVoted,subjects:null,remainMember:null,endedAt:e.endedAt,voteVisibleQualification:e.voteVisibleQualification,isVoteVisibleToViewer:e.isVoteVisibleToViewer,isVoteLimited:e.isVoteLimited,votableLimit:e.votableLimit};return e.subjects?(s.subjects=new i.Collection(e.subjects,{model:r,parse:!0}),s.subjects.length>=o.POLL_SUBJECT_LIMIT&&(s.isSubjectAddible=!1)):delete s.subjects,e.remain_member&&(s.remainMember=new l(e.remain_member,{parse:!0})),s},toJSON:function(){return s.toRecursiveJSON(this)}}),r=i.Model.extend({parse:function(e,t){var n={pollSubjectId:e.poll_subject_id,title:e.title,voters:null,voterCount:e.voter_count,isVoted:e.is_voted,isUpdated:e.is_updated,isAdded:e.is_added};return e.voters&&(n.voters=e.voters),n}}),l=i.Model.extend({defaults:{voterCount:0,voters:null},parse:function(e,t){var n={voterCount:e.voter_count||0,voters:null};return e.voters&&(n.voters=e.voters),n}});return a}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){n(2),n(0);var t=n(52),i=n(6),o=n(152),s=n(504),a=n(490),r=i.Model.extend({defaults:function(){return{todoId:null,title:null,isTaskAddible:!1,isCheckableOnlyByAuthor:!1,tasks:new i.Collection([],{model:l}),endedAt:null}},parse:function(e,n){var s={todoId:(e=t.camelizeKeys(e)).todoId,isAuthor:e.isAuthor,bandNo:e.bandNo,postNo:e.postNo,title:e.title,numberOfTasks:e.numberOfTasks||0,numberOfDone:e.numberOfDone||0,isTaskAddible:e.isTaskAddible,isCheckableOnlyByAuthor:e.isCheckableOnlyByAuthor,tasks:new i.Collection(e.tasks,{model:l,parse:!0}),endedAt:e.endedAt};return s.tasks.length>=o.TODO_TASK_LIMIT&&(s.isTaskAddible=!1),s},toJSON:function(){return a.toRecursiveJSON(this)},isTodoV1:function(){return!this.isTodoV2()},isTodoV2:function(){return!!this.get("todoId")},getTask:function(e){return this.get("tasks").find({taskId:e})}}),l=i.Model.extend({parse:function(e,n){var i={taskId:(e=t.camelizeKeys(e)).taskId,subject:e.subject,isChecked:e.isChecked,isUpdated:e.isUpdated,isAdded:e.isAdded,actor:null};return e.actor&&(i.actor=new s(e.actor,{parse:!0})),i},toJSON:function(){return a.toRecursiveJSON(this)},isCheckedByMe:function(){return!!this.get("actor")&&this.get("actor").isMyself()}});return r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(52),s=n(504),a=n(687),r=n(13),l=n(578),c=n(490),d=i.Model.extend({defaults:function(){var e=l.getCurrencyCode(window.countryCode)||"USD";return{totalPrice:null,isEditable:!0,currency:e,currencyLabel:l.getCurrencyLabel(e),members:new i.Collection([],{model:u})}},parse:function(e,t){var n={bandNo:(e=o.camelizeKeys(e)).bandNo,postNo:e.postNo,isAuthor:e.isAuthor,currency:e.currency,isEditable:e.isEditable,currencyLabel:l.getCurrencyLabel(e.currency),memberCount:e.memberCount,paidMemberCount:e.paidMemberCount,totalPrice:e.totalPrice,members:null};return e.members&&e.members.length>0?n.members=new i.Collection(e.members,{model:u,parse:!0}):delete n.members,n},setMemberPaid:function(e){var t=this.get("members").at(e);return a.payBill(this.get("bandNo"),this.get("postNo"),t.get("userNo"))},toJSON:function(){return c.toRecursiveJSON(this)}}),u=i.Model.extend({defaults:{price:null},parse:function(e,n){var i={price:(e=o.camelizeKeys(e)).price,isPaid:e.isPaid,isCurrentUser:!1};return e.member&&((i=t.extend(i,new s(e.member,{parse:!0}).attributes)).isCurrentUser=r.getUserData().getUserNo()===i.userNo),i},toJSON:function(){return c.toRecursiveJSON(this)}});return d.createMemberModelFrom=function(e){var t=new u;return t.set(e.attributes),t},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(82);return t.Model.extend({parse:function(e,t){return{packNo:(e=i.camelizeKeys(e)).packNo,stickerId:e.stickerId,imageUrl:o.makeStickerImageUrl(e.packNo,e.stickerId),width:e.width,height:e.height}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(16),s=n(705),a=n(156);return t.Model.extend({parse:function(e,t){return{id:(e=i.camelizeKeys(e)).id,type:e.type,title:e.title,fileSize:e.size,fileSizeText:a.toStringFileSize(e.size),extension:e.extension,expiresAt:e.expiresAt,isExpired:o().isAfter(o(e.expiresAt))}},getFileUrl:function(e){return s.getFileUrl(e,this.get("id"))},isExpired:function(){return a.isExpiredFile(this.get("expiresAt"))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(156);return t.Model.extend({parse:function(e,t){return{type:"dropbox",spec:(e=i.camelizeKeys(e)).spec,title:e.name,link:e.link,fileSize:e.size,extension:o.getFileExtension(e.name),fileSizeText:o.toStringFileSize(e.size)}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(156);return t.Model.extend({parse:function(e,t){return{type:(e=i.camelizeKeys(e)).source,id:e.fileId,origin:e.origion,seq:e.seq,title:e.name,link:e.link,fileSize:e.size,extension:o.getFileExtension(e.name),fileSizeText:o.toStringFileSize(e.size)}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52);return t.Model.extend({parse:function(e){return i.camelizeKeys(e)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(52);return o.Model.extend({parse:function(e,t){return e=s.camelizeKeys(e),this.rawResponse=i.clone(e),{title:e.header.text,image:e.body.image&&e.body.image.url?e.body.image.url:null,description:e.body.text,subtitle:e.header.subtext,actionUrl:e.body.action&&e.body.action.pc&&"empty"!==e.body.action.pc?e.body.action.pc:null,actionCallbackUrl:e.body.action&&e.body.action.callback?e.body.action.callback:null}},requestActionCallback:function(){this.get("actionCallbackUrl")&&t.ajax(this.get("actionCallbackUrl"),{type:"GET"})}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(16),s=n(490),a=n(165),r=n(504),l=t.Model.extend({attachmentType:"schedule",idAttribute:"scheduleId",defaults:{isAllDay:!1,isDelete:!1,isRsvp:!1,scheduleDetail:null},parse:function(e){var t={bandNo:(e=i.camelizeKeys(e)).bandNo,scheduleType:e.scheduleType,scheduleId:e.scheduleId,iconType:"calendar",name:e.name,description:e.description,startAt:e.startAt,endAt:e.endAt,scheduleTimeZoneId:e.scheduleTimeZoneId,isLunar:e.isLunar,lunarDateString:e.lunarDateString,lunarEndDateString:e.lunarEndDateString,startAtAsLunar:e.startAtAsLunar,endAtAsLunar:e.endAtAsLunar,isAllDay:e.isAllDay,isDelete:e.isDelete,isRsvp:e.isRsvp,scheduleDetail:null,rsvp:new d};return"BIRTHDAY"==e.schedule_type?t.iconType="birth":"BAND_OPEN"==e.schedule_type&&(t.iconType="calendar-event"),e.rsvp&&(t.rsvp=new d(e.rsvp,{parse:!0})),e.schedule_detail&&(t.scheduleDetail=new c(e.scheduleDetail,{parse:!0})),t},toJSON:function(){return s.toRecursiveJSON(this)},getBandNo:function(){return this.get("bandNo")},getStartAt:function(){var e=this.get("isLunar")?this.get("startAtAsLunar"):this.get("startAt");return this._extractDateByMoment(e)},getEndAt:function(){var e=this.get("isLunar")?this.get("endAtAsLunar"):this.get("endAt");return this._extractDateByMoment(e)},getScheduleId:function(){return this.get("scheduleId")},getScheduleName:function(){return this.get("name")},getDescription:function(){return this.get("description")},getLocationAddress:function(){return this.get("locationAddress")},getStartAt:function(){return this.get("startAt")},isDeletedSchedule:function(){return this.get("isDelete")},_extractDateByMoment:function(e,t){return t=t||a.getCurrentTimezoneId(),e?o.tz(e,t):o.invalid()}}),c=t.Model.extend({parse:function(e){e=i.camelizeKeys(e);var t={owner:new r(e.owner,{parse:!0}),infoKey:e.infoKey,isNew:e.isNew,isBlockedRsvpInfo:e.isBlockedRsvpInfo,latitude:e.latitude,longitude:e.longitude,locationName:e.locationName,locationAddress:e.locationAddress,rsvpCount:null,repeatType:e.repeatType,repeatStartAt:e.repeatStartAt,repeatEndAt:e.repeatEndAt,alarms:e.alarms};return e.rsvpCount&&(t.rsvpCount=new d(e.rsvpCount,{parse:!0})),t},toJSON:function(){return s.toRecursiveJSON(this)},getAlarms:function(){return this.get("alarms")},getPhotos:function(){return this.get("photos")},isPhotoExist:function(){return this.getPhotoCount()>0},getPhotoCount:function(){return(this.getPhotos()||[]).length},getFiles:function(){return this.get("files")},isFileExist:function(){return this.getFileCount()>0},getFileCount:function(){return(this.getFiles()||[]).length}}),d=t.Model.extend({parse:function(e){return{attendeeCount:(e=i.camelizeKeys(e)).attendeeCount,absenteeCount:e.absenteeCount,maybeCount:e.maybeCount,nonresponseCount:e.nonresponseCount,attendeeLimit:e.attendeeLimit,endedAt:e.endedAt,userRsvpState:e.userRsvpState,attendeeList:new t.Collection(e.attendeeList,{model:r,parse:!0}),absenteeList:new t.Collection(e.absenteeList,{model:r,parse:!0}),maybeList:new t.Collection(e.maybeList,{model:r,parse:!0}),rsvpCountJson:e,isMaybeEnabled:e.isMaybeEnabled,customStates:e.customStates}},toJSON:function(){return s.toRecursiveJSON(this)},isMaybeEnabled:function(){return!!this.get("isMaybeEnabled")},getEndedAt:function(){return this.get("endedAt")}});return l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return n(6).Model.extend({defaults:{url:null,width:null,height:null}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52);return t.Model.extend({parse:function(e,t){return{name:(e=i.camelizeKeys(e)).name,albumNo:e.no,isDeleted:e.isDeleted,photoCount:e.photoCount}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(82),s=n(152);return t.Model.extend({parse:function(e,t){if((e=i.camelizeKeys(e)).sourcePost){var n=s.findPriorRestriction({isRestricted:e.sourcePost.isRestricted,isVisibleOnlyToAuthor:e.sourcePost.isVisibleOnlyToAuthor,isMutedAuthorPost:!!e.sourcePost.author&&e.sourcePost.author.isMuted});n&&(n===s.RESTRICTION_TYPE.HIDE_POST&&(e.image=null,e.body=IM("post.hidden_post.guide_message")),n===s.RESTRICTION_TYPE.MUTE_AUTHOR&&(e.image=null,e.body=IM("post.muted_author_post.guide_message")))}var a={bandNo:e.band.bandNo,bandName:e.band.name,certified:!!e.band.certified,body:e.body,image:e.image?e.image.url:null,imageWidth:e.image?e.image.width:null,imageHeight:e.image?e.image.height:null,isPlayButtonVisible:e.isPlayButtonVisible,isSourcePostUnavailable:e.isSourcePostUnavailable,postNo:e.postNo,thumbnailType:"false"};if(e.sourcePost&&(a.sourcePost=e.sourcePost),a.image){var r=a.imageWidth,l=a.imageHeight;r>200&&l>200?r<l?(a.thumbnailType="type2",a.thumbnailUrl=o.make(a.image,o.TYPE.ff196_294)):(a.thumbnailType="type3",a.thumbnailUrl=o.make(a.image,o.TYPE.ff768_432)):(a.thumbnailType="type1",a.thumbnailUrl=o.make(a.image,o.TYPE.s150))}return a},getSourcePost:function(){return this.get("sourcePost")},isSourcePostUnavailable:function(){return this.get("isSourcePostUnavailable")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(82);return t.Model.extend({parse:function(e,t){var n={bandNo:(e=i.camelizeKeys(e)).band.bandNo,bandName:e.band.name,certified:!!e.band.certified,body:e.body,image:e.image?e.image.url:null,imageWidth:e.image?e.image.width:null,imageHeight:e.image?e.image.height:null,isPlayButtonVisible:e.isPlayButtonVisible,isSourcePostUnavailable:e.isSourcePostUnavailable,postNo:e.postNo,thumbnailType:"false"};if(e.sourcePost&&(n.sourcePost=e.sourcePost),n.image){var s=n.imageWidth,a=n.imageHeight;s>200&&a>200?s<a?(n.thumbnailType="type2",n.thumbnailUrl=o.make(n.image,o.TYPE.ff196_294)):(n.thumbnailType="type3",n.thumbnailUrl=o.make(n.image,o.TYPE.ff768_432)):(n.thumbnailType="type1",n.thumbnailUrl=o.make(n.image,o.TYPE.s150))}return n},getSourcePost:function(){return this.get("sourcePost")},isSourcePostUnavailable:function(){return this.get("isSourcePostUnavailable")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(13),s=n(501);return t.Model.extend({defaults:function(){return{postNo:null,attendanceCheckId:null,title:null,attendeeCount:0,checkedAttendeeCount:0,isCheckableOnlyByManagers:!1,startAt:null,endedAt:null,timeZoneId:null,orderBy:null,seq:null,managers:new t.Collection(null,{model:s}),isAttendanceVisibleToViewer:null,attendanceVisibleQualification:null}},parse:function(e,n){return{postNo:(e=i.camelizeKeys(e)).postNo,attendanceCheckId:e.attendanceCheckId,title:e.title,attendeeCount:e.attendeeCount,checkedAttendeeCount:e.checkedAttendeeCount,isCheckableOnlyByManagers:e.isCheckableOnlyByManagers,startAt:e.startAt,endedAt:e.endedAt,timeZoneId:e.timeZoneId,orderBy:e.orderBy,seq:e.seq,managers:new t.Collection(e.managers||[],{model:s,parse:!0}),isAttendanceVisibleToViewer:e.isAttendanceVisibleToViewer,attendanceVisibleQualification:e.attendanceVisibleQualification}},getStartAt:function(){return this.get("startAt")},getEndedAt:function(){return this.get("endedAt")},getTimeZoneId:function(){return this.get("timeZoneId")},getManagers:function(){return this.get("managers")},isAttendanceCheckManager:function(){return!(!o.isLogedIn()||_.isEmpty(this.get("managers")))&&null!=this.getManagers().findWhere({userNo:o.getUserData().getUserNo()})},isAttendanceVisibleToViewer:function(){return this.get("isAttendanceVisibleToViewer")},getAttendanceVisibleQualification:function(){return this.get("attendanceVisibleQualification")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52);return t.Model.extend({defaults:function(){return{bandNo:null,isAuthor:null,signupId:null,seq:null,postNo:null,title:null,startAt:null,timeZoneId:null,taskCount:null,completedTaskCount:null,endedAt:null,isChildMemberAddible:null,childMemberLimit:null,createdAt:null}},parse:function(e){return i.camelizeKeys(e)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(617),s=t.Model.extend({attachmentType:"addon",defaults:function(){return{postAddonId:null,summary:new a}},parse:function(e,t){return{postAddonId:(e=i.camelizeKeys(e)).postAddonId,summary:new a(e.summary,{parse:!0})}},getAddonSummaryModel:function(){return this.get("summary")},getAddonType:function(){return this.getAddonSummaryModel().getAddonType()},getDescription:function(){return this.getAddonSummaryModel().getDescription()},isSupportVersion:function(){return this.getAddonSummaryModel().isSupportVersion()}}),a=t.Model.extend({defaults:function(){return{addonType:null,description:null,oneTimeToken:null,version:null}},parse:function(e,t){var n=i.camelizeKeys(e);return{addonType:n.addonType,description:n.description,oneTimeToken:n.oneTimeToken,version:n.version,name:n.name}},getAddonType:function(){return this.get("addonType")},getDescription:function(){return this.get("description")},getNameMap:function(){return this.get("name")},isSupportVersion:function(){return(this.get("version")||0)<=o.MAX_ADDON_SUPPORT_VERSION}});return s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return n(6).Model.extend({defaults:function(){return{postNo:null,bandNo:null,isAuthor:!1,audioId:null,audioDuration:null}},parse:function(e){return{bandNo:e.bandNo,postNo:e.postNo,isAuthor:e.isAuthor,audioId:e.audioId,audioDuration:e.audioDuration}},getAudioId:function(){return this.get("audioId")},getAudioDuration:function(){return this.get("audioDuration")},getPostNo:function(){return this.get("postNo")},getBandNo:function(){return this.get("bandNo")},isAuthor:function(){var e=this.get("isAuthor");return e||!1}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(6),o=n(501),s=n(490),a=n(52),r=(n(530).GRADED_STATE,i.Model.extend({parse:function(e){return{id:(e=a.camelizeKeys(e)).taker.userNo,gradedState:e.gradedState,takerPointTotal:e.takerPointTotal,takenAt:e.takenAt,taker:new o(e.taker,{parse:!0})}},toJSONForSave:function(){return{taker:{user_no:this.get("taker").getUserNo()}}},toJSON:function(){return s.toRecursiveJSON(this)},getTakenAt:function(){return this.get("takenAt")}}));r.createFromSimpleMemberViewModel=function(e){return new r({taker:new o(e.toJSON())})},e.exports=r},function(e,t,n){var i=n(0),o=n(6),s=n(691),a=o.Collection.extend({model:s,modelId:function(e){return e.choiceId||e.choice_id},initialize:function(e,t){},toJSONForSave:function(e){e=e||{};var t=this.filter((function(e){return e.hasContent()}));return i.map(t,(function(t){return t.toJSONForSave(e)}))},cloneChoices:function(){return new a(this.toJSONForSave(),{parse:!0})},resetChoices:function(e){this.reset(e.toJSONForSave(),{parse:!0})},getCorrectAnswerCount:function(){return this.filter((function(e){return e.isCorrectAnswer()})).length},addEmptyChoice:function(){this.add(new s)},hasContent:function(){return this.some((function(e){return e.hasContent()}))}});a.build=function(e){return new a(e,{parse:!0})},e.exports=a},function(e,t,n){var i;void 0===(i=function(e){n(0);var t=n(6),i=n(683),o=t.Collection.extend({model:i,modelId:function(e){return e.questionId||e.question_id},initialize:function(e,t){},toJSON:function(){return this.toJSONForSave()},toJSONForSave:function(e){return this.map((function(t){return t.toJSONForSave(e)}))},resetQuestionNumbers:function(){this.each((function(e,t){e.setQuestionNumber(t+1)}))}});return o.build=function(e){return new o(e,{parse:!0})},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(692),s=i.Collection.extend({model:o,modelId:function(e){return e.choiceId||e.choice_id},initialize:function(e,t){},toJSONForSave:function(e){e=e||{};var n=this.filter((function(e){return!e.isOtherChoice()}));return e.copy||(n=t.filter(n,(function(e){return e.hasContent()}))),t.map(n,(function(t){return t.toJSONForSave(e)}))},getChoiceCount:function(){return this._hasOtherChoice()?this.length-1:this.length},copyChoices:function(){var e=this.toJSONForSave({copy:!0});return s.build(e)},addEmptyChoice:function(){var e=o.buildEmptyChoice(),t=this._hasOtherChoice()?this.length-1:null;this.add(e,{at:t})},toggleOtherChoice:function(e){e?this._addOtherChoice():this._removeOtherChoice()},hasContent:function(){return this.some((function(e){return!e.isOtherChoice()&&e.hasContent()}))},_hasOtherChoice:function(){return!!this._getOtherChoice()},_getOtherChoice:function(){var e=this.last();return e&&e.isOtherChoice()?e:null},_addOtherChoice:function(){if(!this._hasOtherChoice()){var e=o.buildOtherChoice();this.add(e)}},_removeOtherChoice:function(){var e=this._getOtherChoice();e&&this.remove(e)}});return s.build=function(e){return new s(e,{parse:!0})},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(6),o=n(693),s=n(584),a=i.Collection.extend({model:o,addSurveyees:function(e){this.add(_.map(e,o.createFromSimpleMemberViewModel))},removeSurveyee:function(e){if(!_.isNumber(e))throw new Error("surveyeeUserNo must be number, but "+e);var t=this.find((function(t){return t.get("surveyee").getUserNo()===e}));if(!t)throw new Error("not expected");this.remove(t)},toJSONForSave:function(){return this.map((function(e){return e.toJSONForSave()}))},fetchSurveyeeCollection:function(e,t,n){return s.getSurveyees(e,t,n).then(_.bind((function(e){this.reset(e.surveyees,{parse:!0})}),this))}});a.createFromJSON=function(e){return new a(e)},a.createFromAPI=function(e){return new a(e,{parse:!0})},e.exports=a},function(e,t,n){var i=n(6),o=n(693),s=n(584),a=i.Collection.extend({model:o,initialize:function(e,t){this._bandNo=t.bandNo,this._postNo=t.postNo,this._surveyId=t.surveyId,this._isNonResponseIncluded=void 0},isNonResponseIncluded:function(){return this._isNonResponseIncluded},fetchSurveyeeListCollection:function(){return s.getSurveyees(this._bandNo,this._postNo,this._surveyId).then(_.bind((function(e){this._isNonResponseIncluded=e.is_nonresponse_included,this.reset(e.surveyees,{parse:!0})}),this))}});a.createSurveyeeListCollection=function(e,t,n){return new a(void 0,{bandNo:e,postNo:t,surveyId:n})},e.exports=a},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(52),o=n(6),s=n(489),a=n(719),r=n(152),l=n(165),c=n(43),d=n(9),u=n(34),h=n(13),p=s.extend({defaults:function(){return{durationType:null,amount:null,alarmTime:null}}}),m=o.Collection.extend({model:p}),_=s.extend({defaults:function(){return{bandNo:null,postNo:null,isAuthor:null,signupId:null,endedAt:null,isChildMemberAddible:null,childMemberLimit:null,taskId:null,subject:null,isViewerChecked:null,startAt:null,endAt:null,alarms:new m([]),attendeeLimit:null,checkedAttendeeCount:null,attendees:[]}},parse:function(e){var t=e.alarms||[],n=e.attendees||[];return e.alarms=new m(t),e.attendees=n,e},setSignupTaskAttendees:function(e){var n=t.map(e,(function(e){return{name:e.attendee.name}})),i=t.some(e,(function(e){var t=e.attendee;return!t.child_membership_id&&t.user_no==this.userNo}),{userNo:h.getUserData().getUserNo()});this.set({attendees:n,checkedAttendeeCount:n.length,isViewerChecked:i})},resetSignupTask:function(){this.set(this.defaults())},setSignupTaskToEditedAttributes:function(e){this.set({subject:e.subject,startAt:e.startAt,endAt:e.endAt,attendeeLimit:e.attendeeLimit}),this.getSignupTaskAlarms().reset(e.alarms)},getSignupTaskAlarms:function(){return this.get("alarms")},setSignupTaskStates:function(e){return a.setSignupStates({band_no:this.attributes.bandNo,post_no:this.attributes.postNo,signup_id:this.attributes.signupId,task_id:this.attributes.taskId,state:e.checked?"checked":"unchecked",target_users:u.stringify(e.target_users)}).then(t.bind((function(e){var t=e.attendees;return this.setSignupTaskAttendees(t),t}),this))},unsetSignupTaskTimeAttributes:function(){this.set({startAt:null,endAt:null}),this.getSignupTaskAlarms().reset()}}),g=o.Collection.extend({model:_}),f=s.extend({attachmentType:r.POST_ATTACHMENT_TYPE.SIGNUP,defaults:function(){return{bandNo:null,isAuthor:null,signupId:null,seq:null,postNo:null,title:null,startAt:null,timeZoneId:null,taskCount:null,completedTaskCount:null,endedAt:null,isChildMemberAddible:null,childMemberLimit:null,tasks:new g([]),createdAt:null}},parse:function(e){var n=i.camelizeKeys(e),o=t.pick(n,"bandNo","postNo","isAuthor","signupId","endedAt","isChildMemberAddible","childMemberLimit"),s=t.map(n.tasks,(function(e){return t.extend(e,o)}));return n.tasks=new g(s,{parse:!0}),n},setSignupToEditedAttributes:function(e){this.set({title:e.title,startAt:e.startAt,timeZoneId:e.timeZoneId,endedAt:e.endedAt,isChildMemberAddible:e.isChildMemberAddible,childMemberLimit:e.childMemberLimit})},setSignupToPreviousAttributes:function(e){var n=this.parse({signupId:null,title:e.title,startAt:e.startAt,timeZoneId:e.timeZoneId,taskCount:null,completedTaskCount:null,endedAt:e.endedAt,isChildMemberAddible:e.isChildMemberAddible,childMemberLimit:e.childMemberLimit,tasks:t.map(e.tasks,(function(e){return{taskId:null,subject:e.subject,isViewerChecked:null,startAt:e.startAt,endAt:e.endAt,alarms:e.alarms,attendeeLimit:e.attendeeLimit,checkedAttendeeCount:null}})),createdAt:null});this.set(n)},setSignupSeq:function(e){this.set("seq",e)},hasSignupTaskContainingTimeAttributes:function(){return this.getSignupTasks().some((function(e){return e.get("startAt")||e.get("endAt")||e.getSignupTaskAlarms().size()>0}))},getSignupTasks:function(){return this.get("tasks")},getSignupTaskCount:function(){return this.getSignupTasks().size()},getSignupActualTaskCount:function(){return this.getSignupTasks().filter((function(e){return!!e.get("subject")})).length},addSignupTasks:function(e){var n=t.map(t.range(0,e||1),(function(){return{}}));this.getSignupTasks().add(n)},toJSONForSave:function(e){var n=!e,i=this.toJSON(),o={seq:i.seq,title:i.title,start_at:i.startAt||null,time_zone_id:i.timeZoneId||null,ended_at:i.endedAt||null,is_child_member_addible:i.isChildMemberAddible||!1,child_member_limit:i.childMemberLimit||null};return o.tasks=t.chain(i.tasks).filter((function(e){return!!e.subject})).map((function(e){var i={subject:e.subject,start_at:e.startAt||null,end_at:e.endAt||null,attendee_limit:e.attendeeLimit||1,alarms:t.map(e.alarms,(function(e){return{duration_type:e.durationType,amount:e.amount,alarm_time:e.alarmTime}}))};return n&&(i.task_id=e.taskId),i})).value(),n&&(o.signup_id=i.signupId),o},getTaskGroups:function(){return this.get("startAt")?this.getSignupTasks().chain().groupBy((function(e){return t.compact([e.get("startAt"),e.get("endAt")]).join("-")})).map((function(e,n){return n?{startEnd:n,tasks:e}:t.map(e,(function(e){return{startEnd:"",tasks:[e]}}))})).flatten(!0).sortBy((function(e){return e.startEnd})).map((function(e){var t=e.startEnd.split("-"),n=t[0],i=t[1],o=n?c.tz(+n,this.timeZoneId):null,s=i?c.tz(+i,this.timeZoneId):null,a=[],r=[];return o&&(a.push(d.format.time(c(o.format(this.timeFormat),this.timeFormat),"hour_minute")),s&&a.push(" - ",d.format.time(c(s.format(this.timeFormat),this.timeFormat),"hour_minute")),o.format(this.timeFormat)!=c(o.valueOf()).format(this.timeFormat)&&(a.push(" (GMT",o.format("Z"),")"),r.push(d.format.date(o,"date_time")),s&&(r.push(" - "),c(o.valueOf()).format(this.dateFormat)==c(s.valueOf()).format(this.dateFormat)?r.push(d.format.time(s,"hour_minute")):r.push(d.format.date(s,"date_time"))))),{time:a.join(""),localTime:r.join(""),tasks:new g(e.tasks)}}),{timeZoneId:this.get("timeZoneId")||l.getCurrentTimezoneId(),timeFormat:"YYYY-MM-DD HH:mm",dateFormat:"YYYY-MM-DD"}).value():this.getSignupTasks().map((function(e){return{time:null,localTime:null,tasks:new g(e)}}))}});return f.TaskModel=_,f.TaskCollection=g,f.buildRichSignupModel=function(e){return new f(e||{},{parse:!0})},f.fetchSignup=function(e,t,n){return a.getSignup(e,t,n).then((function(e){return new f(e.signup||{},{parse:!0})}))},f}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(154),s=n(26),a=n(155),r=n(510),l=n(514),c=n(1254),d=n(1150),u=n(568),h=n(533),p=n(889),m=n(531),_=n(540),g=n(516),f=n(17),b=n(541),v=n(933),A=n(513),E=n(204),T=n(800),C=n(1362),y=n(1255),M=n(553),I=n(1023),S=n(661),w={SHOW_VIDEO_VIEWER_LIST:{sortIndex:1,id:"SHOW_VIDEO_VIEWER_LIST",title:IM("media_viewer.menu.show_video_viewer_list")},SAVE_TO_ALBUM:{sortIndex:2,id:"SAVE_TO_ALBUM",title:IM("web.imageviewer.topbar.btn.save_to_album")},COPY_URL:{sortIndex:3,id:"COPY_URL",title:IM("ui.label.copy_url")},CHANGE_STORAGE_QUOTA:{sortIndex:4,id:"CHANGE_STORAGE_QUOTA",title:IM("media.menu.change_storage_option")},DOWNLOAD:{sortIndex:5,id:"DOWNLOAD",title:IM("ui.label.save.long")},REPORT:{sortIndex:6,id:"REPORT",title:IM("ui.label.report")},HIDE_BAND_FROM_FEED:{sortIndex:7,id:"HIDE_BAND_FROM_FEED",title:IM("post.menu.hide_from_feed.for_group_band")},MEDIA_DOWNLOAD_SETTING:{sortIndex:8,id:"MEDIA_DOWNLOAD_SETTING",title:IM("media_download.setting")},DELETE:{sortIndex:9,id:"DELETE",title:IM("ui.label.del")}},N={PHOTO_INFO_UPDATED:"PHOTO_INFO_UPDATED",MENU_CLICKED:"MENU_CLICKED",MEDIA_DELETED:"MEDIA_DELETED"},D={OPTION_LIST_OPEN:"OPTION_LIST_OPEN",OPTION_LIST_CLOSE:"OPTION_LIST_CLOSE",DO_ACTION:"DO_ACTION",RESET_PHOTO_INFO:"RESET_PHOTO_INFO"},L=i.Behavior.extend({initialize:function(e){this._moreOptionListRegionName=e.moreOptionListRegionName,this._moreOptionList=(e.moreOptionList||[]).sort((function(e,t){return e.sortIndex-t.sortIndex})),this._channelId=e.channelId,this._menuStyleClasses=e.menuStyleClasses||{},this._resetPhotoInfo(e.photoInfo),this.listenTo(this.view,D.OPTION_LIST_OPEN,this._openOptionList),this.listenTo(this.view,D.OPTION_LIST_CLOSE,this._closeOptionList),this.listenTo(this.view,D.DO_ACTION,(function(e){this._bandData.loadBandData().then(t.bind((function(){this._isPermittedOption(this._bandData,this._photoInfo,e)?this._handleMoreOption(e):alert(IM("permission_deny"))}),this))})),this.listenTo(this.view,D.RESET_PHOTO_INFO,this._resetPhotoInfo)},_resetPhotoInfo:function(e){this._filteredMoreOptionList=[],e&&(this._photoInfo=e,this._bandData=a.get(this._photoInfo.bandNo),this._filterMoreOptionList().then(t.bind((function(){this.view.trigger(N.PHOTO_INFO_UPDATED,this._filteredMoreOptionList)}),this)))},_openOptionList:function(){var e=this.view.getRegion(this._moreOptionListRegionName);e.hasView()||t.defer(t.bind((function(){var t=p.build(this._filteredMoreOptionList,this._menuStyleClasses);this.listenTo(t,p.EVENTS.MENU_SELECTED,(function(e){this.trigger(N.MENU_CLICKED,e),this._handleMoreOption(e)})),e.show(t)}),this))},_closeOptionList:function(){var e=this.view.getRegion(this._moreOptionListRegionName);e.hasView()&&e.empty()},_filterMoreOptionList:function(){var e=$.Deferred();return this._bandData&&!t.isEmpty(this._filteredMoreOptionList)?e.resolve():(this._bandData.loadBandData().then(t.bind((function(){this._filteredMoreOptionList=t.filter(this._moreOptionList,t.bind((function(e){if(e.id===w.HIDE_BAND_FROM_FEED.id){var t=this._bandData.getBandCore().selectMcoResourceKey("post.menu.hide_from_feed.for_group_band","post.menu.hide_from_feed.for_page_band");e.title=IM(t)}return e.id===w.SHOW_VIDEO_VIEWER_LIST.id&&(this._bandData.canViewVideoWatcher()?e.title=IM("media_viewer.menu.show_video_viewer_list"):this._bandData.canViewMyViewingProgress()&&(e.title=IM("media_viewer.video.my_watch_ratio.title"))),this._isPermittedOption(this._bandData,this._photoInfo,e.id)}),this)),e.resolve()}),this)),e.promise())},_isPermittedOption:function(e,n,i){var o=n.mediaAuthor,s=!t.isEmpty(o)&&o.isMyself();switch(i){case w.SHOW_VIDEO_VIEWER_LIST.id:return!!n.isVideoExist&&(!n.isGifVideo&&!n.isGiphy&&(this._bandData.canViewVideoWatcher()||this._bandData.canViewMyViewingProgress()));case w.SAVE_TO_ALBUM.id:return!n.isGiphy&&(e.isUploadPhotoToAlbumPermitted()&&e.canSaveToBandAlbumForGroupBandImageViewer());case w.COPY_URL.id:return!!this._photoInfo.photoNo;case w.DELETE.id:return!!e.isContentsDeletionPermitted()||!!s;case w.CHANGE_STORAGE_QUOTA.id:return!!n.isVideoExist&&v.canSetVideoIntoQuota(n.bandNo,n.videoExpiresAt,n.videoFileSize);case w.DOWNLOAD.id:return!n.isGiphy&&!(n.isVideoExpired||!e.canSaveBandMedia(s,n.getSavableState()));case w.REPORT.id:return!n.isRestrictedMedia&&!!e.canReportContentOfAuthor(o.getUserNo(),o.getMemberType());case w.HIDE_BAND_FROM_FEED.id:return!0;case w.MEDIA_DOWNLOAD_SETTING.id:return!(!this._bandData.canSetAlbumMediaSetting(s)||!n.isSourceAtPhoto);default:return!1}},_handleMoreOption:function(e){switch(e){case w.SHOW_VIDEO_VIEWER_LIST.id:this._handleShowVideoViewerList();break;case w.SAVE_TO_ALBUM.id:this._handleSaveToAlbum();break;case w.DELETE.id:this._handleDelete();break;case w.CHANGE_STORAGE_QUOTA.id:this._handleChangeStorageQuota();break;case w.DOWNLOAD.id:this._handleDownload();break;case w.COPY_URL.id:this._handleCopyUrl();break;case w.REPORT.id:this._handleReport();break;case w.HIDE_BAND_FROM_FEED.id:this._handleHideBandFromFeed();break;case w.MEDIA_DOWNLOAD_SETTING.id:this._handleSaveSettings()}},_handleSaveSettings:function(){var e=this._photoInfo.getSavableState(),n="allow",i="disallow";e=e===E.STATE.ENABLED||e===E.STATE.DISABLED?e===E.STATE.ENABLED:this._bandData.isMediaSavable();var o={title:IM("media_download.setting"),description:IM("media_download.setting.desc"),initialCheckedValue:e?n:i,radioItems:[{value:n,label:IM("ui.label.allow")},{value:i,label:IM("ui.label.disallow")}],cancel:IM("ui.label.cancel"),confirm:IM("ui.label.confirm")},s=T.openAsLayer(o);this.listenTo(s,"modal:confirm",(function(e){var i=e===n?E.STATE.ENABLED:E.STATE.DISABLED;h.setSavableStateForPhoto(this._photoInfo.bandNo,this._photoInfo.photoNo,i).then(t.bind((function(){this._photoInfo.setSavableState(i)}),this))})),this._closeOptionList()},_handleShowVideoViewerList:function(){this._photoInfo.liveId?y.openAsyncAsLayer(this._bandData,this._photoInfo.videoId,this._photoInfo.liveId,null,this._photoInfo.photoNo):C.openAsyncAsLayer(this._bandData,this._photoInfo.videoId,null,this._photoInfo.photoNo)},_handleSaveToAlbum:function(){var e=d.openAlbumSelectView({bandNo:this._photoInfo.bandNo,saveButtonText:IM("web.modal.btn.confirm")});this.listenTo(e,"unselect:album",t.bind((function(){this._uploadMediaToAlbum(u.TOTAL_ALBUM_NO).then(t.bind((function(){s.getAlbumChannel().trigger(s.EVENT.ALBUM_PHOTO_ADDED,this._photoInfo.bandNo,u.TOTAL_ALBUM_NO),e.destroy()}),this))}),this)),this.listenTo(e,"select:album",t.bind((function(n,i){this._uploadMediaToAlbum(i).then(t.bind((function(){s.getAlbumChannel().trigger(s.EVENT.ALBUM_PHOTO_ADDED,this._photoInfo.bandNo,i),e.destroy()}),this))}),this))},_uploadMediaToAlbum:function(e){var n=this._photoInfo.isVideoExist?this._uploadVideoToAlbum(e):this._uploadPhotoToAlbum(e);return o.wrapActivePromise(n,this.view).then(t.bind((function(){alert(IM("web.imageviewer.alert.txt.photo_saved"))}),this))},_uploadPhotoToAlbum:function(e){return _.clonePhoto(this._photoInfo.photoUrl).then(t.bind((function(t){return h.createPhotos(this._photoInfo.bandNo,e,[{url:t.url,width:t.width,height:t.height}])}),this))},_uploadVideoToAlbum:function(e){return this._cloneVideo().then(t.bind((function(t){return h.createVideo(this._photoInfo.bandNo,e,{id:t,url:this._photoInfo.photoUrl,width:this._photoInfo.width,height:this._photoInfo.height,is_gif:this._photoInfo.isGifVideo})}),this))},_cloneVideo:function(){return this._channelId?g.cloneChatMessageVideo(this._photoInfo.bandNo,this._channelId,this._photoInfo.messageId).then((function(e){return e.id})):$.Deferred().resolve(this._photoInfo.sosId||this._photoInfo.videoId)},_handleDelete:function(){confirm(IM("ui.confirm.delete"))&&h.deletePhotos(this._photoInfo.bandNo,[this._photoInfo.photoNo]).then(t.bind((function(){this.view.trigger(N.MEDIA_DELETED,this._photoInfo.photoNo)}),this))},_handleChangeStorageQuota:function(){r.openLayer({headerTitle:IM("media.menu.change_storage_option"),bodyDesc:IM(this._bandData.getBandCore().selectMcoResourceKey("setting.quota.storage.large_files.layer.description","pageband.band_setting.quota.storage.large_files.layer.description")),confirm:IM("setting.quota.storage.large_files.option.all"),cancel:IM("ui.label.cancel"),withoutHiding:!0}).once(r.EVENTS.CONFIRM,t.bind((function(){b.setVideoIntoQuota(this._photoInfo.bandNo,this._photoInfo.videoId).done(t.bind((function(){this._photoInfo.videoExpiresAt=null}),this)).fail(t.bind((function(e){1027===e.result_code&&r.openLayer({headerTitle:IM("web.postdetail.attachfile.settingSave"),bodyDesc:IM("setting.quota.storage.error_files.layer.description"),confirm:IM("bandsetting.quota_status.storage.management"),cancel:IM("ui.label.cancel"),withoutHiding:!0}).once(r.EVENTS.CONFIRM,t.bind((function(){var e=this._photoInfo.bandNo,t=this._bandData.getBandCore().makeBandRouteUrl(GroupBandRouteInfos.GROUP_BAND_SETTING_MEDIA_QUOTA,PageBandRouteInfos.PAGE_BAND_SETTING_MEDIA_QUOTA,{band_no:e});A.openWindowXSSSafely(t,"_blank")}),this))}),this))}),this))},_handleDownload:function(){var e=this._photoInfo.downloadFileName;if(this._photoInfo.isVideoExist){if(!this._photoInfo.isVideoExpired){var t=this._photoInfo.videoDownloadUrl;t||(t=g.getVideoUrlByPhotoNo(this._photoInfo.bandNo,this._photoInfo.photoNo)),S.downloadVideo(t,this._photoInfo.isGifVideo,e)}}else S.downloadPhoto(this._photoInfo.photoUrl,e)},_handleCopyUrl:function(){var e=this._bandData.getBandCore(),t=M.mediaDetail(e,this._photoInfo.photoNo).url;I.openUrlCopyLayerView(f.appendCurrentDomainOnPathUrl(t))},_handleReport:function(){if(this._photoInfo.schedulePhotoReportOptions){var e=this._photoInfo.schedulePhotoReportOptions;c.build({bandNo:e.bandNo,owner:e.owner,recurrence:e.recurrence,scheduleId:e.scheduleId,contentType:m.REPORT.TYPE.PHOTO,photoUrl:e.photoUrl})}else l.openPhotoReportPopup(this._photoInfo.bandNo,this._photoInfo.photoNo)},_handleHideBandFromFeed:function(){var e=this._bandData.getBandCore();r.openLayer({headerTitle:IM("feed.hide_from_my_feed.confirm.title",{bandName:e.name}),bodyDesc:IM("feed.hide.confirm.desc")}).once(r.EVENTS.CONFIRM,t.bind((function(){s.getFeedChannel().trigger(s.EVENT.HIDE_BAND_FROM_FEED,e.bandNo)}),this))}});return L.MEDIA_MORE_OPTION=w,L.TRIGGERING_EVENTS=N,L.LISTENING_EVENTS=D,L}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(503),s=n(511),a=n(610),r=n(504),l=n(52),c=t.Model.extend({default:{childMembershipId:null,userNo:null,bandNo:null},parse:function(e){e=l.camelizeKeys(e);var t={};return t.childMembershipId=e.childMembershipId,t.userNo=e.userNo,t.bandNo=e.bandNo,t}}),d=t.Model.extend({defaults:{actor:null,member:null,repliedAt:null,childMember:new c,isUpdated:!1},parse:function(e){e=l.camelizeKeys(e);var t={};return t.actor=new r(e.actor,{parse:!0}),e.member&&(t.member=new r(e.member,{parse:!0})),e.repliedAt&&(t.repliedAt=e.repliedAt),t.isUpdated=e.isUpdated,t},setUserRsvpState:function(e){var t=e.bandNo,n=e.scheduleId,l=e.userNo,c=e.rsvpState,d=e.customStateId,u=[];return l?u.push({userNo:l}):this.get("childMember")&&u.push({userNo:this.get("childMember").get("userNo"),childMembershipId:this.get("childMember").get("childMembershipId")}),o.setScheduleRsvpStates(t,n,u,c,d).then(i.bind((function(e){var t=e.result_data,n=new a(t.rsvp,{parse:!0}),o=t.affected_rsvp_states[c],l=[],d=t.affected_rsvp_states[s.PENDING_ATTENDANCE];return d&&d.length>0&&(l=i.map(d,(function(e){return new r(e,{parse:!0})}))),{updatedRsvpInfo:n,updatedMemberList:i.map(o,(function(e){return new r(e,{parse:!0})})),pendingAttendanceMembers:l}}),this)).fail((function(e){return e}))},setChildMemberModel:function(e,t){var n=new c(e,{parse:t});this.set("childMember",n)},isUpdated:function(){return this.get("isUpdated")},getMember:function(){return this.get("member")},getUserNo:function(){if(this.getMember())return this.getMember().getUserNo()},getChildMembershipId:function(){if(this.getMember())return this.getMember().getChildMembershipId()}});return d.build=function(){return new d},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(6),o=n(16),s=n(700),a=n(526),r=n(545),l=n(165);function c(e,t){var n=[];if(e.get("scheduleType")===a.NORMAL||e.get("scheduleType")===a.EXTERNAL){e.get("calendar")&&e.get("description")&&(n.push(e.get("description")),n.push(" - ")),n.push(t.name+": ");var i=e.get("calendar");i&&(i.get("type")===r.TYPE.INTERNAL?(n.push(i.get("name")),n.push(", "),n.push(e.get("owner").get("name")),n.push(" "+IM("ui.label.registration"))):i.get("type")===r.TYPE.EXTERNAL&&(n.push(i.get("name")),n.push(", "),n.push(i.get("serviceProvider"))))}return n.join("")}function d(e){var t=e.get("recurrence");return e.get("scheduleType")===a.BIRTHDAY&&(t=new i.Model({byDay:null,byMonthDay:null,freq:"YEARLY",interval:null,since:e.get("startAt"),until:o(e.get("startAt")).add("years",10).format("YYYY-MM-DD[T]HH:mm:ss[Z]")})),s().makeRecurrence(t,"YYYYMMDD[T]HHmmss[Z]")}return{makeAddEventToGoogleCalendarUrl:function(e,n){var i,s=o(e.get("startAt")),a=o(e.get("endAt")||e.get("startAt"));if(e.get("isAllDay"))i=[s.format("YYYYMMDD"),a.add(1,"day").format("YYYYMMDD")].join("/");else{var r=e.get("scheduleTimeZoneId")||l.getCurrentTimezone().id;r&&(s=s.tz(r),a=a.tz(r)),i=[s.format("YYYYMMDD[T]HHmmss"),a.format("YYYYMMDD[T]HHmmss")].join("/")}var u={action:"TEMPLATE",text:e.get("name")||"",dates:i,details:c(e,n),sprop:"website:"+window.location.href,location:!!e.get("location")&&e.get("location").get("address")||"",ctz:e.get("scheduleTimeZoneId")||l.getCurrentTimezone().id,recur:d(e)};return"https://www.google.com/calendar/render?"+t.param(u)},makeAddEventUrlForOutlookLive:function(e,n){var i=e.get("startAt")||"",s=e.get("endAt")||e.get("startAt")||"",a={startdt:o(i).utc().format("YYYYMMDD[T]HHmmss"),enddt:o(s).utc().format("YYYYMMDD[T]HHmmss"),subject:e.get("name")||"",body:c(e,n)};return"https://outlook.live.com/owa/?path=%2Fcalendar%2Faction%2Fcompose&"+t.param(a)},makeAddEventUrlForYahoo:function(e,n){var i={title:e.get("name")||"",desc:c(e,n),url:window.location.href,in_loc:!!e.get("location")&&e.get("location").get("address")||""};return e.get("isAllDay")?(i.st=o(e.get("startAt")).format("YYYYMMDD"),!e.get("endAt")||o(e.get("endAt")).isSame(e.get("startAt"),"day")?i.dur="allday":i.et=o(e.get("endAt")).add(1,"day").format("YYYYMMDD")):(i.st=o(e.get("startAt")).format("YYYYMMDD[T]HHmmss"),e.get("endAt")&&(i.et=o(e.get("endAt")).format("YYYYMMDD[T]HHmmss"))),"https://calendar.yahoo.com/subscribe?v=60&"+t.param(i)}}}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(489),s=n(501),a=n(687),r=n(13),l=n(578),c=n(52),d=n(152),u=o.extend({attachmentType:d.POST_ATTACHMENT_TYPE.BILL_SPLIT,defaults:function(){var e=l.getCurrencyCode(window.countryCode)||"USD";return{totalPrice:null,isEditable:!0,currency:e,currencyLabel:l.getCurrencyLabel(e),members:new i.Collection([],{model:h})}},parse:function(e,t){var n={bandNo:(e=c.camelizeKeys(e)).bandNo,postNo:e.postNo,isAuthor:e.isAuthor,currency:e.currency,isEditable:e.isEditable,currencyLabel:l.getCurrencyLabel(e.currency),memberCount:e.memberCount,paidMemberCount:e.paidMemberCount,totalPrice:e.totalPrice,members:null};return e.members&&e.members.length>0?n.members=new i.Collection(e.members,{model:h,parse:!0}):delete n.members,n},setJSON:function(e){e.members&&(e.members=new i.Collection(e.members,{model:h})),e.currencyLabel=l.getCurrencyLabel(e.currency),this.set(e)},setMemberPaid:function(e){var t=this.get("members").at(e);return a.payBill(this.get("bandNo"),this.get("postNo"),t.get("userNo"))},validate:function(e,t){return!e.totalPrice||e.totalPrice<=0?IM("web.postwrite.billsplit.alert.enter_total_price"):e.members&&0!==e.members.length?void 0:IM("web.postwrite.billsplit.alert.select_member")},toJSONForSave:function(){return this.isValid()?JSON.stringify({member_count:this.get("members").length,total_price:this.get("totalPrice"),currency:this.get("currency"),members:t.map(this.get("members").models,(function(e){return{user_no:e.get("userNo"),price:e.get("price")}}))}):null}}),h=o.extend({defaults:{price:null},parse:function(e,n){var i={price:(e=c.camelizeKeys(e)).price,isPaid:e.isPaid,isCurrentUser:!1};return e.member&&((i=t.extend(i,new s(e.member,{parse:!0}).attributes)).isCurrentUser=r.getUserData().getUserNo()===i.userNo),i}});return u.createMemberModelFrom=function(e){var t=new h;return t.set(e.attributes),t},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(156),i=n(630),o=n(631),s=n(632);return{generateTemplateData:function(e){return null==e?null:e instanceof o?{attachFileSize:t.toStringFileSize(e.getSize()),attachFileInfo:"Dropbox",attachFileName:e.getName()}:e instanceof s?{attachFileSize:t.toStringFileSize(e.getSize()),attachFileInfo:t.toCamelizeFileSource(e.getSource()),attachFileName:e.getName()}:e instanceof i?{attachFileSize:t.toStringFileSize(e.getFileSize()),attachFileInfo:t.makeExpirationText(e.getExpiresAt()),attachFileName:e.getTitle()}:null},generateFileDownloadData:function(e,t){var n={bandNo:e};return t instanceof o?(n.dropbox=!0,n.link=t.getLink()):t instanceof s?(n.externalFile=!0,n.link=t.getLink()):(n.fileId=t.getId(),n.expiresAt=t.getExpiresAt()),n}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{COMMENT:"comment",FILE:"file",LAST_COMMENT:"last_comment"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(0),n(2),n(627),n(156)],void 0===(o=function(e,t,n,i){return{downloadBandFile:function(e){var o=t.Deferred();return e.isRestricted?(alert(IM("post.msg.post_is_restricted")),o.resolve(),o):i.isExpiredFile(e.expiresAt)?(alert(IM("web.postdetail.attachfile.alert.expired")),o.resolve(),o):e.dropbox||e.externalFile?(window.open(e.link,"_blank"),o.resolve(),o):(n.getFileUrl(e.bandNo,e.fileId).then((function(e){window.location.href=e})).always((function(){o.resolve()})),o)}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(2),s=n(6),a=n(9),r=s.Model.extend({idAttribute:"addonType",getVersion:function(){return this.get("version")},getIconUrl:function(){return this.get("iconUrl")},getBaseUrl:function(){return this.get("baseUrl")},getDescription:function(){return this.get("description")},getAddonType:function(){return this.get("addonType")},getLocaleName:function(){return this.get("localeName")},makeCreateUri:function(){return this.getBaseUrl()+"/create?lang="+a.getLang()},makeModifyUri:function(e){return this.getBaseUrl()+"/modify?lang="+a.getLang()+"&token="+e},makeViewUri:function(e){return this.getBaseUrl()+"/view?lang="+a.getLang()+"&token="+e},parse:function(e,t){return{name:e.name,addonType:e.addonType,iconUrl:e.iconUrl,baseUrl:e.baseUrl,showAttachButton:e.showAttachButton,localeName:this._extractLocaleName(e.name)}},_extractLocaleName:function(e){var n=a.getLang().toLowerCase(),o=t.keys(e),s=t.find(o,(function(e){return n==e.toLowerCase()}));if(!t.isEmpty(s))return e[s];var r=t.find(o,(function(e){return i.startsWith(e.toLowerCase(),n)}));return t.isEmpty(r)?e.en:e[r]}}),l=s.Collection.extend({model:r,findAllowedAddonModelByType:function(e){return this.find((function(t){return t.getAddonType()==e}))},fetchAllowedAddonCollection:function(){return o.Deferred().resolve([{name:{de:"Markdown",ru:"Разметку",ko:"마크다운",th:"Markdown","zh-TW":"Markdown",ja:"マークダウン",en:"Markdown",id:"Markdown",fr:"Markdown","zh-CN":"Markdown",es:"Markdown"},addonType:1,iconUrl:"https://ssl.pstatic.net/cmstatic/addon/markdown/ico-markdown-attachment_theme.png",baseUrl:"https://"+window.addonDomain+"/markdown",showAttachButton:"Y"}]).then(t.bind((function(e){return this.reset(e,{parse:!0}),this}),this))}}),c=null;return l.getCachedAllowedAddonCollection=function(){if(!c){var e=new l;c=e.fetchAllowedAddonCollection()}return c},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(6),o=n(0),s=n(10),a=n(52),r=n(529),l=n(877),c=n(490),d=n(161),u=n(153),h=n(162),p=n(155),m=i.Model.extend({defaults:function(){return{liveId:null,publishInfo:null,creator:null,useChannelMessage:null,channelId:null,description:null,webUrl:null,maxRunningTimeMins:null,viewPeriodSecs:null,viewerCountPeriodSecs:null,startAt:null,thumbnail:null,resolution:null,playInfo:null,viewerCount:null,me:null,band:null,isShareable:null,bandData:null}},initialize:function(e,t){this._bandNo=Number(t.bandNo),this._liveId=Number(t.liveId)},parse:function(e,t){var n=t?t.bandData:null,i=a.camelizeKeys(e);return n?(i.band=n.getBandCore(),i.bandData=n):i.band&&(i.band=d.createBandCore(i.band)),i.creator=r.buildContentAuthorModel(i.creator),i.me&&(i.me=r.buildContentAuthorModel(i.me)),i},fetchLive:function(){return p.get(this._bandNo).loadBandData().then(o.bind((function(){return l.getLive(this._bandNo,this._liveId).then(o.bind((function(e){return this.set(this.parse(e,{bandData:p.get(this._bandNo)})),this}),this))}),this))},fetchLiveAfterOnLive:function(){return t.when(l.getLive(this._bandNo,this._liveId,!0),p.get(this._bandNo).loadBandData()).then(o.bind((function(e){return e.play_info?(this.set(this.parse(e,{bandData:p.get(this._bandNo)})),this):t.Deferred().reject().promise()}),this))},fetchLivePreview:function(){return l.getLivePreview(this._bandNo,this._liveId).then(o.bind((function(e){var n=e?e.preview_play_info:null;return n?(e.play_info=n,this.set(a.camelizeKeys(e)),this):t.Deferred().reject()}),this))},getBandCore:function(){return this.get("band")},getViewerCount:function(){return this.get("viewerCount")},toJSON:function(){return c.toRecursiveJSON(this)},getLiveBandNo:function(){return this._bandNo},getLiveId:function(){return this._liveId},getLivePublishInfo:function(){return this.get("publishInfo")},getLiveCreator:function(){return this.get("creator")},useChannelMessageLive:function(){return this.get("useChannelMessage")},getLiveChannelId:function(){return this.get("channelId")},getLiveDescription:function(){return s.trim(this.get("description"))},getLiveWebUrl:function(){return s.trim(this.get("webUrl"))},getLiveMaxRunningTimeMins:function(){return this.get("maxRunningTimeMins")},getLiveViewPeriodSecs:function(){return this.get("viewPeriodSecs")},getLiveViewerCountPeriodSecs:function(){return this.get("viewerCountPeriodSecs")},getLiveStartAt:function(){return this.get("startAt")},getLiveThumbnail:function(){return this.get("thumbnail")},getLiveResolution:function(){return this.get("resolution")},getLivePlayInfo:function(){return this.get("playInfo")},getLiveViewerCount:function(){return this.get("viewerCount")},getLiveMe:function(){return this.get("me")},setLiveViewerCount:function(e){if(o.isNumber(e))return this.set("viewerCount",e)},getLiveBandData:function(){return this.get("bandData")},isLiveCreatorMe:function(){return this.getLiveCreator().isSameMemberKeyContentAuthor(this.getLiveMe())},isLiveShareable:function(){return!!this.get("isShareable")},getLiveUrl:function(){return this.getBandCore().makeBandRouteUrl(u.GROUP_BAND_LIVE,h.PAGE_BAND_LIVE,{band_no:this.getLiveBandNo(),live_id:this.getLiveId()})}});return m.createLiveAndBuildLiveModel=function(e,t,n,i,o){return p.get(e).loadBandData().then((function(){return l.createLive(e,t,n,i,o).then((function(t){return new m(t,{parse:!0,bandNo:e,liveId:t.live_id,bandData:p.get(e)})}))}))},m.buildEmptyLiveModel=function(e,t){return new m(null,{bandNo:e,liveId:t})},m.buildFeedLiveModel=function(e){return new m(e,{bandNo:e.band.bandNo,liveId:e.liveId,parse:!0})},m}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(489);return i.extend({constructor:function(e,t){(t=t||{})&&t.factoryFunction&&(this.factoryFunction=t.factoryFunction),e&&(t.parse=!0),i.call(this,e,t)},parse:function(e,n){if(t.isEmpty(e))return e;var i={};return t.each(e,(function(e,t){i[t]=this.factoryFunction(e)}),this),i},toJSONForSave:function(e){return JSON.stringify(t.mapObject(this.attributes,(function(t,n){return t.toJSONForSave(e)})))},length:function(){return t.keys(this.attributes).length}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(82),o=n(52),s=n(152),a=n(183);return t.extend({attachmentType:s.POST_ATTACHMENT_TYPE.STICKER,parse:function(e,t){return{packNo:(e=o.camelizeKeys(e)).packNo,stickerId:e.stickerId,imageUrl:i.makeStickerImageUrl(e.packNo,e.stickerId),aniStickerImageUrl:i.makeAniStickerImageUrl(e.packNo,e.stickerId,e.resourceType),resourceType:e.resourceType,width:e.width,height:e.height}},toJSONForSave:function(){return{pack_no:this.get("packNo"),sticker_id:this.get("stickerId")}},isAniSticker:function(){return a.findByResourceType(this.get("resourceType"))==a.ANIMATION}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(52),o=n(152);return t.extend({attachmentType:o.POST_ATTACHMENT_TYPE.PHOTO,idAttribute:"photoNo",parse:function(e,t){return{photoNo:(e=i.camelizeKeys(e)).photoNo||this.cid,photoUrl:e.photoUrl,width:e.width,height:e.height,contentType:e.contentType,emotionCount:e.emotionCount,commentCount:e.commentCount,isRestricted:e.isRestricted,savableState:e.savableState||null,photographedAt:e.photographedAt}},toJSONForSave:function(e){if(e||this.isNew()){var t={url:this.get("photoUrl"),width:this.get("width"),height:this.get("height")};return this.get("photographedAt")&&(t.photographed_at=this.get("photographedAt")),t}return{photo_no:this.get("photoNo")}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return n(489).extend({attachmentType:"promotionPhoto",parse:function(e,t){return{url:e.url,width:e.width,height:e.height}},toJSONForSave:function(){return{url:this.get("url"),width:this.get("width"),height:this.get("height")}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(156),o=n(52),s=n(152);return t.extend({attachmentType:s.POST_ATTACHMENT_TYPE.VIDEO,defaults:{isNew:!0},parse:function(e,t){return{isNew:(e=o.camelizeKeys(e)).isNew||!1,isExpired:i.isExpiredFile(e.expiresAt),expiresAt:e.expiresAt,sosId:e.sosId,id:e.id,logoImage:e.logoImage,width:e.width,height:e.height,isRestricted:e.isRestricted,photoNo:e.photoNo,isGif:e.isGif||!1,liveId:e.liveId||"",isLive:e.isLive||!1,liveDescription:e.liveDescription,savableState:e.savableState||null}},toJSONForSave:function(e){return e||this.get("isNew")?{id:this.get("sosId")?this.get("sosId"):this.get("id"),url:this.get("logoImage"),width:this.get("width"),height:this.get("height"),title:this.get("title"),is_gif:this.get("isGif"),live_id:this.get("liveId"),live_description:this.get("liveDescription")}:{video_id:this.get("id")}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(52),o=n(152);return t.extend({attachmentType:o.POST_ATTACHMENT_TYPE.LOCATION,parse:function(e,t){return{name:(e=i.camelizeKeys(e)).name,address:e.address,latitude:e.latitude,longitude:e.longitude}},toJSONForSave:function(){return{name:this.get("name"),latitude:this.get("latitude"),longitude:this.get("longitude")}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(52),o=n(152);return t.extend({attachmentType:o.POST_ATTACHMENT_TYPE.SNIPPET,parse:function(e){return i.camelizeKeys(e)},deleteRichSnippetImage:function(){this.set({image:null,imageWidth:null,imageHeight:null})},setRichSnippetAttributes:function(e){this.set(e)},toJSONForSave:function(){return i.decamelizeKeys(this.attributes)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(52),o=n(152);return t.extend({attachmentType:o.POST_ATTACHMENT_TYPE.ALBUM,parse:function(e,t){return{name:(e=i.camelizeKeys(e)).name,albumNo:e.albumNo}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(52),o=n(152);return t.extend({attachmentType:o.POST_ATTACHMENT_TYPE.PHOTO_ALBUM,parse:function(e,t){return{name:(e=i.camelizeKeys(e)).name,albumNo:e.no,isDeleted:e.isDeleted,photoCount:e.photoCount}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(489),s=n(52),a=n(152);return o.extend({attachmentType:a.POST_ATTACHMENT_TYPE.SUBPOST,parse:function(e,t){return this.rawResponse=i.clone(e),{title:(e=s.camelizeKeys(e)).header.text,image:e.body.image&&e.body.image.url?e.body.image.url:null,description:e.body.text,subtitle:e.header.subtext,actionUrl:e.body.action&&e.body.action.pc&&"empty"!==e.body.action.pc?e.body.action.pc:null,actionCallbackUrl:e.body.action&&e.body.action.callback?e.body.action.callback:null}},requestActionCallback:function(){this.get("actionCallbackUrl")&&t.ajax(this.get("actionCallbackUrl"),{type:"GET"})},toJSONForSave:function(){return JSON.stringify(this.rawResponse)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(161),o=n(517),s=n(52),a=n(152);return t.extend({attachmentType:a.POST_ATTACHMENT_TYPE.SHARED_POST_SNIPPET,parse:function(e){e=s.camelizeKeys(e);var t={band:i.createBandCore(e.band),postNo:e.postNo,image:e.image?e.image.url:null,imageWidth:e.image?e.image.width:0,imageHeight:e.image?e.image.height:0,body:e.body,isPlayButtonVisible:e.isPlayButtonVisible,isSourcePostUnavailable:e.isSourcePostUnavailable,certified:!!e.band.certified};return e.sourcePost&&(t.sourcePost=new o(e.sourcePost,{parse:!0})),t},getSourcePost:function(){return this.get("sourcePost")},isSourcePostUnavailable:function(){return this.get("isSourcePostUnavailable")},toJSONForSave:function(){return JSON.stringify({band:{band_no:this.get("band").get("bandNo")},post_no:this.get("postNo")})},setJSON:function(e){e.band&&(e.band=i.createBandCore(e.band)),this.set(e)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(489),i=n(161),o=n(517),s=n(52),a=n(152);return t.extend({attachmentType:a.POST_ATTACHMENT_TYPE.SHARED_PAGE_POST_SNIPPET,parse:function(e){e=s.camelizeKeys(e);var t={band:i.createBandCore(e.band),postNo:e.postNo,image:e.image?e.image.url:null,imageWidth:e.image?e.image.width:0,imageHeight:e.image?e.image.height:0,body:e.body,isPlayButtonVisible:e.isPlayButtonVisible,isSourcePostUnavailable:e.isSourcePostUnavailable,certified:!!e.band.certified};return e.sourcePost&&(t.sourcePost=new o(e.sourcePost,{parse:!0})),t},getSourcePost:function(){return this.get("sourcePost")},isSourcePostUnavailable:function(){return this.get("isSourcePostUnavailable")},toJSONForSave:function(){return JSON.stringify({band:{band_no:this.get("band").get("bandNo")},post_no:this.get("postNo")})},setJSON:function(e){e.band&&(e.band=i.createBandCore(e.band)),this.set(e)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return n(489).extend({attachmentType:"unknown"})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(10),s=n(802);return t.Collection.extend({model:s,modelId:function(e){var n,i,o=e.attendee;return o instanceof t.Model?(n=o.get("userNo"),i=o.get("childMembershipId")):(n=o.user_no||o.userNo,i=o.child_membership_id||o.childMembershipId),n+(i?"_"+i:"")},comparator:function(e){return e.getAttendee().isMyself()?"":e.getAttendee().get("name")},extractSortedModels:function(e,t,n,s){var a=this.models;return""!=(t=o.trim(t).toLowerCase())&&(a=this.filter((function(e){return e.getLowerCaseName().indexOf(t)>=0})),i.isEmpty(a)&&(t=t.slice(0,-1),a=this.filter((function(e){return e.getLowerCaseName().indexOf(t)>=0})))),new CollectionForSort(a,{orderBy:e,currentUserManager:n,currentUserNo:s}).models},getAttendeeCount:function(e){return this.getAttendeeModels(e).length},getAttendeeModels:function(e){return e?this.filter((function(t){return t.getState()===e})):this.models},getChildMemberAttendeeModels:function(){return this.filter((function(e){return!!e.get("attendee").get("childMembershipId")}))},getChildMemberAttendeeChildMembershipIds:function(){return i.map(this.getChildMemberAttendeeModels(),(function(e){return e.get("attendee").get("childMembershipId")}))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(152),i=n(52);return n(489).extend({idAttribute:"audioId",attachmentType:t.POST_ATTACHMENT_TYPE.AUDIO,defaults:{postNo:null,bandNo:null,isAuthor:!1,audioId:null,sosId:null,audioDuration:null},parse:function(e){return{bandNo:(e=i.camelizeKeys(e)).bandNo,postNo:e.postNo,isAuthor:e.isAuthor,audioId:e.audioId,audioDuration:e.audioDuration,sosId:e.sosId}},getAudioId:function(){return this.get("audioId")},getAudioDuration:function(){return this.get("audioDuration")},getBandNo:function(){return this.get("bandNo")},getPostNo:function(){return this.get("postNo")},isAuthor:function(){return this.get("isAuthor")},getSOSId:function(){return this.get("sosId")},toJSONForSave:function(e){return e||this.get("isNew")?{sos_id:this.getSOSId(),audio_duration:this.getAudioDuration()}:{audio_id:this.getAudioId()}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i=n(13),o={SET_BAND_NOTICE:"/v1.0.0/set_band_notice",UNSET_BAND_NOTICE:"/v1.0.0/unset_band_notice",GET_BAND_NOTICE_READERS:"/v1.0.0/get_band_notice_readers",GET_BAND_NOTICES:"/v2.0.0/get_band_notices",SET_MAJOR_BAND_NOTICE:"/v1.0.0/set_major_band_notice",UNSET_MAJOR_BAND_NOTICE:"/v1.0.0/unset_major_band_notice",SET_BAND_NOTICE_STATE:"/v2.0.1/set_band_notice_state",GET_LINKED_BAND_NOTICES:"/v2.0.0/get_linked_band_notices",GET_BAND_NOTICE_STATE:"/v2.0.0/get_band_notice_state"},s={setBandNotice:function(e,n){var i={band_no:e,post_no:n};return t.getLoginV1Client().send({url:"https://api.band.us"+o.SET_BAND_NOTICE,data:i}).then((function(e,t,n){return e.result_data.message}))},unsetBandNotice:function(e,n){var i={band_no:e,post_no:n};return t.getLoginV1Client().send({url:"https://api.band.us"+o.UNSET_BAND_NOTICE,data:i}).then((function(e,t,n){return e.result_data.message}))},getBandNoticeReaders:function(e,n){var i={band_no:e,post_no:n};return t.getLoginV1Client().send({url:"https://api.band.us"+o.GET_BAND_NOTICE_READERS,data:i}).then((function(e,t,n){return e.result_data}))},getBandNoticesForPreview:function(e){return(i.isLogedIn()?t.getLoginV1Client():t.getNoLoginV1Client()).send({url:"https://api.band.us"+o.GET_BAND_NOTICES,data:{band_no:e,limit:3}}).then((function(e,t,n){return e.result_data}))},getBandNotices:function(e,n){var i={band_no:e,limit:100};return n&&(i.after=n),t.getLoginV1Client().send({url:"https://api.band.us"+o.GET_BAND_NOTICES,data:i}).then((function(e,t,n){return e.result_data}))},setMajorBandNotice:function(e,n){return t.getLoginV1Client().send({url:"https://api.band.us"+o.SET_MAJOR_BAND_NOTICE,data:{band_no:e,post_no:n}}).then((function(e,t,n){return e.result_data.message}))},unsetMajorBandNotice:function(e,n){return t.getLoginV1Client().send({url:"https://api.band.us"+o.UNSET_MAJOR_BAND_NOTICE,data:{band_no:e,post_no:n}}).then((function(e,t,n){return e.result_data.message}))},setBandNoticeState:function(e,n,i,s,a,r){var l={band_no:e,post_no:n,state:i,unset_at:a,time_zone_id:r};return null!=s&&(l.set_linked_band_notice=s),t.getLoginV1Client().send({url:"https://api.band.us"+o.SET_BAND_NOTICE_STATE,data:l})},getLinkedBandNotice:function(e){return(i.isLogedIn()?t.getLoginV1Client():t.getNoLoginV1Client()).send({url:"https://api.band.us"+o.GET_LINKED_BAND_NOTICES,data:{band_no:e}}).then((function(e){return e.result_data}))},getBandNoticesState:function(e,n){var i={band_no:e,post_no:n};return t.getLoginV1Client().send({url:"https://api.band.us"+o.GET_BAND_NOTICE_STATE,data:i}).then((function(e,t,n){return e.result_data}))}};return s.PATHS=o,s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(872),s=n(873);return i.Collection.extend({model:s,fetchPollSubejctHistoryV1:function(e,n,i){return o.getPollSubjectHistoryV1(e,n,i).then(t.bind((function(e){this.reset(e,{parse:!0})}),this))},fetchPollSubejctHistoryV2:function(e,n,i,s){return o.getPollSubjectHistoryV2(e,n,i,s).then(t.bind((function(e){this.reset(e,{parse:!0})}),this))},fetchTodoSubejctHistoryV1:function(e,n,i){return o.getTodoSubjectHistoryV1(e,n,i).then(t.bind((function(e){this.reset(e,{parse:!0})}),this))},fetchTodoSubejctHistoryV2:function(e,n,i,s){return o.getTodoSubjectHistoryV2(e,n,i,s).then(t.bind((function(e){this.reset(e,{parse:!0})}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i={GET_POLL_SUBJECT_HISTORY_V1:"/v1/get_poll_subject_history",GET_POLL_SUBJECT_HISTORY_V2:"/v2.0.0/get_poll_subject_history",GET_TODO_SUBJECT_HISTORY_V1:"/v1/get_todo_subject_history",GET_TODO_SUBJECT_HISTORY_V2:"/v2.0.0/get_todo_subject_history"},o={getPollSubjectHistoryV1:function(e,n,o){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_POLL_SUBJECT_HISTORY_V1,data:{band_no:e,post_no:n,poll_subject_id:o}}).then((function(e,t,n){return e.result_data.subject_history}))},getPollSubjectHistoryV2:function(e,n,o,s){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_POLL_SUBJECT_HISTORY_V2,data:{band_no:e,post_no:n,poll_id:o,poll_subject_id:s}}).then((function(e,t,n){return e.result_data.subject_history}))},getTodoSubjectHistoryV1:function(e,n,o){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_TODO_SUBJECT_HISTORY_V1,data:{band_no:e,post_no:n,task_id:o}}).then((function(e,t,n){return e.result_data.subject_history}))},getTodoSubjectHistoryV2:function(e,n,o,s){return t.getLoginV1Client().send({url:"https://api.band.us"+i.GET_TODO_SUBJECT_HISTORY_V2,data:{band_no:e,post_no:n,todo_id:o,task_id:s}}).then((function(e,t,n){return e.result_data.subject_history}))}};return o.PATHS=i,o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(504),o=n(490);return t.Model.extend({parse:function(e,t){return{editor:new i(e.editor,{parse:!0}),subject:e.subject,createdAt:e.created_at}},toJSON:function(){return o.toRecursiveJSON(this)},getEditor:function(){return this.get("editor")},getSubject:function(){return this.get("subject")},getCreatedAt:function(){return this.get("createdAt")},getEditorInfo:function(){return{profileInfo:this.getEditor().getMemberProfile(),userNo:this.getEditor().getUserNo(),userName:this.getEditor().getUserName(),roleName:this.getEditor().getRole().name}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(152),o={ADDED:"schedule.history.added",UPDATED:"schedule.history.updated"},s={ANONYMOUS_ADDED:"poll.history.anonymous_added",ADDED:"poll.history.added",UPDATED:"poll.history.updated"},a={ADDED:"todo.history.added",UPDATED:"todo.history.updated"},r={makeStateMessage:function(e,t,n,r){var l;switch(e){case i.POST_ATTACHMENT_TYPE.TODO:case i.POST_ATTACHMENT_TYPE.TODO_V2:l=t?a.ADDED:a.UPDATED;break;case i.POST_ATTACHMENT_TYPE.POLL:case i.POST_ATTACHMENT_TYPE.POLL_V2:l=t?r?s.ANONYMOUS_ADDED:s.ADDED:s.UPDATED;break;case i.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP:l=t?o.ADDED:o.UPDATED}return r?IM(l):IM(l,{editor:n})}};e.exports=r},function(e,t,n){var i=n(6),o=n(0),s=n(876),a=n(503),r=n(52),l=i.Collection.extend({model:s,initialize:function(e){this.bandNo=e.bandNo,this.scheduleId=e.scheduleId},fetchRsvpReplyHistory:function(e,t){return a.getScheduleRsvpReplyHistory(this.bandNo,this.scheduleId,e,t).then(o.bind((function(e){e=r.camelizeKeys(e),this.reset(e.resultData.history,{parse:!0})}),this))}});e.exports=l},function(e,t,n){var i=n(6),o=n(511),s=(n(504),n(163)),a=i.Model.extend({defaults:{author:null,createdAt:null,state:null},parse:function(e){return{actor:e.actor,createdAt:e.createdAt,state:e.state}},getActor:function(){return this.get("actor")},getCreatedAt:function(){return this.get("createdAt")},getState:function(){return this.get("state")},getRsvpStateText:function(){return this.getState().rsvpState==o.CUSTOM?this.getState().title:o.getRsvpStateText(this.getState().rsvpState)},getActorProfile:function(){return new s({name:this.getActor().name,profileImageUrl:this.getActor().profileImageUrl,memberType:this.getActor().memberType})},getActorUserNo:function(){return this.getActor().userNo},getActorInfo:function(){return{profileInfo:new s({name:this.getActor().name,profileImageUrl:this.getActor().profileImageUrl,memberType:this.getActor().memberType}),userNo:this.getActor().userNo,userName:this.getActor().name,roleName:this.getActor().role}}});e.exports=a},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i="/v2.0.0/create_live",o="/v2.0.0/on_live",s="/v2.0.0/off_live",a="/v2.0.0/upload_live",r="/v2.0.0/get_live_preview",l="/v2.0.0/get_live",c="/v2.0.0/get_live_messages",d="/v2.0.0/view_live",u="/v2.0.0/validate_live",h="/v2.0.0/quit_live",p="/v2.0.0/get_live_viewer_count",m="/v2.0.0/get_member_in_live",_="/v2.0.0/hide_live_message",g="/v2.0.0/show_hidden_live_message",f="/v2.0.0/get_live_viewing_members",b="/v2.0.0/get_not_posted_live_count",v="/v2.0.0/get_not_posted_lives",A="/v2.0.0/remove_not_posted_live";return{createLive:function(e,n,o,s,a){var r={band_no:e,preset_name:n,immediate_on_air:o,use_channel_message:a};return s&&(r.description=s),t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+i,data:r,method:"POST"})},onLive:function(e,n){var i={band_no:e,live_id:n};return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+o,data:i,method:"POST"})},offLive:function(e,n,i){return(i?t.getLoginV1ClientWithoutErrorAlert():t.getLoginV1Client()).sendAndThenProcess({url:"https://api.band.us"+s,data:{band_no:e,live_id:n},method:"POST"})},uploadLive:function(e,n){var i={band_no:e,live_id:n};return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+a,data:i,method:"POST"})},getLivePreview:function(e,n){var i={band_no:e,live_id:n};return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+r,data:i})},getLive:function(e,n,i){return(i?t.getLoginV1ClientWithoutErrorAlert():t.getLoginV1Client()).sendAndThenProcess({url:"https://api.band.us"+l,data:{band_no:e,live_id:n}})},getLiveMessages:function(e,n,i,o){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+c,data:{band_no:e,video_id:n,start_offset:i,end_offset:o}})},viewLive:function(e,n){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+d,method:"POST",data:{band_no:e,live_id:n}})},validateLive:function(e,n){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+u,data:{band_no:e,live_id:n}})},quitLive:function(e,n){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+h,method:"POST",data:{band_no:e,live_id:n}})},getLiveViewerCount:function(e,n){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+p,data:{band_no:e,live_id:n}})},getMemberInLive:function(e,n,i){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+m,data:{band_no:e,live_id:n,member_key:i}})},hideLiveMessage:function(e,n,i,o){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+_,data:{band_no:e,video_id:n,target_member_key:i,message_time:o}})},showHiddenLiveMessage:function(e,n,i,o){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+g,data:{band_no:e,video_id:n,target_member_key:i,message_time:o}})},getLiveViewingMembers:function(e,n){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+f,data:{band_no:e,live_id:n}})},getNotPostedLiveCount:function(e){return t.getLoginV1ClientWithoutErrorAlert().sendAndThenProcess({url:"https://api.band.us"+b,data:{band_no:e}})},getNotPostedLives:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+v,data:{band_no:e}})},removeNotPostedLive:function(e,n){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+A,method:"POST",data:{band_no:e,live_id:n}})}}}.call(t,n,t,e))||(e.exports=i)},,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i=n(13),o={GET_ADDON_TOKEN:"/v2.0.0/get_addon_token"},s={getApiClient:function(){return this.apiClient||(i.isLogedIn()?this.apiClient=t.getLoginV1Client():this.apiClient=t.getNoLoginV1Client()),this.apiClient},getAddonToken:function(e,t,n,i){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us"+o.GET_ADDON_TOKEN,data:{band_no:e,post_no:t,post_addon_id:n,scope:i}})}};return s.PATHS=o,s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(10),o=n(152),s=n(633),a=n(82),r=n(158),l=n(506);function c(e){var n=e.model,c=e.attachmentDisplayType==o.ATTACHMENT_DISPLAY_TYPE.HEADER,d=e.bPostDetail||!1,u=function(e,t){var n=e.get("image"),i=e.get("imageWidth"),o=e.get("imageHeight"),r=e.get("imageType"),l=/^https?:\/\//.test(n),c=i>=130,d=l&&c?n:null,u=s.getSnippetThumbnailTypeOfImage({url:d,width:i,height:o});(u!=s.TYPE_NO_IMAGE&&t||r===s.SNIPPET_VIEW_TYPE.SMALL)&&(u=s.TYPE_SQUARE);return{imageType:u,imageUrl:a.makePostSnippetThumbnailUrl(u,d)}}(n,c),h=i.trim(n.get("oembedHtml"));this._isOembedStyle=d&&function(e){try{var n=t(e),i="IFRAME"==n.prop("tagName"),o=/^\s*https:\/\/.+\s*$/i.test(n.attr("src")),s=/^.+((\/>)|(<\/iframe>))$/i.test(e);if(i&&o&&s)return!0}catch(e){}return!1}(h),this._isHeaderType=c,this._isAuthorizedFeature=!!n.get("authorizedFeature"),this._oembedHtml=h,this._imageType=u.imageType,this._imageUrl=u.imageUrl,this._linkUrl=function(e){var t=e.get("authorizedFeature"),n=t?l.get(t,"action.pc"):e.get("url"),o=n?n.toLowerCase():null;if(!r.validateUrl(n))return null;if(i.startsWith(o,"www."))return"http://"+n;if(i.startsWith(o,"ftp."))return"ftp://"+n;return n}(n),this._title=i.trim(n.get("title")),this._description=i.trim(n.get("description")),this._footerText=function(e){var t=e.get("domain"),n=e.get("authorizedFeature");n&&(t=n.footerText);return t}(n),this._isVideo=/^video(\..*)?$/.test(n.get("type")),this._isYoutube=!!this._linkUrl&&i.include(this._footerText,"youtube.com"),this._isYoutubeStyle=this._imageUrl&&this._isVideo&&this._isYoutube&&!this._isHeaderType,this._youtubeUrl=this._isYoutubeStyle?this._linkUrl:null}return c.prototype.isOembedStylePostSnippet=function(){return this._isOembedStyle},c.prototype.isHeaderTypePostSnippet=function(){return this._isHeaderType},c.prototype.isAuthorizedFeaturePostSnippet=function(){return this._isAuthorizedFeature},c.prototype.getPostSnippetOembedHtml=function(){return this._oembedHtml},c.prototype.getPostSnippetImageType=function(){return this._imageType},c.prototype.getPostSnippetImageUrl=function(){return this._imageUrl},c.prototype.getPostSnippetLinkUrl=function(){return this._linkUrl},c.prototype.getPostSnippetTitle=function(){return this._title},c.prototype.getPostSnippetDescription=function(){return this._description},c.prototype.getPostSnippetFooterText=function(){return this._footerText},c.prototype.isVideoPostSnippet=function(){return this._isVideo},c.prototype.isYoutubePostSnippet=function(){return this._isYoutube},c.prototype.isYoutubeStylePostSnippet=function(){return this._isYoutubeStyle},c.prototype.getPostSnippetYoutubeUrl=function(){return this._youtubeUrl},c.buildPostSnippetViewData=function(e){return new c(e)},c}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){return{facebook:function(e){if(window.isMobile){var t="https://m.facebook.com/sharer.php?u="+encodeURIComponent(e.url);window.open(t,"_blank")}else{t="https://www.facebook.com/sharer.php?u="+encodeURIComponent(e.url);window.open(t,"FACEBOOK","width=410, height=400")}},twitter:function(e){var t="https://twitter.com/intent/tweet?text="+encodeURIComponent(e.url);window.isMobile?window.open(t,"_blank"):window.open(t,"_TWITTER_SHARE","width=500, height=445")},cafe:function(e){this._submitCafeBlog({source:e.source||"BAND",url:e.url,title:e.title||"",contents:e.contents||""},"cafe")},_submitCafeBlog:function(e,t){window.isMobile?document.charset="utf-8":document.charset="euc-kr";var n={cafe:{mobile:"http://m.cafe.naver.com/CafeScrapView.nhn",pc:"http://cafe.naver.com/CafeScrapView.nhn"},blog:{mobile:"http://m.blog.naver.com/OpenScrapForm.nhn",pc:"http://blog.naver.com/ScrapForm.nhn"}}[t],i=n.pc;window.isMobile&&(i=n.mobile);var o=document.getElementById("_postCafeForm");(null==o&&((o=document.createElement("form")).id="_postCafeForm",o.action=i,o.method="post",window.isMobile?o.setAttribute("accept-charset","utf-8"):(o.target="_NAVER_SHARE",o.setAttribute("accept-charset","euc-kr"))),$(o).append($('<INPUT type="hidden" name="blogId" value="naver">')),$(o).append($('<INPUT type="hidden" name="source_type" value="118">')),$(o).append($('<INPUT type="hidden" name="source_title" value="'+e.source+'">')),$(o).append($('<INPUT type="hidden" name="source_url" value="'+e.url+'">')),$(o).append($('<INPUT type="hidden" name="title" value="'+e.title+'">')),$(o).append($('<textarea name="source_contents">'+e.contents+"</textarea>")),document.body.appendChild(o),window.isMobile)||window.open("","_NAVER_SHARE","width=410, height=550").focus();o.submit(),o.parentNode.removeChild(o),document.charset="utf-8"}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1355),s=n(522),a=n(638),r=n(578),l="-post",c="-comment",d="-chat",u="-photoView",h="-schedule",p="NONE",m="EACH",_="VIEW",g="-s",f="-ss",b=i.View.extend({tagName:function(){return this.options.clickType===_?"button":"div"},className:function(){return["uEmotionView",a.EMOTION_COUNT_VIEW_CLASS,this.options.sizeType,this.options.originType].join(" ")},attributes:function(){return t.extend({"data-viewname":"DEmotionCountView"},this.options.clickType===_?{type:"button"}:null)},template:t.template(o),ui:{iconBtn:"._iconBtn",countBtn:"._countBtn"},events:{"click @ui.iconBtn":function(){this._clickType===m&&this.trigger("DEmotionCountView:clickIcon")},"click @ui.countBtn":function(){this._clickType===m&&this.trigger("DEmotionCountView:clickCount")},click:function(){this._clickType===_&&this.trigger("DEmotionCountView:clickView")}},initialize:function(e){this._originType=e.originType,this._sizeType=e.sizeType,this._emotionTypes=e.emotionTypes,this._emotionCount=e.emotionCount||0,this._emotionTypeByViewer=e.emotionTypeByViewer,this._clickType=e.clickType,this._maxCount=e.maxCount||NaN},serializeData:function(){return{emotions:s.getDetailAttributes(t.first(this._emotionTypes,2)),emotionCount:this._getEmotionCount(),sizeType:this._sizeType,clickable:this._clickType===m,active:this._isActive()}},_isActive:function(){switch(this._originType){case c:case d:return null!=s.getIconName(this._emotionTypeByViewer);default:return!1}},_getEmotionCount:function(){return this._emotionCount>this._maxCount?r.numberWithCommas(this._maxCount)+"+":r.numberWithCommas(this._emotionCount)}});return b.buildPostEmotionCountView=function(e,t,n,i,o){return new b({originType:l,sizeType:g,emotionTypes:e,emotionCount:t,emotionTypeByViewer:n,clickType:i?o?m:_:p})},b.buildImageViewerEmotionCountView=function(e,t,n,i){return new b({originType:u,sizeType:g,emotionTypes:e,emotionCount:t,emotionTypeByViewer:n,clickType:i?_:p})},b.buildCommentEmotionCountView=function(e,t,n,i){return new b({originType:c,sizeType:f,emotionTypes:e,emotionCount:t,emotionTypeByViewer:n,clickType:i?_:p,maxCount:999})},b.buildChatEmotionCountView=function(e,t,n,i){return new b({originType:d,sizeType:f,emotionTypes:e,emotionCount:t,emotionTypeByViewer:n,clickType:i?_:p,maxCount:999})},b.buildScheduleEmotionCountView=function(e,t){return new b({originType:h,sizeType:g,emotionTypes:e,emotionCount:t,emotionTypeByViewer:null,clickType:p,maxCount:999})},b}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(4),s={MENU_SELECTED:"MENU_SELECTED"},a='<% _.each(items, function(optionMenu) { %>\n<li class="<%= menuStyleClasses.listItemClass %>">\n    <button class="_optionMenuLink <%= menuStyleClasses.btnClass %>" data-menu-id="<%= optionMenu.id %>"><%= optionMenu.title %></button>\n</li>\n<% }); %>',r=o.View.extend({tagName:"ul",className:function(){return this.options.menuStyleClasses.listClass},attributes:{"data-viewname":"DOptionMenuListView",style:"min-width: 145px"},template:t.template(a),templateContext:function(){return{menuStyleClasses:this._menuStyleClasses}},ui:{optionMenuLink:"._optionMenuLink"},events:{"click @ui.optionMenuLink":function(e){var t=$(e.currentTarget).data("menuId");this.trigger(s.MENU_SELECTED,t)}},initialize:function(e){this._menuStyleClasses=e.menuStyleClasses}});return r.build=function(e,n){return n=t.extend({listClass:"",listItemClass:"",btnClass:""},n),new r({collection:new i.Collection(e),menuStyleClasses:n})},r.buildLyMenu=function(e,n){var o={"data-viewname":"DOptionMenuListView"};return n&&(o.style="min-width: "+n+"px"),new r({collection:new i.Collection(e),menuStyleClasses:{listClass:"",listItemClass:"",btnClass:""},tagName:"ul",attributes:o,template:t.template("<ul>"+a+"</ul>"),className:"lyMenu"})},r.EVENTS=s,r.OPTION_MENU_LINK_CLASS="_optionMenuLink",r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(159),s=n(487),a=n(736),r=n(513),l=n(26),c=n(885),d="url_play_inplace",u="url_open";return i.Behavior.extend({behaviors:[{behaviorClass:o},s,{behaviorClass:a}],ui:{snippetLink:"._snippetLink",imageWrap:"._imageWrap",youtubeVideo:"._youtubeVideo"},events:{"click @ui.snippetLink":function(e){var t=this.ui.imageWrap.get(0),n=this.ui.youtubeVideo.get(0);e.preventDefault(),e.stopPropagation(),l.getDGlobalChannel().trigger(l.EVENT.HTML_CLICK,e),this._viewData.isYoutubeStylePostSnippet()&&(t.contains(e.target)||n.contains(e.target))||this._openSnippetUrl()},"click @ui.imageWrap":function(e){!this._youtubePlayer&&this._viewData.isYoutubeStylePostSnippet()&&(e.preventDefault(),this._playYoutubeVideo().then(t.bind((function(e){this._youtubePlayer=e,this.listenToOnce(e,"videoPlayer:play",(function(){this._sendClickLog(d)}))}),this)))}},initialize:function(e){this._bandNo=e.bandNo,this._postNo=e.postNo,this._viewData=c.buildPostSnippetViewData({model:e.model,attachmentDisplayType:e.attachmentDisplayType,bPostDetail:e.bPostDetail}),e.viewDataSetter(this._viewData),this._playYoutubeVideo=e.playYoutubeVideo,this._exposed=!1,this.listenTo(this.view,"intersect",this._sendExposureLog)},onAttach:function(){this.listenTo(l.getDGlobalChannel(),l.EVENT.YOUTUBE_LINK_OPEN,(function(){this._youtubePlayer&&this._youtubePlayer.pause()}))},onBeforeDetach:function(){this.stopListening(l.getDGlobalChannel(),l.EVENT.YOUTUBE_LINK_OPEN),this._destroyYoutubePlayer()},_destroyYoutubePlayer:function(){this._youtubePlayer&&(this._youtubePlayer.destroy(),this._youtubePlayer=null)},_openSnippetUrl:function(){var e=this._viewData.getPostSnippetLinkUrl();this._viewData.isYoutubePostSnippet()&&this._viewData.isHeaderTypePostSnippet()?this.view.trigger("attachmentSnippet:showPostDetailLayer"):e?(this._sendClickLog(u),l.getDGlobalChannel().trigger(l.EVENT.YOUTUBE_LINK_OPEN),r.openWindowXSSSafely(e,"_blank")):this._viewData.isAuthorizedFeaturePostSnippet()&&(this._sendClickLog(u),alert(IM("web.post.subpost.alert.not_supported_in_web")))},_sendExposureLog:function(e){e.isIntersecting&&(this._exposed||(this._exposed=!0,this._viewData.isAuthorizedFeaturePostSnippet()&&this._sendSubPostExposureLog()))},_sendClickLog:function(e){this._viewData.isAuthorizedFeaturePostSnippet()?this._sendSubPostClickLog():this._sendUrlClickLog(e)},_sendUrlClickLog:function(e){this.view.jplClick(s.CLASSIFIER.URL_IN_POST,{band_no:this._bandNo,post_no:this._postNo,url:this._viewData.getPostSnippetLinkUrl(),type:e})},_sendSubPostExposureLog:function(){this.view.jplExposure(s.CLASSIFIER.SUB_POST_AREA,this._getSubPostClickLogExtraValue())},_sendSubPostClickLog:function(){this.view.jplClick(s.CLASSIFIER.SUB_POST_AREA,this._getSubPostClickLogExtraValue())},_getSubPostClickLogExtraValue:function(){return{band_no:this._bandNo,post_no:this._postNo,subpost_value:this._viewData.getPostSnippetLinkUrl()||"Web_no_url"}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i=n(13),o="/v2.0.0/get_audio_url_by_post";return{getApiClient:function(){return this.apiClient||(i.isLogedIn()?this.apiClient=t.getLoginV1Client():this.apiClient=t.getNoLoginV1Client()),this.apiClient},getAudioUrlByPost:function(e,t,n){return this.getApiClient().send({url:"https://api.band.us"+o,data:{band_no:e,post_no:t,audio_id:n,is_https_enabled:!0}}).then((function(e){return e.result_data}))}}}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,function(e,t){t.EVENT={ATTACH:"editor:attachment:attach",CANCEL:"editor:attachment:cancel",WIDGET_MEDIA_LOADED:"editor:widget:media:loaded",WIDGET_CHANGED:"editor:widget:changed",WIDGET_ADDED_HASHTAG:"editor:widget:added:hashtag"}},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(10),s=n(2),a=n(4),r=n(1320),l=n(1321),c=n(1324),d=n(1327),u=n(581),h=n(488),p=n(486),m=n(159),_={WIDE:{WIDTH_CLASS_NAME:"-w480",MEMBER_LIST_CLASS_NAME:"-flexibleHeight",SELECTED_USER_COUNT_PER_LINE:7},NARROW:{WIDTH_CLASS_NAME:"-w380",MEMBER_LIST_CLASS_NAME:"columnFlexible",SELECTED_USER_COUNT_PER_LINE:6}},g=a.View.extend({attributes:{"data-viewname":"DMemberSelectionView"},tagName:"section",className:"lyWrap",template:i.template(r),behaviors:[m],ui:{loadingArea:"._loadingArea",emptyArea:"._emptyArea",emptyMessage:"._emptyMessage",memberListRegion:"._memberListRegion",memberSearchInput:"._memberSearchInput",btnSearch:"._btnSearch",btnClose:"._btnClose",btnSubmit:"._btnSubmit",memberListArea:"._memberListArea",btnSearchMoreMember:"._btnSearchMoreMember",searchMoreBtnText:"._searchMoreBtnText",selectedMemberListRegion:"._selectedMemberListRegion",selectedMemberArea:"._selectedMemberArea",mainContainer:"._mainContainer",memberSortArea:"._memberSortArea",memberSortSelectArea:"._memberSortSelectArea",memberSortTitle:"._memberSortTitle",memberSortSelect:"._memberSortSelect",btnMemberGroupSelect:"._btnMemberGroupSelect",memberGroupArea:"._memberGroupArea"},regions:{memberListRegion:{el:"@ui.memberListRegion",replaceElement:!0},selectedMemberListRegion:{el:"@ui.selectedMemberListRegion",replaceElement:!0}},onMessages:(t={},t[m.MSG.MEMBER_SELECTION_MEMBER_CLICK]=function(e){var t=e.memberSelectModel;if(t.isSelectAllBtn()){var n=e.toBeSelect?g.EVENT.MEMBER_SELECTION_ALL_SELECT_CLICK:g.EVENT.MEMBER_SELECTION_ALL_DESELECT_CLICK,i=this._isMemberListExist()?this._memberListView.getMemberModelsOnly():[];this.trigger(n,{memberSelectionModels:i})}else e.toBeSelect?this.trigger(g.EVENT.MEMBER_SELECTION_MEMBER_SELECT_CLICK,{selectedMember:t,selectedMemberCount:this._isSelectedMemberExist()?this._selectedMemberListView.getSelectedMemberCount():0}):this.trigger(g.EVENT.MEMBER_SELECTION_MEMBER_DESELECT_CLICK,t.getUserNo())},t[m.MSG.MEMBER_SELECTION_PROFILE_CLICK]=function(e){this.trigger(g.EVENT.MEMBER_SELECTION_MEMBER_PROFILE_CLICK,e)},t),initialize:function(e){this._viewWidthType=e.viewWidthType,this._onlySingleSelection=e.onlySingleSelection,this._profileClickAsSelect=e.profileClickAsSelect,this._titleText=e.titleText,this._submitBtnText=e.submitBtnText,this._cancelBtnText=e.cancelBtnText,this._descriptionText=e.descriptionText},templateContext:function(){return{cid:this.cid,titleText:this._titleText,submitBtnText:this._submitBtnText,cancelBtnText:this._cancelBtnText,descriptionExist:!i.isEmpty(this._descriptionText),descriptionText:this._descriptionText,wideView:this._viewWidthType==_.WIDE}},events:{"input @ui.memberSearchInput":function(){var e=this.ui.memberSearchInput.val().length<=0;this.ui.btnSearch.toggleClass(h.ELEMENT.DISABLED,e).toggleClass(h.ELEMENT.ACTIVE,!e),e&&this.trigger(g.EVENT.MEMBER_SELECTION_INPUT_EMPTY)},"click @ui.btnSearch":function(){var e=o.trim(this.ui.memberSearchInput.val());return!!e&&(this.trigger(g.EVENT.MEMBER_SELECTION_SEARCH,e),!1)},"click @ui.btnClose":function(){this.destroy()},"click @ui.btnSubmit":function(){return!!this._isSelectedMemberExist()&&(this.trigger(g.EVENT.MEMBER_SELECTION_COMPLETE,{selectedMembers:this._selectedMemberListView.getSelectedModels()}),!1)},"click @ui.btnSearchMoreMember":function(){return this.ui.memberSearchInput.focus(),!1},"change @ui.memberSortSelect":function(){this.trigger(g.EVENT.MEMBER_SELECTION_SORT_CHANGE,this.ui.memberSortSelect.val())},"click @ui.btnMemberGroupSelect":function(){this.trigger(g.EVENT.MEMBER_SELECTION_MEMBER_GROUP_CLICK)}},renderSortArea:function(e){var t=1==e.showSortArea;this.ui.memberSortArea.toggle(t),this.ui.memberSortArea.toggleClass("memberSortWrap",t),t&&(this.ui.memberSortTitle.text(e.memberSortTitle),this.ui.memberSortSelect.empty(),i.each(e.sortOptions,(function(e){var t=s("<option>").text(e.optionTitle).prop("selected",1==e.selected).prop("value",e.value);this.ui.memberSortSelect.append(t)}),this))},showMemberSortSelectArea:function(){this.ui.memberSortSelectArea.show()},hideMemberSortSelectArea:function(){this.ui.memberSortSelectArea.hide()},renderMemberListToSelect:function(e){this.ui.loadingArea.hide();var t=i.isEmpty(e.memberModels);this.ui.emptyArea.toggle(t),this.ui.memberListArea.toggle(!t),this._renderMemberGroupBtn(e.memberGroupSelectSupport),this.ui.emptyMessage.text(e.emptyMessage||IM("member_list.label.nobody_available")),this.ui.searchMoreBtnText.text(e.searchMoreBtnText||IM("member_list.label.group_band.has_more_member")),t||(this.ui.btnSearchMoreMember.toggle(1==e.showSearchMoreMemberBtn),this._memberListView=l.buildDMemberSelectionMemberListView({collection:this._changeMemberCollectionSelectStatus(e.memberModels),onlySingleSelection:this._onlySingleSelection,profileClickAsSelect:this._profileClickAsSelect}),this.showChildView("memberListRegion",this._memberListView))},selectMember:function(e){this.isDestroyed()||null==e||e.isSelectAllBtn()||(e.setSelected(!0),this._createSelectedMemberListViewIfNotExist([e]),this._selectedMemberListView.addSelectedMember(e),this._changeClassBySelectStatus(),this._changeSubmitBtnText(),this._isMemberListExist()&&this._memberListView.selectMember(e.getUserNo()))},deselectMember:function(e){e!=u.NONE_EXIST_USER_NO&&(this._selectedMemberListView.removeSelectedMember(e),this._makeNoneSelectedViewIfPossible(),this._changeClassBySelectStatus(),this._changeSubmitBtnText(),this._isMemberListExist()&&this._memberListView.deselectMember(e))},deselectAllMembers:function(){this._isSelectedMemberExist()&&(this._selectedMemberListView.removeAllSelectedMembers(),this._makeNoneSelectedViewIfPossible(),this._changeClassBySelectStatus(),this._changeSubmitBtnText(),this._isMemberListExist()&&this._memberListView.deselectAllMembers())},getSelectedMembers:function(){return this._isSelectedMemberExist()?this._selectedMemberListView.getSelectedModels():[]},getSelectedMemberCount:function(){return this.getSelectedMembers().length},destroyView:function(){this.destroy()},_renderMemberGroupBtn:function(e){this.ui.memberGroupArea.toggle(e||!1)},_changeMemberCollectionSelectStatus:function(e){var t=d.buildMemberSelectionViewCollection(e),n=[];return null!=this._selectedMemberListView&&(n=this._selectedMemberListView.getSelectedMemberUserNos()),t.each((function(e){var t=i.contains(n,e.getUserNo());e.setSelected(t)})),t},_changeClassBySelectStatus:function(){this.ui.memberListArea.removeClass("-only -multi"),this._isSelectedMemberExist()&&this.ui.memberListArea.addClass(this._selectedMemberListView.getSelectedMemberCount()>this._viewWidthType.SELECTED_USER_COUNT_PER_LINE?"-multi":"-only")},_createSelectedMemberListViewIfNotExist:function(e){if(null==this._selectedMemberListView)if(i.isEmpty(e))this._makeNoneSelectedViewIfPossible();else{var t=d.buildMemberSelectionViewCollection(e);this._selectedMemberListView=c.buildDMemberSelectionSelectedMemberListView({collection:t}),this.showChildView("selectedMemberListRegion",this._selectedMemberListView),this.ui.selectedMemberArea.show()}},_makeNoneSelectedViewIfPossible:function(){(null==this._selectedMemberListView||this._selectedMemberListView.isEmptyCollection())&&(this.ui.selectedMemberArea.hide(),this._selectedMemberListView=null,this.getRegion("selectedMemberListRegion").empty(),this.ui.memberListArea.removeClass("-only -multi"))},_changeSubmitBtnText:function(){this.ui.btnSubmit.toggleClass(h.ELEMENT.DISABLED,!this._isSelectedMemberExist());var e=this._submitBtnText;this._isSelectedMemberExist()&&(e=this._submitBtnText+"("+this._selectedMemberListView.getSelectedMemberCount()+")"),this.ui.btnSubmit.text(e)},_isSelectedMemberExist:function(){return null!=this._selectedMemberListView},_isMemberListExist:function(){return null!=this._memberListView}});return g.EVENT={MEMBER_SELECTION_MEMBER_SELECT_CLICK:"MEMBER_SELECTION_MEMBER_SELECT_CLICK",MEMBER_SELECTION_MEMBER_DESELECT_CLICK:"MEMBER_SELECTION_MEMBER_DESELECT_CLICK",MEMBER_SELECTION_ALL_SELECT_CLICK:"MEMBER_SELECTION_ALL_SELECT_CLICK",MEMBER_SELECTION_ALL_DESELECT_CLICK:"MEMBER_SELECTION_ALL_DESELECT_CLICK",MEMBER_SELECTION_MEMBER_PROFILE_CLICK:"MEMBER_SELECTION_MEMBER_PROFILE_CLICK",MEMBER_SELECTION_SEARCH:"MEMBER_SELECTION_SEARCH",MEMBER_SELECTION_INPUT_EMPTY:"MEMBER_SELECTION_INPUT_EMPTY",MEMBER_SELECTION_COMPLETE:"MEMBER_SELECTION_COMPLETE",MEMBER_SELECTION_MEMBER_GROUP_CLICK:"MEMBER_SELECTION_MEMBER_GROUP_CLICK",MEMBER_SELECTION_SORT_CHANGE:"MEMBER_SELECTION_SORT_CHANGE"},g.openDMemberSelectionView=function(e){var t=(e=e||{}).wideView?_.WIDE:_.NARROW,n=new g({viewWidthType:t,onlySingleSelection:1==e.onlySingleSelection,profileClickAsSelect:1==e.profileClickAsSelect,titleText:e.titleText||IM("web.bandmemberselection.title"),submitBtnText:e.submitBtnText||IM("web.invitemember.btn.action"),cancelBtnText:e.cancelBtnText||IM("ui.label.cancel"),descriptionText:e.descriptionText||""});return p.open(n),n},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){n(0);var t=n(4),i=n(178),o=n(1025),s=n(53);return t.Behavior.extend({initialize:function(e){this._bandNo=e.bandNo,this._isAccessedByVirtualMember=!!s.getCurrentRouteInfo().params.token},onAttach:function(){this._sendEmailNotificationReceivedOccurLog()},_sendEmailNotificationReceivedOccurLog:function(){var e=o.extractEmailNotificationParamsFromQueryString();if(o.hasEmailNotificationParams(e))try{i.sendLog(i.SCENE.ENGAGEMENT_TRACKING,i.ACTION_ID.OCCUR,i.CLASSIFIER.EMAIL_NOTIFICATION_RECEIVED,{notified_by:e.notifiedBy,notification_type:e.notificationType,task_id:e.taskId,band_no:this._bandNo,is_virtual_member:this._isAccessedByVirtualMember?"Y":"N"})}catch(e){}}})}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(158),i=n(543),o={EMAIL:{NAME:"email",RESULT:{SUCCESS:"success",EMPTY_EMAIL:"empty_email",WRONG_FORM:"wrong_form"},validateEmail:function(e){if(t.isEmpty(e))return o.EMAIL.RESULT.EMPTY_EMAIL;return/^[-\.\w]+\@(?:[a-zA-Z0-9-]{1,63})(?:\.[a-zA-Z0-9-]{1,63}){0,126}/.test(e)?o.EMAIL.RESULT.SUCCESS:o.EMAIL.RESULT.WRONG_FORM}},PASSWORD:{MIN_PASSWORD_LENGTH:8,MAX_PASSWORD_LENGTH:256,NAME:"password",RESULT:{SUCCESS:"success",TOO_SHORT_PASSWORD:"too_short_password",TOO_LONG_PASSWORD:"too_long_password",NONE_NUMBER:"none_number",NONE_ALPHABET:"none_alphabet",UNMATCHED:"unmatched"},validatePassword:function(e,t){return null==e||e.length<o.PASSWORD.MIN_PASSWORD_LENGTH?o.PASSWORD.RESULT.TOO_SHORT_PASSWORD:e.length>o.PASSWORD.MAX_PASSWORD_LENGTH?o.PASSWORD.RESULT.TOO_LONG_PASSWORD:/[0-9]/.test(e)?/[a-zA-Z]/.test(e)?e!=t?o.PASSWORD.RESULT.UNMATCHED:o.PASSWORD.RESULT.SUCCESS:o.PASSWORD.RESULT.NONE_ALPHABET:o.PASSWORD.RESULT.NONE_NUMBER}},BAND_URL_SHORTCUT:{BAND_SHORTCUT_MAX_LENGTH:i.BAND_TYPE_CONDITION.BAND_SHORTCUT_MAX_LENGTH,BAND_SHORTCUT_MIN_LENGTH:i.BAND_TYPE_CONDITION.BAND_SHORTCUT_MIN_LENGTH,NAME:"band_url_shortcut",RESULT:{SUCCESS:"success",TOO_SHORT_SHORTCUT:"too_short_shortcut",TOO_LONG_SHORTCUT:"too_long_shortcut",WRONG_FORM:"wrong_form"},validateBandShortcut:function(e){return null==e||e.length<o.BAND_URL_SHORTCUT.BAND_SHORTCUT_MIN_LENGTH?o.BAND_URL_SHORTCUT.RESULT.TOO_SHORT_SHORTCUT:e.length>o.BAND_URL_SHORTCUT.BAND_SHORTCUT_MAX_LENGTH?o.BAND_URL_SHORTCUT.RESULT.TOO_LONG_SHORTCUT:/^[0-9a-z]+$/.test(e)?o.BAND_URL_SHORTCUT.RESULT.SUCCESS:o.BAND_URL_SHORTCUT.RESULT.WRONG_FORM}}};return o}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(541),a=n(510),r=n(153),l=n(513);return new(o.Object.extend({initialize:function(){this._bandNo=null,this._canSetFileIntoQuota=!1},fetchQuotaStatus:function(e){var n=t.Deferred();return window.isMobileView||e.getBandNo()===this._bandNo||!e.canConfigureContentsQuota()?n.resolve():(s.getQuotaInfo(e.getBandNo(),!0).then(i.bind((function(t){var n=t.band_quota;this._canSetFileIntoQuota=e.canConfigureContentsQuota()&&"enabled"===n.quota_status&&"small_only"===n.file_quota_policy,this._bandNo=e.getBandNo()}),this)).always((function(){n.resolve()})),n.promise())},resetCachedQuotaStatus:function(){this._bandNo=null},canSetFileIntoQuota:function(e,t,n){return e===this._bandNo&&t>(new Date).getTime()&&n>10485760&&this._canSetFileIntoQuota},canSetVideoIntoQuota:function(e,t,n){return e===this._bandNo&&t>(new Date).getTime()&&n>10485760&&this._canSetFileIntoQuota},startSettingFileIntoQuota:function(e){var n=t.Deferred();return a.openLayer({headerTitle:IM("web.postdetail.attachfile.settingSave"),bodyDesc:IM("setting.quota.storage.large_files.layer.description"),confirm:IM("setting.quota.storage.large_files.option.all"),cancel:IM("ui.label.cancel"),withoutHiding:e.withoutHiding}).once(a.EVENTS.CONFIRM,i.bind((function(){this._setFileIntoQuota(e).then((function(){n.resolve()}),(function(){n.reject()}))}),this)).once(a.EVENTS.CANCEL,(function(){n.reject()})),n.promise()},_setFileIntoQuota:function(e){var t=e.bandNo,n=e.fileId,i=e.withoutHiding;return s.setFileIntoQuota(t,n).then((function(){alert(IM("setting.quota.save.alert"))}),(function(e){1027===e.result_code&&a.openLayer({headerTitle:IM("web.postdetail.attachfile.settingSave"),bodyDesc:IM("setting.quota.storage.error_files.layer.description"),confirm:IM("bandsetting.quota_status.storage.management"),cancel:IM("ui.label.cancel"),withoutHiding:i}).once(a.EVENTS.CONFIRM,(function(){var e=r.GROUP_BAND_SETTING_MEDIA_QUOTA.makeUrl({band_no:t});l.openWindowXSSSafely(e,"_blank")}))}))}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(569),o=n(1303),s=n(636);return{buildBandMentionsInput:function(e,t,n,i,s,a){var r={bandNo:t,el:e,autoCompleteListElParent:n,autoCompleteListClass:i,offsetAdjustEl:s,mentionArray:[],disableMention:a};return o.buildDMentionsInput(r)},fetchMembersAndPopulateMentionsInput:function(e,t,n,o){return i.fetchCachedBandMembers(e).then((function(e){t.changeMentionArrayAndInputOptions({mentionArray:i.convertCollectionToMentionArray(e.memberCollection,n),dynamicSearchRequired:e.hasMoreMember,hideCompleteListOnEmptyQuery:e.hasMoreMember&&!o,canMentionMemberGroup:!1})}))},fetchMembersAndGroupsAndPopulateMentionsInput:function(e,n,o,s,a){return i.fetchMentionMembersAndMemberGroups(e).then(t.bind((function(e){var t=e.hasMoreMember&&a.isDynamicSearchPossible(),i=e.canMentionMemberGroup&&a.isMemberGroupMentionPossible();n.changeMentionArrayAndInputOptions({mentionArray:this._populateFetchedMentionData(e,o,i,a.getFixedTargetMemberMentionArray(),a.canMentionLeaderAndColeaderAsWell()),dynamicSearchRequired:t,hideCompleteListOnEmptyQuery:t&&!s,canMentionMemberGroup:i})}),this))},_populateFetchedMentionData:function(e,t,n,o,a){return s.makeCommentMentionTargets({mentionLeaderAndColeaderAsWell:a,withMemberGroupMention:n,bandMemberMentionArray:i.convertCollectionToMentionArray(e.memberCollection,t),leaderColeaderMentionArray:i.convertCollectionToMentionArray(e.leaderColeaderCollection,t),memberGroupMentionArray:e.memberGroupMentionArray,fixedTargetMemberMentionArray:o})},buildDChatMentionsInput:function(e,t,n,i,s,a){var r={el:e,autoCompleteListElParent:t,autoCompleteListClass:n,mentionArray:[],offsetAdjustEl:i,hideCompleteListOnEmptyQuery:s,disableMention:a};return o.buildDMentionsInput(r)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(1361),a=n(486),r=o.View.extend({tagName:"section",className:"lyWrap",template:i.template(s),templateContext:function(){return{msg_title:this.options.title,msg_desc:this.options.desc,msg_maxlength:this.options.maxlength,msg_defaultText:this.options.defaultText,msg_labelName:this.options.labelName,multiline:this.options.multiline,placeholder:this.options.placeholder||"",helpGuide:this.options.helpGuide}},ui:{btnConfirm:"._confirmButton",btnCancel:"._cancelButton",inputText:"._inputText"},events:{"click @ui.btnConfirm":function(){this.trigger("modal:confirm",this.getUI("inputText").val()),this.destroy()},"click @ui.btnCancel":function(){this._destroy()},"input @ui.inputText":function(){this._inputTextCheck()},"change @ui.inputText":function(){this._inputTextCheck()},"cut @ui.inputText":function(){this._inputTextCheck()},"paste @ui.inputText":function(){this._inputTextCheck()}},_destroy:function(){this.trigger("modal:cancel"),this.destroy()},isValid:function(e){return!!this.options.validation&&this.options.validation(e)},_inputTextCheck:function(){i.defer(i.bind((function(){var e=this.isValid(t.trim(this.getUI("inputText").val()));this.getUI("btnConfirm").prop("disabled",!e)}),this))},onAttach:function(){this._inputTextCheck(),this.getUI("inputText").focus();var e=this.getUI("inputText").get(0),t=this.getUI("inputText").val(),n=t?t.length:null;n&&e.setSelectionRange&&e.setSelectionRange(n,n)},initialize:function(e){this._maxLength=e.maxlength}});return r.openDPromptModalView=function(e){var n=new r(t.extend({labelName:IM("ui.label.input"),multiline:!1,placeholder:null,helpGuide:null,validation:function(t){return t.length>0||e.isEnabledConfirmButton}},e));return e.withoutHiding?a.openWithoutHiding(n):a.open(n),n},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(2),s=n(171);o.fn.removeBandSkin=function(){return this.removeClass(s.ALL_TYPES.join(" ")),this},o.fn.bandSkin=function(e){if(null==e){var n=i.words(this[0].className);return t.find(s.ALL_TYPES,(function(e){return t.contains(n,e)}))}return this.removeBandSkin().addClass(e)},o.fn.bandSkinByThemeColor=function(e){console.log("ThemeColor는 BandCore.js 의 getSkinColorClass()를 사용해야 합니다."),this.bandSkin(s.findByThemeColor(e))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2486),a=n(2487),r=n(549),l=n(486),c=n(154),d=n(498),u=n(565),h=n(636),p=n(889),m=n(499),_=n(26),g=n(2488),f=n(159),b=n(488),v=n(2525),A=n(153),E=n(491),T=n(849),C=n(908),y=n(53),M=n(495),I=n(487),S=n(619);n(185);var w,N=o.View.extend({tagName:"section",className:function(){return this._isNotLayerView()?"scheduleSectionArea gBoxShadow":"scheduleSectionArea lyWrap"},attributes:{"data-viewname":"DScheduleDetailView"},behaviors:function(){var e={CourierBehavior:"",JplSceneBehavior:{behaviorClass:M,sceneId:M.SCENE.SCHEDULE_DETAIL},JplActionBehavior:I};return y.getCurrentRouteInfo().routeInfo==A.GROUP_BAND_SCHEDULE&&t.extend(e,{EmailNotificationJackpotLogBehavior:{behaviorClass:C,bandNo:this.options.bandNo}}),e},templateContext:function(){return this._dataFetched?{lyClass:t.bind((function(){return this._isNotLayerView()?"lySchedule -nonLy":this._showBandNameTitle?"lySchedule -extension -feedModal":"lySchedule -extension"}),this),showBtnGotoTop:!this._isNotLayerView(),showBandNameTitle:this._showBandNameTitle,bandUrl:A.GROUP_BAND_HOME.makeUrl({band_no:this.model.getBandNo()}),commentCount:this.model.get("commentCount")||0}:{lyClass:t.bind((function(){return this._isNotLayerView()?"lySchedule -nonLy":"lySchedule"}),this),loadingContent:t.template(d)({_loading_size:m.Size.MEDIUM,middleClass:b.ELEMENT.SCREEN_VERTICAL_MIDDLE})}},ui:{scheduleArticle:"._scheduleArticle",scheduleRegion:"._scheduleRegion",commentRegion:"._commentRegion",fixedCommentCountArea:"._fixedCommentCountArea",commentCountArea:"._commentCountArea",goCommentAreaBtn:"._goCommentAreaBtn",writeCommentBtn:"._writeCommentBtn",commentCountText:"._commentCountText",btnGoToTop:"._btnGoToTop",scheduleSectionArea:".scheduleSectionArea"},regions:{scheduleRegion:{el:"@ui.scheduleRegion",replaceElement:!0},commentRegion:{el:"@ui.commentRegion",replaceElement:!0}},onMessages:(w={},w[f.MSG.SCHEDULE_CLOSE_LAYER]=function(){this.destroy()},w[f.MSG.SCHEDULE_GO_LINKED_POSTS]=function(e){this._isWithToken()||(this.destroy(),A.GROUP_BAND_SCHEDULE_ATTACHED_POST.goDForced({band_no:this._bandData.getBandNo(),schedule_id:e}))},w[f.MSG.SCHEDULE_GO_LINKED_POST]=function(e){this._isWithToken()||(this.destroy(),A.GROUP_BAND_POST_DETAIL.goDForced({band_no:this._bandData.getBandNo(),post_no:e}))},w[f.MSG.SCHEDULE_GO_MEMBER_TAB]=function(){this.destroy(),A.GROUP_BAND_MEMBER.goDForced({band_no:this._bandData.getBandNo()})},w[f.MSG.COMMENTLIST_CHANGE_COLLECTION]=function(){S.fetchScheduleTotalCommentCount(this._bandNo,this._scheduleId,this).then(t.bind((function(e){this.ui.commentCountText.text(e),this._adaptFixFloatElement(),this._topButtonFloating();var t=e>0;this.ui.fixedCommentCountArea.toggle(t),this.ui.commentCountArea.toggle(t)}),this))},w),events:{scroll:function(){this._scheduleView&&this._dataFetched&&this._adaptFixFloatElement()},click:function(e){if(!this._isNotLayerView()){var n=i(e.target);n.hasClass(p.OPTION_MENU_LINK_CLASS)||t.isEmpty(window.getSelection().toString())&&0==n.parents("._lyContent:first").length&&this._destroyIfPossible()}},"click @ui.writeCommentBtn":function(){this._commentListView.scrollToMessageInput()},"click @ui.goCommentAreaBtn":function(){this._commentListView.scrollToCommentArea()},"click @ui.btnGoToTop":function(e){e.stopPropagation(),this.$el.scrollTo(0)}},initialize:function(e){this._showBandNameTitle=e.showBandNameTitle||!1,this._bandNo=e.bandNo,this._scheduleId=e.scheduleId,this._dataFetched=!1,this._initCommentId=e.initCommentId,this._initCommentReplyId=e.initCommentReplyId,this._scrollToCommentArea=e.scrollTo==T.COMMENT,this._token=e.token},getTemplate:function(){return this._dataFetched?t.template(s):t.template(a)},onDomRefresh:function(){this._dataFetched&&(this._scheduleView=g.buildDScheduleView(t.extend({},this.options,{bandData:this._bandData})),this.showChildView("scheduleRegion",this._scheduleView),this._renderCommentListView(),this._scrollOnInit(),this._initCommentShortCutFloating())},onAttach:function(){c.wrapActivePromise(i.when(E.getCachedBandData(this._bandNo),this.model.fetchSchedule(this._token)),this).then(t.bind((function(e){this._dataFetched=!0,this._bandData=e,this._sendJplSceneEnterLog(),e.touchContentAccess(),this.render(),this._applyBandThemeColor(),this.listenTo(_.getDGlobalChannel(),_.EVENT.SCHEDULE_DELETED,(function(){this.destroy(),this._isNotLayerView()&&A.GROUP_BAND_CALENDAR.goDForced({band_no:this._bandNo})})),this.listenTo(_.getDGlobalChannel(),_.EVENT.WINDOW_RESIZE,(function(){this._topButtonFloating()})),this.listenTo(_.getDGlobalChannel(),_.EVENT.SCHEDULE_UPDATED,(function(e){this._bandNo==e.bandNo&&this._scheduleId==e.exScheduleId&&1!=e.scheduleDetailNoReload&&(null==this._scheduleView||this._scheduleView.isDestroyed()||c.wrapActivePromise(this._scheduleView.fetchScheduleAndRender(e.scheduleId).then(t.bind((function(){this._scheduleId=e.scheduleId,this._renderCommentListView()}),this))))})),this.trigger("scheduleView:load")}),this),t.bind((function(e){200===e.result_code?this.destroy():A.GROUP_BAND_CALENDAR.goDForced({band_no:this._bandNo})}),this))},layerOnEscKeyDown:function(){this._destroyIfPossible()},_sendJplSceneEnterLog:function(){this.jplSceneEnter(I.CLASSIFIER.SCHEDULE_DETAIL,{band_no:this._bandData.getBandNo(),schedule_id:this.model.get("scheduleId"),schedule_type:this.model.isLocalMeetup()?"local_meetup":"normal"})},_renderCommentListView:function(){this._bandData.canAccessComment()&&(this.getRegion("commentRegion").empty(),c.wrapDeferPromise(this).then(t.bind((function(){this._commentListView=v.buildDScheduleCommentMainView({bandData:this._bandData,scheduleId:this._scheduleId,initCommentId:this._initCommentId,initCommentReplyId:this._initCommentReplyId,mentionOption:u.buildMentionOption({memberGroupMentionPossible:!this.model.isSecret(),dynamicSearchPossible:!this.model.isSecret(),fixedTargetMemberMentionArray:h.makeScheduleCommentMentionTargets(this.model.getOwner(),this.model.getSecretSharers()),leaderColeaderMentionAsWell:this.model.isSecret()})}),this.showChildView("commentRegion",this._commentListView)}),this)))},_destroyIfPossible:function(){null==this._commentListView||this._commentListView.isDestroyed()?this.destroy():this._commentListView.isModificationStatus()||this._commentListView.hasWritingComment()?confirm(IM("comment.cancel_writing_comment"))&&this.destroy():this.destroy()},_isNotLayerView:function(){return!this.options.isLayerView},_isWithToken:function(){return!t.isEmpty(this._token)},_adaptFixFloatElement:function(){this._adaptScheduleHeadFix(),this._adaptCommentShortcutFix()},_applyBandThemeColor:function(){var e=this.model.get("band");t.isEmpty(e)||this.$el.addClass(e.getSkinColorClass())},_initCommentShortCutFloating:function(){this._$elOffsetTop=this.$el.offset().top,this.listenTo(_.getDGlobalChannel(),_.EVENT.WINDOW_RESIZE,this._adaptFixFloatElement)},_adaptScheduleHeadFix:function(){if(!this.isDestroyed()){if(this.$el.scrollTop()>30){if(this._headerFixed)return;return this.getUI("scheduleArticle").css("padding-top",this._scheduleView.getScheduleHeadHeight()),this.getUI("scheduleArticle").addClass("-fixed"),void(this._headerFixed=!0)}this._headerFixed&&(this.getUI("scheduleArticle").removeClass("-fixed"),this.getUI("scheduleArticle").attr("style",""),this._headerFixed=!1)}},_adaptCommentShortcutFix:function(){if(l.isTopLayerView(this)){var e=this.ui.commentCountArea.offset(),t=e?e.top:0;if(t-=this._$elOffsetTop,this.$el.scrollTop()+this.$el.height()<=t){if(this._shortCutShowing)return;return this.ui.fixedCommentCountArea.addClass(b.ELEMENT.ACTIVE),void(this._shortCutShowing=!0)}this._shortCutShowing&&(this._shortCutShowing=!1,this.ui.fixedCommentCountArea.removeClass(b.ELEMENT.ACTIVE))}},_topButtonFloating:function(){var e=i(window).height();this.getUI("scheduleArticle").height()>e?this.getUI("btnGoToTop").addClass("-active"):this.getUI("btnGoToTop").removeClass("-active")},_scrollOnInit:function(){this._scrollToCommentArea&&this._commentListView.scrollToCommentArea()}});return N.openScheduleDetailLayerView=function(e){var n=N.buildScheduleDetailView(t.extend({isLayerView:!0},e));return l.openWithoutHiding(n),n},N.buildScheduleDetailView=function(e){var t=r.createExistingScheduleModel(e.bandNo,e.scheduleId);return new N({showBandNameTitle:e.showBandNameTitle,scheduleId:e.scheduleId,model:t,bandNo:e.bandNo,initCommentId:e.initCommentId,initCommentReplyId:e.initCommentReplyId,scrollTo:e.scrollTo,token:e.token,isLayerView:e.isLayerView||!1})},N}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;window,i=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){var i=n(2),o=n(3),s=n(4);e.exports=function(e,t){return i(e)||o(e,t)||s()}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){var n=[],i=!0,o=!1,s=void 0;try{for(var a,r=e[Symbol.iterator]();!(i=(a=r.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,s=e}finally{try{i||null==r.return||r.return()}finally{if(o)throw s}}return n}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=i=function(e){return n(e)}:e.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},i(t)}e.exports=i},function(e,t,n){var i=n(8),o=n(9),s=n(10);e.exports=function(e){return i(e)||o(e)||s()}},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),s=n(1),a=n.n(s),r=n(5),l=n.n(r),c=new Date,d=new Date;function u(e,t,n,i){function o(t){return e(t=new Date(+t)),t}return o.floor=o,o.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},o.round=function(e){var t=o(e),n=o.ceil(e);return e-t<n-e?t:n},o.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},o.range=function(n,i,s){var a,r=[];if(n=o.ceil(n),s=null==s?1:Math.floor(s),!(n<i&&s>0))return r;do{r.push(a=new Date(+n)),t(n,s),e(n)}while(a<n&&n<i);return r},o.filter=function(n){return u((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,i){if(e>=e)if(i<0)for(;++i<=0;)for(;t(e,-1),!n(e););else for(;--i>=0;)for(;t(e,1),!n(e););}))},n&&(o.count=function(t,i){return c.setTime(+t),d.setTime(+i),e(c),e(d),Math.floor(n(c,d))},o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?o.filter(i?function(t){return i(t)%e==0}:function(t){return o.count(0,t)%e==0}):o:null}),o}var h=u((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));h.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?u((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):h:null};var p=h,m=(h.range,u((function(e){e.setTime(1e3*Math.floor(e/1e3))}),(function(e,t){e.setTime(+e+1e3*t)}),(function(e,t){return(t-e)/1e3}),(function(e){return e.getUTCSeconds()}))),_=m,g=(m.range,u((function(e){e.setTime(6e4*Math.floor(e/6e4))}),(function(e,t){e.setTime(+e+6e4*t)}),(function(e,t){return(t-e)/6e4}),(function(e){return e.getMinutes()}))),f=g,b=(g.range,u((function(e){var t=6e4*e.getTimezoneOffset()%36e5;t<0&&(t+=36e5),e.setTime(36e5*Math.floor((+e-t)/36e5)+t)}),(function(e,t){e.setTime(+e+36e5*t)}),(function(e,t){return(t-e)/36e5}),(function(e){return e.getHours()}))),v=b,A=(b.range,u((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5}),(function(e){return e.getDate()-1}))),E=A;function T(e){return u((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5}))}A.range;var C=T(0),y=T(1),M=T(2),I=T(3),S=T(4),w=T(5),N=T(6),D=(C.range,y.range,M.range,I.range,S.range,w.range,N.range,u((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),L=D,O=(D.range,u((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));O.every=function(e){return isFinite(e=Math.floor(e))&&e>0?u((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var P=O,x=(O.range,u((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+6e4*t)}),(function(e,t){return(t-e)/6e4}),(function(e){return e.getUTCMinutes()}))),R=(x.range,u((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+36e5*t)}),(function(e,t){return(t-e)/36e5}),(function(e){return e.getUTCHours()}))),k=(R.range,u((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/864e5}),(function(e){return e.getUTCDate()-1}))),B=k;function V(e){return u((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/6048e5}))}k.range;var U=V(0),F=V(1),H=V(2),z=V(3),W=V(4),G=V(5),K=V(6),Y=(U.range,F.range,H.range,z.range,W.range,G.range,K.range,u((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),j=(Y.range,u((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()})));j.every=function(e){return isFinite(e=Math.floor(e))&&e>0?u((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var Q=j;function q(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function J(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function X(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}j.range;var Z,$,ee,te,ne,ie={"-":"",_:" ",0:"0"},oe=/^\s*\d+/,se=/^%/,ae=/[\\^$*+?|[\]().{}]/g;function re(e,t,n){var i=e<0?"-":"",o=(i?-e:e)+"",s=o.length;return i+(s<n?new Array(n-s+1).join(t)+o:o)}function le(e){return e.replace(ae,"\\$&")}function ce(e){return new RegExp("^(?:"+e.map(le).join("|")+")","i")}function de(e){for(var t={},n=-1,i=e.length;++n<i;)t[e[n].toLowerCase()]=n;return t}function ue(e,t,n){var i=oe.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function he(e,t,n){var i=oe.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function pe(e,t,n){var i=oe.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function me(e,t,n){var i=oe.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function _e(e,t,n){var i=oe.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function ge(e,t,n){var i=oe.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function fe(e,t,n){var i=oe.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function be(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function ve(e,t,n){var i=oe.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function Ae(e,t,n){var i=oe.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function Ee(e,t,n){var i=oe.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function Te(e,t,n){var i=oe.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function Ce(e,t,n){var i=oe.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function ye(e,t,n){var i=oe.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function Me(e,t,n){var i=oe.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function Ie(e,t,n){var i=oe.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Se(e,t,n){var i=se.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function we(e,t,n){var i=oe.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function Ne(e,t,n){var i=oe.exec(t.slice(n));return i?(e.Q=1e3*+i[0],n+i[0].length):-1}function De(e,t){return re(e.getDate(),t,2)}function Le(e,t){return re(e.getHours(),t,2)}function Oe(e,t){return re(e.getHours()%12||12,t,2)}function Pe(e,t){return re(1+E.count(P(e),e),t,3)}function xe(e,t){return re(e.getMilliseconds(),t,3)}function Re(e,t){return xe(e,t)+"000"}function ke(e,t){return re(e.getMonth()+1,t,2)}function Be(e,t){return re(e.getMinutes(),t,2)}function Ve(e,t){return re(e.getSeconds(),t,2)}function Ue(e){var t=e.getDay();return 0===t?7:t}function Fe(e,t){return re(C.count(P(e),e),t,2)}function He(e,t){var n=e.getDay();return e=n>=4||0===n?S(e):S.ceil(e),re(S.count(P(e),e)+(4===P(e).getDay()),t,2)}function ze(e){return e.getDay()}function We(e,t){return re(y.count(P(e),e),t,2)}function Ge(e,t){return re(e.getFullYear()%100,t,2)}function Ke(e,t){return re(e.getFullYear()%1e4,t,4)}function Ye(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+re(t/60|0,"0",2)+re(t%60,"0",2)}function je(e,t){return re(e.getUTCDate(),t,2)}function Qe(e,t){return re(e.getUTCHours(),t,2)}function qe(e,t){return re(e.getUTCHours()%12||12,t,2)}function Je(e,t){return re(1+B.count(Q(e),e),t,3)}function Xe(e,t){return re(e.getUTCMilliseconds(),t,3)}function Ze(e,t){return Xe(e,t)+"000"}function $e(e,t){return re(e.getUTCMonth()+1,t,2)}function et(e,t){return re(e.getUTCMinutes(),t,2)}function tt(e,t){return re(e.getUTCSeconds(),t,2)}function nt(e){var t=e.getUTCDay();return 0===t?7:t}function it(e,t){return re(U.count(Q(e),e),t,2)}function ot(e,t){var n=e.getUTCDay();return e=n>=4||0===n?W(e):W.ceil(e),re(W.count(Q(e),e)+(4===Q(e).getUTCDay()),t,2)}function st(e){return e.getUTCDay()}function at(e,t){return re(F.count(Q(e),e),t,2)}function rt(e,t){return re(e.getUTCFullYear()%100,t,2)}function lt(e,t){return re(e.getUTCFullYear()%1e4,t,4)}function ct(){return"+0000"}function dt(){return"%"}function ut(e){return+e}function ht(e){return Math.floor(+e/1e3)}Z=function(e){var t=e.dateTime,n=e.date,i=e.time,o=e.periods,s=e.days,a=e.shortDays,r=e.months,l=e.shortMonths,c=ce(o),d=de(o),u=ce(s),h=de(s),p=ce(a),m=de(a),_=ce(r),g=de(r),f=ce(l),b=de(l),v={a:function(e){return a[e.getDay()]},A:function(e){return s[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return r[e.getMonth()]},c:null,d:De,e:De,f:Re,H:Le,I:Oe,j:Pe,L:xe,m:ke,M:Be,p:function(e){return o[+(e.getHours()>=12)]},Q:ut,s:ht,S:Ve,u:Ue,U:Fe,V:He,w:ze,W:We,x:null,X:null,y:Ge,Y:Ke,Z:Ye,"%":dt},A={a:function(e){return a[e.getUTCDay()]},A:function(e){return s[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return r[e.getUTCMonth()]},c:null,d:je,e:je,f:Ze,H:Qe,I:qe,j:Je,L:Xe,m:$e,M:et,p:function(e){return o[+(e.getUTCHours()>=12)]},Q:ut,s:ht,S:tt,u:nt,U:it,V:ot,w:st,W:at,x:null,X:null,y:rt,Y:lt,Z:ct,"%":dt},T={a:function(e,t,n){var i=p.exec(t.slice(n));return i?(e.w=m[i[0].toLowerCase()],n+i[0].length):-1},A:function(e,t,n){var i=u.exec(t.slice(n));return i?(e.w=h[i[0].toLowerCase()],n+i[0].length):-1},b:function(e,t,n){var i=f.exec(t.slice(n));return i?(e.m=b[i[0].toLowerCase()],n+i[0].length):-1},B:function(e,t,n){var i=_.exec(t.slice(n));return i?(e.m=g[i[0].toLowerCase()],n+i[0].length):-1},c:function(e,n,i){return I(e,t,n,i)},d:Ae,e:Ae,f:Ie,H:Te,I:Te,j:Ee,L:Me,m:ve,M:Ce,p:function(e,t,n){var i=c.exec(t.slice(n));return i?(e.p=d[i[0].toLowerCase()],n+i[0].length):-1},Q:we,s:Ne,S:ye,u:he,U:pe,V:me,w:ue,W:_e,x:function(e,t,i){return I(e,n,t,i)},X:function(e,t,n){return I(e,i,t,n)},y:fe,Y:ge,Z:be,"%":Se};function C(e,t){return function(n){var i,o,s,a=[],r=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++r<c;)37===e.charCodeAt(r)&&(a.push(e.slice(l,r)),null!=(o=ie[i=e.charAt(++r)])?i=e.charAt(++r):o="e"===i?" ":"0",(s=t[i])&&(i=s(n,o)),a.push(i),l=r+1);return a.push(e.slice(l,r)),a.join("")}}function M(e,t){return function(n){var i,o,s=X(1900);if(I(s,e,n+="",0)!=n.length)return null;if("Q"in s)return new Date(s.Q);if("p"in s&&(s.H=s.H%12+12*s.p),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(o=(i=J(X(s.y))).getUTCDay(),i=o>4||0===o?F.ceil(i):F(i),i=B.offset(i,7*(s.V-1)),s.y=i.getUTCFullYear(),s.m=i.getUTCMonth(),s.d=i.getUTCDate()+(s.w+6)%7):(o=(i=t(X(s.y))).getDay(),i=o>4||0===o?y.ceil(i):y(i),i=E.offset(i,7*(s.V-1)),s.y=i.getFullYear(),s.m=i.getMonth(),s.d=i.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:"W"in s?1:0),o="Z"in s?J(X(s.y)).getUTCDay():t(X(s.y)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(o+5)%7:s.w+7*s.U-(o+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,J(s)):t(s)}}function I(e,t,n,i){for(var o,s,a=0,r=t.length,l=n.length;a<r;){if(i>=l)return-1;if(37===(o=t.charCodeAt(a++))){if(o=t.charAt(a++),!(s=T[o in ie?t.charAt(a++):o])||(i=s(e,n,i))<0)return-1}else if(o!=n.charCodeAt(i++))return-1}return i}return v.x=C(n,v),v.X=C(i,v),v.c=C(t,v),A.x=C(n,A),A.X=C(i,A),A.c=C(t,A),{format:function(e){var t=C(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=M(e+="",q);return t.toString=function(){return e},t},utcFormat:function(e){var t=C(e+="",A);return t.toString=function(){return e},t},utcParse:function(e){var t=M(e,J);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),$=Z.format,ee=Z.parse,te=Z.utcFormat,ne=Z.utcParse,Date.prototype.toISOString||te("%Y-%m-%dT%H:%M:%S.%LZ"),+new Date("2000-01-01T00:00:00.000Z")||ne("%Y-%m-%dT%H:%M:%S.%LZ");var pt="http://www.w3.org/1999/xhtml",mt={svg:"http://www.w3.org/2000/svg",xhtml:pt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},_t=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),mt.hasOwnProperty(t)?{space:mt[t],local:e}:e};function gt(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===pt&&t.documentElement.namespaceURI===pt?t.createElement(e):t.createElementNS(n,e)}}function ft(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}var bt=function(e){var t=_t(e);return(t.local?ft:gt)(t)};function vt(){}var At=function(e){return null==e?vt:function(){return this.querySelector(e)}};function Et(){return[]}var Tt=function(e){return null==e?Et:function(){return this.querySelectorAll(e)}},Ct=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var yt=document.documentElement;if(!yt.matches){var Mt=yt.webkitMatchesSelector||yt.msMatchesSelector||yt.mozMatchesSelector||yt.oMatchesSelector;Ct=function(e){return function(){return Mt.call(this,e)}}}}var It=Ct,St=function(e){return new Array(e.length)};function wt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Nt(e,t,n,i,o,s){for(var a,r=0,l=t.length,c=s.length;r<c;++r)(a=t[r])?(a.__data__=s[r],i[r]=a):n[r]=new wt(e,s[r]);for(;r<l;++r)(a=t[r])&&(o[r]=a)}function Dt(e,t,n,i,o,s,a){var r,l,c,d={},u=t.length,h=s.length,p=new Array(u);for(r=0;r<u;++r)(l=t[r])&&(p[r]=c="$"+a.call(l,l.__data__,r,t),c in d?o[r]=l:d[c]=l);for(r=0;r<h;++r)(l=d[c="$"+a.call(e,s[r],r,s)])?(i[r]=l,l.__data__=s[r],d[c]=null):n[r]=new wt(e,s[r]);for(r=0;r<u;++r)(l=t[r])&&d[p[r]]===l&&(o[r]=l)}function Lt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ot(e){return function(){this.removeAttribute(e)}}function Pt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function xt(e,t){return function(){this.setAttribute(e,t)}}function Rt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function kt(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Bt(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}wt.prototype={constructor:wt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var Vt=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function Ut(e){return function(){this.style.removeProperty(e)}}function Ft(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ht(e,t,n){return function(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function zt(e,t){return e.style.getPropertyValue(t)||Vt(e).getComputedStyle(e,null).getPropertyValue(t)}function Wt(e){return function(){delete this[e]}}function Gt(e,t){return function(){this[e]=t}}function Kt(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Yt(e){return e.trim().split(/^|\s+/)}function jt(e){return e.classList||new Qt(e)}function Qt(e){this._node=e,this._names=Yt(e.getAttribute("class")||"")}function qt(e,t){for(var n=jt(e),i=-1,o=t.length;++i<o;)n.add(t[i])}function Jt(e,t){for(var n=jt(e),i=-1,o=t.length;++i<o;)n.remove(t[i])}function Xt(e){return function(){qt(this,e)}}function Zt(e){return function(){Jt(this,e)}}function $t(e,t){return function(){(t.apply(this,arguments)?qt:Jt)(this,e)}}function en(){this.textContent=""}function tn(e){return function(){this.textContent=e}}function nn(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function on(){this.innerHTML=""}function sn(e){return function(){this.innerHTML=e}}function an(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function rn(){this.nextSibling&&this.parentNode.appendChild(this)}function ln(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function cn(){return null}function dn(){var e=this.parentNode;e&&e.removeChild(this)}function un(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function hn(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}Qt.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var pn={},mn=null;function _n(e,t,n){return e=gn(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function gn(e,t,n){return function(i){var o=mn;mn=i;try{e.call(this,this.__data__,t,n)}finally{mn=o}}}function fn(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function bn(e){return function(){var t=this.__on;if(t){for(var n,i=0,o=-1,s=t.length;i<s;++i)n=t[i],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.capture);++o?t.length=o:delete this.__on}}}function vn(e,t,n){var i=pn.hasOwnProperty(e.type)?_n:gn;return function(o,s,a){var r,l=this.__on,c=i(t,s,a);if(l)for(var d=0,u=l.length;d<u;++d)if((r=l[d]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.capture),this.addEventListener(r.type,r.listener=c,r.capture=n),void(r.value=t);this.addEventListener(e.type,c,n),r={type:e.type,name:e.name,value:t,listener:c,capture:n},l?l.push(r):this.__on=[r]}}function An(e,t,n,i){var o=mn;e.sourceEvent=mn,mn=e;try{return t.apply(n,i)}finally{mn=o}}function En(e,t,n){var i=Vt(e),o=i.CustomEvent;"function"==typeof o?o=new o(t,n):(o=i.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Tn(e,t){return function(){return En(this,e,t)}}function Cn(e,t){return function(){return En(this,e,t.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(pn={mouseenter:"mouseover",mouseleave:"mouseout"}));var yn=[null];function Mn(e,t){this._groups=e,this._parents=t}function In(){return new Mn([[document.documentElement]],yn)}Mn.prototype=In.prototype={constructor:Mn,select:function(e){"function"!=typeof e&&(e=At(e));for(var t=this._groups,n=t.length,i=new Array(n),o=0;o<n;++o)for(var s,a,r=t[o],l=r.length,c=i[o]=new Array(l),d=0;d<l;++d)(s=r[d])&&(a=e.call(s,s.__data__,d,r))&&("__data__"in s&&(a.__data__=s.__data__),c[d]=a);return new Mn(i,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=Tt(e));for(var t=this._groups,n=t.length,i=[],o=[],s=0;s<n;++s)for(var a,r=t[s],l=r.length,c=0;c<l;++c)(a=r[c])&&(i.push(e.call(a,a.__data__,c,r)),o.push(a));return new Mn(i,o)},filter:function(e){"function"!=typeof e&&(e=It(e));for(var t=this._groups,n=t.length,i=new Array(n),o=0;o<n;++o)for(var s,a=t[o],r=a.length,l=i[o]=[],c=0;c<r;++c)(s=a[c])&&e.call(s,s.__data__,c,a)&&l.push(s);return new Mn(i,this._parents)},data:function(e,t){if(!e)return m=new Array(this.size()),d=-1,this.each((function(e){m[++d]=e})),m;var n,i=t?Dt:Nt,o=this._parents,s=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var a=s.length,r=new Array(a),l=new Array(a),c=new Array(a),d=0;d<a;++d){var u=o[d],h=s[d],p=h.length,m=e.call(u,u&&u.__data__,d,o),_=m.length,g=l[d]=new Array(_),f=r[d]=new Array(_);i(u,h,g,f,c[d]=new Array(p),m,t);for(var b,v,A=0,E=0;A<_;++A)if(b=g[A]){for(A>=E&&(E=A+1);!(v=f[E])&&++E<_;);b._next=v||null}}return(r=new Mn(r,o))._enter=l,r._exit=c,r},enter:function(){return new Mn(this._enter||this._groups.map(St),this._parents)},exit:function(){return new Mn(this._exit||this._groups.map(St),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,i=t.length,o=n.length,s=Math.min(i,o),a=new Array(i),r=0;r<s;++r)for(var l,c=t[r],d=n[r],u=c.length,h=a[r]=new Array(u),p=0;p<u;++p)(l=c[p]||d[p])&&(h[p]=l);for(;r<i;++r)a[r]=t[r];return new Mn(a,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i,o=e[t],s=o.length-1,a=o[s];--s>=0;)(i=o[s])&&(a&&a!==i.nextSibling&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Lt);for(var n=this._groups,i=n.length,o=new Array(i),s=0;s<i;++s){for(var a,r=n[s],l=r.length,c=o[s]=new Array(l),d=0;d<l;++d)(a=r[d])&&(c[d]=a);c.sort(t)}return new Mn(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],o=0,s=i.length;o<s;++o){var a=i[o];if(a)return a}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var o,s=t[n],a=0,r=s.length;a<r;++a)(o=s[a])&&e.call(o,o.__data__,a,s);return this},attr:function(e,t){var n=_t(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==t?n.local?Pt:Ot:"function"==typeof t?n.local?Bt:kt:n.local?Rt:xt)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?Ut:"function"==typeof t?Ht:Ft)(e,t,null==n?"":n)):zt(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Wt:"function"==typeof t?Kt:Gt)(e,t)):this.node()[e]},classed:function(e,t){var n=Yt(e+"");if(arguments.length<2){for(var i=jt(this.node()),o=-1,s=n.length;++o<s;)if(!i.contains(n[o]))return!1;return!0}return this.each(("function"==typeof t?$t:t?Xt:Zt)(n,t))},text:function(e){return arguments.length?this.each(null==e?en:("function"==typeof e?nn:tn)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?on:("function"==typeof e?an:sn)(e)):this.node().innerHTML},raise:function(){return this.each(rn)},lower:function(){return this.each(ln)},append:function(e){var t="function"==typeof e?e:bt(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:bt(e),i=null==t?cn:"function"==typeof t?t:At(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(dn)},clone:function(e){return this.select(e?hn:un)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var i,o,s=fn(e+""),a=s.length;if(!(arguments.length<2)){for(r=t?vn:bn,null==n&&(n=!1),i=0;i<a;++i)this.each(r(s[i],t,n));return this}var r=this.node().__on;if(r)for(var l,c=0,d=r.length;c<d;++c)for(i=0,l=r[c];i<a;++i)if((o=s[i]).type===l.type&&o.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?Cn:Tn)(e,t))}};var Sn=In,wn=function(e){return"string"==typeof e?new Mn([[document.querySelector(e)]],[document.documentElement]):new Mn([[e]],yn)},Nn=0;function Dn(){this._="@"+(++Nn).toString(36)}Dn.prototype=function(){return new Dn}.prototype={constructor:Dn,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var Ln=function(){for(var e,t=mn;e=t.sourceEvent;)t=e;return t},On=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]},Pn=function(e){var t=Ln();return t.changedTouches&&(t=t.changedTouches[0]),On(e,t)},xn=function(e){return"string"==typeof e?new Mn([document.querySelectorAll(e)],[document.documentElement]):new Mn([null==e?[]:e],yn)},Rn=function(e,t,n){arguments.length<3&&(n=t,t=Ln().changedTouches);for(var i,o=0,s=t?t.length:0;o<s;++o)if((i=t[o]).identifier===n)return On(e,i);return null},kn=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Bn=function(e){var t;return 1===e.length&&(t=e,e=function(e,n){return kn(t(e),n)}),{left:function(t,n,i,o){for(null==i&&(i=0),null==o&&(o=t.length);i<o;){var s=i+o>>>1;e(t[s],n)<0?i=s+1:o=s}return i},right:function(t,n,i,o){for(null==i&&(i=0),null==o&&(o=t.length);i<o;){var s=i+o>>>1;e(t[s],n)>0?o=s:i=s+1}return i}}},Vn=Bn(kn),Un=Vn.right,Fn=(Vn.left,Un),Hn=function(e,t){var n,i,o,s=e.length,a=-1;if(null==t){for(;++a<s;)if(null!=(n=e[a])&&n>=n)for(i=o=n;++a<s;)null!=(n=e[a])&&(i>n&&(i=n),o<n&&(o=n))}else for(;++a<s;)if(null!=(n=t(e[a],a,e))&&n>=n)for(i=o=n;++a<s;)null!=(n=t(e[a],a,e))&&(i>n&&(i=n),o<n&&(o=n));return[i,o]},zn=Array.prototype,Wn=(zn.slice,zn.map,function(e,t,n){e=+e,t=+t,n=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+n;for(var i=-1,o=0|Math.max(0,Math.ceil((t-e)/n)),s=new Array(o);++i<o;)s[i]=e+i*n;return s}),Gn=Math.sqrt(50),Kn=Math.sqrt(10),Yn=Math.sqrt(2),jn=function(e,t,n){var i,o,s,a,r=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((i=t<e)&&(o=e,e=t,t=o),0===(a=Qn(e,t,n))||!isFinite(a))return[];if(a>0)for(e=Math.ceil(e/a),t=Math.floor(t/a),s=new Array(o=Math.ceil(t-e+1));++r<o;)s[r]=(e+r)*a;else for(e=Math.floor(e*a),t=Math.ceil(t*a),s=new Array(o=Math.ceil(e-t+1));++r<o;)s[r]=(e-r)/a;return i&&s.reverse(),s};function Qn(e,t,n){var i=(t-e)/Math.max(0,n),o=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,o);return o>=0?(s>=Gn?10:s>=Kn?5:s>=Yn?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(s>=Gn?10:s>=Kn?5:s>=Yn?2:1)}function qn(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/o;return s>=Gn?o*=10:s>=Kn?o*=5:s>=Yn&&(o*=2),t<e?-o:o}var Jn=function(e,t){var n,i,o=e.length,s=-1;if(null==t){for(;++s<o;)if(null!=(n=e[s])&&n>=n)for(i=n;++s<o;)null!=(n=e[s])&&n>i&&(i=n)}else for(;++s<o;)if(null!=(n=t(e[s],s,e))&&n>=n)for(i=n;++s<o;)null!=(n=t(e[s],s,e))&&n>i&&(i=n);return i},Xn=function(e){for(var t,n,i,o=e.length,s=-1,a=0;++s<o;)a+=e[s].length;for(n=new Array(a);--o>=0;)for(t=(i=e[o]).length;--t>=0;)n[--a]=i[t];return n},Zn=function(e,t){var n,i,o=e.length,s=-1;if(null==t){for(;++s<o;)if(null!=(n=e[s])&&n>=n)for(i=n;++s<o;)null!=(n=e[s])&&i>n&&(i=n)}else for(;++s<o;)if(null!=(n=t(e[s],s,e))&&n>=n)for(i=n;++s<o;)null!=(n=t(e[s],s,e))&&i>n&&(i=n);return i},$n=function(e,t){var n,i=e.length,o=-1,s=0;if(null==t)for(;++o<i;)(n=+e[o])&&(s+=n);else for(;++o<i;)(n=+t(e[o],o,e))&&(s+=n);return s},ei={value:function(){}};function ti(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+"")||e in i)throw new Error("illegal type: "+e);i[e]=[]}return new ni(i)}function ni(e){this._=e}function ii(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",i=e.indexOf(".");if(i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function oi(e,t){for(var n,i=0,o=e.length;i<o;++i)if((n=e[i]).name===t)return n.value}function si(e,t,n){for(var i=0,o=e.length;i<o;++i)if(e[i].name===t){e[i]=ei,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}ni.prototype=ti.prototype={constructor:ni,on:function(e,t){var n,i=this._,o=ii(e+"",i),s=-1,a=o.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++s<a;)if(n=(e=o[s]).type)i[n]=si(i[n],e.name,t);else if(null==t)for(n in i)i[n]=si(i[n],e.name,null);return this}for(;++s<a;)if((n=(e=o[s]).type)&&(n=oi(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ni(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,i,o=new Array(n),s=0;s<n;++s)o[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=0,n=(i=this._[e]).length;s<n;++s)i[s].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],o=0,s=i.length;o<s;++o)i[o].value.apply(t,n)}};var ai,ri,li=ti,ci=0,di=0,ui=0,hi=0,pi=0,mi=0,_i="object"==typeof performance&&performance.now?performance:Date,gi="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function fi(){return pi||(gi(bi),pi=_i.now()+mi)}function bi(){pi=0}function vi(){this._call=this._time=this._next=null}function Ai(e,t,n){var i=new vi;return i.restart(e,t,n),i}function Ei(){pi=(hi=_i.now())+mi,ci=di=0;try{!function(){fi(),++ci;for(var e,t=ai;t;)(e=pi-t._time)>=0&&t._call.call(null,e),t=t._next;--ci}()}finally{ci=0,function(){for(var e,t,n=ai,i=1/0;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:ai=t);ri=e,Ci(i)}(),pi=0}}function Ti(){var e=_i.now(),t=e-hi;t>1e3&&(mi-=t,hi=e)}function Ci(e){ci||(di&&(di=clearTimeout(di)),e-pi>24?(e<1/0&&(di=setTimeout(Ei,e-_i.now()-mi)),ui&&(ui=clearInterval(ui))):(ui||(hi=_i.now(),ui=setInterval(Ti,1e3)),ci=1,gi(Ei)))}vi.prototype=Ai.prototype={constructor:vi,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?fi():+n)+(null==t?0:+t),this._next||ri===this||(ri?ri._next=this:ai=this,ri=this),this._call=e,this._time=n,Ci()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ci())}};var yi=function(e,t,n){var i=new vi;return t=null==t?0:+t,i.restart((function(n){i.stop(),e(n+t)}),t,n),i},Mi=li("start","end","interrupt"),Ii=[],Si=function(e,t,n,i,o,s){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var i,o=e.__transition;function s(l){var c,d,u,h;if(1!==n.state)return r();for(c in o)if((h=o[c]).name===n.name){if(3===h.state)return yi(s);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[c]):+c<t&&(h.state=6,h.timer.stop(),delete o[c])}if(yi((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(u=n.tween.length),c=0,d=-1;c<u;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function a(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(r),n.state=5,1),s=-1,a=i.length;++s<a;)i[s].call(null,o);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),r())}function r(){for(var i in n.state=6,n.timer.stop(),delete o[t],o)return;delete e.__transition}o[t]=n,n.timer=Ai((function(e){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=e&&s(e-n.delay)}),0,n.time)}(e,n,{name:t,index:i,group:o,on:Mi,tween:Ii,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})};function wi(e,t){var n=Di(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ni(e,t){var n=Di(e,t);if(n.state>2)throw new Error("too late; already started");return n}function Di(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}var Li=function(e,t){var n,i,o,s=e.__transition,a=!0;if(s){for(o in t=null==t?null:t+"",s)(n=s[o]).name===t?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),i&&n.on.call("interrupt",e,e.__data__,n.index,n.group),delete s[o]):a=!1;a&&delete e.__transition}},Oi=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function Pi(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function xi(){}var Ri="\\s*([+-]?\\d+)\\s*",ki="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Vi=/^#([0-9a-f]{3})$/,Ui=/^#([0-9a-f]{6})$/,Fi=new RegExp("^rgb\\("+[Ri,Ri,Ri]+"\\)$"),Hi=new RegExp("^rgb\\("+[Bi,Bi,Bi]+"\\)$"),zi=new RegExp("^rgba\\("+[Ri,Ri,Ri,ki]+"\\)$"),Wi=new RegExp("^rgba\\("+[Bi,Bi,Bi,ki]+"\\)$"),Gi=new RegExp("^hsl\\("+[ki,Bi,Bi]+"\\)$"),Ki=new RegExp("^hsla\\("+[ki,Bi,Bi,ki]+"\\)$"),Yi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ji(e){var t;return e=(e+"").trim().toLowerCase(),(t=Vi.exec(e))?new Zi((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=Ui.exec(e))?Qi(parseInt(t[1],16)):(t=Fi.exec(e))?new Zi(t[1],t[2],t[3],1):(t=Hi.exec(e))?new Zi(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=zi.exec(e))?qi(t[1],t[2],t[3],t[4]):(t=Wi.exec(e))?qi(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Gi.exec(e))?eo(t[1],t[2]/100,t[3]/100,1):(t=Ki.exec(e))?eo(t[1],t[2]/100,t[3]/100,t[4]):Yi.hasOwnProperty(e)?Qi(Yi[e]):"transparent"===e?new Zi(NaN,NaN,NaN,0):null}function Qi(e){return new Zi(e>>16&255,e>>8&255,255&e,1)}function qi(e,t,n,i){return i<=0&&(e=t=n=NaN),new Zi(e,t,n,i)}function Ji(e){return e instanceof xi||(e=ji(e)),e?new Zi((e=e.rgb()).r,e.g,e.b,e.opacity):new Zi}function Xi(e,t,n,i){return 1===arguments.length?Ji(e):new Zi(e,t,n,null==i?1:i)}function Zi(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function $i(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function eo(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new io(e,t,n,i)}function to(e){if(e instanceof io)return new io(e.h,e.s,e.l,e.opacity);if(e instanceof xi||(e=ji(e)),!e)return new io;if(e instanceof io)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,o=Math.min(t,n,i),s=Math.max(t,n,i),a=NaN,r=s-o,l=(s+o)/2;return r?(a=t===s?(n-i)/r+6*(n<i):n===s?(i-t)/r+2:(t-n)/r+4,r/=l<.5?s+o:2-s-o,a*=60):r=l>0&&l<1?0:a,new io(a,r,l,e.opacity)}function no(e,t,n,i){return 1===arguments.length?to(e):new io(e,t,n,null==i?1:i)}function io(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function oo(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Oi(xi,ji,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),Oi(Zi,Xi,Pi(xi,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Zi(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Zi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+$i(this.r)+$i(this.g)+$i(this.b)},toString:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),Oi(io,no,Pi(xi,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new io(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new io(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,o=2*n-i;return new Zi(oo(e>=240?e-240:e+120,o,i),oo(e,o,i),oo(e<120?e+240:e-120,o,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var so=Math.PI/180,ao=180/Math.PI,ro=6/29*3*(6/29);function lo(e){if(e instanceof uo)return new uo(e.l,e.a,e.b,e.opacity);if(e instanceof bo){if(isNaN(e.h))return new uo(e.l,0,0,e.opacity);var t=e.h*so;return new uo(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof Zi||(e=Ji(e));var n,i,o=_o(e.r),s=_o(e.g),a=_o(e.b),r=ho((.2225045*o+.7168786*s+.0606169*a)/1);return o===s&&s===a?n=i=r:(n=ho((.4360747*o+.3850649*s+.1430804*a)/.96422),i=ho((.0139322*o+.0971045*s+.7141733*a)/.82521)),new uo(116*r-16,500*(n-r),200*(r-i),e.opacity)}function co(e,t,n,i){return 1===arguments.length?lo(e):new uo(e,t,n,null==i?1:i)}function uo(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function ho(e){return e>6/29*(6/29)*(6/29)?Math.pow(e,1/3):e/ro+4/29}function po(e){return e>6/29?e*e*e:ro*(e-4/29)}function mo(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function _o(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function go(e){if(e instanceof bo)return new bo(e.h,e.c,e.l,e.opacity);if(e instanceof uo||(e=lo(e)),0===e.a&&0===e.b)return new bo(NaN,0,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*ao;return new bo(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function fo(e,t,n,i){return 1===arguments.length?go(e):new bo(e,t,n,null==i?1:i)}function bo(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}Oi(uo,co,Pi(xi,{brighter:function(e){return new uo(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new uo(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Zi(mo(3.1338561*(t=.96422*po(t))-1.6168667*(e=1*po(e))-.4906146*(n=.82521*po(n))),mo(-.9787684*t+1.9161415*e+.033454*n),mo(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Oi(bo,fo,Pi(xi,{brighter:function(e){return new bo(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new bo(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return lo(this).rgb()}}));var vo=-.14861,Ao=1.78277,Eo=-.29227,To=-1.7884503806,Co=1.97294*Ao,yo=Ao*Eo- -.90649*vo;function Mo(e){if(e instanceof So)return new So(e.h,e.s,e.l,e.opacity);e instanceof Zi||(e=Ji(e));var t=e.r/255,n=e.g/255,i=e.b/255,o=(yo*i+To*t-Co*n)/(yo+To-Co),s=i-o,a=(1.97294*(n-o)-Eo*s)/-.90649,r=Math.sqrt(a*a+s*s)/(1.97294*o*(1-o)),l=r?Math.atan2(a,s)*ao-120:NaN;return new So(l<0?l+360:l,r,o,e.opacity)}function Io(e,t,n,i){return 1===arguments.length?Mo(e):new So(e,t,n,null==i?1:i)}function So(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function wo(e,t,n,i,o){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*i+a*o)/6}Oi(So,Io,Pi(xi,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new So(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new So(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*so,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),o=Math.sin(e);return new Zi(255*(t+n*(vo*i+Ao*o)),255*(t+n*(Eo*i+-.90649*o)),255*(t+n*(1.97294*i)),this.opacity)}}));var No=function(e){return function(){return e}};function Do(e,t){return function(n){return e+n*t}}function Lo(e,t){var n=t-e;return n?Do(e,n>180||n<-180?n-360*Math.round(n/360):n):No(isNaN(e)?t:e)}function Oo(e){return 1==(e=+e)?Po:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):No(isNaN(t)?n:t)}}function Po(e,t){var n=t-e;return n?Do(e,n):No(isNaN(e)?t:e)}var xo=function e(t){var n=Oo(t);function i(e,t){var i=n((e=Xi(e)).r,(t=Xi(t)).r),o=n(e.g,t.g),s=n(e.b,t.b),a=Po(e.opacity,t.opacity);return function(t){return e.r=i(t),e.g=o(t),e.b=s(t),e.opacity=a(t),e+""}}return i.gamma=e,i}(1);function Ro(e){return function(t){var n,i,o=t.length,s=new Array(o),a=new Array(o),r=new Array(o);for(n=0;n<o;++n)i=Xi(t[n]),s[n]=i.r||0,a[n]=i.g||0,r[n]=i.b||0;return s=e(s),a=e(a),r=e(r),i.opacity=1,function(e){return i.r=s(e),i.g=a(e),i.b=r(e),i+""}}}Ro((function(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[i],s=e[i+1],a=i>0?e[i-1]:2*o-s,r=i<t-1?e[i+2]:2*s-o;return wo((n-i/t)*t,a,o,s,r)}})),Ro((function(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),o=e[(i+t-1)%t],s=e[i%t],a=e[(i+1)%t],r=e[(i+2)%t];return wo((n-i/t)*t,o,s,a,r)}}));var ko,Bo,Vo,Uo,Fo=function(e,t){var n,i=t?t.length:0,o=e?Math.min(i,e.length):0,s=new Array(o),a=new Array(i);for(n=0;n<o;++n)s[n]=jo(e[n],t[n]);for(;n<i;++n)a[n]=t[n];return function(e){for(n=0;n<o;++n)a[n]=s[n](e);return a}},Ho=function(e,t){var n=new Date;return t-=e=+e,function(i){return n.setTime(e+t*i),n}},zo=function(e,t){return t-=e=+e,function(n){return e+t*n}},Wo=function(e,t){var n,i={},o={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?i[n]=jo(e[n],t[n]):o[n]=t[n];return function(e){for(n in i)o[n]=i[n](e);return o}},Go=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ko=new RegExp(Go.source,"g"),Yo=function(e,t){var n,i,o,s=Go.lastIndex=Ko.lastIndex=0,a=-1,r=[],l=[];for(e+="",t+="";(n=Go.exec(e))&&(i=Ko.exec(t));)(o=i.index)>s&&(o=t.slice(s,o),r[a]?r[a]+=o:r[++a]=o),(n=n[0])===(i=i[0])?r[a]?r[a]+=i:r[++a]=i:(r[++a]=null,l.push({i:a,x:zo(n,i)})),s=Ko.lastIndex;return s<t.length&&(o=t.slice(s),r[a]?r[a]+=o:r[++a]=o),r.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,i=0;i<t;++i)r[(n=l[i]).i]=n.x(e);return r.join("")})},jo=function(e,t){var n,i=typeof t;return null==t||"boolean"===i?No(t):("number"===i?zo:"string"===i?(n=ji(t))?(t=n,xo):Yo:t instanceof ji?xo:t instanceof Date?Ho:Array.isArray(t)?Fo:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Wo:zo)(e,t)},Qo=function(e,t){return t-=e=+e,function(n){return Math.round(e+t*n)}},qo=180/Math.PI,Jo={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Xo=function(e,t,n,i,o,s){var a,r,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(r=Math.sqrt(n*n+i*i))&&(n/=r,i/=r,l/=r),e*i<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:o,translateY:s,rotate:Math.atan2(t,e)*qo,skewX:Math.atan(l)*qo,scaleX:a,scaleY:r}};function Zo(e,t,n,i){function o(e){return e.length?e.pop()+" ":""}return function(s,a){var r=[],l=[];return s=e(s),a=e(a),function(e,i,o,s,a,r){if(e!==o||i!==s){var l=a.push("translate(",null,t,null,n);r.push({i:l-4,x:zo(e,o)},{i:l-2,x:zo(i,s)})}else(o||s)&&a.push("translate("+o+t+s+n)}(s.translateX,s.translateY,a.translateX,a.translateY,r,l),function(e,t,n,s){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),s.push({i:n.push(o(n)+"rotate(",null,i)-2,x:zo(e,t)})):t&&n.push(o(n)+"rotate("+t+i)}(s.rotate,a.rotate,r,l),function(e,t,n,s){e!==t?s.push({i:n.push(o(n)+"skewX(",null,i)-2,x:zo(e,t)}):t&&n.push(o(n)+"skewX("+t+i)}(s.skewX,a.skewX,r,l),function(e,t,n,i,s,a){if(e!==n||t!==i){var r=s.push(o(s)+"scale(",null,",",null,")");a.push({i:r-4,x:zo(e,n)},{i:r-2,x:zo(t,i)})}else 1===n&&1===i||s.push(o(s)+"scale("+n+","+i+")")}(s.scaleX,s.scaleY,a.scaleX,a.scaleY,r,l),s=a=null,function(e){for(var t,n=-1,i=l.length;++n<i;)r[(t=l[n]).i]=t.x(e);return r.join("")}}}var $o=Zo((function(e){return"none"===e?Jo:(ko||(ko=document.createElement("DIV"),Bo=document.documentElement,Vo=document.defaultView),ko.style.transform=e,e=Vo.getComputedStyle(Bo.appendChild(ko),null).getPropertyValue("transform"),Bo.removeChild(ko),e=e.slice(7,-1).split(","),Xo(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}),"px, ","px)","deg)"),es=Zo((function(e){return null==e?Jo:(Uo||(Uo=document.createElementNS("http://www.w3.org/2000/svg","g")),Uo.setAttribute("transform",e),(e=Uo.transform.baseVal.consolidate())?(e=e.matrix,Xo(e.a,e.b,e.c,e.d,e.e,e.f)):Jo)}),", ",")",")"),ts=Math.SQRT2;function ns(e){return((e=Math.exp(e))+1/e)/2}var is=function(e,t){var n,i,o=e[0],s=e[1],a=e[2],r=t[0],l=t[1],c=t[2],d=r-o,u=l-s,h=d*d+u*u;if(h<1e-12)i=Math.log(c/a)/ts,n=function(e){return[o+e*d,s+e*u,a*Math.exp(ts*e*i)]};else{var p=Math.sqrt(h),m=(c*c-a*a+4*h)/(2*a*2*p),_=(c*c-a*a-4*h)/(2*c*2*p),g=Math.log(Math.sqrt(m*m+1)-m),f=Math.log(Math.sqrt(_*_+1)-_);i=(f-g)/ts,n=function(e){var t,n=e*i,r=ns(g),l=a/(2*p)*(r*(t=ts*n+g,((t=Math.exp(2*t))-1)/(t+1))-function(e){return((e=Math.exp(e))-1/e)/2}(g));return[o+l*d,s+l*u,a*r/ns(ts*n+g)]}}return n.duration=1e3*i,n};function os(e){return function(t,n){var i=e((t=no(t)).h,(n=no(n)).h),o=Po(t.s,n.s),s=Po(t.l,n.l),a=Po(t.opacity,n.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=s(e),t.opacity=a(e),t+""}}}function ss(e){return function(t,n){var i=e((t=fo(t)).h,(n=fo(n)).h),o=Po(t.c,n.c),s=Po(t.l,n.l),a=Po(t.opacity,n.opacity);return function(e){return t.h=i(e),t.c=o(e),t.l=s(e),t.opacity=a(e),t+""}}}function as(e){return function t(n){function i(t,i){var o=e((t=Io(t)).h,(i=Io(i)).h),s=Po(t.s,i.s),a=Po(t.l,i.l),r=Po(t.opacity,i.opacity);return function(e){return t.h=o(e),t.s=s(e),t.l=a(Math.pow(e,n)),t.opacity=r(e),t+""}}return n=+n,i.gamma=t,i}(1)}function rs(e,t){var n,i;return function(){var o=Ni(this,e),s=o.tween;if(s!==n)for(var a=0,r=(i=n=s).length;a<r;++a)if(i[a].name===t){(i=i.slice()).splice(a,1);break}o.tween=i}}function ls(e,t,n){var i,o;if("function"!=typeof n)throw new Error;return function(){var s=Ni(this,e),a=s.tween;if(a!==i){o=(i=a).slice();for(var r={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=r;break}l===c&&o.push(r)}s.tween=o}}function cs(e,t,n){var i=e._id;return e.each((function(){var e=Ni(this,i);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return Di(e,i).value[t]}}os(Lo),os(Po),ss(Lo),ss(Po),as(Lo),as(Po);var ds=function(e,t){var n;return("number"==typeof t?zo:t instanceof ji?xo:(n=ji(t))?(t=n,xo):Yo)(e,t)};function us(e){return function(){this.removeAttribute(e)}}function hs(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ps(e,t,n){var i,o;return function(){var s=this.getAttribute(e);return s===n?null:s===i?o:o=t(i=s,n)}}function ms(e,t,n){var i,o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===n?null:s===i?o:o=t(i=s,n)}}function _s(e,t,n){var i,o,s;return function(){var a,r=n(this);if(null!=r)return(a=this.getAttribute(e))===r?null:a===i&&r===o?s:s=t(i=a,o=r);this.removeAttribute(e)}}function gs(e,t,n){var i,o,s;return function(){var a,r=n(this);if(null!=r)return(a=this.getAttributeNS(e.space,e.local))===r?null:a===i&&r===o?s:s=t(i=a,o=r);this.removeAttributeNS(e.space,e.local)}}function fs(e,t){function n(){var n=this,i=t.apply(n,arguments);return i&&function(t){n.setAttributeNS(e.space,e.local,i(t))}}return n._value=t,n}function bs(e,t){function n(){var n=this,i=t.apply(n,arguments);return i&&function(t){n.setAttribute(e,i(t))}}return n._value=t,n}function vs(e,t){return function(){wi(this,e).delay=+t.apply(this,arguments)}}function As(e,t){return t=+t,function(){wi(this,e).delay=t}}function Es(e,t){return function(){Ni(this,e).duration=+t.apply(this,arguments)}}function Ts(e,t){return t=+t,function(){Ni(this,e).duration=t}}function Cs(e,t){if("function"!=typeof t)throw new Error;return function(){Ni(this,e).ease=t}}function ys(e,t,n){var i,o,s=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?wi:Ni;return function(){var a=s(this,e),r=a.on;r!==i&&(o=(i=r).copy()).on(t,n),a.on=o}}var Ms=Sn.prototype.constructor;function Is(e,t,n){function i(){var i=this,o=t.apply(i,arguments);return o&&function(t){i.style.setProperty(e,o(t),n)}}return i._value=t,i}var Ss=0;function ws(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function Ns(e){return Sn().transition(e)}function Ds(){return++Ss}var Ls=Sn.prototype;function Os(e){return+e}ws.prototype=Ns.prototype={constructor:ws,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=At(e));for(var i=this._groups,o=i.length,s=new Array(o),a=0;a<o;++a)for(var r,l,c=i[a],d=c.length,u=s[a]=new Array(d),h=0;h<d;++h)(r=c[h])&&(l=e.call(r,r.__data__,h,c))&&("__data__"in r&&(l.__data__=r.__data__),u[h]=l,Si(u[h],t,n,h,u,Di(r,n)));return new ws(s,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Tt(e));for(var i=this._groups,o=i.length,s=[],a=[],r=0;r<o;++r)for(var l,c=i[r],d=c.length,u=0;u<d;++u)if(l=c[u]){for(var h,p=e.call(l,l.__data__,u,c),m=Di(l,n),_=0,g=p.length;_<g;++_)(h=p[_])&&Si(h,t,n,_,p,m);s.push(p),a.push(l)}return new ws(s,a,t,n)},filter:function(e){"function"!=typeof e&&(e=It(e));for(var t=this._groups,n=t.length,i=new Array(n),o=0;o<n;++o)for(var s,a=t[o],r=a.length,l=i[o]=[],c=0;c<r;++c)(s=a[c])&&e.call(s,s.__data__,c,a)&&l.push(s);return new ws(i,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,i=t.length,o=n.length,s=Math.min(i,o),a=new Array(i),r=0;r<s;++r)for(var l,c=t[r],d=n[r],u=c.length,h=a[r]=new Array(u),p=0;p<u;++p)(l=c[p]||d[p])&&(h[p]=l);for(;r<i;++r)a[r]=t[r];return new ws(a,this._parents,this._name,this._id)},selection:function(){return new Ms(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Ds(),i=this._groups,o=i.length,s=0;s<o;++s)for(var a,r=i[s],l=r.length,c=0;c<l;++c)if(a=r[c]){var d=Di(a,t);Si(a,e,n,c,r,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new ws(i,this._parents,e,n)},call:Ls.call,nodes:Ls.nodes,node:Ls.node,size:Ls.size,empty:Ls.empty,each:Ls.each,on:function(e,t){var n=this._id;return arguments.length<2?Di(this.node(),n).on.on(e):this.each(ys(n,e,t))},attr:function(e,t){var n=_t(e),i="transform"===n?es:ds;return this.attrTween(e,"function"==typeof t?(n.local?gs:_s)(n,i,cs(this,"attr."+e,t)):null==t?(n.local?hs:us)(n):(n.local?ms:ps)(n,i,t+""))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var i=_t(e);return this.tween(n,(i.local?fs:bs)(i,t))},style:function(e,t,n){var i="transform"==(e+="")?$o:ds;return null==t?this.styleTween(e,function(e,t){var n,i,o;return function(){var s=zt(this,e),a=(this.style.removeProperty(e),zt(this,e));return s===a?null:s===n&&a===i?o:o=t(n=s,i=a)}}(e,i)).on("end.style."+e,function(e){return function(){this.style.removeProperty(e)}}(e)):this.styleTween(e,"function"==typeof t?function(e,t,n){var i,o,s;return function(){var a=zt(this,e),r=n(this);return null==r&&(this.style.removeProperty(e),r=zt(this,e)),a===r?null:a===i&&r===o?s:s=t(i=a,o=r)}}(e,i,cs(this,"style."+e,t)):function(e,t,n){var i,o;return function(){var s=zt(this,e);return s===n?null:s===i?o:o=t(i=s,n)}}(e,i,t+""),n)},styleTween:function(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==t)return this.tween(i,null);if("function"!=typeof t)throw new Error;return this.tween(i,Is(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(cs(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}));var e},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i,o=Di(this.node(),n).tween,s=0,a=o.length;s<a;++s)if((i=o[s]).name===e)return i.value;return null}return this.each((null==t?rs:ls)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?vs:As)(t,e)):Di(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Es:Ts)(t,e)):Di(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(Cs(t,e)):Di(this.node(),t).ease}},function e(t){function n(e){return Math.pow(e,t)}return t=+t,n.exponent=e,n}(3),function e(t){function n(e){return 1-Math.pow(1-e,t)}return t=+t,n.exponent=e,n}(3),function e(t){function n(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}return t=+t,n.exponent=e,n}(3),Math.PI,function e(t){function n(e){return e*e*((t+1)*e-t)}return t=+t,n.overshoot=e,n}(1.70158),function e(t){function n(e){return--e*e*((t+1)*e+t)+1}return t=+t,n.overshoot=e,n}(1.70158),function e(t){function n(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}return t=+t,n.overshoot=e,n}(1.70158);var Ps=2*Math.PI,xs=(function e(t,n){var i=Math.asin(1/(t=Math.max(1,t)))*(n/=Ps);function o(e){return t*Math.pow(2,10*--e)*Math.sin((i-e)/n)}return o.amplitude=function(t){return e(t,n*Ps)},o.period=function(n){return e(t,n)},o}(1,.3),function e(t,n){var i=Math.asin(1/(t=Math.max(1,t)))*(n/=Ps);function o(e){return 1-t*Math.pow(2,-10*(e=+e))*Math.sin((e+i)/n)}return o.amplitude=function(t){return e(t,n*Ps)},o.period=function(n){return e(t,n)},o}(1,.3),function e(t,n){var i=Math.asin(1/(t=Math.max(1,t)))*(n/=Ps);function o(e){return((e=2*e-1)<0?t*Math.pow(2,10*e)*Math.sin((i-e)/n):2-t*Math.pow(2,-10*e)*Math.sin((i+e)/n))/2}return o.amplitude=function(t){return e(t,n*Ps)},o.period=function(n){return e(t,n)},o}(1,.3),{time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}});function Rs(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))return xs.time=fi(),xs;return n}Sn.prototype.interrupt=function(e){return this.each((function(){Li(this,e)}))},Sn.prototype.transition=function(e){var t,n;e instanceof ws?(t=e._id,e=e._name):(t=Ds(),(n=xs).time=fi(),e=null==e?null:e+"");for(var i=this._groups,o=i.length,s=0;s<o;++s)for(var a,r=i[s],l=r.length,c=0;c<l;++c)(a=r[c])&&Si(a,e,t,c,r,n||Rs(a,t));return new ws(i,this._parents,e,t)};var ks={arc:"bb-arc",arcs:"bb-arcs",area:"bb-area",areas:"bb-areas",axis:"bb-axis",axisX:"bb-axis-x",axisXLabel:"bb-axis-x-label",axisY:"bb-axis-y",axisY2:"bb-axis-y2",axisY2Label:"bb-axis-y2-label",axisYLabel:"bb-axis-y-label",bar:"bb-bar",bars:"bb-bars",brush:"bb-brush",button:"bb-button",buttonZoomReset:"bb-zoom-reset",chart:"bb-chart",chartArc:"bb-chart-arc",chartArcs:"bb-chart-arcs",chartArcsBackground:"bb-chart-arcs-background",chartArcsGaugeMax:"bb-chart-arcs-gauge-max",chartArcsGaugeMin:"bb-chart-arcs-gauge-min",chartArcsGaugeUnit:"bb-chart-arcs-gauge-unit",chartArcsTitle:"bb-chart-arcs-title",chartBar:"bb-chart-bar",chartBars:"bb-chart-bars",chartLine:"bb-chart-line",chartLines:"bb-chart-lines",chartRadar:"bb-chart-radar",chartRadars:"bb-chart-radars",chartText:"bb-chart-text",chartTexts:"bb-chart-texts",circle:"bb-circle",circles:"bb-circles",colorPattern:"bb-color-pattern",defocused:"bb-defocused",dragarea:"bb-dragarea",empty:"bb-empty",eventRect:"bb-event-rect",eventRects:"bb-event-rects",eventRectsMultiple:"bb-event-rects-multiple",eventRectsSingle:"bb-event-rects-single",focused:"bb-focused",gaugeValue:"bb-gauge-value",grid:"bb-grid",gridLines:"bb-grid-lines",legendBackground:"bb-legend-background",legendItem:"bb-legend-item",legendItemEvent:"bb-legend-item-event",legendItemFocused:"bb-legend-item-focused",legendItemHidden:"bb-legend-item-hidden",legendItemPoint:"bb-legend-item-point",legendItemTile:"bb-legend-item-tile",level:"bb-level",levels:"bb-levels",line:"bb-line",lines:"bb-lines",region:"bb-region",regions:"bb-regions",selectedCircle:"bb-selected-circle",selectedCircles:"bb-selected-circles",shape:"bb-shape",shapes:"bb-shapes",target:"bb-target",text:"bb-text",texts:"bb-texts",title:"bb-title",tooltip:"bb-tooltip",tooltipContainer:"bb-tooltip-container",tooltipName:"bb-tooltip-name",xgrid:"bb-xgrid",xgridFocus:"bb-xgrid-focus",xgridLine:"bb-xgrid-line",xgridLines:"bb-xgrid-lines",xgrids:"bb-xgrids",ygrid:"bb-ygrid",ygridLine:"bb-ygrid-line",ygridLines:"bb-ygrid-lines",ygrids:"bb-ygrids",zoomBrush:"bb-zoom-brush",zoomRect:"bb-zoom-rect",EXPANDED:"_expanded_",SELECTED:"_selected_",INCLUDED:"_included_"},Bs=n(6),Vs=n.n(Bs);function Us(){mn.stopImmediatePropagation()}var Fs=function(){mn.preventDefault(),mn.stopImmediatePropagation()},Hs=function(e){var t=e.document.documentElement,n=wn(e).on("dragstart.drag",Fs,!0);"onselectstart"in t?n.on("selectstart.drag",Fs,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")};function zs(e,t){var n=e.document.documentElement,i=wn(e).on("dragstart.drag",null);t&&(i.on("click.drag",Fs,!0),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Ws=function(e){return function(){return e}};function Gs(e,t,n,i,o,s,a,r,l,c){this.target=e,this.type=t,this.subject=n,this.identifier=i,this.active=o,this.x=s,this.y=a,this.dx=r,this.dy=l,this._=c}function Ks(){return!mn.button}function Ys(){return this.parentNode}function js(e){return null==e?{x:mn.x,y:mn.y}:e}function Qs(){return"ontouchstart"in this}Gs.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var qs=function(){var e,t,n,i,o=Ks,s=Ys,a=js,r=Qs,l={},c=li("start","drag","end"),d=0,u=0;function h(e){e.on("mousedown.drag",p).filter(r).on("touchstart.drag",g).on("touchmove.drag",f).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(){if(!i&&o.apply(this,arguments)){var a=v("mouse",s.apply(this,arguments),Pn,this,arguments);a&&(wn(mn.view).on("mousemove.drag",m,!0).on("mouseup.drag",_,!0),Hs(mn.view),Us(),n=!1,e=mn.clientX,t=mn.clientY,a("start"))}}function m(){if(Fs(),!n){var i=mn.clientX-e,o=mn.clientY-t;n=i*i+o*o>u}l.mouse("drag")}function _(){wn(mn.view).on("mousemove.drag mouseup.drag",null),zs(mn.view,n),Fs(),l.mouse("end")}function g(){if(o.apply(this,arguments)){var e,t,n=mn.changedTouches,i=s.apply(this,arguments),a=n.length;for(e=0;e<a;++e)(t=v(n[e].identifier,i,Rn,this,arguments))&&(Us(),t("start"))}}function f(){var e,t,n=mn.changedTouches,i=n.length;for(e=0;e<i;++e)(t=l[n[e].identifier])&&(Fs(),t("drag"))}function b(){var e,t,n=mn.changedTouches,o=n.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),e=0;e<o;++e)(t=l[n[e].identifier])&&(Us(),t("end"))}function v(e,t,n,i,o){var s,r,u,p=n(t,e),m=c.copy();if(An(new Gs(h,"beforestart",s,e,d,p[0],p[1],0,0,m),(function(){return null!=(mn.subject=s=a.apply(i,o))&&(r=s.x-p[0]||0,u=s.y-p[1]||0,!0)})))return function a(c){var _,g=p;switch(c){case"start":l[e]=a,_=d++;break;case"end":delete l[e],--d;case"drag":p=n(t,e),_=d}An(new Gs(h,c,s,e,_,p[0]+r,p[1]+u,p[0]-g[0],p[1]-g[1],m),m.apply,m,[c,i,o])}}return h.filter=function(e){return arguments.length?(o="function"==typeof e?e:Ws(!!e),h):o},h.container=function(e){return arguments.length?(s="function"==typeof e?e:Ws(e),h):s},h.subject=function(e){return arguments.length?(a="function"==typeof e?e:Ws(e),h):a},h.touchable=function(e){return arguments.length?(r="function"==typeof e?e:Ws(!!e),h):r},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(u=(e=+e)*e,h):Math.sqrt(u)},h},Js=function(e){return function(){return e}},Xs=function(e,t,n){this.target=e,this.type=t,this.selection=n};function Zs(){mn.stopImmediatePropagation()}var $s=function(){mn.preventDefault(),mn.stopImmediatePropagation()},ea={name:"drag"},ta={name:"space"},na={name:"handle"},ia={name:"center"},oa={name:"x",handles:["e","w"].map(ua),input:function(e,t){return e&&[[e[0],t[0][1]],[e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},sa={name:"y",handles:["n","s"].map(ua),input:function(e,t){return e&&[[t[0][0],e[0]],[t[1][0],e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},aa=(["n","e","s","w","nw","ne","se","sw"].map(ua),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),ra={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},la={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},ca={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},da={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function ua(e){return{type:e}}function ha(){return!mn.button}function pa(){var e=this.ownerSVGElement||this;return[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function ma(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function _a(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function ga(e){var t,n=pa,i=ha,o=li(a,"start","brush","end"),s=6;function a(t){var n=t.property("__brush",u).selectAll(".overlay").data([ua("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",aa.overlay).merge(n).each((function(){var e=ma(this).extent;wn(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])})),t.selectAll(".selection").data([ua("selection")]).enter().append("rect").attr("class","selection").attr("cursor",aa.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=t.selectAll(".handle").data(e.handles,(function(e){return e.type}));i.exit().remove(),i.enter().append("rect").attr("class",(function(e){return"handle handle--"+e.type})).attr("cursor",(function(e){return aa[e.type]})),t.each(r).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",d)}function r(){var e=wn(this),t=ma(this).selection;t?(e.selectAll(".selection").style("display",null).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1]),e.selectAll(".handle").style("display",null).attr("x",(function(e){return"e"===e.type[e.type.length-1]?t[1][0]-s/2:t[0][0]-s/2})).attr("y",(function(e){return"s"===e.type[0]?t[1][1]-s/2:t[0][1]-s/2})).attr("width",(function(e){return"n"===e.type||"s"===e.type?t[1][0]-t[0][0]+s:s})).attr("height",(function(e){return"e"===e.type||"w"===e.type?t[1][1]-t[0][1]+s:s}))):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function l(e,t){return e.__brush.emitter||new c(e,t)}function c(e,t){this.that=e,this.args=t,this.state=e.__brush,this.active=0}function d(){if(mn.touches){if(mn.changedTouches.length<mn.touches.length)return $s()}else if(t)return;if(i.apply(this,arguments)){var n,o,s,a,c,d,u,h,p,m,_,g,f,b=this,v=mn.target.__data__.type,A="selection"===(mn.metaKey?v="overlay":v)?ea:mn.altKey?ia:na,E=e===sa?null:ca[v],T=e===oa?null:da[v],C=ma(b),y=C.extent,M=C.selection,I=y[0][0],S=y[0][1],w=y[1][0],N=y[1][1],D=E&&T&&mn.shiftKey,L=Pn(b),O=L,P=l(b,arguments).beforestart();"overlay"===v?C.selection=M=[[n=e===sa?I:L[0],s=e===oa?S:L[1]],[c=e===sa?w:n,u=e===oa?N:s]]:(n=M[0][0],s=M[0][1],c=M[1][0],u=M[1][1]),o=n,a=s,d=c,h=u;var x=wn(b).attr("pointer-events","none"),R=x.selectAll(".overlay").attr("cursor",aa[v]);if(mn.touches)x.on("touchmove.brush",B,!0).on("touchend.brush touchcancel.brush",U,!0);else{var k=wn(mn.view).on("keydown.brush",F,!0).on("keyup.brush",H,!0).on("mousemove.brush",B,!0).on("mouseup.brush",U,!0);Hs(mn.view)}Zs(),Li(b),r.call(b),P.start()}function B(){var e=Pn(b);!D||g||f||(Math.abs(e[0]-O[0])>Math.abs(e[1]-O[1])?f=!0:g=!0),O=e,_=!0,$s(),V()}function V(){var e;switch(p=O[0]-L[0],m=O[1]-L[1],A){case ta:case ea:E&&(p=Math.max(I-n,Math.min(w-c,p)),o=n+p,d=c+p),T&&(m=Math.max(S-s,Math.min(N-u,m)),a=s+m,h=u+m);break;case na:E<0?(p=Math.max(I-n,Math.min(w-n,p)),o=n+p,d=c):E>0&&(p=Math.max(I-c,Math.min(w-c,p)),o=n,d=c+p),T<0?(m=Math.max(S-s,Math.min(N-s,m)),a=s+m,h=u):T>0&&(m=Math.max(S-u,Math.min(N-u,m)),a=s,h=u+m);break;case ia:E&&(o=Math.max(I,Math.min(w,n-p*E)),d=Math.max(I,Math.min(w,c+p*E))),T&&(a=Math.max(S,Math.min(N,s-m*T)),h=Math.max(S,Math.min(N,u+m*T)))}d<o&&(E*=-1,e=n,n=c,c=e,e=o,o=d,d=e,v in ra&&R.attr("cursor",aa[v=ra[v]])),h<a&&(T*=-1,e=s,s=u,u=e,e=a,a=h,h=e,v in la&&R.attr("cursor",aa[v=la[v]])),C.selection&&(M=C.selection),g&&(o=M[0][0],d=M[1][0]),f&&(a=M[0][1],h=M[1][1]),M[0][0]===o&&M[0][1]===a&&M[1][0]===d&&M[1][1]===h||(C.selection=[[o,a],[d,h]],r.call(b),P.brush())}function U(){if(Zs(),mn.touches){if(mn.touches.length)return;t&&clearTimeout(t),t=setTimeout((function(){t=null}),500),x.on("touchmove.brush touchend.brush touchcancel.brush",null)}else zs(mn.view,_),k.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);x.attr("pointer-events","all"),R.attr("cursor",aa.overlay),C.selection&&(M=C.selection),_a(M)&&(C.selection=null,r.call(b)),P.end()}function F(){switch(mn.keyCode){case 16:D=E&&T;break;case 18:A===na&&(E&&(c=d-p*E,n=o+p*E),T&&(u=h-m*T,s=a+m*T),A=ia,V());break;case 32:A!==na&&A!==ia||(E<0?c=d-p:E>0&&(n=o-p),T<0?u=h-m:T>0&&(s=a-m),A=ta,R.attr("cursor",aa.selection),V());break;default:return}$s()}function H(){switch(mn.keyCode){case 16:D&&(g=f=D=!1,V());break;case 18:A===ia&&(E<0?c=d:E>0&&(n=o),T<0?u=h:T>0&&(s=a),A=na,V());break;case 32:A===ta&&(mn.altKey?(E&&(c=d-p*E,n=o+p*E),T&&(u=h-m*T,s=a+m*T),A=ia):(E<0?c=d:E>0&&(n=o),T<0?u=h:T>0&&(s=a),A=na),R.attr("cursor",aa[v]),V());break;default:return}$s()}}function u(){var t=this.__brush||{selection:null};return t.extent=n.apply(this,arguments),t.dim=e,t}return a.move=function(t,n){t.selection?t.on("start.brush",(function(){l(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){l(this,arguments).end()})).tween("brush",(function(){var t=this,i=t.__brush,o=l(t,arguments),s=i.selection,a=e.input("function"==typeof n?n.apply(this,arguments):n,i.extent),c=jo(s,a);function d(e){i.selection=1===e&&_a(a)?null:c(e),r.call(t),o.brush()}return s&&a?d:d(1)})):t.each((function(){var t=this,i=arguments,o=t.__brush,s=e.input("function"==typeof n?n.apply(t,i):n,o.extent),a=l(t,i).beforestart();Li(t),o.selection=null==s||_a(s)?null:s,r.call(t),a.start().brush().end()}))},c.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){An(new Xs(a,t,e.output(this.state.selection)),o.apply,o,[t,this.that,this.args])}},a.extent=function(e){return arguments.length?(n="function"==typeof e?e:Js([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),a):n},a.filter=function(e){return arguments.length?(i="function"==typeof e?e:Js(!!e),a):i},a.handleSize=function(e){return arguments.length?(s=+e,a):s},a.on=function(){var e=o.on.apply(o,arguments);return e===o?a:e},a}var fa=function(e){return e||0===e},ba=function(e){return"function"==typeof e},va=function(e){return"string"==typeof e},Aa=function(e){return"number"==typeof e},Ea=function(e){return void 0===e},Ta=function(e){return void 0!==e},Ca=function(e){return"boolean"==typeof e},ya=function(e){return 10*Math.ceil(e/10)},Ma=function(e){return Math.ceil(e)+.5},Ia=function(e){return e[1]-e[0]},Sa=function(e){return"object"===Vs()(e)},wa=function(e){return Ea(e)||null===e||va(e)&&0===e.length||Sa(e)&&0===Object.keys(e).length},Na=function(e){return!wa(e)},Da=function(e){return e&&e.constructor===Array},La=function(e){return e&&!e.nodeType&&Sa(e)&&!Da(e)},Oa=function(e,t,n){return Ta(e[t])?e[t]:n},Pa=function(e){for(var t=ba(e),n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return t&&e.call.apply(e,i),t},xa=function(e){return va(e)?e.replace(/</g,"&lt;").replace(/>/g,"&gt;"):e},Ra=function(e){var t=e.getBBox(),n=t.x,i=t.y,o=t.width,s=t.height;return[{x:n,y:i+s},{x:n,y:i},{x:n+o,y:i},{x:n+o,y:i+s}]},ka=function(e){var t,n=null,i=mn,o=e.context||e.main;return i&&"BrushEvent"===i.constructor.name?n=i.selection:o&&(n=o.select(".".concat(ks.brush)).node())&&(n=(t=n.__brush)?t.dim.output(t.selection):null),n},Ba=function(e){var t=ka(e);return!t||t[0]===t[1]},Va=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var n in t)e[n]=t[n];return e},Ua=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Fa=function(e){return[].slice.call(e)},Ha={mouse:function(){try{return new MouseEvent("t"),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{bubbles:!1,cancelable:!1,screenX:0,screenY:0,clientX:0,clientY:0};e.dispatchEvent(new MouseEvent(t,n))}}catch(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{bubbles:!1,cancelable:!1,screenX:0,screenY:0,clientX:0,clientY:0},i=document.createEvent("MouseEvent");i.initMouseEvent(t,n.bubbles,n.cancelable,window,0,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.dispatchEvent(i)}}}(),touch:function(e,t,n){var i=new Touch(Object.assign({identifier:Date.now(),target:e,radiusX:2.5,radiusY:2.5,rotationAngle:10,force:.5},n));e.dispatchEvent(new TouchEvent(t,{cancelable:!0,bubbles:!0,shiftKey:!0,touches:[i],targetTouches:[],changedTouches:[i]}))}},za=n(7),Wa=n.n(za);function Ga(){}function Ka(e,t){var n=new Ga;if(e instanceof Ga)e.each((function(e,t){n.set(t,e)}));else if(Array.isArray(e)){var i,o=-1,s=e.length;if(null==t)for(;++o<s;)n.set(o,e[o]);else for(;++o<s;)n.set(t(i=e[o],o,e),i)}else if(e)for(var a in e)n.set(a,e[a]);return n}Ga.prototype=Ka.prototype={constructor:Ga,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var Ya=Ka;function ja(){}var Qa=Ya.prototype;function qa(e,t){var n=new ja;if(e instanceof ja)e.each((function(e){n.add(e)}));else if(e){var i=-1,o=e.length;if(null==t)for(;++i<o;)n.add(e[i]);else for(;++i<o;)n.add(t(e[i],i,e))}return n}ja.prototype=qa.prototype={constructor:ja,has:Qa.has,add:function(e){return this["$"+(e+="")]=e,this},remove:Qa.remove,clear:Qa.clear,values:Qa.keys,size:Qa.size,empty:Qa.empty,each:Qa.each};var Ja=qa,Xa=function(e){var t=[];for(var n in e)t.push(n);return t},Za=Array.prototype,$a=Za.map,er=Za.slice,tr={name:"implicit"};function nr(e){var t=Ya(),n=[],i=tr;function o(o){var s=o+"",a=t.get(s);if(!a){if(i!==tr)return i;t.set(s,a=n.push(o))}return e[(a-1)%e.length]}return e=null==e?[]:er.call(e),o.domain=function(e){if(!arguments.length)return n.slice();n=[],t=Ya();for(var i,s,a=-1,r=e.length;++a<r;)t.has(s=(i=e[a])+"")||t.set(s,n.push(i));return o},o.range=function(t){return arguments.length?(e=er.call(t),o):e.slice()},o.unknown=function(e){return arguments.length?(i=e,o):i},o.copy=function(){return nr().domain(n).range(e).unknown(i)},o}var ir=function(e){return function(){return e}},or=function(e){return+e},sr=[0,1];function ar(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:ir(t)}function rr(e,t,n,i){var o=e[0],s=e[1],a=t[0],r=t[1];return s<o?(o=n(s,o),a=i(r,a)):(o=n(o,s),a=i(a,r)),function(e){return a(o(e))}}function lr(e,t,n,i){var o=Math.min(e.length,t.length)-1,s=new Array(o),a=new Array(o),r=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++r<o;)s[r]=n(e[r],e[r+1]),a[r]=i(t[r],t[r+1]);return function(t){var n=Fn(e,t,1,o)-1;return a[n](s[n](t))}}function cr(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function dr(e,t){var n,i,o,s=sr,a=sr,r=jo,l=!1;function c(){return n=Math.min(s.length,a.length)>2?lr:rr,i=o=null,d}function d(t){return(i||(i=n(s,a,l?function(e){return function(t,n){var i=e(t=+t,n=+n);return function(e){return e<=t?0:e>=n?1:i(e)}}}(e):e,r)))(+t)}return d.invert=function(e){return(o||(o=n(a,s,ar,l?function(e){return function(t,n){var i=e(t=+t,n=+n);return function(e){return e<=0?t:e>=1?n:i(e)}}}(t):t)))(+e)},d.domain=function(e){return arguments.length?(s=$a.call(e,or),c()):s.slice()},d.range=function(e){return arguments.length?(a=er.call(e),c()):a.slice()},d.rangeRound=function(e){return a=er.call(e),r=Qo,c()},d.clamp=function(e){return arguments.length?(l=!!e,c()):l},d.interpolate=function(e){return arguments.length?(r=e,c()):r},c()}var ur=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]},hr=function(e){return(e=ur(Math.abs(e)))?e[1]:NaN},pr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function mr(e){return new _r(e)}function _r(e){if(!(t=pr.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}mr.prototype=_r.prototype,_r.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var gr,fr,br,vr,Ar=function(e,t){var n=ur(e,t);if(!n)return e+"";var i=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")},Er={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Ar(100*e,t)},r:Ar,s:function(e,t){var n=ur(e,t);if(!n)return e+"";var i=n[0],o=n[1],s=o-(gr=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,a=i.length;return s===a?i:s>a?i+new Array(s-a+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+ur(e,Math.max(0,t+s-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},Tr=function(e){return e},Cr=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],yr=function(e){var t,n,i=e.grouping&&e.thousands?(t=e.grouping,n=e.thousands,function(e,i){for(var o=e.length,s=[],a=0,r=t[0],l=0;o>0&&r>0&&(l+r+1>i&&(r=Math.max(1,i-l)),s.push(e.substring(o-=r,o+r)),!((l+=r+1)>i));)r=t[a=(a+1)%t.length];return s.reverse().join(n)}):Tr,o=e.currency,s=e.decimal,a=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(e.numerals):Tr,r=e.percent||"%";function l(e){var t=(e=mr(e)).fill,n=e.align,l=e.sign,c=e.symbol,d=e.zero,u=e.width,h=e.comma,p=e.precision,m=e.trim,_=e.type;"n"===_?(h=!0,_="g"):Er[_]||(null==p&&(p=12),m=!0,_="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var g="$"===c?o[0]:"#"===c&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",f="$"===c?o[1]:/[%p]/.test(_)?r:"",b=Er[_],v=/[defgprs%]/.test(_);function A(e){var o,r,c,A=g,E=f;if("c"===_)E=b(e)+E,e="";else{var T=(e=+e)<0;if(e=b(Math.abs(e),p),m&&(e=function(e){e:for(var t,n=e.length,i=1,o=-1;i<n;++i)switch(e[i]){case".":o=t=i;break;case"0":0===o&&(o=i),t=i;break;default:if(o>0){if(!+e[i])break e;o=0}}return o>0?e.slice(0,o)+e.slice(t+1):e}(e)),T&&0==+e&&(T=!1),A=(T?"("===l?l:"-":"-"===l||"("===l?"":l)+A,E=("s"===_?Cr[8+gr/3]:"")+E+(T&&"("===l?")":""),v)for(o=-1,r=e.length;++o<r;)if(48>(c=e.charCodeAt(o))||c>57){E=(46===c?s+e.slice(o+1):e.slice(o))+E,e=e.slice(0,o);break}}h&&!d&&(e=i(e,1/0));var C=A.length+e.length+E.length,y=C<u?new Array(u-C+1).join(t):"";switch(h&&d&&(e=i(y+e,y.length?u-E.length:1/0),y=""),n){case"<":e=A+e+E+y;break;case"=":e=A+y+e+E;break;case"^":e=y.slice(0,C=y.length>>1)+A+e+E+y.slice(C);break;default:e=y+A+e+E}return a(e)}return p=null==p?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),A.toString=function(){return e+""},A}return{format:l,formatPrefix:function(e,t){var n=l(((e=mr(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(hr(t)/3))),o=Math.pow(10,-i),s=Cr[8+i/3];return function(e){return n(o*e)+s}}}};!function(e){fr=yr(e),br=fr.format,vr=fr.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Mr=function(e,t,n){var i,o=e[0],s=e[e.length-1],a=qn(o,s,null==t?10:t);switch((n=mr(null==n?",f":n)).type){case"s":var r=Math.max(Math.abs(o),Math.abs(s));return null!=n.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(hr(t)/3)))-hr(Math.abs(e)))}(a,r))||(n.precision=i),vr(n,r);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,hr(t)-hr(e))+1}(a,Math.max(Math.abs(o),Math.abs(s))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=function(e){return Math.max(0,-hr(Math.abs(e)))}(a))||(n.precision=i-2*("%"===n.type))}return br(n)};function Ir(e){var t=e.domain;return e.ticks=function(e){var n=t();return jn(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return Mr(t(),e,n)},e.nice=function(n){null==n&&(n=10);var i,o=t(),s=0,a=o.length-1,r=o[s],l=o[a];return l<r&&(i=r,r=l,l=i,i=s,s=a,a=i),(i=Qn(r,l,n))>0?i=Qn(r=Math.floor(r/i)*i,l=Math.ceil(l/i)*i,n):i<0&&(i=Qn(r=Math.ceil(r*i)/i,l=Math.floor(l*i)/i,n)),i>0?(o[s]=Math.floor(r/i)*i,o[a]=Math.ceil(l/i)*i,t(o)):i<0&&(o[s]=Math.ceil(r*i)/i,o[a]=Math.floor(l*i)/i,t(o)),e},e}function Sr(){var e=dr(ar,zo);return e.copy=function(){return cr(e,Sr())},Ir(e)}var wr=function(e,t){var n,i=0,o=(e=e.slice()).length-1,s=e[i],a=e[o];return a<s&&(n=i,i=o,o=n,n=s,s=a,a=n),e[i]=t.floor(s),e[o]=t.ceil(a),e};function Nr(e){return new Date(e)}function Dr(e){return e instanceof Date?+e:+new Date(+e)}function Lr(e,t,n,i,o,s,a,r,l){var c=dr(ar,zo),d=c.invert,u=c.domain,h=l(".%L"),p=l(":%S"),m=l("%I:%M"),_=l("%I %p"),g=l("%a %d"),f=l("%b %d"),b=l("%B"),v=l("%Y"),A=[[a,1,1e3],[a,5,5e3],[a,15,15e3],[a,30,3e4],[s,1,6e4],[s,5,3e5],[s,15,9e5],[s,30,18e5],[o,1,36e5],[o,3,108e5],[o,6,216e5],[o,12,432e5],[i,1,864e5],[i,2,1728e5],[n,1,6048e5],[t,1,2592e6],[t,3,7776e6],[e,1,31536e6]];function E(r){return(a(r)<r?h:s(r)<r?p:o(r)<r?m:i(r)<r?_:t(r)<r?n(r)<r?g:f:e(r)<r?b:v)(r)}function T(t,n,i,o){if(null==t&&(t=10),"number"==typeof t){var s=Math.abs(i-n)/t,a=Bn((function(e){return e[2]})).right(A,s);a===A.length?(o=qn(n/31536e6,i/31536e6,t),t=e):a?(o=(a=A[s/A[a-1][2]<A[a][2]/s?a-1:a])[1],t=a[0]):(o=Math.max(qn(n,i,t),1),t=r)}return null==o?t:t.every(o)}return c.invert=function(e){return new Date(d(e))},c.domain=function(e){return arguments.length?u($a.call(e,Dr)):u().map(Nr)},c.ticks=function(e,t){var n,i=u(),o=i[0],s=i[i.length-1],a=s<o;return a&&(n=o,o=s,s=n),n=(n=T(e,o,s,t))?n.range(o,s+1):[],a?n.reverse():n},c.tickFormat=function(e,t){return null==t?E:l(t)},c.nice=function(e,t){var n=u();return(e=T(e,n[0],n[n.length-1],t))?u(wr(n,e)):c},c.copy=function(){return cr(c,Lr(e,t,n,i,o,s,a,r,l))},c}var Or=function(){function e(t,n){o()(this,e);var i=Sr();this.config=t,this.scale=i,t.range=i.rangeExtent?i.rangeExtent():this.scaleExtent((n.orgXScale||i).range())}return l()(e,[{key:"axisX",value:function(e,t){var n=this.config.tickOffset;e.attr("transform",(function(e){return"translate(".concat(Math.ceil(t(e)+n),", 0)")}))}},{key:"axisY",value:function(e,t){e.attr("transform",(function(e){return"translate(0,".concat(Math.ceil(t(e)),")")}))}},{key:"scaleExtent",value:function(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}},{key:"generateTicks",value:function(e){var t=[];if(e.ticks)return e.ticks.apply(e,Wa()(this.config.tickArguments||[])).map((function(e){return va(e)&&Aa(e)&&!isNaN(e)&&Math.round(10*e)/10||e}));for(var n=e.domain(),i=Math.ceil(n[0]);i<n[1];i++)t.push(i);return t.length>0&&t[0]>0&&t.unshift(t[0]-(t[1]-t[0])),t}},{key:"copyScale",value:function(){var e=this.scale.copy();return e.domain().length||e.domain(this.scale.domain()),e}},{key:"textFormatted",value:function(e){var t=this.config.tickFormat,n=/\d+\.\d+0{5,}\d$/.test(e)?+(e+"").replace(/0+\d$/,""):e,i=t?t(n):n;return Ta(i)?i:""}},{key:"transitionise",value:function(e){var t=this.config;return t.withoutTransition?e.interrupt():e.transition(t.transition)}}],[{key:"getSizeFor1Char",value:function(e){var t={w:5.5,h:11.5};return e.empty()||e.select("text").text("0").call((function(e){try{var n=e.node().getBBox(),i=n.width,o=n.height;i&&o&&(t.w=i,t.h=o),e.text("")}catch(e){}})),this.getSizeFor1Char=function(){return t},t}}]),e}(),Pr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e);var n={innerTickSize:6,outerTickSize:t.withOuterTick?6:0,orient:"bottom",range:[],tickArguments:null,tickCentered:null,tickCulling:!0,tickFormat:null,tickLength:9,tickOffset:0,tickPadding:3,tickValues:null,transition:null,withoutTransition:t.withoutTransition};n.tickLength=Math.max(n.innerTickSize,0)+n.tickPadding,this.helper=new Or(n,t),this.config=n,this.params=t}return l()(e,[{key:"create",value:function(e){var t=this,n=this.config,i=this.params,o=this.helper,s=o.scale,a=n.orient,r=this.splitTickText.bind(this),l=/^(left|right)$/.test(a),c=/^(top|bottom)$/.test(a),d=o[c?"axisX":"axisY"],u=d===o.axisX?"y":"x",h=/^(top|left)$/.test(a)?-1:1,p=i.tickTextRotate;this.config.range=s.rangeExtent?s.rangeExtent():o.scaleExtent((i.orgXScale||s).range());var m=n,_=m.innerTickSize,g=m.tickLength,f=m.range,b=i.axisName&&/^(x|y|y2)$/.test(i.axisName)?i.config["axis_".concat(i.axisName,"_tick_text_position")]:{x:0,y:0},v=null;e.each((function(){var e=wn(this);v=e;var m=this.__chart__||s,A=o.copyScale();this.__chart__=A;var E=n.tickValues||o.generateTicks(A),T=e.selectAll(".tick").data(E,A),C=T.enter().insert("g",".domain").attr("class","tick").style("opacity","1"),y=T.exit().remove();T=C.merge(T);var M=e.selectAll(".domain").data([0]);M.enter().append("path").attr("class","domain").merge(o.transitionise(M)).attr("d",(function(){var e=n.outerTickSize*h;return c?"M".concat(f[0],",").concat(e,"V0H").concat(f[1],"V").concat(e):"M".concat(e,",").concat(f[0],"H0V").concat(f[1],"H").concat(e)})),C.append("line"),C.append("text");var I=Or.getSizeFor1Char(T),S=[],w=T.select("text").selectAll("tspan").data((function(e,t){var n=i.tickMultiline?r(e,A,E,l,I.w):Da(o.textFormatted(e))?o.textFormatted(e).concat():[o.textFormatted(e)];return S[t]=n.length,n.map((function(e){return{index:t,splitted:e}}))}));w.exit().remove(),(w=w.enter().append("tspan").merge(w).text((function(e){return e.splitted}))).attr("x",c?0:g*h).attr("dx",function(){var e=0;return"bottom"===a&&p&&(e=8*Math.sin(Math.PI*(p/180))),e+(b.x||0)}()).attr("dy",(function(e,t){var n=0;return"top"!==a&&(n=I.h,0===t&&(n=l?-((S[e.index]-1)*(I.h/2)-3):0===b.y?".71em":0)),Aa(n)&&b.y?n+b.y:n||".71em"}));var N=T.select("line"),D=T.select("text");if(C.select("line").attr("".concat(u,"2"),_*h),C.select("text").attr("".concat(u),g*h),t.setTickLineTextPosition(N,D,A),i.tickTitle&&D.append&&D.append("title").each((function(e){wn(this).text(i.tickTitle[e])})),A.bandwidth){var L=A,O=L.bandwidth()/2;A=m=function(e){return L(e)+O}}else m.bandwidth?m=A:d.call(o,y,A);d.call(o,C,m),d.call(o,o.transitionise(T).style("opacity",1),A)})),this.g=v}},{key:"getTickXY",value:function(e){var t=this.config,n={x:0,y:0};return this.params.isCategory?(t.tickOffset=Math.ceil((e(1)-e(0))/2),n.x=t.tickCentered?0:t.tickOffset,n.y=t.tickCentered?t.tickOffset:0):t.tickOffset=n.x,n}},{key:"getTickSize",value:function(e){var t=this.helper.scale,n=this.config,i=n.innerTickSize,o=n.range,s=t(e)+(n.tickCentered?0:n.tickOffset);return o[0]<s&&s<o[1]?i:0}},{key:"setTickLineTextPosition",value:function(e,t,n){var i,o=this.getTickXY(n),s=this.config,a=s.innerTickSize,r=s.orient,l=s.tickLength,c=s.tickOffset,d=this.params.tickTextRotate;"bottom"===r?(e.attr("x1",o.x).attr("x2",o.x).attr("y2",this.getTickSize.bind(this)),t.attr("x",0).attr("y",(i=d,i?11.5-i/15*2.5*(i>0?1:-1):l)).style("text-anchor",function(e){return e?e>0?"start":"end":"middle"}(d)).attr("transform",function(e){return e?"rotate(".concat(e,")"):null}(d))):"top"===r?(e.attr("x2",0).attr("y2",-a),t.attr("x",0).attr("y",-l).style("text-anchor","middle")):"left"===r?(e.attr("x2",-a).attr("y1",o.y).attr("y2",o.y),t.attr("x",-l).attr("y",c).style("text-anchor","end")):"right"===r&&(e.attr("x2",a).attr("y2",0),t.attr("x",l).attr("y",0).style("text-anchor","start"))}},{key:"splitTickText",value:function(e,t,n,i,o){var s=this.params,a=this.helper.textFormatted(e),r=va(a)&&a.indexOf("\n")>-1?a.split("\n"):[];if(r.length)return r;if(Da(a))return a;var l=s.tickWidth;return(!l||l<=0)&&(l=i?95:s.isCategory?Math.ceil(t(n[1])-t(n[0]))-12:110),function e(t,n){for(var i,s,a,r=1;r<n.length;r++)if(" "===n.charAt(r)&&(s=r),i=n.substr(0,r+1),a=o*i.length,l<a)return e(t.concat(n.substr(0,s||r)),n.slice(s?s+1:r));return t.concat(n)}(r,a+"")}},{key:"scale",value:function(e){return arguments.length?(this.helper.scale=e,this):this.helper.scale}},{key:"orient",value:function(e){return arguments.length?(this.config.orient=e in{top:1,right:1,bottom:1,left:1}?e+"":"bottom",this):this.config.orient}},{key:"tickFormat",value:function(e){return arguments.length?(this.config.tickFormat=e,this):this.config.tickFormat}},{key:"tickCentered",value:function(e){var t=this.config;return arguments.length?(t.tickCentered=e,this):t.tickCentered}},{key:"tickOffset",value:function(){return this.config.tickOffset}},{key:"tickInterval",value:function(e){var t;return(t=this.params.isCategory?2*this.config.tickOffset:(this.g.select("path.domain").node().getTotalLength()-2*this.config.outerTickSize)/(e||this.g.selectAll("line").size()))===1/0?0:t}},{key:"ticks",value:function(){for(var e=this.config,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.length?(e.tickArguments=Fa(n),this):e.tickArguments}},{key:"tickCulling",value:function(e){var t=this.config;return arguments.length?(t.tickCulling=e,this):t.tickCulling}},{key:"tickValues",value:function(e){var t=this,n=this.config;if(ba(e))n.tickValues=function(){return e(t.helper.scale.domain())};else{if(!arguments.length)return n.tickValues;n.tickValues=e}return this}},{key:"setTransition",value:function(e){return this.config.transition=e,this}}]),e}(),xr=function(e,t){var n=e.config.axis_rotated;return t?n:!n},Rr=function(){function e(t){o()(this,e),this.owner=t}return l()(e,[{key:"init",value:function(){var e=this,t=this.owner,n=t.config,i=n.axis_rotated,o=t.main;["x","y","y2"].forEach((function(s){var a="axis".concat(Ua(s)),r="".concat(ks.axis," ").concat(ks[a]),l=ks["".concat(a,"Label")];t.axes[s]=o.append("g").attr("class",r).attr("clip-path",(function(){var e=null;return"x"===s?e=t.clipPathForXAxis:"y"===s&&n.axis_y_inner&&(e=t.clipPathForYAxis),e})).attr("transform",t.getTranslate(s)).style("visibility",n["axis_".concat(s,"_show")]?"visible":"hidden"),t.axes[s].append("text").attr("class",l).attr("transform",["rotate(-90)",null]["x"===s?+!i:+i]).style("text-anchor",e.textAnchorForXAxisLabel.bind(e))}))}},{key:"getXAxis",value:function(e,t,n,i,o,s,a,r){var l=this.owner,c=l.config,d=l.isCategorized(),u={isCategory:d,withOuterTick:s,withoutTransition:a,config:c,axisName:e,tickMultiline:c.axis_x_tick_multiline,tickWidth:c.axis_x_tick_width,tickTextRotate:r?0:c.axis_x_tick_rotate,tickTitle:d&&c.axis_x_tick_tooltip&&l.api.categories(),orgXScale:l.x},h=new Pr(u).scale(l.zoomScale||t).orient(n),p=o;return l.isTimeSeries()&&o&&!ba(o)&&(p=o.map((function(e){return l.parseDate(e)}))),h.tickFormat(i).tickValues(p),d&&(h.tickCentered(c.axis_x_tick_centered),wa(c.axis_x_tick_culling)&&(c.axis_x_tick_culling=!1)),h}},{key:"getYAxis",value:function(e,t,n,i,o,s,a,r){var l=this.owner,c=l.config,d={withOuterTick:s,withoutTransition:a,config:c,axisName:e,tickTextRotate:r?0:c.axis_y_tick_rotate},u=new Pr(d).scale(t).orient(n).tickFormat(i||l.isStackNormalized()&&function(e){return"".concat(e,"%")});return l.isTimeSeriesY()?u.ticks(c.axis_y_tick_time_value):u.tickValues(o),u}},{key:"updateXAxisTickValues",value:function(e,t){var n,i=this.owner,o=i.config,s=o.axis_x_tick_count;return(o.axis_x_tick_fit||s)&&(n=this.generateTickValues(i.mapTargetsToUniqueXs(e),s,i.isTimeSeries())),t?t.tickValues(n):(i.xAxis.tickValues(n),i.subXAxis.tickValues(n)),n}},{key:"getId",value:function(e){var t=this.owner.config;return e in t.data_axes?t.data_axes[e]:"y"}},{key:"getXAxisTickFormat",value:function(){var e,t=this.owner,n=t.config.axis_x_tick_format,i=t.isTimeSeries(),o=t.isCategorized();return n?ba(n)?e=n:i&&(e=function(e){return e?t.axisTimeFormat(n)(e):""}):e=i?t.defaultAxisTimeFormat:o?t.categoryName:function(e){return e<0?e.toFixed(0):e},ba(e)?function(n){return e.apply(t,o?[n,t.categoryName(n)]:[n])}:e}},{key:"getTickValues",value:function(e){var t=this.owner,n=t.config["axis_".concat(e,"_tick_values")],i=t["".concat(e,"Axis")];return n||(i?i.tickValues():void 0)}},{key:"getXAxisTickValues",value:function(){return this.getTickValues("x")}},{key:"getYAxisTickValues",value:function(){return this.getTickValues("y")}},{key:"getY2AxisTickValues",value:function(){return this.getTickValues("y2")}},{key:"getLabelOptionByAxisId",value:function(e){return this.owner.config["axis_".concat(e,"_label")]}},{key:"getLabelText",value:function(e){var t=this.getLabelOptionByAxisId(e);return va(t)?t:t?t.text:null}},{key:"setLabelText",value:function(e,t){var n=this.owner.config,i=this.getLabelOptionByAxisId(e);va(i)?n["axis_".concat(e,"_label")]=t:i&&(i.text=t)}},{key:"getLabelPosition",value:function(e,t){var n=this.owner.config.axis_rotated,i=this.getLabelOptionByAxisId(e),o=Sa(i)&&i.position?i.position:t[+!n],s=function(e){return!!~o.indexOf(e)};return{isInner:s("inner"),isOuter:s("outer"),isLeft:s("left"),isCenter:s("center"),isRight:s("right"),isTop:s("top"),isMiddle:s("middle"),isBottom:s("bottom")}}},{key:"getXAxisLabelPosition",value:function(){return this.getLabelPosition("x",["inner-top","inner-right"])}},{key:"getYAxisLabelPosition",value:function(){return this.getLabelPosition("y",["inner-right","inner-top"])}},{key:"getY2AxisLabelPosition",value:function(){return this.getLabelPosition("y2",["inner-right","inner-top"])}},{key:"getLabelPositionById",value:function(e){return this["get".concat(e.toUpperCase(),"AxisLabelPosition")]()}},{key:"textForXAxisLabel",value:function(){return this.getLabelText("x")}},{key:"textForYAxisLabel",value:function(){return this.getLabelText("y")}},{key:"textForY2AxisLabel",value:function(){return this.getLabelText("y2")}},{key:"xForAxisLabel",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.owner,i=e.isMiddle?-n.height/2:0;return xr(n,t)?i=e.isLeft?0:e.isCenter?n.width/2:n.width:e.isBottom&&(i=-n.height),i}},{key:"dxForAxisLabel",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.owner,i=e.isBottom?"0.5em":"0";return xr(n,t)?i=e.isLeft?"0.5em":e.isRight?"-0.5em":"0":e.isTop&&(i="-0.5em"),i}},{key:"textAnchorForAxisLabel",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.owner,i=e.isMiddle?"middle":"end";return xr(n,t)?i=e.isLeft?"start":e.isCenter?"middle":"end":e.isBottom&&(i="start"),i}},{key:"xForXAxisLabel",value:function(){return this.xForAxisLabel(this.getXAxisLabelPosition(),!1)}},{key:"xForYAxisLabel",value:function(){return this.xForAxisLabel(this.getYAxisLabelPosition())}},{key:"xForY2AxisLabel",value:function(){return this.xForAxisLabel(this.getY2AxisLabelPosition())}},{key:"dxForXAxisLabel",value:function(){return this.dxForAxisLabel(this.getXAxisLabelPosition(),!1)}},{key:"dxForYAxisLabel",value:function(){return this.dxForAxisLabel(this.getYAxisLabelPosition())}},{key:"dxForY2AxisLabel",value:function(){return this.dxForAxisLabel(this.getY2AxisLabelPosition())}},{key:"dyForXAxisLabel",value:function(){var e=this.owner.config,t=this.getXAxisLabelPosition().isInner,n=e.axis_x_height;return e.axis_rotated?t?"1.2em":-25-this.getMaxTickWidth("x"):t?"-0.5em":n?n-10:"3em"}},{key:"dyForYAxisLabel",value:function(){var e=this.owner,t=this.getYAxisLabelPosition().isInner;return e.config.axis_rotated?t?"-0.5em":"3em":t?"1.2em":-10-(e.config.axis_y_inner?0:this.getMaxTickWidth("y")+10)}},{key:"dyForY2AxisLabel",value:function(){var e=this.owner,t=this.getY2AxisLabelPosition().isInner;return e.config.axis_rotated?t?"1.2em":"-2.2em":t?"-0.5em":15+(e.config.axis_y2_inner?0:this.getMaxTickWidth("y2")+15)}},{key:"textAnchorForXAxisLabel",value:function(){return this.textAnchorForAxisLabel(this.getXAxisLabelPosition(),!1)}},{key:"textAnchorForYAxisLabel",value:function(){return this.textAnchorForAxisLabel(this.getYAxisLabelPosition())}},{key:"textAnchorForY2AxisLabel",value:function(){return this.textAnchorForAxisLabel(this.getY2AxisLabelPosition())}},{key:"getMaxTickWidth",value:function(e,t){var n=this.owner,i=n.config,o=n.currentMaxTickWidths,s=0;if(t&&o[e])return o[e];if(n.svg){var a=/^y2?$/.test(e),r=n.filterTargetsToShow(n.data.targets),l=a?"getY":"getX",c=n[e].copy().domain(n["".concat(l,"Domain")](r,e)),d=this["".concat(l,"Axis")](e,c,n["".concat(e,"Orient")],a?i["axis_".concat(e,"_tick_format")]:n.xAxisTickFormat,null,!1,!0,!0);a||this.updateXAxisTickValues(r,d);var u=n.selectChart.append("svg").style("visibility","hidden").style("position","fixed").style("top","0px").style("left","0px");d.create(u),u.selectAll("text").each((function(){s=Math.max(s,this.getBoundingClientRect().width)})),u.remove()}return s>0&&(o[e]=s),o[e]}},{key:"updateLabels",value:function(e){var t=this,n=this.owner,i={X:n.main.select(".".concat(ks.axisX," .").concat(ks.axisXLabel)),Y:n.main.select(".".concat(ks.axisY," .").concat(ks.axisYLabel)),Y2:n.main.select(".".concat(ks.axisY2," .").concat(ks.axisY2Label))};Object.keys(i).forEach((function(n){var o=i[n],s="".concat(n,"AxisLabel");(e?o.transition():o).attr("x",t["xFor".concat(s)].bind(t)).attr("dx",t["dxFor".concat(s)].bind(t)).attr("dy",t["dyFor".concat(s)].bind(t)).text(t["textFor".concat(s)].bind(t))}))}},{key:"getPadding",value:function(e,t,n,i){var o=Aa(e)?e:e[t];return fa(o)?"ratio"===e.unit?e[t]*i:this.convertPixelsToAxisPadding(o,i):n}},{key:"convertPixelsToAxisPadding",value:function(e,t){var n=this.owner;return t*(e/(n.config.axis_rotated?n.width:n.height))}},{key:"generateTickValues",value:function(e,t,n){var i,o,s,a,r,l,c=e;if(t){var d=ba(t)?t():t;if(1===d)c=[e[0]];else if(2===d)c=[e[0],e[e.length-1]];else if(d>2){for(s=d-2,i=e[0],a=((o=e[e.length-1])-i)/(s+1),c=[i],r=0;r<s;r++)l=+i+a*(r+1),c.push(n?new Date(l):l);c.push(o)}}return n||(c=c.sort((function(e,t){return e-t}))),c}},{key:"generateTransitions",value:function(e){var t=this.owner.axes,n=["x","y","y2","subx"].map((function(n){return e?t[n].transition().duration(e):t[n]})),i=a()(n,4);return{axisX:i[0],axisY:i[1],axisY2:i[2],axisSubX:i[3]}}},{key:"redraw",value:function(e,t){var n=this.owner,i=t?"0":"1";["x","y","y2","subx"].forEach((function(e){n.axes[e].style("opacity",i)})),n.xAxis.create(e.axisX),n.yAxis.create(e.axisY),n.y2Axis.create(e.axisY2),n.subXAxis.create(e.axisSubX)}}]),e}(),kr=function(){function e(t){o()(this,e);var n=this;n.api=t,n.config=n.getOptions(),n.data={},n.cache={},n.axes={}}return l()(e,[{key:"beforeInit",value:function(){var e=this.config;Pa(e.onbeforeinit,this)}},{key:"afterInit",value:function(){var e=this.config;Pa(e.onafterinit,this)}},{key:"init",value:function(){var e,t=this,n=t.config;if(t.initParams(),n.data_url)t.convertUrlToData(n.data_url,n.data_mimeType,n.data_headers,n.data_keys,t.initWithData);else if(n.data_json)e=t.convertJsonToData(n.data_json,n.data_keys);else if(n.data_rows)e=t.convertRowsToData(n.data_rows);else{if(!n.data_columns)throw Error("url or json or rows or columns is required.");e=t.convertColumnsToData(n.data_columns)}e&&t.initWithData(e)}},{key:"initParams",value:function(){var e=this,t=e.config,n=t.axis_rotated;e.datetimeId="bb-".concat(+new Date),e.clipId="".concat(e.datetimeId,"-clip"),e.clipIdForXAxis="".concat(e.clipId,"-xaxis"),e.clipIdForYAxis="".concat(e.clipId,"-yaxis"),e.clipIdForGrid="".concat(e.clipId,"-grid"),e.clipIdForSubchart="".concat(e.clipId,"-subchart"),e.clipPath=e.getClipPath(e.clipId),e.clipPathForXAxis=e.getClipPath(e.clipIdForXAxis),e.clipPathForYAxis=e.getClipPath(e.clipIdForYAxis),e.clipPathForGrid=e.getClipPath(e.clipIdForGrid),e.clipPathForSubchart=e.getClipPath(e.clipIdForSubchart),e.dragStart=null,e.dragging=!1,e.flowing=!1,e.cancelClick=!1,e.mouseover=!1,e.transiting=!1,e.color=e.generateColor(),e.levelColor=e.generateLevelColor(),e.point=e.generatePoint(),e.extraLineClasses=e.generateExtraLineClass(),e.dataTimeFormat=t.data_xLocaltime?ee:ne,e.axisTimeFormat=t.axis_x_localtime?$:te,e.defaultAxisTimeFormat=function(t){var n=(t.getMilliseconds()?".%L":t.getSeconds()&&".:%S")||t.getMinutes()&&"%I:%M"||t.getHours()&&"%I %p"||t.getDay()&&1!==t.getDate()&&"%-m/%-d"||1!==t.getDate()&&"%b %d"||t.getMonth()&&"%-m/%-d"||"%Y/%-m/%-d";return e.axisTimeFormat(n)(t)},e.hiddenTargetIds=[],e.hiddenLegendIds=[],e.focusedTargetIds=[],e.defocusedTargetIds=[],e.xOrient=n?"left":"bottom",e.yOrient=n?t.axis_y_inner?"top":"bottom":t.axis_y_inner?"right":"left",e.y2Orient=n?t.axis_y2_inner?"bottom":"top":t.axis_y2_inner?"left":"right",e.subXOrient=n?"left":"bottom",e.isLegendRight="right"===t.legend_position,e.isLegendInset="inset"===t.legend_position,e.isLegendTop="top-left"===t.legend_inset_anchor||"top-right"===t.legend_inset_anchor,e.isLegendLeft="top-left"===t.legend_inset_anchor||"bottom-left"===t.legend_inset_anchor,e.legendStep=0,e.legendItemWidth=0,e.legendItemHeight=0,e.currentMaxTickWidths={x:0,y:0,y2:0},e.rotated_padding_left=30,e.rotated_padding_right=n&&!t.axis_x_show?0:30,e.rotated_padding_top=5,e.withoutFadeIn={},e.inputType=e.convertInputType(),e.axes.subx=xn([])}},{key:"initWithData",value:function(e){var t=this,n=t.config;t.axis=new Rr(t),n.subchart_show&&t.initBrush(),n.zoom_enabled&&(t.initZoom(),t.initZoomBehaviour());var i={element:n.bindto,classname:"bb"};if(La(n.bindto)&&(i.element=n.bindto.element||"#chart",i.classname=n.bindto.classname||i.classname),t.selectChart=ba(i.element.node)?n.bindto.element:wn(i.element?i.element:[]),t.selectChart.html("").classed(i.classname,!0),t.data.xs={},t.data.targets=t.convertDataToTargets(e),n.data_filter&&(t.data.targets=t.data.targets.filter(n.data_filter)),n.data_hide&&t.addHiddenTargetIds(!0===n.data_hide?t.mapToIds(t.data.targets):n.data_hide),n.legend_hide&&t.addHiddenLegendIds(!0===n.legend_hide?t.mapToIds(t.data.targets):n.legend_hide),t.hasType("gauge")&&(n.legend_show=!1),t.updateSizes(),t.updateScales(),t.x.domain(Hn(t.getXDomain(t.data.targets))),t.y.domain(t.getYDomain(t.data.targets,"y")),t.y2.domain(t.getYDomain(t.data.targets,"y2")),t.subX.domain(t.x.domain()),t.subY.domain(t.y.domain()),t.subY2.domain(t.y2.domain()),t.orgXDomain=t.x.domain(),t.svg=t.selectChart.append("svg").style("overflow","hidden").style("display","block"),n.interaction_enabled&&t.inputType){var o="touch"===t.inputType;t.svg.on(o?"touchstart":"mouseenter",(function(){return Pa(n.onover,t)})).on(o?"touchend":"mouseleave",(function(){return Pa(n.onout,t)}))}n.svg_classname&&t.svg.attr("class",n.svg_classname),t.defs=t.svg.append("defs"),t.clipChart=t.appendClip(t.defs,t.clipId),t.clipXAxis=t.appendClip(t.defs,t.clipIdForXAxis),t.clipYAxis=t.appendClip(t.defs,t.clipIdForYAxis),t.clipGrid=t.appendClip(t.defs,t.clipIdForGrid),t.clipSubchart=t.appendClip(t.defs,t.clipIdForSubchart),ba(n.color_tiles)&&t.patterns&&t.patterns.forEach((function(e){return t.defs.append((function(){return e.node}))})),t.updateSvgSize();var s=t.svg.append("g").attr("transform",t.getTranslate("main"));if(t.main=s,n.subchart_show&&t.initSubchart&&t.initSubchart(),t.initTooltip&&t.initTooltip(),t.initLegend&&t.initLegend(),t.initTitle&&t.initTitle(),s.append("text").attr("class","".concat(ks.text," ").concat(ks.empty)).attr("text-anchor","middle").attr("dominant-baseline","middle"),t.initRegion(),t.initGrid(),n.clipPath||t.axis.init(),s.append("g").attr("class",ks.chart).attr("clip-path",t.clipPath),n.grid_lines_front&&t.initGridLines(),n.grid_front&&t.initXYFocusGrid(),t.initEventRect(),t.initChartElements(),s.insert("rect",n.zoom_privileged?null:"g.".concat(ks.regions)).attr("class",ks.zoomRect).attr("width",t.width).attr("height",t.height).style("opacity","0").on("dblclick.zoom",null),n.axis_x_extent&&t.brush.scale(t.getDefaultExtent()),n.clipPath&&t.axis.init(),t.updateTargets(t.data.targets),t.updateDimension(),n.oninit.call(t),t.redraw({withTransition:!1,withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransitionForAxis:!1,initializing:!0}),n.data_onmin||n.data_onmax){var a=t.getMinMaxData();Pa(n.data_onmin,t,a.min),Pa(n.data_onmax,t,a.max)}t.bindResize(),t.api.element=t.selectChart.node()}},{key:"initChartElements",value:function(){var e=this;["Pie","Bar","Line","Arc","Gauge","Bubble","Radar","Text"].forEach((function(t){var n="init".concat(t);e[n]&&e[n]()}))}},{key:"getChartElements",value:function(){var e=this;return{chart:e.selectChart,svg:e.svg,defs:e.defs,main:e.main,tooltip:e.tooltip,legend:e.legend,title:e.title,grid:e.grid,arc:e.arcs,bar:{bars:e.mainBar},line:{lines:e.mainLine,areas:e.mainArea,circles:e.mainCircle},text:{texts:e.texts}}}},{key:"smoothLines",value:function(e,t){"grid"===t&&e.each((function(){var e=wn(this),t=["x1","x2","y1","y2"].map((function(t){return Math.ceil(e.attr(t))})),n=a()(t,4),i=n[0],o=n[1],s=n[2],r=n[3];e.attr({x1:i,x2:o,y1:s,y2:r})}))}},{key:"updateSizes",value:function(){var e=this,t=e.config,n=t.axis_rotated,i=e.hasArcType(),o=e.legend?e.getLegendHeight():0,s=e.legend?e.getLegendWidth():0,a=e.isLegendRight||e.isLegendInset?0:o,r=n||i?0:e.getHorizontalAxisHeight("x"),l=t.subchart_show&&!i?t.subchart_size_height+r:0;e.currentWidth=e.getCurrentWidth(),e.currentHeight=e.getCurrentHeight(),e.margin=n?{top:e.getHorizontalAxisHeight("y2")+e.getCurrentPaddingTop(),right:i?0:e.getCurrentPaddingRight(),bottom:e.getHorizontalAxisHeight("y")+a+e.getCurrentPaddingBottom(),left:l+(i?0:e.getCurrentPaddingLeft())}:{top:4+e.getCurrentPaddingTop(),right:i?0:e.getCurrentPaddingRight(),bottom:r+l+a+e.getCurrentPaddingBottom(),left:i?0:e.getCurrentPaddingLeft()},e.margin2=n?{top:e.margin.top,right:NaN,bottom:20+a,left:e.rotated_padding_left}:{top:e.currentHeight-l-a,right:NaN,bottom:r+a,left:e.margin.left},e.margin3={top:0,right:NaN,bottom:0,left:0},e.updateSizeForLegend&&e.updateSizeForLegend(o,s),e.width=e.currentWidth-e.margin.left-e.margin.right,e.height=e.currentHeight-e.margin.top-e.margin.bottom,e.width<0&&(e.width=0),e.height<0&&(e.height=0),e.width2=n?e.margin.left-e.rotated_padding_left-e.rotated_padding_right:e.width,e.height2=n?e.height:e.currentHeight-e.margin2.top-e.margin2.bottom,e.width2<0&&(e.width2=0),e.height2<0&&(e.height2=0),e.arcWidth=e.width-(e.isLegendRight?s+10:0),e.arcHeight=e.height-(e.isLegendRight?0:10),e.hasType("gauge")&&!t.gauge_fullCircle&&(e.arcHeight+=e.height-e.getGaugeLabelHeight()),e.updateRadius&&e.updateRadius(),e.isLegendRight&&i&&(e.margin3.left=e.arcWidth/2+1.1*e.radiusExpanded)}},{key:"updateTargets",value:function(e){var t=this;t.updateTargetsForText(e),t.updateTargetsForBar(e),t.updateTargetsForLine(e),t.hasArcType(e)&&(t.hasType("radar")?t.updateTargetsForRadar(e):t.updateTargetsForArc(e)),t.updateTargetsForSubchart&&t.updateTargetsForSubchart(e),t.showTargets()}},{key:"showTargets",value:function(){var e=this;e.svg.selectAll(".".concat(ks.target)).filter((function(t){return e.isTargetToShow(t.id)})).transition().duration(e.config.transition_duration).style("opacity","1")}},{key:"getWithOption",value:function(e){var t={Y:!0,Subchart:!0,Transition:!0,EventRect:!0,Dimension:!0,TrimXDomain:!0,Transform:!1,UpdateXDomain:!1,UpdateOrgXDomain:!1,Legend:!1,UpdateXAxis:"UpdateXDomain",TransitionForExit:"Transition",TransitionForAxis:"Transition"};return Object.keys(t).forEach((function(n){var i=t[n];va(i)&&(i=t[i]),t[n]=Oa(e,"with".concat(n),i)})),t}},{key:"redraw",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,s=this,a=s.main,r=s.config,l=r.axis_rotated,c=s.hasType("radar"),d=s.getShapeIndices(s.isAreaType),u=s.getShapeIndices(s.isBarType),h=s.getShapeIndices(s.isLineType),p=s.hasArcType(),m=s.filterTargetsToShow(s.data.targets),_=s.xv.bind(s),g=s.getWithOption(i),f=g.Transition?r.transition_duration:0,b=g.TransitionForExit?f:0,v=g.TransitionForAxis?f:0,A=o||s.axis.generateTransitions(v);if(i.initializing&&r.tooltip_init_show||"touch"!==s.inputType||s.hideTooltip(),g.Legend&&r.legend_show?s.updateLegend(s.mapToIds(s.data.targets),i,A):g.Dimension&&s.updateDimension(!0),s.isCategorized()&&0===m.length&&s.x.domain([0,s.axes.x.selectAll(".tick").size()]),m.length?(s.updateXDomain(m,g.UpdateXDomain,g.UpdateOrgXDomain,g.TrimXDomain),!r.axis_x_tick_values&&(e=s.axis.updateXAxisTickValues(m))):(s.xAxis.tickValues([]),s.subXAxis.tickValues([])),r.zoom_rescale&&!i.flow&&(n=s.x.orgDomain()),["y","y2"].forEach((function(e){var t=s[e],i=r["axis_".concat(e,"_tick_values")],o=r["axis_".concat(e,"_tick_count")];if(t.domain(s.getYDomain(m,e,n)),!i&&o){var a=t.domain();s["".concat(e,"Axis")].tickValues(s.axis.generateTickValues(a,a.every((function(e){return 0===e}))?1:o,s.isTimeSeriesY()))}})),s.axis.redraw(A,p),s.axis.updateLabels(g.Transition),(g.UpdateXDomain||g.UpdateXAxis)&&m.length)if(r.axis_x_tick_culling&&e){for(var E=1;E<e.length;E++)if(e.length/E<r.axis_x_tick_culling_max){t=E;break}s.svg.selectAll(".".concat(ks.axisX," .tick text")).each((function(n){var i=e.indexOf(n);i>=0&&wn(this).style("display",i%t?"none":"block")}))}else s.svg.selectAll(".".concat(ks.axisX," .tick text")).style("display","block");var T=s.generateDrawArea?s.generateDrawArea(d,!1):void 0,C=s.generateDrawBar?s.generateDrawBar(u):void 0,y=s.generateDrawLine?s.generateDrawLine(h,!1):void 0,M=s.generateXYForText(d,u,h,!0),I=s.generateXYForText(d,u,h,!1);g.Y&&(s.subY.domain(s.getYDomain(m,"y")),s.subY2.domain(s.getYDomain(m,"y2"))),s.updateXgridFocus(),a.select("text.".concat(ks.text,".").concat(ks.empty)).attr("x",s.width/2).attr("y",s.height/2).text(r.data_empty_label_text).transition().style("opacity",m.length?0:1),s.updateGrid(f),s.updateRegion(f),s.updateBar(b),s.updateLine(b),s.updateArea(b),s.updateCircle(),s.hasDataLabel()&&s.updateText(b),s.redrawTitle&&s.redrawTitle(),s.redrawArc&&s.redrawArc(f,b,g.Transform),c&&s.redrawRadar(f,b),r.subchart_show&&s.redrawSubchart&&s.redrawSubchart(g.Subchart,A,f,b,d,u,h),a.selectAll(".".concat(ks.selectedCircles)).filter(s.isBarType.bind(s)).selectAll("circle").remove(),r.interaction_enabled&&!i.flow&&g.EventRect&&(s.redrawEventRect(),s.bindZoomEvent()),s.updateCircleY();var S=(c?s.radarCircleX:l?s.circleY:s.circleX).bind(s),w=(c?s.radarCircleY:l?s.circleX:s.circleY).bind(s),N=i.flow&&s.generateFlow({targets:m,flow:i.flow,duration:i.flow.duration,drawBar:C,drawLine:y,drawArea:T,cx:S,cy:w,xv:_,xForText:M,yForText:I}),D=(f||N)&&s.isTabVisible(),L=[s.redrawBar(C,D),s.redrawLine(y,D),s.redrawArea(T,D),s.redrawCircle(S,w,D,N),s.redrawText(M,I,i.flow,D),s.redrawRegion(D),s.redrawGrid(D)],O=N||r.onrendered?function(){N&&N(),Pa(r.onrendered,s)}:null;if(O)if(D){var P=s.generateWait();Ns().duration(f).each((function(){L.reduce((function(e,t){return e.concat(t)}),[]).forEach((function(e){return P.add(e)}))})).call(P,O)}else O();s.mapToIds(s.data.targets).forEach((function(e){s.withoutFadeIn[e]=!0}))}},{key:"updateAndRedraw",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,i=n.config;t.withTransition=Oa(t,"withTransition",!0),t.withTransform=Oa(t,"withTransform",!1),t.withLegend=Oa(t,"withLegend",!1),t.withUpdateXDomain=!0,t.withUpdateOrgXDomain=!0,t.withTransitionForExit=!1,t.withTransitionForTransform=Oa(t,"withTransitionForTransform",t.withTransition),n.updateSizes(),t.withLegend&&i.legend_show||(e=n.axis.generateTransitions(t.withTransitionForAxis?i.transition_duration:0),n.updateScales(),n.updateSvgSize(),n.transformAll(t.withTransitionForTransform,e)),n.redraw(t,e)}},{key:"redrawWithoutRescale",value:function(){this.redraw({withY:!1,withSubchart:!1,withEventRect:!1,withTransitionForAxis:!1})}},{key:"isTimeSeries",value:function(){return"timeseries"===this.config.axis_x_type}},{key:"isCategorized",value:function(){return this.config.axis_x_type.indexOf("category")>=0||this.hasType("radar")}},{key:"isCustomX",value:function(){var e=this.config;return!this.isTimeSeries()&&(e.data_x||Na(e.data_xs))}},{key:"isTimeSeriesY",value:function(){return"timeseries"===this.config.axis_y_type}},{key:"getTranslate",value:function(e){var t,n,i=this,o=i.config.axis_rotated;if("main"===e)t=Ma(i.margin.left),n=Ma(i.margin.top);else if("context"===e)t=Ma(i.margin2.left),n=Ma(i.margin2.top);else if("legend"===e)t=i.margin3.left,n=i.margin3.top;else if("x"===e)t=0,n=o?0:i.height;else if("y"===e)t=0,n=o?i.height:0;else if("y2"===e)t=o?0:i.width,n=o?1:0;else if("subx"===e)t=0,n=o?0:i.height2;else if("arc"===e)t=i.arcWidth/2,n=i.arcHeight/2;else if("radar"===e){var s=(i.arcWidth-i.arcHeight)/2;t=Math.max(s,0)+4,n=s<0?Math.abs(s):Ma(i.margin.top)}return"translate(".concat(t,", ").concat(n,")")}},{key:"initialOpacity",value:function(e){return null!==this.getBaseValue(e)&&this.withoutFadeIn[e.id]?"1":"0"}},{key:"initialOpacityForCircle",value:function(e){return null!==this.getBaseValue(e)&&this.withoutFadeIn[e.id]?this.opacityForCircle(e):"0"}},{key:"opacityForCircle",value:function(e){var t=this.config.point_show?"1":"0";return fa(this.getBaseValue(e))?this.isBubbleType(e)||this.isScatterType(e)?"0.5":t:"0"}},{key:"opacityForText",value:function(){return this.hasDataLabel()?"1":"0"}},{key:"xx",value:function(e){var t=this.config.zoom_enabled&&this.zoomScale?this.zoomScale:this.x;return e?t(e.x):null}},{key:"xv",value:function(e){var t=this,n=t.getBaseValue(e);return t.isTimeSeries()?n=t.parseDate(n):t.isCategorized()&&va(n)&&(n=t.config.axis_x_categories.indexOf(n)),Math.ceil(t.x(n))}},{key:"yv",value:function(e){var t=e.axis&&"y2"===e.axis?this.y2:this.y;return Math.ceil(t(this.getBaseValue(e)))}},{key:"subxx",value:function(e){return e?this.subX(e.x):null}},{key:"transformMain",value:function(e,t){var n,i,o,s=this;t&&t.axisX?n=t.axisX:(n=s.main.select(".".concat(ks.axisX)),e&&(n=n.transition())),t&&t.axisY?i=t.axisY:(i=s.main.select(".".concat(ks.axisY)),e&&(i=i.transition())),t&&t.axisY2?o=t.axisY2:(o=s.main.select(".".concat(ks.axisY2)),e&&(o=o.transition())),(e?s.main.transition():s.main).attr("transform",s.getTranslate("main")),n.attr("transform",s.getTranslate("x")),i.attr("transform",s.getTranslate("y")),o.attr("transform",s.getTranslate("y2")),s.main.select(".".concat(ks.chartArcs)).attr("transform",s.getTranslate("arc"))}},{key:"transformAll",value:function(e,t){var n=this;n.transformMain(e,t),n.config.subchart_show&&n.transformContext(e,t),n.legend&&n.transformLegend(e)}},{key:"updateSvgSize",value:function(){var e=this,t=e.svg.select(".".concat(ks.brush," .overlay")),n=t.size()?t.attr("height"):0;e.svg.attr("width",e.currentWidth).attr("height",e.currentHeight),e.svg.selectAll(["#".concat(e.clipId),"#".concat(e.clipIdForGrid)]).select("rect").attr("width",e.width).attr("height",e.height),e.svg.select("#".concat(e.clipIdForXAxis)).select("rect").attr("x",e.getXAxisClipX.bind(e)).attr("y",e.getXAxisClipY.bind(e)).attr("width",e.getXAxisClipWidth.bind(e)).attr("height",e.getXAxisClipHeight.bind(e)),e.svg.select("#".concat(e.clipIdForYAxis)).select("rect").attr("x",e.getYAxisClipX.bind(e)).attr("y",e.getYAxisClipY.bind(e)).attr("width",e.getYAxisClipWidth.bind(e)).attr("height",e.getYAxisClipHeight.bind(e)),e.svg.select("#".concat(e.clipIdForSubchart)).select("rect").attr("width",e.width).attr("height",n),e.svg.select(".".concat(ks.zoomRect)).attr("width",e.width).attr("height",e.height),e.brush&&e.brush.scale(e.subX,n)}},{key:"updateDimension",value:function(e){var t=this;e||(t.config.axis_rotated?(t.xAxis.create(t.axes.x),t.subXAxis.create(t.axes.subx)):(t.yAxis.create(t.axes.y),t.y2Axis.create(t.axes.y2))),t.updateSizes(),t.updateScales(e),t.updateSvgSize(),t.transformAll(!1)}},{key:"bindResize",value:function(){var e=this,t=e.config;e.resizeFunction=e.generateResize(),e.resizeFunction.add((function(){return t.onresize.call(e)})),t.resize_auto&&e.resizeFunction.add((function(){e.resizeTimeout&&(window.clearTimeout(e.resizeTimeout),e.resizeTimeout=null),e.resizeTimeout=window.setTimeout(e.api.flush,100)})),e.resizeFunction.add((function(){return t.onresized.call(e)})),window.addEventListener("resize",e.resizeFunction)}},{key:"generateResize",value:function(){function e(){t.forEach((function(e){return e()}))}var t=[];return e.add=function(e){return t.push(e)},e.remove=function(e){return t.splice(t.indexOf(e),1)},e}},{key:"endall",value:function(e,t){var n=0;e.each((function(){return++n})).on("end",(function(){for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];--n||t.apply.apply(t,[this].concat(i))}))}},{key:"generateWait",value:function(){var e=[],t=function(t,n){var i;!function t(){var o=0;e.forEach((function(e){if(e.empty())o++;else try{e.transition()}catch(e){o++}})),i&&clearTimeout(i),o===e.length?n&&n():i=setTimeout(t,50)}()};return t.add=function(t){Da(t)?e=e.concat(t):e.push(t)},t}},{key:"parseDate",value:function(e){var t;return e instanceof Date?t=e:va(e)?t=this.dataTimeFormat(this.config.data_xFormat)(e):Aa(e)&&!isNaN(e)&&(t=new Date(+e)),(!t||isNaN(+t))&&console&&console.error&&console.error("Failed to parse x '".concat(e,"' to Date object")),t}},{key:"isTabVisible",value:function(){return!document[["hidden","mozHidden","msHidden","webkitHidden"].filter((function(e){return e in document}))[0]]}},{key:"convertInputType",value:function(){var e=this.config,t=this.isMobile(),n=e.interaction_inputType_mouse&&!t&&"onmouseover"in window,i=!1;return e.interaction_inputType_touch&&(i="ontouchmove"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),(n?"mouse":i&&"touch")||null}}]),e}(),Br=function e(t){o()(this,e);var n=new kr(this);this.internal=n,n.loadConfig(t),n.beforeInit(t),n.init(),this.$=n.getChartElements(),n.afterInit(t),function e(t,n,i){Object.keys(t).forEach((function(o){n[o]=t[o].bind(i),Object.keys(t[o]).length&&e(t[o],n[o],i)}))}(e.prototype,this,this)},Vr=function e(){return o()(this,e),{bindto:"#chart",clipPath:!0,svg_classname:void 0,size_width:void 0,size_height:void 0,padding_left:void 0,padding_right:void 0,padding_top:void 0,padding_bottom:void 0,resize_auto:!0,zoom_enabled:void 0,zoom_extent:void 0,zoom_privileged:!1,zoom_rescale:!1,zoom_onzoom:void 0,zoom_onzoomstart:void 0,zoom_onzoomend:void 0,zoom_resetButton:!0,zoom_x_min:void 0,zoom_x_max:void 0,interaction_enabled:!0,interaction_brighten:!0,interaction_inputType_mouse:!0,interaction_inputType_touch:{},onover:function(){},onout:function(){},onresize:function(){},onresized:function(){},onbeforeinit:void 0,oninit:function(){},onafterinit:void 0,onrendered:void 0,transition_duration:350,data_x:void 0,data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:!0,data_xSort:!0,data_idConverter:function(e){return e},data_names:{},data_classes:{},data_groups:[],data_axes:{},data_type:void 0,data_types:{},data_labels:{},data_labels_position:{},data_order:"desc",data_regions:{},data_color:void 0,data_colors:{},data_hide:!1,data_filter:void 0,data_stack_normalize:!1,data_selection_enabled:!1,data_selection_grouped:!1,data_selection_isselectable:function(){return!0},data_selection_multiple:!0,data_selection_draggable:!1,data_onclick:function(){},data_onover:function(){},data_onout:function(){},data_onselected:function(){},data_onunselected:function(){},data_onmin:void 0,data_onmax:void 0,data_url:void 0,data_headers:void 0,data_json:void 0,data_rows:void 0,data_columns:void 0,data_mimeType:void 0,data_keys:void 0,data_empty_label_text:"",subchart_show:!1,subchart_size_height:60,subchart_axis_x_show:!0,subchart_onbrush:function(){},color_pattern:[],color_tiles:void 0,color_threshold:{},legend_show:!0,legend_hide:!1,legend_contents_bindto:void 0,legend_contents_template:void 0,legend_position:"bottom",legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:void 0,legend_item_onclick:void 0,legend_item_onover:void 0,legend_item_onout:void 0,legend_equally:!1,legend_padding:0,legend_item_tile_width:10,legend_item_tile_height:10,legend_usePoint:!1,axis_rotated:!1,axis_x_clipPath:!0,axis_x_show:!0,axis_x_type:"indexed",axis_x_localtime:!0,axis_x_categories:[],axis_x_tick_centered:!1,axis_x_tick_format:void 0,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_count:void 0,axis_x_tick_text_position:{x:0,y:0},axis_x_tick_fit:!0,axis_x_tick_values:null,axis_x_tick_rotate:0,axis_x_tick_outer:!0,axis_x_tick_multiline:!0,axis_x_tick_width:null,axis_x_tick_tooltip:!1,axis_x_max:void 0,axis_x_min:void 0,axis_x_padding:{},axis_x_height:void 0,axis_x_extent:void 0,axis_x_label:{},axis_y_clipPath:!0,axis_y_show:!0,axis_y_type:void 0,axis_y_max:void 0,axis_y_min:void 0,axis_y_inverted:!1,axis_y_center:void 0,axis_y_inner:!1,axis_y_label:{},axis_y_tick_format:void 0,axis_y_tick_outer:!0,axis_y_tick_values:null,axis_y_tick_rotate:0,axis_y_tick_count:void 0,axis_y_tick_text_position:{x:0,y:0},axis_y_tick_time_value:void 0,axis_y_padding:{},axis_y_default:void 0,axis_y2_show:!1,axis_y2_max:void 0,axis_y2_min:void 0,axis_y2_inverted:!1,axis_y2_center:void 0,axis_y2_inner:!1,axis_y2_label:{},axis_y2_tick_format:void 0,axis_y2_tick_outer:!0,axis_y2_tick_values:null,axis_y2_tick_count:void 0,axis_y2_tick_text_position:{x:0,y:0},axis_y2_padding:{},axis_y2_default:void 0,grid_x_show:!1,grid_x_type:"tick",grid_x_lines:[],grid_y_show:!1,grid_y_lines:[],grid_y_ticks:10,grid_focus_show:!0,grid_front:!1,grid_lines_front:!0,point_show:!0,point_r:2.5,point_sensitivity:10,point_focus_expand_enabled:!0,point_focus_expand_r:void 0,point_pattern:[],point_select_r:void 0,point_type:"circle",line_connectNull:!1,line_step_type:"step",line_classes:void 0,line_point:!0,bar_padding:0,bar_radius:void 0,bar_radius_ratio:void 0,bar_width:void 0,bar_width_ratio:.6,bar_width_max:void 0,bar_zerobased:!0,bubble_maxR:35,area_zerobased:!0,area_above:!1,pie_label_show:!0,pie_label_format:void 0,pie_label_threshold:.05,pie_label_ratio:void 0,pie_expand:{},pie_expand_duration:50,pie_innerRadius:0,pie_padAngle:0,pie_padding:0,gauge_fullCircle:!1,gauge_label_show:!0,gauge_label_format:void 0,gauge_min:0,gauge_max:100,gauge_startingAngle:-1*Math.PI/2,gauge_label_extents:void 0,gauge_units:void 0,gauge_width:void 0,gauge_expand:{},gauge_expand_duration:50,donut_label_show:!0,donut_label_format:void 0,donut_label_threshold:.05,donut_label_ratio:void 0,donut_width:void 0,donut_title:"",donut_expand:{},donut_expand_duration:50,donut_padAngle:0,spline_interpolation_type:"cardinal",radar_axis_max:void 0,radar_axis_line_show:!0,radar_axis_text_show:!0,radar_level_depth:3,radar_level_show:!0,radar_level_text_format:function(e){return e%1==0?e:e.toFixed(2)},radar_level_text_show:!0,radar_size_ratio:.87,radar_direction_clockwise:!1,regions:[],tooltip_show:!0,tooltip_grouped:!0,tooltip_format_title:void 0,tooltip_format_name:void 0,tooltip_format_value:void 0,tooltip_position:void 0,tooltip_contents:function(e,t,n,i){return this.getTooltipContent?this.getTooltipContent(e,t,n,i):""},tooltip_init_show:!1,tooltip_init_x:0,tooltip_init_position:{top:"0px",left:"50px"},tooltip_linked:!1,tooltip_linked_name:"",tooltip_onshow:function(){},tooltip_onhide:function(){},tooltip_onshown:function(){},tooltip_onhidden:function(){},tooltip_order:null,title_text:void 0,title_padding:{top:0,right:0,bottom:0,left:0},title_position:"top-center"}};Va(kr.prototype,{getOptions:function(){return new Vr},loadConfig:function(e){var t,n,i,o=this.config,s=function(){var e=n.shift();return e&&t&&Sa(t)&&e in t?(t=t[e],s()):e?void 0:t};Object.keys(o).forEach((function(a){t=e,n=a.split("_"),i=s(),Ta(i)&&(o[a]=i)}))}}),Va(kr.prototype,{getScale:function(e,t,n){return(n?Lr(P,L,C,E,v,f,_,p,$).domain([new Date(2e3,0,1),new Date(2e3,0,2)]):Sr()).range([e,t])},getX:function(e,t,n,i){var o=this.zoomScale||this.getScale(e,t,this.isTimeSeries());return this.getCustomizedScale(n?o.domain(n):o,i)},getY:function(e,t,n){var i=this.getScale(e,t,this.isTimeSeriesY());return n&&i.domain(n),i},getCustomizedScale:function(e,t){var n=this,i=t||function(){return n.xAxis.tickOffset()},o=function(t,n){var o=e(t)+i();return n?o:Math.ceil(o)};for(var s in e)o[s]=e[s];return o.orgDomain=function(){return e.domain()},o.orgScale=function(){return e},n.isCategorized()&&(o.domain=function(t){var n=t;return arguments.length?(e.domain(n),o):[(n=this.orgDomain())[0],n[1]+1]}),o},getYScale:function(e){return"y2"===this.axis.getId(e)?this.y2:this.y},getSubYScale:function(e){return"y2"===this.axis.getId(e)?this.subY2:this.subY},updateScales:function(e){var t=this,n=t.config,i=n.axis_rotated,o=!t.x;t.xMin=i?1:0,t.xMax=i?t.height:t.width,t.yMin=i?0:t.height,t.yMax=i?t.width:1,t.subXMin=t.xMin,t.subXMax=t.xMax,t.subYMin=i?0:t.height2,t.subYMax=i?t.width2:1,t.x=t.getX(t.xMin,t.xMax,o?void 0:t.x.orgDomain(),(function(){return t.xAxis.tickOffset()})),t.y=t.getY(t.yMin,t.yMax,o?n.axis_y_default:t.y.domain()),t.y2=t.getY(t.yMin,t.yMax,o?n.axis_y2_default:t.y2.domain()),t.subX=t.getX(t.xMin,t.xMax,t.orgXDomain,(function(e){return e%1?0:t.subXAxis.tickOffset()})),t.subY=t.getY(t.subYMin,t.subYMax,o?n.axis_y_default:t.subY.domain()),t.subY2=t.getY(t.subYMin,t.subYMax,o?n.axis_y2_default:t.subY2.domain()),t.xAxisTickFormat=t.axis.getXAxisTickFormat(),t.xAxisTickValues=t.axis.getXAxisTickValues(),t.yAxisTickValues=t.axis.getYAxisTickValues(),t.y2AxisTickValues=t.axis.getY2AxisTickValues(),t.xAxis=t.axis.getXAxis("x",t.x,t.xOrient,t.xAxisTickFormat,t.xAxisTickValues,n.axis_x_tick_outer,e),t.subXAxis=t.axis.getXAxis("subx",t.subX,t.subXOrient,t.xAxisTickFormat,t.xAxisTickValues,n.axis_x_tick_outer),t.yAxis=t.axis.getYAxis("y",t.y,t.yOrient,n.axis_y_tick_format,t.yAxisTickValues,n.axis_y_tick_outer),t.y2Axis=t.axis.getYAxis("y2",t.y2,t.y2Orient,n.axis_y2_tick_format,t.y2AxisTickValues,n.axis_y2_tick_outer),t.updateArc&&t.updateArc()}}),Va(kr.prototype,{getYDomainMinMax:function(e,t){var n=this,i=n.config,o="min"===t,s=i.data_groups,a=n.mapToIds(e),r=n.getValuesAsIdKeyed(e),l=o?Zn:Jn;return s.length>0&&function(){for(var t,i,l=n["has".concat(o?"Negative":"Positive","ValueInTargets")](e),c=0;i=s[c];c++)if(0!==(i=i.filter((function(e){return a.indexOf(e)>=0}))).length){if(t=i[0],l&&r[t]){var d=o?function(e,n){r[t][n]=e<0?e:0}:function(e,n){r[t][n]=e>0?e:0};r[t].forEach(d)}for(var u,h=function(e,i){return r[i]?void r[i].forEach((function(e,s){var a=+e,c=o?a>0:a<0;n.axis.getId(i)===n.axis.getId(t)&&r[t]&&(!l||!c)&&(r[t][s]+=a)})):"continue"},p=1;u=i[p];p++)h(0,u)}}(),l(Object.keys(r).map((function(e){return l(r[e])})))},getYDomainMin:function(e){return this.getYDomainMinMax(e,"min")},getYDomainMax:function(e){return this.getYDomainMinMax(e,"max")},getYDomain:function(e,t,n){var i=this,o=i.config;if(i.isStackNormalized())return[0,100];var s,a=e.filter((function(e){return i.axis.getId(e.id)===t})),r=n?i.filterByXDomain(a,n):a,l="y2"===t?o.axis_y2_min:o.axis_y_min,c="y2"===t?o.axis_y2_max:o.axis_y_max,d=i.getYDomainMin(r),u=i.getYDomainMax(r),h="y2"===t?o.axis_y2_center:o.axis_y_center,p=i.hasType("bar",r)&&o.bar_zerobased||i.hasType("area",r)&&o.area_zerobased,m="y2"===t?o.axis_y2_inverted:o.axis_y_inverted,_=i.hasDataLabel()&&o.axis_rotated,g=i.hasDataLabel()&&!o.axis_rotated;if(d=fa(l)?l:fa(c)?d<c?d:c-10:d,u=fa(c)?c:fa(l)?l<u?u:l+10:u,0===r.length)return"y2"===t?i.y2.domain():i.y.domain();isNaN(d)&&(d=0),isNaN(u)&&(u=d),d===u&&(d<0?u=0:d=0);var f=d>=0&&u>=0,b=d<=0&&u<=0;(fa(l)&&f||fa(c)&&b)&&(p=!1),p&&(f&&(d=0),b&&(u=0));var v=Math.abs(u-d),A=.1*v,E=.1*v;if(Ta(h)){var T=Math.max(Math.abs(d),Math.abs(u));u=h+T,d=h-T}if(_){s=i.getDataLabelLength(d,u,"width");var C=Ia(i.y.range()),y=[s[0]/C,s[1]/C];A+=v*(y[1]/(1-y[0]-y[1])),E+=v*(y[0]/(1-y[0]-y[1]))}else g&&(s=i.getDataLabelLength(d,u,"height"),A+=i.axis.convertPixelsToAxisPadding(s[1],v),E+=i.axis.convertPixelsToAxisPadding(s[0],v));"y"===t&&Na(o.axis_y_padding)&&(A=i.axis.getPadding(o.axis_y_padding,"top",A,v),E=i.axis.getPadding(o.axis_y_padding,"bottom",E,v)),"y2"===t&&Na(o.axis_y2_padding)&&(A=i.axis.getPadding(o.axis_y2_padding,"top",A,v),E=i.axis.getPadding(o.axis_y2_padding,"bottom",E,v)),p&&(f&&(E=d),b&&(A=-u));var M=[d-E,u+A];return m?M.reverse():M},getXDomainMinMax:function(e,t){var n=this.config["axis_x_".concat(t)],i="min"===t?Zn:Jn;return Ta(n)?this.isTimeSeries()?this.parseDate(n):n:i(e,(function(e){return i(e.values,(function(e){return e.x}))}))},getXDomainMin:function(e){return this.getXDomainMinMax(e,"min")},getXDomainMax:function(e){return this.getXDomainMinMax(e,"max")},getXDomainPadding:function(e){var t,n,i=this.config,o=e[1]-e[0],s=i.axis_x_padding,a=n=this.isCategorized()?0:this.hasType("bar")?(t=this.getMaxDataCount())>1?o/(t-1)/2:.5:.01*o,r=n;return La(s)&&Na(s)?(a=fa(s.left)?s.left:n,r=fa(s.right)?s.right:n):Aa(i.axis_x_padding)&&(a=s,r=s),{left:a,right:r}},getXDomain:function(e){var t=this,n=[t.getXDomainMin(e),t.getXDomainMax(e)],i=n[0],o=n[1],s=t.getXDomainPadding(n),a=0,r=0;return i-o!=0||t.isCategorized()||(t.isTimeSeries()?(i=new Date(.5*i.getTime()),o=new Date(1.5*o.getTime())):(i=0===i?1:.5*i,o=0===o?-1:1.5*o)),(i||0===i)&&(a=t.isTimeSeries()?new Date(i.getTime()-s.left):i-s.left),(o||0===o)&&(r=t.isTimeSeries()?new Date(o.getTime()+s.right):o+s.right),[a,r]},updateXDomain:function(e,t,n,i,o){var s=this,a=s.config.zoom_enabled;if(n&&(s.x.domain(o||Hn(s.getXDomain(e))),s.orgXDomain=s.x.domain(),a&&s.zoom.updateScaleExtent(),s.subX.domain(s.x.domain()),s.brush&&s.brush.scale(s.subX)),t){var r=o||!s.brush||Ba(s)?s.orgXDomain:ka(s).map(s.subX.invert);s.x.domain(r),a&&s.zoom.updateScaleExtent()}return i&&s.x.domain(s.trimXDomain(s.x.orgDomain())),s.x.domain()},trimXDomain:function(e){var t=this.getZoomDomain(),n=t[0],i=t[1];return e[0]<=n&&(e[1]=+e[1]+(n-e[0]),e[0]=n),i<=e[1]&&(e[0]=+e[0]-(e[1]-i),e[1]=i),e}}),Va(kr.prototype,{isX:function(e){var t,n,i,o=this.config,s=o.data_x&&e===o.data_x,a=Na(o.data_xs)&&(t=o.data_xs,n=e,i=!1,Object.keys(t).forEach((function(e){return t[e]===n&&(i=!0)})),i);return s||a},isNotX:function(e){return!this.isX(e)},isStackNormalized:function(){var e=this.config;return e.data_stack_normalize&&e.data_groups.length},isGrouped:function(e){return this.config.data_groups.map((function(t){return t.indexOf(e)>=0}))[0]},getXKey:function(e){var t=this.config;return t.data_x?t.data_x:Na(t.data_xs)?t.data_xs[e]:null},getXValuesOfXKey:function(e,t){var n,i=this;return(t&&Na(t)?i.mapToIds(t):[]).forEach((function(t){i.getXKey(t)===e&&(n=i.data.xs[t])})),n},getIndexByX:function(e){var t=this.filterByX(this.data.targets,e);return t.length?t[0].index:null},getXValue:function(e,t){return e in this.data.xs&&this.data.xs[e]&&fa(this.data.xs[e][t])?this.data.xs[e][t]:t},getOtherTargetXs:function(){var e=Object.keys(this.data.xs);return e.length?this.data.xs[e[0]]:null},getOtherTargetX:function(e){var t=this.getOtherTargetXs();return t&&e<t.length?t[e]:null},addXs:function(e){var t=this;Object.keys(e).forEach((function(n){t.config.data_xs[n]=e[n]}))},hasMultipleX:function(e){return Ja(Object.keys(e).map((function(t){return e[t]}))).size()>1},isMultipleX:function(){return Na(this.config.data_xs)||!this.config.data_xSort||this.hasType("bubble")||this.hasType("scatter")},addName:function(e){var t;return e&&(t=this.config.data_names[e.id],e.name=void 0===t?e.id:t),e},getAllValuesOnIndex:function(e){var t=this;return t.filterTargetsToShow(t.data.targets).map((function(n){return t.addName(t.getValueOnIndex(n.values,e))}))},getValueOnIndex:function(e,t){var n=e.filter((function(e){return e.index===t}));return n.length?n[0]:null},updateTargetX:function(e,t){var n=this;e.forEach((function(e){e.values.forEach((function(i,o){i.x=n.generateTargetX(t[o],e.id,o)})),n.data.xs[e.id]=t}))},updateTargetXs:function(e,t){var n=this;e.forEach((function(e){t[e.id]&&n.updateTargetX([e],t[e.id])}))},generateTargetX:function(e,t,n){var i=this,o=i.isCategorized()?n:e||n;return i.isTimeSeries()?o=e?i.parseDate(e):i.parseDate(i.getXValue(t,n)):i.isCustomX()&&!i.isCategorized()&&(o=fa(e)?+e:i.getXValue(t,n)),o},cloneTarget:function(e){return{id:e.id,id_org:e.id_org,values:e.values.map((function(e){return{x:e.x,value:e.value,id:e.id}}))}},updateXs:function(){var e=this;e.data.targets.length&&(e.xs=[],e.data.targets[0].values.forEach((function(t){e.xs[t.index]=t.x})))},getPrevX:function(e){var t=this.xs[e-1];return Ta(t)?t:null},getNextX:function(e){var t=this.xs[e+1];return Ta(t)?t:null},getBaseValue:function(e){var t=e.value;return t&&this.isAreaRangeType(e)&&(t=this.getAreaRangeData(e,"mid")),t},getMinMaxValue:function(e){var t,n,i=this.getBaseValue.bind(this);return(e||this.data.targets.map((function(e){return e.values}))).forEach((function(e){t=Zn([t,Zn(e,i)]),n=Jn([n,Jn(e,i)])})),{min:t,max:n}},getMinMaxData:function(){var e=this,t=e.getCache("$minMaxData");if(!t){var n=e.data.targets.map((function(e){return e.values})),i=e.getMinMaxValue(n),o=[],s=[];n.forEach((function(t){var n=e.getFilteredDataByValue(t,i.min),a=e.getFilteredDataByValue(t,i.max);n.length&&(o=o.concat(n)),a.length&&(s=s.concat(a))})),e.addCache("$minMaxData",t={min:o,max:s})}return t},getTotalPerIndex:function(){var e=this.getCache("$totalPerIndex");return this.isStackNormalized()&&!e&&(e=[],this.data.targets.forEach((function(t){t.values.forEach((function(t,n){e[n]||(e[n]=0),e[n]+=Aa(t.value)?t.value:0}))}))),e},getTotalDataSum:function(){var e=this.getCache("$totalDataSum");if(!e){var t=0;this.data.targets.map((function(e){return e.values})).forEach((function(e){t+=$n(e,(function(e){return e.value}))})),this.addCache("$totalDataSum",e=t)}return e},getFilteredDataByValue:function(e,t){var n=this;return e.filter((function(e){return n.getBaseValue(e)===t}))},getMaxDataCount:function(){return Jn(this.data.targets,(function(e){return e.values.length}))},getMaxDataCountTarget:function(e){var t,n=e.length,i=0;return n>1?e.forEach((function(e){e.values.length>i&&(t=e,i=e.values.length)})):t=n?e[0]:null,t},mapToIds:function(e){return e.map((function(e){return e.id}))},mapToTargetIds:function(e){return e?Da(e)?e.concat():[e]:this.mapToIds(this.data.targets)},hasTarget:function(e,t){for(var n,i=this.mapToIds(e),o=0;n=i[o];o++)if(n===t)return!0;return!1},isTargetToShow:function(e){return this.hiddenTargetIds.indexOf(e)<0},isLegendToShow:function(e){return this.hiddenLegendIds.indexOf(e)<0},filterTargetsToShow:function(e){var t=this;return e.filter((function(e){return t.isTargetToShow(e.id)}))},mapTargetsToUniqueXs:function(e){var t=Ja(Xn(e.map((function(e){return e.values.map((function(e){return+e.x}))})))).values();return(t=this.isTimeSeries()?t.map((function(e){return new Date(+e)})):t.map((function(e){return+e}))).sort((function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}))},addHiddenTargetIds:function(e){this.hiddenTargetIds=this.hiddenTargetIds.concat(e)},removeHiddenTargetIds:function(e){this.hiddenTargetIds=this.hiddenTargetIds.filter((function(t){return e.indexOf(t)<0}))},addHiddenLegendIds:function(e){this.hiddenLegendIds=this.hiddenLegendIds.concat(e)},removeHiddenLegendIds:function(e){this.hiddenLegendIds=this.hiddenLegendIds.filter((function(t){return e.indexOf(t)<0}))},getValuesAsIdKeyed:function(e){var t={};return e.forEach((function(e){var n=[];e.values.forEach((function(e){var t=e.value;Da(t)?n.push.apply(n,Wa()(t)):La(t)&&"high"in t?n.push.apply(n,Wa()(Object.values(t))):n.push(t)})),t[e.id]=n})),t},checkValueInTargets:function(e,t){for(var n,i=Object.keys(e),o=0;o<i.length;o++){n=e[i[o]].values;for(var s=0;s<n.length;s++)if(t(n[s].value))return!0}return!1},hasNegativeValueInTargets:function(e){return this.checkValueInTargets(e,(function(e){return e<0}))},hasPositiveValueInTargets:function(e){return this.checkValueInTargets(e,(function(e){return e>0}))},_checkOrder:function(e){var t=this.config;return va(t.data_order)&&t.data_order.toLowerCase()===e},isOrderDesc:function(){return this._checkOrder("desc")},isOrderAsc:function(){return this._checkOrder("asc")},orderTargets:function(e){var t=this.config,n=Wa()(e),i=this.isOrderAsc(),o=this.isOrderDesc();return i||o?n.sort((function(e,t){var n=function(e,t){return e+Math.abs(t.value)},o=e.values.reduce(n,0),s=t.values.reduce(n,0);return i?s-o:o-s})):ba(t.data_order)&&n.sort(t.data_order),n},filterByX:function(e,t){return Xn(e.map((function(e){return e.values}))).filter((function(e){return e.x-t==0}))},filterRemoveNull:function(e){var t=this;return e.filter((function(e){return fa(t.getBaseValue(e))}))},filterByXDomain:function(e,t){return e.map((function(e){return{id:e.id,id_org:e.id_org,values:e.values.filter((function(e){return t[0]<=e.x&&e.x<=t[1]}))}}))},hasDataLabel:function(){var e=this.config.data_labels;return Ca(e)&&e||Sa(e)&&Na(e)},getDataLabelLength:function(e,t,n){var i=this,o=[0,0];return i.selectChart.select("svg").selectAll(".dummy").data([e,t]).enter().append("text").text((function(e){return i.dataLabelFormat(e.id)(e)})).each((function(e,t){o[t]=1.3*this.getBoundingClientRect()[n]})).remove(),o},isNoneArc:function(e){return this.hasTarget(this.data.targets,e.id)},isArc:function(e){return"data"in e&&this.hasTarget(this.data.targets,e.data.id)},findSameXOfValues:function(e,t){var n,i=e[t].x,o=[];for(n=t-1;n>=0&&i===e[n].x;n--)o.push(e[n]);for(n=t;n<e.length&&i===e[n].x;n++)o.push(e[n]);return o},findClosestFromTargets:function(e,t){var n=this,i=e.map((function(e){return n.findClosest(e.values,t)}));return n.findClosest(i,t)},findClosest:function(e,t){var n,i=this,o=i.config.point_sensitivity;return e.filter((function(e){return e&&i.isBarType(e.id)})).forEach((function(e){var t=i.main.select(".".concat(ks.bars).concat(i.getTargetSelectorSuffix(e.id)," .").concat(ks.bar,"-").concat(e.index)).node();!n&&i.isWithinBar(t)&&(n=e)})),e.filter((function(e){return e&&!i.isBarType(e.id)})).forEach((function(e){var s=i.dist(e,t);s<o&&(o=s,n=e)})),n},dist:function(e,t){var n=this.config.axis_rotated,i=n?1:0,o=n?0:1,s=this.circleY(e,e.index),a=this.x(e.x);return Math.sqrt(Math.pow(a-t[i],2)+Math.pow(s-t[o],2))},convertValuesToStep:function(e){var t=this.config,n=t.axis_rotated,i=t.line_step_type,o=this.isCategorized(),s=Da(e)?e.concat():[e];if(!n&&!o)return e;var a=s[0].id,r=s[0].x-1,l=s[0].value;return o&&s.unshift({x:r,value:l,id:a}),"step-after"===i&&s.unshift({x:r-1,value:l,id:a}),l=s[(r=s.length)-1].value,o&&s.push({x:r,value:l,id:a}),"step-before"===i&&s.push({x:r+1,value:l,id:a}),s},convertValuesToRange:function(e){var t=Da(e)?e.concat():[e],n=[];return t.forEach((function(e){var t=e.x,i=e.id;n.push({x:t,id:i,value:e.value[0]}),n.push({x:t,id:i,value:e.value[2]})})),n},updateDataAttributes:function(e,t){var n=this.config["data_".concat(e)];return Ea(t)||(Object.keys(t).forEach((function(e){n[e]=t[e]})),this.redraw({withLegend:!0})),n},getAreaRangeData:function(e,t){var n=e.value;if(Da(n)){var i=["high","mid","low"].indexOf(t);return-1===i?null:n[i]}return n[t]},getRatio:function(e,t,n){var i=this,o=i.config,s=i.api,a=0;if(t&&s.data.shown.call(s).length){var r=s.data.values.bind(s);if(a=t.ratio||t.value,"arc"===e)if(i.pie.padAngle()()){var l=i.getTotalDataSum();i.hiddenTargetIds.length&&(l-=$n(r(i.hiddenTargetIds))),a=t.value/l}else a=(t.endAngle-t.startAngle)/(Math.PI*(i.hasType("gauge")&&!o.gauge_fullCircle?1:2));else if("index"===e){var c=this.getTotalPerIndex();if(i.hiddenTargetIds.length){var d=r(i.hiddenTargetIds,!1);d.length&&(d=d.reduce((function(e,t){return e.map((function(e,n){return(Aa(e)?e:0)+t[n]}))})),c=c.map((function(e,t){return e-d[t]})))}t.ratio=Aa(t.value)&&c&&c[t.index]>0?t.value/c[t.index]:0,a=t.ratio}else"radar"===e&&(a=parseFloat(Math.max(t.value,0))/i.maxValue*o.radar_size_ratio)}return n&&a?100*a:a}});var Ur={},Fr={};function Hr(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+"]"})).join(",")+"}")}var zr=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function i(e,t){var i,o=[],s=e.length,a=0,r=0,l=s<=0,c=!1;function d(){if(l)return Fr;if(c)return c=!1,Ur;var t,i,o=a;if(34===e.charCodeAt(o)){for(;a++<s&&34!==e.charCodeAt(a)||34===e.charCodeAt(++a););return(t=a)>=s?l=!0:10===(i=e.charCodeAt(a++))?c=!0:13===i&&(c=!0,10===e.charCodeAt(a)&&++a),e.slice(o+1,t-1).replace(/""/g,'"')}for(;a<s;){if(10===(i=e.charCodeAt(t=a++)))c=!0;else if(13===i)c=!0,10===e.charCodeAt(a)&&++a;else if(i!==n)continue;return e.slice(o,t)}return l=!0,e.slice(o,s)}for(10===e.charCodeAt(s-1)&&--s,13===e.charCodeAt(s-1)&&--s;(i=d())!==Fr;){for(var u=[];i!==Ur&&i!==Fr;)u.push(i),i=d();t&&null==(u=t(u,r++))||o.push(u)}return o}function o(t){return t.map(s).join(e)}function s(e){return null==e?"":t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,o,s=i(e,(function(e,i){if(n)return n(e,i-1);o=e,n=t?function(e,t){var n=Hr(e);return function(i,o){return t(n(i),o,e)}}(e,t):Hr(e)}));return s.columns=o||[],s},parseRows:i,format:function(t,n){return null==n&&(n=function(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var i in e)i in t||n.push(t[i]=i)})),n}(t)),[n.map(s).join(e)].concat(t.map((function(t){return n.map((function(e){return s(t[e])})).join(e)}))).join("\n")},formatRows:function(e){return e.map(o).join("\n")}}},Wr=zr(","),Gr=Wr.parse,Kr=Wr.parseRows,Yr=(Wr.format,Wr.formatRows,zr("\t")),jr=Yr.parse,Qr=Yr.parseRows;Yr.format,Yr.formatRows,Va(kr.prototype,{convertUrlToData:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv",i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,a=new XMLHttpRequest;if(i)for(var r,l=Object.keys(i),c=0;c<l.length;c++)r=l[c],a.setRequestHeader(r,i[r]);a.open("GET",e),a.onreadystatechange=function(){if(4===a.readyState){if(200!==a.status)throw new Error("".concat(e,": Something went wrong loading!"));var i=a.responseText;i&&s.call(t,t["convert".concat(Ua(n),"ToData")]("json"===n?JSON.parse(i):i,o))}},a.send()},_convertCsvTsvToData:function(e,t){var n,i=e.rows(t);return 1===i.length?(n=[{}],i[0].forEach((function(e){n[0][e]=null}))):n=e.parse(t),n},convertCsvToData:function(e){return this._convertCsvTsvToData({rows:Kr,parse:Gr},e)},convertTsvToData:function(e){return this._convertCsvTsvToData({rows:Qr,parse:jr},e)},convertJsonToData:function(e,t){var n,i,o=this,s=this.config,a=[];if(Da(e)){var r=t||s.data_keys;r.x?(n=r.value.concat(r.x),s.data_x=r.x):n=r.value,a.push(n),e.forEach((function(e){var t=[],i=!0,s=!1,r=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var d=l.value,u=o.findValueInJson(e,d);Ea(u)&&(u=null),t.push(u)}}catch(e){s=!0,r=e}finally{try{i||null==c.return||c.return()}finally{if(s)throw r}}a.push(t)})),i=this.convertRowsToData(a)}else Object.keys(e).forEach((function(t){var n=e[t].concat();n.unshift(t),a.push(n)})),i=this.convertColumnsToData(a);return i},findValueInJson:function(e,t){if(void 0!==e[t])return e[t];var n=t.replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split("."),i=e,o=!0,s=!1,a=void 0;try{for(var r,l=n[Symbol.iterator]();!(o=(r=l.next()).done);o=!0){var c=r.value;if(!(c in i)){i=void 0;break}i=i[c]}}catch(e){s=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw a}}return i},convertRowsToData:function(e){for(var t=e[0],n=[],i=1,o=e.length;i<o;i++){for(var s={},a=0,r=e[i].length;a<r;a++){if(Ea(e[i][a]))throw new Error("Source data is missing a component at (".concat(i,", ").concat(a,")!"));s[t[a]]=e[i][a]}n.push(s)}return n},convertColumnsToData:function(e){for(var t=[],n=0,i=e.length;n<i;n++)for(var o=e[n][0],s=1,a=e[n].length;s<a;s++){if(Ea(t[s-1])&&(t[s-1]={}),Ea(e[n][s]))throw new Error("Source data is missing a component at (".concat(n,", ").concat(s,")!"));t[s-1][o]=e[n][s]}return t},convertDataToTargets:function(e,t){var n,i=this,o=this,s=o.config,a=Xa(e[0]).filter(o.isNotX,o),r=Xa(e[0]).filter(o.isX,o);a.forEach((function(a){var l=i.getXKey(a);i.isCustomX()||i.isTimeSeries()?r.indexOf(l)>=0?n=(t&&o.data.xs[a]||[]).concat(e.map((function(e){return e[l]})).filter(fa).map((function(e,t){return o.generateTargetX(e,a,t)}))):s.data_x?n=i.getOtherTargetXs():Na(s.data_xs)&&(n=o.getXValuesOfXKey(l,o.data.targets)):n=e.map((function(e,t){return t})),n&&(i.data.xs[a]=n)})),a.forEach((function(e){if(!n)throw new Error('x is not defined for id = "'.concat(e,'".'))}));var l=a.map((function(t,n){var i=s.data_idConverter(t),a=o.getXKey(t),r=o.isCustomX()&&o.isCategorized(),l=r&&e.map((function(e){return e.x})).every((function(e){return s.axis_x_categories.indexOf(e)>-1}));return{id:i,id_org:t,values:e.map((function(e,c){var d,u=e[a],h=e[t];return h=null===h||isNaN(h)?Da(h)||La(h)&&h.high?h:null:+e[t],r&&0===n&&!Ea(u)?(!l&&0===n&&0===c&&(s.axis_x_categories=[]),-1===(d=s.axis_x_categories.indexOf(u))&&(d=s.axis_x_categories.length,s.axis_x_categories.push(u))):d=o.generateTargetX(u,t,c),(Ea(e[t])||o.data.xs[t].length<=c)&&(d=void 0),{x:d,value:h,id:i}})).filter((function(e){return Ta(e.x)}))}}));return l.forEach((function(e){s.data_xSort&&(e.values=e.values.sort((function(e,t){return(e.x||0===e.x?e.x:1/0)-(t.x||0===t.x?t.x:1/0)}))),e.values.forEach((function(e,t){var n=o.data.targets?o.getIndexByX(e.x):null;e.index=null===n?t:n})),o.data.xs[e.id].sort((function(e,t){return e-t}))})),o.hasNegativeValue=o.hasNegativeValueInTargets(l),o.hasPositiveValue=o.hasPositiveValueInTargets(l),s.data_type&&o.setTargetType(o.mapToIds(l).filter((function(e){return!(e in s.data_types)})),s.data_type),l.forEach((function(e){return o.addCache(e.id_org,e,!0)})),l}}),Va(kr.prototype,{load:function(e,t){var n=this,i=e;i&&(t.filter&&(i=i.filter(t.filter)),(t.type||t.types)&&i.forEach((function(e){var i=t.types&&t.types[e.id]||t.type;n.setTargetType(e.id,i)})),n.data.targets.forEach((function(e){for(var t=0;t<i.length;t++)if(e.id===i[t].id){e.values=i[t].values,i.splice(t,1);break}})),n.data.targets=n.data.targets.concat(i)),n.updateTargets(n.data.targets),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),t.done&&t.done()},loadFromArgs:function(e){var t,n=this;n.resetCache(),e.data?t=e.data:e.url?n.convertUrlToData(e.url,e.mimeType,e.headers,e.keys,(function(t){n.load(n.convertDataToTargets(t),e)})):e.json?t=n.convertJsonToData(e.json,e.keys):e.rows?t=n.convertRowsToData(e.rows):e.columns&&(t=n.convertColumnsToData(e.columns)),n.load(t?n.convertDataToTargets(t):null,e)},unload:function(e,t){var n=this,i=t,o=e;return n.resetCache(),i||(i=function(){}),(o=o.filter((function(e){return n.hasTarget(n.data.targets,e)})))&&0!==o.length?(n.svg.selectAll(o.map((function(e){return n.selectorTarget(e)}))).transition().style("opacity","0").remove().call(n.endall,i),void o.forEach((function(e){n.withoutFadeIn[e]=!1,n.legend&&n.legend.selectAll(".".concat(ks.legendItem).concat(n.getTargetSelectorSuffix(e))).remove(),n.data.targets=n.data.targets.filter((function(t){return t.id!==e}))}))):void i()}}),Va(kr.prototype,{categoryName:function(e){var t=this.config;return e<t.axis_x_categories.length?t.axis_x_categories[e]:e}}),Va(kr.prototype,{initEventRect:function(){this.main.select(".".concat(ks.chart)).append("g").attr("class",ks.eventRects).style("fill-opacity","0")},redrawEventRect:function(){var e,t=this,n=t.config,i=n.zoom_enabled,o=t.isMultipleX(),s=t.main.select(".".concat(ks.eventRects)).style("cursor",!i||!0!==i&&"wheel"!==i.type?null:n.axis_rotate?"ns-resize":"ew-resize").classed(ks.eventRectsMultiple,o).classed(ks.eventRectsSingle,!o);if(s.selectAll(".".concat(ks.eventRect)).remove(),t.eventRect=s.selectAll(".".concat(ks.eventRect)),o)e=t.eventRect.data([0]),e=t.generateEventRectsForMultipleXs(e.enter()).merge(e);else{var a=t.getMaxDataCountTarget(t.data.targets);s.datum(a?a.values:[]),t.eventRect=s.selectAll(".".concat(ks.eventRect)),(e=t.eventRect.data((function(e){return e}))).exit().remove(),e=t.generateEventRectsForSingleX(e.enter()).merge(e)}t.updateEventRect(e),"touch"!==t.inputType||t.svg.on("touchstart.eventRect")||t.hasArcType()||t.bindTouchOnEventRect(o)},bindTouchOnEventRect:function(e){var t,n=this,i=n.config,o=function(){var e=mn.changedTouches[0];return wn(document.elementFromPoint(e.clientX,e.clientY))},s=function(e){var t=e&&e.attr("class")&&1*e.attr("class").replace(new RegExp("(".concat(ks.eventRect,"-?|s)"),"g"),"");return(isNaN(t)||null===t)&&(t=-1),t},a=i.interaction_inputType_touch.preventDefault,r=Ca(a)&&a||!1,l=!isNaN(a)&&a||null;n.svg.on("touchstart.eventRect touchmove.eventRect",(function(){var a=o();if(!a.empty()&&a.classed(ks.eventRect)){if(n.dragging||n.flowing||n.hasArcType())return;(function(e){var n=e.type,o=e.changedTouches[0]["client".concat(i.axis_rotated?"Y":"X")];"touchstart"===n?r?e.preventDefault():null!==l&&(t=o):"touchmove"===n&&(r||!0===t||null!==l&&Math.abs(t-o)>=l)&&(t=!0,e.preventDefault())})(mn),function(t){if(e)n.selectRectForMultipleXs(t);else{var i=o(),a=s(i);n.setOver(a),-1===a?n.unselectRect():n.selectRectForSingle(t,i,a)}}(this)}else n.unselectRect()})).on("touchend.eventRect",(function(){var t=o();if(!t.empty()&&t.classed(ks.eventRect)){if(n.hasArcType()||!n.toggleShape||n.cancelClick)return void(n.cancelClick&&(n.cancelClick=!1));var a=s(t);e||-1===a||n.main.selectAll(".".concat(ks.shape,"-").concat(a)).each((function(e){return i.data_onout.call(n.api,e)}))}}))},updateEventRect:function(e){var t,n,i,o,s=this,a=s.config,r=s.zoomScale||s.x,l=e||s.eventRect.data(),c=a.axis_rotated;if(s.isMultipleX())t=0,n=0,i=s.width,o=s.height;else{var d,u;if(s.isCategorized())d=s.getEventRectWidth(),u=function(e){return r(e.x)-d/2};else{s.updateXs();var h=function(e){var t=e.index;return{prev:s.getPrevX(t),next:s.getNextX(t)}};d=function(e){var t=h(e);return null===t.prev&&null===t.next?c?s.height:s.width:(null===t.prev&&(t.prev=r.domain()[0]),null===t.next&&(t.next=r.domain()[1]),Math.max(0,(r(t.next)-r(t.prev))/2))},u=function(e){var t=h(e),n=s.data.xs[e.id][e.index];return null===t.prev&&null===t.next?0:(null===t.prev&&(t.prev=r.domain()[0]),(r(n)+r(t.prev))/2)}}t=c?0:u,n=c?u:0,i=c?s.width:d,o=c?d:s.height}l.attr("class",s.classEvent.bind(s)).attr("x",t).attr("y",n).attr("width",i).attr("height",o)},selectRectForSingle:function(e,t,n){var i=this,o=i.config,s=o.data_selection_enabled,a=o.data_selection_grouped,r=o.tooltip_grouped,l=i.getAllValuesOnIndex(n);r&&(i.showTooltip(l,e),i.showXGridFocus(l),!s||a)||i.main.selectAll(".".concat(ks.shape,"-").concat(n)).each((function(){wn(this).classed(ks.EXPANDED,!0),s&&t.style("cursor",a?"pointer":null),r||(i.hideXGridFocus(),i.hideTooltip(),!a&&i.expandCirclesBars(n))})).filter((function(e){return i.isWithinShape(this,e)})).call((function(l){var c=l.data();s&&(a||o.data_selection_isselectable(c))&&t.style("cursor","pointer"),r||(i.showTooltip(c,e),i.showXGridFocus(c),i.unexpandCircles(),l.each((function(e){return i.expandCirclesBars(n,e.id)})))}))},expandCirclesBars:function(e,t,n){this.config.point_focus_expand_enabled&&this.expandCircles(e,t,n),this.expandBars(e,t,n)},selectRectForMultipleXs:function(e){var t=this,n=t.config,i=t.filterTargetsToShow(t.data.targets);if(!t.dragging&&!t.hasArcType(i)){var o=Pn(e),s=t.findClosestFromTargets(i,o);if(t.mouseover&&(!s||s.id!==t.mouseover.id)&&(n.data_onout.call(t.api,t.mouseover),t.mouseover=void 0),!s)return void t.unselectRect();var a=(t.isBubbleType(s)||t.isScatterType(s)||!n.tooltip_grouped?[s]:t.filterByX(i,s.x)).map((function(e){return t.addName(e)}));t.showTooltip(a,e),t.expandCirclesBars(s.index,s.id,!0),t.showXGridFocus(a),(t.isBarType(s.id)||t.dist(s,o)<n.point_sensitivity)&&(t.svg.select(".".concat(ks.eventRect)).style("cursor","pointer"),!t.mouseover&&(n.data_onover.call(t.api,s),t.mouseover=s))}},unselectRect:function(){var e=this;e.svg.select(".".concat(ks.eventRect)).style("cursor",null),e.hideXGridFocus(),e.hideTooltip(),e._handleLinkedCharts(!1),e.unexpandCircles(),e.unexpandBars()},setOver:function(e){var t=this,n=t.config;t.expandCirclesBars(e,null,!0),-1!==e&&t.main.selectAll(".".concat(ks.shape,"-").concat(e)).each((function(e){return n.data_onover.call(t.api,e)}))},getDraggableSelection:function(){var e=this,t=e.config;return t.interaction_enabled&&t.data_selection_draggable&&e.drag?qs().on("drag",(function(){e.drag(Pn(this))})).on("start",(function(){e.dragstart(Pn(this))})).on("end",(function(){e.dragend()})):function(){}},generateEventRectsForSingleX:function(e){var t=this,n=t.config,i=e.append("rect").attr("class",t.classEvent.bind(t)).style("cursor",n.data_selection_enabled&&n.data_selection_grouped?"pointer":null).on("click",(function(e){t.clickHandlerForSingleX.bind(this)(e,t)})).call(t.getDraggableSelection());return"mouse"===t.inputType&&i.on("mouseover",(function(e){t.dragging||t.flowing||t.hasArcType()||t.setOver(e.index)})).on("mousemove",(function(e){if(!(t.dragging||t.flowing||t.hasArcType())){var n=e.index,i=t.svg.select(".".concat(ks.eventRect,"-").concat(n));t.isStepType(e)&&"step-after"===t.config.line_step_type&&Pn(this)[0]<t.x(t.getXValue(e.id,n))&&(n-=1),-1===n?t.unselectRect():t.selectRectForSingle(this,i,n)}})).on("mouseout",(function(e){if(t.config&&!t.hasArcType()){var i=e.index;t.unselectRect(),t.main.selectAll(".".concat(ks.shape,"-").concat(i)).each((function(e){return n.data_onout.call(t.api,e)}))}})),i},clickHandlerForSingleX:function(e,t){var n=t,i=n.config;if(n.hasArcType()||!n.toggleShape||n.cancelClick)n.cancelClick&&(n.cancelClick=!1);else{var o=e.index;n.main.selectAll(".".concat(ks.shape,"-").concat(o)).each((function(e){(i.data_selection_grouped||n.isWithinShape(this,e))&&(n.toggleShape(this,e,o),i.data_onclick.call(n.api,e,this))}))}},generateEventRectsForMultipleXs:function(e){var t=this,n=e.append("rect").attr("x",0).attr("y",0).attr("width",t.width).attr("height",t.height).attr("class",ks.eventRect).on("click",(function(){t.clickHandlerForMultipleXS.bind(this)(t)})).call(t.getDraggableSelection());return"mouse"===t.inputType&&n.on("mouseover mousemove",(function(){t.selectRectForMultipleXs(this)})).on("mouseout",(function(){!t.config||t.hasArcType()||t.unselectRect()})),n},clickHandlerForMultipleXS:function(e){var t=e,n=t.config,i=t.filterTargetsToShow(t.data.targets);if(!t.hasArcType(i)){var o=Pn(this),s=t.findClosestFromTargets(i,o);!s||(t.isBarType(s.id)||t.dist(s,o)<n.point_sensitivity)&&t.main.selectAll(".".concat(ks.shapes).concat(t.getTargetSelectorSuffix(s.id))).selectAll(".".concat(ks.shape,"-").concat(s.index)).each((function(){(n.data_selection_grouped||t.isWithinShape(this,s))&&(t.toggleShape(this,s,s.index),n.data_onclick.call(t.api,s,this))}))}},dispatchEvent:function(e,t,n){var i=".".concat(this.isMultipleX()?ks.eventRect:"".concat(ks.eventRect,"-").concat(t)),o=this.main.select(i).node(),s=o.getBoundingClientRect(),a=s.left+(n?n[0]:0)+s.width/2,r=s.top+(n?n[1]:0);Ha[/^(mouse|click)/.test(e)?"mouse":"touch"](o,e,{screenX:a,screenY:r,clientX:a,clientY:r})}}),Va(kr.prototype,{getCurrentWidth:function(){return this.config.size_width||this.getParentWidth()},getCurrentHeight:function(){var e=this.config,t=e.size_height||this.getParentHeight();return t>0?t:320/(this.hasType("gauge")&&!e.gauge_fullCircle?2:1)},getCurrentPaddingTop:function(){var e=this.config,t=fa(e.padding_top)?e.padding_top:0;return this.title&&this.title.node()&&(t+=this.getTitlePadding()),t},getCurrentPaddingBottom:function(){var e=this.config;return fa(e.padding_bottom)?e.padding_bottom:0},getCurrentPaddingLeft:function(e){var t=this.config;return fa(t.padding_left)?t.padding_left:t.axis_rotated?t.axis_x_show?Math.max(ya(this.getAxisWidthByAxisId("x",e)),40):1:!t.axis_y_show||t.axis_y_inner?this.axis.getYAxisLabelPosition().isOuter?30:1:ya(this.getAxisWidthByAxisId("y",e))},getCurrentPaddingRight:function(){var e=this,t=e.config,n=e.isLegendRight?e.getLegendWidth()+20:0;return fa(t.padding_right)?t.padding_right+1:t.axis_rotated?10+n:!t.axis_y2_show||t.axis_y2_inner?2+n+(e.axis.getY2AxisLabelPosition().isOuter?20:0):ya(e.getAxisWidthByAxisId("y2"))+n},getParentRectValue:function(e){for(var t,n="offset".concat(Ua(e)),i=this.selectChart.node();!t&&i&&"BODY"!==i.tagName;){try{t=i.getBoundingClientRect()[e]}catch(e){n in i&&(t=i[n])}i=i.parentNode}if("width"===e){var o=document.body.offsetWidth;t>o&&(t=o)}return t},getParentWidth:function(){return this.getParentRectValue("width")},getParentHeight:function(){var e=this.selectChart.style("height");return e.indexOf("px")>0?+e.replace("px",""):0},getSvgLeft:function(e){var t=this,n=t.config,i=n.axis_rotated||!n.axis_rotated&&!n.axis_y_inner,o=n.axis_rotated?ks.axisX:ks.axisY,s=t.main.select(".".concat(o)).node(),a=s&&i?s.getBoundingClientRect():{right:0},r=t.selectChart.node().getBoundingClientRect(),l=t.hasArcType(),c=a.right-r.left-(l?0:t.getCurrentPaddingLeft(e));return c>0?c:0},getAxisWidthByAxisId:function(e,t){var n=this.axis.getLabelPositionById(e);return this.axis.getMaxTickWidth(e,t)+(n.isInner?20:40)},getHorizontalAxisHeight:function(e){var t=this,n=t.config,i=30;return"x"!==e||n.axis_x_show?"x"===e&&n.axis_x_height?n.axis_x_height:"y"!==e||n.axis_y_show?"y2"!==e||n.axis_y2_show?("x"===e&&!n.axis_rotated&&n.axis_x_tick_rotate&&(i=30+t.axis.getMaxTickWidth(e)*Math.cos(Math.PI*(90-n.axis_x_tick_rotate)/180)),"y"===e&&n.axis_rotated&&n.axis_y_tick_rotate&&(i=30+t.axis.getMaxTickWidth(e)*Math.cos(Math.PI*(90-n.axis_y_tick_rotate)/180)),i+(t.axis.getLabelPositionById(e).isInner?0:10)+("y2"===e?-10:0)):t.rotated_padding_top:!n.legend_show||t.isLegendRight||t.isLegendInset?1:10:8},getEventRectWidth:function(){return Math.max(0,this.xAxis.tickInterval())}});var qr=Math.PI,Jr=2*qr,Xr=Jr-1e-6;function Zr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function $r(){return new Zr}Zr.prototype=$r.prototype={constructor:Zr,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,o,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+o)+","+(this._y1=+s)},arcTo:function(e,t,n,i,o){e=+e,t=+t,n=+n,i=+i,o=+o;var s=this._x1,a=this._y1,r=n-e,l=i-t,c=s-e,d=a-t,u=c*c+d*d;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(u>1e-6)if(Math.abs(d*r-l*c)>1e-6&&o){var h=n-s,p=i-a,m=r*r+l*l,_=h*h+p*p,g=Math.sqrt(m),f=Math.sqrt(u),b=o*Math.tan((qr-Math.acos((m+u-_)/(2*g*f)))/2),v=b/f,A=b/g;Math.abs(v-1)>1e-6&&(this._+="L"+(e+v*c)+","+(t+v*d)),this._+="A"+o+","+o+",0,0,"+ +(d*h>c*p)+","+(this._x1=e+A*r)+","+(this._y1=t+A*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,i,o,s){e=+e,t=+t;var a=(n=+n)*Math.cos(i),r=n*Math.sin(i),l=e+a,c=t+r,d=1^s,u=s?i-o:o-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+l+","+c),n&&(u<0&&(u=u%Jr+Jr),u>Xr?this._+="A"+n+","+n+",0,1,"+d+","+(e-a)+","+(t-r)+"A"+n+","+n+",0,1,"+d+","+(this._x1=l)+","+(this._y1=c):u>1e-6&&(this._+="A"+n+","+n+",0,"+ +(u>=qr)+","+d+","+(this._x1=e+n*Math.cos(o))+","+(this._y1=t+n*Math.sin(o))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var el=$r,tl=function(e){return function(){return e}},nl=Math.abs,il=Math.atan2,ol=Math.cos,sl=Math.max,al=Math.min,rl=Math.sin,ll=Math.sqrt,cl=Math.PI,dl=cl/2,ul=2*cl;function hl(e){return e>1?0:e<-1?cl:Math.acos(e)}function pl(e){return e>=1?dl:e<=-1?-dl:Math.asin(e)}function ml(e){return e.innerRadius}function _l(e){return e.outerRadius}function gl(e){return e.startAngle}function fl(e){return e.endAngle}function bl(e){return e&&e.padAngle}function vl(e,t,n,i,o,s,a,r){var l=n-e,c=i-t,d=a-o,u=r-s,h=(d*(t-s)-u*(e-o))/(u*l-d*c);return[e+h*l,t+h*c]}function Al(e,t,n,i,o,s,a){var r=e-n,l=t-i,c=(a?s:-s)/ll(r*r+l*l),d=c*l,u=-c*r,h=e+d,p=t+u,m=n+d,_=i+u,g=(h+m)/2,f=(p+_)/2,b=m-h,v=_-p,A=b*b+v*v,E=o-s,T=h*_-m*p,C=(v<0?-1:1)*ll(sl(0,E*E*A-T*T)),y=(T*v-b*C)/A,M=(-T*b-v*C)/A,I=(T*v+b*C)/A,S=(-T*b+v*C)/A,w=y-g,N=M-f,D=I-g,L=S-f;return w*w+N*N>D*D+L*L&&(y=I,M=S),{cx:y,cy:M,x01:-d,y01:-u,x11:y*(o/E-1),y11:M*(o/E-1)}}var El=function(){var e=ml,t=_l,n=tl(0),i=null,o=gl,s=fl,a=bl,r=null;function l(){var l,c,d=+e.apply(this,arguments),u=+t.apply(this,arguments),h=o.apply(this,arguments)-dl,p=s.apply(this,arguments)-dl,m=nl(p-h),_=p>h;if(r||(r=l=el()),u<d&&(c=u,u=d,d=c),u>1e-12)if(m>ul-1e-12)r.moveTo(u*ol(h),u*rl(h)),r.arc(0,0,u,h,p,!_),d>1e-12&&(r.moveTo(d*ol(p),d*rl(p)),r.arc(0,0,d,p,h,_));else{var g,f,b=h,v=p,A=h,E=p,T=m,C=m,y=a.apply(this,arguments)/2,M=y>1e-12&&(i?+i.apply(this,arguments):ll(d*d+u*u)),I=al(nl(u-d)/2,+n.apply(this,arguments)),S=I,w=I;if(M>1e-12){var N=pl(M/d*rl(y)),D=pl(M/u*rl(y));(T-=2*N)>1e-12?(A+=N*=_?1:-1,E-=N):(T=0,A=E=(h+p)/2),(C-=2*D)>1e-12?(b+=D*=_?1:-1,v-=D):(C=0,b=v=(h+p)/2)}var L=u*ol(b),O=u*rl(b),P=d*ol(E),x=d*rl(E);if(I>1e-12){var R=u*ol(v),k=u*rl(v),B=d*ol(A),V=d*rl(A);if(m<cl){var U=T>1e-12?vl(L,O,B,V,R,k,P,x):[P,x],F=L-U[0],H=O-U[1],z=R-U[0],W=k-U[1],G=1/rl(hl((F*z+H*W)/(ll(F*F+H*H)*ll(z*z+W*W)))/2),K=ll(U[0]*U[0]+U[1]*U[1]);S=al(I,(d-K)/(G-1)),w=al(I,(u-K)/(G+1))}}C>1e-12?w>1e-12?(g=Al(B,V,L,O,u,w,_),f=Al(R,k,P,x,u,w,_),r.moveTo(g.cx+g.x01,g.cy+g.y01),w<I?r.arc(g.cx,g.cy,w,il(g.y01,g.x01),il(f.y01,f.x01),!_):(r.arc(g.cx,g.cy,w,il(g.y01,g.x01),il(g.y11,g.x11),!_),r.arc(0,0,u,il(g.cy+g.y11,g.cx+g.x11),il(f.cy+f.y11,f.cx+f.x11),!_),r.arc(f.cx,f.cy,w,il(f.y11,f.x11),il(f.y01,f.x01),!_))):(r.moveTo(L,O),r.arc(0,0,u,b,v,!_)):r.moveTo(L,O),d>1e-12&&T>1e-12?S>1e-12?(g=Al(P,x,R,k,d,-S,_),f=Al(L,O,B,V,d,-S,_),r.lineTo(g.cx+g.x01,g.cy+g.y01),S<I?r.arc(g.cx,g.cy,S,il(g.y01,g.x01),il(f.y01,f.x01),!_):(r.arc(g.cx,g.cy,S,il(g.y01,g.x01),il(g.y11,g.x11),!_),r.arc(0,0,d,il(g.cy+g.y11,g.cx+g.x11),il(f.cy+f.y11,f.cx+f.x11),_),r.arc(f.cx,f.cy,S,il(f.y11,f.x11),il(f.y01,f.x01),!_))):r.arc(0,0,d,E,A,_):r.lineTo(P,x)}else r.moveTo(0,0);if(r.closePath(),l)return r=null,l+""||null}return l.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,i=(+o.apply(this,arguments)+ +s.apply(this,arguments))/2-cl/2;return[ol(i)*n,rl(i)*n]},l.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:tl(+t),l):e},l.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:tl(+e),l):t},l.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:tl(+e),l):n},l.padRadius=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:tl(+e),l):i},l.startAngle=function(e){return arguments.length?(o="function"==typeof e?e:tl(+e),l):o},l.endAngle=function(e){return arguments.length?(s="function"==typeof e?e:tl(+e),l):s},l.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:tl(+e),l):a},l.context=function(e){return arguments.length?(r=null==e?null:e,l):r},l};function Tl(e){this._context=e}Tl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var Cl=function(e){return new Tl(e)};function yl(e){return e[0]}function Ml(e){return e[1]}var Il=function(){var e=yl,t=Ml,n=tl(!0),i=null,o=Cl,s=null;function a(a){var r,l,c,d=a.length,u=!1;for(null==i&&(s=o(c=el())),r=0;r<=d;++r)!(r<d&&n(l=a[r],r,a))===u&&((u=!u)?s.lineStart():s.lineEnd()),u&&s.point(+e(l,r,a),+t(l,r,a));if(c)return s=null,c+""||null}return a.x=function(t){return arguments.length?(e="function"==typeof t?t:tl(+t),a):e},a.y=function(e){return arguments.length?(t="function"==typeof e?e:tl(+e),a):t},a.defined=function(e){return arguments.length?(n="function"==typeof e?e:tl(!!e),a):n},a.curve=function(e){return arguments.length?(o=e,null!=i&&(s=o(i)),a):o},a.context=function(e){return arguments.length?(null==e?i=s=null:s=o(i=e),a):i},a},Sl=function(){var e=yl,t=null,n=tl(0),i=Ml,o=tl(!0),s=null,a=Cl,r=null;function l(l){var c,d,u,h,p,m=l.length,_=!1,g=new Array(m),f=new Array(m);for(null==s&&(r=a(p=el())),c=0;c<=m;++c){if(!(c<m&&o(h=l[c],c,l))===_)if(_=!_)d=c,r.areaStart(),r.lineStart();else{for(r.lineEnd(),r.lineStart(),u=c-1;u>=d;--u)r.point(g[u],f[u]);r.lineEnd(),r.areaEnd()}_&&(g[c]=+e(h,c,l),f[c]=+n(h,c,l),r.point(t?+t(h,c,l):g[c],i?+i(h,c,l):f[c]))}if(p)return r=null,p+""||null}function c(){return Il().defined(o).curve(a).context(s)}return l.x=function(n){return arguments.length?(e="function"==typeof n?n:tl(+n),t=null,l):e},l.x0=function(t){return arguments.length?(e="function"==typeof t?t:tl(+t),l):e},l.x1=function(e){return arguments.length?(t=null==e?null:"function"==typeof e?e:tl(+e),l):t},l.y=function(e){return arguments.length?(n="function"==typeof e?e:tl(+e),i=null,l):n},l.y0=function(e){return arguments.length?(n="function"==typeof e?e:tl(+e),l):n},l.y1=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:tl(+e),l):i},l.lineX0=l.lineY0=function(){return c().x(e).y(n)},l.lineY1=function(){return c().x(e).y(i)},l.lineX1=function(){return c().x(t).y(n)},l.defined=function(e){return arguments.length?(o="function"==typeof e?e:tl(!!e),l):o},l.curve=function(e){return arguments.length?(a=e,null!=s&&(r=a(s)),l):a},l.context=function(e){return arguments.length?(null==e?s=r=null:r=a(s=e),l):s},l},wl=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},Nl=function(e){return e};function Dl(e){this._curve=e}function Ll(e){function t(t){return new Dl(e(t))}return t._curve=e,t}Ll(Cl),Dl.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}},Array.prototype.slice,Math.sqrt(1/3);Math.sin(cl/10),Math.sin(7*cl/10);var Ol=(Math.sin(ul/10),Math.cos(ul/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function Pl(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function xl(e){this._context=e}xl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Pl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Pl(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Rl=function(e){return new xl(e)};function kl(e){this._context=e}kl.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Pl(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Bl=function(e){return new kl(e)};function Vl(e){this._context=e}Vl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Pl(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Ul=function(e){return new Vl(e)};function Fl(e,t){this._basis=new xl(e),this._beta=t}Fl.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i,o=e[0],s=t[0],a=e[n]-o,r=t[n]-s,l=-1;++l<=n;)i=l/n,this._basis.point(this._beta*e[l]+(1-this._beta)*(o+i*a),this._beta*t[l]+(1-this._beta)*(s+i*r));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Hl=function e(t){function n(e){return 1===t?new xl(e):new Fl(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function zl(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Wl(e,t){this._context=e,this._k=(1-t)/6}Wl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:zl(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:zl(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Gl=function e(t){function n(e){return new Wl(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Kl(e,t){this._context=e,this._k=(1-t)/6}Kl.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:zl(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Yl=function e(t){function n(e){return new Kl(e,t)}return n.tension=function(t){return e(+t)},n}(0);function jl(e,t){this._context=e,this._k=(1-t)/6}jl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:zl(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ql=function e(t){function n(e){return new jl(e,t)}return n.tension=function(t){return e(+t)},n}(0);function ql(e,t,n){var i=e._x1,o=e._y1,s=e._x2,a=e._y2;if(e._l01_a>1e-12){var r=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*r-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,o=(o*r-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>1e-12){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,d=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*c+e._x1*e._l23_2a-t*e._l12_2a)/d,a=(a*c+e._y1*e._l23_2a-n*e._l12_2a)/d}e._context.bezierCurveTo(i,o,s,a,e._x2,e._y2)}function Jl(e,t){this._context=e,this._alpha=t}Jl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:ql(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Xl=function e(t){function n(e){return t?new Jl(e,t):new Wl(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Zl(e,t){this._context=e,this._alpha=t}Zl.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ql(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var $l=function e(t){function n(e){return t?new Zl(e,t):new Kl(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function ec(e,t){this._context=e,this._alpha=t}ec.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ql(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var tc=function e(t){function n(e){return t?new ec(e,t):new jl(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function nc(e){this._context=e}nc.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};var ic=function(e){return new nc(e)};function oc(e){return e<0?-1:1}function sc(e,t,n){var i=e._x1-e._x0,o=t-e._x1,s=(e._y1-e._y0)/(i||o<0&&-0),a=(n-e._y1)/(o||i<0&&-0),r=(s*o+a*i)/(i+o);return(oc(s)+oc(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(r))||0}function ac(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function rc(e,t,n){var i=e._x0,o=e._y0,s=e._x1,a=e._y1,r=(s-i)/3;e._context.bezierCurveTo(i+r,o+r*t,s-r,a-r*n,s,a)}function lc(e){this._context=e}function cc(e){this._context=new dc(e)}function dc(e){this._context=e}function uc(e){return new lc(e)}function hc(e){return new cc(e)}function pc(e){this._context=e}function mc(e){var t,n,i=e.length-1,o=new Array(i),s=new Array(i),a=new Array(i);for(o[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<i-1;++t)o[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(o[i-1]=2,s[i-1]=7,a[i-1]=8*e[i-1]+e[i],t=1;t<i;++t)n=o[t]/s[t-1],s[t]-=n,a[t]-=n*a[t-1];for(o[i-1]=a[i-1]/s[i-1],t=i-2;t>=0;--t)o[t]=(a[t]-o[t+1])/s[t];for(s[i-1]=(e[i]+o[i-1])/2,t=0;t<i-1;++t)s[t]=2*e[t+1]-o[t+1];return[o,s]}lc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:rc(this,this._t0,ac(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,rc(this,ac(this,n=sc(this,e,t)),n);break;default:rc(this,this._t0,n=sc(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(cc.prototype=Object.create(lc.prototype)).point=function(e,t){lc.prototype.point.call(this,t,e)},dc.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,o,s){this._context.bezierCurveTo(t,e,i,n,s,o)}},pc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var i=mc(e),o=mc(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(i[0][s],o[0][s],i[1][s],o[1][s],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var _c=function(e){return new pc(e)};function gc(e,t){this._context=e,this._t=t}gc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var fc=function(e){return new gc(e,.5)};function bc(e){return new gc(e,0)}function vc(e){return new gc(e,1)}Va(kr.prototype,{getShapeIndices:function(e){var t=this.config,n={},i=0;return this.filterTargetsToShow(this.data.targets.filter(e,this)).forEach((function(e){for(var o,s=0;o=t.data_groups[s];s++)if(!(o.indexOf(e.id)<0))for(var a,r=0;a=o[r];r++)if(a in n){n[e.id]=n[a];break}Ea(n[e.id])&&(n[e.id]=i++)})),n.__max__=i-1,n},getShapeX:function(e,t,n,i){var o=i?this.subX:this.zoomScale||this.x,s=this.config.bar_padding;return function(i){var a=i.id in n?n[i.id]:0,r=i.x||0===i.x?o(i.x)-e*(t/2-a):0;return e&&r&&t>1&&s&&(a&&(r+=s*a),t>2?r-=(t-1)*s/2:2===t&&(r-=s/2)),r}},getShapeY:function(e){var t=this,n=t.isStackNormalized();return function(i){return(e?t.getSubYScale(i.id):t.getYScale(i.id))(n?t.getRatio("index",i,!0):i.value)}},getShapeOffset:function(e,t,n){var i=this,o=i.orderTargets(i.filterTargetsToShow(i.data.targets.filter(e,i))),s=o.map((function(e){return e.id}));return function(e,a){var r=n?i.getSubYScale(e.id):i.getYScale(e.id),l=r(0),c=l,d=a;return o.forEach((function(n){var o=i.isStepType(e)?i.convertValuesToStep(n.values):n.values,a=o.map((function(e){return i.isStackNormalized()?i.getRatio("index",e,!0):e.value}));n.id===e.id||t[n.id]!==t[e.id]||s.indexOf(n.id)<s.indexOf(e.id)&&((Ea(o[d])||+o[d].x!=+e.x)&&(d=-1,o.forEach((function(t,n){(t.x.constructor===Date?+t.x:t.x)===(e.x.constructor===Date?+e.x:e.x)&&(d=n)}))),d in o&&o[d].value*e.value>=0&&(c+=r(a[d])-l))})),c}},isWithinShape:function(e,t){var n,i=this,o=wn(e);return i.isTargetToShow(t.id)?i.hasValidPointType(e.nodeName)?n=i.isStepType(t)?i.isWithinStep(e,i.getYScale(t.id)(t.value)):i.isWithinCircle(e,1.5*i.pointSelectR(t)):"path"===e.nodeName&&(n=!o.classed(ks.bar)||i.isWithinBar(e)):n=!1,n},getInterpolate:function(e){var t=this.getInterpolateType(e);return{basis:Rl,"basis-closed":Bl,"basis-open":Ul,bundle:Hl,cardinal:Gl,"cardinal-closed":Yl,"cardinal-open":Ql,"catmull-rom":Xl,"catmull-rom-closed":$l,"catmull-rom-open":tc,"monotone-x":uc,"monotone-y":hc,natural:_c,"linear-closed":ic,linear:Cl,step:fc,"step-after":vc,"step-before":bc}[t]},getInterpolateType:function(e){var t=this,n=t.config.spline_interpolation_type,i=t.isInterpolationType(n)?n:"cardinal";return t.isSplineType(e)?i:t.isStepType(e)?t.config.line_step_type:"linear"}}),Va(kr.prototype,{initPie:function(){var e=this.config,t=e.pie_padding,n=this.hasType("pie")&&t?.01*t:e["".concat(e.data_type,"_padAngle")]?e["".concat(e.data_type,"_padAngle")]:0;this.pie=function(){var e=Nl,t=wl,n=null,i=tl(0),o=tl(ul),s=tl(0);function a(a){var r,l,c,d,u,h=a.length,p=0,m=new Array(h),_=new Array(h),g=+i.apply(this,arguments),f=Math.min(ul,Math.max(-ul,o.apply(this,arguments)-g)),b=Math.min(Math.abs(f)/h,s.apply(this,arguments)),v=b*(f<0?-1:1);for(r=0;r<h;++r)(u=_[m[r]=r]=+e(a[r],r,a))>0&&(p+=u);for(null!=t?m.sort((function(e,n){return t(_[e],_[n])})):null!=n&&m.sort((function(e,t){return n(a[e],a[t])})),r=0,c=p?(f-h*v)/p:0;r<h;++r,g=d)l=m[r],d=g+((u=_[l])>0?u*c:0)+v,_[l]={data:a[l],index:r,value:u,startAngle:g,endAngle:d,padAngle:b};return _}return a.value=function(t){return arguments.length?(e="function"==typeof t?t:tl(+t),a):e},a.sortValues=function(e){return arguments.length?(t=e,n=null,a):t},a.sort=function(e){return arguments.length?(n=e,t=null,a):n},a.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:tl(+e),a):i},a.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:tl(+e),a):o},a.padAngle=function(e){return arguments.length?(s="function"==typeof e?e:tl(+e),a):s},a}().padAngle(n).value((function(e){return e.values.reduce((function(e,t){return e+t.value}),0)})),e.data_order||this.pie.sort(null)},updateRadius:function(){var e=this,t=e.config,n=t.pie_innerRadius,i=t.pie_padding,o=t.gauge_width||t.donut_width;e.radiusExpanded=Math.min(e.arcWidth,e.arcHeight)/2,e.radius=.95*e.radiusExpanded,e.innerRadiusRatio=o?(e.radius-o)/e.radius:.6;var s=n||(i?i*(e.innerRadiusRatio+.1):0);e.innerRadius=e.hasType("donut")||e.hasType("gauge")?e.radius*e.innerRadiusRatio:s},updateArc:function(){var e=this;e.svgArc=e.getSvgArc(),e.svgArcExpanded=e.getSvgArcExpanded(),e.svgArcExpandedSub=e.getSvgArcExpanded(.98)},updateAngle:function(e){var t,n,i,o,s=this,a=s.config,r=e,l=!1,c=0;return a?(s.pie(s.filterTargetsToShow(s.data.targets)).forEach((function(e){l||e.data.id!==r.data.id||(l=!0,(r=e).index=c),c++})),isNaN(r.startAngle)&&(r.startAngle=0),isNaN(r.endAngle)&&(r.endAngle=r.startAngle),s.isGaugeType(r.data)&&(t=a.gauge_min,n=a.gauge_max,i=Math.PI*(a.gauge_fullCircle?2:1)/(n-t),o=r.value<t?0:r.value<n?r.value-t:n-t,r.startAngle=a.gauge_startingAngle,r.endAngle=r.startAngle+i*o),l?r:null):null},getSvgArc:function(){var e=this,t=El().outerRadius(e.radius).innerRadius(e.innerRadius),n=function(n,i){var o="M 0 0";if("value"in n?n.value>0:n.data){var s=!i&&e.updateAngle(n);i?o=t(n):s&&(o=t(s))}return o};return n.centroid=t.centroid,n},getSvgArcExpanded:function(e){var t=this,n=El().outerRadius(t.radiusExpanded*(e||1)).innerRadius(t.innerRadius);return function(e){var i=t.updateAngle(e);return i?n(i):"M 0 0"}},getArc:function(e,t,n){return n||this.isArcType(e.data)?this.svgArc(e,t):"M 0 0"},transformForArcLabel:function(e){var t=this,n=t.config,i=t.updateAngle(e),o="";if(i&&!t.hasType("gauge")){var s=this.svgArc.centroid(i),a=isNaN(s[0])?0:s[0],r=isNaN(s[1])?0:s[1],l=Math.sqrt(a*a+r*r),c=t.hasType("donut")&&n.donut_label_ratio||t.hasType("pie")&&n.pie_label_ratio;c=c?ba(c)?c(e,t.radius,l):c:t.radius&&(l?(36/t.radius>.375?1.175-36/t.radius:.8)*t.radius/l:0),o="translate(".concat(a*c,",").concat(r*c,")")}return o},convertToArcData:function(e){return this.addName({id:e.data.id,value:e.value,ratio:this.getRatio("arc",e),index:e.index})},textForArcLabel:function(e){var t=this,n=e.node?e.datum():e;if(!t.shouldShowArcLabel())return"";var i=t.updateAngle(n),o=i?i.value:null,s=t.getRatio("arc",i),a=n.data.id;if(!t.hasType("gauge")&&!t.meetsArcLabelThreshold(s))return"";var r=(t.getArcLabelFormat()||t.defaultArcValueFormat)(o,s,a).toString();if(e.node)if(-1===r.indexOf("\n"))e.text(r);else{var l=r.split("\n"),c=l.length-1;l.forEach((function(t,n){e.append("tspan").attr("x",0).attr("dy","".concat(0===n?-c:1,"em")).text(t)}))}return r},textForGaugeMinMax:function(e,t){var n=this.getGaugeLabelExtents();return n?n(e,t):e},expandArc:function(e){var t=this;if(t.transiting)var n=setInterval((function(){t.transiting||(clearInterval(n),t.legend.selectAll(".".concat(ks.legendItemFocused)).size()>0&&t.expandArc(e))}),10);else{var i=t.mapToTargetIds(e);t.svg.selectAll(t.selectorTargets(i,".".concat(ks.chartArc))).each((function(e){if(t.shouldExpand(e.data.id)&&0!==e.value){var n=t.expandDuration(e.data.id);wn(this).selectAll("path").transition().duration(n).attr("d",t.svgArcExpanded).transition().duration(2*n).attr("d",t.svgArcExpandedSub)}}))}},unexpandArc:function(e){var t=this;if(!t.transiting){var n=t.mapToTargetIds(e);t.svg.selectAll(t.selectorTargets(n,".".concat(ks.chartArc))).selectAll("path").transition().duration((function(e){return t.expandDuration(e.data.id)})).attr("d",t.svgArc),t.svg.selectAll("".concat(ks.arc)).style("opacity","1")}},expandDuration:function(e){var t,n=this.config;return this.isDonutType(e)?t="donut":this.isGaugeType(e)?t="gauge":this.isPieType(e)&&(t="pie"),t?n["".concat(t,"_expand_duration")]:50},shouldExpand:function(e){var t=this.config;return this.isDonutType(e)&&t.donut_expand||this.isGaugeType(e)&&t.gauge_expand||this.isPieType(e)&&t.pie_expand},shouldShowArcLabel:function(){var e=this.config,t=!0;return this.hasType("donut")?t=e.donut_label_show:this.hasType("pie")&&(t=e.pie_label_show),t},meetsArcLabelThreshold:function(e){var t=this.config;return e>=(this.hasType("donut")?t.donut_label_threshold:t.pie_label_threshold)},getArcLabelFormat:function(){var e=this.config,t=e.pie_label_format;return this.hasType("gauge")?t=e.gauge_label_format:this.hasType("donut")&&(t=e.donut_label_format),t},getGaugeLabelExtents:function(){return this.config.gauge_label_extents},getArcTitle:function(){return this.hasType("donut")?this.config.donut_title:""},updateTargetsForArc:function(e){var t=this,n=t.main,i=t.classChartArc.bind(t),o=t.classArcs.bind(t),s=t.classFocus.bind(t),a=n.select(".".concat(ks.chartArcs)).selectAll(".".concat(ks.chartArc)).data(t.pie(e)).attr("class",(function(e){return i(e)+s(e.data)})),r=a.enter().append("g").attr("class",i);r.append("g").attr("class",o).merge(a),r.append("text").attr("dy",t.hasType("gauge")?"-.1em":".35em").style("opacity","0").style("text-anchor","middle").style("pointer-events","none")},initArc:function(){this.arcs=this.main.select(".".concat(ks.chart)).append("g").attr("class",ks.chartArcs).attr("transform",this.getTranslate("arc")),this.setArcTitle()},setArcTitle:function(){var e=this.getArcTitle();if(e){var t=e.split("\n"),n=this.arcs.append("text").attr("class",ks.chartArcsTitle).style("text-anchor","middle");if(t.length>1){var i=+n.style("font-size").replace("px",""),o=Math.floor(n.text(".").node().getBBox().height,n.text(""));t.forEach((function(e,t){return n.insert("tspan").text(e).attr("x",0).attr("dy",t?o:0)})),n.attr("y","-".concat(i*(t.length-2)||i/2))}else n.text(e)}},redrawArc:function(e,t,n){var i=this,o=i.config,s=i.main,a=o.interaction_enabled,r=s.selectAll(".".concat(ks.arcs)).selectAll(".".concat(ks.arc)).data(i.arcData.bind(i));r.exit().transition().duration(t).style("opacity","0").remove(),(r=r.enter().append("path").attr("class",i.classArc.bind(i)).style("fill",(function(e){return i.color(e.data)})).style("cursor",(function(e){return a&&(o.data_selection_isselectable(e)?"pointer":null)})).style("opacity","0").each((function(e){i.isGaugeType(e.data)&&(e.startAngle=o.gauge_startingAngle,e.endAngle=o.gauge_startingAngle),this._current=e})).merge(r)).attr("transform",(function(e){return!i.isGaugeType(e.data)&&n?"scale(0)":""})).style("opacity",(function(e){return e===this._current?"0":"1"})).each((function(){i.transiting=!0})).transition().duration(e).attrTween("d",(function(e){var t=i.updateAngle(e);if(!t)return function(){return"M 0 0"};isNaN(this._current.startAngle)&&(this._current.startAngle=0),isNaN(this._current.endAngle)&&(this._current.endAngle=this._current.startAngle);var n=jo(this._current,t);return this._current=n(0),function(t){var o=n(t);return o.data=e.data,i.getArc(o,!0)}})).attr("transform",n?"scale(1)":"").style("fill",(function(e){return i.levelColor?i.levelColor(e.data.values[0].value):i.color(e.data.id)})).style("opacity","1").call(i.endall,(function(){i.transiting=!1})),a&&i.bindArcEvent(r),i.redrawArcText(e)},bindArcEvent:function(e){function t(e,t,n){i.expandArc(n),i.api.focus(n),i.toggleFocusLegend(n,!0),i.showTooltip([t],e)}function n(e){var t=e&&e.id||void 0;i.unexpandArc(t),i.api.revert(),i.revertLegend(),i.hideTooltip()}var i=this,o="touch"===i.inputType,s="mouse"===i.inputType;if(e.on("click",(function(e,t){var n,o=i.updateAngle(e);o&&(n=i.convertToArcData(o),i.toggleShape&&i.toggleShape(this,n,t),i.config.data_onclick.call(i.api,n,this))})),s&&e.on("mouseover",(function(e){if(!i.transiting){var n=i.updateAngle(e),o=n?i.convertToArcData(n):null;t(this,o,o&&o.id||void 0),i.config.data_onover(o,this)}})).on("mouseout",(function(e){if(!i.transiting){var t=i.updateAngle(e),o=t?i.convertToArcData(t):null;n(),i.config.data_onout(o,this)}})).on("mousemove",(function(e){var t=i.updateAngle(e),n=t?i.convertToArcData(t):null;i.showTooltip([n],this)})),o&&i.hasArcType()){var a=function(){var e=mn.changedTouches[0];return wn(document.elementFromPoint(e.clientX,e.clientY))};i.svg.on("touchstart",(function(){if(!i.transiting){var e=a().datum(),o=e&&e.data&&e.data.id?i.updateAngle(e):null,s=o?i.convertToArcData(o):null,r=s&&s.id||void 0;void 0===r?n():t(this,s,r),i.config.data_onover(s,this)}})).on("touchend",(function(){if(!i.transiting){var e=a().datum(),o=e&&e.data&&e.data.id?i.updateAngle(e):null,s=o?i.convertToArcData(o):null,r=s&&s.id||void 0;void 0===r?n():t(this,s,r),i.config.data_onout(s,this)}})).on("touchmove",(function(){var e=a().datum(),o=e&&e.data&&e.data.id?i.updateAngle(e):null,s=o?i.convertToArcData(o):null,r=s&&s.id||void 0;void 0===r?n():t(this,s,r)}))}},redrawArcText:function(e){var t=this,n=t.config,i=t.main,o=i.selectAll(".".concat(ks.chartArc)).select("text").style("opacity","0").attr("class",(function(e){return t.isGaugeType(e.data)?ks.gaugeValue:""}));n.gauge_fullCircle&&o.attr("dy","".concat(Math.round(t.radius/14)));var s=!o.empty()&&o.classed(ks.gaugeValue)?"call":"text";if(o[s](t.textForArcLabel.bind(t)).attr("transform",t.transformForArcLabel.bind(t)).style("font-size",(function(e){return t.isGaugeType(e.data)?"".concat(Math.round(t.radius/5),"px"):""})).transition().duration(e).style("opacity",(function(e){return t.isTargetToShow(e.data.id)&&t.isArcType(e.data)?"1":"0"})),i.select(".".concat(ks.chartArcsTitle)).style("opacity",t.hasType("donut")||t.hasType("gauge")?"1":"0"),t.hasType("gauge")){var a=(n.gauge_fullCircle?-4:-1)*n.gauge_startingAngle;t.arcs.select(".".concat(ks.chartArcsBackground)).attr("d",(function(){var e={data:[{value:n.gauge_max}],startAngle:n.gauge_startingAngle,endAngle:a};return t.getArc(e,!0,!0)})),t.arcs.select(".".concat(ks.chartArcsGaugeUnit)).attr("dy",".75em").text(n.gauge_label_show?n.gauge_units:""),n.gauge_label_show&&(t.arcs.select(".".concat(ks.chartArcsGaugeMin)).attr("dx","".concat(-1*(t.innerRadius+(t.radius-t.innerRadius)/(n.gauge_fullCircle?1:2)),"px")).attr("dy","1.2em").text(t.textForGaugeMinMax(n.gauge_min,!1)),!n.gauge_fullCircle&&t.arcs.select(".".concat(ks.chartArcsGaugeMax)).attr("dx","".concat(t.innerRadius+(t.radius-t.innerRadius)/2,"px")).attr("dy","1.2em").text(t.textForGaugeMinMax(n.gauge_max,!0)))}},initGauge:function(){var e=this.config,t=this.arcs;this.hasType("gauge")&&(t.append("path").attr("class",ks.chartArcsBackground),t.append("text").attr("class",ks.chartArcsGaugeUnit).style("text-anchor","middle").style("pointer-events","none"),e.gauge_label_show&&(t.append("text").attr("class",ks.chartArcsGaugeMin).style("text-anchor","middle").style("pointer-events","none"),!e.gauge_fullCircle&&t.append("text").attr("class",ks.chartArcsGaugeMax).style("text-anchor","middle").style("pointer-events","none")))},getGaugeLabelHeight:function(){return this.config.gauge_label_show?20:0}}),Va(kr.prototype,{initBar:function(){this.main.select(".".concat(ks.chart)).append("g").attr("class",ks.chartBars)},updateTargetsForBar:function(e){var t=this,n=t.config,i=t.classChartBar.bind(t),o=t.classBars.bind(t),s=t.classFocus.bind(t);t.main.select(".".concat(ks.chartBars)).selectAll(".".concat(ks.chartBar)).data(e).attr("class",(function(e){return i(e)+s(e)})).enter().append("g").attr("class",i).style("opacity","0").style("pointer-events","none").append("g").attr("class",o).style("cursor",(function(e){return n.data_selection_isselectable(e)?"pointer":null}))},updateBar:function(e){var t=this,n=t.barData.bind(t),i=t.classBar.bind(t),o=t.initialOpacity.bind(t),s=function(e){return t.color(e.id)};t.mainBar=t.main.selectAll(".".concat(ks.bars)).selectAll(".".concat(ks.bar)).data(n),t.mainBar.exit().transition().duration(e).style("opacity","0").remove(),t.mainBar=t.mainBar.enter().append("path").attr("class",i).style("stroke",s).style("fill",s).merge(t.mainBar).style("opacity",o)},redrawBar:function(e,t){return[(t?this.mainBar.transition(Math.random().toString()):this.mainBar).attr("d",e).style("fill",this.color).style("opacity","1")]},getBarW:function(e,t){var n=this.config,i=Aa(n.bar_width)?n.bar_width:t?e.tickInterval(this.getMaxDataCount())*n.bar_width_ratio/t:0;return n.bar_width_max&&i>n.bar_width_max?n.bar_width_max:i},getBars:function(e,t){var n=fa(e)?"-".concat(e):"";return(t?this.main.selectAll(".".concat(ks.bars).concat(this.getTargetSelectorSuffix(t))):this.main).selectAll(".".concat(ks.bar).concat(n))},expandBars:function(e,t,n){n&&this.unexpandBars(),this.getBars(e,t).classed(ks.EXPANDED,!0)},unexpandBars:function(e){this.getBars(e).classed(ks.EXPANDED,!1)},generateDrawBar:function(e,t){var n=this.config,i=this.generateGetBarPoints(e,t),o=n.axis_rotated,s=n.data_groups.length,a=n.bar_radius,r=n.bar_radius_ratio,l=Aa(a)&&a>0?function(){return a}:Aa(r)?function(e){return e*r}:null;return function(e,t){var n=i(e,t),a=+o,r=+!a,c=e.value<0,d=["",""],u=0;if(l&&!s){var h=o?r:a,p=n[2][h]-n[0][h];u=l(p);var m="a".concat(u,",").concat(u," ").concat(c?"1 0 0":"0 0 1"," ");d[+!o]="".concat(m).concat(u,",").concat(u),d[+o]="".concat(m).concat([-u,u][o?"sort":"reverse"]()),c&&d.reverse()}var _=o?"H".concat(n[1][a]-u," ").concat(d[0],"V").concat(n[2][r]-u," ").concat(d[1],"H").concat(n[3][a]):"V".concat(n[1][r]+(c?-u:u)," ").concat(d[0],"H").concat(n[2][a]-u," ").concat(d[1],"V").concat(n[3][r]);return"M".concat(n[0][a],",").concat(n[0][r]).concat(_,"z")}},generateGetBarPoints:function(e,t){var n=this,i=t?n.subXAxis:n.xAxis,o=e.__max__+1,s=n.getBarW(i,o),a=n.getShapeX(s,o,e,!!t),r=n.getShapeY(!!t),l=n.getShapeOffset(n.isBarType,e,!!t),c=t?n.getSubYScale:n.getYScale;return function(e,t){var i=c.call(n,e.id)(0),o=l(e,t)||i,d=a(e),u=r(e);return n.config.axis_rotated&&(e.value>0&&u<i||e.value<0&&i<u)&&(u=i),[[d,o],[d,u-=i-o],[d+s,u],[d+s,o]]}},isWithinBar:function(e){var t=Pn(e),n=Ra(e),i=a()(n,2),o=i[0],s=i[1],r=Math.min(o.x,s.x),l=Math.min(o.y,s.y),c=e.getBBox(),d=c.width,u=c.height;return r-2<t[0]&&t[0]<r+d+2&&l-2<t[1]&&t[1]<l+u+2}}),Va(kr.prototype,{initBubble:function(){var e=this.config;this.hasType("bubble")&&(e.point_show=!0,e.point_type="circle",e.point_sensitivity=25)},getBaseLength:function(){var e=this.getCache("$baseLength");return e||this.addCache("$baseLength",e=Zn([this.axes.x.select("path").node().getTotalLength(),this.axes.y.select("path").node().getTotalLength()])),e},getBubbleR:function(e){var t=this.config.bubble_maxR;ba(t)?t=t(e):!Aa(t)&&(t=this.getBaseLength()/(2*this.getMaxDataCount())+12);var n=Jn(this.getMinMaxData().max.map((function(e){return La(e.value)?e.value.mid:e.value}))),i=t*t*Math.PI,o=e.value*(i/n);return Math.sqrt(o/Math.PI)}}),Va(kr.prototype,{initLine:function(){this.main.select(".".concat(ks.chart)).append("g").attr("class",ks.chartLines)},updateTargetsForLine:function(e){var t=this,n=t.config,i=t.classChartLine.bind(t),o=t.classLines.bind(t),s=t.classAreas.bind(t),a=t.classCircles.bind(t),r=t.classFocus.bind(t),l=t.main.select(".".concat(ks.chartLines)).selectAll(".".concat(ks.chartLine)).data(e).attr("class",(function(e){return i(e)+r(e)})).enter().append("g").attr("class",i).style("opacity","0").style("pointer-events","none");l.append("g").attr("class",o),l.append("g").attr("class",s),n.point_show&&(n.data_selection_enabled&&l.append("g").attr("class",(function(e){return t.generateClass(ks.selectedCircles,e.id)})),l.append("g").attr("class",a).style("cursor",(function(e){return n.data_selection_isselectable(e)?"pointer":null}))),e.forEach((function(e){t.main.selectAll(".".concat(ks.selectedCircles).concat(t.getTargetSelectorSuffix(e.id))).selectAll("".concat(ks.selectedCircle)).each((function(t){t.value=e.values[t.index].value}))}))},updateLine:function(e){var t=this;t.mainLine=t.main.selectAll(".".concat(ks.lines)).selectAll(".".concat(ks.line)).data(t.lineData.bind(t)),t.mainLine.exit().transition().duration(e).style("opacity","0").remove(),t.mainLine=t.mainLine.enter().append("path").attr("class",(function(e){return"".concat(t.classLine.bind(t)(e)," ").concat(t.extraLineClasses(e)||"")})).style("stroke",t.color).merge(t.mainLine).style("opacity",t.initialOpacity.bind(t)).style("shape-rendering",(function(e){return t.isStepType(e)?"crispEdges":""})).attr("transform",null)},redrawLine:function(e,t){return[(t?this.mainLine.transition(Math.random().toString()):this.mainLine).attr("d",e).style("stroke",this.color).style("opacity","1")]},getCurve:function(e){var t=this;return t.config.axis_rotated&&t.isStepType(e)?function(n){var i=t.getInterpolate(e)(n);return i.orgPoint=i.point,i.pointRotated=function(e,t){1===this._point&&(this._point=2);var n=this._y*(1-this._t)+t*this._t;this._context.lineTo(this._x,n),this._context.lineTo(e,n),this._x=e,this._y=t},i.point=function(e,t){0===this._point?this.orgPoint(e,t):this.pointRotated(e,t)},i}:t.getInterpolate(e)},generateDrawLine:function(e,t){var n=this,i=n.config,o=i.line_connectNull,s=i.axis_rotated,a=n.generateGetLinePoints(e,t),r=t?n.getSubYScale:n.getYScale,l=function(e){return(t?n.subxx:n.xx).call(n,e)},c=function(e,t){return n.isGrouped(e.id)?a(e,t)[0][1]:r.call(n,e.id)(n.getBaseValue(e))},d=Il();return d=s?d.x(c).y(l):d.x(l).y(c),o||(d=d.defined((function(e){return null!==n.getBaseValue(e)}))),function(e){var a,l=t?n.x:n.subX,c=r.call(n,e.id),u=o?n.filterRemoveNull(e.values):e.values,h=0,p=0;return n.isLineType(e)?i.data_regions[e.id]?a=n.lineWithRegions(u,l,c,i.data_regions[e.id]):(n.isStepType(e)&&(u=n.convertValuesToStep(u)),a=d.curve(n.getCurve(e))(u)):(u[0]&&(h=l(u[0].x),p=c(u[0].value)),a=s?"M ".concat(p," ").concat(h):"M ".concat(h," ").concat(p)),a||"M 0 0"}},generateGetLinePoints:function(e,t){var n=this,i=n.config,o=e.__max__+1,s=!!t,a=n.getShapeX(0,o,e,s),r=n.getShapeY(s),l=n.getShapeOffset(n.isLineType,e,s),c=s?n.getSubYScale:n.getYScale;return function(e,t){var o=c.call(n,e.id)(0),s=l(e,t)||o,d=a(e),u=r(e);i.axis_rotated&&(e.value>0&&u<o||e.value<0&&o<u)&&(u=o);var h=[d,u-(o-s)];return[h,h,h,h]}},lineWithRegions:function(e,t,n,i){var o,s,a,r,l=this,c=l.config.axis_rotated,d=l.isTimeSeries(),u=l.isCategorized()?.5:0,h=[],p=function(e,t){for(var n,i=0;n=t[i];i++)if(n.start<e&&e<=n.end)return n.style;return!1};if(Ta(i))for(var m,_=function(e,t){return Ea(e)?t:d?l.parseDate(e):e},g=0;m=i[g];g++){var f=_(m.start,e[0].x),b=_(m.end,e[e.length-1].x),v=m.style||{dasharray:"2 2"};h[g]={start:f,end:b,style:v}}for(var A,E=c?function(e){return n(e.value)}:function(e){return t(e.x)},T=c?function(e){return t(e.x)}:function(e){return n(e.value)},C=function(e){return"M".concat(e[0][0],",").concat(e[0][1],"L").concat(e[1][0],",").concat(e[1][1])},y=d?function(e,i,o,r){var l=e.x.getTime(),d=i.x-e.x,u=new Date(l+d*o),h=new Date(l+d*(o+r)),p=c?[[n(s(o)),t(u)],[n(s(o+a)),t(h)]]:[[t(u),n(s(o))],[t(h),n(s(o+a))]];return C(p)}:function(e,i,a,r){var l=c?[[n(s(a),!0),t(o(a))],[n(s(a+r),!0),t(o(a+r))]]:[[t(o(a),!0),n(s(a))],[t(o(a+r),!0),n(s(a+r))]];return C(l)},M="M",I=0;A=e[I];I++){var S=e[I-1];if(v=p(A.x,h),Ea(h)||!v)M+="".concat(I?"L":"").concat(E(A),",").concat(T(A));else{try{v=v.dasharray.split(" ")}catch(e){v="2 2".split(" ")}o=l.getScale(S.x+u,A.x+u,d),s=l.getScale(S.value,A.value);var w=t(A.x)-t(S.x),N=n(A.value)-n(S.value),D=Math.sqrt(Math.pow(w,2)+Math.pow(N,2));r=(a=v[0]/D)*v[1];for(var L=a;L<=1;L+=r)M+=y(S,A,L,a),L+r>=1&&(M+=y(S,A,1,0))}}return M},updateArea:function(e){var t=this;t.mainArea=t.main.selectAll(".".concat(ks.areas)).selectAll(".".concat(ks.area)).data(t.lineData.bind(t)),t.mainArea.exit().transition().duration(e).style("opacity","0").remove(),t.mainArea=t.mainArea.enter().append("path").attr("class",t.classArea.bind(t)).style("fill",t.color).style("opacity",(function(){return t.orgAreaOpacity=wn(this).style("opacity"),"0"})).merge(t.mainArea),t.mainArea.style("opacity",t.orgAreaOpacity)},redrawArea:function(e,t){var n=this;return[(t?this.mainArea.transition(Math.random().toString()):this.mainArea).attr("d",e).style("fill",this.color).style("opacity",(function(e){return n.isAreaRangeType(e)?n.orgAreaOpacity/1.75:n.orgAreaOpacity}))]},generateDrawArea:function(e,t){var n=this,i=n.config,o=i.line_connectNull,s=i.axis_rotated,a=n.generateGetAreaPoints(e,t),r=t?n.getSubYScale:n.getYScale,l=function(e){return(t?n.subxx:n.xx).call(n,e)},c=function(e,t){return n.isGrouped(e.id)?a(e,t)[0][1]:r.call(n,e.id)(n.isAreaRangeType(e)?n.getAreaRangeData(e,"high"):n.getAreaBaseValue(e.id))},d=function(e,t){return n.isGrouped(e.id)?a(e,t)[1][1]:r.call(n,e.id)(n.isAreaRangeType(e)?n.getAreaRangeData(e,"low"):e.value)};return function(e){var t,a=o?n.filterRemoveNull(e.values):e.values,r=0,u=0;if(n.isAreaType(e)){var h=Sl();h=s?h.y(l).x0(c).x1(d):h.x(l).y0(i.area_above?0:c).y1(d),o||(h=h.defined((function(e){return null!==n.getBaseValue(e)}))),n.isStepType(e)&&(a=n.convertValuesToStep(a)),t=h.curve(n.getCurve(e))(a)}else a[0]&&(r=n.x(a[0].x),u=n.getYScale(e.id)(a[0].value)),t=s?"M ".concat(u," ").concat(r):"M ".concat(r," ").concat(u);return t||"M 0 0"}},getAreaBaseValue:function(){return 0},generateGetAreaPoints:function(e,t){var n=this,i=n.config,o=e.__max__+1,s=n.getShapeX(0,o,e,!!t),a=n.getShapeY(!!t),r=n.getShapeOffset(n.isAreaType,e,!!t),l=t?n.getSubYScale:n.getYScale;return function(e,t){var o=l.call(n,e.id)(0),c=r(e,t)||o,d=s(e),u=a(e);return i.axis_rotated&&(e.value>0&&u<o||e.value<0&&o<u)&&(u=o),[[d,c],[d,u-(o-c)],[d,u-(o-c)],[d,c]]}},updateCircle:function(){var e=this;e.config.point_show&&(e.mainCircle=e.main.selectAll(".".concat(ks.circles)).selectAll(".".concat(ks.circle)).data((function(t){return!e.isBarType(t)&&(!e.isLineType(t)||e.shouldDrawPointsForLine(t))&&e.labelishData(t)})),e.mainCircle.exit().remove(),e.mainCircle=e.mainCircle.enter().append(e.point("create",this,e.classCircle.bind(e),e.pointR.bind(e),e.color)).merge(e.mainCircle).style("stroke",e.color).style("opacity",e.initialOpacityForCircle.bind(e)))},redrawCircle:function(e,t,n,i){var o=this,s=o.main.selectAll(".".concat(ks.selectedCircle));if(!o.config.point_show)return[];var a=[];o.mainCircle.each((function(r){var l=o.point("update",o,e,t,o.opacityForCircle.bind(o),o.color,n,i,s).bind(this)(r);a.push(l)}));var r=o.isCirclePoint()?"c":"";return[a,s.attr("".concat(r,"x"),e).attr("".concat(r,"y"),t)]},circleX:function(e){var t=fa(e.x);return this.config.zoom_enabled&&this.zoomScale?t?this.zoomScale(e.x):null:t?this.x(e.x):null},updateCircleY:function(){var e=this;e.circleY=function(t,n){var i=t.id;return e.isGrouped(i)?e.generateGetLinePoints(e.getShapeIndices(e.isLineType))(t,n)[0][1]:e.getYScale(i)(e.getBaseValue(t))}},getCircles:function(e,t){var n=fa(e)?"-".concat(e):"";return(t?this.main.selectAll(".".concat(ks.circles).concat(this.getTargetSelectorSuffix(t))):this.main).selectAll(".".concat(ks.circle).concat(n))},expandCircles:function(e,t,n){var i=this,o=i.pointExpandedR.bind(i);n&&i.unexpandCircles();var s=i.getCircles(e,t).classed(ks.EXPANDED,!0),a=o(s)/i.config.point_r;i.isCirclePoint()?s.attr("r",o):s.each((function(){var e=wn(this),t=this.getBBox(),n=t.x,i=t.y,s=t.width,r=t.height;"circle"===this.tagName?e.attr("r",o):e.style("transform","translate(".concat((1-a)*(n+.5*s),"px, ").concat((1-a)*(i+.5*r),"px) scale(").concat(a,")"))}))},unexpandCircles:function(e){var t=this,n=t.pointR.bind(t),i=t.getCircles(e).filter((function(){return wn(this).classed(ks.EXPANDED)})).classed(ks.EXPANDED,!1);i.attr("r",n),t.isCirclePoint()||i.style("transform","scale(".concat(n(i)/t.config.point_r,")"))},pointR:function(e){var t=this.config.point_r,n=t;return this.isStepType(e)?n=0:this.isBubbleType(e)?n=this.getBubbleR(e):ba(t)&&(n=t(e)),n},pointExpandedR:function(e){var t=this.config,n=this.isBubbleType(e)?1.15:1.75;return t.point_focus_expand_enabled?t.point_focus_expand_r||this.pointR(e)*n:this.pointR(e)},pointSelectR:function(e){var t=this.config.point_select_r;return ba(t)?t(e):t||4*this.pointR(e)},isWithinCircle:function(e,t){var n=Pn(e),i=wn(e),o=this.isCirclePoint()?"c":"",s=+i.attr("".concat(o,"x")),a=+i.attr("".concat(o,"y"));if(!s&&!a&&1===e.nodeType){var r=e.getBBox?e.getBBox():e.getBoundingClientRect();s=r.x,a=r.y}return Math.sqrt(Math.pow(s-n[0],2)+Math.pow(a-n[1],2))<t},isWithinStep:function(e,t){return Math.abs(t-Pn(e)[1])<30},shouldDrawPointsForLine:function(e){var t=this.config.line_point;return!0===t||Da(t)&&-1!==t.indexOf(e.id)}}),Va(kr.prototype,{hasValidPointType:function(e){return/^(circle|rect(angle)?|polygon|ellipse|use)$/i.test(e||this.config.point_type)},hasValidPointDrawMethods:function(e){var t=e||this.config.point_type;return Sa(t)&&ba(t.create)&&ba(t.update)},insertPointInfoDefs:function(e,t){var n=function(e,t){for(var n,i=e.attributes,o=0;n=i[o];o++)n=n.name,t.setAttribute(n,e.getAttribute(n))},i=(new DOMParser).parseFromString(e,"image/svg+xml").documentElement,o=document.createElementNS(mt.svg,i.nodeName.toLowerCase());if(o.id=t,o.style.fill="inherit",o.style.stroke="inherit",n(i,o),i.childNodes&&i.childNodes.length){var s=wn(o);"innerHTML"in o?s.html(i.innerHTML):Fa(i.childNodes).forEach((function(e){n(e,s.append(e.tagName).node())}))}this.defs.node().appendChild(o)},pointFromDefs:function(e){return this.defs.select("#".concat(e))},generatePoint:function(){var e=this,t=e.config,n=[],i=Na(t.point_pattern)?t.point_pattern:[t.point_type];return function(t,o){for(var s=arguments.length,a=Array(s>2?s-2:0),r=2;r<s;r++)a[r-2]=arguments[r];return function(s){var r,l=s.id||s.data&&s.data.id||s,c=wn(this);if(n.indexOf(l)<0&&n.push(l),r=i[n.indexOf(l)%i.length],e.hasValidPointType(r))r=e[r];else if(!e.hasValidPointDrawMethods(r)){var d="".concat(e.datetimeId,"-point-").concat(l);if(e.pointFromDefs(d).size()<1&&e.insertPointInfoDefs(r,d),"create"===t)return e.custom.create.bind(o).apply(void 0,[c,d].concat(a));if("update"===t)return e.custom.update.bind(o).apply(void 0,[c].concat(a))}return r[t].bind(o).apply(void 0,[c].concat(a))}}},getTransitionName:function(){return Math.random().toString()},custom:{create:function(e,t,n,i,o){return e.append("use").attr("xlink:href","#".concat(t)).attr("class",n).style("fill",o).node()},update:function(e,t,n,i,o,s,a,r){var l=e.node().getBBox(),c=l.width,d=l.height,u=function(e){return t(e)-c/2},h=function(e){return n(e)-d/2},p=e;if(s){var m=this.getTransitionName();a&&(p=e.attr("x",u)),p=e.transition(m).attr("x",u).attr("y",h).transition(m),r.transition(this.getTransitionName())}else p=e.attr("x",u).attr("y",h);return p.style("opacity",i).style("fill",o)}},circle:{create:function(e,t,n,i){return e.append("circle").attr("class",t).attr("r",n).style("fill",i).node()},update:function(e,t,n,i,o,s,a,r){var l=this,c=e;if(l.hasType("bubble")&&(c=c.attr("r",l.pointR.bind(l))),s){var d=l.getTransitionName();a&&(c=c.attr("cx",t)),c=e.attr("cx")?c.transition(d).attr("cx",t).attr("cy",n).transition(d):c.attr("cx",t).attr("cy",n),r.transition(l.getTransitionName())}else c=c.attr("cx",t).attr("cy",n);return c.style("opacity",i).style("fill",o)}},rectangle:{create:function(e,t,n,i){var o=function(e){return 2*n(e)};return e.append("rect").attr("class",t).attr("width",o).attr("height",o).style("fill",i).node()},update:function(e,t,n,i,o,s,a,r){var l=this.config.point_r,c=function(e){return t(e)-l},d=function(e){return n(e)-l},u=e;if(s){var h=this.getTransitionName();a&&(u=u.attr("x",c)),u=u.transition(h).attr("x",c).attr("y",d).transition(h),r.transition(this.getTransitionName())}else u=u.attr("x",c).attr("y",d);return u.style("opacity",i).style("fill",o)}}}),Va(kr.prototype,{initRadar:function(){var e=this,t=e.config;e.hasType("radar")&&(e.radars=e.main.select(".".concat(ks.chart)).append("g").attr("class",ks.chartRadars),e.radars.levels=e.radars.append("g").attr("class",ks.levels),e.radars.axes=e.radars.append("g").attr("class",ks.axis),e.radars.shapes=e.radars.append("g").attr("class",ks.shapes),e.maxValue=t.radar_axis_max||e.getMinMaxData().max[0].value)},getRadarSize:function(){var e=this.config.axis_x_categories.length<4?-20:10,t=(Math.min(this.arcWidth,this.arcHeight)-e)/2;return[t,t]},updateTargetsForRadar:function(e){var t=this.config;wa(t.axis_x_categories)&&(t.axis_x_categories=Wn(0,Jn(e).values.length)),this.generateRadarPoints()},getRadarPosition:function(e,t,n,i){var o=this.config,s=this.getRadarSize(),r=a()(s,2),l=r[0],c=r[1],d=o.axis_x_categories.length,u=o.radar_direction_clockwise,h=Fa(e).map((function(s){return function(e,t,n,i,o,s){var a=e&&i>0?n-i:i,r=2*Math.PI;return o*(1-s*("x"===t?Math.sin:Math.cos)(a*r/n))}(u,s,d,t,Ta(n)?n:"x"===e?l:c,i||o.radar_size_ratio)}));return 1===h.length?h[0]:h},generateRadarPoints:function(){var e=this,t=e.data.targets,n=e.getRadarSize(),i=a()(n,2),o=i[0],s=i[1],r=e.getCache("$radarPoints")||{},l=r._size;l&&(l.width===o||l.height===s)||(t.forEach((function(t){r[t.id]=t.values.map((function(t,n){return e.getRadarPosition(["x","y"],n,void 0,e.getRatio("radar",t))}))})),r._size={width:o,height:s},e.addCache("$radarPoints",r))},redrawRadar:function(e,t){var n=this,i=n.getTranslate("radar");i&&(n.radars.attr("transform",i),n.main.selectAll(".".concat(ks.circles)).attr("transform",i),n.main.select(".".concat(ks.chartTexts)).attr("transform",i),n.generateRadarPoints(),n.updateRadarLevel(),n.updateRadarAxes(),n.updateRadarShape(e,t))},generateGetRadarPoints:function(){var e=this.getCache("$radarPoints");return function(t,n){var i=e[t.id][n];return[i,i,i,i]}},updateRadarLevel:function(){var e=this,t=e.config,n=e.getRadarSize(),i=a()(n,2),o=i[0],s=i[1],r=t.radar_level_depth,l=t.axis_x_categories.length,c=t.radar_level_text_show,d=e.radars.levels,u=Wn(0,r),h=t.radar_size_ratio*Math.min(o,s),p=u.map((function(e){return h*((e+1)/r)})),m=t.radar_level_text_format,_=u.map((function(t){var n=p[t];return Wn(0,l).map((function(t){return e.getRadarPosition(["x","y"],t,n,1).join(",")})).join(" ")})),g=d.selectAll(".".concat(ks.level)).data(u);g.exit().remove();var f=g.enter().append("g").attr("class",(function(e,t){return"".concat(ks.level," ").concat(ks.level,"-").concat(t)}));f.append("polygon").style("visibility",t.radar_level_show?null:"hidden"),c&&(d.select("text").empty()&&d.append("text").attr("dx","-.5em").attr("dy","-.7em").style("text-anchor","end").text((function(){return m(0)})),f.append("text").attr("dx","-.5em").style("text-anchor","end").text((function(t){return m(e.maxValue/u.length*(t+1))}))),f.merge(g).attr("transform",(function(e){return"translate(".concat(o-p[e],", ").concat(s-p[e],")")})).selectAll("polygon").attr("points",(function(e){return _[e]})),c&&d.selectAll("text").attr("x",(function(e){return Ea(e)?o:_[e].split(",")[0]})).attr("y",(function(e){return Ea(e)?s:0}))},updateRadarAxes:function(){var e=this,t=e.config,n=e.getRadarSize(),i=a()(n,2),o=i[0],s=i[1],r=t.axis_x_categories,l=e.radars.axes.selectAll("g").data(r);l.exit().remove();var c=l.enter().append("g").attr("class",(function(e,t){return"".concat(ks.axis,"-").concat(t)}));t.radar_axis_line_show&&c.append("line"),t.radar_axis_text_show&&c.append("text"),l=c.merge(l),t.radar_axis_line_show&&l.select("line").attr("x1",o).attr("y1",s).attr("x2",(function(t,n){return e.getRadarPosition("x",n)})).attr("y2",(function(t,n){return e.getRadarPosition("y",n)})),t.radar_axis_text_show&&l.select("text").style("text-anchor","middle").attr("dy",".5em").text((function(e){return e})).datum((function(e,t){return{index:t}})).attr("x",(function(t,n){return e.getRadarPosition("x",n,void 0,1)})).attr("y",(function(t,n){return e.getRadarPosition("y",n,void 0,1)})),e.bindEvent()},bindEvent:function(){var e=this,t=this;if(t.config.interaction_enabled){var n="mouse"===t.inputType;t.radars.select(".".concat(ks.axis)).on("".concat(n?"mouseover ":"","click"),(function(){if(!t.transiting){var e=wn(mn.target).datum().index;t.selectRectForSingle(t.svg.node(),null,e),t.setOver(e)}})).on("mouseout",n?function(){e.hideTooltip(),e.unexpandCircles()}:null)}},updateRadarShape:function(e,t){var n=this,i=n.data.targets,o=n.getCache("$radarPoints"),s=n.radars.shapes.selectAll("polygon").data(i),a=s.enter().append("g").attr("class",n.classChartRadar.bind(n));s.exit().transition().duration(t).remove(),a.append("polygon").merge(s).transition().duration(e).style("fill",(function(e){return n.color(e)})).style("stroke",(function(e){return n.color(e)})).attr("points",(function(e){return o[e.id].join(" ")}))},radarCircleX:function(e){return this.getCache("$radarPoints")[e.id][e.index][0]},radarCircleY:function(e){return this.getCache("$radarPoints")[e.id][e.index][1]}}),Va(kr.prototype,{initText:function(){this.main.select(".".concat(ks.chart)).append("g").attr("class",ks.chartTexts),this.mainText=xn([])},updateTargetsForText:function(e){var t=this,n=t.classChartText.bind(t),i=t.classTexts.bind(t),o=t.classFocus.bind(t);t.main.select(".".concat(ks.chartTexts)).selectAll(".".concat(ks.chartText)).data(e).attr("class",(function(e){return n(e)+o(e)})).enter().append("g").attr("class",n).style("opacity","0").style("pointer-events","none").append("g").attr("class",i)},updateText:function(e){var t=this,n=this,i=n.config,o=n.labelishData.bind(n),s=n.classText.bind(n);n.mainText=n.main.selectAll(".".concat(ks.texts)).selectAll(".".concat(ks.text)).data((function(e){return t.isRadarType(e)?e.values:o(e)})),n.mainText.exit().transition().duration(e).style("fill-opacity","0").remove(),n.mainText=n.mainText.enter().append("text").merge(n.mainText).attr("class",s).attr("text-anchor",(function(e){return i.axis_rotated?e.value<0?"end":"start":"middle"})).style("stroke","none").style("fill",(function(e){return n.color(e)})).style("fill-opacity","0").text((function(e,t,i){return n.dataLabelFormat(e.id)(e.value,e.id,t,i)}))},redrawText:function(e,t,n,i){return[(i?this.mainText.transition():this.mainText).attr("x",e).attr("y",t).style("fill",this.color).style("fill-opacity",n?0:this.opacityForText.bind(this))]},getTextRect:function(e,t,n){var i,o=(e.node?e.node():e).textContent,s=n.node?n.node():n,a=wn("body").append("div").classed("bb",!0),r=a.append("svg").style("visibility","hidden").style("position","fixed").style("top","0px").style("left","0px"),l=wn(s).style("font");return r.selectAll(".dummy").data([o]).enter().append("text").classed(t,!!t).style("font",l).text(o).each((function(){i=this.getBoundingClientRect()})),a.remove(),i},generateXYForText:function(e,t,n,i){var o=this,s=o.generateGetAreaPoints(e,!1),a=o.generateGetBarPoints(t,!1),r=o.generateGetLinePoints(n,!1),l=o.generateGetRadarPoints(),c=i?o.getXForText:o.getYForText;return function(e,t){var n=o.isAreaType(e)&&s||o.isBarType(e)&&a||o.isRadarType(e)&&l||r;return c.call(o,n(e,t),e,this)}},getXForText:function(e,t,n){var i,o,s=this,a=s.config;return a.axis_rotated?(o=s.isBarType(t)?4:6,i=e[2][1]+o*(t.value<0?-1:1)):i=s.hasType("bar")?(e[2][0]+e[0][0])/2:e[0][0],null===t.value&&(i>s.width?i=s.width-n.getBoundingClientRect().width:i<0&&(i=4)),i+(a.data_labels_position.x||0)},getYForText:function(e,t,n){var i,o=this,s=o.config,a=s.point_r,r=3;if(s.axis_rotated)i=(e[0][0]+e[2][0]+.6*n.getBoundingClientRect().height)/2;else if(i=e[2][1],Aa(a)&&a>5&&(o.isLineType(t)||o.isScatterType(t))&&(r+=s.point_r/2.3),t.value<0||0===t.value&&!o.hasPositiveValue)i+=n.getBoundingClientRect().height,o.isBarType(t)&&o.isSafari()?i-=r:!o.isBarType(t)&&o.isChrome()&&(i+=r);else{var l=2*-r;o.isBarType(t)?l=-r:o.isBubbleType(t)&&(l=r),i+=l}if(null===t.value&&!s.axis_rotated){var c=n.getBoundingClientRect().height;i<c?i=c:i>this.height&&(i=this.height-4)}return i+(s.data_labels_position.y||0)}}),Va(kr.prototype,{setTargetType:function(e,t){var n=this,i=n.config;n.mapToTargetIds(e).forEach((function(e){n.withoutFadeIn[e]=t===i.data_types[e],i.data_types[e]=t})),e||(i.data_type=t)},hasType:function(e,t){var n=this.config.data_types,i=t||this.data.targets,o=!1;return i&&i.length?i.forEach((function(t){var i=n[t.id];(i&&i.indexOf(e)>=0||!i&&"line"===e)&&(o=!0)})):Object.keys(n).length?Object.keys(n).forEach((function(t){n[t]===e&&(o=!0)})):o=this.config.data_type===e,o},hasArcType:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=["pie","donut","gauge","radar"].filter((function(e){return-1===n.indexOf(e)}));return!i.every((function(n){return!t.hasType(n,e)}))},isLineType:function(e){var t=va(e)?e:e.id;return!this.config.data_types[t]||this.isTypeOf(t,["line","spline","area","area-spline","area-spline-range","area-line-range","step","area-step"])},isTypeOf:function(e,t){var n=va(e)?e:e.id,i=this.config.data_types[n];return Da(t)?t.indexOf(i)>=0:i===t},isStepType:function(e){return this.isTypeOf(e,["step","area-step"])},isSplineType:function(e){return this.isTypeOf(e,["spline","area-spline","area-spline-range"])},isAreaType:function(e){return this.isTypeOf(e,["area","area-spline","area-spline-range","area-line-range","area-step"])},isAreaRangeType:function(e){return this.isTypeOf(e,["area-spline-range","area-line-range"])},isBarType:function(e){return this.isTypeOf(e,"bar")},isBubbleType:function(e){return this.isTypeOf(e,"bubble")},isScatterType:function(e){return this.isTypeOf(e,"scatter")},isPieType:function(e){return this.isTypeOf(e,"pie")},isGaugeType:function(e){return this.isTypeOf(e,"gauge")},isDonutType:function(e){return this.isTypeOf(e,"donut")},isRadarType:function(e){return this.isTypeOf(e,"radar")},isArcType:function(e){return this.isPieType(e)||this.isDonutType(e)||this.isGaugeType(e)||this.isRadarType(e)},isCirclePoint:function(){var e=this.config,t=e.point_pattern;return"circle"===e.point_type&&(!t||Da(t)&&0===t.length)},lineData:function(e){return this.isLineType(e)?[e]:[]},arcData:function(e){return this.isArcType(e.data)?[e]:[]},barData:function(e){return this.isBarType(e)?e.values:[]},labelishData:function(e){return this.isBarType(e)||this.isLineType(e)||this.isScatterType(e)||this.isBubbleType(e)||this.isRadarType(e)?e.values:[]},barLineBubbleData:function(e){return this.isBarType(e)||this.isLineType(e)||this.isBubbleType(e)?e.values:[]},isInterpolationType:function(e){return["basis","basis-closed","basis-open","bundle","cardinal","cardinal-closed","cardinal-open","catmull-rom","catmull-rom-closed","catmull-rom-open","linear","linear-closed","monotone-x","monotone-y","natural"].indexOf(e)>=0}});var Ac=function(e){return fa(e.position)||"end"},Ec=function(e){return"start"===e.position?4:"middle"===e.position?0:-4},Tc=function(e,t,n){return function(i){var o=e?0:t;return"start"===i.position?o=e?-n:0:"middle"===i.position&&(o=(e?-n:t)/2),o}};Va(kr.prototype,{initGrid:function(){var e=this.config;this.xgrid=xn([]),e.grid_lines_front||this.initGridLines(),e.grid_front||this.initXYFocusGrid()},initGridLines:function(){var e=this;e.gridLines=e.main.append("g").attr("clip-path",e.clipPathForGrid).attr("class","".concat(ks.grid," ").concat(ks.gridLines)),e.gridLines.append("g").attr("class",ks.xgridLines),e.gridLines.append("g").attr("class",ks.ygridLines),e.xgridLines=xn([])},updateXGrid:function(e){var t=this,n=t.config,i=n.axis_rotated,o=t.generateGridData(n.grid_x_type,t.x),s=t.isCategorized()?t.xAxis.tickOffset():0;t.xgridAttr=i?{x1:0,x2:t.width,y1:function(e){return t.x(e)-s},y2:function(e){return t.x(e)-s}}:{x1:function(e){return t.x(e)+s},x2:function(e){return t.x(e)+s},y1:0,y2:t.height},t.xgrid=t.main.select(".".concat(ks.xgrids)).selectAll(".".concat(ks.xgrid)).data(o),t.xgrid.exit().remove(),t.xgrid=t.xgrid.enter().append("line").attr("class",ks.xgrid).merge(t.xgrid),e||t.xgrid.each((function(){var e=wn(this);Object.keys(t.xgridAttr).forEach((function(n){e.attr(n,t.xgridAttr[n]).style("opacity",(function(){return e.attr(i?"y1":"x1")===(i?t.height:0)?"0":"1"}))}))}))},updateYGrid:function(){var e=this,t=e.config,n=t.axis_rotated,i=e.yAxis.tickValues()||e.y.ticks(t.grid_y_ticks);e.ygrid=e.main.select(".".concat(ks.ygrids)).selectAll(".".concat(ks.ygrid)).data(i),e.ygrid.exit().remove(),e.ygrid=e.ygrid.enter().append("line").attr("class",ks.ygrid).merge(e.ygrid),e.ygrid.attr("x1",n?e.y:0).attr("x2",n?e.y:e.width).attr("y1",n?0:e.y).attr("y2",n?e.height:e.y),e.smoothLines(e.ygrid,"grid")},updateGrid:function(e){var t=this;t.grid.style("visibility",t.hasArcType()?"hidden":"visible"),t.main.select("line.".concat(ks.xgridFocus)).style("visibility","hidden"),t.updateXGridLines(e),t.updateYGridLines(e)},updateXGridLines:function(e){var t=this,n=t.main,i=t.config,o=i.axis_rotated;i.grid_x_show&&t.updateXGrid(),t.xgridLines=n.select(".".concat(ks.xgridLines)).selectAll(".".concat(ks.xgridLine)).data(i.grid_x_lines),t.xgridLines.exit().transition().duration(e).style("opacity","0").remove();var s=t.xgridLines.enter().append("g");s.append("line").style("opacity","0"),s.append("text").attr("transform",o?"":"rotate(-90)").attr("dy",-5).style("opacity","0"),t.xgridLines=s.merge(t.xgridLines),t.xgridLines.attr("class",(function(e){return"".concat(ks.xgridLine," ").concat(e.class||"").trim()})).select("text").attr("text-anchor",Ac).attr("dx",Ec).transition().duration(e).text((function(e){return e.text})).transition().style("opacity","1")},updateYGridLines:function(e){var t=this,n=t.main,i=t.config,o=i.axis_rotated;i.grid_y_show&&t.updateYGrid(),t.ygridLines=n.select(".".concat(ks.ygridLines)).selectAll(".".concat(ks.ygridLine)).data(i.grid_y_lines),t.ygridLines.exit().transition().duration(e).style("opacity","0").remove();var s=t.ygridLines.enter().append("g");s.append("line").style("opacity","0"),s.append("text").attr("transform",o?"rotate(-90)":"").style("opacity","0"),t.ygridLines=s.merge(t.ygridLines);var a=t.yv.bind(t);t.ygridLines.attr("class",(function(e){return"".concat(ks.ygridLine," ").concat(e.class||"").trim()})).select("line").transition().duration(e).attr("x1",o?a:0).attr("x2",o?a:t.width).attr("y1",o?0:a).attr("y2",o?t.height:a).transition().style("opacity","1"),t.ygridLines.select("text").attr("text-anchor",Ac).attr("dx",Ec).transition().duration(e).attr("dy",-5).attr("x",Tc(o,t.width,t.height)).attr("y",a).text((function(e){return e.text})).transition().style("opacity","1")},redrawGrid:function(e){var t=this,n=t.config.axis_rotated,i=t.xv.bind(t),o=t.xgridLines.select("line"),s=t.xgridLines.select("text");return o=(e?o.transition():o).attr("x1",n?0:i).attr("x2",n?t.width:i).attr("y1",n?i:0).attr("y2",n?i:t.height),s=(e?s.transition():s).attr("x",Tc(!n,t.width,t.height)).attr("y",i).text((function(e){return e.text})),[(e?o.transition():o).style("opacity","1"),(e?s.transition():s).style("opacity","1")]},initXYFocusGrid:function(){var e=this,t=e.config;e.grid=e.main.append("g").attr("clip-path",e.clipPathForGrid).attr("class",ks.grid),t.grid_x_show&&e.grid.append("g").attr("class",ks.xgrids),t.grid_y_show&&e.grid.append("g").attr("class",ks.ygrids),t.grid_focus_show&&e.grid.append("g").attr("class",ks.xgridFocus).append("line").attr("class",ks.xgridFocus)},showXGridFocus:function(e){var t=this,n=t.config,i=n.axis_rotated,o=e.filter((function(e){return e&&fa(t.getBaseValue(e))})),s=t.main.selectAll("line.".concat(ks.xgridFocus)),a=t.xx.bind(t);!n.tooltip_show||t.hasType("bubble")||t.hasType("scatter")||t.hasArcType()||(s.style("visibility","visible").data([o[0]]).attr(i?"y1":"x1",a).attr(i?"y2":"x2",a),t.smoothLines(s,"grid"))},hideXGridFocus:function(){this.main.select("line.".concat(ks.xgridFocus)).style("visibility","hidden")},updateXgridFocus:function(){var e=this.config.axis_rotated;this.main.select("line.".concat(ks.xgridFocus)).attr("x1",e?0:-10).attr("x2",e?this.width:-10).attr("y1",e?-10:0).attr("y2",e?-10:this.height)},generateGridData:function(e,t){var n=this.main.select(".".concat(ks.axisX)).selectAll(".tick").size(),i=[];if("year"===e)for(var o=this.getXDomain(),s=o[0].getFullYear(),a=o[1].getFullYear(),r=s;r<=a;r++)i.push(new Date("".concat(r,"-01-01 00:00:00")));else(i=t.ticks(10)).length>n&&(i=i.filter((function(e){return(e+"").indexOf(".")<0})));return i},getGridFilterToRemove:function(e){return e?function(t){var n=!1;return(Da(e)?e.concat():[e]).forEach((function(e){("value"in e&&t.value===e.value||"class"in e&&t.class===e.class)&&(n=!0)})),n}:function(){return!0}},removeGridLines:function(e,t){var n=this.config,i=this.getGridFilterToRemove(e),o=t?ks.xgridLines:ks.ygridLines,s=t?ks.xgridLine:ks.ygridLine;this.main.select(".".concat(o)).selectAll(".".concat(s)).filter(i).transition().duration(n.transition_duration).style("opacity","0").remove();var a="grid_".concat(t?"x":"y","_lines");n[a]=n[a].filter((function(e){return!i(e)}))}}),Va(kr.prototype,{initTooltip:function(){var e=this,t=e.config;if(e.tooltip=e.selectChart.style("position","relative").append("div").attr("class",ks.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none"),t.tooltip_init_show){if(e.isTimeSeries()&&va(t.tooltip_init_x)){var n,i,o=e.data.targets[0];for(t.tooltip_init_x=e.parseDate(t.tooltip_init_x),n=0;(i=o.values[n])&&i.x-t.tooltip_init_x!=0;n++);t.tooltip_init_x=n}e.tooltip.html(t.tooltip_contents.call(e,e.data.targets.map((function(n){return e.addName(n.values[t.tooltip_init_x])})),e.axis.getXAxisTickFormat(),e.getYFormat(e.hasArcType(null,["radar"])),e.color)),e.tooltip.style("top",t.tooltip_init_position.top).style("left",t.tooltip_init_position.left).style("display","block")}},getTooltipContent:function(e,t,n,i){var o,s,r,l,c=this,d=c.config,u=d.tooltip_format_title||t,h=d.tooltip_format_name||function(e){return e},p=d.tooltip_format_value||(c.isStackNormalized()?function(e,t){return"".concat((100*t).toFixed(2),"%")}:n),m=d.tooltip_order,_=function(e){return c.getBaseValue(e)},g=c.levelColor?function(e){return c.levelColor(e.value)}:function(e){return i(e.id)};if(null===m&&d.data_groups.length){var f=c.orderTargets(c.data.targets).map((function(e){return e.id})).reverse();e.sort((function(e,t){var n=e?e.value:null,i=t?t.value:null;return n>0&&i>0&&(n=e.id?f.indexOf(e.id):null,i=t.id?f.indexOf(t.id):null),n-i}))}else/^(asc|desc)$/.test(m)?e.sort((function(e,t){var n=e?_(e):null,i=t?_(t):null;return"asc"===m?n-i:i-n})):ba(m)&&e.sort(m);for(var b=0,v=e.length;b<v;b++)if((s=e[b])&&(_(s)||0===_(s))){if(!o){var A=xa(u?u(s.x):s.x);o='<table class="'.concat(c.CLASS.tooltip,'">').concat(fa(A)?'<tr><th colspan="2">'.concat(A,"</th></tr>"):"")}if(r=[s.ratio,s.id,s.index,e],l=xa(p.apply(void 0,[_(s)].concat(Wa()(r)))),c.isAreaRangeType(s)){var E=["high","low"].map((function(e){return xa(p.apply(void 0,[c.getAreaRangeData(s,e)].concat(Wa()(r))))})),T=a()(E,2),C=T[0],y=T[1];l="<b>Mid:</b> ".concat(l," <b>High:</b> ").concat(C," <b>Low:</b> ").concat(y)}if(void 0!==l){if(null===s.name)continue;var M=xa(h.apply(void 0,[s.name].concat(Wa()(r)))),I=g(s);o+='<tr class="'.concat(c.CLASS.tooltipName).concat(c.getTargetSelectorSuffix(s.id),'"><td class="name">'),o+=c.patterns?'<svg><rect style="fill:'.concat(I,'" width="10" height="10"></rect></svg>'):'<span style="background-color:'.concat(I,'"></span>'),o+="".concat(M,'</td><td class="value">').concat(l,"</td></tr>")}}return"".concat(o,"</table>")},tooltipPosition:function(e,t,n,i){var o=this,s=o.config,r=Pn(i),l=a()(r,2),c=l[0],d=l[1],u=o.getSvgLeft(!0),h=u+o.currentWidth-o.getCurrentPaddingRight();if(d+=20,o.hasArcType())"touch"===o.inputType||o.hasType("radar")||(d+=o.height/2,c+=(o.width-(o.isLegendRight?o.getLegendWidth():0))/2);else{var p=o.x(e[0].x);s.axis_rotated?(d=p+20,c+=u+100,h-=u):(d-=5,c=u+o.getCurrentPaddingLeft(!0)+20+(o.zoomScale?c:p))}var m=c+t;return m>h&&(c-=m-h+20),d+n>o.currentHeight&&(d-=n+30),d<0&&(d=0),{top:d,left:c}},showTooltip:function(e,t){var n=this,i=n.config,o=n.hasArcType(null,["radar"]),s=e.filter((function(e){return e&&fa(n.getBaseValue(e))})),a=i.tooltip_position||n.tooltipPosition;if(0!==s.length&&i.tooltip_show){var r=n.tooltip.datum(),l=JSON.stringify(e),c=r&&r.width||0,d=r&&r.height||0;if(!r||r.current!==l){var u=e.concat().sort()[0].index,h=i.tooltip_contents.call(n,e,n.axis.getXAxisTickFormat(),n.getYFormat(o),n.color);Pa(i.tooltip_onshow,n),n.tooltip.html(h).style("display","block").datum({index:u,current:l,width:c=n.tooltip.property("offsetWidth"),height:d=n.tooltip.property("offsetHeight")}),Pa(i.tooltip_onshown,n),n._handleLinkedCharts(!0,u)}var p=a.call(this,s,c,d,t);n.tooltip.style("top","".concat(p.top,"px")).style("left","".concat(p.left,"px"))}},hideTooltip:function(){var e=this.config;Pa(e.tooltip_onhide,this),this.tooltip.style("display","none").datum(null),Pa(e.tooltip_onhidden,this)},_handleLinkedCharts:function(e,t){var n=this;if(n.config.tooltip_linked){var i=n.config.tooltip_linked_name;(n.api.internal.charts||[]).forEach((function(o){if(o!==n.api){var s=o.internal.config,a=s.tooltip_linked,r=s.tooltip_linked_name,l=document.body.contains(o.element);if(a&&i===r&&l){var c=o.internal.tooltip.data()[0],d=t!==(c&&c.index);try{e&&d?o.tooltip.show({index:t}):!e&&o.tooltip.hide()}catch(e){}}}}))}}}),Va(kr.prototype,{initLegend:function(){var e=this,t=e.config;e.legendItemTextBox={},e.legendHasRendered=!1,e.legend=e.svg.append("g"),t.legend_show?(e.legend.attr("transform",e.getTranslate("legend")),e.updateLegend()):(e.legend.style("visibility","hidden"),e.hiddenLegendIds=e.mapToIds(e.data.targets))},updateLegend:function(e,t,n){var i=this,o=i.config;o.legend_contents_bindto&&o.legend_contents_template?i.updateLegendTemplate():i.updateLegendElement(e||i.mapToIds(i.data.targets),t||{withTransform:!1,withTransitionForTransform:!1,withTransition:!1},n)},updateLegendTemplate:function(){var e=this,t=e.config,n=wn(t.legend_contents_bindto),i=t.legend_contents_template;if(!n.empty()){var o=e.data.targets,s=[],a="";e.mapToIds(o).forEach((function(t){var n=ba(i)?i.call(e,t,e.color(t),e.api.data(t)[0].values):i.replace(/{=COLOR}/g,e.color(t)).replace(/{=TITLE}/g,t);n&&(s.push(t),a+=n)}));var r=n.html(a).selectAll((function(){return this.childNodes})).data(s);e.setLegendItem(r)}},updateSizeForLegend:function(e,t){var n=this,i=n.config,o={top:n.isLegendTop?n.getCurrentPaddingTop()+i.legend_inset_y+5.5:n.currentHeight-e-n.getCurrentPaddingBottom()-i.legend_inset_y,left:n.isLegendLeft?n.getCurrentPaddingLeft()+i.legend_inset_x+.5:n.currentWidth-t-n.getCurrentPaddingRight()-i.legend_inset_x+.5};n.margin3={top:n.isLegendRight?0:n.isLegendInset?o.top:n.currentHeight-e,right:NaN,bottom:0,left:n.isLegendRight?n.currentWidth-t:n.isLegendInset?o.left:0}},transformLegend:function(e){(e?this.legend.transition():this.legend).attr("transform",this.getTranslate("legend"))},updateLegendStep:function(e){this.legendStep=e},updateLegendItemWidth:function(e){this.legendItemWidth=e},updateLegendItemHeight:function(e){this.legendItemHeight=e},getLegendWidth:function(){var e=this;return e.config.legend_show?e.isLegendRight||e.isLegendInset?e.legendItemWidth*(e.legendStep+1):e.currentWidth:0},getLegendHeight:function(){var e=this,t=0;return e.config.legend_show&&(t=e.isLegendRight?e.currentHeight:Math.max(20,e.legendItemHeight)*(e.legendStep+1)),t},opacityForLegend:function(e){return e.classed(ks.legendItemHidden)?null:"1"},opacityForUnfocusedLegend:function(e){return e.classed(ks.legendItemHidden)?null:"0.3"},toggleFocusLegend:function(e,t){var n=this,i=n.mapToTargetIds(e);n.legend.selectAll(".".concat(ks.legendItem)).filter((function(e){return i.indexOf(e)>=0})).classed(ks.legendItemFocused,t).transition().duration(100).style("opacity",(function(){return(t?n.opacityForLegend:n.opacityForUnfocusedLegend).call(n,wn(this))}))},revertLegend:function(){var e=this;e.legend.selectAll(".".concat(ks.legendItem)).classed(ks.legendItemFocused,!1).transition().duration(100).style("opacity",(function(){return e.opacityForLegend(wn(this))}))},showLegend:function(e){var t=this,n=t.config;n.legend_show||(n.legend_show=!0,t.legend.style("visibility","visible"),!t.legendHasRendered&&t.updateLegend()),t.removeHiddenLegendIds(e),t.legend.selectAll(t.selectorLegends(e)).style("visibility","visible").transition().style("opacity",(function(){return t.opacityForLegend(wn(this))}))},hideLegend:function(e){var t=this,n=t.config;n.legend_show&&wa(e)&&(n.legend_show=!1,t.legend.style("visibility","hidden")),t.addHiddenLegendIds(e),t.legend.selectAll(t.selectorLegends(e)).style("opacity","0").style("visibility","hidden")},clearLegendItemTextBoxCache:function(){this.legendItemTextBox={}},setLegendItem:function(e){var t=this,n=t.config,i="touch"===t.inputType;e.attr("class",(function(e){var n=wn(this);return(!n.empty()&&n.attr("class")||"")+t.generateClass(ks.legendItem,e)})).style("visibility",(function(e){return t.isLegendToShow(e)?"visible":"hidden"})).style("cursor","pointer").on("click",(function(e){Pa(n.legend_item_onclick,t,e)||(mn.altKey?(t.api.hide(),t.api.show(e)):(t.api.toggle(e),!i&&t.isTargetToShow(e)?t.api.focus(e):t.api.revert())),i&&t.hideTooltip()})),i||e.on("mouseout",(function(e){Pa(n.legend_item_onout,t,e)||(wn(this).classed(ks.legendItemFocused,!1),t.api.revert())})).on("mouseover",(function(e){Pa(n.legend_item_onover,t,e)||(wn(this).classed(ks.legendItemFocused,!0),!t.transiting&&t.isTargetToShow(e)&&t.api.focus(e))}))},updateLegendElement:function(e,t,n){var i,o,s,a=this,r=a.config,l=r.legend_item_tile_width+5,c=0,d=0,u=0,h={},p={},m={},_=[0],g={},f=0,b=a.isLegendRight||a.isLegendInset,v=e.filter((function(e){return!Ta(r.data_names[e])||null!==r.data_names[e]})),A=t||{},E=Oa(A,"withTransition",!0),T=Oa(A,"withTransitionForTransform",!0),C=function(e,t,n){var i,o=n===v.length-1,s=function(e,t){return a.legendItemTextBox[t]||(a.legendItemTextBox[t]=a.getTextRect(e,ks.legendItem,e)),a.legendItemTextBox[t]}(e,t),A=s.width+l+(o&&!b?0:10)+r.legend_padding,E=s.height+4,T=b?E:A,C=b?a.getLegendHeight():a.getLegendWidth(),y=function(e,t){t||(i=(C-u-T)/2)<10&&(i=(C-T)/2,u=0,f++),g[e]=f,_[f]=a.isLegendInset?10:i,h[e]=u,u+=T};if(0===n&&(u=0,f=0,c=0,d=0),r.legend_show&&!a.isLegendToShow(t))return p[t]=0,m[t]=0,g[t]=0,void(h[t]=0);p[t]=A,m[t]=E,(!c||A>=c)&&(c=A),(!d||E>=d)&&(d=E);var M=b?d:c;r.legend_equally?(Object.keys(p).forEach((function(e){return p[e]=c})),Object.keys(m).forEach((function(e){return m[e]=d})),(i=(C-M*v.length)/2)<10?(u=0,f=0,v.forEach((function(e){return y(e)}))):y(t,!0)):y(t)};a.isLegendInset&&(f=r.legend_inset_step?r.legend_inset_step:v.length,a.updateLegendStep(f)),a.isLegendRight?(i=function(e){return c*g[e]},o=function(e){return _[g[e]]+h[e]}):a.isLegendInset?(i=function(e){return c*g[e]+10},o=function(e){return _[g[e]]+h[e]}):(i=function(e){return _[g[e]]+h[e]},o=function(e){return d*g[e]});var y=function(e,t){return i(e,t)+4+r.legend_item_tile_width},M=function(e,t){return i(e,t)},I=function(e,t){return i(e,t)-2},S=function(e,t){return i(e,t)-2+r.legend_item_tile_width},w=function(e,t){return o(e,t)+9},N=function(e,t){return o(e,t)-5},D=function(e,t){return o(e,t)+4},L=a.legend.selectAll(".".concat(ks.legendItem)).data(v).enter().append("g");a.setLegendItem(L),L.append("text").text((function(e){return Ta(r.data_names[e])?r.data_names[e]:e})).each((function(e,t){C(this,e,t)})).style("pointer-events","none").attr("x",b?y:-200).attr("y",b?-200:w),L.append("rect").attr("class",ks.legendItemEvent).style("fill-opacity","0").attr("x",b?M:-200).attr("y",b?-200:N);var O=a.config.legend_usePoint;if(O){var P=[];L.append((function(e){var t=Na(r.point_pattern)?r.point_pattern:[r.point_type];-1===P.indexOf(e)&&P.push(e);var n=t[P.indexOf(e)%t.length];return"rectangle"===n&&(n="rect"),document.createElementNS(mt.svg,a.hasValidPointType(n)?n:"use")})).attr("class",ks.legendItemPoint).style("fill",(function(e){return a.color(e)})).style("pointer-events","none").attr("href",(function(e,t,n){return"use"===n[t].nodeName.toLowerCase()?"#".concat(a.datetimeId,"-point-").concat(e):void 0}))}else L.append("line").attr("class",ks.legendItemTile).style("stroke",a.color).style("pointer-events","none").attr("x1",b?I:-200).attr("y1",b?-200:D).attr("x2",b?S:-200).attr("y2",b?-200:D).attr("stroke-width",r.legend_item_tile_height);s=a.legend.select(".".concat(ks.legendBackground," rect")),a.isLegendInset&&c>0&&0===s.size()&&(s=a.legend.insert("g",".".concat(ks.legendItem)).attr("class",ks.legendBackground).append("rect"));var x=a.legend.selectAll("text").data(v).text((function(e){return Ta(r.data_names[e])?r.data_names[e]:e})).each((function(e,t){C(this,e,t)}));(E?x.transition():x).attr("x",y).attr("y",w);var R=a.legend.selectAll("rect.".concat(ks.legendItemEvent)).data(v);if((E?R.transition():R).attr("width",(function(e){return p[e]})).attr("height",(function(e){return m[e]})).attr("x",M).attr("y",N),O){var k=a.legend.selectAll(".".concat(ks.legendItemPoint)).data(v);(E?k.transition():k).each((function(){var e,t,n,i=this.nodeName.toLowerCase(),o=a.config.point_r,s="x",r="y",l=2,c=2.5;if("circle"===i){var d=.2*o;s="cx",r="cy",e=o+d,l=2*o,c=-d}else if("rect"===i){var u=2.5*o;t=u,n=u,c=3}wn(this).attr(s,(function(e){return I(e)+l})).attr(r,(function(e){return D(e)-c})).attr("r",e).attr("width",t).attr("height",n)}))}else{var B=a.legend.selectAll("line.".concat(ks.legendItemTile)).data(v);(E?B.transition():B).style("stroke",a.color).attr("x1",I).attr("y1",D).attr("x2",S).attr("y2",D)}s&&(E?s.transition():s).attr("height",a.getLegendHeight()-12).attr("width",c*(f+1)+10),a.legend.selectAll(".".concat(ks.legendItem)).classed(ks.legendItemHidden,(function(e){return!a.isTargetToShow(e)})),a.updateLegendItemWidth(c),a.updateLegendItemHeight(d),a.updateLegendStep(f),a.updateSizes(),a.updateScales(!E),a.updateSvgSize(),a.transformAll(T,n),a.legendHasRendered=!0}}),Va(kr.prototype,{initTitle:function(){this.title=this.svg.append("text").text(this.config.title_text).attr("class",this.CLASS.title)},redrawTitle:function(){var e=this;e.title.attr("x",e.xForTitle.bind(e)).attr("y",e.yForTitle.bind(e))},xForTitle:function(){var e=this,t=e.config,n=t.title_position||"left";return n.indexOf("right")>=0?e.currentWidth-e.getTextRect(e.title,e.CLASS.title,e.title).width-t.title_padding.right:n.indexOf("center")>=0?(e.currentWidth-e.getTextRect(e.title,e.CLASS.title,e.title).width)/2:t.title_padding.left},yForTitle:function(){var e=this;return e.config.title_padding.top+e.getTextRect(e.title,e.CLASS.title,e.title).height},getTitlePadding:function(){return this.yForTitle()+this.config.title_padding.bottom}}),Va(kr.prototype,{getClipPath:function(e){var t=this.config;if(!t.clipPath&&/-clip$/.test(e)||!t.axis_x_clipPath&&/-clip-xaxis$/.test(e)||!t.axis_y_clipPath&&/-clip-yaxis$/.test(e))return null;var n=window.navigator.appVersion.toLowerCase().indexOf("msie 9.")>=0;return"url(".concat(n?"":document.URL.split("#")[0],"#").concat(e,")")},appendClip:function(e,t){return e.append("clipPath").attr("id",t).append("rect")},getAxisClipX:function(e){var t=Math.max(30,this.margin.left);return e?-(1+t):-(t-1)},getAxisClipY:function(e){return e?-20:-this.margin.top},getXAxisClipX:function(){return this.getAxisClipX(!this.config.axis_rotated)},getXAxisClipY:function(){return this.getAxisClipY(!this.config.axis_rotated)},getYAxisClipX:function(){return this.config.axis_y_inner?-1:this.getAxisClipX(this.config.axis_rotated)},getYAxisClipY:function(){return this.getAxisClipY(this.config.axis_rotated)},getAxisClipWidth:function(e){var t=Math.max(30,this.margin.left),n=Math.max(30,this.margin.right);return e?this.width+2+t+n:this.margin.left+20},getAxisClipHeight:function(e){return(e?this.margin.bottom:this.margin.top+this.height)+20},getXAxisClipWidth:function(){return this.getAxisClipWidth(!this.config.axis_rotated)},getXAxisClipHeight:function(){return this.getAxisClipHeight(!this.config.axis_rotated)},getYAxisClipWidth:function(){return this.getAxisClipWidth(this.config.axis_rotated)+(this.config.axis_y_inner?20:0)},getYAxisClipHeight:function(){return this.getAxisClipHeight(this.config.axis_rotated)}}),Va(kr.prototype,{initRegion:function(){this.region=this.main.append("g").attr("clip-path",this.clipPath).attr("class",ks.regions)},updateRegion:function(e){var t=this,n=t.config;t.region.style("visibility",t.hasArcType()?"hidden":"visible"),t.mainRegion=t.main.select(".".concat(ks.regions)).selectAll(".".concat(ks.region)).data(n.regions),t.mainRegion.exit().transition().duration(e).style("opacity","0").remove(),t.mainRegion=t.mainRegion.enter().append("g").merge(t.mainRegion).attr("class",t.classRegion.bind(t)),t.mainRegion.append("rect").style("fill-opacity","0")},redrawRegion:function(e){var t=this,n=t.mainRegion.select("rect");return n=(e?n.transition():n).attr("x",t.regionX.bind(t)).attr("y",t.regionY.bind(t)).attr("width",t.regionWidth.bind(t)).attr("height",t.regionHeight.bind(t)),[(e?n.transition():n).style("fill-opacity",(function(e){return fa(e.opacity)?e.opacity:"0.1"})).on("end",(function(){wn(this.parentNode).selectAll("rect:not([x])").remove()}))]},getRegionXY:function(e,t){var n=this,i=n.config.axis_rotated,o="x"===e,s="start",a=0;return"y"===t.axis||"y2"===t.axis?(!o&&(s="end"),(o?i:!i)&&s in t&&(a=(0,n[t.axis])(t[s]))):(o?!i:i)&&s in t&&(a=(n.zoomScale||n.x)(n.isTimeSeries()?n.parseDate(t[s]):t[s])),a},regionX:function(e){return this.getRegionXY("x",e)},regionY:function(e){return this.getRegionXY("y",e)},getRegionSize:function(e,t){var n=this,i=n.config.axis_rotated,o="width"===e,s=n[o?"regionX":"regionY"](t),a="end",r=n[e];return"y"===t.axis||"y2"===t.axis?(!o&&(a="start"),(o?i:!i)&&a in t&&(r=(0,n[t.axis])(t[a]))):(o?!i:i)&&a in t&&(r=(n.zoomScale||n.x)(n.isTimeSeries()?n.parseDate(t[a]):t[a])),r<s?0:r-s},regionWidth:function(e){return this.getRegionSize("width",e)},regionHeight:function(e){return this.getRegionSize("height",e)},isRegionOnX:function(e){return!e.axis||"x"===e.axis}}),Va(kr.prototype,{drag:function(e){var t=this,n=t.config,i=t.main;if(!t.hasArcType()&&n.data_selection_enabled&&(!n.zoom_enabled||t.zoom.altDomain)&&n.data_selection_multiple){var o=a()(t.dragStart,2),s=o[0],r=o[1],l=a()(e,2),c=l[0],d=l[1],u=Math.min(s,c),h=Math.max(s,c),p=n.data_selection_grouped?t.margin.top:Math.min(r,d),m=n.data_selection_grouped?t.height:Math.max(r,d);i.select(".".concat(ks.dragarea)).attr("x",u).attr("y",p).attr("width",h-u).attr("height",m-p),i.selectAll(".".concat(ks.shapes)).selectAll(".".concat(ks.shape)).filter((function(e){return n.data_selection_isselectable(e)})).each((function(e,n){var i,o,s,a,r,l,c,d,_,g,f,b=wn(this),v=b.classed(ks.SELECTED),A=b.classed(ks.INCLUDED),E=!1;if(b.classed(ks.circle))i=1*b.attr("cx"),o=1*b.attr("cy"),r=t.togglePoint,E=u<i&&i<h&&p<o&&o<m;else{if(!b.classed(ks.bar))return;d=(c=this).getBoundingClientRect(),_=d.width,g=d.height,i=(l={x:(f=Ra(c))[0].x,y:Math.min(f[0].y,f[1].y),width:_,height:g}).x,o=l.y,s=l.width,a=l.height,r=t.togglePath,E=!(h<i||i+s<u||m<o||o+a<p)}E^A&&(b.classed(ks.INCLUDED,!A),b.classed(ks.SELECTED,!v),r.call(t,!v,b,e,n))}))}},dragstart:function(e){var t=this,n=t.config;t.hasArcType()||!n.data_selection_enabled||(t.dragStart=e,t.main.select(".".concat(ks.chart)).append("rect").attr("class",ks.dragarea).style("opacity","0.1"),t.setDragStatus(!0))},dragend:function(){var e=this,t=e.config;e.hasArcType()||!t.data_selection_enabled||(e.main.select(".".concat(ks.dragarea)).transition().duration(100).style("opacity","0").remove(),e.main.selectAll(".".concat(ks.shape)).classed(ks.INCLUDED,!1),e.setDragStatus(!1))},setDragStatus:function(e){this.dragging=e}}),Va(kr.prototype,{selectPoint:function(e,t,n){var i=this,o=i.config,s=o.axis_rotated,a=(s?i.circleY:i.circleX).bind(i),r=(s?i.circleX:i.circleY).bind(i),l=i.pointSelectR.bind(i);Pa(o.data_onselected,i.api,t,e.node()),i.main.select(".".concat(ks.selectedCircles).concat(i.getTargetSelectorSuffix(t.id))).selectAll(".".concat(ks.selectedCircle,"-").concat(n)).data([t]).enter().append("circle").attr("class",(function(){return i.generateClass(ks.selectedCircle,n)})).attr("cx",a).attr("cy",r).attr("stroke",(function(){return i.color(t)})).attr("r",(function(e){return 1.4*i.pointSelectR(e)})).transition().duration(100).attr("r",l)},unselectPoint:function(e,t,n){Pa(this.config.data_onunselected,this.api,t,e.node()),this.main.select(".".concat(ks.selectedCircles).concat(this.getTargetSelectorSuffix(t.id))).selectAll(".".concat(ks.selectedCircle,"-").concat(n)).transition().duration(100).attr("r",0).remove()},togglePoint:function(e,t,n,i){this["".concat(e?"":"un","selectPoint")](t,n,i)},selectPath:function(e,t){var n=this,i=n.config;Pa(i.data_onselected,n,t,e.node()),i.interaction_brighten&&e.transition().duration(100).style("fill",(function(){return Xi(n.color(t)).brighter(.75)}))},unselectPath:function(e,t){var n=this,i=n.config;Pa(i.data_onunselected,n,t,e.node()),i.interaction_brighten&&e.transition().duration(100).style("fill",(function(){return n.color(t)}))},togglePath:function(e,t,n,i){this["".concat(e?"":"un","selectPath")](t,n,i)},getToggle:function(e,t){return"path"===e.nodeName?this.togglePath:this.isStepType(t)?function(){}:this.togglePoint},toggleShape:function(e,t,n){var i,o=this,s=o.config,a=wn(e),r=a.classed(ks.SELECTED),l=o.getToggle(e,t).bind(o);if(s.data_selection_enabled&&s.data_selection_isselectable(t)){if(!s.data_selection_multiple){var c=".".concat(ks.shapes);s.data_selection_grouped&&(c+=o.getTargetSelectorSuffix(t.id)),o.main.selectAll(c).selectAll(".".concat(ks.shape)).each((function(e,t){var n=wn(this);n.classed(ks.SELECTED)&&(i=n,l(!1,n.classed(ks.SELECTED,!1),e,t))}))}i&&i.node()===a.node()||(a.classed(ks.SELECTED,!r),l(!r,a,t,n))}}}),Va(kr.prototype,{initBrush:function(){var e=this;e.brush=e.config.axis_rotated?ga(sa):ga(oa);var t=function(){e.redrawForBrush()};e.brush.on("start",(function(){"touch"===e.inputType&&e.hideTooltip(),t()})).on("brush",t),e.brush.update=function(){return 0===this.extent()()[1].filter((function(e){return isNaN(e)})).length&&e.context&&e.context.select(".".concat(ks.brush)).call(this),this},e.brush.scale=function(t,n){var i=e.svg.select(".bb-brush .overlay"),o=[[0,0]];t.range?o.push([t.range()[1],(n||!i.empty())&&~~i.attr("height")||60]):t.constructor===Array&&o.push(t),e.config.axis_rotated&&o.reverse(),this.extent(e.config.axis_x_extent||o),this.update()},e.brush.getSelection=function(){return e.context?e.context.select(".".concat(ks.brush)):wn([])}},initSubchart:function(){var e=this,t=e.config,n=t.subchart_show?"visible":"hidden";e.context=e.svg.append("g").attr("transform",e.getTranslate("context"));var i=e.context;i.style("visibility",n),i.append("g").attr("clip-path",e.clipPathForSubchart).attr("class",ks.chart),i.select(".".concat(ks.chart)).append("g").attr("class",ks.chartBars),i.select(".".concat(ks.chart)).append("g").attr("class",ks.chartLines),i.append("g").attr("clip-path",e.clipPath).attr("class",ks.brush).call(e.brush),e.axes.subx=i.append("g").attr("class",ks.axisX).attr("transform",e.getTranslate("subx")).attr("clip-path",t.axis_rotated?"":e.clipPathForXAxis).style("visibility",t.subchart_axis_x_show?n:"hidden")},updateTargetsForSubchart:function(e){var t=this,n=t.context,i=t.config,o=t.classChartBar.bind(t),s=t.classBars.bind(t),a=t.classChartLine.bind(t),r=t.classLines.bind(t),l=t.classAreas.bind(t);if(i.subchart_show){var c=n.select(".".concat(ks.chartBars)).selectAll(".".concat(ks.chartBar)).data(e).attr("class",o);c.enter().append("g").style("opacity","0").attr("class",o).merge(c).append("g").attr("class",s);var d=n.select(".".concat(ks.chartLines)).selectAll(".".concat(ks.chartLine)).data(e).attr("class",a),u=d.enter().append("g").style("opacity","0").attr("class",a).merge(d);u.append("g").attr("class",r),u.append("g").attr("class",l),n.selectAll(".".concat(ks.brush," rect")).attr(i.axis_rotated?"width":"height",i.axis_rotated?t.width2:t.height2)}},updateBarForSubchart:function(e){var t=this;t.contextBar=t.context.selectAll(".".concat(ks.bars)).selectAll(".".concat(ks.bar)).data(t.barData.bind(t)),t.contextBar.exit().transition().duration(e).style("opacity","0").remove(),t.contextBar=t.contextBar.enter().append("path").attr("class",t.classBar.bind(t)).style("stroke","none").style("fill",t.color).merge(t.contextBar).style("opacity",t.initialOpacity.bind(t))},redrawBarForSubchart:function(e,t,n){(t?this.contextBar.transition(Math.random().toString()).duration(n):this.contextBar).attr("d",e).style("opacity","1")},updateLineForSubchart:function(e){var t=this;t.contextLine=t.context.selectAll(".".concat(ks.lines)).selectAll(".".concat(ks.line)).data(t.lineData.bind(t)),t.contextLine.exit().transition().duration(e).style("opacity","0").remove(),t.contextLine=t.contextLine.enter().append("path").attr("class",t.classLine.bind(t)).style("stroke",t.color).merge(t.contextLine).style("opacity",t.initialOpacity.bind(t))},redrawLineForSubchart:function(e,t,n){(t?this.contextLine.transition(Math.random().toString()).duration(n):this.contextLine).attr("d",e).style("opacity","1")},updateAreaForSubchart:function(e){var t=this;t.contextArea=t.context.selectAll(".".concat(ks.areas)).selectAll(".".concat(ks.area)).data(t.lineData.bind(t)),t.contextArea.exit().transition().duration(e).style("opacity","0").remove(),t.contextArea=t.contextArea.enter().append("path").attr("class",t.classArea.bind(t)).style("fill",t.color).style("opacity",(function(){return t.orgAreaOpacity=wn(this).style("opacity"),"0"})).merge(t.contextArea).style("opacity","0")},redrawAreaForSubchart:function(e,t,n){(t?this.contextArea.transition(Math.random().toString()).duration(n):this.contextArea).attr("d",e).style("fill",this.color).style("opacity",this.orgAreaOpacity)},redrawSubchart:function(e,t,n,i,o,s,a){var r=this,l=r.config;if(r.context.style("visibility",l.subchart_show?"visible":"hidden"),l.subchart_show&&(mn&&"zoom"===mn.type&&r.brush.update(),e)){Ba(r)||r.brush.update();var c=r.generateDrawArea(o,!0),d=r.generateDrawBar(s,!0),u=r.generateDrawLine(a,!0);r.updateBarForSubchart(n),r.updateLineForSubchart(n),r.updateAreaForSubchart(n),r.redrawBarForSubchart(d,n,n),r.redrawLineForSubchart(u,n,n),r.redrawAreaForSubchart(c,n,n)}},redrawForBrush:function(){var e=this,t=e.x;e.redraw({withTransition:!1,withY:e.config.zoom_rescale,withSubchart:!1,withUpdateXDomain:!0,withDimension:!1}),e.config.subchart_onbrush.call(e.api,t.orgDomain())},transformContext:function(e,t){var n;t&&t.axisSubX?n=t.axisSubX:(n=this.context.select(".".concat(ks.axisX)),e&&(n=n.transition())),this.context.attr("transform",this.getTranslate("context")),n.attr("transform",this.getTranslate("subx"))},getDefaultExtent:function(){var e=this,t=e.config,n=ba(t.axis_x_extent)?t.axis_x_extent(e.getXDomain(e.data.targets)):t.axis_x_extent;return e.isTimeSeries()&&(n=[e.parseDate(n[0]),e.parseDate(n[1])]),n}});var Cc=function(e){return function(){return e}};function yc(e,t,n){this.target=e,this.type=t,this.transform=n}function Mc(e,t,n){this.k=e,this.x=t,this.y=n}Mc.prototype={constructor:Mc,scale:function(e){return 1===e?this:new Mc(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Mc(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ic=new Mc(1,0,0);function Sc(){mn.stopImmediatePropagation()}Mc.prototype;var wc=function(){mn.preventDefault(),mn.stopImmediatePropagation()};function Nc(){return!mn.button}function Dc(){var e,t,n=this;return n instanceof SVGElement?(e=(n=n.ownerSVGElement||n).width.baseVal.value,t=n.height.baseVal.value):(e=n.clientWidth,t=n.clientHeight),[[0,0],[e,t]]}function Lc(){return this.__zoom||Ic}function Oc(){return-mn.deltaY*(mn.deltaMode?120:1)/500}function Pc(){return"ontouchstart"in this}function xc(e,t,n){var i=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o),a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a))}Va(kr.prototype,{initZoom:function(){this.zoomScale=null,this.generateZoom()},bindZoomEvent:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,n=t.config.zoom_enabled;t.redrawEventRect(),n&&e?t.bindZoomOnEventRect(n.type):!1===e&&(t.api.unzoom(),t.main.select(".".concat(ks.eventRects)).on(".zoom",null).on(".drag",null))},generateZoom:function(){var e=this,t=e.config,n=function(){var e,t,n=Nc,i=Dc,o=xc,s=Oc,a=Pc,r=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],c=250,d=is,u=[],h=li("start","zoom","end"),p=0;function m(e){e.property("__zoom",Lc).on("wheel.zoom",E).on("mousedown.zoom",T).on("dblclick.zoom",C).filter(a).on("touchstart.zoom",y).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",I).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function _(e,t){return(t=Math.max(r[0],Math.min(r[1],t)))===e.k?e:new Mc(t,e.x,e.y)}function g(e,t,n){var i=t[0]-n[0]*e.k,o=t[1]-n[1]*e.k;return i===e.x&&o===e.y?e:new Mc(e.k,i,o)}function f(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function b(e,t,n){e.on("start.zoom",(function(){v(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){v(this,arguments).end()})).tween("zoom",(function(){var e=this,o=arguments,s=v(e,o),a=i.apply(e,o),r=n||f(a),l=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),c=e.__zoom,u="function"==typeof t?t.apply(e,o):t,h=d(c.invert(r).concat(l/c.k),u.invert(r).concat(l/u.k));return function(e){if(1===e)e=u;else{var t=h(e),n=l/t[2];e=new Mc(n,r[0]-t[0]*n,r[1]-t[1]*n)}s.zoom(null,e)}}))}function v(e,t){for(var n,i=0,o=u.length;i<o;++i)if((n=u[i]).that===e)return n;return new A(e,t)}function A(e,t){this.that=e,this.args=t,this.index=-1,this.active=0,this.extent=i.apply(e,t)}function E(){if(n.apply(this,arguments)){var e=v(this,arguments),t=this.__zoom,i=Math.max(r[0],Math.min(r[1],t.k*Math.pow(2,s.apply(this,arguments)))),a=Pn(this);if(e.wheel)e.mouse[0][0]===a[0]&&e.mouse[0][1]===a[1]||(e.mouse[1]=t.invert(e.mouse[0]=a)),clearTimeout(e.wheel);else{if(t.k===i)return;e.mouse=[a,t.invert(a)],Li(this),e.start()}wc(),e.wheel=setTimeout(c,150),e.zoom("mouse",o(g(_(t,i),e.mouse[0],e.mouse[1]),e.extent,l))}function c(){e.wheel=null,e.end()}}function T(){if(!t&&n.apply(this,arguments)){var e=v(this,arguments),i=wn(mn.view).on("mousemove.zoom",c,!0).on("mouseup.zoom",d,!0),s=Pn(this),a=mn.clientX,r=mn.clientY;Hs(mn.view),Sc(),e.mouse=[s,this.__zoom.invert(s)],Li(this),e.start()}function c(){if(wc(),!e.moved){var t=mn.clientX-a,n=mn.clientY-r;e.moved=t*t+n*n>p}e.zoom("mouse",o(g(e.that.__zoom,e.mouse[0]=Pn(e.that),e.mouse[1]),e.extent,l))}function d(){i.on("mousemove.zoom mouseup.zoom",null),zs(mn.view,e.moved),wc(),e.end()}}function C(){if(n.apply(this,arguments)){var e=this.__zoom,t=Pn(this),s=e.invert(t),a=e.k*(mn.shiftKey?.5:2),r=o(g(_(e,a),t,s),i.apply(this,arguments),l);wc(),c>0?wn(this).transition().duration(c).call(b,r,t):wn(this).call(m.transform,r)}}function y(){if(n.apply(this,arguments)){var t,i,o,s,a=v(this,arguments),r=mn.changedTouches,l=r.length;for(Sc(),i=0;i<l;++i)o=r[i],s=[s=Rn(this,r,o.identifier),this.__zoom.invert(s),o.identifier],a.touch0?a.touch1||(a.touch1=s):(a.touch0=s,t=!0);if(e&&(e=clearTimeout(e),!a.touch1))return a.end(),void((s=wn(this).on("dblclick.zoom"))&&s.apply(this,arguments));t&&(e=setTimeout((function(){e=null}),500),Li(this),a.start())}}function M(){var t,n,i,s,a=v(this,arguments),r=mn.changedTouches,c=r.length;for(wc(),e&&(e=clearTimeout(e)),t=0;t<c;++t)n=r[t],i=Rn(this,r,n.identifier),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=i:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=i);if(n=a.that.__zoom,a.touch1){var d=a.touch0[0],u=a.touch0[1],h=a.touch1[0],p=a.touch1[1],m=(m=h[0]-d[0])*m+(m=h[1]-d[1])*m,f=(f=p[0]-u[0])*f+(f=p[1]-u[1])*f;n=_(n,Math.sqrt(m/f)),i=[(d[0]+h[0])/2,(d[1]+h[1])/2],s=[(u[0]+p[0])/2,(u[1]+p[1])/2]}else{if(!a.touch0)return;i=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(g(n,i,s),a.extent,l))}function I(){var e,n,i=v(this,arguments),o=mn.changedTouches,s=o.length;for(Sc(),t&&clearTimeout(t),t=setTimeout((function(){t=null}),500),e=0;e<s;++e)n=o[e],i.touch0&&i.touch0[2]===n.identifier?delete i.touch0:i.touch1&&i.touch1[2]===n.identifier&&delete i.touch1;i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0?i.touch0[1]=this.__zoom.invert(i.touch0[0]):i.end()}return m.transform=function(e,t){var n=e.selection?e.selection():e;n.property("__zoom",Lc),e!==n?b(e,t):n.interrupt().each((function(){v(this,arguments).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()}))},m.scaleBy=function(e,t){m.scaleTo(e,(function(){var e=this.__zoom.k,n="function"==typeof t?t.apply(this,arguments):t;return e*n}))},m.scaleTo=function(e,t){m.transform(e,(function(){var e=i.apply(this,arguments),n=this.__zoom,s=f(e),a=n.invert(s),r="function"==typeof t?t.apply(this,arguments):t;return o(g(_(n,r),s,a),e,l)}))},m.translateBy=function(e,t,n){m.transform(e,(function(){return o(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),l)}))},m.translateTo=function(e,t,n){m.transform(e,(function(){var e=i.apply(this,arguments),s=this.__zoom,a=f(e);return o(Ic.translate(a[0],a[1]).scale(s.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,l)}))},A.prototype={start:function(){return 1==++this.active&&(this.index=u.push(this)-1,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(u.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(e){An(new yc(m,e,this.that.__zoom),h.apply,h,[e,this.that,this.args])}},m.wheelDelta=function(e){return arguments.length?(s="function"==typeof e?e:Cc(+e),m):s},m.filter=function(e){return arguments.length?(n="function"==typeof e?e:Cc(!!e),m):n},m.touchable=function(e){return arguments.length?(a="function"==typeof e?e:Cc(!!e),m):a},m.extent=function(e){return arguments.length?(i="function"==typeof e?e:Cc([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),m):i},m.scaleExtent=function(e){return arguments.length?(r[0]=+e[0],r[1]=+e[1],m):[r[0],r[1]]},m.translateExtent=function(e){return arguments.length?(l[0][0]=+e[0][0],l[1][0]=+e[1][0],l[0][1]=+e[0][1],l[1][1]=+e[1][1],m):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},m.constrain=function(e){return arguments.length?(o=e,m):o},m.duration=function(e){return arguments.length?(c=+e,m):c},m.interpolate=function(e){return arguments.length?(d=e,m):d},m.on=function(){var e=h.on.apply(h,arguments);return e===h?m:e},m.clickDistance=function(e){return arguments.length?(p=(e=+e)*e,m):Math.sqrt(p)},m}().duration(0).on("start",e.onZoomStart.bind(e)).on("zoom",e.onZoom.bind(e)).on("end",e.onZoomEnd.bind(e));n.orgScaleExtent=function(){var n=t.zoom_extent||[1,10];return[n[0],Math.max(e.getMaxDataCount()/n[1],n[1])]},n.updateScaleExtent=function(){var t=Ia(e.x.orgDomain())/Ia(e.getZoomDomain()),n=this.orgScaleExtent();return this.scaleExtent([n[0]*t,n[1]*t]),this},n.updateTransformScale=function(n){var i=n.rescaleX(e.subX.orgScale()),o=e.trimXDomain(i.domain()),s=t.zoom_rescale;i.domain(o,e.orgXDomain),e.zoomScale=e.getCustomizedScale(i),e.xAxis.scale(e.zoomScale),s&&e.x.domain(e.zoomScale.orgDomain())},e.zoom=n},onZoomStart:function(){var e=this,t=mn.sourceEvent;e.zoom.altDomain=t.altKey?e.x.orgDomain():null,e.zoom.startEvent=t,Pa(e.config.zoom_onzoomstart,e.api,t)},onZoom:function(){var e=this,t=e.config,n=mn;if(t.zoom_enabled){var i="mousemove"===n.sourceEvent.type,o=n.transform;return e.zoom.updateTransformScale(o),0===e.filterTargetsToShow(e.data.targets).length?void 0:i&&e.zoom.altDomain?(e.x.domain(e.zoom.altDomain),void o.scale(e.zoomScale).updateScaleExtent()):(e.isCategorized()&&e.x.orgDomain()[0]===e.orgXDomain[0]&&e.x.domain([e.orgXDomain[0]-1e-10,e.x.orgDomain()[1]]),e.redraw({withTransition:!1,withY:t.zoom_rescale,withSubchart:!1,withEventRect:!1,withDimension:!1}),e.cancelClick=i,void Pa(t.zoom_onzoom,e.api,e.subX.domain()))}},onZoomEnd:function(){var e=this,t=e.zoom.startEvent;event&&t.clientX===event.clientX&&t.clientY===event.clientY||(e.redrawEventRect(),e.updateZoom(),Pa(e.config.zoom_onzoomend,e.api,e.subX.domain()))},getZoomDomain:function(){var e=this.config;return[Zn([this.orgXDomain[0],e.zoom_x_min]),Jn([this.orgXDomain[1],e.zoom_x_max])]},updateZoom:function(){var e=this;if(e.zoomScale){var t=e.zoomScale.domain(),n=e.subX.domain();(t[0]<=n[0]||t[0]-.015<=n[0])&&(n[1]<=t[1]||n[1]<=t[1]-.015)&&(e.xAxis.scale(e.subX),e.x.domain(e.subX.orgDomain()),e.zoomScale=null)}},bindZoomOnEventRect:function(e){var t="drag"===e?this.zoomBehaviour:this.zoom;this.main.select(".".concat(ks.eventRects)).call(t).on("dblclick.zoom",null)},initZoomBehaviour:function(){var e=this,t=e.config.axis_rotated,n=0,i=0,o=null;e.zoomBehaviour=qs().clickDistance(4).on("start",(function(){e.setDragStatus(!0),o||(o=e.main.append("rect").attr("clip-path",e.clipPath).attr("class",ks.zoomBrush).attr("width",t?e.width:0).attr("height",t?0:e.height)),n=Pn(this)[0],i=n,o.attr("x",n).attr("width",0),e.onZoomStart()})).on("drag",(function(){i=Pn(this)[0],o.attr("x",Math.min(n,i)).attr("width",Math.abs(i-n))})).on("end",(function(){var t,s=e.zoomScale||e.x;if(e.setDragStatus(!1),o.attr("x",0).attr("width",0),n>i&&(n=(t=[i,n])[0],i=t[1]),n<0&&(i+=Math.abs(n),n=0),n!==i)e.api.zoom([n,i].map((function(e){return s.invert(e)}))),e.onZoomEnd();else if(e.isMultipleX())e.clickHandlerForMultipleXS.bind(this)(e);else{var r=mn.sourceEvent||mn,l="clientX"in r?[r.clientX,r.clientY]:[r.x,r.y],c=a()(l,2),d=c[0],u=c[1],h=document.elementFromPoint(d,u);e.clickHandlerForSingleX.bind(h)(wn(h).datum(),e)}}))},setZoomResetButton:function(){var e=this,t=e.config,n=t.zoom_resetButton;n&&"drag"===t.zoom_enabled.type&&(e.zoom.resetBtn?e.zoom.resetBtn.style("display",null):e.zoom.resetBtn=e.selectChart.append("div").classed(ks.button,!0).append("span").on("click",e.api.unzoom.bind(e)).classed(ks.buttonZoomReset,!0).text(n.text||"Reset Zoom"))}});var Rc=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];Va(kr.prototype,{getColorFromCss:function(){var e=document.body,t=e.__colorPattern__;if(!t){var n=document.createElement("span");n.className=ks.colorPattern,n.style.display="none",e.appendChild(n);var i=window.getComputedStyle(n).backgroundImage;n.parentNode.removeChild(n),i.indexOf(";")>-1&&(t=i.replace(/url[^#]*|["'()]|(\s|%20)/g,"").split(";").map((function(e){return e.trim().replace(/[\"'\s]/g,"")})).filter(Boolean),e.__colorPattern__=t)}return t},generateColor:function(){var e=this,t=e.config,n=t.data_colors,i=t.data_color,o=[],s=Na(t.color_pattern)?t.color_pattern:nr(e.getColorFromCss()||Rc).range(),a=s;if(ba(t.color_tiles)){var r=t.color_tiles(),l=s.map((function(t,n){var i=t.replace(/[#\(\)\s,]/g,""),o="".concat(e.datetimeId,"-pattern-").concat(i,"-").concat(n);return function(e,t,n){var i=wn(e.cloneNode(!0));return i.attr("id",n).insert("rect",":first-child").attr("width",i.attr("width")).attr("height",i.attr("height")).style("fill",t),{id:n,node:i.node()}}(r[n%r.length],t,o)}));s=l.map((function(e){return"url(#".concat(e.id,")")})),e.patterns=l}return function(t){var r,l=t.id||t.data&&t.data.id||t,c=e.isTypeOf(l,["line","spline","step"])||!e.config.data_types[l];return ba(n[l])?r=n[l](t):n[l]?r=n[l]:(o.indexOf(l)<0&&o.push(l),r=c?a[o.indexOf(l)%a.length]:s[o.indexOf(l)%s.length],n[l]=r),ba(i)?i(r,t):r}},generateLevelColor:function(){var e=this.config,t=e.color_pattern,n=e.color_threshold,i="value"===n.unit,o=n.max||100,s=n.values&&n.values.length?n.values:[];return Na(n)?function(e){for(var n=t[t.length-1],a=0;a<s.length;a++)if((i?e:100*e/o)<s[a]){n=t[a];break}return n}:null}});var kc=function(e,t,n){var i=e.config,o="axis_".concat(t,"_tick_format");return(i[o]?i[o]:e.defaultValueFormat)(n)};Va(kr.prototype,{getYFormat:function(e){var t=this,n=t.yFormat,i=t.y2Format;return e&&!t.hasType("gauge")&&(n=t.defaultArcValueFormat,i=t.defaultArcValueFormat),function(e,o,s){return("y2"===t.axis.getId(s)?i:n).call(t,e,o)}},yFormat:function(e){return kc(this,"y",e)},y2Format:function(e){return kc(this,"y2",e)},defaultValueFormat:function(e){return fa(e)?+e:""},defaultArcValueFormat:function(e,t){return"".concat((100*t).toFixed(1),"%")},dataLabelFormat:function(e){var t=this.config.data_labels,n=function(e){return fa(e)?+e:""},i=n;return ba(t.format)?i=t.format:Sa(t.format)&&(i=t.format[e]?!0===t.format[e]?n:t.format[e]:function(){return""}),i}}),Va(kr.prototype,{addCache:function(e,t){var n=!!(arguments.length>2&&void 0!==arguments[2])&&arguments[2];this.cache[e]=n?this.cloneTarget(t):t},removeCache:function(e){var t=this;Fa(e).forEach((function(e){return delete t.cache[e]}))},getCache:function(e){var t=!!(arguments.length>1&&void 0!==arguments[1])&&arguments[1];if(t){for(var n,i=[],o=0;n=e[o];o++)n in this.cache&&i.push(this.cloneTarget(this.cache[n]));return i}return this.cache[e]||null},resetCache:function(e){for(var t in this.cache)(e||/^\$/.test(t))&&(this.cache[t]=null)}}),Va(kr.prototype,{CLASS:ks,generateClass:function(e,t){return" ".concat(e," ").concat(e+this.getTargetSelectorSuffix(t))},classText:function(e){return this.generateClass(ks.text,e.index)},classTexts:function(e){return this.generateClass(ks.texts,e.id)},classShape:function(e){return this.generateClass(ks.shape,e.index)},classShapes:function(e){return this.generateClass(ks.shapes,e.id)},generateExtraLineClass:function(){var e=this.config.line_classes||[],t=[];return function(n){var i=n.id||n.data&&n.data.id||n;return t.indexOf(i)<0&&t.push(i),e[t.indexOf(i)%e.length]}},classLine:function(e){return this.classShape(e)+this.generateClass(ks.line,e.id)},classLines:function(e){return this.classShapes(e)+this.generateClass(ks.lines,e.id)},classCircle:function(e){return this.classShape(e)+this.generateClass(ks.circle,e.index)},classCircles:function(e){return this.classShapes(e)+this.generateClass(ks.circles,e.id)},classBar:function(e){return this.classShape(e)+this.generateClass(ks.bar,e.index)},classBars:function(e){return this.classShapes(e)+this.generateClass(ks.bars,e.id)},classArc:function(e){return this.classShape(e.data)+this.generateClass(ks.arc,e.data.id)},classArcs:function(e){return this.classShapes(e.data)+this.generateClass(ks.arcs,e.data.id)},classArea:function(e){return this.classShape(e)+this.generateClass(ks.area,e.id)},classAreas:function(e){return this.classShapes(e)+this.generateClass(ks.areas,e.id)},classRegion:function(e,t){return"".concat(this.generateClass(ks.region,t)," ").concat("class"in e?e.class:"")},classEvent:function(e){return this.generateClass(ks.eventRect,e.index)},classTarget:function(e){var t=this.config.data_classes[e],n="";return t&&(n=" ".concat(ks.target,"-").concat(t)),this.generateClass(ks.target,e)+n},classFocus:function(e){return this.classFocused(e)+this.classDefocused(e)},classFocused:function(e){return" ".concat(this.focusedTargetIds.indexOf(e.id)>=0?ks.focused:"")},classDefocused:function(e){return" ".concat(this.defocusedTargetIds.indexOf(e.id)>=0?ks.defocused:"")},classChartText:function(e){return ks.chartText+this.classTarget(e.id)},classChartLine:function(e){return ks.chartLine+this.classTarget(e.id)},classChartBar:function(e){return ks.chartBar+this.classTarget(e.id)},classChartArc:function(e){return ks.chartArc+this.classTarget(e.data.id)},classChartRadar:function(e){return ks.chartRadar+this.classTarget(e.id)},getTargetSelectorSuffix:function(e){return e||0===e?"-".concat(e).replace(/[\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,"-"):""},selectorTarget:function(e,t){return"".concat(t||"",".").concat(ks.target+this.getTargetSelectorSuffix(e))},selectorTargets:function(e,t){var n=this,i=e||[];return i.length?i.map((function(e){return n.selectorTarget(e,t)})):null},selectorLegend:function(e){return".".concat(ks.legendItem+this.getTargetSelectorSuffix(e))},selectorLegends:function(e){var t=this;return e&&e.length?e.map((function(e){return t.selectorLegend(e)})):null}}),Va(Br.prototype,{focus:function(e){var t=this.internal,n=t.mapToTargetIds(e),i=t.svg.selectAll(t.selectorTargets(n.filter(t.isTargetToShow,t)));this.revert(),this.defocus(),i.classed(ks.focused,!0).classed(ks.defocused,!1),t.hasArcType()&&t.expandArc(n),t.toggleFocusLegend(n,!0),t.focusedTargetIds=n,t.defocusedTargetIds=t.defocusedTargetIds.filter((function(e){return n.indexOf(e)<0}))},defocus:function(e){var t=this.internal,n=t.mapToTargetIds(e);t.svg.selectAll(t.selectorTargets(n.filter(t.isTargetToShow,t))).classed(ks.focused,!1).classed(ks.defocused,!0),t.hasArcType()&&t.unexpandArc(n),t.toggleFocusLegend(n,!1),t.focusedTargetIds=t.focusedTargetIds.filter((function(e){return n.indexOf(e)<0})),t.defocusedTargetIds=n},revert:function(e){var t=this.internal,n=t.mapToTargetIds(e);t.svg.selectAll(t.selectorTargets(n)).classed(ks.focused,!1).classed(ks.defocused,!1),t.hasArcType()&&t.unexpandArc(n),t.config.legend_show&&(t.showLegend(n.filter(t.isLegendToShow.bind(t))),t.legend.selectAll(t.selectorLegends(n)).filter((function(){return wn(this).classed(ks.legendItemFocused)})).classed(ks.legendItemFocused,!1)),t.focusedTargetIds=[],t.defocusedTargetIds=[]}}),Va(Br.prototype,{show:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.internal,i=n.mapToTargetIds(e);n.removeHiddenTargetIds(i);var o=n.svg.selectAll(n.selectorTargets(i));o.transition().style("opacity","1","important").call(n.endall,(function(){o.style("opacity",null).style("opacity","1")})),t.withLegend&&n.showLegend(i),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},hide:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.internal,i=n.mapToTargetIds(e);n.addHiddenTargetIds(i);var o=n.svg.selectAll(n.selectorTargets(i));o.transition().style("opacity","0","important").call(n.endall,(function(){o.style("opacity",null).style("opacity","0")})),t.withLegend&&n.hideLegend(i),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},toggle:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.internal,o={show:[],hide:[]};i.mapToTargetIds(e).forEach((function(e){return o[i.isTargetToShow(e)?"hide":"show"].push(e)})),o.show.length&&this.show(o.show,n),o.hide.length&&setTimeout((function(){return t.hide(o.hide,n)}),0)}});var Bc=function(e){var t,n=this.internal,i=e;if(n.config.zoom_enabled&&i){if(n.isTimeSeries()&&(i=i.map((function(e){return n.parseDate(e)}))),n.config.subchart_show){var o=n.zoomScale||n.x;n.brush.getSelection().call(n.brush.move,[o(i[0]),o(i[1])]),t=i}else n.x.domain(i),n.zoomScale=n.x,n.xAxis.scale(n.zoomScale),t=n.zoomScale.orgDomain();n.redraw({withTransition:!0,withY:n.config.zoom_rescale,withDimension:!1}),n.setZoomResetButton(),Pa(n.config.zoom_onzoom,this,n.x.orgDomain())}else t=n.zoomScale?n.zoomScale.domain():n.x.orgDomain();return t};Va(Bc,{enable:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wheel",t=this.internal,n=t.config,i=e;e&&(i=va(e)&&/^(drag|wheel)$/.test(e)?{type:e}:e),n.zoom_enabled=i,t.zoom?!1===e&&t.bindZoomEvent(!1):(t.initZoom(),t.initZoomBehaviour(),t.bindZoomEvent()),t.updateAndRedraw()},max:function(e){var t=this.internal,n=t.config;return(0===e||e)&&(n.zoom_x_max=Jn([t.orgXDomain[1],e])),n.zoom_x_max},min:function(e){var t=this.internal,n=t.config;return(0===e||e)&&(n.zoom_x_min=Zn([t.orgXDomain[0],e])),n.zoom_x_min},range:function(e){var t=this.zoom;return La(e)&&(Ta(e.min)&&t.min(e.min),Ta(e.max)&&t.max(e.max)),{min:t.min(),max:t.max()}}}),Va(Br.prototype,{zoom:Bc,unzoom:function(){var e=this.internal,t=e.config;e.zoomScale&&(t.subchart_show?e.brush.getSelection().call(e.brush.move,null):e.zoom.updateTransformScale(Ic),e.updateZoom(),e.zoom.resetBtn&&e.zoom.resetBtn.style("display","none"),e.redraw({withTransition:!0,withY:t.zoom_rescale}))}}),Va(Br.prototype,{load:function(e){var t=this.internal,n=t.config;e.xs&&t.addXs(e.xs),"names"in e&&this.data.names(e.names),"classes"in e&&Object.keys(e.classes).forEach((function(t){n.data_classes[t]=e.classes[t]})),"categories"in e&&t.isCategorized()&&(n.axis_x_categories=e.categories),"axes"in e&&Object.keys(e.axes).forEach((function(t){n.data_axes[t]=e.axes[t]})),"colors"in e&&Object.keys(e.colors).forEach((function(t){n.data_colors[t]=e.colors[t]})),"unload"in e&&!1!==e.unload?t.unload(t.mapToTargetIds(!0===e.unload?null:e.unload),(function(){return t.loadFromArgs(e)})):t.loadFromArgs(e)},unload:function(e){var t=this.internal,n=e||{};Da(n)?n={ids:n}:va(n)&&(n={ids:[n]});var i=t.mapToTargetIds(n.ids);t.unload(i,(function(){t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),t.removeCache(i),n.done&&n.done()}))}}),Va(Br.prototype,{flow:function(e){var t,n,i,o,s=this.internal,a=[],r=s.getMaxDataCount(),l=0,c=0;if(e.json)t=s.convertJsonToData(e.json,e.keys);else if(e.rows)t=s.convertRowsToData(e.rows);else{if(!e.columns)return;t=s.convertColumnsToData(e.columns)}var d=s.convertDataToTargets(t,!0);s.data.targets.forEach((function(e){for(var t=!1,n=0;n<d.length;n++)if(e.id===d[n].id){t=!0,e.values[e.values.length-1]&&(c=e.values[e.values.length-1].index+1),l=d[n].values.length;for(var i=0;i<l;i++)d[n].values[i].index=c+i,s.isTimeSeries()||(d[n].values[i].x=c+i);e.values=e.values.concat(d[n].values),d.splice(n,1);break}t||a.push(e.id)})),s.data.targets.forEach((function(e){for(var t=0;t<a.length;t++)if(e.id===a[t]){c=e.values[e.values.length-1].index+1;for(var n=0;n<l;n++)e.values.push({id:e.id,index:c+n,x:s.isTimeSeries()?s.getOtherTargetX(c+n):c+n,value:null})}})),s.data.targets.length&&d.forEach((function(e){for(var t=[],n=s.data.targets[0].values[0].index;n<c;n++)t.push({id:e.id,index:n,x:s.isTimeSeries()?s.getOtherTargetX(n):n,value:null});e.values.forEach((function(e){e.index+=c,s.isTimeSeries()||(e.x+=c)})),e.values=t.concat(e.values)})),s.data.targets=s.data.targets.concat(d);var u=s.data.targets[0],h=u.values[0];Ta(e.to)?(l=0,o=s.isTimeSeries()?s.parseDate(e.to):e.to,u.values.forEach((function(e){e.x<o&&l++}))):Ta(e.length)&&(l=e.length),r?1===r&&s.isTimeSeries()&&(i=(u.values[u.values.length-1].x-h.x)/2,n=[new Date(+h.x-i),new Date(+h.x+i)],s.updateXDomain(null,!0,!0,!1,n)):(i=s.isTimeSeries()?u.values.length>1?u.values[u.values.length-1].x-h.x:h.x-s.getXDomain(s.data.targets)[0]:1,n=[h.x-i,h.x],s.updateXDomain(null,!0,!0,!1,n)),s.updateTargets(s.data.targets),s.redraw({flow:{index:h.index,length:l,duration:fa(e.duration)?e.duration:s.config.transition_duration,done:e.done,orgDataCount:r},withLegend:!0,withTransition:r>1,withTrimXDomain:!1,withUpdateXAxis:!0})}}),Va(kr.prototype,{generateFlow:function(e){var t=this,n=t.config;return function(){var i,o,s=e.targets,a=e.flow,r=e.drawBar,l=e.drawLine,c=e.drawArea,d=e.cx,u=e.cy,h=e.xv,p=e.xForText,m=e.yForText,_=e.duration,g=a.index,f=a.length,b=t.getValueOnIndex(t.data.targets[0].values,g),v=t.getValueOnIndex(t.data.targets[0].values,g+f),A=t.x.domain(),E=a.duration||_,T=a.done||function(){},C=t.generateWait(),y=t.xgrid||xn([]),M=t.xgridLines||xn([]),I=t.mainRegion||xn([]),S=t.mainText||xn([]),w=t.mainBar||xn([]),N=t.mainLine||xn([]),D=t.mainArea||xn([]),L=t.mainCircle||xn([]);t.flowing=!0,t.data.targets.forEach((function(e){e.values.splice(0,f)}));var O=t.updateXDomain(s,!0,!0);t.updateXGrid&&t.updateXGrid(!0),a.orgDataCount?i=1===a.orgDataCount||(b&&b.x)===(v&&v.x)||t.isTimeSeries()?t.x(A[0])-t.x(O[0]):t.x(b.x)-t.x(v.x):1===t.data.targets[0].values.length?t.isTimeSeries()?(b=t.getValueOnIndex(t.data.targets[0].values,0),v=t.getValueOnIndex(t.data.targets[0].values,t.data.targets[0].values.length-1),i=t.x(b.x)-t.x(v.x)):i=Ia(O)/2:i=t.x(A[0])-t.x(O[0]),o=Ia(A)/Ia(O);var P="translate(".concat(i,",0) scale(").concat(o,",1)");t.hideXGridFocus();var x=Ns().ease(Os).duration(E);C.add([t.axes.x.transition(x).call((function(e){return t.xAxis.setTransition(x).create(e)})),w.transition(x).attr("transform",P),N.transition(x).attr("transform",P),D.transition(x).attr("transform",P),L.transition(x).attr("transform",P),S.transition(x).attr("transform",P),I.filter(t.isRegionOnX).transition(x).attr("transform",P),y.transition(x).attr("transform",P),M.transition(x).attr("transform",P)]),x.call(C,(function(){var e=[],i=[],o=[];if(f){for(var s,a=0;a<f;a++)s=g+a,e.push(".".concat(ks.shape,"-").concat(s)),i.push(".".concat(ks.text,"-").concat(s)),o.push(".".concat(ks.eventRect,"-").concat(s));t.svg.selectAll(".".concat(ks.shapes)).selectAll(e).remove(),t.svg.selectAll(".".concat(ks.texts)).selectAll(i).remove(),t.svg.selectAll(".".concat(ks.eventRects)).selectAll(o).remove(),t.svg.select(".".concat(ks.xgrid)).remove()}y.size()&&y.attr("transform",null).attr(t.xgridAttr),M.attr("transform",null),M.select("line").attr("x1",n.axis_rotated?0:h).attr("x2",n.axis_rotated?t.width:h),M.select("text").attr("x",n.axis_rotated?t.width:0).attr("y",h),w.attr("transform",null).attr("d",r),N.attr("transform",null).attr("d",l),D.attr("transform",null).attr("d",c),L.attr("transform",null),t.isCirclePoint()?L.attr("cx",d).attr("cy",u):L.attr("x",(function(e){return d(e)-n.point_r})).attr("y",(function(e){return u(e)-n.point_r})).attr("cx",d).attr("cy",u),S.attr("transform",null).attr("x",p).attr("y",m).style("fill-opacity",t.opacityForText.bind(t)),I.attr("transform",null),I.select("rect").filter(t.isRegionOnX).attr("x",t.regionX.bind(t)).attr("width",t.regionWidth.bind(t)),n.interaction_enabled&&t.redrawEventRect(),T(),t.flowing=!1}))}}}),Va(Br.prototype,{selected:function(e){var t=this.internal,n=[];return t.main.selectAll(".".concat(ks.shapes+t.getTargetSelectorSuffix(e))).selectAll(".".concat(ks.shape)).filter((function(){return wn(this).classed(ks.SELECTED)})).each((function(e){return n.push(e)})),n},select:function(e,t,n){var i=this.internal,o=i.config;o.data_selection_enabled&&i.main.selectAll(".".concat(ks.shapes)).selectAll(".".concat(ks.shape)).each((function(s,a){var r=wn(this),l=s.data?s.data.id:s.id,c=i.getToggle(this,s).bind(i),d=o.data_selection_grouped||!e||e.indexOf(l)>=0,u=!t||t.indexOf(a)>=0,h=r.classed(ks.SELECTED);r.classed(ks.line)||r.classed(ks.area)||(d&&u?o.data_selection_isselectable(s)&&!h&&c(!0,r.classed(ks.SELECTED,!0),s,a):Ta(n)&&n&&h&&c(!1,r.classed(ks.SELECTED,!1),s,a))}))},unselect:function(e,t){var n=this.internal,i=n.config;i.data_selection_enabled&&n.main.selectAll(".".concat(ks.shapes)).selectAll(".".concat(ks.shape)).each((function(o,s){var a=wn(this),r=o.data?o.data.id:o.id,l=n.getToggle(this,o).bind(n),c=i.data_selection_grouped||!e||e.indexOf(r)>=0,d=!t||t.indexOf(s)>=0,u=a.classed(ks.SELECTED);a.classed(ks.line)||a.classed(ks.area)||c&&d&&i.data_selection_isselectable(o)&&u&&l(!1,a.classed(ks.SELECTED,!1),o,s)}))}}),Va(Br.prototype,{transform:function(e,t){var n=this.internal,i=["pie","donut"].indexOf(e)>=0?{withTransform:!0}:null;n.transformTo(t,e,i)}}),Va(kr.prototype,{transformTo:function(e,t,n){var i=this,o=!i.hasArcType(),s=n||{withTransitionForAxis:o};s.withTransitionForTransform=!1,i.transiting=!1,i.setTargetType(e,t),i.updateTargets(i.data.targets),i.updateAndRedraw(s)}}),Va(Br.prototype,{groups:function(e){var t=this.internal,n=t.config;return Ea(e)||(n.data_groups=e,t.redraw()),n.data_groups}});var Vc=function(e){var t=this.internal,n=t.config;return e?(n.grid_x_lines=e,t.redrawWithoutRescale(),n.grid_x_lines):n.grid_x_lines};Va(Vc,{add:function(e){return this.xgrids(this.internal.config.grid_x_lines.concat(e||[]))},remove:function(e){this.internal.removeGridLines(e,!0)}});var Uc=function(e){var t=this.internal,n=t.config;return e?(n.grid_y_lines=e,t.redrawWithoutRescale(),n.grid_y_lines):n.grid_y_lines};Va(Uc,{add:function(e){return this.ygrids(this.internal.config.grid_y_lines.concat(e||[]))},remove:function(e){this.internal.removeGridLines(e,!1)}}),Va(Br.prototype,{xgrids:Vc,ygrids:Uc});var Fc=function(e){var t=this.internal,n=t.config;return e?(n.regions=e,t.redrawWithoutRescale(),e):n.regions};Va(Fc,{add:function(e){var t=this.internal,n=t.config;return e?(n.regions=n.regions.concat(e),t.redrawWithoutRescale(),n.regions):n.regions},remove:function(e){var t=this.internal,n=t.config,i=e||{},o=Oa(i,"duration",n.transition_duration),s=Oa(i,"classes",[ks.region]),a=t.main.select(".".concat(ks.regions)).selectAll(s.map((function(e){return".".concat(e)})));return(o?a.transition().duration(o):a).style("opacity","0").remove(),a=n.regions,Object.keys(i).length?(a=a.filter((function(e){var t=!1;return!e.class||(e.class.split(" ").forEach((function(e){s.indexOf(e)>=0&&(t=!0)})),!t)})),n.regions=a):n.regions=[],a}}),Va(Br.prototype,{regions:Fc});var Hc=function(e){var t=this.internal.data.targets;return Ea(e)?t:t.filter((function(t){return e.indexOf(t.id)>=0}))};Va(Hc,{shown:function(e){return this.internal.filterTargetsToShow(this.data(e))},values:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;if(e){var i=this.data(e);i&&Da(i)&&(n=[],i.forEach((function(e){var i=e.values.map((function(e){return e.value}));t?n=n.concat(i):n.push(i)})))}return n},names:function(e){return this.internal.clearLegendItemTextBoxCache(),this.internal.updateDataAttributes("names",e)},colors:function(e){return this.internal.updateDataAttributes("colors",e)},axes:function(e){return this.internal.updateDataAttributes("axes",e)},min:function(){return this.internal.getMinMaxData().min},max:function(){return this.internal.getMinMaxData().max}}),Va(Br.prototype,{data:Hc}),Va(Br.prototype,{category:function(e,t){var n=this.internal,i=n.config;return arguments.length>1&&(i.axis_x_categories[e]=t,n.redraw()),i.axis_x_categories[e]},categories:function(e){var t=this.internal,n=t.config;return arguments.length?(n.axis_x_categories=e,t.redraw(),n.axis_x_categories):n.axis_x_categories}}),Va(Br.prototype,{color:function(e){return this.internal.color(e)}}),Va(Br.prototype,{x:function(e){var t=this.internal,n=t.isCustomX()&&t.isCategorized();return Da(e)&&(n?t.api.categories(e):(t.updateTargetX(t.data.targets,e),t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}))),n?t.api.categories():t.data.xs},xs:function(e){var t=this.internal;return La(e)&&(t.updateTargetXs(t.data.targets,e),t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),t.data.xs}});var zc=function(e,t,n){var i=e.config,o="axis_x_".concat(t),s="axis_y_".concat(t),a="axis_y2_".concat(t);Ta(n)&&(Sa(n)?(fa(n.x)&&(i[o]=n.x),fa(n.y)&&(i[s]=n.y),fa(n.y2)&&(i[a]=n.y2)):(i[s]=n,i[a]=n),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}))},Wc=function(e,t){var n=e.config,i="axis_x_".concat(t),o="axis_y_".concat(t),s="axis_y2_".concat(t);return{x:n[i],y:n[o],y2:n[s]}},Gc=Va((function(){}),{labels:function(e){var t=this.internal;arguments.length&&(Object.keys(e).forEach((function(n){t.axis.setLabelText(n,e[n])})),t.axis.updateLabels())},min:function(e){var t=this.internal;return arguments.length?zc(t,"min",e):Wc(t,"min")},max:function(e){var t=this.internal;return arguments.length?zc(t,"max",e):Wc(t,"max")},range:function(e){var t=this.axis;if(!arguments.length)return{max:t.max(),min:t.min()};Ta(e.max)&&t.max(e.max),Ta(e.min)&&t.min(e.min)}});Va(Br.prototype,{axis:Gc});var Kc=Va((function(){}),{show:function(e){var t=this.internal;t.showLegend(t.mapToTargetIds(e)),t.updateAndRedraw({withLegend:!0})},hide:function(e){var t=this.internal;t.hideLegend(t.mapToTargetIds(e)),t.updateAndRedraw({withLegend:!0})}});Va(Br.prototype,{legend:Kc});var Yc=Ta(window)&&window.Math===Math?window:Ta(self)&&(self.Math===Math?self:Function("return this")());Yc.document,Va(Br.prototype,{resize:function(e){var t=this.internal.config;t.size_width=e?e.width:null,t.size_height=e?e.height:null,this.flush()},flush:function(e){var t=this.internal;t.zoomScale=null,e?t.redraw({withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withLegend:!0}):t.updateAndRedraw({withLegend:!0,withTransition:!1,withTransitionForTransform:!1})},destroy:function(){var e=this,t=this.internal;return Na(t)&&(t.charts.splice(t.charts.indexOf(this),1),Ta(t.resizeTimeout)&&Yc.clearTimeout(t.resizeTimeout),Yc.removeEventListener("resize",t.resizeFunction),t.selectChart.classed("bb",!1).html(""),Object.keys(this).forEach((function(n){"internal"===n&&Object.keys(t).forEach((function(e){t[e]=null})),e[n]=null,delete e[n]}))),null},config:function(e,t,n){var i,o=this.internal,s=e&&e.replace(/\./g,"_");return s in o.config&&(Ta(t)?(o.config[s]=t,i=t,n&&this.flush(!0)):i=o.config[s]),i}});var jc=Va((function(){}),{show:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.internal;n.mouse&&(t=n.mouse),n.data?i.isMultipleX()?(t=[i.x(n.data.x),i.getYScale(n.data.id)(n.data.value)],e=null):e=fa(n.data.index)?n.data.index:i.getIndexByX(n.data.x):Ta(n.x)?e=i.getIndexByX(n.x):Ta(n.index)&&(e=n.index),("mouse"===i.inputType?["mouseover","mousemove"]:["touchstart"]).forEach((function(n){i.dispatchEvent(n,e,t)}))},hide:function(){var e=this.internal;e.hideTooltip(),e.hideXGridFocus(),e.unexpandCircles(),e.unexpandBars()}});Va(Br.prototype,{tooltip:jc});var Qc=window.navigator.userAgent;Va(kr.prototype,{isSafari:function(){return Qc.indexOf("Safari")>-1&&!this.isChrome()},isChrome:function(){return Qc.indexOf("Chrome")>-1},isMobile:function(){return Qc.indexOf("Mobi")>-1}});var qc=function(e){var t=e.getBoundingClientRect(),n=e.cloneNode(!0),i=function(e){var t=[];return e.forEach((function(e){try{e.cssRules&&e.cssRules.length&&(t=t.concat(Fa(e.cssRules)))}catch(t){console.error("Error while reading rules from ".concat(e.href,": ").concat(t.toString()))}})),t}(Fa(document.styleSheets)).filter((function(e){return e.cssText})).map((function(e){return e.cssText}));n.setAttribute("xmlns",mt.xhtml);var o=(new XMLSerializer).serializeToString(n),s='<svg xmlns="'.concat(mt.svg,'" width="').concat(t.width,'" height="').concat(t.height,'">\n\t\t\t<foreignObject width="100%" height="100%">\n\t\t\t\t<style>').concat(i.join("\n"),"</style>\n\t\t\t\t").concat(o,"\n\t\t\t</foreignObject></svg>").replace(/#/g,"%23").replace("/\n/g","%0A");return"data:image/svg+xml;base64,".concat(btoa(encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x".concat(t))}))))};Va(Br.prototype,{export:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",t=arguments.length>1?arguments[1]:void 0,n=qc(this.element);if(ba(t)){var i=new Image;i.crosssOrigin="Anonymous",i.onload=function(){var n=document.createElement("canvas"),o=n.getContext("2d");n.width=i.width,n.height=i.height,o.drawImage(i,0,0),n.toBlob((function(e){t(window.URL.createObjectURL(e))}),e)},i.src=n}return n}}),n.d(t,"bb",(function(){return Jc}));var Jc={version:"1.6.2-nightly-20181204182425",generate:function(e){var t=new Br(e);return t.internal.charts=this.instance,this.instance.push(t),t},instance:[],chart:{fn:Br.prototype,internal:{fn:kr.prototype,axis:{fn:Rr.prototype}}}};t.default=Jc}])},e.exports=i()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(4),a=n(1299),r=n(486),l=n(82),c=n(507),d=(n(203),s.View.extend({tagName:"section",className:"lyWrap",template:i.template(a),attributes:{"data-viewname":"DCropView"},ui:{cropWrap:"._cropWrap",btnComplete:"._btnComplete",btnCancel:"._btnCancel",btnCamera:"._btnCamera"},events:{"click @ui.btnComplete":"_cropComplete","click @ui.btnCancel":"_cropCancel"},initialize:function(e){this.cropFile=this._getCropFile(e.cropFile),this.cropOptions=e.cropOptions,this.currentWidthRatio=1,this.currentHeightRatio=1,this.currentCoords=null,this._isPageBand=e.cropOptions.isPageBand},templateContext:function(){return{viewId:this.cid,isPageBand:this._isPageBand}},_getCropFile:function(e){return l.make(e,l.TYPE.e1280_std)},_cropComplete:function(){var e=t("<canvas>")[0],n=e.getContext("2d"),i=parseInt(this.currentCoords.lw*this.currentWidthRatio),o=parseInt(this.currentCoords.lh*this.currentHeightRatio),s=parseInt(this.currentCoords.lx*this.currentWidthRatio),a=parseInt(this.currentCoords.ly*this.currentHeightRatio);e.setAttribute("width",i),e.setAttribute("height",o),n.clearRect(0,0,i,o),n.drawImage(this._originalImg[0],s,a,i,o,0,0,i,o);var r=e.toDataURL("image/png");this.trigger("crop:complete",r)},_cropCancel:function(){this.trigger("crop:cancel")},_createCropper:function(){var e=this,n=null,o=null;this._originalImg=t("<img>"),this._originalImg.attr("src",this.cropFile),this._originalImg.on("load",(function(){n=this.width,o=this.height,e.ui.cropWrap.cropper(t.extend(e.cropOptions,{file:e.cropFile,onSelect:function(t){e.currentCoords=t,i.defer((function(){e.currentWidthRatio=n/e.$(".jcrop-holder").width(),e.currentHeightRatio=o/e.$(".jcrop-holder").height()}))}}))}))},_initImageChangeUploader:function(){this._imageUploader&&(this._imageUploader=null);var e=n(600);this._imageUploader=e.createSinglePhotoUploader(this.ui.btnCamera,{multiple:!1,showProgress:!0,autoUpload:!1,fileInputTitle:window.webkitURL?" ":""}),this.listenTo(this._imageUploader,c.SELECT_FILES,(function(e){this._imageUploader.loadFileReaderResize(e.files[0]).then(i.bind((function(e){this._changeCropImage(e)}),this))}))},_changeCropImage:function(e){this.cropFile=this._getCropFile(e),this._createCropper()},onAttach:function(){this._createCropper(),this._initImageChangeUploader(),this._isPageBand&&this.getUI("cropWrap").addClass("pageImageCrop")},onBeforeDetach:function(){this._imageUploader&&(this._imageUploader.destroy(),this._imageUploader=null)}}));return d.Model=o.Model.extend({}),d.build=function(e,t){var n=new d.Model,o=i.extend({bgColor:"#fff",maxSize:[340,340],minSize:[50,50],selection:"90%",aspectRatio:1},t.cropOptions);n.set("title",t.title);var s=new d({model:n,cropFile:e,cropOptions:o});return r.open(s),s},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(54),o=n(567),s=null,a={getCachedStartDayOfWeek:function(){return s||(s=t.Deferred(),i.getUserConfig("first_day_of_week").then((function(e){if(!e||!e[0])return s.resolve(o.DAYS.SUNDAY),void(s=null);s.resolve(o.findDayOfWeekByString(e[0].value))}),(function(){s=null})),s)},getCachedStartDayNum:function(){return a.getCachedStartDayOfWeek().then((function(e){return e.getDayNumber()}))},changeStartDayOfWeek:function(e){return i.setUserConfig({key:"first_day_of_week",value:e}).then((function(){s=null}))}};return a}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(4),s=n(1369),a=n(780),r=n(486),l=n(1370),c=n(1373),d=n(1034),u={MEMBER_SELECTED:"member:selected",SELECTION_COUNT_EXCEEDED:"bandMember:selection:countExceeded"},h=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DSimpleMemberSelectView"},template:t.template(s),templateContext:function(){return{viewWidth:t.isNull(this._viewWidth)?"480px":this._viewWidth+"px"}},ui:{selectedMemberListRegion:"._selectedMemberListRegion",memberSelectionListRegion:"._memberSelectionListRegion",groupMemberSelectBtnArea:"._groupMemberSelectBtnArea",btnMemberGroupSelect:"._btnMemberGroupSelect",inputSearchQuery:"._inputSearchQuery",selectedMembersWrap:"._selectedMembersWrap",memberListWrap:"._memberListWrap",formSearch:"._formSearch",btnSearch:"._btnSearch",btnConfirm:"._btnConfirm",btnCancel:"._btnCancel"},events:{"keyup @ui.inputSearchQuery":function(e){e.preventDefault();var t=this.getUI("inputSearchQuery").val();return t.trim()?this.getUI("btnSearch").prop("disabled",!1).removeClass("-disabled").addClass("-active"):(this.getUI("btnSearch").removeClass("-active").addClass("-disabled").prop("disabled",!0),t||this.allMemberRendered||this._showAllMembers(e)),!1},"click @ui.btnSearch":function(e){return e.preventDefault(),this._showSearchedMembers(e),this.ui.inputSearchQuery.focus(),!1},"submit @ui.formSearch":function(e){return!1},"click @ui.btnCancel":"destroy","click @ui.btnConfirm":function(){this.trigger(u.MEMBER_SELECTED,this._selectedMemberListView.collection),this.destroy()},"click @ui.btnMemberGroupSelect":function(e){e.preventDefault();var n=d.buildMemberGroupSelectView(this._bandData.getBandCore().bandNo);this.listenToOnce(n,"memberGroupView:selectedMemberGroups",(function(e){if(!t.isEmpty(e)){var n=t.chain(e).filter((function(e){return!this.collection.isExcludedUserNo(e.userNo)}),this).filter((function(e){return!t.contains(this._selectedMemberListView.getSelectedUserNos(),e.userNo)}),this).map((function(e){return a.createSimpleMemberViewModel(e.userNo,e.name,e.description,e.profileImageUrl,e.role)})).value();t.isEmpty(n)||this._memberSelectionListView.addMembersByMemberGroupSelect(n)}}))}},regions:{selectedMemberListRegion:{el:"@ui.selectedMemberListRegion",replaceElement:!0},memberSelectionListRegion:{el:"@ui.memberSelectionListRegion",replaceElement:!0}},initialize:function(e){this._bandData=e.bandData,this._maxSelectionCount=e.maxSelectionCount,this._supportMemberGroup=1==e.supportMemberGroup,this._viewWidth=e.viewWidth,this._initMemberSelectionListView(),this._initSelectedMemberListView()},onAttach:function(){this._showSelectedMembers(),this._showMemberSelectionListView(),this._showAllMembers(),this.ui.inputSearchQuery.focus()},_initMemberSelectionListView:function(){this._memberSelectionListView=new l({bandData:this._bandData,collection:this.collection}),this._memberSelectionListView.on(l.EVENT.BAND_MEMBER_SELECTED,t.bind((function(e){var n=this._selectedMemberListView.collection.length,i=e.length;if(this._maxSelectionCount&&n+i>this._maxSelectionCount){var o=this._maxSelectionCount-n,s=i-o;this._memberSelectionListView.deselectChildSilently(t.last(e,s)),e=t.first(e,o),t.defer(t.bind((function(){this.trigger(u.SELECTION_COUNT_EXCEEDED)}),this))}t.isEmpty(e)||(this._selectedMemberListView.addSelectedMembers(e),this._configureSelectedMemberListViewWrap(),this._configureConfirmButton())}),this)),this._memberSelectionListView.on(l.EVENT.BAND_MEMBER_DESELECTED,t.bind((function(e){this._selectedMemberListView.removeSelectedMembers(e),this._configureSelectedMemberListViewWrap(),this._configureConfirmButton()}),this))},_initSelectedMemberListView:function(){this._selectedMemberListView=new c({collection:new i.Collection(null,{model:a})}),this._selectedMemberListView.on(c.EVENT.BAND_MEMBER_DESELECTED,t.bind((function(e){this._memberSelectionListView.deselectChildSilently([e]),this._configureSelectedMemberListViewWrap(),this._configureConfirmButton()}),this))},_configureSelectedMemberListViewWrap:function(){this._selectedMemberListView.collection.length>0?this.getUI("selectedMembersWrap").show():this.getUI("selectedMembersWrap").hide()},_configureConfirmButton:function(){this._selectedMemberListView.collection.length>0?this.getUI("btnConfirm").prop("disabled",!1):this.getUI("btnConfirm").prop("disabled",!0)},_showSelectedMembers:function(){this.showChildView("selectedMemberListRegion",this._selectedMemberListView)},_showMemberSelectionListView:function(){this.showChildView("memberSelectionListRegion",this._memberSelectionListView,{preventDestroy:!0})},_showAllMembers:function(e){var n=this._selectedMemberListView.getSelectedUserNos();this._memberSelectionListView.searchMembers("",n).then(t.bind((function(){this.allMemberRendered=!0,this._showGroupMemberSelectButton()}),this))},_showGroupMemberSelectButton:function(){this._supportMemberGroup&&this._memberSelectionListView.hasMemberGroup()&&this.ui.groupMemberSelectBtnArea.toggle(!this.collection.isEmpty())},_showSearchedMembers:function(e){var n=this.ui.inputSearchQuery.val();if(n){var i=this._selectedMemberListView.getSelectedUserNos();this._memberSelectionListView.searchMembers(n,i).then(t.bind((function(){this.allMemberRendered=!1}),this))}}});return h.EVENT=u,h.openAsLayerWithOption=function(e){var t=new h({bandData:e.bandData,collection:e.collection,maxSelectionCount:e.maxSelectionCount,supportMemberGroup:e.supportMemberGroup,viewWidth:e.viewWidth||null});return r.open(t),t},h.openAsLayer=function(e,n,i,o,s){if(!t.isFunction(n.search)){var r=a.createVirtualMemberForAllMemberSelection(e.getCoverUrl(),n.length);n.add(r,{at:0})}return h.openAsLayerWithOption({bandData:e,collection:n,maxSelectionCount:i,supportMemberGroup:o,viewWidth:s||null})},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(580),n(1060)),o=n(698),s=n(158),a=n(156),r=n(13),l=n(82),c=n(9),d=n(508),u=n(497),h=n(16),p=n(1050),m=n(22),_=n(163),g=n(596),f=n(699),b=new g(130,130);return{buildMoreButtonDCommentModel:function(e,t){var n={commentId:e?d.PREVIOUS_MORE_BUTTON_ID:d.NEXT_MORE_BUTTON_ID,isPreviousMoreButton:e,isNextMoreButton:!e,modificationMode:!1,isReply:t};return i.buildDCommentViewModel(n)},_buildCommonDCommentAttrs:function(e,n,i,o,a,r){if(t.isEmpty(e.getBody())&&t.isEmpty(e.getAuthorUserNo())&&t.isEmpty(e.getAuthorName()))return{};var d=i.clone();d.setContentTypeByKey(e.getContentType()),d.setCommentId(e.getCommentId());var h=n.supportMentionClick(),p=s.convertText(e.getBody(),null,!h,!0),g=e.isRestricted(),f=e.isMutedAuthorComment()&&!g&&o!=e.getAuthorUserNo(),v=e.isVisibleOnlyToAuthor()&&!g&&!a,A=!1,E=null,T=null,C={};return null!=e.getStickerPackNo()&&null!=e.getStickerId()&&(A=!0,E=l.makeStickerImageUrl(e.getStickerPackNo(),e.getStickerId()),T=l.makeAniStickerImageUrl(e.getStickerPackNo(),e.getStickerId(),e.getStickerResourceType()),C=b.calcurate({width:e.getStickerImageWidth(),height:e.getStickerImageHeight()})),{bandNo:n.bandNo,bandCore:n,contents:p,contentKey:d,commentId:e.getCommentId(),originCommentId:e.getOriginCommentId(),body:e.getBody(),longRelativeAddTime:c.format.date(e.getCreatedAt(),"short_date_time"),authorUserNo:e.getAuthorUserNo(),authorName:e.getAuthorName(),authorNickname:e.getAuthorNickname(),authorRealName:e.getAuthorRealName(),authorThumbnail:l.makeProfileThumbnailUrl(e.getAuthorThumbnail()),authorRole:u.parseRole(e.getAuthorRole()),authorMemberType:e.getAuthorMemberType(),authorMemberProfile:new _({name:e.getAuthorName(),profileImageUrl:e.getAuthorThumbnail(),memberType:e.getAuthorMemberType()}),isCertifiedAuthor:e.isCertifiedAuthor(),isAuthorPageProfileMemberType:e.getAuthorMemberType()==m.MEMBER_TYPE.PAGE_PROFILE,isRestricted:g,isSecret:e.isSecret(),isSecretKnownToViewer:e.isSecretKnownToViewer(),isMutedComment:f,isHiddenComment:v,showEmotionArea:r,isAudioExist:e.getAudioDuration()&&e.getAudioDuration()>-1,audioDuration:e.getAudioDuration(),isPhotoExist:!t.isEmpty(e.getPhotos()),isMultiplePhotoAttached:!t.isEmpty(e.getPhotos())&&e.getPhotos().length>1,photos:e.getPhotos(),photoCount:e.getPhotoCount(),isVideoExist:null!=e.getVideoThumbnail(),videoThumbnail:e.getVideoThumbnail(),videoWidth:e.getVideoWidth(),videoHeight:e.getVideoHeight(),isGifVideo:e.isGifVideo(),videoExpiresAt:e.getVideoExpiresAt(),isStickerExist:A,stickerImageUrl:E,aniStickerImageUrl:T,stickerPackNo:e.getStickerPackNo(),stickerId:e.getStickerId(),stickerImageWidth:e.getStickerImageWidth(),stickerImageHeight:e.getStickerImageHeight(),stickerResourceType:e.getStickerResourceType(),convertedStickerWidth:C.width,convertedStickerHeight:C.height,snippetDescription:e.getSnippetDescription(),snippetDomain:e.getSnippetDomain(),snippetImage:l.make(e.getSnippetImage(),l.TYPE.ff640_640),snippetTitle:e.getSnippetTitle(),snippetType:e.getSnippetType(),snippetUrl:e.getSnippetUrl(),isSnippetExist:e.isSnippetExist(),emotionCount:e.getEmotionCount(),commonEmotionType:e.getCommonEmotionType(),emotionTypeByViewer:e.getEmotionTypeByViewer(),isVisibleOnlyToAuthor:e.isVisibleOnlyToAuthor(),isPossibleToRecover:!1,hasHiddenCommentInfo:!1}},buildByDetailDComment:function(e,n,s,l,d,u,m){if(t.isEmpty(e.getBody())&&t.isEmpty(e.getAuthorUserNo())&&t.isEmpty(e.getAuthorName()))return null;var _,g=n.getBandCore(),b=this._buildCommonDCommentAttrs(e,g,s,d,u,m),v=b.isRestricted,A=b.isAudioExist,E=b.isSecret,T=b.isSecretKnownToViewer,C=b.isMutedComment,y=b.contentKey,M=b.contents;_=l?n.canModifyCommentReplyOfUser(e.getAuthorMemberType(),e.getAuthorUserNo()):n.canModifyCommentOfUser(e.getAuthorMemberType(),e.getAuthorUserNo());var I=E&&!T,S=!v&&(M||!A)&&_&&!b.isHiddenComment,w=!v&&n.canReportContentOfAuthor(e.getAuthorUserNo(),e.getAuthorMemberType())&&!I,N=n.canDeleteOneCommentOfUser(e.getAuthorMemberType(),e.getAuthorUserNo()),D=r.isLogedIn()&&e.getAuthorUserNo()==r.getUserData().getUserNo(),L=b.isAuthorPageProfileMemberType,O=!v&&n.canHideComment()&&!D&&!L,P=!v&&n.canHideComment(),x=!v&&n.canRecoverHiddenComment(),R=!v&&null!=e.getPunishment(),k=y.makeContentUrl(g),B=null!=k&&!I&&!b.isHiddenComment,V=s.clone();V.setContentType(s.getContentType().getReplyContentType()),V.setOriginCommentId(e.getCommentId());var U=p.build();U.resetProperties({isTranslatable:e.isTranslatable(),writtenIn:e.getWrittenIn(),content:e.getBody()});var F,H=null!=e.getFileName(),z=null!=e.getDropboxFileName(),W=null!=e.getExternalFileName(),G=U.supportsMoreOption()&&!v,K=!v&&n.canMuteOtherMemberContent()&&!D&&!e.isMutedAuthorComment()&&!b.isHiddenComment,Y=n.canOpenCommentOption()&&(S||N||w||O||G||B||K),j=t.extend(b,{shortRelativeAddTime:(F=e.getCreatedAt(),c.format.relative(F,"year_month_day",[{start:h.duration(1,"days").asMilliseconds(),end:h.duration(6,"months").asMilliseconds(),style:"month_day_time"}])),videoId:e.getVideoId(),isFileExist:H,expiresAt:e.getExpires(),fileName:e.getFileName(),fileId:e.getFileId(),fileSiUnit:a.toStringFileSize(e.getFileSize()),fileSize:e.getFileSize(),isDropboxFileExist:z,dropboxFileLink:e.getDropboxFileLink(),dropboxFileName:e.getDropboxFileName(),dropboxFileId:e.getDropboxFileId(),dropboxFileSize:a.toStringFileSize(e.getDropboxFileSize()),isExternalFileExist:W,externalFileLink:e.getExternalFileLink(),externalFileName:e.getExternalFileName(),externalFileId:e.getExternalFileId(),externalFileSize:a.toStringFileSize(e.getExternalFileSize()),externalFileSource:e.getExternalFileSource(),showOptionButton:Y,contentsDeletionPermitted:N,isPossibleToReport:w,isModifiable:S,punishedAt:h(e.getPunishedAt()).format("MMMM Do a h:mm"),punishTitle:o.makePunishTitle(e),translationChannel:U,translatable:G,latestComment:e.getLatestComment(),replyCount:e.getCommentCount()||0,contentKeyForReply:V,contentUrl:k,isContentUrlExist:B,isReply:l,isSecretAndUnknownToViewer:I,isPreviousMoreButton:!1,isNextMoreButton:!1,modificationMode:!1,isSmallBox:!1,isPossibleToHide:O,hasHideCommentPermit:P,isPossibleToRecover:x,hasHiddenCommentInfo:R,muteIgnoredAuthorUserNo:d,isHiddenFilterIgnored:u,isMuteMemberAvailable:K});return i.buildDCommentViewModel(f.removeAttrsIfMuteComment(j,C))},buildBySimpleDComment:function(e,n,s,a,r,l){if(t.isEmpty(e.getBody())&&t.isEmpty(e.getAuthorUserNo())&&t.isEmpty(e.getAuthorName()))return null;var d=this._buildCommonDCommentAttrs(e,n,s,r,l,a),u=d.isMutedComment,h=o.simpleCommentAttachFileAttrs(e),p=t.extend(d,h,{shortRelativeAddTime:c.format.relative(e.getCreatedAt()),isSmallBox:!0,isModifiable:!1,isPreviousMoreButton:!1,isNextMoreButton:!1,showOptionButton:!1});return i.buildDCommentViewModel(f.removeAttrsIfMuteComment(p,u))}}}.call(t,n,t,e))||(e.exports=i)},,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(498),s=n(499),a=n(488),r={html:t.memoize((function(e,n){return e=e||s.Size.MEDIUM,t.template(o)({_loading_size:e,middleClass:n||""})})),view:function(e){return new i.View({className:e.className,template:function(){return r.html(e.loadingSize,e.middleClass)}})}};return r.Size=s.Size,r.MiddleClass=a.ELEMENT,r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(1395),a=n(522),r=n(525),l=n(13),c=n(491),d=(n(509),n(487)),u=n(22);n(1148);var h=[a.great,a.funny,a.like,a.shocked,a.sad,a.angry],p=o.View.extend({tagName:"div",className:"uEmotionSelect -active",attributes:{"data-viewname":"DEmotionSelectView"},behaviors:[d],template:t.template(s),ui:{selectBtn:"._selectBtn",arrow:"._arrow",btnSelProfile:"._btnSelProfile",selProfile:"._selProfile",btnChangeMemberProfile:"._btnChangeMemberProfile"},events:{click:function(){return!1},"click @ui.selectBtn":function(e){return this.__clicked||(this.__clicked=!0,this.$el.removeClass("-active"),this._setEmotion(i(e.currentTarget).data("emotionType")).then(t.bind((function(e){var n=t.propertyOf(e.emotion)("index"),i=t.propertyOf(e.emotion)("type"),o=t.propertyOf(e.emotion)("actor"),s=o?o.member_type:null,r={emotionCount:e.emotion_count,commonEmotionType:e.common_emotion_type};this._bandData.getBandCore().showSelectedEmotion(s)&&(r.emotionTypeByViewer=i),!n&&i&&(n=a.getChatEmotionTypeCode(i)),this._sendJplLog(n),this.trigger("DEmotionSelectView:changeEmotion",r)}),this))),!1},"click @ui.btnSelProfile":function(e){return this.getUI("selProfile").toggleClass("-active"),!1},"click @ui.btnChangeMemberProfile":function(e){var t=i(e.currentTarget),n=t.attr("data-member-type");return this.getUI("btnSelProfile").html(t.html()),this.getUI("btnChangeMemberProfile").removeClass("-outline"),t.addClass("-outline"),this.getUI("selProfile").attr("data-member-type",n).removeClass("-active"),this._setSelectedMemberProfileType(n),!1}},templateContext:function(){return{isChangeableProfiles:this._isChangeableProfiles,memberProfiles:this._memberProfiles,selectedMemberType:this._selectedMemberType,selectedMemberProfile:this._selectedMemberProfile}},initialize:function(e){this._emotionTypeByViewer=e.emotionTypeByViewer,this._bandNo=e.bandNo,this._userNo=l.getUserData().getUserNo(),this._contentKey=e.contentKey,this._chatEmotion=1==e.chatEmotion,this._channelId=e.channelId,this._dataFetched=!1},serializeData:function(){return{emotions:t.map(a.getDetailAttributes(h),(function(e){return e.selected=e.type===this.selected,e}),{selected:this._emotionTypeByViewer})}},onDomRefresh:function(){if(!this._dataFetched)return!1;this.isAttached()||this.$el.css("visibility","hidden"),this._chatEmotion?this._setChatPosition():this._contentKey.getContentType().isCommentOrReplyType()&&this._setCommentArrrowPosition(),this.getUI("btnSelProfile").DUProfile({memberProfile:this._selectedMemberProfile,description:IM("page_band.emotion.select_profile.label",{name:this._selectedMemberProfile.name})});var e=t.chain(this._memberProfiles).map((function(e){return[e.memberType,e]})).object().value();this.getUI("btnChangeMemberProfile").each(t.bind((function(t,n){var o=i(n);o.DUProfile({memberProfile:e[o.data("member-type")],description:IM("page_band.emotion.select_profile.label",{name:e[o.data("member-type")].name})})}),this))},onAttach:function(){c.getCachedBandData(this._bandNo).then(t.bind((function(e){this._bandData=e,this._memberProfiles=e.getSelectableMemberProfilesAtEmotion(),this._dataFetched=!0,this._setChangeableProfiles(),this._selectMemberType(),this.render()}),this)),this.$el.css("visibility","")},_setChangeableProfiles:function(){this._isChangeableProfiles=this._memberProfiles.length>1,this._isChangeableProfiles&&this.$el.addClass("-isChangeableProfiles")},_selectMemberType:function(){this._selectedMemberType=this._bandData.getCurrentSelectedMemberProfileMemberTypeAtEmotion(),this._selectedMemberProfile=t.find(this._memberProfiles,t.bind((function(e){return e.memberType===this._selectedMemberType}),this))},_setSelectedMemberProfileType:function(e){this._selectedMemberType=e,this._bandData.setCurrentSelectedMemberProfileMemberTypeAtEmotion(e)},_setCommentArrrowPosition:function(){var e=(this.$el.closest(".func").offset()||this.$el.closest(".commentBody").offset()).left-this.$el.offset().left,t=this.$el.closest(".emotionSection");e+=t.position().left+t.width()/2-this.ui.arrow.width()/2,this.ui.arrow.css("left",Math.ceil(e-7)+"px")},_setChatPosition:function(){this.$el.offset().left<0&&this.$el.addClass("-positionLeft")},_setEmotion:function(e){var t=null;if(e===this._emotionTypeByViewer&&this._selectedMemberType===u.MEMBER_TYPE.MEMBERSHIP&&(e=a.none),this._chatEmotion)return t={emotion:{type:e}},i.Deferred().resolve(t);var n={band_no:this.getOption("bandNo"),content_key:this._contentKey.toApiParams(!0),type:e};return this._isChangeableProfiles&&(n.member_type=this._selectedMemberType),r.setEmotions(n)},_sendJplLog:function(e){if(e){var n={};if(this._bandData.getBandCore().type===u.BAND_TYPE.PAGE&&(n.is_preview=""+!this._isChangeableProfiles),t.extend(n,{emotion_index:e,band_no:this._bandNo}),this._contentKey){var i=this._contentKey.clone();i.setContentType(null),i.setCommentId(null),i.setOriginCommentId(null),t.extend(n,i.toApiParams())}var o=d.CLASSIFIER.EMOTION;this._chatEmotion&&(o=d.CLASSIFIER.CHAT_MESSAGE_EMOTION,n.channel_id=this._channelId),this.jplCreate(o,n)}}});return p.buildChatEmotionSelectView=function(e,t,n){return new p({emotionTypeByViewer:e,channelId:n,bandNo:t,chatEmotion:!0})},p.buildDEmotionSelectViewByContentKey=function(e){return new p({bandNo:e.bandNo,contentKey:e.contentKey,emotionTypeByViewer:e.emotionTypeByViewer,chatEmotion:!1})},p}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,function(e,t,n){var i=n(0);function o(e){this._roles=e}o.prototype.isSame=function(e){var t;return t=e instanceof o?e._roles:i.isArray(e)?e.join(","):e,i.isEqual(t,this._roles)},o.prototype.toString=function(){return this._roles},o.ANYONE=new o("leader,coleader,member"),o.UNTIL_COLEADER=new o("leader,coleader"),o.ONLY_LEADER=new o("leader"),o.NO_ONE=new o(""),o.ALL_MEMBER_ROLES=[o.ANYONE,o.UNTIL_COLEADER,o.ONLY_LEADER,o.NO_ONE],o.parseMemberRoles=function(e){return i.find(o.ALL_MEMBER_ROLES,(function(t){return t.isSame(e)}))},e.exports=o},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1313),s=n(180),a=n(486),r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DClipboardCopyActionLayerView"},template:t.template(o),templateContext:function(){return{title:this._title,description:this._description,copyTargetText:this._copyTargetText,copyButtonText:this._copyButtonText}},ui:{btnCopy:"._btnCopy",btnClose:"._btnClose"},events:{"click @ui.btnClose":"destroy"},initialize:function(e){this._title=e.title,this._description=e.description,this._copyTargetText=e.copyTargetText,this._copyButtonText=e.copyButtonText,this._copySuccessAlertText=e.copySuccessAlertText,this._copyFailAlertText=e.copyFailAlertText},onAttach:function(){this._initTextCopyClipboard(),this.getUI("btnCopy").click()},onBeforeDetach:function(){this._destroyTextCopyClipboard()},_initTextCopyClipboard:function(){s.isSupported()&&(this._destroyTextCopyClipboard(),this._clipboard=new s("._btnCopy"),this._clipboard.on("success",t.bind((function(e){if(window.clipboardData&&"function"==typeof window.clipboardData.getData){var n=window.clipboardData.getData("Text");if(e.text!==n)return void alert(this._copyFailAlertText)}this.$el.hide(),alert(this._copySuccessAlertText),setTimeout(t.bind(this.destroy,this),0)}),this)),this._clipboard.on("error",t.bind((function(e){alert(this._copyFailAlertText)}),this)))},_destroyTextCopyClipboard:function(){this._clipboard&&this._clipboard.destroy()}});return r.openClipboardCopyActionLayerView=function(e){a.openWithoutHiding(new r(e))},r.openUrlCopyLayerView=function(e){a.openWithoutHiding(new r({title:IM("ui.label.copy_url"),description:IM("copy_url.label.try_copy_to_paste"),copyTargetText:e,copyButtonText:IM("ui.label.copy_url"),copySuccessAlertText:IM("copy_url.success"),copyFailAlertText:IM("url_copy.fail")}))},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(52),o=n(6),s=n(529),a=o.Model.extend({initialize:function(e,t){var n=e.owner;n&&(this._owner=s.buildContentAuthorModel(n))},parse:function(e,t){return i.camelizeKeys(e)},isMyFolder:function(){return!!this._owner&&this._owner.isContentAuthorMe()},setFolderFileCount:function(e){this.set("fileCount",e)},getFolderId:function(){return this.get("folderId")},getFolderName:function(){return this.get("name")},getFolderCreatedAt:function(){return this.get("createdAt")},getFolderFileCount:function(){return this.get("fileCount")},getFolderLatestFileCreatedAt:function(){return this.get("latestFileCreatedAt")}});a.build=function(e){return new a(e,{parse:!0})},e.exports=a},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(17),o=["notificationType","notifiedBy","taskId"];return{extractEmailNotificationParamsFromQueryString:function(){var e=i.queryStringToObject(location.search);return t.pick(e,o)},hasEmailNotificationParams:function(e){return!t.isEmpty(e)&&t.every(o,(function(n){return t.has(e,n)}))}}}.call(t,n,t,e))||(e.exports=i)},,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(2),s=n(6),a=n(168),r=n(784),l=n(52),c=n(13),d=n(1022),u=s.Model.extend({initialize:function(e,t){this._channelId=t.channelId,this._userNo=t.userNo,this._editable=t.editable||!1,this._dataFetched=!1},defaults:function(){return{bandNo:null,memberKey:null,me:!1,name:null,profileImageUrl:null,cellphone:null,description:null,createdAt:null,role:null,birthday:null,isLunar:null,isOpenBirthday:null,isMember:null,permittedOperation:[],openCellphoneRoles:null,userProfileSetId:null,isAlreadyBlockedCommentAndChat:!1,isMuted:!1}},parse:function(e){return{bandNo:(e=l.camelizeKeys(e)).bandNo,memberKey:e.memberKey,me:e.me||!1,name:e.name,profileImageUrl:e.profileImageUrl,cellphone:e.cellphone,description:e.description,createdAt:e.createdAt,role:e.role,birthday:e.birthday,isLunar:e.isLunar,isOpenBirthday:e.isOpenBirthday,permittedOperation:e.permittedOperation,openCellphoneRoles:e.openCellphoneRoles,isMember:e.isMember,userProfileSetId:e.userProfileSetId,isAlreadyBlockedCommentAndChat:e.isAlreadyBlockedCommentAndChat,isMuted:e.isMuted}},fetchBandMember:function(){var e=this.get("bandNo"),n=this._userNo;return this._fetchMember().then(t.bind((function(i){return o.Deferred((function(o){t.contains(i.permitted_operation,"block_comment_and_chat")?r.checkPenaltyMembers(e,[n],r.PENALTY_TYPE.BLOCK_COMMENT_AND_CHAT).then(t.bind((function(e){i.isAlreadyBlockedCommentAndChat=t.contains(e,n),o.resolve(i)}),this)):(i.isAlreadyBlockedCommentAndChat=!1,o.resolve(i))})).promise()}),this)).then(t.bind((function(e){this._dataFetched=!0,this.set(this.parse(e))}),this),t.bind((function(){}),this))},hasProfileSetDifference:function(e){return i.trim(e.name)!==this.get("name")||e.profileImageUrl!==this.get("profileImageUrl")},hasDifferenceWith:function(e){return e.bandNo!==this.get("bandNo")||i.trim(e.name)!==i.trim(this.get("name"))||i.trim(e.description)!==i.trim(this.get("description"))||i.trim(e.profileImageUrl)!==i.trim(this.get("profileImageUrl"))||this.isPermittedModifyOpenBirthday()&&e.isOpenBirthday!==this.get("isOpenBirthday")||this._isPermittedModifyOpenCellphone()&&this._isChangedCellphoneRoles(e.openCellphoneRoles)},_isChangedCellphoneRoles:function(e){return!t.isUndefined(this.get("openCellphoneRoles"))&&!d.parseMemberRoles(this.get("openCellphoneRoles")).isSame(e)},updateBandMemberProfile:function(e,n,o,s){var r;t.isNull(e.openCellphoneRoles)||t.isUndefined(e.openCellphoneRoles)||(r=t.map(e.openCellphoneRoles.split(","),(function(e){return e.trim()})).join(","));var l={band_no:e.bandNo,name:i.trim(e.name),profile_image_url:e.profileImageUrl,description:i.trim(e.description)};return this.isPermittedModifyOpenBirthday()&&(l.open_birthday=e.isOpenBirthday||!1),this._isPermittedModifyOpenCellphone()&&(l.open_cellphone_roles=r),n&&i.trim(e.name)===i.trim(n.get("name"))&&i.trim(e.profileImageUrl)===i.trim(n.get("profileImageUrl"))&&(l=t.extend(t.omit(l,"name","profile_image_url"),{user_profile_set_id:n.get("userProfileSetId")})),o&&s&&(l.profile_image_width=s.width,l.profile_image_height=s.height,l.create_profile_image_change_post=!0),a.setMemberProfile(l)},isMyProfile:function(){return c.getUserData().getUserNo()===this._userNo},_isMemberOperationPermitted:function(e){return t.contains(this.get("permittedOperation"),e)},togglePenaltyBlockCommentAndChat:function(){return this.get("isAlreadyBlockedCommentAndChat")?r.removePenaltyMember(this.get("bandNo"),this._userNo,r.PENALTY_TYPE.BLOCK_COMMENT_AND_CHAT):r.addPenaltyMember(this.get("bandNo"),this._userNo,r.PENALTY_TYPE.BLOCK_COMMENT_AND_CHAT)},canBanChat:function(){return this._isMemberOperationPermitted("ban_chat")},canBanMember:function(){return this._isMemberOperationPermitted("ban_member")},canBlockCommentAndChat:function(){return this._isMemberOperationPermitted("block_comment_and_chat")},canSendMessage:function(){return this._isMemberOperationPermitted("send_message")},canViewJoinInfo:function(){return this._isMemberOperationPermitted("view_join_info")},canMuteMember:function(){return this._isMemberOperationPermitted("mute")},_isPermittedModifyOpenCellphone:function(){return this.getModifyOpenCellphonePermittedOperations().length>0},getModifyOpenCellphonePermittedOperations:function(){return t.intersection(this.get("permittedOperation"),["modify_open_cellphone_roles_anyone","modify_open_cellphone_roles_until_coleader","modify_open_cellphone_roles_only_leader"])},isPermittedModifyOpenBirthday:function(){return this._isMemberOperationPermitted("modify_open_birthday")},isAlreadyBlockedCommentAndChat:function(){return this.get("isAlreadyBlockedCommentAndChat")},isReallyNotMember:function(){return this._dataFetched&&!this.get("isMember")},getBandMemberProfileUserNo:function(){return this._userNo},getBandMemberProfileMemberKey:function(){return this.get("memberKey")},isLoginUserBandMemberProfile:function(){return this.get("me")},getOpenCellphoneRoles:function(){return this.get("openCellphoneRoles")},getBandNo:function(){return this.get("bandNo")},getUserNo:function(){return this._userNo},getName:function(){return this.get("name")},getCreatedAt:function(){return this.get("createdAt")},isMuted:function(){return this.get("isMuted")},isUndefinedOpenBirthday:function(){return t.isUndefined(this.get("isOpenBirthday"))},isUndefinedOpenCellphoneRoles:function(){return t.isUndefined(this.get("openCellphoneRoles"))},_fetchMember:function(){var e=this.get("bandNo");return this._editable?a.getMember(e):this._channelId?a.getMemberByChannelId(this._channelId,this._userNo):a.getMember(e,this._userNo)}});return u.createBandMemberProfileModelByChannelId=function(e,t,n,i){var o={bandNo:t,name:e.name,profileImageUrl:e.profileImageUrl};return new u(o,{channelId:n,userNo:i})},u.createEmptyBandMemberProfileModel=function(e,t){return new u({bandNo:e},{userNo:t})},u.createBandMemberProfileModel=function(e,t,n){var i={bandNo:t,name:e.name,profileImageUrl:e.profileImageUrl};return new u(i,{userNo:n})},u.createBandMemberProfileEditModel=function(e,t){var n={bandNo:t,name:e.name,profileImageUrl:e.profileImageUrl},i={editable:!0,userNo:c.getUserData().getUserNo()};return new u(n,i)},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(52),s=n(486),a=n(493),r=n(1315),l=n(1317),c=n(160),d=t.View.extend({attributes:{"data-viewname":"DGroupBandMemberGroupSelectView"},className:"lyWrap",tagName:"section",template:i.template(l),ui:{memberGroupsRegion:"._memberGroupsRegion",emptyView:"._emptyView",btnCloseLayer:"._btnCloseLayer",btnConfirm:"._btnConfirm"},events:{"click @ui.btnCloseLayer":function(){this.destroy()},"click @ui.btnConfirm":function(){var e=i.map(this._dGroupBandMemberGroupSelectCollection.filter((function(e){return!0===e.get("isChecked")})),(function(e){return e.get("memberGroupId")}));a.getBandMembersOfBandWithFilter(this._bandNo,c.MEMBER_GROUP,e.join(",")).then(i.bind((function(e){var t=o.camelizeKeys(e.members);this.trigger("memberGroupView:selectedMemberGroups",i.map(t,(function(e){return{name:e.name,userNo:e.userNo,profileImageUrl:e.profileImageUrl,role:e.role,description:e.description,isKid:e.isKid}}))),this.destroy()}),this))}},regions:{memberGroupsRegion:{el:"@ui.memberGroupsRegion",replaceElement:!1}},initialize:function(e){this._bandNo=e.bandNo},onAttach:function(){a.getMemberGroups(this._bandNo).then(i.bind((function(e){var t=o.camelizeKeys(e.items);this._dGroupBandMemberGroupSelectCollection=new h(t);var n=new p({collection:this._dGroupBandMemberGroupSelectCollection});i.isEmpty(t)?(this.getUI("emptyView").show(),this.getUI("memberGroupsRegion").hide()):(this.getUI("emptyView").hide(),this.showChildView("memberGroupsRegion",n),this.listenTo(n,"selectListView:set_check_state",(function(){this._dGroupBandMemberGroupSelectCollection.filter((function(e){return e.get("isChecked")})).length>0?this.getUI("btnConfirm").addClass("-active").removeClass("-disabled").attr("disabled",!1):this.getUI("btnConfirm").addClass("-disabled").removeClass("-active").attr("disabled",!0)}),this))}),this))}}),u=Backbone.Model.extend({defaults:function(){return{memberGroupId:"",name:"",memberCount:"",isChecked:!1}},toggleCheckState:function(){this.get("isChecked")?this.set("isChecked",!1):this.set("isChecked",!0)}}),h=Backbone.Collection.extend({model:u}),p=t.CollectionView.extend({tagName:"ul",className:"listLine",childView:r,childViewEvents:{"selectItemView:set_check_state":function(){this.trigger("selectListView:set_check_state")}}});return d.buildMemberGroupSelectView=function(e){var t=new d({bandNo:e});return s.openWithoutHiding(t),t},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){n(0);var t=n(6),i=n(1364),o=i.WATCHER_TYPE,s=t.Collection.extend({model:i,comparator:function(e){return e.getMember().getName()},getLiveWatcherCount:function(){return this.filter((function(e){return e.isLiveWatcher()})).length},getVideoWatcherCount:function(){return this.filter((function(e){return e.isVideoWatcher()})).length},getNonWatcherCount:function(){return this.filter((function(e){return e.isNonWatcher()})).length},getNonWatchers:function(){return this.filter((function(e){return e.isNonWatcher()}))}});return s.WATCHER_TYPE=o,s}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(1117);return{hasWritingInputDescendantOf:function(e){var n=e.find("."+o.INPUT_VIEW_CLASS_NAME);return t.some(n,(function(e){var t=i(e).data(o.INPUT_VIEW_DATA_KEY);return!!t&&t.hasInputContent()}))},hasFocusingInputDescendantOf:function(e){var n=e.find("."+o.INPUT_VIEW_CLASS_NAME);return t.some(n,(function(e){var t=i(e).data(o.INPUT_VIEW_DATA_KEY);return!!t&&t.isMessageInputFocused()}))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(1393),a=n(1394),r=n(551),l=n(486),c=n(522),d=n(578),u=n(583),h=n(488),p=n(499),m=n(618),_=n(155),g=(n(509),o.View.extend({tagName:"li",className:"flexList tLine emotionList",attributes:function(){var e={"data-viewname":"DEmotionListItemView"};return this.model.isMutedActorEmotion()&&(e.style="opacity:0.3"),e},template:i.template(a),templateContext:function(){var e=this.model.get("emotionType");return{emotionClass:c.getIconName(e),emotionLabel:c.getLabel(e)}},regions:{profileImage:{el:"._profileImage",replaceElement:!0}},initialize:function(e){this._bandNo=e.bandNo},onRender:function(){this.showChildView("profileImage",m.buildContentCreatorProfileImageView({memberProfile:this.model.getActorMemberProfile(),userNoOrMemberKey:this.model.get("actorUserNo"),bandCore:_.get(this._bandNo).getBandCore(),role:this.model.get("actorRole")}))}})),f=o.CollectionView.extend({tagName:"ul",className:"listLine rScroll -h360",childView:g,childViewOptions:function(){return{bandNo:this._bandNo}},events:function(){return{scroll:i.throttle(i.bind((function(e){var t=e.currentTarget;this.collection.hasMorePages()&&t.scrollHeight-t.scrollTop<=this._scrollThreshold&&this.collection.addNextPage()}),this),200)}},onAttach:function(){this._scrollThreshold=Math.round(1.5*this.$el.outerHeight())},initialize:function(e){this._bandNo=e.bandNo}}),b=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEmotionListView"},template:i.template(s),ui:{tabWrap:"._tabWrap",prevBtn:"._prevBtn",nextBtn:"._nextBtn",listRegion:"._listRegion",confirmBtn:"._confirmBtn",tab:"._tab",emotionTypeBtn:"._emotionTypeBtn",loading:"._loading",loadingRegion:"._loadingRegion"},events:{"click @ui.prevBtn":function(){this.ui.tabWrap.removeClass("-alignR")},"click @ui.nextBtn":function(){this.ui.tabWrap.addClass("-alignR")},"click @ui.emotionTypeBtn":function(e){this.collection.isLoading()||(this.ui.tab.children(".-on").removeClass("-on"),this._fetchEmotions(t(e.currentTarget).parent().addClass("-on").end().data("emotionType")))},"click @ui.confirmBtn":"destroy"},regions:{listRegion:"@ui.listRegion",loadingRegion:"@ui.loadingRegion"},collectionEvents:{"EmotionCollection:fetchComplete":"render"},serializeData:function(){var e=this.options.channelId?"":"-w380";return this.isAttached()?{title:IM("web.emotionlist.topbar.title.total_count",{count:d.numberWithCommas(this.collection.getTotalCount())}),emotions:this._getEmotions(),total:this.collection.getTotalCount(),emotionType:this._emotionType,lyWidth:e}:{title:IM("web.postdetail.emotion.title"),emotions:null,lyWidth:e}},onRender:function(){this.getRegion("listRegion").show(new f({collection:this.collection,bandNo:this._bandNo})),this.isAttached()&&this._alignTab()},onAttach:function(){this._fetchEmotions()},_alignTab:function(){var e=this.ui.tab.children(":last"),t=this.ui.tab.children(".-on"),n=this.ui.tabWrap.width();e.position().left+e.outerWidth()<=n&&this.ui.nextBtn.remove(),t.position().left+t.outerWidth()>n&&this.ui.tabWrap.addClass("-alignR")},_getEmotions:function(){return i.chain(this.collection.getCountMap()).map((function(e,t){if(e>0||t===this._emotionType)return i.extend(c.getDetailAttribute(t),{count:d.numberWithCommas(e),_order:-1*e})}),this).compact().sortBy("_order").value()},_fetchEmotions:function(e){return this._emotionType=e,this._startLoading(),this._chatEmotion?this.collection.fetchChatMessageEmotions(this._bandNo,this._channelId,this._messageNo,this._emotionType):this.collection.fetchEmotions({bandNo:this._bandNo,contentKey:this._contentKey,emotionType:this._emotionType})},_startLoading:function(){this.getRegion("loadingRegion").show(u.build(p.Size.MEDIUM,h.ELEMENT.AREA_VERTICAL_MIDDLE)),this.ui.listRegion.css("display","none"),this.ui.loading.css("display","")},initialize:function(e){this._bandNo=e.bandNo,this._contentKey=e.contentKey,this._emotionType=null,this._totalCount=null,this._chatEmotion=1==e.chatEmotion,this._channelId=e.channelId,this._messageNo=e.messageNo}});return b.openDEmotionListView=function(e,t){var n=new b({collection:r.build(),bandNo:e,contentKey:t});return l.openWithoutHiding(n),n},b.openChatEmotionListView=function(e,t,n){var i=new b({collection:r.build(),bandNo:e,channelId:t,messageNo:n,chatEmotion:!0});return l.open(i),i},b}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){var e={BAND_FILTER:{POSTING:"posting",REGISTER_SCHEDULE:"register_schedule",INVITE_MEMBER:"invite_member",INVITE_CHAT:"invite_chat",CREATE_OPEN_CHAT:"create_open_chat",GIFT:"gift",LEADER:"leader",SECRET:"secret",PUBLIC_OR_CLOSED:"public_or_closed",EXPOSE_ONLINE:"expose_online",UNFIX_QUOTA:"unfix_quota",LOCATION:"location",PAGE:"page",CREATE_INVITATION_URL:"create_invitation_url",LOCAL_BAND:"local_band"},BAND_FIELD:{BAND:{BAND_NO:"band.band_no",TYPE:"band.type",OPEN_TYPE:"band.open_type",NAME:"band.name",COVER:"band.cover",PROFILE_IMAGE:"band.profile_image",MEMBER_COUNT:"band.member_count",CERTIFIED:"band.certified",THEME_COLOR:"band.theme_color",BAND_NOS_OF_PAGE_LINK:"band.band_nos_of_page_link",BAND_NOS_OF_PAGE_LINK_APPLICATION:"band.band_nos_of_page_link_application",PROPERTIES:{POST_WITHOUT_APPROVAL:"band.properties.post_without_approval"}},MEMBER:{NAME:"member.name",PROFILE_IMAGE_URL:"member.profile_image_url",USER_PROFILE_SET_ID:"member.user_profile_set_id",RECEIVE_EMAIL_NOTIFICATION:"member.receive_email_notification",EXPOSE_ONLINE:"member.expose_online",PERMITTED_OPERATION:{POSTING:"member.permitted_operation.posting",APPROVE_POST:"member.permitted_operation.approve_post"}}}};return e.BAND_LIST_DEFAULT_FIELDS=[e.BAND_FIELD.BAND.BAND_NO,e.BAND_FIELD.BAND.NAME,e.BAND_FIELD.BAND.COVER,e.BAND_FIELD.BAND.MEMBER_COUNT,e.BAND_FIELD.BAND.THEME_COLOR],e}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(156),o=n(152);function s(e){return{user_no:e.get("userNo"),member_type:e.get("memberType")}}return{generateMediaData:function(e){return t.chain(e.toContentModels()).filter((function(e){return"photo"===e.attachmentType||"video"===e.attachmentType})).map((function(n){var i={bandNo:e.getBandNo(),comment_count:0,emotion_count:0,author:s(e.get("author"))};return"photo"===n.attachmentType?t.extend(i,{photo_no:n.get("photoNo"),photo_url:n.get("photoUrl"),width:n.get("width"),height:n.get("height"),savable_state:n.get("savableState")}):"video"===n.attachmentType?t.extend(i,{photo_no:n.get("photoNo"),photo_url:n.get("logoImage"),width:n.get("width"),height:n.get("height"),savable_state:n.get("savableState"),video:{expires_at:n.get("expiresAt"),videoId:n.get("id"),is_gif:n.get("isGif")}}):void 0})).value()},generateSortedMediasFromPostListItemModel:function(e){var n={bandNo:e.getBandNo(),author:s(e.getAuthor())},a=e.getAttachment(o.POST_ATTACHMENT_TYPE.VIDEO).map((function(e){return t.extend({photo_no:e.getPhotoNo(),photo_url:e.getLogoImage(),comment_count:e.getCommentCount(),emotion_count:e.getEmotionCount(),width:e.getWidth(),height:e.getHeight(),savableState:e.getSavableState(),video:{expires_at:e.getExpiresAt(),videoId:e.id,is_gif:e.isGif(),is_live:e.isLive()}},n)})),r=e.getAttachment(o.POST_ATTACHMENT_TYPE.PROMOTION_PHOTO).map((function(e){return t.extend({photo_url:e.get("url"),width:e.get("width"),height:e.get("height")},n)})),l=e.getAttachment(o.POST_ATTACHMENT_TYPE.PHOTO).map((function(e){return t.extend({photo_no:e.getPhotoNo(),photo_url:e.getPhotoUrl(),comment_count:e.getCommentCount(),emotion_count:e.getEmotionCount(),width:e.getWidth(),height:e.getHeight(),savableState:e.getSavableState()},n)})),c=a.concat(r,l);return t.sortBy(c,(function(e){var t=e.video;return t&&t.is_live?1:t&&!t.is_gif?2:t&&t.is_gif?3:i.isGif(e.photo_url)?4:5}))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(788);t.renderDimOfView=function(e,t){i.isFunction(e.dimUpdateArea)&&e.dimUpdateArea(t)},t.withUI=function(e,t,n){return n=n||{},o.with(i.extend({dimUI:e,runOnDomRefresh:!1},n,{dimUI:e,clickDimTrigger:t}))},t.EVENT={CLICK_DIM:"click:dim"}},,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2153),a=n(26),r=n(887),l=n(9),c=n(1023),d=n(153),u=n(162),h=n(82),p=n(83),m=n(13),_=n(85),g=n(495),f=n(487),b=n(1615),v=n(553),A=n(17),E="share_fcb",T="share_twi",C="share_url",y="share_cafe",M=o.View.extend({_joinedBands:[],tagName:"div",className:"lyMenu -lyShare",attributes:{"data-viewname":"DUrlShareView"},template:t.template(s),ui:{btnShareMoreBands:"._btnShareMoreBands",btnShareBand:"._btnShareBand",btnShareFacebook:"._btnShareFacebook",btnShareTwitter:"._btnShareTwitter",btnShareGoogle:"._btnShareGoogle",btnShareCafe:"._btnShareCafe",btnDetailUrl:"._btnDetailUrl"},events:{"click @ui.btnShareMoreBands":"_shareMoreBands","click @ui.btnShareBand":"_shareBand","click @ui.btnShareFacebook":function(e){e.preventDefault(),r.facebook({url:this._shareUrl}),this._sendShareClickLog(E),this._destroy()},"click @ui.btnShareTwitter":function(e){e.preventDefault(),r.twitter({url:this._shareUrl}),this._sendShareClickLog(T),this._destroy()},"click @ui.btnShareCafe":function(e){e.preventDefault(),r.cafe({url:this._shareUrl}),this._sendShareClickLog(y),this._destroy()},"click @ui.btnDetailUrl":function(e){e.preventDefault(),this._sendShareClickLog(C),c.openUrlCopyLayerView(this._shareUrl),this._destroy()},click:function(e){e.stopPropagation()}},behaviors:function(){return[{behaviorClass:g,sceneId:g.SCENE.SHARE_POST_SELECT},f]},initialize:function(e){this._shareUrl=e.shareUrl,this._message=e.message,this._excludedBandNos=e.excludedBandNos,this._isSingleSelectionOnMoreBandSelection=e.isSingleSelectionOnMoreBandSelection,this._withoutHidingOnLayerOpen=e.withoutHidingOnLayerOpen,this._gotoBandOnNewTab=e.gotoBandOnNewTab,this.listenTo(a.getDGlobalChannel(),a.EVENT.HTML_CLICK,(function(e){this._destroy()}))},serializeData:function(){return{canShareToExternalSNS:m.canShareToExternalSNS(),isLogedIn:m.isLogedIn(),joinedBands:this._joinedBands,hasKoreaCountryCode:l.isKoreaCountryCode(),coverThumb:function(e){return h.make(e,h.TYPE.s150)}}},onRender:function(){this.isAttached()?(this.$el.toggleClass("-bottom",this._isCoveredWithNavBar()),this.$el.css("visibility","")):this.$el.css("visibility","hidden")},onAttach:function(){if(m.isLogedIn()){var e=_.POSTING,n=_.getFieldsWithFilterType(e);p.getBandListWithFilter(e,n).then(t.bind((function(e){this._joinedBands=t.chain(e).first(6).pluck("band").filter((function(e){return!t.contains(this._excludeBandNos,e.band_no)}),this).first(4).value(),this.isDestroyed()||this.render()}),this))}else this.isDestroyed()||this.render();this._isPostShareUrl()&&this.jplSceneEnter(f.CLASSIFIER.SHARE_POST_SELECT)},_isPostShareUrl:function(){return!(!d.GROUP_BAND_POST_DETAIL.isMatched(this._shareUrl)&&!u.PAGE_BAND_POST_DETAIL.isMatched(this._shareUrl))},_isCoveredWithNavBar:function(){var e=i("#header"),t=i("#lnb"),n=0!==e.length?e.offset().top:0,o=0!==e.length?e.outerHeight():0,s=0!==t.length?t.outerHeight():0;return this.$el.offset().top<n+o+s},_shareMoreBands:function(){b.writePost(b.WRITE_ACTION.SHARE_URL_WITH_BAND_SELECTION,{shareUrl:this._shareUrl,message:this._message,excludedBandNos:this._excludedBandNos,isSingleBandSelection:this._isSingleSelectionOnMoreBandSelection,withoutHiding:this._withoutHidingOnLayerOpen,gotoBandOnNewTab:this._gotoBandOnNewTab}),this._destroy()},_shareBand:function(e){e.preventDefault();var t=i(e.currentTarget),n={bandNo:t.data("bandNo"),name:t.data("bandName"),cover:t.data("bandCover")};b.writePost(b.WRITE_ACTION.SHARE_URL_ON_BANDS,{shareUrl:this._shareUrl,message:this._message,bandList:[n],withoutHiding:this._withoutHidingOnLayerOpen,gotoBandOnNewTab:this._gotoBandOnNewTab}),this._destroy()},_sendShareClickLog:function(e){this.jplClick(f.CLASSIFIER.SHARE_OTHER_APPS,{button_id:e})},_destroy:function(){t.defer(t.bind(this.destroy,this))}});return M.buildUrlShareView=function(e){return new M(e)},M.openPostShareViewAtRegion=function(e,n,i){e.hasView()||t.defer(t.bind((function(){var t=v.postDetail(n,i).url;e.show(M.buildUrlShareView({shareUrl:A.appendCurrentDomainOnPathUrl(t),message:"",excludedBandNos:[n.bandNo],isSingleSelectionOnMoreBandSelection:!1}))}),this))},M}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(2),s=n(4),a=n(26),r=n(1333),l=n(559),c=n(1093),d=n(82),u=n(600),h=n(510),p=n(159),m=n(512),_=n(555),g=n(154),f=n(1059),b=n(934),v=n(582),A=n(636),E=n(590),T=n(57),C=n(801),y=n(167),M=n(507),I=n(166),S=n(488),w=n(487),N=n(55),D=n(537),L=n(1250),O=n(155),P=n(1251),x=n(1117),R=n(1149),k=n(1118),B=n(508),V=n(552),U=n(569);n(502);var F,H="mediaWrap",z="fileWrap",W="closePreview",G="closePreviewFile",K="video",Y=s.View.extend({template:t.template(r),className:function(){return x.INPUT_VIEW_CLASS_NAME},templateContext:function(){var e=this.options;return{messageLabel:this._messageLabel,textareaPlaceHolder:this._textareaPlaceHolder,buttonLabel:this._buttonLabel,cid:this.cid,msg_getTextAreaStyle:function(){return e.textareaHeight?"height : "+e.textareaHeight+";":""},isStickerOnTop:this._isStickerOnTop,topWriteMoreWrap:this._topWriteMoreWrap}},attributes:{"data-viewname":"DCommentInputView"},ui:{stickerSelectRegion:"._stickerSelectRegion",sendMessageButton:"._sendMessageButton",previewImage:"._previewImage",loadingImage:"._loadingImage",previewArea:"._previewArea",closePreviewButton:"._closePreviewButton",messageTextArea:"._messageTextArea",stickerInputButton:"._stickerInputButton",imageUploadButton:"._imageUploadButton",mediaUploadArea:"._mediaUploadArea",mediaUploadLabel:"._mediaUploadLabel",mentionListParent:"._mentionListParent",writeMain:"._writeMain",btnUpload:"._btnUpload",lyMenu:"._lyMenu",previewFile:"._previewFile",uploadContextWrap:"._uploadContextWrap",fileUploadButton:"._fileUploadButton",fileUploadArea:"._fileUploadArea",filePreviewArea:"._filePreviewArea",profileInputRegion:"._profileInputRegion",offsetAdjustEl:"._offsetAdjustEl",secretModeButton:"._secretModeButton",photoArea:"._photoArea",photoInputArea:"._photoInputArea",photoList:"._photoList"},regions:{stickerSelectRegion:"@ui.stickerSelectRegion",profileInputRegion:"@ui.profileInputRegion"},behaviors:[p,w],events:function(){if(this.options.preventAllEvent)return{"click @ui.imageUploadButton":function(){return!1}};var e={};return e["click @ui.photoList "+V.INPUT_PHOTO_DELETE_BUTTON_SELECTOR]=function(e){var t=o(e.currentTarget).data(V.INPUT_PHOTO_DATA_KEY);return this._commentInputData.removePhotoInfoByUrl(t),this.ui.photoList.find(V.INPUT_PHOTO_SELECTOR).filter((function(e,n){return o(n).data(V.INPUT_PHOTO_DATA_KEY)==t})).remove(),this.ui.photoInputArea.toggle(!this._commentInputData.isMaxPhotoCount()),this.ui.photoArea.toggle(this._commentInputData.isPhotoExist()),!1},t.extend(e,{"keyup @ui.messageTextArea":function(){this._fnDebouncedCheckIfValidLengh(),this._determineButtonActivation()},"paste @ui.messageTextArea":function(e){var n=P.getImageFile(e);if(!n)return this._fnDebouncedCheckIfValidLengh(),void g.wrapDeferPromise(this).then(t.bind(this._determineButtonActivation,this));n.isClipboardImage=!0,this._mediaUploader.uploadFiles(n),a.getDGlobalChannel().trigger(a.EVENT.MESSAGE_INPUT_CLOSE_LAYER,this.cid)},"cut @ui.messageTextArea":function(){g.wrapDeferPromise(this).then(t.bind(this._determineButtonActivation,this))},"keydown @ui.messageTextArea":function(e){if(e.keyCode!=_.ENTER||e.shiftKey)return this._fnDeboucedDetermineButtonActivation(),!0;switch(this._messageSubmitKeyType){case l.ENTER:return!(!(!!T.isMac()&&e.ctrlKey)&&!e.altKey)||(this._doSubmit(),!1);case l.CONTROL_ENTER:return!(T.isMac()?e.metaKey:e.ctrlKey)||(this._doSubmit(),!1)}return!0},"click @ui.sendMessageButton":function(){this._doSubmit()},"click @ui.stickerInputButton":function(){this._toggleStickerSelectRegion()},"click @ui.closePreviewButton":function(){this._closeAttachedAreaAndResetData()},"focus @ui.messageTextArea":function(){this._loadBandDataAndFollowUpProcess(),this.spawn(p.MSG.MESSAGE_INPUT_TEXTAREA_FOCUS,this)},"input @ui.messageTextArea":function(){E.isContentCreationPunished()&&this._mentionsInput.val("")},"click @ui.btnUpload":function(){if(!E.isContentCreationPunished()){var e=this.ui.lyMenu.is(":visible");g.wrapDeferPromise(this).then(t.bind((function(){this.ui.lyMenu.toggle(!e),this._hideStickerSelectRegion()}),this)),this._messageInputBandData.isBandDataStateLoaded()?(this._shouldSendAttachLog=!0,this._sendJplAttachLog()):(this._shouldSendAttachLog=!0,this._loadBandDataAndFollowUpProcess())}},"click @ui.imageUploadButton":function(){a.getDGlobalChannel().trigger(a.EVENT.MESSAGE_INPUT_CLOSE_LAYER,this.cid)},"click @ui.fileUploadButton":function(){if(this._commentInputData.isPhotoExist()&&!confirm(IM("attach.uploaded_file_discard_description")))return!1;a.getDGlobalChannel().trigger(a.EVENT.MESSAGE_INPUT_CLOSE_LAYER,this.cid)},"click @ui.secretModeButton":function(){this._secretMode?this._releaseSecretMode():this._makeSecretModeWithGuideAlert()},click:function(e){this._loadBandDataAndFollowUpProcess(),e.stopPropagation(),a.getDGlobalChannel().trigger(a.EVENT.HTML_CLICK)}})},onMessages:(F={},F[p.MSG.DSTICKER_SELECT]=function(e){this._hideStickerSelectRegion();var t=e.packNo,n=e.stickerId;this._closeAttachedAreaAndResetData(),this._showPreview("sticker",d.makeStickerImageUrl(t,n)),this._commentInputData.setStickerInfo(t,n),this._determineButtonActivation()},F[p.MSG.DSTICKER_DOUBLE_CLICK]=function(e){var t=e.packNo,n=e.stickerId;this._commentInputData.resetCommentInput(),this._commentInputData.setStickerInfo(t,n),this._doSubmit()},F[p.MSG.MESSAGE_INPUT_PROFILE_CHANGE]=function(e){this._messageInputBandData.setCurrentSelectedMemberProfileMemberType(e),this._messageInputBandData.shouldCancelCommentMentionedTextOnProfileChange()&&this._mentionsInput.emptyMentionedArray(),this._mentionsInput.hideAutoCompleteList()},F),passMessages:function(){var e={};return e[p.MSG.MESSAGE_INPUT_PROFILE_CHANGE]=p.MSG.PROPAGATION_STOP,e}(),initialize:function(e){e=e||{},this._messageLabel=e.messageLabel||"",this._textareaPlaceHolder=e.textareaPlaceHolder||"",this._buttonLabel=e.buttonLabel||"",this._maxMessageLength=e.maxMessageLength||1e7,this._overMaxLengthAlertMessage=e.overMaxLengthAlertMessage||"max message length : "+this._maxMessageLength,this._readOnlyTextarea=e.readOnlyTextarea||!1,this._bandNo=e.bandNo,this._standByMessage=e.standByMessage,this._commentInputData=v.buildCommentOrJoinQnAInputData(),this._messageSubmitKeyType=this._getSendKey(),this._memberProfileArray=e.memberProfileArray,this._currentProfileMemberType=e.currentProfileMemberType,this._preventAllEvent=e.preventAllEvent,this._isStickerOnTop=e.isStickerOnTop,this._messageInputBandData=e.messageInputBandData,this._secretMode=!1,this._initSecretMode=e.initSecretMode,this._secretCommentStorageKey=e.secretCommentStorageKey||I.SecretCommentUseGuide,this._topWriteMoreWrap=1==e.topWriteMoreWrap,this._mentionOption=e.mentionOption,this._fnDebouncedCheckIfValidLengh=t.debounce(this._checkIfValidMaxLength,100),this._fnDeboucedDetermineButtonActivation=t.debounce(this._determineButtonActivation,100)},onAttach:function(){this._readOnlyTextarea?this.ui.messageTextArea.attr("disabled","disabled"):(this._mentionsInput=b.buildBandMentionsInput(this.ui.messageTextArea,this._bandNo,this.ui.mentionListParent,"",this.ui.offsetAdjustEl,!1),this.ui.sendMessageButton.removeClass(S.ELEMENT.ACTIVE),this._renderProfileInput(),this._bindBandDataEvent(),this.listenTo(a.getDGlobalChannel(),a.EVENT.HTML_CLICK,this._closeLayerMenu),this.listenTo(a.getDGlobalChannel(),a.EVENT.DOCUMENT_ESC_KEY_DOWN,this._closeLayerMenu),this.listenTo(a.getDGlobalChannel(),a.EVENT.MESSAGE_INPUT_CLOSE_LAYER,(function(e){e!=this.cid&&(this._hideStickerSelectRegion(),this._closeAttachedAreaAndResetData())})),this._messageInputBandData.isBandDataStateLoaded()&&this._processAfterBandDataLoaded(),this.$el.data(x.INPUT_VIEW_DATA_KEY,this),this._initSecretMode&&this._makeSecretMode())},onBeforeDetach:function(){this._mediaUploader&&(this._mediaUploader.destroy(),this._mediaUploader=null),this._fileUploader&&(this._fileUploader.destroy(),this._fileUploader=null),this._mentionsInput&&(this._mentionsInput.destroy(),this._mentionsInput=null),this.$el.removeData(x.INPUT_VIEW_DATA_KEY),this.ui.previewImage.off()},_getSendKey:function(){var e=y.getCurrentUserEnvStorage().get([I.MessageSendKey,C.MESSAGE_SEND_KEY.API_KEY_NAME.COMMENT]),t=l.CONTROL_ENTER;return e&&(t=l.ENTER),t},isMessageInputFocused:function(){return"string"!=typeof this.ui.messageTextArea&&this.ui.messageTextArea.is(":focus")},focusMessageTextArea:function(){"string"!=typeof this.ui.messageTextArea&&this.ui.messageTextArea.focus()},scrollToInput:function(e){if(null!=this.ui.messageTextArea&&"string"!=typeof this.ui.messageTextArea){var t=this._calculateScrollTarget(),n=e.position.top;return e.isInLayer||(n=e.offset.top),n-t.$scrollTopCheckingEl.scrollTop()-t.$scrollTopCheckingEl.height()>0?(e.isInLayer||(n=n-t.$scrollTopCheckingEl.height()+65),this._animateScrollParent(t.$animateEl,n+"px")):o.Deferred().resolve()}},appendMention:function(e,t,n){this._mentionsInput&&(this._mentionsInput.appendNewMention(e,t,n),this._fnDebouncedCheckIfValidLengh(),this._determineButtonActivation())},_makeSecretModeWithGuideAlert:function(){this._secretMode||(R.alertDSecretCommentUseGuide(this._secretCommentStorageKey),this._makeSecretMode())},_makeSecretMode:function(){this._secretMode||(this._secretMode=!0,this.ui.secretModeButton.addClass(S.ELEMENT.ACTIVE))},_releaseSecretMode:function(){this._secretMode&&(this._secretMode=!1,this.ui.secretModeButton.removeClass(S.ELEMENT.ACTIVE))},isMentionExist:function(){return!!this._mentionsInput&&this._mentionsInput.isMentionExist()},releaseStandByMode:function(){this._standByStatus=!1,this._determineButtonActivation()},getScrollParent:function(){return this.$el.scrollParent()},_bindUploaders:function(){this._uploaderBinded||g.wrapDeferPromise(this).then(t.bind((function(){this._bindMediaUploader(),this._bindFileUploader(),this._bindPhotoUploader(),this._uploaderBinded=!0}),this))},_bindMediaUploader:function(){var e={multiple:!0,autoUpload:!0,elements:{dnd:null}};this._messageInputBandData.getBandCore().supportAttachVideoOnComment()?this._mediaUploader=u.createPhotoOrVideoUploader(this.ui.mediaUploadArea,e):(this._mediaUploader=u.createPhotoUploader(this.ui.mediaUploadArea,e),this.ui.mediaUploadLabel.text(IM("web.noui.bandcreate.title.select_image"))),this.listenTo(this._mediaUploader,M.BEFORE_VALIDATE,(function(e){var n={photoCount:this._commentInputData.getPhotoCount()};if(this._messageInputBandData.getBandCore().supportAttachVideoOnComment()){var i=D.makeCommentMediaValidator(n),o=t.throttle(i,1e3,{trailing:!1});e.push(o)}else{var s=D.makeCommentPhotoValidator(n),a=t.throttle(s,1e3,{trailing:!1});e.push(a)}})),this.listenTo(this._mediaUploader,M.BEFORE_UPLOAD,(function(e){if(e&&e.files&&e.files[0]){var t=e.files[0],n=!D.isVideoType(t)&&!D.isGifType(t);this._mediaUploader.setShowProgress(n&&!t.isClipboardImage),this._commentInputData.isPhotoExist()||this._closeAttachedAreaAndResetData(),this._mediaUploading=!0,n||this._showLoadingview("image")}})),this.listenTo(this._mediaUploader,M.UPLOAD_COMPLETE,t.bind((function(e){if(this._mediaUploading=!1,!e.cancelled&&e&&e.resultList&&e.resultList[0]){this._resetAttachedInfoOnMediaUpload(e);var t=e.resultList[0];if(t.isVideo||t.isGifVideo)return this._showPreview(t.isGifVideo?"gif_video":"video",d.make(t.url,d.TYPE.w200)),this._commentInputData.setVideoInfo(t.id,t.url,t.width,t.height,t.name,t.isGifVideo),void this._determineButtonActivation();this._renderAndAddUploadedPhotoList(e.resultList)}}),this))},_bindFileUploader:function(){this._messageInputBandData.getBandCore().supportAttachFileOnComment()&&(this.ui.fileUploadArea.show(),this._fileUploader=u.createFileUploader(this.ui.fileUploadArea,{multiple:!1,showProgress:!1,autoUpload:!0,elements:{dnd:null}}),this.listenTo(this._fileUploader,M.BEFORE_UPLOAD,(function(){this._fileUploading=!0,this._showLoadingview("file"),this._determineButtonActivation()})),this.listenTo(this._fileUploader,M.UPLOAD_COMPLETE,(function(e){if(this._fileUploading=!1,!e.cancelled)if(e&&e.resultList&&e.resultList[0]){var t=e.resultList[0];this._showPreview("file",t.name),this._commentInputData.resetCommentInput(),this._commentInputData.setFileInfo(t.name,t.id,t.file_size),this._determineButtonActivation()}else this._closeAttachedAreaAndResetData()})))},_bindPhotoUploader:function(){var e={multiple:!0,autoUpload:!0,accept:D.getCommentMultiplePhotoAccept(),elements:{dnd:null}};this._photoUploader=u.createPhotoUploader(this.ui.photoInputArea,e),this.listenTo(this._photoUploader,M.BEFORE_VALIDATE,(function(e){var n={photoCount:this._commentInputData.getPhotoCount()},i=D.makeCommentMediaValidator(n),o=t.throttle(i,1e3,{trailing:!1});e.push(o)})),this.listenTo(this._photoUploader,M.BEFORE_UPLOAD,(function(e){e&&e.files&&e.files[0]&&(this._photoUploading=!0,this._determineButtonActivation())})),this.listenTo(this._photoUploader,M.UPLOAD_COMPLETE,t.bind((function(e){this._photoUploading=!1,e&&!e.cancelled&&e.resultList&&e.resultList[0]&&this._renderAndAddUploadedPhotoList(e.resultList)}),this))},_renderAndAddUploadedPhotoList:function(e){this.isDestroyed()||(t.each(e,(function(e){this._commentInputData.addInputPhoto(e.url,e.width,e.height);var t=k.createDInputPhotoElement(e.url);this.ui.photoList.append(t),t.find(V.INPUT_PHOTO_IMG_SELECTOR).setLoading()}),this),this.ui.photoInputArea.toggle(!this._commentInputData.isMaxPhotoCount()),this.ui.photoArea.toggle(this._commentInputData.isPhotoExist()),this._determineButtonActivation())},_resetAttachedInfoOnMediaUpload:function(e){e.videoUpload||e.resultList[0].isGif||e.resultList[0].isVideo?this._commentInputData.resetCommentInput():this._commentInputData.isPhotoExist()||this._commentInputData.resetCommentInput()},_bindBandDataEvent:function(){this.listenTo(this._messageInputBandData,O.UPDATE_EVENT.PROFILE,(function(){this._changeProfileData(),this._mentionsInput.changeCurrentMemberType(this._currentProfileMemberType)})),this.listenToOnce(this._messageInputBandData,O.UPDATE_EVENT.ANY,this._processAfterBandDataLoaded)},_loadBandDataAndFollowUpProcess:function(){this._loadBandDataEverCalled||(this._loadBandDataEverCalled=!0,this._messageInputBandData.isBandDataStateLoaded()?this._processAfterBandDataLoaded():this._messageInputBandData.loadBandData())},_populateMentionsInput:function(){this._mentionInited||this._fetchProgress||!this._mentionsInput||(this._mentionsInput.injectBandData(this._messageInputBandData),this._mentionsInput.setMaxMentionCount(B.MAX_MENTION_COUNT),this._messageInputBandData.canMentionToCurrentBandMember()?(this._fetchProgress=!0,g.wrapActivePromise(U.fetchMentionMembersAndMemberGroups(this._bandNo),this).then(t.bind((function(e){this._currentBandMemberCollection=e.memberCollection,this._currentBandLeaderColeaderCollection=e.leaderColeaderCollection,this._dynamicSearchRequired=e.hasMoreMember&&this._mentionOption.isDynamicSearchPossible(),this._canMentionMemberGroup=this._mentionOption.isMemberGroupMentionPossible()&&e.canMentionMemberGroup,this._memberGroupMentionArray=this._mentionOption.isMemberGroupMentionPossible()?e.memberGroupMentionArray:[],this._changeMentionListToCurrentBandCollection(),this._mentionInited=!0}),this)).always(t.bind((function(){this._fetchProgress=!1}),this))):this._mentionInited=!0)},_changeMentionListToCurrentBandCollection:function(){if(null!=this._currentBandMemberCollection&&null!=this._memberGroupMentionArray){this._mentionsInput.changeSelectedBandInfo(this._bandNo,this._messageInputBandData.getBandCore().name);var e=A.makeCommentMentionTargets({mentionLeaderAndColeaderAsWell:this._mentionOption.canMentionLeaderAndColeaderAsWell(),withMemberGroupMention:this._mentionOption.isMemberGroupMentionPossible(),bandMemberMentionArray:U.convertCollectionToMentionArray(this._currentBandMemberCollection),leaderColeaderMentionArray:U.convertCollectionToMentionArray(this._currentBandLeaderColeaderCollection),memberGroupMentionArray:this._memberGroupMentionArray,fixedTargetMemberMentionArray:this._mentionOption.getFixedTargetMemberMentionArray()});this._mentionsInput.changeMentionArrayAndInputOptions({mentionArray:e,dynamicSearchRequired:this._dynamicSearchRequired,hideCompleteListOnEmptyQuery:this._dynamicSearchRequired&&!this._messageInputBandData.getBandCore().supportSelectOtherBandOnMentionFor(this._currentProfileMemberType),canMentionMemberGroup:this._canMentionMemberGroup})}},_processAfterBandDataLoaded:function(){this._changeProfileData(),this._populateMentionsInput(),this._renderSecretButton(),this._bindUploaders(),this._sendJplAttachLog()},_changeProfileData:function(){this._currentProfileMemberType=this._messageInputBandData.getCurrentSelectedMemberProfileMemberType(),this._memberProfileArray=this._messageInputBandData.getSelectableMemberProfiles(),this._canMentionMemberGroup=this._messageInputBandData.canMentionToCurrentBandMemberGroup()&&this._mentionOption.isMemberGroupMentionPossible(),this._changeMentionListToCurrentBandCollection(),this._inputProfileView&&this._inputProfileView.changeProfileData(this._currentProfileMemberType,this._memberProfileArray)},_animateScrollParent:function(e,t){var n=o.Deferred();return m.pauseDetection(),e.animate({scrollTop:t},100,(function(){n.resolve(),m.resumeDetection()})),n},_calculateScrollTarget:function(){var e,t,n=this.ui.messageTextArea.scrollParent();return n[0].nodeType==f.DOCUMENT?(this._htmlBody||(this._htmlBody=o("html, body")),e=N.get$Window(),t=this._htmlBody):(e=n,t=n),{$scrollTopCheckingEl:e,$animateEl:t}},_showStickerSelectRegion:function(){a.getDGlobalChannel().trigger(a.EVENT.MESSAGE_INPUT_CLOSE_LAYER,this.cid),this._adjustStickerLayerOffset();var e=c.buildDStickerSelectionLayoutView({bandNo:this._bandNo});this.getUI("stickerSelectRegion").is(":visible")||this.getUI("stickerSelectRegion").css({"z-index":"3400",display:"block"}),this.getRegion("stickerSelectRegion").show(e),this._closeAttachedAreaAndResetData(),this.spawn(p.MSG.MESSAGE_INPUT_SHOW_STICKER)},_adjustStickerLayerOffset:function(){this.ui.stickerSelectRegion.removeClass("-stickerTop");var e,t,n=this.ui.stickerSelectRegion.scrollParent();n[0].nodeType==f.DOCUMENT?(e=N.get$Window().scrollTop()+N.getHeight(),t=this.ui.stickerInputButton.offset().top+340):(e=n.height()+n.offset().top,t=this.ui.stickerInputButton.offset().top+340);t>e&&this.ui.stickerSelectRegion.addClass("-stickerTop")},_hideStickerSelectRegion:function(){var e=this.getRegion("stickerSelectRegion");e.hasView()&&(e.empty(),this.getUI("stickerSelectRegion").css({"z-index":"auto",display:"none"}),this._determineButtonActivation(),this.spawn(p.MSG.MESSAGE_INPUT_HIDE_STICKER))},_closeLayerMenu:function(){this.isDestroyed()||this.ui.lyMenu.hide()},_toggleStickerSelectRegion:function(){if(!E.isContentCreationPunished())if(this.getRegion("stickerSelectRegion").hasView())this._hideStickerSelectRegion();else{if(!this._commentInputData.isPhotoExist())return this._commentInputData.resetCommentInput(),void this._showStickerSelectRegion();var e=h.openLayer({bodyTitle:IM("attach.uploaded_file_discard_description"),withoutHiding:!0});this.listenToOnce(e,h.EVENTS.CONFIRM,(function(){this._commentInputData.resetCommentInput(),this._showStickerSelectRegion()}))}},hasInputContent:function(){return!(this.isDestroyed()||!this._mentionsInput)&&(this._commentInputData.setMessage(i.trim(this._mentionsInput.val())),this._commentInputData.isAbleToSubmit())},_doSubmit:function(){if(!E.isContentCreationPunished()&&this._mentionsInput&&this._checkIfValidMaxLength()&&!this._mediaUploading&&!this._photoUploading&&!this._fileUploading&&!this._standByStatus&&this.hasInputContent()){var e=this._commentInputData;this._closePreview(),this._cancelUploading(),this.ui.photoArea.hide(),this.ui.photoList.empty(),this._closeLayerMenu(),this._commentInputData=v.buildCommentOrJoinQnAInputData(),this._hideStickerSelectRegion(),this._standByStatus=!0,this._prepareSendButton(),this.spawn(p.MSG.MESSAGE_INPUT_SUBMIT,{isSecret:this._secretMode,submitData:e,memberType:this._inputProfileView.getSelectedProfileMemberType(),jplExtra:t.extend({is_preview:this._messageInputBandData.isPreviewForJplExtra()},e.makeJackpotExtra())}),this._mentionsInput.resetMentionInput(),this._changeMentionListToCurrentBandCollection(),this._releaseSecretMode()}},_checkIfValidMaxLength:function(){if(this.isDestroyed())return!1;var e=i.trim(this._mentionsInput.val());return!e||e.length<=this._maxMessageLength||(alert(this._overMaxLengthAlertMessage),g.wrapDeferPromise(this).then(t.bind((function(){var e=i.trim(this._mentionsInput.val());this._mentionsInput.val(e.substring(0,this._maxMessageLength))}),this)),!1)},_showLoadingview:function(e){this.ui.previewImage.hide(),"file"==e?(this.ui.uploadContextWrap.removeClass([H,K].join(" ")),this.ui.uploadContextWrap.addClass(z),this.ui.previewFile.html(""),this.ui.closePreviewButton.removeClass(W),this.ui.closePreviewButton.addClass(G)):(this.ui.uploadContextWrap.removeClass([z,K].join(" ")),this.ui.uploadContextWrap.addClass(H),this.ui.previewImage.attr("src",""),this.ui.closePreviewButton.removeClass(G),this.ui.closePreviewButton.addClass(W)),this.ui.loadingImage.show(),this.ui.previewArea.show()},_showPreview:function(e,n){"file"==e?(this.ui.loadingImage.hide(),this.ui.previewImage.attr("src",""),this.ui.previewFile.html(n),this.ui.previewFile.show(),this.ui.closePreviewButton.removeClass(W),this.ui.closePreviewButton.addClass(G),this.ui.uploadContextWrap.addClass(z),this.ui.uploadContextWrap.removeClass(H)):(this.ui.previewImage.attr("src",n),this.ui.previewImage.setLoading(),this.ui.previewImage.on("setLoading:done",t.bind((function(){this.ui.previewImage.off("setLoading:done"),this.isDestroyed()||(this.ui.loadingImage.hide(),this.ui.previewFile.html(""),this.ui.previewImage.show(),this.ui.uploadContextWrap.addClass(H),this.ui.uploadContextWrap.removeClass(z),this.ui.closePreviewButton.removeClass(G),this.ui.closePreviewButton.addClass(W),"video"==e&&this.ui.uploadContextWrap.addClass(K))}),this))),this.ui.previewArea.show(),this.ui.photoArea.hide(),this._closeLayerMenu()},_closePreview:function(){this.ui.previewArea.hide(),this.ui.previewImage.attr("src",""),this.ui.previewFile.html(""),this.ui.uploadContextWrap.removeClass([H,z,K].join(" ")),this.ui.closePreviewButton.removeClass([W,G].join(" "))},_cancelUploading:function(){this._mediaUploader&&this._mediaUploading&&this._mediaUploader.cancelUpload(),this._fileUploader&&this._fileUploading&&this._fileUploader.cancelUpload(),this._photoUploader&&this._photoUploading&&this._photoUploader.cancelUpload()},_determineButtonActivation:function(){this._determineStickerButtonActivation(),this._determineSendButtonActivation()},_prepareSendButton:function(){if(this._standByStatus)return this.ui.sendMessageButton.addClass(S.ELEMENT.DISABLED).removeClass(S.ELEMENT.ACTIVE),void this.ui.sendMessageButton.text(this._standByMessage);this.ui.sendMessageButton.addClass(S.ELEMENT.ACTIVE).removeClass(S.ELEMENT.DISABLED),this.ui.sendMessageButton.text(this._buttonLabel)},_determineSendButtonActivation:function(){!this.isDestroyed()&&this._mentionsInput&&(this._standByStatus?this._prepareSendButton():(this._commentInputData.setMessage(this._mentionsInput.val()),this.ui.sendMessageButton.text(this._buttonLabel),!this._commentInputData.isAbleToSubmit()||this._mediaUploading||this._photoUploading||this._fileUploading?this.ui.sendMessageButton.addClass(S.ELEMENT.DISABLED).removeClass(S.ELEMENT.ACTIVE):this.ui.sendMessageButton.addClass(S.ELEMENT.ACTIVE).removeClass(S.ELEMENT.DISABLED)))},_determineStickerButtonActivation:function(){this.isDestroyed()||(this._commentInputData.isStickerExist()||this.getRegion("stickerSelectRegion").hasView()?this.ui.stickerInputButton.addClass(S.ELEMENT.ACTIVE):this.ui.stickerInputButton.removeClass(S.ELEMENT.ACTIVE))},_renderProfileInput:function(){this._inputProfileView=L.buildDMessageInputProfileView({bandNo:this._bandNo,memberProfileArray:this._memberProfileArray,currentProfileMemberType:this._currentProfileMemberType,preventAllEvent:this._preventAllEvent}),this.showChildView("profileInputRegion",this._inputProfileView)},_renderSecretButton:function(){this._messageInputBandData.isBandDataStateLoaded()&&this._messageInputBandData.canSetMessageSecret()?this.ui.secretModeButton.show():this.ui.secretModeButton.hide()},_closeAttachedAreaAndResetData:function(){this._cancelUploading(),this._commentInputData.resetCommentInput(),this._closePreview(),this.ui.photoInputArea.toggle(!this._commentInputData.isMaxPhotoCount()),this.ui.photoArea.toggle(this._commentInputData.isPhotoExist()),this.ui.photoList.empty(),this._determineButtonActivation()},_sendJplAttachLog:function(){this._shouldSendAttachLog&&(this.jplClick(w.CLASSIFIER.COMMENT_ATTACH,{is_preview:this._messageInputBandData.isPreviewForJplExtra()}),this._shouldSendAttachLog=!1)}});return Y.buildDCommentInputView=function(e){return new Y(t.extend({messageInputBandData:O.get(e.bandNo).getMessageInputBandDataAtComment()},e))},Y}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1056),s={SEE_TRANSLATION:"SEE_TRANSLATION",TRANSLATION_START:"TRANSLATION_START",TRANSLATION_END:"TRANSLATION_END"},a={},r=i.Object.extend({resetProperties:function(e){this._writtenIn=e.writtenIn,this._contents={original:e.content},this._isTranslatable=!(!e.isTranslatable||!e.content),this._highZIndex=e.highZIndex||!1,this._targetLanguage=null,this._sourceLanguage=null,this._lastTargetLanguage=null,this._lastSourceLanguage=null},isHighZIndex:function(){return 1==this._highZIndex},setHighZIndex:function(e){this._highZIndex=e},supportsMoreOption:function(){return this._isTranslatable&&o.isTranslatable()},supportsContentBottom:function(){return this.supportsMoreOption()&&(!!this._lastTargetLanguage||this.isTranslatableImmediately())},isOriginalShown:function(){return!this._targetLanguage},hasShownLayer:function(){return!t.isEmpty(a)},setShownLayer:function(e){this.listenToOnce(e,"destroy",(function(){delete a[e.cid]})),a[e.cid]=!0},isTranslatableImmediately:function(){return o.isTranslatableImmediately(this._writtenIn)},getContentTranslationSettingData:function(){var e=o.getTargetLanguage();return{languages:e.languages,selected:e.selected,sourceLanguage:this._sourceLanguage,targetLanguage:this._targetLanguage,writtenIn:this._writtenIn}},seeOriginal:function(){this._triggerTranslationEnd(null,null,this._contents.original)},seeTranslation:function(e,t){this.trigger(s.SEE_TRANSLATION,{targetLanguage:e,sourceLanguage:t})},translatePost:function(e,n,i,s){this._translate(i,s,t.bind(o.translatePost,o,e,n))},translateComment:function(e,n,i,s){this._translate(i,s,t.bind(o.translateComment,o,e,n))},_translate:function(e,n,i){var a=e||this._lastTargetLanguage||o.getSelectedTargetLanguage(),r=n||this._lastSourceLanguage,l=[a,r].join("_");t.has(this._contents,l)?this._triggerTranslationEnd(a,r,this._contents[l]):(this.trigger(s.TRANSLATION_START),i(a,r).then(t.bind((function(e){this._triggerTranslationEnd(a,r,this._contents[l]=e)}),this),t.bind((function(){this._triggerTranslationEnd(a,r)}),this)))},_triggerTranslationEnd:function(e,t,n){e&&(this._lastTargetLanguage=e),t&&(this._lastSourceLanguage=t),n&&(this._targetLanguage=e,this._sourceLanguage=t),this.trigger(s.TRANSLATION_END,{content:n})}});return r.EVENT=s,r.build=function(){return new r},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(1382),a=n(82),r=n(1123),l=n(1383),c=n(13),d=n(1384),u=n(1152),h=n(669),p=n(17),m=n(1180),_={VIDEO_PLAYER_PLAY:"videoPlayer:play",VIDEO_PLAYER_PAUSE:"videoPlayer:pause",VIDEO_PLAYER_OPEN_MEDIA_VIEWER:"videoPlayer:openMediaViewer",VIDEO_PLAYER_ENTERED_FULL_SCREEN:"videoPlayer:enteredfullscreen",VIDEO_PLAYER_EXITED_FULL_SCREEN:"videoPlayer:exitedfullscreen",VIDEO_PLAYER_VOLUME_CHANGED:"videoPlayer:volumeChanged"},g=o.View.extend({constructor:function(e){if(!e.videoWidth||!e.videoHeight)throw new Error("video width/height required");e.playerWidth||e.playerHeight?e.playerWidth?e.playerHeight||(e.playerHeight=e.playerWidth*e.videoHeight/e.videoWidth):e.playerWidth=e.playerHeight*e.videoWidth/e.videoHeight:(e.playerWidth=e.videoWidth,e.playerHeight=e.videoHeight),o.View.prototype.constructor.apply(this,arguments)},options:{poster:null,autoplay:!1,playingGroup:"video",loop:!1,useControl:!0,videoWidth:1,videoHeight:1,playerWidth:void 0,playerHeight:void 0,containerWidth:void 0,containerHeight:void 0,features:[],additionalClass:"",noplay:!1,disabledKeys:null,seekInterval:null,clickPlayingVideoToOpenMediaViewer:!1,muted:!0,startVolume:null,enableKeyboard:!1,useHighQuality:!1},className:function(){return"_playerControls static-player "+this.options.additionalClass},attributes:function(){var e={"data-viewname":"DStaticVideoPlayerView"};return e.style="width:"+this.options.playerWidth+"px;height:"+this.options.playerHeight+"px;",e},behaviors:function(){var e=[{behaviorClass:m,uiToggleEventName:"toggleControlUI"}],t=this.options.model.getVideoViewingProgressLoggingParameters();return t&&"video"===this.options.playingGroup&&e.push({behaviorClass:h,videoSelector:"video",bandNo:t.bandNo,videoId:t.videoId,postNo:t.postNo,photoNo:t.photoNo}),e},initialize:function(){this._reservePlay=this.model.hasSource(),this._mediaElement=null,this._mediaElementPlayer=null,this.listenTo(this,"toggleControlUI",this._toggleControls)},template:t.template(s),templateContext:function(){var e=a.make(this.options.poster,a.TYPE.w520),n=this.model.getSource();return this._isAutoPlayed&&(n=p.appendParamsToURL(n,{auto_play:"true"})),{source:n,contentClass:this._getContentClass(),poster:e,useGaussianblur:t.contains(this.options.features,"bandbackground"),containerWidth:this.options.containerWidth,containerHeight:this.options.containerHeight,playerWidth:this.options.playerWidth,playerHeight:this.options.playerHeight,expiredPoster:e,muted:this._getMutedSettingValue(),loop:this.options.loop,showBigPlay:!this.model.isExpired()&&this.options.useControl,showExpired:this.model.isExpired(),isLive:this.options.isLive}},ui:{playerControls:"._playerControls",btnVideoExpired:"._btnVideoExpired"},events:{click:function(){if(!this.options.noplay)return!this.model.isExpired()&&(this.model.get("waitForEncoding")?(alert(IM("web.imageviewer.alert.txt.encoding_progress_video")),!1):this._isPlayerReady()?(this.options.useControl||this._triggerVideoPlayerMediaViewerOpen(this._isPlaying()),!1):(this.model.hasSource()||this.listenToOnce(this.model,"change:waitForEncoding",(function(){this.model.get("waitForEncoding")&&alert(IM("web.imageviewer.alert.txt.encoding_progress_video"))})),this.play(),!1))},"click @ui.btnVideoExpired":function(){this._triggerVideoPlayerMediaViewerOpen()}},modelEvents:{waitForEncodingAborted:function(){this._reservePlay=!1},"change:source":"_changeSource"},onAttach:function(){this.model.isExpired()||this.options.noplay||r.register(this,{autoplay:this.options.autoplay,playingType:this.options.playingGroup})},onBeforeRender:function(){this._clearMediaElement()},onDomRefresh:function(){if(this.model.hasSource()){var e=this.options.features;this.options.useHighQuality&&this.model.hasHighQuality()&&(e=e.concat(["highquality"])),d.static(this.$("VIDEO"),{poster:a.make(this.options.poster,a.TYPE.w520),useControl:this.options.useControl,features:e,disabledKeys:this.options.disabledKeys,seekInterval:this.options.seekInterval,startVolume:this._getStartVolumeSettingValue(),enableKeyboard:this.options.enableKeyboard,isHighQuality:this.model.isHighQuality(),success:t.bind((function(e,n,o){var s=this.$(e);this._adjustPlayerElements(e,o);var a=t.bind((function(){s.one("playing",t.bind((function(e){"video"==this.options.playingGroup&&this.trigger(_.VIDEO_PLAYER_PLAY,this,{isAutoPlayed:this._isAutoPlayed,duration:e.target.duration,currentTime:e.target.currentTime})}),this))}),this),r=t.bind((function(){s.one("pause",t.bind((function(e){"video"==this.options.playingGroup&&this.trigger(_.VIDEO_PLAYER_PAUSE,this,{isAutoPlayed:this._isAutoPlayed,duration:e.target.duration,currentTime:e.target.currentTime}),this._isAutoPlayed=!1}),this))}),this);s.one("loadedmetadata",t.bind((function(e){s.on("play",t.bind((function(){a(),r()}),this)),a(),r()}),this)),s.on("pause",t.bind((function(){this._registerPlayTime(),this._reservePlay=!1}),this)),s.on("ended",t.bind((function(){this._unregisterPlayTime()}),this)),s.on("error",t.bind((function(){this.model.resetSources(),this._reservePlay=!1}),this)),o.container.on("mediaviewer:open",t.bind((function(){var e=this._isPlaying();this._mediaElementPlayer.pause(),this._triggerVideoPlayerMediaViewerOpen(e)}),this));var l,c=o.enterFullScreen;o.enterFullScreen=function(){var e=i("body");return l=e.css("overflow"),e.css("overflow","visible"),c.apply(this,arguments)},o.container.on("enteredfullscreen",t.bind((function(){window.requestAnimationFrame(t.bind(this.trigger,this,_.VIDEO_PLAYER_ENTERED_FULL_SCREEN))}),this)),o.container.on("exitedfullscreen",t.bind((function(){this._adjustPlayerElements(e,o),l&&(i("body").css("overflow",l),l=void 0),this.trigger(_.VIDEO_PLAYER_EXITED_FULL_SCREEN)}),this)),o.container.on("highquality:click",t.bind((function(){this.model.fetchSources(!this.model.isHighQuality())}),this)),s.one("canplay",t.bind((function(){this._mediaElement=e,this._mediaElementPlayer=o,this._retrievePlayTime()}),this)),s.on("playing",t.bind((function(){this._reservePlay=!0}),this)),s.on({clickToPause:t.bind((function(){this.options.clickPlayingVideoOpenMediaViewer&&this._triggerVideoPlayerMediaViewerOpen(!0)}),this),volumechange:t.bind((function(){this.trigger(_.VIDEO_PLAYER_VOLUME_CHANGED,{volume:this._mediaElement.volume,muted:this._mediaElement.muted})}),this)}),this._reservePlay&&o.play(),this._mediaElement=e,this._mediaElementPlayer=o,this._updatePauseScene()}),this)})}},_getContentClass:function(){var e=this.options.playerWidth/this.options.playerHeight,t=this.options.videoWidth/this.options.videoHeight;return e!==t?e>t?"gMiddleItem":"gCenterItem":""},_adjustPlayerElements:function(e,t){var n=this.$(e),i=t.container.find(".mejs-poster");t.container.css({height:"",width:""});var o=this._getContentClass();i.removeClass("gMiddleItem gCenterItem"),n.removeClass("gMiddleItem gCenterItem"),o&&(i.addClass(o),n.addClass(o));var s={};this.options.containerHeight?s.height=this.options.containerHeight+"px":s.height="",this.options.containerWidth?s.width=this.options.containerWidth+"px":s.width="",i.css(s),n.css(s)},_registerPlayTime:function(){this._mediaElement&&this.model.hasVideoId()&&l.registerPlayTime(this.model.getVideoId(),this._mediaElement.currentTime||0)},_retrievePlayTime:function(){if(this._mediaElement&&this.model.hasVideoId()){var e=l.getPlayTime(this.model.getVideoId());if(t.isNumber(e))try{this._mediaElement.setCurrentTime(e)}catch(e){console.log(e)}}},_unregisterPlayTime:function(){this.model.hasVideoId()&&l.unregisterPlayTime(this.model.getVideoId())},onBeforeDetach:function(){r.unregister(this),this._registerPlayTime(),this._clearMediaElement(),this.$("video").remove()},play:function(e){this._isAutoPlayed=!!e,this._isPlayerReady()?this._mediaElement.paused&&(this._mediaElementPlayer.play(),this._retrievePlayTime()):this._reservePlay||(this._reservePlay=!0,this.model.hasSource()||this.model.fetchSources(this.options.useHighQuality))},pause:function(){this._isPlayerReady()?this._mediaElement.paused||this._mediaElementPlayer.pause():this._reservePlay=!1},isPlayReserved:function(){return this._reservePlay},_isPlayerReady:function(){return!!this._mediaElementPlayer},_clearMediaElement:function(){this._mediaElementPlayer&&(this._mediaElementPlayer.bandcleanup(),this._mediaElement=null,this._mediaElementPlayer=null)},setPlayerSize:function(e){this.$el.width(e.width).height(e.height),t.defer(t.bind((function(){this._mediaElementPlayer&&t.isFunction(this._mediaElementPlayer.setControlsSize)&&this._mediaElementPlayer.setControlsSize()}),this))},_getStaticVideoPlayerDuration:function(){return t.result(this._mediaElement,"duration")||0},_getStaticVideoPlayerCurrentTime:function(){return t.result(this._mediaElement,"currentTime")||0},_isLoopStaticVideoPlayer:function(){return t.result(this._mediaElement,"loop")||!1},seekBackwardOrBeginning:function(e){var n=i.Deferred(),o=this._isLoopStaticVideoPlayer(),s=this._getStaticVideoPlayerDuration(),a=this.options.seekInterval||this._mediaElementPlayer.options.defaultSeekBackwardInterval(this._mediaElement),r=Math.max(0,this._getStaticVideoPlayerCurrentTime()-a),l=0==r;return s>0&&(this._mediaElementPlayer.showControls(),this._mediaElementPlayer.startControlsTimer()),e||o||!l?(this._mediaElement.setCurrentTime(r),n.resolve(l)):(i(this._mediaElement).one("pause",t.bind((function(){n.resolve(l)}),this)),this._mediaElement.setCurrentTime(r),this.pause()),n.promise()},seekForwardOrEnd:function(){var e=i.Deferred(),n=this._isLoopStaticVideoPlayer(),o=this._getStaticVideoPlayerDuration(),s=this.options.seekInterval||this._mediaElementPlayer.options.defaultSeekForwardInterval(this._mediaElement),a=Math.min(o,this._getStaticVideoPlayerCurrentTime()+s),r=a==o;return o>0&&(this._mediaElementPlayer.showControls(),this._mediaElementPlayer.startControlsTimer()),n||!r?(this._mediaElement.setCurrentTime(a),e.resolve(r)):(i(this._mediaElement).one("ended",t.bind((function(){e.resolve(r)}),this)),this._mediaElement.setCurrentTime(a)),e.promise()},_isPlaying:function(){return this._isPlayerReady()&&!this._mediaElement.paused},_triggerVideoPlayerMediaViewerOpen:function(e){e&&u.buildMediaViewerOptionsAddedToHolder().setAutoPlayOnOpening(!0),this.trigger(_.VIDEO_PLAYER_OPEN_MEDIA_VIEWER)},_toggleControls:function(e){this.trigger("showPlayerControls",e)},_getMutedSettingValue:function(){return this._settings?this._settings.muted:this.options.muted},_getStartVolumeSettingValue:function(){return this._settings?this._settings.volume:this.options.startVolume},_updatePauseScene:function(){!this._isPlaying()&&this._settings&&(i(this._mediaElement).one("playing",t.bind((function(){this.pause(),this._mediaElementPlayer.setMuted(this._settings.muted)}),this)),this._mediaElementPlayer.setMuted(!0),this.play())},_changeSource:function(){this._mediaElement&&(this._settings={muted:this._mediaElement.muted,volume:this._mediaElement.volume},this._registerPlayTime()),this.render()}});return g.EVENTS=_,g.buildThinVideoPlayer=function(e){return e=t.extend({},e,{autoplay:c.getUserConfig().isVideoAutoPlay(),features:["playpause","current","progress","duration","tracks","bandsetting","bandmediaviewer","volume"],additionalClass:"thin-player",clickPlayingVideoOpenMediaViewer:!0}),new g(e)},g.buildGifVideoPlayer=function(e){return e=t.extend({},e,{autoplay:!0,loop:!0,useControl:!1,additionalClass:"gif-player",playingGroup:"gif"}),new g(e)},g.buildBlurFullfillPlayer=function(e){var n=(e=t.extend({},{autoplay:c.getUserConfig().isVideoAutoPlay(),features:["playpause","current","progress","duration","tracks","bandsetting","bandmediaviewer","volume","bandoffvolume","bandbackground"],clickPlayingVideoOpenMediaViewer:!0},e)).playerWidth/e.playerHeight,i=e.videoWidth/e.videoHeight;return i>n?e.containerHeight=e.playerWidth*e.videoHeight/e.videoWidth:i<n&&(e.containerWidth=e.playerHeight*e.videoWidth/e.videoHeight),new g(e)},g.buildMediaPlayer=function(e){return(e=t.extend({},e,{features:["playpause","current","progress","duration","tracks","bandsetting","fullscreen","volume","bandpreventvideo"],useHighQuality:!0})).autoplay=!!e.autoplay||c.getUserConfig().isVideoAutoPlay(),new g(e)},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(2),o=n(0),s=n(10),a=n(627),r=n(1024),l=n(850),c=n(153),d=n(935),u=n(1023),h=n(17),p=n(26),m=n(668),_={downloadFile:function(e,t){if(t.isRestrictedFile())return m.openSimpleAlert(IM("post.msg.post_is_restricted")),i.when();var n={bandNo:e,dropbox:t.isDropboxFile(),externalFile:t.isExternalFile(),link:t.getFileLink(),fileId:t.getFileId(),expiresAt:t.getFileExpiresAt()};return l.downloadBandFile(n)},getOriginLabel:function(e){return e.isPostFile()?IM("web.bandfile.filelist.viewOriginPost"):e.isPhotoFile()?IM("ui.label.show_the_photo"):e.isScheduleFile()?IM("bandfile.filelist.viewOriginSchedule"):null},getOriginUrl:function(e,t){var n=t.getContentKey();return n?n.makeContentUrl(e):null},openOriginContent:function(e,t,n){if(t.isRestrictedFile())m.openSimpleAlert(IM("post.msg.post_is_restricted"));else{var i=t.getContentKey();if(!i)return null;t.isPostFile()||t.isPhotoFile()||t.isScheduleFile()?p.getBandChannel(e.bandNo).trigger(p.EVENT.OPEN_LAYER_CONTENT,{contentKey:i,openerView:n}):i.goToContentUrl(e)}},getFilesUrl:function(e){return c.GROUP_BAND_ATTACHMENT_FILES.makeUrl({band_no:e})},getFolderUrl:function(e,t){return c.GROUP_BAND_ATTACHMENT_FOLDER.makeUrl({band_no:e,folder_id:t.getFolderId()})},gotoFolder:function(e,t){c.GROUP_BAND_ATTACHMENT_FOLDER.goDForced({band_no:e,folder_id:t.getFolderId()})},changeFolderDocumentTitle:function(e,t){if(e&&t){var n=[t.getFolderName(),e.name].join(" : ");document.title=IM("page.title",{title:n})}},fetchBandFolder:function(e,t){return a.getFolder(e,t).then((function(e){return r.build(e.folder)}))},getFolderNameMaxLength:function(){return 100},createFolder:function(e,t){var n=s.trim(t);return this.isValidFolderName(n)?a.createFolder(e,n).then((function(e){return r.build(e.folder)})):i.Deferred().reject()},openFolderCreationModel:function(e){var t=i.Deferred();return d.openDPromptModalView({title:IM("file.create_new_folder"),maxlength:100,placeholder:IM("file.folder_name"),validation:o.bind(this.isValidFolderName,this),withoutHiding:!0}).once({"modal:confirm":o.bind((function(n){this.createFolder(e,n).then((function(e){t.resolve(e)}),(function(){t.reject()}))}),this),"modal:cancel":function(){t.reject()}}),t.promise()},updateFolderName:function(e,t,n){var r=t.getFolderId(),l=s.trim(n);return this.isValidFolderName(l)?a.setFolderName(e,r,l).then(o.bind((function(e){t.set(t.parse(e.folder))}),this)):i.Deferred().reject()},copyFolderUrl:function(e,t){var n=h.appendCurrentDomainOnPathUrl(this.getFolderUrl(e,t));u.openUrlCopyLayerView(n)},gotoAttachmentHome:function(e){c.GROUP_BAND_ATTACHMENT.goDForced({band_no:e})},deleteFolder:function(e,t){var n=t.getFolderFileCount();if(o.isFinite(n)&&n>0)return m.openSimpleAlert(IM("file.only_delete_empty_folder")),i.Deferred().reject();var s=t.getFolderId(),r=IM("file.folder_delete_confirm");return m.openPromiseTypeSimpleConfirm(r).then((function(){return a.deleteFolder(e,s)}))},isSameFolder:function(e,t){var n=e?e.getFolderId():null,i=t?t.getFolderId():null;return n&&i&&n===i},createFiles:function(e,t,n){var i={band_no:e,target:n?"folder":"unassigned",file:JSON.stringify(t)};return n&&(i.target_folder_id=n.getFolderId()),a.createFiles(i).then((function(t){return p.getBandChannel(e).trigger(p.EVENT.BAND_FILE_UPDATED),t}))},moveFiles:function(e,t,n){var i={band_no:e,target:n?"folder":"unassigned",file_ids:o.map(t,(function(e){return e.getFileId()})).join(",")};return n&&(i.target_folder_id=n.getFolderId()),a.moveFiles(i)},deleteFiles:function(e,t){var n=o.map(t,(function(e){return e.getFileId()})),i={bandNo:e,fileIds:n};return a.deleteFiles(i).then((function(t){return p.getBandChannel(e).trigger(p.EVENT.BAND_FILE_UPDATED),t}))},isValidFolderName:function(e){var t=s.trim(e);if(!t)return!1;if(t.length>100){var n=IM("ui.message.type_up_to_maxlength",{maxlength:100});return m.openSimpleAlert(n),!1}return!0}};e.exports=_},function(e,t,n){n(0);var i={encodeQuery:function(e,t){var n=$("<div/>").text(e).html();return t?n:n.replace(/\"/g,"&quot;")},decodeQuery:function(e){return $("<div/>").html(e).text()}};e.exports=i},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(2532),a=n(1404),r=n(1156),l=n(2541),c=n(2543),d=n(2550),u=n(486),h=n(26),p=n(2562),m=n(1571),_=n(153),g=n(162),f=n(53),b=n(2579),v=n(495),A=n(487),E=n(84),T=n(13),C=n(201),y=n(562),M=n(510),I=n(156),S=n(158),w=n(784),N=n(159),D=n(1114);function L(e){return i.find([_.GROUP_BAND_LIVE,g.PAGE_BAND_LIVE],(function(t){return t.isMatched(e)}))}var O,P="-liftUp",x="start",R="watching",k="exit",B="end",V=o.View.extend({tagName:"section",className:function(){return"lyWrap lyVideoLiveWrap -darkBg "+this.model.getLiveContentBandData().getBandCore().getSkinColorClass()},attributes:{"data-viewname":"DLiveViewerLayoutView"},template:i.template(s),behaviors:function(){return[N,{behaviorClass:v,sceneId:this.options.sceneId},{behaviorClass:A}]},onMessages:(O={},O[N.MSG.EXPIRED_LIVE_VOD_DELETED]=function(){var e=this.model.getLiveContentVodModel().getLiveVodPostNo();h.getPostChannel().trigger(h.EVENT.POST_UPDATED,e),this.destroy()},O),ui:{bottomSection:"._bottomSection",bottomBtn:"._bottomBtn",offBtn:"._offBtn",closeBtn:"._closeBtn",liveVideo:"._liveVideo",liveStatus:"._liveStatus",chatSection:"._chatSection",chatSectionLine:"._chatSectionLine",liveIntro:"._liveIntro",liveChat:"._liveChat",expiresText:"._expiresText"},regions:{liveVideo:{el:"@ui.liveVideo",replaceElement:!0},liveStatus:{el:"@ui.liveStatus",replaceElement:!0},liveIntro:{el:"@ui.liveIntro",replaceElement:!0},liveChat:{el:"@ui.liveChat",replaceElement:!0}},events:{"click @ui.offBtn":"_onClickOffBtn","click @ui.closeBtn":"_closeLiveViewer","mousedown @ui.chatSectionLine":"_onMouseDownChatSectionLine","dragstart @ui.chatSectionLine":function(e){e.preventDefault()}},modelEvents:{all:"_onTriggerLiveViewerModel"},initialize:function(e){this._sceneId=e.sceneId,this._bandData=this.model.getLiveContentBandData(),this._bandCore=this._bandData.getBandCore(),this._bandNo=this._bandCore.bandNo,this._liveId=this.model.getLiveContentLiveId()},templateContext:function(){var e=this._bandCore.getBandRouteInfo(_.GROUP_BAND_HOME,g.PAGE_BAND_HOME);return{enabled:{offBtn:this.model.canOffLiveContent(),closeBtn:!this.model.isStreamerModeLiveContent()},bandHomeUrl:e.makeUrl({band_no:this._bandNo}),bandHomeBtnLabel:e==_.GROUP_BAND_HOME?IM("web.uicomponent.topbar.button.band"):IM("ui.label.go_to_this_page"),expiresAt:I.makeRemainExpiresForStorageQuotaMessage(this.model.getLiveContentExpiresAt()),isExpiredVideo:I.isExpiredFile(this.model.getLiveContentExpiresAt())}},onRender:function(){this._renderLiveVideo(),this._renderLiveStatus(),this._renderLiveContents()},onAttach:function(){h.getDGlobalChannel().trigger(h.EVENT.LIVE_VIEWER_OPENED),this._sendSceneEnterLog(),this.model.startWatchingLiveContent(),this._width=this.$el.width(),this._chatSectionMinWidth=parseInt(this.ui.chatSection.css("min-width")),this._chatSectionMaxWidth=parseInt(this.ui.chatSection.css("max-width")),this.listenTo(h.getDGlobalChannel(),h.EVENT.WINDOW_RESIZE,(function(){this._width=this.$el.width()}))},onBeforeDetach:function(){this._stopHeartbeatLogSending(),this.model.stopWatchingLiveContent(),this.stopListening(h.getDGlobalChannel()),this.model.destroyLiveContent(),h.getDGlobalChannel().trigger(h.EVENT.LIVE_VIEWER_CLOSED)},_renderLiveVideo:function(){var e;e=this.model.isVodLiveContent()?b.buildDVodVideoPlayerView(this.model):p.buildDLiveVideoPlayerView(this.model),this.listenTo(e,m.TOGGLE_CHAT,(function(e){this.ui.chatSection.css("display",e?"":"none"),this.model.notifyLiveContentChatSectionSizeChanged()})),this.listenTo(e,m.PLAY_ENDED,(function(){this.model.validateLiveContent()})),this.listenTo(e,m.ERROR_OCCURRED,(function(){this.model.handleLiveContentVideoError()})),this.listenTo(e,m.PLAY_TIME_UPDATE,(function(e){this.model.updateLiveContentVideoOffset(e)})),this._getLiveVideoRegion().show(e),this.getUI("expiresText").hide(),this.listenTo(e,"showPlayerControls",(function(e){e?this.getUI("expiresText").show():this.getUI("expiresText").hide()}))},_getLiveVideoRegion:function(){return this.getRegion("liveVideo")},_renderLiveStatus:function(){var e=this.getRegion("liveStatus"),t=!1;switch(this._toggleOffBtn(),this.model.getLiveContentStatus()){case a.PLAYING:case a.LOADING:this.ui.bottomSection.css("display","");break;case a.PREVIEW:case a.PREVIEW_TIME_OVER:case a.STARTING:t=!0,this.ui.bottomSection.css("display","none");break;default:t=!0,this.ui.bottomSection.css("display","").addClass(P)}t?e.show(l.buildPreviewLiveViewerStatusView(this.model)):e.empty()},_renderLiveContents:function(){var e=this.getRegion("liveIntro"),t=this.getRegion("liveChat"),n=this.model.getLiveContentStatus();!e.hasView()&&n!=a.PREVIEW&&n!=a.PREVIEW_TIME_OVER?(this.ui.chatSection.css("display",""),e.show(c.buildLiveViewerIntroView(this.model)),t.show(d.buildLiveViewerChatLayoutView(this.model))):(e.empty(),t.empty(),this.ui.chatSection.css("display","none"))},_onClickOffBtn:function(){this._confirm(IM("live.live_off_confirm")).once(M.EVENTS.CONFIRM,i.bind((function(){this.model.stopLiveContentBroadcasting()}),this))},_onMouseDownChatSectionLine:function(e){var n="touchstart"==e.type,o=n?"touchmove":"mousemove",s=n?"touchend":"mouseup",a=t(document),r=e.originalEvent.touches,l=i.bind((function(e){e.preventDefault(),this._slideChatSectionLine(e.clientX)}),this),c=i.bind((function(e){this._slideChatSectionLine(e.clientX),a.off(o,l),a.off(s,c)}),this);r&&r[0]&&r[1]||(e.preventDefault(),a.on(o,l),a.on(s,c))},_slideChatSectionLine:function(e){var t=this._width-e;t>this._chatSectionMaxWidth?t=this._chatSectionMaxWidth:t<this._chatSectionMinWidth&&(t=this._chatSectionMinWidth),this.ui.chatSection.css("width",t+"px"),this.model.notifyLiveContentChatSectionSizeChanged()},_toggleOffBtn:function(){switch(this.model.getLiveContentStatus()){case a.STARTING:case a.LOADING:case a.PLAYING:this.ui.offBtn.css("display",this.model.canOffLiveContent()?"":"none");break;default:this.ui.offBtn.css("display","none")}},_isLayer:function(){return u.isContainedInLayer(this)},_closeLiveViewer:function(){this.model.isStreamerModeLiveContent()||!this._isLayer()?this._goBandHome():u.closeAll()},_isCurrentUrlLiveOrBandHome:function(){switch(f.getCurrentRouteInfo().routeInfo){case _.GROUP_BAND_LIVE:case _.GROUP_BAND_HOME:case g.PAGE_BAND_LIVE:case g.PAGE_BAND_HOME:return!0;default:return!1}},_goBandHome:function(){var e=this._bandCore.makeBandRouteUrl(_.GROUP_BAND_HOME,g.PAGE_BAND_HOME,{band_no:this._bandNo}),t=this.model.isStreamerModeLiveContent()||this._isCurrentUrlLiveOrBandHome();E.go(e,{replace:t})},_replaceStreamerViewUrl:function(){var e=this._bandCore.getBandRouteInfo(_.GROUP_BAND_LIVE,g.PAGE_BAND_LIVE).makeUrl({band_no:this._bandNo,live_id:this._liveId});E.go(e,{replace:!0,trigger:!1})},_removeBlockCommentAndChat:function(e){D.openPenaltyRemoveConfirm().confirm(i.bind((function(){var t=w.PENALTY_TYPE.BLOCK_COMMENT_AND_CHAT;w.removePenaltyMember(this._bandNo,e,t,!0).fail(i.bind((function(e){this.model.requestLiveContentApiErrorAlert(e)}),this))}),this))},_alert:function(e){return y.openLayer({bodyTitle:S.nl2br(e),withoutHiding:!0})},_confirm:function(e,t){return M.openLayer({bodyTitle:S.nl2br(e),withoutHiding:!0,confirm:t})},_onTriggerLiveViewerModel:function(e,t){switch(e){case r.EVENT.LIVE_STATUS_CHANGED:this._onChangeLiveStatus(t);break;case r.EVENT.CLOSE_LIVE_CONTENT_VIEWER:this._closeLiveViewer();break;case r.EVENT.LIVE_MESSAGE_ALERT_REQUESTED:this._alert(t);break;case r.EVENT.LIVE_BLOCK_COMMENT_AND_CHAT_REMOVE_REQUESTED:this._removeBlockCommentAndChat(t)}},_onChangeLiveStatus:function(e){e==a.PLAYING&&this._startHeartbeatLogSending(),this._renderLiveStatus(),e==a.STARTING&&(this._renderLiveContents(),this._replaceStreamerViewUrl()),this.model.isLiveContentEnded()&&(this._getLiveVideoRegion().empty(),this._stopHeartbeatLogSending(),this.model.stopWatchingLiveContent())},_sendSceneEnterLog:function(){switch(this._sceneId){case v.SCENE.LIVE_STREAMER_VIEW:this._sendLiveStreamerViewSceneEnterLog();break;case v.SCENE.LIVE_WATCHER_VIEW:this._sendLiveWatcherViewSceneEnterLog();break;case v.SCENE.LIVE_VOD_VIEW:this._sendLiveVodViewSceneEnterLog()}},_sendLiveStreamerViewSceneEnterLog:function(){this.jplSceneEnter(A.CLASSIFIER.LIVE_STREAMER_VIEW,{band_no:this._bandNo,live_id:this._liveId})},_sendLiveWatcherViewSceneEnterLog:function(){this.jplSceneEnter(A.CLASSIFIER.LIVE_WATCHER_VIEW,{band_no:this._bandNo,live_id:this._liveId})},_sendLiveVodViewSceneEnterLog:function(){this.jplSceneEnter(A.CLASSIFIER.LIVE_VOD_VIEW,{band_no:this._bandNo,video_id:this.model.getLiveContentVodModel().getLiveVodVideoId()})},_startHeartbeatLogSending:function(){(this.model.isOnAirLiveContent()||this.model.isPreviewLiveContent())&&(this._sendLiveParticipatingHeartbeatOccurLog(x),this._heartbeatIntervalId=setInterval(i.bind(this._sendLiveParticipatingHeartbeatOccurLog,this,R),5e3))},_stopHeartbeatLogSending:function(){this._heartbeatIntervalId&&(clearInterval(this._heartbeatIntervalId),this._heartbeatIntervalId=null,this._sendLiveParticipatingHeartbeatOccurLog(this.model.isLiveContentEnded()?B:k))},_sendLiveParticipatingHeartbeatOccurLog:function(e){this.jplOccur(A.CLASSIFIER.LIVE_PARTICIPATING_HEARTBEAT,{band_no:this._bandNo,live_id:this._liveId,live_current_time_sec:Math.floor(this.model.getLiveContentCurrentVideoOffset()/1e3),type:e,is_pip_mode:!1})}});function U(e,t){return t.then((function(t){var n,i=new V({model:t,sceneId:(n=t,n.isStreamerModeLiveContent()?v.SCENE.LIVE_STREAMER_VIEW:n.isOnAirLiveContent()?v.SCENE.LIVE_WATCHER_VIEW:v.SCENE.LIVE_VOD_VIEW)});return e&&u.open(i),i}),(function(e){var t=i.result(e,"result_data"),n=i.result(t,"message");n&&alert(n)}))}function F(){return C.isSupported()?!!T.isLogedIn()||(alert(IM("login_and_install.label.should_login_to_continue")),!1):(alert(IM("live.not_support_browser")),!1)}function H(e,n,i){return F()?U(e,r.buildOnAirLiveViewerModel(n,i)):t.Deferred().reject().promise()}return V.openPreviewLiveViewerLayer=function(e){return F()?U(!0,r.buildPreviewLiveViewerModel(e)):t.Deferred().reject().promise()},V.openOnAirLiveViewerLayer=function(e,t){H(!0,e,t)},V.openOnAirLiveViewerLayerByUrl=function(e){var t=L(e);if(t){var n=E.extractPageRouteData(t,e).pathVariables||{};H(!0,n.band_no,n.live_id)}},V.openVodLiveViewerLayer=function(e,t,n){U(!0,r.buildVodLiveViewerModel(e,t,n))},V.buildOnAirLiveViewer=function(e,t){var n=t.band_no,i=t.live_id;return H(!1,n,i).then((function(e){return e}),(function(){switch(f.getCurrentRouteInfo().routeInfo){case _.GROUP_BAND_LIVE:_.GROUP_BAND_HOME.goDForced({band_no:n},null,{replace:!0});break;case g.PAGE_BAND_LIVE:g.PAGE_BAND_HOME.goDForced({band_no:n},null,{replace:!0})}}))},V.getMatchedLiveDetailRouteInfo=L,V.isLiveDetailUrl=function(e){return!!L(e)},V}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(1174),a=n(13),r=n(53),l=n(157);return new(o.Object.extend({initialize:function(){this._targetLanguage={},this._myLanguages={}},prepareTranslation:function(){return i.isEmpty(this._targetLanguage)&&a.isLogedIn()&&!window.isMobileView&&r.getCurrentRouteInfo().routeInfo!=l.GLOBAL_SETTING_TRANSLATION?this.fetchTranslationSettings():t.when()},fetchTranslationSettings:function(){return t.when(s.getTargetLanguage(),s.getMyLanguages()).then(i.bind((function(e,t){return this._targetLanguage={languages:e.languages,selected:e.selected||""},this._myLanguages={languages:t.languages,selected:t.selected||[]},this.getTranslationSettings()}),this))},getTranslationSettings:function(){return{targetLanguage:this.getTargetLanguage(),myLanguages:this.getMyLanguages()}},getTargetLanguage:function(){return i.clone(this._targetLanguage)},getMyLanguages:function(){return i.clone(this._myLanguages)},setTargetLanguage:function(e){return s.setTargetLanguage(e).then(i.bind((function(){this._targetLanguage.selected=e}),this))},setMyLanguages:function(e){return s.setMyLanguages(e.join(",")).then(i.bind((function(){this._myLanguages.selected=e}),this))},isTranslatableImmediately:function(e){return!!e&&(!i.contains(this._myLanguages.selected,e)&&!!i.findWhere(this._targetLanguage.languages,{code:e}))},getSelectedTargetLanguage:function(){return this._targetLanguage.selected},isTranslatable:function(){return!!this.getSelectedTargetLanguage()},translatePost:function(e,t,n,i){var o={band_no:e,post_no:t,target_language:n};return i&&(o.source_language=i),s.translatePost(o).then((function(e){return e.content}))},translateComment:function(e,t,n,i){var o={band_no:e,content_key:t,target_language:n};return i&&(o.source_language=i),s.translateComment(o).then((function(e){return e.content}))}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(493),a=n(486),r=n(510),l=n(153),c=n(1300),d=n(168),u=n(562),h=n(506),p=o.View.extend({attributes:{"data-viewname":"DBandMemberWithdrawalConfirmView"},template:t.template(c),ui:{btnCancel:"._btnCancel",inputWithdrawal:"._inputWithdrawal",btnConfirm:"._btnConfirm"},events:{"click @ui.inputWithdrawal":"_setActiveButtonStyle","click @ui.btnConfirm":"_confirmMemberWithdrawal","click @ui.btnCancel":"destroy"},initialize:function(e){this.bandNo=e.bandNo,this.userNo=e.userNo,this._userNos=e.userNos,this.isDeleted=e.isDeleted,this._memberKey=e.memberKey,this._withdrawOnly=e.withdrawOnly},serializeData:function(){return{cid:this.cid,isDeleted:this.isDeleted}},_setActiveButtonStyle:function(){this.ui.btnConfirm.toggleClass("-disabled",!1)},_confirmMemberWithdrawal:function(){if(this.isDeleted)var e=!0;else e="withdrawalWithBlock"==this.ui.inputWithdrawal.filter(":checked").val();t.isEmpty(this._userNos)?this._doWithdrawBandMember(e):this._doWithdrawBandMembers(e)},_doWithdrawBandMember:function(e){s.doWithdrawBandMember(this.bandNo,this.userNo,e,!0).then(t.bind((function(){this._withdrawOnly?(this._openMessageAlert(IM("ui.alert.request_completed")),this._triggerMemberWithdrawal()):this._openDoneConfirm(),this.destroy()}),this),t.bind((function(e){var t=h.get(e,"result_data.message");t&&this._openMessageAlert(t),this.destroy()}),this))},_doWithdrawBandMembers:function(e){var n=this._userNos.join(",");s.doWithdrawBandMembers(this.bandNo,n,e,!0).then(t.bind((function(){this._openMessageAlert(IM("ui.alert.request_completed")),this._triggerMembersWithdrawal(),this.destroy()}),this),t.bind((function(e){var t=h.get(e,"result_data.message");t&&this._openMessageAlert(t),this.destroy()}),this))},_triggerMemberWithdrawal:function(){this.trigger("memberWithdrawal:updateMember")},_triggerMembersWithdrawal:function(){this.trigger("membersWithdrawal:updateMemberList")},_openMessageAlert:function(e){u.openLayer({bodyTitle:e})},_openDoneConfirm:function(){var e=r.openLayer({bodyTitle:IM("memberWithdrawal.forced_title.alert"),bodyDesc:IM("memberWithdrawal.forced.alert"),confirm:IM("web.ui.button.label.complete"),cancel:IM("manage.your.posts_label")});e.once(r.EVENTS.CONFIRM,t.bind((function(){this._triggerMemberWithdrawal()}),this)),e.once(r.EVENTS.CANCEL,t.bind((function(){this._fetchMemberKey().then(t.bind((function(e){l.GROUP_BAND_MEMBER_CONTENT.goDForced({band_no:this.bandNo,member_key:e,type:"post"})}),this))}),this))},_fetchMemberKey:function(){return this._memberKey?i.Deferred().resolve(this._memberKey):d.getMemberKeyByUserNo(this.bandNo,this.userNo)}});return p.openLayer=function(e){var t=new p({bandNo:e.bandData.getBandNo(),userNo:e.userNo,userNos:e.userNos,memberKey:e.memberKey,isDeleted:e.isDeleted,withdrawOnly:!e.bandData.canAccessSearchMemberPostWebPage()||e.withdrawOnly});return a.open(t),t},p}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=Promise.all([n.e(18),n.e(16),n.e(87),n.e(30),n.e(117)]).then(n.t.bind(null,611,7)).then((function(e){t=e.default}));return{openJoinApplicationSingleViewer:function(e,n){return o.then(i.bind((function(){var i=this._makeMediaViewerOptions(e,n,0);return t.openDPhotoVideoImageViewer(i)}),this))},openJoinApplicationSingleViewerAsPopup:function(e,n,s){return o.then(i.bind((function(){var i=this._makeMediaViewerOptions(e,n,s);i.popupName="bandJoinAnswerImage",i.expandSupport=!1,t.openDImageViewerAsPopup(i)}),this))},_makeMediaViewerOptions:function(e,t,n){return{result_data:{photos:t,total_count:t.length},bandNo:e,hidePageIndex:1==t.length,openIndex:n}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{DOCUMENT:9}}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(580),a=n(491),r=n(158),l=n(156),c=n(82),d=n(16),u=n(183),h=null,p=Promise.resolve().then(n.t.bind(null,1005,7)).then((function(e){h=e.default})),m=o.Model.extend({idAttribute:"commentId",initialize:function(){},getCommentId:function(){return this.get("commentId")},getOriginCommentId:function(){return this.get("originCommentId")},getContents:function(){return this.get("contents")},isMoreButton:function(){return this.isPreviousButton()||this.isNextButton()},isPreviousButton:function(){return 1==this.get("isPreviousMoreButton")},isNextButton:function(){return 1==this.get("isNextMoreButton")},getBandNo:function(){return this.get("bandNo")},getBandCore:function(){return this.get("bandCore")},canClickMention:function(){return this.getBandCore().supportMentionClick()},getAuthorUserNo:function(){return this.get("authorUserNo")},getAuthorName:function(){return this.get("authorName")},isCertifiedAuthor:function(){return this.get("isCertifiedAuthor")},getAuthorNickname:function(){return this.get("authorNickname")},getAuthorRealName:function(){return this.get("authorRealName")},getAuthorMemberProfile:function(){return this.get("authorMemberProfile")},isAudioExist:function(){return this.get("isAudioExist")},getAudioUrl:function(){return this.get("audioUrl")},getAudioDuration:function(){return this.get("audioDuration")},isContentsDeletionPermitted:function(){return this.get("contentsDeletionPermitted")},isModifiable:function(){return this.get("isModifiable")},getBody:function(){return this.get("body")},isPossibleToReport:function(){return this.get("isPossibleToReport")},isPossibleToHide:function(){return this.get("isPossibleToHide")},hasHideCommentPermit:function(){return this.get("hasHideCommentPermit")},isPhotoExist:function(){return this.get("isPhotoExist")},isMultiplePhotoAttached:function(){return this.get("isMultiplePhotoAttached")},isStickerExist:function(){return this.get("isStickerExist")},getStickerPackNo:function(){return this.get("stickerPackNo")},getStickerId:function(){return this.get("stickerId")},getStickerImageUrl:function(){return this.get("stickerImageUrl")},getAniStickerImageUrl:function(){return this.get("aniStickerImageUrl")},isAniSticker:function(){return u.ANIMATION.RESOURCE_TYPE==this.get("stickerResourceType")},getStickerImageWidth:function(){return this.get("stickerImageWidth")},getStickerImageHeight:function(){return this.get("stickerImageHeight")},getConvertedStickerWidth:function(){return this.get("convertedStickerWidth")},getConvertedStickerHeight:function(){return this.get("convertedStickerHeight")},getPhotos:function(){return this.get("photos")},getPhotoCount:function(){return this.get("photoCount")},getFirstPhotoUrl:function(){return(this.getPhotos()||[])[0].url},getFirstPhotoWidth:function(){return(this.getPhotos()||[])[0].width},getFirstPhotoHeight:function(){return(this.getPhotos()||[])[0].height},isFirstPhotoGif:function(){return/\.gif$/i.test(this.getFirstPhotoUrl())},getExpiresFileSchedule:function(){var e=this.get("expiresAt");return e?l.isExpiredFile(e)?IM("web.postdetail.attachfile.txt.expired"):d().add(365,"day").isBefore(d(e))?"":l.makeRemainExpiresForStorageQuotaMessage(e):""},getFileName:function(){return this.get("fileName")},getFileId:function(){return this.get("fileId")},getFileSize:function(){return this.get("fileSize")},isFileExist:function(){return this.get("isFileExist")},getDropboxFileLink:function(){return this.get("dropboxFileLink")},getDropboxFileName:function(){return this.get("dropboxFileName")},getDropboxFileId:function(){return this.get("dropboxFileId")},getDropboxFileSize:function(){return this.get("dropboxFileSize")},isDropboxFileExist:function(){return this.get("isDropboxFileExist")},getExternalFileLink:function(){return this.get("externalFileLink")},getExternalFileName:function(){return this.get("externalFileName")},getExternalFileId:function(){return this.get("externalFileId")},getExternalFileSize:function(){return this.get("externalFileSize")},getExternalFileSource:function(){return"one_drive"==this.get("externalFileSource")?"OneDrive":this.get("externalFileSource")},isExternalFileExist:function(){return this.get("isExternalFileExist")},isVideoSnippet:function(){return"video"==this.get("snippetType")},getSnippetUrl:function(){return this.get("snippetUrl")},isSnippetImage:function(){return c.make(this.get("snippetImage"))},getSnippetDescription:function(){return this.get("snippetDescription")},setModificationMode:function(e){this.set("modificationMode",e)},isModificationMode:function(){return 1==this.get("modificationMode")},isSmallBox:function(){return 1==this.get("isSmallBox")},isVisibleOnlyToAuthor:function(){return this.get("isVisibleOnlyToAuthor")},isHiddenComment:function(){return this.get("isHiddenComment")},isSecret:function(){return this.get("isSecret")},isSecretKnownToViewer:function(){return this.get("isSecretKnownToViewer")},isSecretAndUnknownToViewer:function(){return this.get("isSecretAndUnknownToViewer")},isRestricted:function(){return this.get("isRestricted")},getPunishedAt:function(){return this.get("punishedAt")},getPunishTitle:function(){return this.get("punishTitle")},getHasHiddenCommentInfo:function(){return this.get("hasHiddenCommentInfo")},isVideoExist:function(){return this.get("isVideoExist")},getVideoId:function(){return this.get("videoId")},getVideoWidth:function(){return this.get("videoWidth")},getVideoHeight:function(){return this.get("videoHeight")},getVideoThumbnail:function(){return this.get("videoThumbnail")},isGifVideo:function(){return 1==this.get("isGifVideo")},getVideoExpiresAt:function(){return this.get("videoExpiresAt")},getEmotionCount:function(){return this.get("emotionCount")},canShowEmotionArea:function(){return 1==this.get("showEmotionArea")},isPossibleToRecover:function(){return this.get("isPossibleToRecover")},isEmotionExist:function(){return this.getEmotionCount()>0},getCommonEmotionType:function(){return this.get("commonEmotionType")},getEmotionTypeByViewer:function(){return this.get("emotionTypeByViewer")},isTranslatable:function(){return 1==this.get("translatable")},setTranslatedContent:function(e){this.set({contents:r.convertText(e,null,!this.isMentionedUserClickable(),!0)})},getTranslationChannel:function(){return this.get("translationChannel")},getLatestComment:function(){return this.get("latestComment")},getLatestCommentCount:function(){return i.isEmpty(this.getLatestComment())?0:this.getLatestComment().length},isMoreCommentExistExceptLatest:function(){return!!this.isReplyExist()&&this.getReplyCount()-this.getLatestCommentCount()>0},getReplyCount:function(){return this.get("replyCount")},getReplyCountExceptLatest:function(){return this.getReplyCount()-this.getLatestCommentCount()},setReplyCountSilently:function(e){this.set("replyCount",e,{silent:!0})},isReply:function(){return this.get("isReply")},isReplyExist:function(){return this.getReplyCount()>0},getContentKey:function(){return this.get("contentKey")},getContentKeyForReply:function(){return this.get("contentKeyForReply")},isMentionedUserClickable:function(){return this.get("isMentionedUserClickable")},getAuthorMemberType:function(){return this.get("authorMemberType")},isAuthorPageProfileMemberType:function(){return this.get("isAuthorPageProfileMemberType")},fetchAndRefresh:function(e){t.when(a.getCachedBandData(e),s.fetchComment(e,this.getContentKey()),p).then(i.bind((function(e,t){var n=this.getContentKey().clone();n.setCommentId(null);var i=h.buildByDetailDComment(t,e,n,this.isReply(),null);this.clear({silent:!0}),this.set(i.toJSON())}),this))},getContentUrl:function(){return this.get("contentUrl")},getMuteIgnoredAuthorUserNo:function(){return this.get("muteIgnoredAuthorUserNo")},isHiddenFilterIgnored:function(){return this.get("isHiddenFilterIgnored")}});return m.buildDCommentViewModel=function(e){return new m(e)},m}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(26),a=n(800),r=n(870),l=n(2028),c=n(510),d=n(2437),u=n(9),h=n(2439),p=n(514),m=n(2441),_=n(486),g=n(491),f=n(157),b=n(1183),v=n(152),A=n(1637),E=n(798),T=n(53),C=n(162),y=n(2444),M=n(2031),I=n(556),S=n(517),w=n(1403),N=n(493),D=n(84),L=n(520),O=n(2032),P={MODIFY_POST:"postMoreAction:modifyPost",SET_NOTICE:"postMoreAction:setNotice",UNSET_NOTICE:"postMoreAction:unsetNotice",SET_MAJOR_NOTICE:"postMoreAction:setMajorNotice",UNSET_MAJOR_NOTICE:"postMoreAction:unsetMajorNotice",SEND_AN_ALERT:"postMoreAction:sendAnAlert",COPY_POST:"postMoreAction:copyPost",REPORT_POST:"postMoreAction:reportPost",DELETE_POST:"postMoreAction:deletePost",SHOW_POST_URL:"postMoreAction:showPostUrl",COPY_POST_URL_SUCCESS:"postMoreAction:copyPostUrl:success",HIDE_BAND_FROM_FEED:"postMoreAction:hideBandFromFeed",HIDE_POST_FROM_FEED:"postMoreAction:hidePostFromFeed",BOOKMARK_ADD_POST:"postMoreAction:bookmarkAddPost",MUTE_AUTHOR:"postMoreAction:muteAuthor",UNMUTE_AUTHOR:"postMoreAction:unmuteAuthor",UNCOVER_DIMMED_POST:"postMoreAction:uncoverDimmedPost",HIDE_POST_FROM_OTHERS:"postMoreAction:hidePostFromOthers",BOOKMARK_DELETE_POST:"postMoreAction:bookmarkDeletePost",SUBSCRIBE_PAGE_BAND:"postMoreAction:subscribePageBand",SEE_POST_STATS:"postMoreAction:seePostStats",CANCEL_MISSION_CONFIRM_POST:"postMoreAction:cancelMissionConfirmPost",DOWNLOAD_COMMENTS:"postMoreAction:downloadComments"},x=o.Behavior.extend({ui:{closeNotificationCard:"._closeNotificationCard",notificationCard:"._notificationCard",myPageLink:"._myPageLink"},events:{"click @ui.closeNotificationCard":function(){return this.$el.find(this.getUI("notificationCard").selector).remove(),!1}},_getBandCore:function(){return this.view.model.getBandCore()},_getBandNo:function(){return this.view.model.getBandNo()},_getPostNo:function(){return this.view.model.getPostNo()},_getAuthorUserNo:function(){return this.view.model.getAuthor().getUserNo()},initialize:function(){var e={};e[P.MODIFY_POST]=this._modifyPost,e[P.SET_NOTICE]=this._setNotice,e[P.UNSET_NOTICE]=this._unsetNotice,e[P.SET_MAJOR_NOTICE]=this._setMajorNotice,e[P.UNSET_MAJOR_NOTICE]=this._unsetMajorNotice,e[P.SEND_AN_ALERT]=this._sendAnAlert,e[P.COPY_POST]=this._copyPostUrl,e[P.REPORT_POST]=this._reportPost,e[P.DELETE_POST]=this._deletePost,e[P.SHOW_POST_URL]=this._showPostUrl,e[P.COPY_POST_URL_SUCCESS]=this._copyPostUrlSuccess,e[P.HIDE_BAND_FROM_FEED]=this._hideBandFromFeed,e[P.HIDE_POST_FROM_FEED]=this._hidePostFromFeed,e[P.BOOKMARK_ADD_POST]=this._bookmarkAddPost,e[P.MUTE_AUTHOR]=this._muteAuthor,e[P.UNMUTE_AUTHOR]=this._unmuteAuthor,e[P.UNCOVER_DIMMED_POST]=this._uncoverDimmedPost,e[P.HIDE_POST_FROM_OTHERS]=this._hidePostFromOthers,e[P.BOOKMARK_DELETE_POST]=this._bookmarkDeletePost,e[P.SUBSCRIBE_PAGE_BAND]=this._subscribePageBand,e[P.SEE_POST_STATS]=this._seePostStats,e[P.CANCEL_MISSION_CONFIRM_POST]=this._cancelMissionConfirmPost,e[P.DOWNLOAD_COMMENTS]=this._downloadComments,this.listenTo(this.view,e)},_modifyPost:function(){return(new I).fetchPost(this._getBandNo(),this._getPostNo()).then(i.bind((function(e){s.getPostChannel().trigger(s.EVENT.MODIFY_POST,this._getBandNo(),this._getPostNo(),e)}),this))},_setNotice:function(){g.getCachedBandData(this._getBandNo()).then(i.bind((function(e){var n=t.extend(this.view.model.toJSON(),{unset_at:this.view.model.toJSON().bandNoticeUnsetAt,time_zone_id:this.view.model.toJSON().bandNoticeTimeZoneId}),o={view:A,option:{bandNo:this._getBandNo(),post:n,hasLinkedBand:e.canShowPostNoticeToConnectedBand()}},s=o.view.openAsLayer(o.option);this.listenTo(s,"modal:confirm",(function(e){s instanceof A?this._setNoticeState(e.bandNo,e.postNo,e.noticeState,e.isLinkedBandNotice,e.alertMessage,e.unsetAt,e.timezoneId):"major_notice"===e?this._setMajorNotice():"general_notice"===e&&r.setBandNotice(this._getBandNo(),this._getPostNo()).then(i.bind(this._alertMessageAndTriggerNoticeUpdateEvent,this))}))}),this))},_unsetNotice:function(){g.getCachedBandData(this._getBandNo()).then(i.bind((function(e){if(e.canShowPostNoticeToConnectedBand()){this._setNoticeState(this._getBandNo(),this._getPostNo(),"off",!1,IM("page.notice.setting.off.notice"))}else r.unsetBandNotice(this._getBandNo(),this._getPostNo()).then(i.bind(this._alertMessageAndTriggerNoticeUpdateEvent,this))}),this))},_setMajorNotice:function(){return c.openLayer({headerTitle:IM("web.postdetail.menu.set_major_notice"),bodyDesc:IM("web.postdetail.menu.major_notice_addition_confirm_desc")}).once(c.EVENTS.CONFIRM,i.bind((function(){r.setMajorBandNotice(this._getBandNo(),this._getPostNo()).then(i.bind(this._alertMessageAndTriggerNoticeUpdateEvent,this))}),this)),!1},_unsetMajorNotice:function(){r.unsetMajorBandNotice(this._getBandNo(),this._getPostNo()).then(i.bind(this._alertMessageAndTriggerNoticeUpdateEvent,this))},_setNoticeState:function(e,t,n,o,s,a,l){r.setBandNoticeState(e,t,n,o,a,l).then(i.bind((function(){this._alertMessageAndTriggerNoticeUpdateEvent(s)}),this))},_alertMessageAndTriggerNoticeUpdateEvent:function(e){alert(e),s.getPostChannel().trigger(s.EVENT.UPDATE_BAND_NOTICE),s.getPostChannel().trigger(s.EVENT.POST_UPDATED,this._getPostNo())},_sendAnAlert:function(){var e=this,t={bandNo:this._getBandNo(),postNo:this._getPostNo()};M.openLayer(t).then((function(t){e.listenTo(t,M.EVENT.SEND_LOG,(function(t){e.view.jplClick(t.classifier,t.extraData)}))}))},_copyPostUrl:function(){var e=this._getBandNo(),t=this._getPostNo();if(this.view.model instanceof I||this.view.model instanceof S){var n=this.view.model.hasAttachment(v.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP);s.getPostChannel().trigger(s.EVENT.COPY_POST,e,t,n)}else(new I).fetchPost(e,t).then((function(n){var i=n.hasAttachment(v.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP);s.getPostChannel().trigger(s.EVENT.COPY_POST,e,t,i)}))},_copyPostUrlSuccess:function(){var e="<div class='notificationCard _notificationCard'>"+IM("post.option_menu.copy_url.success")+"<button type='button' class='close _closeNotificationCard'><span class='gSrOnly'>"+IM("ui.label.close")+"</span></button></div>";this._notificationTemplate(e)},_deletePost:function(){g.getCachedBandData(this._getBandNo()).then(i.bind((function(e){var t={bandNo:this._getBandNo(),postNo:this._getPostNo(),canReport:!this.view.model.get("isAuthor")&&u.spec.canReport()&&!this.view.model.get("isRestricted"),canDelete:this.view.model.get("isAuthor")||e&&e.isContentsDeletionPermitted()},n=h.buildAsLayer(t);this.listenTo(n,"postItem:postDelete",i.bind((function(){this.view.model.destroyPost().then(i.bind((function(){n.destroy(),s.getPostChannel().trigger(s.EVENT.POST_DELETED,{bandNo:this._getBandNo(),postNo:this._getPostNo()}),!i.isNull(this.view.model.getMissionInfoForPost())&&this.view.model.getAuthor().isMyself()&&s.getPostChannel().trigger(s.EVENT.CANCEL_MISSION_CONFIRM,{bandNo:this._getBandNo(),postNo:this._getPostNo(),missionId:this.view.model.getMissionInfoForPost().getMissionId()})}),this))}),this)),this.listenTo(n,"postItem:postDeleteWithReport",i.bind((function(){this._reportPost(),n.destroy()}),this))}),this))},_muteAuthor:function(){c.openLayer({bodyTitle:IM("mute_author.confirm.title"),bodyDesc:IM("mute_author.confirm.desc"),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no")}).once(c.EVENTS.CONFIRM,i.bind((function(){return N.muteMember(this._getAuthorUserNo(),this._getBandNo()).then(i.bind((function(){D.refreshCurrentPage()}),this))}),this))},_unmuteAuthor:function(){a.openAsLayer({title:IM("post.unmute_author.menu_layer.title"),confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:[{label:IM("post.unmute_author.menu_layer.menu.unmute_once"),value:"unmute_once"},{label:IM("post.unmute_author.menu_layer.menu.unmute_author"),value:"unmute_author"}],initialCheckedValue:"unmute_once",withoutHiding:!0}).once("modal:confirm",i.bind((function(e){"unmute_once"===e?this.view.bPostDetail?this.view.uncoverOnce():this.view.openPostDetailLayerWithUncoverOnce&&this.view.openPostDetailLayerWithUncoverOnce():"unmute_author"===e&&N.unmuteMember(this._getAuthorUserNo(),this._getBandNo()).then(i.bind((function(){D.refreshCurrentPage()}),this))}),this))},_recoverHiddenPost:function(){if(this.view.model.get("isRecoverableByViewer")){var e=i.bind((function(){(i.isFunction(this.view.model.showPostFromOthers)?this.view.model.showPostFromOthers():L.showPostFromOthers(this._getBandNo(),this._getPostNo())).then(i.bind((function(){s.getPostChannel().trigger(s.EVENT.POST_UPDATED,this._getPostNo())}),this))}),this);i.isFunction(this.view.model.isUncoveredOnce)&&this.view.model.isUncoveredOnce()?e():a.openAsLayer({title:IM("post.unmute_author.menu_layer.title"),confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:[{label:IM("post.unmute_author.menu_layer.menu.unmute_once"),value:"recover_once"},{label:IM("web.postdetail.comment.btn.show_comment"),value:"recover_hidden_post"}],initialCheckedValue:"recover_once",withoutHiding:!0}).once("modal:confirm",i.bind((function(t){"recover_once"===t?this.view.bPostDetail?this.view.uncoverOnce():this.view.openPostDetailLayerWithUncoverOnce&&this.view.openPostDetailLayerWithUncoverOnce():"recover_hidden_post"===t&&e()}),this))}},_hidePostFromOthers:function(){c.openLayer({bodyTitle:"게시글을 숨깁니까? (실험실 기능입니다.)",confirm:IM("ui.label.yes"),cancel:IM("ui.label.no")}).once(c.EVENTS.CONFIRM,i.bind((function(){L.hidePostFromOthers(this._getBandNo(),this._getPostNo()).then(i.bind((function(){s.getPostChannel().trigger(s.EVENT.POST_UPDATED,this._getPostNo())}),this))}),this))},_uncoverDimmedPost:function(){var e=v.findPriorRestriction({isRestricted:this.view.model.get("isRestricted"),isVisibleOnlyToAuthor:this.view.model.get("isVisibleOnlyToAuthor"),isMutedAuthorPost:this.view.model.isMutedAuthorPost()});e===v.RESTRICTION_TYPE.HIDE_POST?this._recoverHiddenPost():e===v.RESTRICTION_TYPE.MUTE_AUTHOR&&this._unmuteAuthor()},_reportPost:function(){var e=i.bind((function(e){g.getCachedBandData(this._getBandNo()).then(i.bind((function(t){var n=this.view.model.get("isAuthor")||t&&t.isContentsDeletionPermitted(),o=t&&t.isBanMemberPermitted(),a={bandNo:e.bandNo,userNo:e.reporteeNo,canDelete:n,canBanMember:o};if(n||o){var r=d.buildAsLayer(a);this.listenTo(r,"postItem:postDelete",i.bind((function(){this.view.model.destroyPost().then(i.bind((function(){s.getPostChannel().trigger(s.EVENT.POST_DELETED,{bandNo:this._getBandNo(),postNo:this._getPostNo()})}),this))}),this)),this.listenTo(r,"DPostDeleteWithReportView:postReported",(function(){s.getPostChannel().trigger(s.EVENT.POST_REPORTED,{bandNo:this._getBandNo(),postNo:this._getPostNo()})}))}else s.getPostChannel().trigger(s.EVENT.POST_REPORTED,{bandNo:this._getBandNo(),postNo:this._getPostNo()})}),this))}),this),t={bandNo:this._getBandNo(),postNo:this._getPostNo(),fnCallback:e};p.openPostReportPopup(t)},_showPostUrl:function(){var e=this._getBandCore(),t=this._getPostNo();_.openWithoutHiding(m.buildDPostDetailUrlView(e,t))},_hideBandFromFeed:function(){var e=this.view.model,t=e.get("band");c.openLayer({headerTitle:IM(e.get("isRecommendedFeed")?"feed.hide_from_open_feed.confirm.title":"feed.hide_from_my_feed.confirm.title",{bandName:t.get("name")}),bodyDesc:IM("feed.hide.confirm.desc")}).once(c.EVENTS.CONFIRM,i.bind((function(){s.getFeedChannel().trigger(s.EVENT.HIDE_BAND_FROM_FEED,t.get("bandNo"))}),this))},_hidePostFromFeed:function(){s.getFeedChannel().trigger(s.EVENT.HIDE_POST_FROM_FEED,{bandNo:this._getBandNo(),postNo:this._getPostNo()})},_bookmarkAddPost:function(){l.setBookmarked(this._getBandNo(),this._getPostNo()).then(i.bind((function(){var e=f.GLOBAL_MY_BOOKMARK.makeUrl(),t="<div class='notificationCard _notificationCard'>"+IM("web.post.add_bookmark_success")+"<a href='"+e+"' class='more _myPageLink'>"+IM("web.post.mypage_bookmark_link")+"</a><button type='button' class='close _closeNotificationCard'><span class='gSrOnly'>"+IM("ui.label.close")+"</span></button></div>";b.increaseBookmarkCount(),s.getPostChannel().trigger(s.EVENT.POST_UPDATED,this._getPostNo()),this._notificationTemplate(t)}),this))},_bookmarkDeletePost:function(){l.deleteBookmarked(this._getBandNo(),this._getPostNo()).then(i.bind((function(){var e="<div class='notificationCard _notificationCard'>"+IM("web.post.delete_bookmark_success")+"<button type='button' class='close _closeNotificationCard'><span class='gSrOnly'>"+IM("ui.label.close")+"</span></button></div>";this._notificationTemplate(e),b.decreaseBookmarkCount(),s.getPostChannel().trigger(s.EVENT.POST_UPDATED,this._getPostNo()),s.getPostChannel().trigger(s.EVENT.POST_BOOKMARK_DELETED,{bandNo:this._getBandNo(),postNo:this._getPostNo()})}),this))},_notificationTemplate:function(e){var n=t(e),o=this.$el.find(this.getUI("notificationCard").selector),s=this.view.getChildView("moreOptionListRegion").getUI("postFunctionWrap");o.remove(),s.attr("aria-live","assertive"),setTimeout(i.bind((function(){n.fadeOut({complete:function(){n.remove(),s.removeAttr("aria-live")}})}),this),3e3),n.appendTo(s).fadeIn()},_subscribePageBand:function(){E.build({onBandJoinCompleted:i.bind((function(e){parseInt(T.getCurrentRouteInfo().pathVariables.band_no,10)!==this._getBandNo()?(e&&alert(e),g.getCachedBandData(this._getBandNo()).then(i.bind((function(){this.view.trigger("DPostMoreActionBehavior:pageSubscriptionCompleted")}),this))):(alert(IM("page_band.msg.subscription_complete_and_move_page_main",{originalMessage:e||""})),C.PAGE_BAND_HOME.goDForced({band_no:this._getBandNo()}))}),this)}).startJoinFromBand(this._getBandNo())},_seePostStats:function(){_.openWithoutHiding(y.buildDBandPagePostStatsView(this._getBandNo(),this._getPostNo()))},_cancelMissionConfirmPost:function(){confirm(IM("confirm_post.cancel.alert.msg"))&&w.cancelMissionConfirmPost(this._getBandNo(),this._getPostNo()).then(i.bind((function(){s.getPostChannel().trigger(s.EVENT.CANCEL_MISSION_CONFIRM,{bandNo:this._getBandNo(),postNo:this._getPostNo(),missionId:this.view.model.getMissionInfoForPost().getMissionId()})}),this))},_downloadComments:function(){O.downloadCommentList(this._getBandCore(),this._getPostNo(),this.view.model.get("createdAt"))}});return x.POST_MORE_ACTIONS=P,x}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i=n(0);function o(e){this._modal=e.modal,this._confirm=e.confirm,this._cancel=e.cancel,this._confirms=[],this._cancels=[],this._confirm&&this._modal.once(this._confirm,i.bind(this._exec,this,this._confirms)),this._cancel&&this._modal.once(this._cancel,i.bind(this._exec,this,this._cancels))}o.prototype._exec=i.restArguments((function(e,t){i.each(e,(function(e){e.apply(e,t)}))})),o.prototype._filter=function(e){return i.isArray(e)||(e=[e]),i.filter(e,i.isFunction)},o.prototype.confirm=function(e){return Array.prototype.push.apply(this._confirms,this._filter(e)),this},o.prototype.cancel=function(e){return Array.prototype.push.apply(this._cancels,this._filter(e)),this},o.create=function(e){return new o(e)},e.exports=o},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(666),s=n(635),a={internal:"internal_calendars",external:"external_calendars"},r=t.Collection.extend({model:o,initialize:function(e,t){this._defaultCalendarOnly=t.defaultCalendarOnly},fetchCalendar:function(e,t){return"string"==typeof t&&(t=[t]),s.getCalendars(e,t.join()).then(i.bind((function(e){var n=i.map(t,(function(t){return e[a[t]]}));n=i.flatten(n),this._defaultCalendarOnly&&(n=i.find(n,(function(e){return 1==e.is_default}))),this.add(n,{parse:!0})}),this))}});return r.build=function(e){return new r([],{defaultCalendarOnly:e})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(2),n(6),n(4)),o=n(684),s=n(1334),a=n(1338),r=n(491),l=i.View.extend({className:"cStickerCollection",attributes:{"data-viewname":"DStickerSelectionLayoutView"},tagName:"section",template:t.template('<h1 class="gSrOnly"><%= IM("web.postwrite.attach.title.sticker") %></h1><div class="stickerHeaderWrap" data-uiselector="usingPackArea" ></div>'),ui:{usingPackArea:"[data-uiselector=usingPackArea]"},regions:{usingPackArea:"@ui.usingPackArea"},events:{},initialize:function(e){this.usingPackCollection=e.usingPackCollection,this._bandNo=e.bandNo,this._spritesRegions={},this._additionalPackNos=[],this.listenTo(this.usingPackCollection,"update",this._resetUsingPackListViewPackNos),this.usingPackCollection.fetchCachedStickerPackCollection()},_resetAdditionalPackNos:function(){this._bandNo&&r.getCachedBandData(this._bandNo).then(t.bind((function(e){var t=e.getStickerPackNos();t&&(this._additionalPackNos=t,this._resetUsingPackListViewPackNos())}),this))},onRender:function(){this._resetAdditionalPackNos()},onAttach:function(){var e=s.buildDStickerUsingPackListView(this._getAllStickerPackNos());this.listenTo(e,"usingPack:change",t.bind((function(e){this._showSpritesArea(e)}),this)),this.getRegion("usingPackArea").show(e)},setBandNo:function(e){this._bandNo=e,this._resetAdditionalPackNos()},_resetUsingPackListViewPackNos:function(){var e=this.getRegion("usingPackArea");e.hasView()&&t.isFunction(e.currentView.resetPacks)&&e.currentView.resetPacks(this._getAllStickerPackNos())},_getAllStickerPackNos:function(){return this._additionalPackNos.concat(this.usingPackCollection.pluck("no"))},_showSpritesArea:function(e){if(this._spritesRegions[e])return this._hideExSprites(),this._spritesRegions[e].$el.show(),void(this._currentPackNo=e);var t=a.buildDStickerSpritesView(),n="spriteRegion"+e;this.$el.append('<div data-uiselector="'+n+'"></div>'),this.addRegion("spriteRegion"+e,"[data-uiselector="+n+"]"),this._hideExSprites(),this._spritesRegions[e]=this.getRegion("spriteRegion"+e),this._spritesRegions[e].show(t),t.renderSpriteView(e),this._currentPackNo=e},_hideExSprites:function(){this._currentPackNo&&this._spritesRegions[this._currentPackNo].$el.hide()}});return l.buildDStickerSelectionLayoutView=function(e){e=e||{};var t=o.singletonBuildStickerUsingPackDataCollection();return new l({usingPackCollection:t,bandNo:e.bandNo})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1347),s=n(159),a=(n(1060),n(1005)),r=n(1392),l=n(592),c=n(559),d=n(55),u=n(626),h=n(169),p=n(1037),m=$("html, body"),_=i.CollectionView.extend({className:"sCommentList "+h.HEIGHT_DETECT_AREA_FOR_COMMENT,attributes:{"data-viewname":"DCommentListCollectionView"},childView:o,childViewOptions:function(){return{overMaxLengthAlertMessage:this._overMaxLengthAlertMessage,maxMessageLength:this._maxMessageLength,flexibleTooltipPositionSupport:this._flexibleTooltipPositionSupport,isCommentingPermitted:this._isCommentingPermitted,messageSubmitKeyType:c.CONTROL_ENTER,replySupport:this._replySupport,isReplyButTopMost:this._isReplyButTopMost,canUsePaging:this._canUsePaging,canExpressEmotion:this._canExpressEmotion,canOpenMediaViewer:this._canOpenMediaViewer,canDownloadFile:this._canDownloadFile,canOpenSnippetUrl:this._canOpenSnippetUrl,mentionOption:this._mentionOption}},behaviors:[s],initialize:function(e){this._currentElHeightDectector=new l,this._documentHeightDetector=new l,this.collection=r.buildDCommentViewCollection(),this._maxMessageLength=e.maxMessageLength,this._overMaxLengthAlertMessage=e.overMaxLengthAlertMessage,this._flexibleTooltipPositionSupport=e.flexibleTooltipPositionSupport,this._disablePreviousNextBtn=1==e.disablePreviousNextBtn,this._replySupport=1==e.replySupport,this._oldestCommentShow=!1,this._isCommentingPermitted=e.isCommentingPermitted,this._isReplyButTopMost=1==e.isReplyButTopMost,this._canUsePaging=1==e.canUsePaging,this._canExpressEmotion=1==e.canExpressEmotion,this._canOpenMediaViewer=1==e.canOpenMediaViewer,this._canDownloadFile=1==e.canDownloadFile,this._canOpenSnippetUrl=1==e.canOpenSnippetUrl,this._mentionOption=e.mentionOption,this._generateOnMessages()},isEmptyCollection:function(){return this.collection.isEmpty()},getTotalCount:function(){return this.collection.getTotalCount()},populateFetchedCollection:function(e,t,n,i,o){n?this.collection.reset(e):this.collection.putComments(e),this.collection.setTotalCount(t),this._processPreviousNextCommentButton(i,o)},populateSimpleCollection:function(e,t){this.collection.setTotalCount(t),this.collection.reset(e)},deleteCommentOnView:function(e,t,n){this.collection.remove(e),this.collection.decreaseTotalCount(),this._processPreviousNextCommentButton(t,n),this.isModificationMode()||this.spawn(s.MSG.COMMENTLIST_SHOW_INPUT)},getCollection:function(){return this.collection},setOldestCommentShow:function(e){this._oldestCommentShow=e},isOldestCommentShow:function(){return 1==this._oldestCommentShow},scrollToCommentWithDelay:function(e){t.delay(t.bind((function(){this.scrollToComment(e)}),this),300)},scrollToComment:function(e){this.isDestroyed()||(this._scrollToCommentDirectly(e),this.stopListening(this._currentElHeightDectector),this.stopListening(this._documentHeightDetector),this.listenTo(this._currentElHeightDectector,l.EVENT.HEIGHT_CHANGED,t.bind(this._scrollToCommentDirectly,this,e)),this.listenTo(this._documentHeightDetector,l.EVENT.HEIGHT_CHANGED,t.bind(this._scrollToCommentDirectly,this,e)),this._currentElHeightDectector.startDetecting(this.$el,200,6),this._documentHeightDetector.startDetecting(document,200,4))},isModificationMode:function(){return!this.isDestroyed()&&(null!=this._findModificationComment()||null!=this._findModificationCommentReplyView())},renderReplyListAndFocus:function(e,t){if(null!=e&&null!=t){var n=this.collection.get(e);if(null!=n)this.children.findByModel(n).renderReplyList(t);else this.scrollToComment(e)}},hideEveryReplyInputArea:function(){this.isDestroyed()||this.children.each((function(e){e.hideReplyInputArea()}))},cancelDescendantModificationMode:function(){this.children.each((function(e){e.cancelChildrenModificationMode()}));var e=this._findModificationComment();e&&e.setModificationMode(!1)},openReplyInputByCommentId:function(e){this.children.each((function(t){t.openReplyInputIfSameCommentId(e)}))},_generateOnMessages:function(){var e={};e[s.MSG.COMMENT_CHANGE_TO_MODIFICATION_MODE]=function(){this._cancelEveryInputMode()},e[s.MSG.COMMENT_REPLY_INPUT_OPEN]=function(){this._cancelEveryInputMode()},e[s.MSG.COMMENT_SUBMIT_MODIFICATION]=function(e){e.totalCount=this.collection.getTotalCount()},this._isReplyButTopMost||(e[s.MSG.COMMENT_CHECK_REPLY_INPUT_OPENABLE]=function(e){this.isModificationMode()||p.hasWritingInputDescendantOf(this.$el)?confirm(IM("comment.cancel_writing_comment"))&&e.processReplyInputOpen():e.processReplyInputOpen()},e[s.MSG.COMMENT_CHECK_COMMENT_MODIFIABLE]=function(e){this.isModificationMode()||p.hasWritingInputDescendantOf(this.$el)?confirm(IM("comment.cancel_writing_comment"))&&e.processCommentModify():e.processCommentModify()}),this.onMessages=e},_cancelEveryInputMode:function(){this.cancelDescendantModificationMode(),this.hideEveryReplyInputArea()},_scrollToCommentDirectly:function(e){if(!this.isDestroyed()&&0!=this.children.length){var t=this.collection.get(e);if(t){var n=this.children.findByModel(t),i=n.$el,o=i.height();if(0!=o){var s=i.scrollParent();n.highlightForAWhile(),u.isElementDocument(s)?m.stop(!0).animate({scrollTop:i.offset().top-(d.getHeight()-o)/2},100):s.scrollTop(i.offset().top+s.scrollTop()-s.offset().top-(s.height()-o)/2)}}}},_findModificationComment:function(){return this.collection.find((function(e){return e.isModificationMode()}))},_findModificationCommentReplyView:function(){return this.children.find((function(e){return e.hasModificationCommentReply()}))},_processPreviousNextCommentButton:function(e,t){this.collection.removeMoreButtons(),this.collection.isAllCommentFetched()||1==this._disablePreviousNextBtn||(e&&this.collection.putComments(a.buildMoreButtonDCommentModel(!0,this._isReplyButTopMost)),t&&this.collection.putComments(a.buildMoreButtonDCommentModel(!1,this._isReplyButTopMost)))}});return _.buildDCommentCollectionView=function(e){return new _(e)},_}.call(t,n,t,e))||(e.exports=i)},function(e,t){!function(e,t){if(!e.fn.dotdotdot){e.fn.dotdotdot=function(t){if(0==this.length)return e.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each((function(){e(this).dotdotdot(t)}));var i=this;i.data("dotdotdot")&&i.trigger("destroy.dot"),i.data("dotdotdot-style",i.attr("style")||""),i.css("word-wrap","break-word"),"nowrap"===i.css("white-space")&&i.css("white-space","normal"),i.bind_events=function(){return i.bind("update.dot",(function(t,n){switch(i.removeClass("is-truncated"),t.preventDefault(),t.stopPropagation(),typeof r.height){case"number":r.maxHeight=r.height;break;case"function":r.maxHeight=r.height.call(i[0]);break;default:r.maxHeight=function(e){for(var t=e.innerHeight(),n=["paddingTop","paddingBottom"],i=0,o=n.length;i<o;i++){var s=parseInt(e.css(n[i]),10);isNaN(s)&&(s=0),t-=s}return t}(i)}r.maxHeight+=r.tolerance,void 0!==n&&(("string"==typeof n||"nodeType"in n&&1===n.nodeType)&&(n=e("<div />").append(n).contents()),n instanceof e&&(o=n)),(h=i.wrapInner('<div class="dotdotdot" />').children()).contents().detach().end().append(o.clone(!0)).find("br").replaceWith(r.noSpaceWrapBr?"<br />":"  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var l=!1,d=!1;return c.afterElement&&((l=c.afterElement.clone(!0)).show(),c.afterElement.detach()),a(h,r)&&(d="children"==r.wrap?function(e,t,n){var i=e.children(),o=!1;e.empty();for(var s=0,r=i.length;s<r;s++){var l=i.eq(s);if(e.append(l),n&&e.append(n),a(e,t)){l.remove(),o=!0;break}n&&n.detach()}return o}(h,r,l):function t(n,i,o,r,l){var c=!1;return n.contents().detach().each((function(){var d=this,u=e(d);if(void 0===d)return!0;if(u.is("script, .dotdotdot-keep"))n.append(u);else{if(c)return!0;n.append(u),!l||u.is(r.after)||u.find(r.after).length||n[n.is("a, table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style")?"after":"append"](l),a(o,r)&&((c=3==d.nodeType||r.noSpaceWrapBr&&"br"==d.nodeName.toLowerCase()?s(u,i,o,r,l):t(u,i,o,r,l))||(u.detach(),c=!0)),c||l&&l.detach()}})),i.addClass("is-truncated"),c}(h,i,h,r,l)),h.replaceWith(h.contents()),h=null,e.isFunction(r.callback)&&r.callback.call(i[0],d,o),c.isTruncated=d,d})).bind("isTruncated.dot",(function(e,t){return e.preventDefault(),e.stopPropagation(),"function"==typeof t&&t.call(i[0],c.isTruncated),c.isTruncated})).bind("originalContent.dot",(function(e,t){return e.preventDefault(),e.stopPropagation(),"function"==typeof t&&t.call(i[0],o),o})).bind("destroy.dot",(function(e){e.preventDefault(),e.stopPropagation(),i.unwatch().unbind_events().contents().detach().end().append(o).attr("style",i.data("dotdotdot-style")||"").data("dotdotdot",!1)})),i},i.unbind_events=function(){return i.unbind(".dot"),i},i.watch=function(){if(i.unwatch(),"window"==r.watch){var t=e(window),n=t.width(),o=t.height();t.bind("resize.dot"+c.dotId,(function(){n==t.width()&&o==t.height()&&r.windowResizeFix||(n=t.width(),o=t.height(),u&&clearInterval(u),u=setTimeout((function(){i.trigger("update.dot")}),100))}))}else d=l(i),u=setInterval((function(){if(i.is(":visible")){var e=l(i);d.width==e.width&&d.height==e.height||(i.trigger("update.dot"),d=e)}}),500);return i},i.unwatch=function(){return e(window).unbind("resize.dot"+c.dotId),u&&clearInterval(u),i};var o=i.contents(),r=e.extend(!0,{},e.fn.dotdotdot.defaults,t),c={},d={},u=null,h=null;return r.lastCharacter.remove instanceof Array||(r.lastCharacter.remove=e.fn.dotdotdot.defaultArrays.lastCharacter.remove),r.lastCharacter.noEllipsis instanceof Array||(r.lastCharacter.noEllipsis=e.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),c.afterElement=function(t,n){if(!t)return!1;if("string"==typeof t)return!!(t=e(t,n)).length&&t;return!!t.jquery&&t}(r.after,i),c.isTruncated=!1,c.dotId=n++,i.data("dotdotdot",!0).bind_events().trigger("update.dot"),r.watch&&i.watch(),i},e.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,noSpaceWrapBr:!1},e.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},e.fn.dotdotdot.debug=function(e){};var n=1,i=e.fn.html;e.fn.html=function(t){return null!=t&&!e.isFunction(t)&&this.data("dotdotdot")?this.trigger("update",[t]):i.apply(this,arguments)};var o=e.fn.text;e.fn.text=function(t){return null!=t&&!e.isFunction(t)&&this.data("dotdotdot")?(t=e("<div />").text(t).html(),this.trigger("update",[t])):o.apply(this,arguments)}}function s(t,n,i,o,s){var l=t[0];if(!l)return!1;var u=d(l),p=-1!==u.indexOf(" ")?" ":"　",m="letter"==o.wrap?"":p,_=u.split(m),g=-1,f=-1,b=0,v=_.length-1;for(o.fallbackToLetter&&0==b&&0==v&&(m="",v=(_=u.split(m)).length-1);b<=v&&(0!=b||0!=v);){var A=Math.floor((b+v)/2);if(A==f)break;f=A,c(l,_.slice(0,f+1).join(m)+o.ellipsis),i.children().each((function(){e(this).toggle().toggle()})),a(i,o)?(v=f,o.fallbackToLetter&&0==b&&0==v&&(m="",g=-1,f=-1,b=0,v=(_=_[0].split(m)).length-1)):(g=f,b=f)}if(-1==g||1==_.length&&0==_[0].length)if(o.noSpaceWrapBr&&"br"==l.nodeName.toLowerCase()){t.parent()[0].replaceChild(document.createTextNode(o.ellipsis),l)}else{var E=t.parent();t.detach();var T=s&&s.closest(E).length?s.length:0;E.contents().length>T?l=h(E.contents().eq(-1-T),n):(l=h(E,n,!0),T||E.detach()),l&&(c(l,u=r(d(l),o)),T&&s&&e(l).parent().append(s))}else c(l,u=r(_.slice(0,g+1).join(m),o));return!0}function a(e,t){return e.innerHeight()>t.maxHeight}function r(t,n){for(;e.inArray(t.slice(-1),n.lastCharacter.remove)>-1;)t=t.slice(0,-1);return e.inArray(t.slice(-1),n.lastCharacter.noEllipsis)<0&&(t+=n.ellipsis),t}function l(e){return{width:e.innerWidth(),height:e.innerHeight()}}function c(e,t){e.innerText?e.innerText=t:e.nodeValue?e.nodeValue=t:e.textContent&&(e.textContent=t)}function d(e){return e.innerText?e.innerText:e.nodeValue?e.nodeValue:e.textContent?e.textContent:""}function u(e){do{e=e.previousSibling}while(e&&1!==e.nodeType&&3!==e.nodeType);return e}function h(t,n,i){var o,s=t&&t[0];if(s){if(!i){if(3===s.nodeType)return s;if(e.trim(t.text()))return h(t.contents().last(),n)}for(o=u(s);!o;){if((t=t.parent()).is(n)||!t.length)return!1;o=u(t[0])}if(o)return h(e(o),n)}return!1}}(jQuery)},function(e,t,n){var i=n(0),o=n(4),s=n(1401),a=n(486),r=n(9),l=n(158),c=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DUnsupportedBrowserView"},template:i.template(s),templateContext:function(){return{isSuggestWhale:r.spec.isSuggestWhaleAtNotSupportBrowser(),nl2br:l.nl2br}},ui:{closeBtn:"._closeBtn"},events:{"click @ui.closeBtn":function(){this.trigger(c.UNSUPPORTED_BROWSER_CLOSED),this.destroy()}}});c.openDUnsupportedBrowserLayer=function(){var e=new c;return a.openWithoutHiding(e),e},c.UNSUPPORTED_BROWSER_CLOSED="UNSUPPORTED_BROWSER_CLOSED",e.exports=c},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(52),s=n(4),a=n(2428),r=n(2026),l=n(546),c=n(486),d=n(22),u=n(1039),h=n(83),p={SINGLE_SELECT:"SINGLE_SELECT",MULTIPLE_SELECT:"MULTIPLE_SELECT"},m=[u.BAND_FIELD.BAND.BAND_NO,u.BAND_FIELD.BAND.TYPE,u.BAND_FIELD.BAND.COVER,u.BAND_FIELD.BAND.NAME,u.BAND_FIELD.BAND.PROPERTIES.POST_WITHOUT_APPROVAL,u.BAND_FIELD.MEMBER.PERMITTED_OPERATION.POSTING,u.BAND_FIELD.MEMBER.PERMITTED_OPERATION.APPROVE_POST],_=[u.BAND_FIELD.BAND.BAND_NO,u.BAND_FIELD.BAND.TYPE,u.BAND_FIELD.BAND.PROFILE_IMAGE,u.BAND_FIELD.BAND.NAME];function g(e){return e.pick("bandNo","name","cover","type","currentUserPostingPermitted")}var f=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DBandSelectView"},template:t.template(a),templateContext:function(){return{title:this._title||IM("web.inviteband.btn.choice_band"),isSingleSelect:this._selectionType==p.SINGLE_SELECT,showSubTitle:this._pageBandListCollection.length>0&&this._groupBandListCollection.length>0,pageBandCount:this._pageBandListCollection.length,groupBandCount:this._groupBandListCollection.length,isNoSelectableBand:this._pageBandListCollection.isEmpty()&&this._groupBandListCollection.isEmpty(),bandGuideMessage:this._bandGuideMessage,confirmText:this._confirmText||IM("web.modal.btn.confirm")}},ui:{pageBandListWrap:"._pageBandListWrap",pageBandListRegion:"._pageBandListRegion",groupBandListWrap:"._groupBandListWrap",groupBandListRegion:"._groupBandListRegion",emptyViewRegion:"._emptyViewRegion",btnClose:"._btnClose",btnConfirm:"._btnConfirm",createBand:"._createBand",countSelectedBand:"._countSelectedBand"},regions:{pageBandListRegion:{el:"@ui.pageBandListRegion",replaceElement:!0},groupBandListRegion:{el:"@ui.groupBandListRegion",replaceElement:!0},emptyViewRegion:{el:"@ui.emptyViewRegion",replaceElement:!0}},events:{"click @ui.btnClose":function(){this.trigger("close"),this._isSelfCloseDisabled||this.destroy()},"click @ui.btnConfirm":function(e){if(this._selectionType==p.MULTIPLE_SELECT){var t=this._selectedBandCollection.map((function(e){return g(e)}));this.trigger("multipleBand:selected",t),this._isSelfCloseDisabled||this.destroy()}}},childViewEvents:{"singleBand:selected":function(e){this.trigger("singleBand:selected",g(e))},"multipleBand:selected":function(e){this._selectedBandCollection.add(e),this._changeConfirmButtonState(),this.getUI("countSelectedBand").text("("+this._selectedBandCollection.length+")")},"multipleBand:deselected":function(e){this._selectedBandCollection.remove(e),this._changeConfirmButtonState(),0===t.size(this._selectedBandCollection)?this.getUI("countSelectedBand").text(""):this.getUI("countSelectedBand").text("("+this._selectedBandCollection.length+")")}},initialize:function(e){this._title=e.title,this._selectionType=e.selectionType,this._bandTypes=e.bandTypes,this._pageBandListCollection=e.pageBandListCollection||new Backbone.Collection([]),this._groupBandListCollection=e.groupBandListCollection||new Backbone.Collection([]),this._selectedBandCollection=new Backbone.Collection([]),this._bandGuideMessage=e.bandGuideMessage,this._confirmText=e.confirmText,this._isSelfCloseDisabled=e.isSelfCloseDisabled,this._emptyView=e.emptyView||new s.View({tagName:"p",className:"uEmpty -h480",template:t.template('<span><%= IM("discover.search.txt.no_band") %></span>')}),e.excludedBandNos=t.map(e.excludedBandNos||[],(function(e){return Number(e)})),e.groupBandFilters=e.groupBandFilters||[],e.pageBandFilters=e.pageBandFilters||[],i.when(this._fetchGroupBandListCollection(e.excludedBandNos,e.groupBandFilters),this._fetchPageBandListCollection(e.excludedBandNos,e.pageBandFilters)).then(t.bind((function(){this._pageBandListCollection.each((function(t){e.selectedBandNos.indexOf(t.get("bandNo"))>=0&&(this._selectedBandCollection.add(t),t.set("selected",!0))}),this),this._groupBandListCollection.each((function(t){e.selectedBandNos.indexOf(t.get("bandNo"))>=0&&(this._selectedBandCollection.add(t),t.set("selected",!0))}),this),this.render(),this._pageBandListCollection.isEmpty()&&this._groupBandListCollection.isEmpty()&&this._showEmptyView()}),this))},onRender:function(){this._showPageBandList(),this._showGroupBandList()},_showEmptyView:function(){this.getRegion("emptyViewRegion").show(this._emptyView)},_showPageBandList:function(){var e=this.getRegion("pageBandListRegion");e.hasView()||this._pageBandListCollection.isEmpty()||(this.getUI("pageBandListWrap").show(),e.show(r.build({selectionType:this._selectionType,collection:this._pageBandListCollection})))},_fetchPageBandListCollection:function(e,n){return t.contains(this._bandTypes,d.BAND_TYPE.PAGE)?this.options.pageBandListCollection?i.Deferred().resolve():h.getBandListWithFilter(n,_).then(t.bind((function(n){n=t.chain(o.camelizeKeys(n||[])).filter((function(n){return!t.contains(e,n.band.bandNo)})).pluck("band").value(),this._pageBandListCollection=new Backbone.Collection(n)}),this)):i.Deferred().resolve()},_showGroupBandList:function(){var e=this.getRegion("groupBandListRegion");e.hasView()||this._groupBandListCollection.isEmpty()||(this._groupBandListCollection.each((function(e){e.set("type",d.BAND_TYPE.GROUP)})),this.getUI("groupBandListWrap").show(),e.show(r.build({selectionType:this._selectionType,collection:this._groupBandListCollection,limitSelect:10})))},_fetchGroupBandListCollection:function(e,n){return t.contains(this._bandTypes,d.BAND_TYPE.GROUP)?this.options.groupBandListCollection?i.Deferred().resolve():l.build(n,m,e).fetchBandWithFilterDataCollection().then(t.bind((function(e){this._groupBandListCollection=e}),this)):i.Deferred().resolve()},_changeConfirmButtonState:function(){this._selectedBandCollection.isEmpty()?this.getUI("btnConfirm").prop("disabled",!0):this.getUI("btnConfirm").prop("disabled",!1)}});return f.SELECTION_TYPE=p,f.REQUIRED_GROUP_BAND_FIELDS=m,f.REQUIRED_PAGE_BAND_FIELDS=_,f.openLayer=function(e){var t=new f({title:e.title,selectionType:e.selectionType,excludedBandNos:e.excludedBandNos,bandTypes:e.bandTypes,groupBandListCollection:e.groupBandListCollection,groupBandFilters:e.groupBandFilters,pageBandListCollection:e.pageBandListCollection,pageBandFilters:e.pageBandFilters,selectedBandNos:e.selectedBandNos||[],bandGuideMessage:e.bandGuideMessage,confirmText:e.confirmText,emptyView:e.emptyView,isSelfCloseDisabled:e.isSelfCloseDisabled});return e.withoutHiding?c.openWithoutHiding(t):c.open(t),t},f}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(10),s=n(1036),a=n(606);n(591);var r=/[\]\[*?\/\\]/g;function l(e,t){if(i.isEmpty(e))return 0;var n=i.reduce(e,(function(e,t){return i.isEmpty(t)||e>=t.length?e:t.length}),0);return Math.min(n+10,t)}function c(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=e.length,o=0;o<i;++o)n[o]=255&e.charCodeAt(o);return t}var d={downloadAsExcelFile:function(e){var t=this.createExcelBlob(e.sheets);this.downloadExcelBlob(t,e.filename)},downloadExcelBlob:function(e,t){-1===(t=o.trim(t)||i.now().toString()).indexOf(".xlsx")&&(t+=".xlsx"),a.saveAs(e,t)},createExcelBlob:function(e){var t=s.utils.book_new(),n={};i.each(e,i.bind((function(e){var a,l=s.utils.json_to_sheet(e.data,e.opts),c=e.cols,d=(a=e.name,o.trim(a).replace(r,"")).substr(0,28)||void 0;d&&(n[d]?d=d+" "+n[d]++:n[d]=1),l["!cols"]=c?i.map(c,(function(e){return{wch:e}})):this.makeMaxColumnWidthData(e.data,e.opts.header),e.rows&&(l["!rows"]=e.rows),s.utils.book_append_sheet(t,l,d)}),this));var a=s.write(t,{bookType:"xlsx",bookSST:!0,type:"binary"});return new Blob([c(a)],{type:"application/octet-stream"})},addBlankRow:function(e,t){var n={};i.each(t,(function(e){n[e]=""})),e.push(n)},makeMaxColumnWidthData:function(e,t,n){return null==n&&(n=Number.MAX_VALUE),i.map(t,(function(t){return{wch:l(i.pluck(e,t),n)}}))},makeFileName:function(e){var t=i.map(e,(function(e){var t=e.name;return e.maxLength&&(t=e.name.substring(0,e.maxLength)),t.replace(r,"")})).join("_");if(t.length>70)throw new Error("파일 이름이 너무 깁니다. 70자 이내로 수정해주세요.");return t}};e.exports=d},,,,,,,,,,function(e,t){e.exports='<div class="lyContent" style="<%= width ? \'width:\' + width + \'px;\' : \'\' %>">\n    <% if (!!headerTitle) { %>\n    <div class="modalHeader">\n        <h5 class="title"><%= headerTitle %></h5>\n    </div>\n    <% } %>\n\n    <div class="modalBody">\n        <% if (!!bodyTitle) { %>\n        <div class="headingMsg <%- alignCenter ? \'gTaC\' : \'\' %>"><%= bodyTitle %></div>\n        <% } %>\n        <div class="msgWrap">\n            <% if (!_.isArray(bodyDesc)) { // 단건 설명 %>\n            <p class="pText <%- breakWordKeepAll %> <%- alignCenter ? \'gTaC\' : \'\' %>"><%= bodyDesc %></p>\n            <% } else { // 목록형 설명 %>\n            <ul class="msgList">\n                <% _.each(bodyDesc, function(eachDesc) { %>\n                <li class="msgListItem"><%= eachDesc %></li>\n                <% }); %>\n            </ul>\n            <% } %>\n        </div>\n    </div>\n\n    <div class="modalFooter">\n        <button type="button" class="uButton -cancel _btnCancel"><%= cancel %></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%= confirm %></button>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i={resizeTo:function(e,n){try{window.resizeTo(e,n)}catch(i){setTimeout(t.bind((function(){this.resizeTo(e,n)}),this),500)}},closeWindow:function(){window.close();try{window.close()}catch(e){}},_bindedEvent:{}};return i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(9),s=n(2151),a=n(797),r=n(82),l=n(618),c=n(562),d=n(656),u=i.View.extend({options:{showReaderCount:!1},tagName:"div",className:"postWriter uFlexItem",attributes:{"data-viewname":"DPostAuthorView"},template:t.template(s),ui:{postAuthorRegion:"._postAuthorRegion",authorImg:"._authorImg",authorProfile:"._authorProfile",btnPunishedInfo:"._btnPunishedInfo"},events:{"click @ui.btnPunishedInfo":function(e){return c.openLayer({bodyTitle:IM("post.clean_filter.punished_layer.title"),bodyDesc:IM("post.clean_filter.punished_layer.description",{date:o.format.date(this.model.get("punishedAt"),"short_date_time")})}),!1}},regions:{postAuthorRegion:"@ui.postAuthorRegion",authorProfile:{el:"@ui.authorProfile",replaceElement:!0}},triggers:{click:{event:"author:showPostDetailLayer",stopPropagation:!1}},initialize:function(e){this.postModel=e.model,this.authorModel=this.postModel.get("author"),this.bPostDetail=e.bPostDetail||!1},serializeData:function(){var e,t,n=a.getAuthorInfo(this.postModel.get("viewType"),this.authorModel);return e=this.bPostDetail?o.format.date(this.postModel.get("createdAt"),"short_date_time"):o.format.relative(this.postModel.get("createdAt"),"short_date_time"),d.hasRestriction(this.postModel)||(this.postModel.get("isMajorNotice")?t=IM("post.list.majorNotice"):this.postModel.get("isNotice")&&(t=IM("post.list.notice"))),{bPostDetail:this.bPostDetail,authorFaceThumb:r.makeProfileThumbnailUrl(n.profileImageUrl),authorName:n.name,authorDesc:n.desc,createdDate:e,postReadCount:this.postModel.get("readCount"),isViewPostReaderCount:this.options.showReaderCount,realName:n.realName,noticeMarkMessage:t,authorRealName:this.authorModel.get("realName"),isCertifiedPage:this.postModel.get("band").isCertifiedPageBand(),webUrl:this.postModel.get("webUrl")||"#",punishedAt:this.postModel.get("punishedAt")}},onRender:function(){var e=a.getAuthorInfo(this.postModel.get("viewType"),this.authorModel);this.showChildView("authorProfile",l.buildContentCreatorProfileImageView({memberProfile:e.memberProfile,userNoOrMemberKey:this.authorModel.get("userNo"),bandCore:this.postModel.get("band"),role:e.role.name}))},setTop:function(e){this.$el.css("top",e)}});return u.build=function(e,t){return new u({model:e,bPostDetail:t.bPostDetail,showReaderCount:t.showReaderCount})},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1290),s=n(164),a=n(82),r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DProfilePhotoView"},template:t.template(o),ui:{btnClose:"._btnClose"},events:{"click @ui.btnClose":"destroy",click:function(e){0==$(e.target).parents("._lyContent:first").length&&this.destroy(),this._stopClickPropagation&&e.stopPropagation()}},initialize:function(e){this._stopClickPropagation=e.stopClickPropagation},serializeData:function(){return{thumbnailUrl:a.makeGifSupportedProfileUrl(this.options.imageUrl,s.s480_gif),name:this.options.name}}});return r.buildDProfilePhotoView=function(e,t,n){return new r({imageUrl:e,name:t,stopClickPropagation:n})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(1296),a=n(518),r=n(486),l=n(82),c=n(158),d=n(495),u=n(487),h={PROFILE_SET_SELECTED:"PROFILE_SET_SELECTED",NEW_PROFILE:"NEW_PROFILE"},p=o.View.extend({behaviors:[{behaviorClass:d,sceneId:d.SCENE.PROFILE_SETTING_CHANGE},u],tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DProfileSetSelectView"},template:i.template(s),templateContext:function(){return{nl2br:c.nl2br,joinButtonLabel:{join:this._showAdAgreement?IM("bandjoin.agree_ad_and_join"):IM("band.join.form.submit_btn.label"),subscribe:this._showAdAgreement?IM("bandjoin.agree_ad_and_subscribe"):IM("page_band.label.subscribe_long"),participate:IM("recruiting.joinable.band")}[this._bandCore.getJoinTermType()],showAdAgreement:this._showAdAgreement}},serializeData:function(){return{cid:this.cid,items:this.collection.map((function(e){var t=e.toJSON();return t.profileImageUrl=l.make(t.profileImageUrl,l.TYPE.s75),t.profileInnerClass=l.makeProfileInnerClass(t.profileImageUrl),t})),joining:this._joining,showSubscribeForEditProfile:this._fromEditProfile,band:this._bandCore}},ui:{radio:"._radio",newProfileBtn:"._newProfileBtn",confirmBtn:"._confirmBtn",closeBtn:"._closeBtn",setDefaultProfileSetOfPageCheck:"._setDefaultProfileSetOfPageCheck"},events:{"change @ui.radio":"_toggleConfirmBtn","click @ui.newProfileBtn":function(){this._triggerEvent(h.NEW_PROFILE,null,this.ui.setDefaultProfileSetOfPageCheck.is(":checked")),this.destroy()},"click @ui.confirmBtn":function(){var e=this.collection.get(parseInt(this.ui.radio.filter(":checked").val()));e&&(this.jplClick(u.CLASSIFIER.PROFILE_JOIN_PAGE,{band_no:this._bandCore.bandNo}),this._triggerEvent(h.PROFILE_SET_SELECTED,e,this.ui.setDefaultProfileSetOfPageCheck.is(":checked")),this.destroy())},"click @ui.closeBtn":"destroy"},initialize:function(e){this._bandCore=e.bandCore,this._joining=e.joining,this._fromEditProfile=!!e.fromEditProfile,this._showAdAgreement=!!e.showAdAgreement},onRender:function(){this._toggleConfirmBtn()},_toggleConfirmBtn:function(){this.ui.confirmBtn.prop("disabled",0===this.ui.radio.filter(":checked").length)},_triggerEvent:function(e,t,n){this.trigger("DProfileSetSelectView",e,t,n)},onAttach:function(){this._joining&&this._bandCore.isLoggingJoiningProfileSetLayer()&&this.jplSceneEnter(u.CLASSIFIER.PROFILE_SETTING_CHANGE)}});return p.EVENTS=h,p.openLayer=function(e){var n=t.when(a.fetchProfileSets()).then((function(t){return e.profileModel&&t.remove(e.profileModel.get("userProfileSetId")),new p({collection:t,bandCore:e.bandData.getBandCore(),joining:!1,fromEditProfile:!1,showAdAgreement:e.bandData.getNeedAdAgreement()})}));return r.openPromiseView(n,!1,{width:380,height:484}),n},p.openBandJoinLayer=function(e,t,n,i){var o=new p({collection:e,bandCore:t,joining:!0,fromEditProfile:n,showAdAgreement:i});return r.openWithoutHiding(o),o},p}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1312),s=n(547),a=n(154),r=n(486),l=n(498),c=n(499),d=n(488),u=n(9),h=n(443),p=n(158),m=n(82),_=n(1058);n(502);var g=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DGroupBandJoinHistoryView"},getTemplate:function(){return this._dataFetched?t.template(o):t.template(l)},templateContext:function(){if(!this._dataFetched)return{_loading_size:c.Size.MEDIUM,middleClass:d.ELEMENT.SCREEN_VERTICAL_MIDDLE};var e=this._appliedAt?this._appliedAt:this._createdAt,n=u.format.date(e,"year_month_day"),i=u.format.date(this._appliedAt,"year_month_day"),o=!1,s=null;return this._isJoinAnswerImagesExist()&&(o=!0,s=m.make(this._joinAnswerImages[0].url,m.TYPE.s150)),{name:this._name,joinDateText:IM("member_list.sort.joined_at",{joinedAt:n}),isApplicationExist:null!=this._appliedAt,joinApplicaionDateText:IM("bandjoin.join_application_date_format",{joinDateText:i}),acceptorHtml:IM("bandjoin.join_acceptor_text",{acceptor:t.escape(this._approverName)}),isJoinQuestiionExist:!t.isEmpty(this._joinQuestion),joinQuestionAsHtml:p.nl2br(t.escape(this._joinQuestion)),joinAnswerAsHtml:p.nl2br(t.escape(this._joinAnswer)),hasApplicantComment:this._hasApplicantComment,isJoinAnswerImagesExist:o,joinAnswerThumbnail:s,modalFooterExtraClass:this._hasApplicantComment?"":"gPat0",cid:this.cid}},ui:{closeBtn:"._closeBtn",openJoinTimeQnAApp:"._openJoinTimeQnAApp",joinAnswerImage:"._joinAnswerImage",showMediaViewer:"._showMediaViewer"},events:{"click @ui.closeBtn":function(){this.destroy()},"click @ui.openJoinTimeQnAApp":function(){return h.openBandMemberJoinTimeQnAApp(this._bandNo,this._memberKey),!1},"click @ui.showMediaViewer":function(){var e=this._joinAnswerImages[0];return _.openJoinApplicationSingleViewer(this._bandNo,[{photo_url:e.url,width:e.width,height:e.height}]),!1}},initialize:function(e){this._bandNo=e.bandNo,this._memberKey=e.memberKey,this._name=e.name,this._createdAt=e.createdAt},onDomRefresh:function(){this._dataFetched&&this._isJoinAnswerImagesExist()&&this.ui.joinAnswerImage.setLoading()},onAttach:function(){a.wrapActivePromise(s.getJoinInfo(this._bandNo,this._memberKey),this).then(t.bind((function(e){if(e&&e.data&&e.data.application){var t=e.data.application;this._appliedAt=t.applied_at,this._approverName=t.approver?t.approver.name:null,this._joinQuestion=t.join_question,this._joinAnswer=t.join_answer,this._hasApplicantComment=t.has_applicant_comment,this._joinAnswerImages=t.join_answer_images}this._dataFetched=!0,this.render()}),this))},_isJoinAnswerImagesExist:function(){return!t.isEmpty(this._joinAnswerImages)}});return g.openDGroupBandJoinHistoryView=function(e){var t=new g({bandNo:e.bandNo,memberKey:e.memberKey,name:e.name,createdAt:e.createdAt});r.openWithoutHiding(t)},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(668),i=n(158);return{openPenaltyAddConfirm:function(){var e={headerTitle:IM("page_band.block_member.title"),bodyDesc:i.nl2br(IM("page_band.block_member.description")),confirm:IM("page_band.block_member.confirm"),cancel:IM("ui.label.cancel"),withoutHiding:!0};return t.openConfirm(e)},openPenaltyRemoveConfirm:function(){var e={headerTitle:IM("page_band.release_blocked_member.title"),bodyDesc:i.nl2br(IM("page_band.release_blocked_member.description")),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no"),withoutHiding:!0};return t.openConfirm(e)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(6),s=n(4),a=n(43),r=n(2172),l=n(1314),c=n(1116),d=n(523),u=n(165),h=n(1619),p=o.Model.extend({validateFunction:function(e){return!0},validate:function(e){if(!this.validateFunction({date:e.date,dateFormat:"YYYY-MM-DD",time:e.time,timeFormat:"HH:mm"}))return"invalid"},dateTextParser:function(e){if(""===(e=i.trim(e)))return"";var t=a(e);if(!t.isValid())throw"invalid";return t.format("YYYY-MM-DD")},timeTextParser:function(e){if(""===(e=i.trim(e)))return"";var t=a(e,["a h:mm","h:mm a","HH:mm"]);if(!t.isValid())throw"invalid";return t.format("HH:mm")},defaults:function(){var e=d.startOfMinuteOfUnit(a(),30);return{useDelete:!1,disableTime:!1,date:"",time:"",pickerDate:e.format("YYYY-MM-DD"),pickerTime:e.format("HH:mm")}},setPickerDateAndTime:function(e,n){var i={};(e=this.dateTextParser(e))&&!this.get("date")&&(i.pickerDate=e),(n=this.timeTextParser(n))&&!this.get("time")&&(i.pickerTime=n),t.isEmpty(i)||this.set(i)},setDateAndTime:function(e,t){if(e&&t)try{e=this.dateTextParser(e),t=this.timeTextParser(t),this.set({date:e,pickerDate:e,time:t,pickerTime:t},{validate:!0})}catch(e){this.trigger("invalid")}else this._removeDateTimeWhenUseDelete()},setDate:function(e){if(e){var t={};this.get("time")||(t.time=this.get("pickerTime"));try{t.date=this.dateTextParser(e),t.pickerDate=t.date,this.set(t,{validate:!0})}catch(e){this.trigger("invalid")}}else this._removeDateTimeWhenUseDelete()},setTime:function(e){if(e){var t={};this.get("date")||(t.date=this.get("pickerDate"));try{t.time=this.timeTextParser(e),t.pickerTime=t.time,this.set(t,{validate:!0})}catch(e){this.trigger("invalid")}}else this._removeDateTimeWhenUseDelete()},_removeDateTimeWhenUseDelete:function(){this.get("useDelete")?this.set({date:"",time:""},{validate:!0}):this.trigger("invalid")}}),m={DATE_TIME_CHANGED:"dateTimeChanged"},_=s.View.extend({attributes:{"data-viewname":"DDateTimeInputView"},className:"flexList -layoutFixed -tbSpaceNone",template:t.template(r),ui:{dateInput:"._dateInput",timeInput:"._timeInput"},regions:{dateInput:"@ui.dateInput",timeInput:"@ui.timeInput"},childViewEvents:{dateChanged:function(){this.model.setDate(this.getChildView("dateInput").getValue())},"time:changed":function(){var e=this.getChildView("timeInput").getTime();e.time?(this.getChildView("dateInput").getValue()||this.getChildView("dateInput").setValue(this.model.get("pickerDate")),setTimeout(t.bind((function(){this.model.setTime(a(e.time,e.format).format("HH:mm"))}),this),0)):this.model.setTime("")}},modelEvents:{change:function(){var e=this.model.changedAttributes();t.has(e,"date")&&this.getChildView("dateInput").setValue(this.model.get("date")),t.has(e,"time")&&this.getChildView("timeInput").setTime(this.model.get("time")),!t.has(e,"date")&&!t.has(e,"time")||this._settingFromOutside||this.trigger(m.DATE_TIME_CHANGED,this.getDateTime())},invalid:function(){this.getChildView("dateInput").setValue(this.model.get("date")),this.getChildView("timeInput").setTime(this.model.get("time"))}},initialize:function(e){var n=e.dateValidator;this.model=new p(t.pick(e,"useDelete","disableTime")),this.model.setPickerDateAndTime(e.pickerDate,e.pickerTime),e.date&&e.time&&this.model.setDateAndTime(e.date,e.time),this.getOption("dateTextParser")&&(this.model.dateTextParser=this.getOption("dateTextParser")),n&&t.isFunction(n.isValid)&&(this.model.validateFunction=n.isValid),this._settingFromOutside=!1},onRender:function(){var e={useDateDelete:this.model.get("useDelete")};e.textParser=this.getOption("dateTextParser"),e.useDatePicker=this.getOption("useDatePicker"),e.pickerDirection=this.getOption("datepickerDirection"),e.placeholder=this.getOption("datePlaceholder"),e.date=this.model.get("date"),e.pickerDate=this.model.get("pickerDate"),e.canTextEdit=this.getOption("canTextEdit"),e.dateValidator=this._resolveDateValidator(),e.pickerWidth=this.getOption("pickerWidth"),this.showChildView("dateInput",c.buildDDateInputView(e));var t={};t.inputTime=this.model.get("time"),t.pickerTime=this.model.get("pickerTime"),t.placeholder=this.getOption("timePlaceholder"),t.pickerDirection=this.getOption("timepickerDirection"),t.readOnlyInput=this.getOption("canTextEdit"),t.minutesInterval=this.getOption("timeMinutesInterval"),this.showChildView("timeInput",l.buildTimeInputView(t)),this.model.get("disableTime")&&this.getChildView("timeInput").disable()},setPickerDateAndTime:function(e,t){this.model.setPickerDateAndTime(e,t)},getDateTime:function(){return{date:this.model.get("date"),dateFormat:"YYYY-MM-DD",time:this.model.get("time"),timeFormat:"HH:mm"}},setDateTime:function(e,t){this._settingFromOutside=!0,this.model.setDateAndTime(e,t),this._settingFromOutside=!1},focusDate:function(){this.getChildView("dateInput").focus()},_resolveDateValidator:function(){var e=this.getOption("dateValidator"),n=t.bind((function(){var e=this.getChildView("timeInput").getTime();return a(e.time||this.model.get("pickerTime"),e.format)}),this);return e?{getMinDate:t.wrap(e.getMinDate,t.bind((function(e){var t=e?e():null,i=n(),o=t?a(t).set({hour:i.hour(),minute:i.minute()}):null;return o?(o.isBefore(t)&&o.add(1,"days"),o.startOf("day")):null}),this)),getMaxDate:t.wrap(e.getMaxDate,t.bind((function(e){var t=e?e():null,i=n(),o=t?a(t).set({hour:i.hour(),minute:i.minute()}):null;return o?(o.isAfter(t)&&o.subtract(1,"days"),o.startOf("day")):null}),this)),isValid:t.wrap(e.isValid,t.bind((function(e,t){return!e||e({date:t.format("YYYY-MM-DD"),dateFormat:"YYYY-MM-DD",time:n().format("HH:mm"),timeFormat:"HH:mm"})}),this))}:null}});return _.DATEPICKER_DIRECTION=c.PICKER_DIRECTION,_.TIMEPICKER_DIRECTION=l.PICKER_DIRECTION,_.EVENT=m,_.buildDDateInputView=function(e){return new _(t.extend({},e))},_.buildSolarDateInputView=function(e){var n=(e=t.extend({},e)).timezoneId||u.getCurrentTimezoneId();if(e.dateTime){var i=a.tz(e.dateTime,n);i.isValid()&&(e.date=i.format("YYYY-MM-DD"),e.time=i.format("HH:mm"))}else if(e.pickerDateTime){var o=a.tz(e.pickerDateTime,n);o.isValid()&&(e.pickerDate=o.format("YYYY-MM-DD"),e.pickerTime=o.format("HH:mm"))}return new _(t.extend({},e))},_.buildLunarDateInputView=function(e){if((e=t.extend({dateTextParser:function(e){if(""===(e=i.trim(e)))return"";var t=h.parseDateText(e);if(!t)throw"invalid";return t.toDateISOText()}},e,{useDatePicker:!1})).dateTime){var n=h.parseISO(e.dateTime);n&&(e.date=n.toDateISOText(),e.time=n.toTimeISOText())}else if(e.pickerDateTime){var o=h.parseISO(e.pickerDateTime);o&&(e.pickerDate=o.toDateISOText(),e.pickerTime=o.toTimeISOText())}return new _(t.extend({},e))},_}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(2174),a=n(2175),r=n(16),l=n(26),c=n(9),d=n(567),u={DATE_CHANGED:"dateChanged"},h=o.View.extend({viewOptions:["pickerDirection","placeholder","useDateDelete","canTextEdit","format","disable","useDatePicker","textParser","dateValidator","pickerWidth","pickerHeight","useWeekSelect"],pickerDirection:a.DIRECTION.DOWN,pickerWidth:null,pickerHeight:null,useWeekSelect:!1,placeholder:IM("web.datepicker.topbar.text.title"),useDateDelete:!1,canTextEdit:!0,viewFormat:"YYYY.MM.DD",format:"YYYY-MM-DD",disable:!1,useDatePicker:!0,dateValidator:null,textParser:function(e){if(""===(e=i.trim(e)))return"";var t=r(e);if(!t.isValid())throw"invalid";return t.format(this.format)},attributes:{"data-viewname":"DDateInputView"},className:function(){var e="uInput -block";return this.getOption("pickerHeight")||(e+=" -h32"),this.getOption("disable")&&(e+=" -disabled"),!1!==this.getOption("useDatePicker")&&(e+=" -icoCalendar"),e},template:t.template(s),templateContext:function(){return{vid:this.cid,placeholder:this.placeholder,readonly:!this.canTextEdit,disable:this.disable}},initialize:function(e){this.mergeOptions(e,this.viewOptions);try{this._date=this.textParser(e.date)}catch(e){this._date=""}this._date?this._pickerDate=this._date:e.pickerDate?this._pickerDate=this.textParser(e.pickerDate):this._pickerDate=r().format(this.format)},ui:{input:"._input",datePickerRegion:"._datePickerRegion"},regions:{datePickerRegion:"@ui.datePickerRegion"},events:{"focus @ui.input":"_showDatePicker","change @ui.input":function(){var e;this._hideDatePicker();try{e=this.textParser(this._getFormattedInputValue())}catch(e){return void this.getUI("input").val(this._getViewFormattedValue())}this._updateValue(e)},"blur @ui.input":function(e){null!=e.relatedTarget&&this.getChildView("datePickerRegion")&&!this.getChildView("datePickerRegion").el.contains(e.relatedTarget)&&this._hideDatePicker()}},childViewEvents:{selectday:function(e){this._hideDatePicker(),this._updateValue(r(e,a.DATE_FORMAT).format(this.format))},delete:function(){this._hideDatePicker(),this._updateValue("")}},onRender:function(){this.getUI("input").val(this._getViewFormattedValue())},onAttach:function(){this._setWidth(),this._setHeight(),this.listenTo(l.getDGlobalChannel(),l.EVENT.HTML_CLICK,(function(e){this.el.contains(e.target)||this._hideDatePicker()}))},getValue:function(){return this._date},getWeeklyValueOfSelectedDate:function(){return{firstDateOfWeek:d.getFirstDateOfWeek(this.getValue(),d.DAYS.MONDAY.getDayNumber()).format(this.format),endDateOfWeek:d.getEndDateOfWeek(this.getValue(),d.DAYS.MONDAY.getDayNumber()).format(this.format)}},_setWidth:function(){var e=this.getOption("pickerWidth");e&&this.$el.css("width",e)},_setHeight:function(){var e=this.getOption("pickerHeight");e&&this.$el.css("height",e)},_getViewFormattedValue:function(){return this._date?c.format.date(r(this._date),"short_noweekday"):""},_getFormattedInputValue:function(){var e=this.getUI("input").val();return e?r(e,this.viewFormat).format(this.format):""},setValue:function(e){try{var t=this.textParser(e);this._updateValue(t,!0)}catch(e){}},_updateValue:function(e,t){this._date!==e&&(this._date=e,this._date&&(this._pickerDate=this._date),this.getUI("input").val(this._getViewFormattedValue()),t||this.trigger(u.DATE_CHANGED,{value:this.getValue(),format:this.format}))},_showDatePicker:function(){this.useDatePicker&&!this.getChildView("datePickerRegion")&&this.showChildView("datePickerRegion",a.build(r(this._pickerDate,this.format),this.pickerDirection,this.useDateDelete,this.dateValidator,this.useWeekSelect))},_hideDatePicker:function(){var e=this.getRegion("datePickerRegion");null!=e&&e.hasView()&&e.empty()},focus:function(){this.getUI("input").focus()},getElementId:function(){return this.ui.input.attr("id")},setInputText:function(e){this.getUI("input").val(e)}});return h.PICKER_DIRECTION=a.DIRECTION,h.EVENT=u,h.buildDDateInputView=function(e){return new h(e)},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{INPUT_VIEW_CLASS_NAME:"_messageInputView",INPUT_VIEW_DATA_KEY:"message-input-view"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(82),s=n(1346),a=n(552);return{createDInputPhotoElement:function(e){var n=o.make(e,o.TYPE.s150),r=i(t.template(s)({thumbnailUrl:n}));return r.data(a.INPUT_PHOTO_DATA_KEY,e).find(a.INPUT_PHOTO_DELETE_BUTTON_SELECTOR).data(a.INPUT_PHOTO_DATA_KEY,e),r}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(696),s=n(1354),a=n(158),r=n(159),l=n(26),c=n(154),d=n(668),u={STOP:"-stop",LOADING:"-loading",PLAY:"-play",PAUSE:"-pause"},h=i.View.extend({behaviors:[{behaviorClass:r}],attributes:{"data-viewname":"DAudioPlayerView"},className:"uVoicePlayer",template:t.template(s),ui:{audioPlayer:"._audioPlayer",controlBtn:"._controlBtn",minuteLabel:"._minuteLabel",secondLabel:"._secondLabel"},events:{"click @ui.controlBtn":function(){return!this._playProhibit&&(this._shouldLoadAudioFile()?(this._updateControlButtonStatus(u.LOADING),this.spawn(r.MSG.AUDIOPLAYER_FILE_URL_REQUIRED,{playerView:this}),!1):(this.togglePlayAudio(),!1))}},initialize:function(e){this._totalDuration=e.totalDuration,this._playProhibit=e.playProhibit,this._audioFileUrl=null,this._isAudioReady=!1,this._loadingProgress=!1},onRender:function(){this._updateControlButtonStatus(u.PLAY),this._updateTime(this._totalDuration,0)},onBeforeDetach:function(){this._audioPlayer&&this._audioPlayer.destroy()},play:function(){this._isAudioReady&&this._audioPlayer.play()},_pause:function(){this._isPlaying&&this._audioPlayer.pause()},togglePlayAudio:function(){this._isPlaying?this._pause():this.play()},loadAudioFile:function(e){if(this._shouldLoadAudioFile()){this._audioFileUrl=e,this._loadingProgress=!0;var n=o.buildAsyncAudioPlayer(this.ui.audioPlayer,this._audioFileUrl);c.wrapActivePromise(n,this).then(t.bind((function(e){this._audioPlayer=e,this.listenTo(this._audioPlayer,{timeupdate:function(e){var t=e.status;this._isPlaying&&t.src===this._audioFileUrl&&this._updateTime(t.duration,t.currentTime)},play:function(){this._isPlaying=!0,this._updateControlButtonStatus(u.PAUSE)},pause:function(){this._isPlaying=!1,this._updateControlButtonStatus(u.PLAY)},"ended stop":function(e){var t=e.status;t.src===this._audioFileUrl&&(this._isPlaying=!1,this._updateControlButtonStatus(u.PLAY),this._updateTime(t.duration,0))},error:function(){this._isPlaying=!1,d.openSimpleAlert(IM("unsupported_browser.msg.description")),this._updateControlButtonStatus(u.PLAY)}}),this._loadingProgress=!1,this._isAudioReady=!0,this._bindPageChangeEvent(),this._audioPlayer.play()}),this))}},_shouldLoadAudioFile:function(){return!this._isAudioReady&&!this._loadingProgress},_updateTime:function(e,t){(!e||e<0)&&(e=this._totalDuration),(!t||t<0)&&(t=0);var n=Math.floor(e)-Math.floor(t),i=a.zeropadWithParseInt(n/60,1),o=a.zeropadWithParseInt(n%60,2);this.ui.minuteLabel.text(i),this.ui.secondLabel.text(o)},_bindPageChangeEvent:function(){this.listenTo(l.getDGlobalChannel(),l.EVENT.ROUTE_CHANGE,this._pause),this.listenTo(l.getPostChannel(),l.EVENT.POST_DETAIL_LAYER_OPEN,this._pause)},_updateControlButtonStatus:function(e){this.ui.controlBtn.removeClass(t.values(u).join(" ")).addClass(e).text(this._getControlButtonLabel(e))},_getControlButtonLabel:function(e){switch(e){case u.STOP:return IM("web.audioplayer.player.btn.ready");case u.LOADING:return IM("ui.message.loading");case u.PLAY:return IM("web.audioplayer.player.btn.play");case u.PAUSE:return IM("pause");default:return""}}});return h.buildDAudioPlayerView=function(e,t){return new h({totalDuration:e,playProhibit:t})},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(1356),a=n(513),r=n(157),l=n(26),c=o.View.extend({tagName:"div",className:"settingBox",attributes:{"data-viewname":"DContentTranslationSettingView"},template:i.template(s),ui:{wrap:"._wrap",toggleBtn:"._toggleBtn",sourceLanguageBtn:"._sourceLanguageBtn",targetLanguageBtn:"._targetLanguageBtn",translationBtn:"._translationBtn",settingBtn:"._settingBtn"},events:{"click @ui.toggleBtn":function(e){var n=t(e.currentTarget),o="true"==n.attr("aria-expanded");i.defer(i.bind((function(){n.attr("aria-expanded",o?"false":"true").closest("._wrap").toggleClass("-dropDownOn",!o)}),this))},"click @ui.sourceLanguageBtn":function(e){var n=t(e.currentTarget).data("code");this._sourceLanguage=this._findSourceLanguage(n),this._targetLanguage=this._findTargetLanguage(this._targetLanguage.code),this.render()},"click @ui.targetLanguageBtn":function(e){var n=t(e.currentTarget).data("code");this._targetLanguage=this._findTargetLanguage(n),this.render()},"click @ui.translationBtn":function(){this._translationChannel.seeTranslation(this._targetLanguage.code,this._sourceLanguage.code),this._closeSelf()},"click @ui.settingBtn":function(){return a.openWindowXSSSafely(r.GLOBAL_SETTING_TRANSLATION.makeUrl(),"_blank"),!1},click:function(){return this._closeDropDown(),!1}},initialize:function(e){var t=(this._translationChannel=e.translationChannel).getContentTranslationSettingData(),n=t.selected;this._sourceLanguages=t.languages,this._sourceLanguage=this._findSourceLanguage(t.sourceLanguage||t.writtenIn)||this._findSourceLanguage(this._findFirstTranslatableLanguageCode(n)),this._targetLanguage=this._findTargetLanguage(t.targetLanguage||n),this._translationChannel.setShownLayer(this),i.defer(i.bind(this._bindBandRadioEvent,this))},onRender:function(){this._readyToSetPosition()},onAttach:function(){this._setPosition()},serializeData:function(){return{cid:this.cid,sourceLanguages:this._sourceLanguages,sourceLanguage:this._sourceLanguage,targetLanguages:this._getTargetLanguages(),targetLanguage:this._targetLanguage}},_readyToSetPosition:function(){this.isAttached()||this.$el.css({visibility:"hidden"})},_setPosition:function(){var e=this.el.getBoundingClientRect(),t=document.documentElement.clientHeight;e.height<t&&e.bottom>t&&this.$el.css({top:-(e.height+5)+"px"}),this.$el.css({visibility:""})},_bindBandRadioEvent:function(){this.listenTo(l.getDGlobalChannel(),l.EVENT.DOCUMENT_ESC_KEY_DOWN,(function(){this.isAttached()&&(this.ui.toggleBtn.filter('[aria-expanded="true"]').length>0?this._closeDropDown():this._closeSelf())})),this.listenTo(l.getDGlobalChannel(),l.EVENT.HTML_CLICK,(function(e){!this.isAttached()||e&&this.el.contains(e.target)||this._closeSelf()}))},_getTargetLanguages:function(e){return(e||this._sourceLanguage).translatable_languages},_findSourceLanguage:function(e){return i.findWhere(this._sourceLanguages,{code:e})},_findTargetLanguage:function(e){var t=this._getTargetLanguages();return i.findWhere(t,{code:e})||t[0]},_findFirstTranslatableLanguageCode:function(e){var t=this._findSourceLanguage(e);return(t?this._getTargetLanguages(t)[0]:this._sourceLanguages[0]).code},_closeDropDown:function(){this.isAttached()&&(this.ui.toggleBtn.attr("aria-expanded","false"),this.ui.wrap.toggleClass("-dropDownOn",!1))},_closeSelf:function(){this.isAttached()&&this.destroy()}});return c.build=function(e){return new c(e)},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=function(e,t){if(e.length+1!==t.length)throw new Error("not matching options");this.threshold=e,this.ids=t};return i.prototype.identify=function(e){for(var n=0;n<this.threshold.length;n++)if(t.isArray(this.threshold[n])){if(this.threshold[n][0]>e)return this.ids[n];if(this.threshold[n][0]===e)return this.threshold[n][1]}else if(this.threshold[n]>e)return this.ids[n];return this.ids[this.ids.length-1]},i.create=function(e){var n=t.partition(e,(function(e,t){return t%2==1}));return new i(n[0],n[1])},i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){var e=n(9),t="connection"in window.navigator&&"effectiveType"in window.navigator.connection,i={useHighQualityImage:function(){return!(window.devicePixelRatio<=1)&&i.isConsiderHighSpeedNetwork()},isConsiderHighSpeedNetwork:function(){return t?"4g"===window.navigator.connection.effectiveType:e.isHighSpeedNetworkCountry()}};return i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(486),s=n(577),a="SIMPLE",r="MAIN_LAYOUT",l=function(){this._intesectThreshold=.99,this._observers={},this._observers[r]=new IntersectionObserver(t.bind(this.onIntersecting,this),{threshold:[this._intesectThreshold],rootMargin:i.browser.msie?"-87px 0px 0px 0px":"-107px 0px 0px 0px"}),this._observers[a]=new IntersectionObserver(t.bind(this.onIntersecting,this),{threshold:[this._intesectThreshold]}),this._container={},this._registered=!1};return l.prototype._registerLayerHelper=function(){this._registered||(this._registered=!0,o.registerLayerEvent(o.EVENT.BEFORE_LAYER_OPEN,t.bind((function(e){t.each(this._container,(function(t){t.coveredLayerCid||(t.coveredLayerCid=e.cid,t.wasPlaying=t.view.isPlayReserved(),t.view.pause())}),this)}),this)),o.registerLayerEvent(o.EVENT.AFTER_LAYER_CLOSE,t.bind((function(e){t.each(this._container,(function(t){t.coveredLayerCid==e.cid&&(t.coveredLayerCid=null,t.wasPlaying&&t.autoplay&&t.view.play(!0))}),this)}),this)))},l.prototype.playingLogic={video:function(e){var n=t.partition(e,(function(e){return e.isIntersecting}));t.each(n[1],(function(e){e.view.pause()})),t.some(n[0],(function(e){return e.view.isPlayReserved()}))||t.chain(n[0]).sortBy((function(e){return e.view.$el.offset().top})).each((function(e,t){t<1?e.view.play(!0):e.view.pause()})).value()},gif:function(e){var n=t.partition(e,(function(e){return e.isIntersecting}));t.each(n[1],(function(e){e.view.pause()})),t.chain(n[0]).sortBy((function(e){return e.view.$el.offset().top})).each((function(e,t){t<3?e.view.play(!0):e.view.pause()})).value()}},l.prototype.onIntersecting=function(e){t.each(e,(function(e){var t=i(e.target).data("view-cid"),n=this._container[t];if(!n.coveredLayerCid){var o=e.intersectionRatio>=this._intesectThreshold;n.isIntersecting!==o&&(!o&&s.isFullScreenElementIn(e.target)?n.isIntersecting=!0:n.isIntersecting=o)}}),this),t.chain(this._container).values().filter((function(e){return!e.coveredLayerCid})).groupBy((function(e){return e.playingType})).each((function(e,t){this.playingLogic[t](e)}),this).value()},l.prototype.register=function(e,t){var n=e.cid,i=e.el,o=this._resolveObserverType(e);e.$el.data("view-cid",n),this._container[n]={view:e,coveredLayerCid:null,autoplay:t.autoplay,playingType:t.playingType,observerType:o},t.autoplay&&this._observers[o].observe(i),this._registerLayerHelper()},l.prototype.unregister=function(e){var t=e.cid,n=e.el,i=this._container[t],o=i?i.observerType:null;o&&this._observers[o].unobserve(n),i&&(this._container[t]=null,delete this._container[t])},l.prototype._resolveObserverType=function(e){return!o.isContainedInLayer(e)&&i("#header").length?r:a},new l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(1181);return new(i.Model.extend({defaults:{"feed.replacement_of_no_contents":"","comment.hidable_limit":""},ready:t.memoize((function(){return o.getEnv(t.keys(this.defaults).join(",")).then(t.bind((function(e){this.set(e)}),this))})),isShowFeedReplacementOfNoContents:function(){return"template1"===this.get("feed.replacement_of_no_contents")},getHidableCommentReplyLimitPromise:function(){return this.ready().then(t.bind((function(){return this.get("comment.hidable_limit")||Number.MAX_VALUE}),this))}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(10),s=n(1386),a=n(1387),r=n(486),l=n(493),c=n(155),d=n(52),u=n(589),h=n(527),p=n(907),m=n(154),_=n(1389),g=n(160),f=n(167),b=n(166),v=n(26),A=t.View.extend({attributes:{"data-viewname":"DGroupBandMemberGroupItemDetailView"},tagName:"section",className:"lyWrap",template:i.template(s),ui:{groupMemberListRegion:"._groupMemberListRegion",addMembers:"._addMembers",emptyWrap:"._emptyWrap",btnSearch:"._btnSearch",memberCount:"._memberCount",inputSearch:"._inputSearch",btnLayerClose:"._btnLayerClose",btnMoreMenu:"._btnMoreMenu",moreMenuLayer:"._moreMenuLayer",modifyGroupName:"._modifyGroupName",btnCloseSummary:"._btnCloseSummary",bandManagerSummary:"._bandManagerSummary",searchWrap:"._searchWrap"},events:{"submit @ui.searchWrap":function(e){e.preventDefault(),this._searchMembersForGroup()},"input @ui.inputSearch":function(){var e=this.getUI("inputSearch").val(),t=this.getUI("btnSearch");i.isEmpty(e)?(t.removeClass("-active").addClass("-disabled").attr("disabled",!0),this._showMemberGroupDetailListRegion(this._originGroupBandMemberGroupItemDetailMember)):t.removeClass("-disabled").addClass("-active").attr("disabled",!1)},"click @ui.addMembers":function(){var e=p.openDMemberSelectionView({titleText:this._memberGroupName,submitBtnText:IM("ui.label.complete")}),t=h.buildBandMemberWithFilterDataCollection(this._bandNo,g.MEMBER_GROUP_CANDIDATE,100,this._memberGroupId),n=h.buildBandMemberWithFilterDataCollection(this._bandNo,g.MEMBER_GROUP_CANDIDATE,100,this._memberGroupId);m.wrapActivePromise(t.fetchBandMemberWithFilterDataCollection(),this).then(i.bind((function(){e.renderMemberListToSelect({memberModels:t.toMemberSelectionViewModels(),showSearchMoreMemberBtn:t.hasMoreMember()})}),this)),this.listenTo(e,p.EVENT.MEMBER_SELECTION_MEMBER_SELECT_CLICK,(function(t){t.selectedMemberCount+this._originGroupBandMemberGroupItemDetailMember.length>=100?alert(IM("band.member.group.max_selection_count",{maxCount:100})):e.selectMember(t.selectedMember)})),this.listenTo(e,p.EVENT.MEMBER_SELECTION_MEMBER_DESELECT_CLICK,(function(t){e.deselectMember(t)})),this.listenTo(e,p.EVENT.MEMBER_SELECTION_MEMBER_PROFILE_CLICK,(function(e){u.openMembershipProfileLayer({name:e.name,profileImageUrl:e.profileImageUrl,userNo:e.userNo,bandNo:this._bandNo})})),this.listenTo(e,p.EVENT.MEMBER_SELECTION_SEARCH,(function(t){m.wrapActivePromise(n.searchBandMemberWithFilterDataCollection(t),this).then((function(){e.renderMemberListToSelect({memberModels:n.toMemberSelectionViewModels(),showSearchMoreMemberBtn:n.hasMoreMember()})}))})),this.listenTo(e,p.EVENT.MEMBER_SELECTION_INPUT_EMPTY,(function(){e.renderMemberListToSelect({memberModels:t.toMemberSelectionViewModels(),showSearchMoreMemberBtn:t.hasMoreMember()})})),this.listenTo(e,p.EVENT.MEMBER_SELECTION_COMPLETE,(function(t){if(t.selectedMembers.length+this._originGroupBandMemberGroupItemDetailMember.length>100)alert(IM("band.member.group.max_selection_count",{maxCount:100}));else{var n=i.map(t.selectedMembers,(function(e){return e.getUserNo()})).join(",");l.addMembersToMemberGroup(this._bandNo,this._memberGroupId,n).then(i.bind((function(){this._getBandMembersOfMemberGroup(),e.destroyView()}),this))}}))},"click @ui.btnLayerClose":function(){v.getBandChannel(this._bandNo).trigger(v.EVENT.REFRESH_MEMBER_GROUPS),this.destroy()},"click @ui.btnMoreMenu":function(){this.getUI("moreMenuLayer").toggle()},"click @ui.modifyGroupName":function(){var e=_.buildLayerView(this._bandNo,this._memberGroupId,this._memberGroupName);this.listenTo(e,"modifyGroupName:resolved",i.bind((function(e){this._memberGroupName=e,this.render()}),this)),this.getUI("moreMenuLayer").hide()},"click @ui.btnCloseSummary":function(){this.getUI("bandManagerSummary").hide(),f.getCurrentUserEnvStorage().set([b.MemberGroupUseGuide],!0)}},regions:{groupMemberListRegion:{el:"@ui.groupMemberListRegion",replacement:!1}},initialize:function(e){this._bandNo=e.bandNo,this._memberGroupId=e.memberGroupId,this._memberGroupName=e.memberGroupName,this._memberCount=e.memberCount,this._dGroupBandMemberGroupItemDetailMemberCollection={},this._bandData=c.get(this._bandNo)},templateContext:function(){return{memberGroupName:this._memberGroupName,memberCount:this._memberCount,canManageMemberGroups:this._bandData.canManageMemberGroups(),isHideMemberGroupUseGuide:f.getCurrentUserEnvStorage().get([b.MemberGroupUseGuide])}},onDomRefresh:function(){this._getBandMembersOfMemberGroup()},_getBandMembersOfMemberGroup:function(){l.getBandMembersOfBandWithFilter(this._bandNo,g.MEMBER_GROUP,this._memberGroupId).then(i.bind((function(e){this._originGroupBandMemberGroupItemDetailMember=e.members,this._showMemberGroupDetailListRegion(e.members),this.getUI("memberCount").html(e.members.length)}),this))},_searchMembersForGroup:function(){var e=this.getUI("inputSearch").val(),t=i.filter(this._originGroupBandMemberGroupItemDetailMember,(function(t){return o.include(t.name.toLowerCase(),e.toLowerCase())}));this._showMemberGroupDetailListRegion(t)},_showMemberGroupDetailListRegion:function(e){if(this._dGroupBandMemberGroupItemDetailMemberCollection=new T(i.extend(d.camelizeKeys(e))),i.isEmpty(e))this.getUI("emptyWrap").show(),this.getUI("groupMemberListRegion").hide();else{var t=new C({collection:this._dGroupBandMemberGroupItemDetailMemberCollection,bandNo:this._bandNo,memberGroupId:this._memberGroupId,canManageMemberGroups:this._bandData.canManageMemberGroups()});this.getUI("emptyWrap").hide(),this.getUI("groupMemberListRegion").show(),this.showChildView("groupMemberListRegion",t),this.listenTo(t,"groupMembersView:remove_member",i.bind((function(e){this._originGroupBandMemberGroupItemDetailMember=i.filter(this._originGroupBandMemberGroupItemDetailMember,i.bind((function(t){return t.user_no!=e}),this)),this.getUI("memberCount").html(this._dGroupBandMemberGroupItemDetailMemberCollection.length),0==this._dGroupBandMemberGroupItemDetailMemberCollection.length&&(this.getUI("emptyWrap").show(),this.getUI("groupMemberListRegion").hide())}),this))}}}),E=Backbone.Model.extend({defaults:function(){return{userNo:"",name:"",profileImageUrl:""}}}),T=Backbone.Collection.extend({model:E}),C=t.CollectionView.extend({tagName:"ul",className:"listLine",attributes:{"data-viewname":"DGroupBandMemberGroupCollectionView"},initialize:function(e){this._collection=e.collection,this._bandNo=e.bandNo,this._memberGroupId=e.memberGroupId,this._canManageMemberGroups=e.canManageMemberGroups},childView:a,childViewOptions:function(){return{canManageMemberGroups:this._canManageMemberGroups}},childViewEvents:{"groupMemberView:exclude_from_group":function(e){confirm(IM("band.member.group.are_you_sure_member_except"))&&l.deleteMembersFromMemberGroup(this._bandNo,this._memberGroupId,e.get("userNo")).then(i.bind((function(){this._collection.remove(e),this.trigger("groupMembersView:remove_member",e.get("userNo"))}),this))}}});return A.buildAsyncLayerView=function(e,t){return l.getMemberGroup(e,t).then(i.bind((function(n){var i=new A({bandNo:e,memberGroupId:t,memberGroupName:n.name,memberCount:n.member_count});return r.open(i),i}),this))},A}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i=n(2),o=n(0),s=n(10),a=n(1399),r=n(161),l=n(156),c=n(59),d=n(1128),u=n(1096);function h(e){this._zipName=l.convertToSafeFileNameAgainstOS(e.zipName),this._entries=e.zipEntries.toArray(),this._bandCore=e.bandCore,this._onCancel=e.onCancel,this._onComplete=e.onComplete,this._total=this._entries.length,this._errors=[],this._isClosed=!1,this._cancelZip=o.bind(this._closeZip,this,!0),this._abortController=new AbortController,this._abortSignal=this._abortController.signal,this._openProgress(),i(window).on("beforeunload",this._cancelZip),Promise.all([n.e(151),n.e(175)]).then(n.t.bind(null,1752,7)).then(o.bind(this._createZip,this))}h.prototype._createZip=function(e){var t=this._zipName;s.endsWith(t.toLowerCase(),".zip")||(t+=".zip"),this._fileStream=e.createWriteStream(t),this._zipStream=new ZIP({start:o.bind(this._startEntry,this),pull:o.bind(this._pullEntry,this)}),window.WritableStream&&this._zipStream.pipeTo?this._zipStream.pipeTo(this._fileStream).catch(o.noop):(this._writer=this._fileStream.getWriter(),this._reader=this._zipStream.getReader(),this._writeReaderValue())},h.prototype._closeZip=function(e){if(!this._isClosed){this._isClosed=!0,i(window).off("beforeunload",this._cancelZip),this._closeProgress(),e&&(this._abortController.abort(),this._writer?this._writer.abort().catch(o.noop):this._fileStream&&this._fileStream.abort().catch(o.noop));try{this._zipWriter.close()}catch(e){}e?o.isFunction(this._onCancel)&&this._onCancel():(this._reportError(),o.isFunction(this._onComplete)&&this._onComplete())}},h.prototype._startEntry=function(e){this._zipWriter=e},h.prototype._pullEntry=function(){return new Promise(o.bind(this._addEntry,this))},h.prototype._addEntry=function(e){if(this._isClosed)e();else{if(this._updateProgress(),0===this._entries.length)return this._closeZip(),void e();var t=this._entries.shift();t.fetchStream(this._abortSignal).then(o.bind((function(n){this._zipWriter.enqueue({name:this._zipName+"/"+t.getEntryPathName(),stream:function(){return n}}),e()}),this)).catch(o.bind((function(n){this._handleError(t,n),setTimeout(o.bind(this._addEntry,this,e))}),this))}},h.prototype._handleError=function(e,t){if(e.hasFailureMark()){var n=t instanceof Error?t.message:t;this._errors.push({entry:e,message:n})}else e.markFailure(),this._entries.push(e)},h.prototype._reportError=function(){if(0!==this._errors.length){var e=o.map(this._errors,(function(e){return{message:e.message,entry:e.entry.getEntryLog()}}));c.sendWarn({body:"ZipDownloadFailed\n"+JSON.stringify(e,null,2)})}},h.prototype._writeReaderValue=function(){this._reader.read().then(o.bind((function(e){return e.done?this._writer.close():this._writer.write(e.value)}),this)).then(o.bind(this._writeReaderValue,this))},h.prototype._openProgress=function(){this._progress=d.openProgressModal({title:this._zipName,desc:IM("ui.label.downloading"),bandCore:this._bandCore,withoutHiding:!0,progressMode:d.MODE.COUNT,total:this._entries.length}),this._progress.on("cancel",this._cancelZip)},h.prototype._updateProgress=function(){this._progress.isDestroyed()||this._progress.setProgress(this._total-this._entries.length-this._errors.length)},h.prototype._closeProgress=function(){this._progress.isDestroyed()||this._progress.destroy()},h.supports=function(){try{return new Function("(a = 0) => a"),!!o.isFunction(window.fetch)&&!!o.isFunction(window.AbortController)}catch(e){return!1}},h.openUnsupportedLayer=function(){u.openDUnsupportedBrowserLayer()},h.entries=function(){return a.create()},h.download=function(e){h.supports()&&new h(e)},h.downloadPhotoList=function(e){if(h.supports()){var t=e.band,n=t.band_no,i=r.createBandCore(t),s=e.file_name,a=h.entries();o.each(e.photo_list,(function(e){a.addPhoto(n,e.name,e.url)})),new h({zipName:s,zipEntries:a,bandCore:i})}else h.openUnsupportedLayer()},e.exports=h},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1400),s=n(486),a={PERCENT:"percent",COUNT:"count"},r=i.View.extend({options:{progressMode:a.PERCENT,total:0,noCancel:!1},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DProgressModalView"},template:t.template(o),ui:{progressText:"._progressText",progressBar:"._progressBar",cancelBtn:"._cancelBtn"},events:{"click @ui.cancelBtn":function(e){this.trigger("cancel"),this.destroy()}},initialize:function(e){this._title=e.title,this._desc=e.desc,this._bandCore=e.bandCore},serializeData:function(){return{title:this._title,skinColor:this._bandCore?this._bandCore.getSkinColorClass():null,desc:this._desc,noCancel:this.options.noCancel}},setProgress:function(e){this.options.progressMode===a.PERCENT?(this.ui.progressText.html(e+"%"),this.ui.progressBar.css("width",e+"%")):(this.ui.progressText.html(t.template('<strong class="sf_color"><%-progress%></strong>/<%-total %>')({progress:e,total:this.options.total})),this.ui.progressBar.css("width",e/this.options.total*100+"%"))}});return r.openProgressModal=function(e){var t=new r(e);if(e.withoutHiding?s.openWithoutHiding(t):s.open(t),e.progressMode===a.COUNT&&!e.total)throw new Error("total required when using COUNT mode");return t},r.MODE=a,r}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(){var e=function(e,t,n){this.routeInfo=e,this.params=t,this.query=n};return e.newRoute=function(t,n,i){return new e(t,n||{},i||{})},e}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(53),s=n(513),a=n(153),r=n(162),l=n(589),c=n(168),d=function(e,t,n){this._memberProfile=e,this._userNoOrMemberKey=t,this._bandCore=n};return d.prototype._isAnonymousMembership=function(){return!this._memberProfile.gotoBandOnClickProfile()&&!this._userNoOrMemberKey},d.prototype.isGotoBandOnClick=function(){return!this._isAnonymousMembership()&&(this._memberProfile.gotoBandOnClickProfile()&&(parseInt(o.getCurrentRouteInfo().pathVariables.band_no,10)!==this._bandCore.bandNo||i.contains([a.GROUP_BAND_MEDIA_DETAIL,a.GROUP_BAND_MEDIA_DETAIL_COMMENT,a.GROUP_BAND_MEDIA_DETAIL_COMMENT_REPLY,r.PAGE_BAND_MEDIA_DETAIL,r.PAGE_BAND_MEDIA_DETAIL_COMMENT],o.getCurrentRouteInfo().routeInfo)))},d.prototype.isOpenProfileOnClick=function(){return!this._isAnonymousMembership()&&!this._memberProfile.gotoBandOnClickProfile()},d.prototype.canClickMemberProfile=function(){return this.isGotoBandOnClick()||this.isOpenProfileOnClick()},d.prototype.clickMemberProfileAction=function(){if(this.isGotoBandOnClick()){var e=this._bandCore.makeBandRouteUrl(a.GROUP_BAND_HOME,r.PAGE_BAND_HOME,{band_no:this._bandCore.bandNo});s.openWindowXSSSafely(location.protocol+"//"+location.host+e,"_blank")}else{if(this.isOpenProfileOnClick())(t.isNumeric(this._userNoOrMemberKey)?t.Deferred().resolve(this._userNoOrMemberKey):c.getUserNoByMemberKey(this._bandCore.bandNo,this._userNoOrMemberKey)).then(i.bind((function(e){l.openMemberProfileLayer(this._memberProfile,e,this._bandCore.bandNo)}),this))}},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(165),s=n(2204),a=i.View.extend({_isAttached:!1,_currentLang:null,_currentTimezone:null,_countries:null,_selectedCountry:null,_selectedCountryTimezones:null,_selectedTimezone:null,tagName:"div",className:"uTimezoneArea",attributes:{"data-viewname":"DTimezoneSelectView"},template:t.template(s),ui:{countrySelect:"._countrySelect",timezoneSelect:"._timezoneSelect"},events:{"change @ui.countrySelect":function(e){var t=this.ui.countrySelect.val();this._selectedCountry=o.getTimezoneCountry(t),this._selectedCountryTimezones=o.getTimezones(t),this._selectedTimezone=this._selectedCountryTimezones[0],this.trigger(a.EVENT.TIMEZONE_CHANGED,this._selectedTimezone.id),this.render()},"change @ui.timezoneSelect":function(e){var t=this.ui.timezoneSelect.val();this.ui.timezoneSelect.attr("data-value",t),this._selectedTimezone=o.getTimezone(t),this.trigger(a.EVENT.TIMEZONE_CHANGED,t)}},initialize:function(e){this._currentLang=o.getCurrentLanguage(),this._currentTimezone=o.getCurrentTimezone(),this._countries=o.getAllTimezoneCountries(),this._selectedTimezone=o.getTimezone(e.timezoneId)||o.getCurrentTimezone();var n=this._selectedTimezone.country.code;this._selectedCountry=o.getTimezoneCountry(n),this._selectedCountryTimezones=o.getTimezones(n),this._isShowTimezoneTitle=t.isUndefined(e.isShowTimezoneTitle)&&!0},serializeData:function(){return{currentLang:this._currentLang,currentTimezone:this._currentTimezone,countries:this._countries,selectedCountry:this._selectedCountry,selectedCountryTimezones:this._selectedCountryTimezones,selectedTimezone:this._selectedTimezone,isShowTimezoneTitle:this._isShowTimezoneTitle}},destroyTimezoneSelectView:function(){this.destroy()}});return a.EVENT={TIMEZONE_CHANGED:"timezoneSelectView:changed"},a}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0);return{html:t.memoize((function(e,n){return t.template('<p class="uEmpty <%-additionalClass%>"><span class="text"><%=message %></span></p>')({message:e,additionalClass:n||""})}))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(1345),s=n(82),a=n(22),r=t.template(o);var l={21:"-size21",34:"-size34"};i.fn.DUProfile=function(e){var n=(e=e||{}).memberProfile,o=e.size;t.isFinite(e.size)||(o=34);var c=e.description||"";return this.each((function(){var e=i(this);e.html(r(function(e){var t=s.makeProfileThumbnailUrl(e.memberProfile.profileImageUrl);return{profileImageUrl:e.memberProfile.profileImageUrl,profileThumbnail:t,profileInnerClass:s.makeProfileInnerClass(t),name:e.memberProfile.name,description:e.description}}({memberProfile:n,description:c}))),n.memberType===a.MEMBER_TYPE.PAGE_PROFILE&&t.isEmpty(n.profileImageUrl)&&e.addClass("-pageProfile"),e.find("._img").one("error",(function(){i(this).remove(),n.memberType===a.MEMBER_TYPE.PAGE_PROFILE&&e.addClass("-pageProfile"),e.find("._profileInner").removeClass("-gifProfileBg")})),e.addClass("uProfile"),e.addClass(l[o])}))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(167),o=n(166),s=n(562);return{alertDSecretCommentUseGuide:function(e){var n=i.getCurrentUserEnvStorage();if(!n.get([e])){var a=IM("comment.secret_comment_use_guide");e==o.SecretCommentReplyUseGuide&&(a=IM("comment.secret_reply_use_guide")),s.openLayer({bodyTitle:a,withoutHiding:!0}).once(s.EVENTS.CONFIRM,t.bind((function(){n.set([e],!0)}),this))}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(4),a=n(1360),r=n(595),l=n(935),c=n(82),d=n(486),u=n(499),h=n(498),p=n(488),m=n(154),_=n(16),g=s.View.extend({tagName:"section",attributes:{"data-viewname":"DAlbumSelectView"},className:function(){return 1==this.options.transparentMode?"lyWrap -bgOpacity0":"lyWrap"},templateContext:function(){return{msg_ThumbnailUrl:function(e){return c.make(e,c.TYPE.s150)},msg_displayDate:function(e){return _(e).format("ll")}}},ui:{cancelButton:"[data-uiselector=cancelButton]",btnSaveAlbum:"[data-uiselector=btnSaveAlbum]",makeAlbum:"[data-uiselector=makeAlbum]",albumRadioButton:"[data-uiselector=albumRadioButton]",eachAlbumLi:"._eachAlbumLi"},events:{"click @ui.cancelButton":function(){this.destroy()},"click @ui.makeAlbum":"_openCreateAlbumModal","click @ui.btnSaveAlbum":"_saveSelectedAlbum","click @ui.albumRadioButton":function(){return!1},"mousedown @ui.eachAlbumLi":"_toggleAlbumRadio"},initialize:function(e){this._bandNo=e.bandNo,this._saveButtonText=e.saveButtonText,this._excludeAlbumNo=e.excludeAlbumNo,this._initAlbumNo=e.initAlbumNo,this._selectedAlbumIndex=null,this.collection=new b,this._dataFetched=!1,this.collection.fetchDAlbumCollection(this._bandNo,this._excludeAlbumNo),this.listenTo(this.collection,"fetch:albumCollection",(function(){this._dataFetched=!0,this.render()}))},getTemplate:function(){return this._dataFetched?i.template(a):i.template(h)},serializeData:function(){return this._dataFetched?{items:this.collection.toJSON(),saveButtonText:this._saveButtonText}:{_loading_size:u.Size.MEDIUM,middleClass:p.ELEMENT.SCREEN_VERTICAL_MIDDLE}},onRender:function(){this._dataFetched&&this._selectInitAlbum()},_toggleAlbumRadio:function(e){var n=t(e.currentTarget).find("._checkInput"),i=n.val();return i==this._selectedAlbumIndex?(this._selectedAlbumIndex=null,this._unselectAll(),this.ui.btnSaveAlbum.addClass("-disabled"),!1):(this._unselectAll(),n.prop("checked",!0),this._selectedAlbumIndex=i,this.ui.btnSaveAlbum.removeClass("-disabled"),!1)},_unselectAll:function(){this.ui.albumRadioButton.each((function(e,n){var i=t(n);i.prop("checked")&&i.prop("checked",!1)}))},_selectInitAlbum:function(){null!=this._initAlbumNo&&m.wrapDeferPromise(this).then(i.bind((function(){var e=this.$el.find('[data-albumno="'+this._initAlbumNo+'"]');e.prop("checked",!0),this._selectedAlbumIndex=e.val(),this.ui.btnSaveAlbum.removeClass("-disabled"),this._initAlbumNo=null}),this))},_openCreateAlbumModal:function(){var e=l.openDPromptModalView({title:IM("web.postwrite.album.modal.title"),desc:IM("web.postwrite.album.modal.desc"),maxlength:50});return this.listenTo(e,"modal:confirm",i.bind((function(e){r.createPhotoAlbum(this._bandNo,e,!1).then(i.bind((function(e){this._initAlbumNo=e.photo_album.no,this.collection.fetchDAlbumCollection(this._bandNo,this._excludeAlbumNo)}),this))}),this)),!1},_saveSelectedAlbum:function(){if(!this._selectedAlbumIndex)return alert(IM("web.postwrite.album.modal.alert")),!1;if("noalbum"==this._selectedAlbumIndex)return this.trigger("unselect:album"),!1;var e=this.collection.at(this._selectedAlbumIndex);return this.trigger("select:album",e.get("name"),e.get("albumNo")),!1}}),f=o.Model.extend({parse:function(e){return{name:e.name,albumNo:e.no,cover:e.covers?e.covers[0]:null,isDeleted:e.is_deleted,createdAt:e.created_at}}}),b=o.Collection.extend({model:f,fetchDAlbumCollection:function(e,t){var n={band_no:e,all_cover_count:1,album_cover_count:1,album_count:100,is_with_all:!1};return r.getPhotoAlbums(n).then(i.bind((function(e){var n=e.photo_albums;null!=t&&(n=i.filter(n,(function(e){return e.no!=t}))),this.reset(n,{parse:!0,validate:!0}),this.trigger("fetch:albumCollection")}),this))}});return g.openAlbumSelectView=function(e){var t=new g(e);return d.openWithoutHiding(t),t},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1147),s=n(1365),a=(n(152),n(1035).WATCHER_TYPE);return i.CollectionView.extend({tagName:"ul",className:"listLine rScroll -flexAuto",childView:s,childViewOptions:function(){return{bandData:this._bandData,watcherType:this._watcherType}},emptyView:function(){var e,n=!this._isEveryMemberIncluded;return e=this._watcherType===a.NON_WATCHER&&n?IM("post.read_user_list.message.limit_max_member_count"):IM("ui.message.empty_conents"),i.View.extend({tagName:"p",className:"uEmpty -hFull",template:t.template(o.html(e))})},initialize:function(e){this._bandData=e.bandData,this._watcherType=e.watcherType,this._isEveryMemberIncluded=e.isEveryMemberIncluded},filter:function(e,t,n){var i=!this._isEveryMemberIncluded;return(this._watcherType!==a.NON_WATCHER||!i)&&e.containsWatcherType(this._watcherType)},filterWatcherType:function(e){this._watcherType=e,this.render()}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6).Model.extend({setAutoPlayOnOpening:function(e){return this.set("autoPlayOnOpening",e)},isAutoPlayOnOpening:function(){return this.get("autoPlayOnOpening")||!1}}),i=[];return{buildMediaViewerOptionsAddedToHolder:function(){return i.splice(0,i.length,new t({})),i[0]},getMediaViewerOptionsRemovedFromHolder:function(){return i.pop()||new t({})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(52),s=n(804),a=n(529),r=i.Model.extend({initialize:function(e,t){this._bandNo=t.bandNo,this._missionId=t.missionId,this._userNo=t.userNo},parse:function(e){var t=o.camelizeKeys(e);return t.actor=a.buildContentAuthorModel(t.actor),t},getBandMissionConfirmSummaryActor:function(){return this.get("actor")},getBandMissionConfirmSummaryConfirmCount:function(){return this.get("confirmCount")},getBandMissionConfirmSummaryConfirmStatus:function(){return this.get("confirmStatus")},isParticipatedBandMission:function(){return this.getBandMissionConfirmSummaryConfirmCount()>0},getBandMissionConfirmSummaryLatestConfirmedAt:function(){return this.get("latestConfirmedAt")},isMyNotYetConfirmedBandMissionConfirmSummary:function(){return this.getBandMissionConfirmSummaryActor().isContentAuthorMe()&&"not_yet_confirmed"==this.get("confirmStatus")},getBandMissionConfirmSummaryMissionConfirm:function(){return this.get("missionConfirm")},fetchBandMissionConfirmSummary:function(){return s.getMissionConfirmSummary(this._bandNo,this._missionId,this._userNo).then(t.bind((function(e){this.clear({silent:!0}),this.set(this.parse(e.mission_confirm_summary))}),this))},isMatchedBandMissionConfirmSummary:function(e,n,i){return this._bandNo==e&&(this._missionId==n||t.some(this.getBandMissionConfirmSummaryMissionConfirm(),(function(e){return e.postNo==i})))},isBandMissionConfirmSummaryRemindEnabled:function(){return"remind_enabled"===this.get("remindState")},setBandMissionConfirmSummaryRemindState:function(e){return s.setMissionRemindState(this._bandNo,this._missionId,e?"remind_enabled":"remind_disabled")}});return r.createBandMissionConfirmSummaryModel=function(e,t,n){return new r(void 0,{bandNo:e,missionId:t,userNo:n})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){var e=n(16),t={YYYYMMDD:"YYYY-MM-DD",SHORT_MONTH_DAY:"short_month_day",SHORT:"short",SHORT_NOWEEKDAY:"short_noweekday"},i={TAB_INFO:{FOLLOWERS:"followers",PARTICIPATION:"participation",REACTION:"reaction"},EVENT:{RENDERED:"pageBand:stats:rendered",DATA_AREA_SCROLL:"pageBand:stats:dataArea:scroll",CONTENT_BODY_CLICK:"pageBand:stats:contentBody:click"},DEFAULT_LOOKUP_DATE:{FROM:function(){return e().subtract(7,"days").format(t.YYYYMMDD)},TO:function(){return e().subtract(1,"days").format(t.YYYYMMDD)}}};return i.DATE_FORMAT=t,i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(154),s=n(596),a=n(2459);n(608);var r=new s(150,150),l=i.View.extend({options:{bPostDetail:!1},attributes:{"data-viewname":"DPostStickerView"},template:t.template(a),ui:{attachmentSticker:"._attachmentSticker",stickerImage:"._stickerImage"},events:{"click @ui.attachmentSticker":"_showPostDetailLayer","click ._stickerImage":function(e){if(this.bPostDetail)return this._renderAniSticker(e.currentTarget),!1}},initialize:function(e){this.stickerModel=e.model,this.bPostDetail=e.bPostDetail,this._hasSticker=null!=this.stickerModel.get("imageUrl"),this._convertedSize=r.calcurate({width:this.stickerModel.get("width"),height:this.stickerModel.get("height")})},serializeData:function(){return{imageUrl:this.stickerModel.get("imageUrl")?this.stickerModel.get("imageUrl"):"",aniStickerImageUrl:this.stickerModel.get("aniStickerImageUrl")?this.stickerModel.get("aniStickerImageUrl"):"",convertedWidth:this._convertedSize.width,convertedHeight:this._convertedSize.height}},onDomRefresh:function(){this._renderAniSticker(this.ui.stickerImage[0])},onBeforeDetach:function(){this._apngSticker&&(this._apngSticker.stop(),this._apngSticker=null)},_showPostDetailLayer:function(){this.bPostDetail||this.trigger("attachmentSticker:showPostDetailLayer")},_renderAniSticker:function(e){if(this.bPostDetail&&this._hasSticker&&this.stickerModel.isAniSticker()){if(this._apngSticker){if(this._apngSticker.isPlayed()&&!this._apngSticker.isFinished())return;return this._apngSticker.rewind(),void this._apngSticker.play()}o.wrapActivePromise(APNG.animateImage(e,this._convertedSize.width,this.stickerModel.get("width"),this._convertedSize.height,this.stickerModel.get("height")),this).then(t.bind((function(e){this._apngSticker=e}),this))}}});return l.build=function(e){return new l({model:e.model})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(155),s=n(852),a=n(2533),r=n(1405),l=(n(529),n(1404)),c=n(2534),d=n(2535),u=n(2538),h=n(2539),p=n(2540),m=n(506),_={LIVE_STATUS_CHANGED:"LIVE_STATUS_CHANGED",LIVE_FETCHED_AFTER_ON_LIVE:"LIVE_FETCHED_AFTER_ON_LIVE",LIVE_CHAT_CONNECT_STATUS_CHANGED:"LIVE_CHAT_CONNECT_STATUS_CHANGED",LIVE_CHAT_PIN_MESSAGE_CHANGED:"LIVE_CHAT_PIN_MESSAGE_CHANGED",LIVE_CHAT_SECTION_SIZE_CHANGED:"LIVE_CHAT_SECTION_SIZE_CHANGED",LIVE_VIEWER_COUNT_UPDATED:"LIVE_VIEWER_COUNT_UPDATED",LIVE_BAND_JOIN_STATUS_CHANGED:"LIVE_BAND_JOIN_STATUS_CHANGED",LIVE_CHAT_MESSAGE_MENU_OPENED:"LIVE_CHAT_MESSAGE_MENU_OPENED",LIVE_CHAT_MESSAGE_MENU_CLOSED:"LIVE_CHAT_MESSAGE_MENU_CLOSED",LIVE_CHAT_MESSAGE_HEIGHT_CHANGED:"LIVE_CHAT_MESSAGE_HEIGHT_CHANGED",LIVE_CHAT_MESSAGE_SENT:"LIVE_CHAT_MESSAGE_SENT",CLOSE_LIVE_CONTENT_VIEWER:"CLOSE_LIVE_CONTENT_VIEWER",LIVE_VIDEO_LOADING_TOGGLED:"LIVE_VIDEO_LOADING_TOGGLED",LIVE_MESSAGE_ALERT_REQUESTED:"LIVE_MESSAGE_ALERT_REQUESTED",LIVE_BLOCK_COMMENT_AND_CHAT_REMOVE_REQUESTED:"LIVE_BLOCK_COMMENT_AND_CHAT_REMOVE_REQUESTED",LIVE_ORIGINAL_MESSAGE_VIEW_REQUESTED:"LIVE_ORIGINAL_MESSAGE_VIEW_REQUESTED",LIVE_CHAT_BLOCK_CHANGED:"LIVE_CHAT_BLOCK_CHANGED",LIVE_STARTED_PLAYING:"LIVE_STARTED_PLAYING",LIVE_DESCRIPTION_TOGGLED:"LIVE_DESCRIPTION_TOGGLED",LIVE_CHAT_PIN_MESSAGE_TOGGLED:"LIVE_CHAT_PIN_MESSAGE_TOGGLED",LIVE_CHAT_MESSAGE_INPUT:"LIVE_CHAT_MESSAGE_INPUT"},g="PREVIEW",f="ON_AIR",b="VOD",v=i.Collection.extend({model:r}),A=i.Model.extend({initialize:function(e,t){this._contentType=t.contentType,this._bandData=t.bandData,this._liveModel=t.liveModel,this._vodModel=t.vodModel,this._bandNo=this._bandData.getBandCore().bandNo,this._liveId=this._liveModel?this._liveModel.getLiveId():this._vodModel.getLiveVodLiveId(),this._liveStatus=this._contentType===g?l.PREVIEW:l.LOADING,this._controllable=!!this._liveModel&&this._liveModel.isLiveCreatorMe(),this._messageCollection=new v([]),this._video={offset:0,updated:0,error:!1},this._chatController=this._buildChatController(this._liveModel,this._messageCollection,this._bandData),this._broadcastController=this._buildBroadcastController(this._liveModel,this._bandData,this._controllable),this._vodController=this._buildVodController(this._vodModel,this._messageCollection,this._bandData),this._profileMenuController=this._buildLiveProfileMenuController(),this._messageMenuController=this._buildLiveMessageMenuController()},destroyLiveContent:function(){t.each([this._chatController,this._broadcastController,this._vodController,this._profileMenuController,this._messageMenuController],(function(e){e&&!e.isDestroyed()&&e.destroy()}))},closeLiveContentViewer:function(){this.trigger(_.CLOSE_LIVE_CONTENT_VIEWER)},startWatchingLiveContent:function(){this.isOnAirLiveContent()&&(this.connectLiveContentChat(),this._broadcastController.startWatchingLive())},stopWatchingLiveContent:function(){this.isOnAirLiveContent()&&(this._chatController.closeLiveChat(),this._broadcastController.stopWatchingLive())},startLiveContentBroadcasting:function(){this.isPreviewLiveContent()&&this._broadcastController.startLiveBroadcasting()},stopLiveContentBroadcasting:function(e){!this.isLiveContentEnded()&&this.isOnAirLiveContent()&&this._broadcastController.stopLiveBroadcasting(e)},validateLiveContent:function(){this.isLiveContentEnded()||!this.isPreviewLiveContent()&&!this.isOnAirLiveContent()||this._broadcastController.validateLiveBroadcasting()},checkLiveContentBandJoin:function(){this._bandData.resetBandDataState(),this._bandData.loadBandData().then(t.bind((function(){this._bandData.isUserJoinApplied()?this.trigger(_.LIVE_BAND_JOIN_STATUS_CHANGED):this._bandData.canJoin()||this._liveModel.fetchLiveAfterOnLive().then(t.bind((function(){this.trigger(_.LIVE_BAND_JOIN_STATUS_CHANGED),this.connectLiveContentChat()}),this))}),this))},setLiveContentStatus:function(e){this._liveStatus=e,e===l.STARTING&&(this._contentType=f,this.startWatchingLiveContent()),this.trigger(_.LIVE_STATUS_CHANGED,e),e===l.PLAYING&&this.trigger(_.LIVE_STARTED_PLAYING)},updateLiveContentVideoOffset:function(e){!t.isFinite(e)||e<=0||(this._video.updated=Date.now(),this._video.offset=e,this._video.error=!1,this._updateLiveStatusPlaying(),this.isVodLiveContent()&&this._vodController.updateLiveVodVideoOffset(e))},handleLiveContentVideoError:function(){var e=Date.now(),t=this._video.updated,n=this._video.offset;this._video.updated=e,this._video.offset=e-t+n,this._video.error=!0,this.validateLiveContent()},_updateLiveStatusPlaying:function(){this._liveStatus!==l.STARTING&&this._liveStatus!==l.LOADING||!this._video.updated||!this._vodController&&this._chatController.isLiveChatConnectWait()||this.setLiveContentStatus(l.PLAYING)},isPreviewLiveContent:function(){return this._contentType===g},isOnAirLiveContent:function(){return this._contentType===f},isVodLiveContent:function(){return this._contentType===b},isStreamerModeLiveContent:function(){return this._controllable},getLiveContentStatus:function(){return this._liveStatus},getLiveContentCurrentVideoOffset:function(){var e=this._video.error?0:Date.now()-this._video.updated;return this._video.offset+e},isLiveContentEnded:function(){switch(this._liveStatus){case l.ENDED:case l.FORCE_ENDED:case l.PREVIEW_TIME_OVER:return!0;default:return!1}},getLiveContentEndMessage:function(){return this._broadcastController?this._broadcastController.getLiveEndMessage():null},getLiveContentBandData:function(){return this._bandData},getLiveContentBandNo:function(){return this._bandNo},getLiveContentLiveId:function(){return this._liveId},getLiveContentLiveModel:function(){return this._liveModel},getLiveContentVodModel:function(){return this._vodModel},getLiveContentExpiresAt:function(){return this._vodModel?this._vodModel.getLiveVodExpiresAt():null},getLiveContentAuthor:function(){return this._liveModel?this._liveModel.getLiveCreator():this._vodModel.getLiveVodAuthor()},getLiveContentCreator:function(){return this._liveModel?this._liveModel.getLiveCreator():this._vodController.getLiveVodCreator()},getLiveContentDescription:function(){return this._liveModel?this._liveModel.getLiveDescription():null},getLiveContentViewerCount:function(){return this._liveModel?this._liveModel.getLiveViewerCount():null},getLiveContentMaxRunningTimeMins:function(){return(this._liveModel?this._liveModel.getLiveMaxRunningTimeMins():null)||0},isChatEnabledLiveContent:function(){return!!this._liveModel&&this._liveModel.useChannelMessageLive()},isChatAvailableLiveContent:function(){return this.isChatEnabledLiveContent()&&this._chatController.isLiveChatConnected()&&this._liveStatus===l.PLAYING},isChatUnAvailableLiveContent:function(){return this.isChatEnabledLiveContent()&&this._chatController.isLiveChatConnectFailed()&&this._liveStatus===l.PLAYING},getLiveContentChatConnectFailedReason:function(){return this._chatController?this._chatController.getLiveChatConnectFailedReason():null},isChatMessageEnabledLiveContent:function(){return this.isChatEnabledLiveContent()||this.isVodLiveContent()&&this._vodController.isLiveVodMessageEnabled()},isChatMessageAvailableLiveContent:function(){return this.isChatAvailableLiveContent()||this.isVodLiveContent()&&this._vodController.isLiveVodMessageEnabled()},isLiveContentCreatorProfileMenuEnabled:function(){var e=this._liveModel?this._liveModel.getLiveMe():null;return!(!this._liveModel||!e||this._liveModel.isLiveCreatorMe())&&(e.isPageProfileContentAuthor()||e.isLeaderContentAuthor()||e.isColeaderContentAuthor())},isLiveContentMessageProfileMenuEnabled:function(e){var t=this._liveModel?this._liveModel.getLiveMe():null;return!(!this._liveModel||!t||t.isSameMemberKeyContentAuthor(e))&&(this._liveModel.isLiveCreatorMe()||t.isPageProfileContentAuthor()||t.isLeaderContentAuthor()||t.isColeaderContentAuthor())},isLiveContentChatBlockedUser:function(e){return!!this._chatController&&this._chatController.isLiveChatBlockedUser(e)},isOnAirChatBlockedLiveContent:function(){return!!this._chatController&&this._chatController.isChatBlockedLiveChat()},isPageBandChatBlockedLiveContent:function(){return!!this._chatController&&this._chatController.isPageBlockedLiveChat()},isGroupBandChatBlockedLiveContent:function(){return!!this._chatController&&this._chatController.isBandBlockedLiveChat()},isChatBlockedLiveContent:function(){return!!this._chatController&&this._chatController.isBlockedLiveChat()},canOffLiveContent:function(){return this._controllable&&!!this._liveModel&&this._liveModel.isLiveCreatorMe()&&this._liveModel.getLiveMe().isOffLivePermittedContentAuthor()},canUploadLiveContent:function(){return this._controllable&&this._bandData.isPostingPermitted()&&!!this._liveModel&&this._liveModel.getLiveMe().isUploadLivePermittedContentAuthor()},canPinLiveContentChatMessage:function(){return!!this._liveModel&&this._liveModel.getLiveMe().isPinLiveChatMessagePermittedContentAuthor()},canHideLiveContentChatMessage:function(){return this._liveModel?this._liveModel.getLiveMe().isHideLiveChatMessagePermittedContentAuthor():this._bandData.canHideLiveVodMessage()},canRecoverHiddenLiveContentChatMessage:function(){return this._liveModel?this._liveModel.getLiveMe().isHideLiveChatMessagePermittedContentAuthor():this._bandData.canRecoverHiddenLiveVodMessage()},canViewLiveContentViewingMember:function(){return!(!this._liveModel||this.isLiveContentEnded())&&this._liveModel.getLiveMe().isViewLiveViewingMemberPermittedContentAuthor()},hasLiveContentPinMessage:function(){return!!this._chatController&&this._chatController.hasLiveChatPinMessage()},getLiveContentPinMessage:function(){return this._chatController?this._chatController.getLiveChatPinMessage():null},getLiveContentMessageCollection:function(){return this._messageCollection},isEmptyLiveContentMessageCollection:function(){return this._messageCollection.isEmpty()},getOnAirLiveContentUser:function(){return this._liveModel?this._liveModel.getLiveMe():null},getLiveContentProfileMenuController:function(){return this._profileMenuController},getLiveContentMessageMenuController:function(){return this._messageMenuController},notifyLiveContentChatSectionSizeChanged:function(){this.trigger(_.LIVE_CHAT_SECTION_SIZE_CHANGED)},notifyLiveContentChatMessageMenuOpened:function(){this.trigger(_.LIVE_CHAT_MESSAGE_MENU_OPENED)},notifyLiveContentChatMessageMenuClosed:function(){this.trigger(_.LIVE_CHAT_MESSAGE_MENU_CLOSED)},notifyLiveContentChatMessageHeightChanged:function(e){this.trigger(_.LIVE_CHAT_MESSAGE_HEIGHT_CHANGED,e)},notifyLiveContentPreviewTimeOver:function(){this.setLiveContentStatus(l.PREVIEW_TIME_OVER)},notifyLiveContentChatStatusChanged:function(){this._liveStatus===l.PLAYING&&this.trigger(_.LIVE_CHAT_CONNECT_STATUS_CHANGED),this._updateLiveStatusPlaying()},notifyLiveContentChatPinMessageChanged:function(){this.trigger(_.LIVE_CHAT_PIN_MESSAGE_CHANGED)},notifyLiveContentFetchedAfterOnLive:function(){this.trigger(_.LIVE_FETCHED_AFTER_ON_LIVE)},notifyLiveContentViewerCountUpdated:function(){this.trigger(_.LIVE_VIEWER_COUNT_UPDATED)},notifyLiveContentChatMessageSent:function(){this.trigger(_.LIVE_CHAT_MESSAGE_SENT)},notifyLiveContentChatMessageInput:function(){this.trigger(_.LIVE_CHAT_MESSAGE_INPUT)},notifyLiveContentVideoLoadingToggled:function(e){this.trigger(_.LIVE_VIDEO_LOADING_TOGGLED,e)},notifyLiveContentChatBlockChanged:function(){this.trigger(_.LIVE_CHAT_BLOCK_CHANGED)},notifyLiveContentDescriptionToggled:function(){this.trigger(_.LIVE_DESCRIPTION_TOGGLED)},notifyLiveContentChatPinMessageToggled:function(){this.trigger(_.LIVE_CHAT_PIN_MESSAGE_TOGGLED)},requestLiveContentMessageAlert:function(e){this.trigger(_.LIVE_MESSAGE_ALERT_REQUESTED,e)},requestLiveContentApiErrorAlert:function(e){var n=m.get(e,"result_data.message",IM("ui.alert.temporary_error"));this.requestLiveContentMessageAlert(t.escape(n))},requestLiveContentCommentAndChatBlockRemove:function(e){this.trigger(_.LIVE_BLOCK_COMMENT_AND_CHAT_REMOVE_REQUESTED,e)},requestLiveContentOriginalMessageView:function(e){this.trigger(_.LIVE_ORIGINAL_MESSAGE_VIEW_REQUESTED,e)},sendLiveContentChatMessage:function(e){return this._chatController.sendLiveChatMessage(e)},pinLiveContentChatMessage:function(e){this._chatController.pinLiveChatMessage(e)},unpinLiveContentChatMessage:function(e){this._chatController.unpinLiveChatMessage(e)},hideLiveContentChatMessage:function(e){this.isVodLiveContent()?this._vodController.hideLiveVodMessage(e):this._chatController.hideLiveChatMessage(e)},unhideLiveContentChatMessage:function(e){this.isVodLiveContent()?this._vodController.showHiddenLiveVodMessage(e):this._chatController.unhideLiveChatMessage(e)},blockLiveContentChatUser:function(e){return this._chatController.blockLiveChatUser(e)},unblockLiveContentChatUser:function(e){return this._chatController.unblockLiveChatUser(e)},connectLiveContentChat:function(){this._chatController.connectLiveChat()},_buildChatController:function(e,t,n){return e?d.buildLiveChatController({liveViewerModel:this,liveModel:e,messageCollection:t,bandData:n}):null},_buildBroadcastController:function(e,t,n){return e?u.buildLiveBroadcastController({liveViewerModel:this,liveModel:e,bandData:t,controllable:n}):null},_buildVodController:function(e,t,n){return e?c.buildLiveVodController({liveViewerModel:this,vodModel:e,messageCollection:t,bandData:n}):null},_buildLiveProfileMenuController:function(){return h.buildLiveProfileMenuController({liveViewerModel:this})},_buildLiveMessageMenuController:function(){return p.buildLiveMessageMenuController({liveViewerModel:this})}});return A.EVENT=_,A.buildPreviewLiveViewerModel=function(e){return e.fetchLivePreview().then((function(e){return new A(null,{contentType:g,bandData:e.getLiveBandData(),liveModel:e})}))},A.buildOnAirLiveViewerModel=function(e,t){return o.get(e).loadBandData().then((function(){return s.buildEmptyLiveModel(e,t).fetchLive().then((function(t){return new A(null,{contentType:f,bandData:o.get(e),liveModel:t})}))}))},A.buildVodLiveViewerModel=function(e,t,n){return o.get(e).loadBandData().then((function(){return a.buildLiveVodModel(e,t,n).then((function(t){return new A(null,{contentType:b,bandData:o.get(e),vodModel:t})}))}))},A}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(21);return{getTargetLanguage:function(){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_target_language"})},setTargetLanguage:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1.0.0/set_target_language",data:{language_code:e},method:"POST"})},getMyLanguages:function(){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_my_languages"})},setMyLanguages:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1.0.0/set_my_languages",data:{language_codes:e},method:"POST"})},translatePost:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1.0.0/translate_post",data:e})},translateComment:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/translate_comment",data:e})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent">\n    <% if (!!headerTitle) { %>\n    <div class="modalHeader">\n        <h5 class="title"><%= headerTitle %></h5>\n    </div>\n    <% } %>\n\n    <div class="modalBody">\n        <% if (!!bodyTitle) { %>\n        <div class="headingMsg"><%= bodyTitle %></div>\n        <% } %>\n        <div class="msgWrap">\n            <% if (!_.isArray(bodyDesc)) { // 단건 설명 %>\n            <p class="pText"><%= bodyDesc %></p>\n            <% } else { // 목록형 설명 %>\n            <ul class="msgList gMat10">\n                <% _.each(bodyDesc, function(eachDesc) { %>\n                <li class="msgListItem"><%= eachDesc %></li>\n                <% }); %>\n            </ul>\n            <% } %>\n        </div>\n    </div>\n\n    <div class="modalFooter">\n        <button type="button" class="uButton -confirm _btnConfirm"><%= confirm %></button>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1309),s=n(486),a=n(54),r=n(659),l=n(1310),c=n(155),d=n(510),u=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DGroupBandJoinVerificationEmailSendLayerView"},template:t.template(o),templateContext:function(){return{domains:this._domains,verifiedEmailId:this._verifiedEmailId,verifiedDomain:this._verifiedDomain}},ui:{emailId:"#emailId",selectDomain:"._selectDomain",btnCancel:"._btnCancel",btnNext:"._btnNext"},events:{"keyup @ui.emailId":"_toggleNextButton","click @ui.btnCancel":"_cancelSendingAuthEmail","click @ui.btnNext":function(e){var n=this.getUI("emailId").val()+"@"+this.getUI("selectDomain").find(":selected").val();r.checkMemberEmail(this._bandNo,n).done(t.bind((function(){this._sendAuthEmail(n)}),this)).fail(t.bind((function(e,t,i){if(1070==e.result_code){var o=d.openLayer({bodyDesc:IM("bandjoin.join_application.send_verification_email.confirm.already_used_email")});this.listenToOnce(o,d.EVENTS.CONFIRM,(function(){this._sendAuthEmail(n)})),this.listenToOnce(o,d.EVENTS.CANCEL,this._cancelSendingAuthEmail)}else alert(e.result_data.message)}),this))}},initialize:function(e){this._loading=!0,this._bandNo=e.bandNo,this._verifiedEmailId="",this._verifiedDomain="",this._domains=[],this._bandData=c.get(this._bandNo)},onAttach:function(){$.when(r.getBandEmailVerification(this._bandNo),this._bandData.loadBandData()).then(t.bind((function(e){this._loading=!1,this._domains=e.email_verification_domains||[],this._bandData.canJoin()?this.render():r.getMemberEmail(this._bandNo).then(t.bind((function(e){if(e&&e.email){var t=e.email.split("@");this._verifiedEmailId=t[0],this._verifiedDomain=t[1]}this.render()}),this))}),this))},_toggleNextButton:function(){this.getUI("emailId").val().trim().length>0?this.getUI("btnNext").removeClass("-disabled").prop("disabled",!1):this.getUI("btnNext").addClass("-disabled").prop("disabled",!0)},_sendAuthEmail:function(e){a.sendAuthEmail(e).then(t.bind((function(){var t=l.openAsLayer(e);this.listenToOnce(t,"confirm",(function(e){this.trigger("apply:next",e),this.destroy()}))}),this))},_cancelSendingAuthEmail:function(){this.trigger("cancel"),this.destroy()}});return u.openAsLayer=function(e){var t=new u({bandNo:e});return s.open(t),t},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(2),s=n(4),a=n(2222),r=n(486),l=n(1012),c=n(1319),d=n(2226),u=n(2227),h=n(1556),p=n(1147),m=n(154),_=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DSelectLocationLayerView",role:"dialog"},template:i.template(a),ui:{content:"._content",btnClose:"._btnClose"},events:{"click @ui.btnClose":"destroy"},regions:{content:"@ui.content"},childViewTriggers:{locationSelected:"locationSelected"},onRender:function(){this.showChildView("content",l.view({loadingSize:l.Size.MEDIUM,middleClass:l.MiddleClass.AREA_VERTICAL_MIDDLE,className:"-h360"}))},startGoogleMap:function(e){m.wrapActivePromise(o.when(c.requestCurrentPosition(),d.load()),this).then(i.bind((function(t,n){var i=u.buildDSelectLocationContentView({currentPosition:h.fromCoordinates(t.coords),locationObject:e,googleMaps:n});this.showChildView("content",i)}),this)).fail(i.bind((function(e){this.showChildView("content",p.html(e,"-h360"))}),this))}});return _.asyncOpenDSelectLocationLayer=function(e){return t||(c.isSupportGeoLocation()?t=c.checkLocationPersonalInfoAgreement().then((function(){var t=new _;return r.openWithoutHiding(t),t.startGoogleMap(e),t})).always((function(){t=null})):(alert(IM("geolocation.msg.browser_geolocation_unsupport")),o.Deferred().reject()))},_}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(2),n(0),n(4),n(189),n(1342),n(56)],void 0===(o=function(e,t,n,i,o){var s=n.Behavior.extend({events:{"customScroll:init":"onCustomScrollInit","customScroll:destroy":"onCustomScrollDestroy"},onCustomScrollInit:function(e){e&&this.onCustomScrollDestroy(),this.view._customScroller=this.scroller=this.$el.find(".nano").nanoScroller(),this.scroller.nanoScroller({flash:!0,iOSNativeScrolling:!0,preventPageScrolling:!0})},onCustomScrollDestroy:function(){this.scroller&&(this.scroller.nanoScroller({destroy:!0}),this.scroller=null)},onBeforeDetach:function(){this.onCustomScrollDestroy()}});return i.CustomScrollBehavior=s,s}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(516),s=n(486),a=n(833),r=Promise.resolve().then(n.t.bind(null,611,7)).then((function(e){t=e.default}));return{openDCommentMediaViewer:function(e){var n={result_data:e.resultData,bandNo:e.bandNo,goPostSupport:!1,profileViewSupport:!1,showUserInfo:!1,moreOptionList:[a.MEDIA_MORE_OPTION.SAVE_TO_ALBUM],openIndex:e.openIndex};r.then(i.bind((function(){e.view.isDestroyed()||(e.video?this._openVideo(e,n):t.openDPhotoVideoImageViewer(n))}),this))},_openVideo:function(e,n){var i=e.bandNo,a=e.view,r=e.contentKey,l=t.buildImageViewer(n);a.listenTo(l,t.EVENT.FETCH_VIDEO_URL,(function(e,t,n,s){o.getVideoUrlByComment(i,r.toApiParams(!0)).then((function(t){l.setVideoUrlFromAPI(t,e)}))})),s.open(l)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0);return n(4).Behavior.extend({options:{uiToggleEventName:"toggleControlUI"},initialize:function(){this._controlTimer=void 0},onRender:function(){this.$el.on("mouseenter",t.bind(this._showControls,this,5e3)),this.$el.on("mousemove",t.bind(this._showControls,this,5e3)),this.$el.on("mouseleave",t.bind(this._showControls,this,1e3))},_showControls:function(e){this._controlTimer&&(clearTimeout(this._controlTimer),this._controlTimer=void 0),this._controlTimer=setTimeout(t.bind((function(){this._hideControls()}),this),e),this.view.trigger(this.options.uiToggleEventName,!0)},_hideControls:function(){this._controlTimer=void 0,this.view.trigger(this.options.uiToggleEventName,!1)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21);return{getApiClient:function(){return this.apiClient||(this.apiClient=t.getLoginV1Client()),this.apiClient},getEnv:function(e){return this.getApiClient().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_env",data:{names:e}})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1396),s=(n(551),n(26)),a=n(522),r=n(1013),l=n(1397),c=n(1145),d=n(22),u=n(638),h=n(509),p="POST",m="PHOTO",_=i.View.extend({attributes:function(){var e={"data-viewname":"DEmotionMemberFaceItemView"};return this.model.isMutedActorEmotion()&&(e.style="opacity:0.3;"),e},options:{profileImageHelper:null},tagName:"li",ui:{profileImage:"._profileImage"},events:function(){return this.options.profileImageHelper.canClickMemberProfile()?{"click ._actorFace":"_onClickMemberProfile"}:{}},template:t.template(l),templateContext:function(){return{clickAvailable:this.options.profileImageHelper.canClickMemberProfile(),EmotionType:a,isPageProfile:d.MEMBER_TYPE.PAGE_PROFILE===this.model.get("actorMemberType")}},onDomRefresh:function(){this.getUI("profileImage").on("error",t.bind((function(e){$(e.currentTarget).remove()}),this))},_onClickMemberProfile:function(){return this.options.profileImageHelper.clickMemberProfileAction(),!1}}),g=i.View.extend({options:{useSetEmotion:!0,useShowEmotionList:!0,hideInput:!1},className:"faceAdd",attributes:{"data-viewname":"DEmotionView"},template:t.template(o),templateContext:function(){return{hideInput:this._hideInput,EmotionType:a}},ui:{selectFace:"._selectFace",giveMeFace:"._giveMeFace",viewFace:"._viewFace",actorFace:"._actorFace"},regions:{emotionFaceListRegion:{el:"._emotionFaceListRegion",replaceElement:!0}},childViewEvents:{"DEmotionSelectView:changeEmotion":function(e){this._closeEmotionSelectLayer(),this.trigger(g.EVENT.SET_EMOTION,e)}},setEmotionEvents:{"click @ui.selectFace":"_toggleEmoticonSelectView"},showEmotionListEvents:{"click @ui.viewFace":function(){this.collection.length>0&&this.trigger(g.EVENT.SHOW_EMOTION_LIST)}},events:function(){var e={};return this.options.useSetEmotion&&t.extend(e,this.setEmotionEvents),this.options.useShowEmotionList&&t.extend(e,this.showEmotionListEvents),e},initialize:function(e){this._hideInput=e.hideInput||!1,this._originType=e.originType,this._bandCore=e.bandCore,this._postNo=e.postNo,this._photoNo=e.photoNo,this._emotionTypeByViewer=e.emotionTypeByViewer,this._bandNo=this._bandCore.bandNo,this._hideInput||(this.addRegions({emoticonSelectViewRegion:{el:"._emoticonSelectViewRegion",replaceElement:!0}}),this.listenTo(s.getDGlobalChannel(),s.EVENT.HTML_CLICK,this._closeEmotionSelectLayer))},onRender:function(){var e=this._bandCore;this.collection.length>0&&this.showChildView("emotionFaceListRegion",new i.CollectionView({tagName:"ul",childView:_,childViewOptions:function(t){return{profileImageHelper:new c(t.getActorMemberProfile(),t.get("actorUserNo"),e)}},collection:this.collection,filter:function(e,t){return t<u.MAX_EMOTION_COUNT_FOR_SUMMARY_VIEW}}))},_toggleEmoticonSelectView:function(){var e=this.getRegion("emoticonSelectViewRegion");e.hasView()||t.defer(t.bind((function(){var t=null;null!=this._postNo?t=h.buildPostKey(this._postNo):null!=this._photoNo&&(t=h.buildPhotoKey(this._photoNo)),null!=t&&e.show(r.buildDEmotionSelectViewByContentKey({bandNo:this._bandNo,contentKey:t,emotionTypeByViewer:this._emotionTypeByViewer}))}),this))},_closeEmotionSelectLayer:function(){var e=this.getRegion("emoticonSelectViewRegion");null!=e&&e.hasView()&&e.empty()}});return g.EVENT={SET_EMOTION:"emotionView:setEmotion",SHOW_EMOTION_LIST:"emotionView:showEmotionList",OPEN_PROFILE_VIEW:"emotionView:openProfileView"},g.buildPostEmotionViewWithCollection=function(e,n){return new g(t.extend({collection:e,originType:p},n))},g.buildPhotoEmotionViewWithCollection=function(e,n){return new g(t.extend({collection:e,originType:m},n))},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(541);n(26);return new(i.Object.extend({UPDATED:"my_page_info:updated",initialize:function(){this._resetMyPageCount()},_resetMyPageCount:function(e){e||(e={}),this._myPageCount={bookmarkCount:e.bookmark_count||0,recruitingCount:e.recruiting_count||0,scheduleCount:e.schedule_count||0,isBookmarkCountless:e.is_bookmark_countless||!1,isScheduleCountless:e.is_schedule_countless||!1,bandApplicationCount:e.band_application_count||0,pageCount:e.page_count||0,myApplicationCommentSetCount:e.my_application_comment_set_count||0,isMyApplicationCommentSetCountless:e.is_my_application_comment_set_countless||!1,bandCollectionCount:e.band_collection_count||0,bandCollectionCountExist:t.has(e,"band_collection_count")}},isJoinQnARoomExist:function(){return this._myPageCount.myApplicationCommentSetCount>0},getJoinQnARoomCountText:function(){if(!this.isJoinQnARoomExist())return"";var e=this._myPageCount.myApplicationCommentSetCount+"";return this._myPageCount.isMyApplicationCommentSetCountless&&(e+="+"),e},fetchMyPageCount:function(){o.getMyPageInfo().then(t.bind((function(e){this._resetMyPageCount(e),this._triggerUpdatedEvent()}),this))},_triggerUpdatedEvent:function(){this.trigger(this.UPDATED,this.getMyPageCount())},getMyPageCount:function(){return t.clone(this._myPageCount)},increaseBookmarkCount:function(){this._myPageCount.bookmarkCount+=1,this._triggerUpdatedEvent()},decreaseBookmarkCount:function(){this._myPageCount.bookmarkCount-=1,this._triggerUpdatedEvent()},decreaseBandApplicationCount:function(){this._myPageCount.bandApplicationCount-=1,this._triggerUpdatedEvent()}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{CHANGE_PLAYING:"changePlaying",READY_PLAYING:"readyPlaying"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{VIDEO_PLAYER_PLAY:"videoPlayer:play",VIDEO_PLAYER_PAUSE:"videoPlayer:pause",OPEN_MEDIA:"openMedia"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(4),s=n(1408),a=n(1094),r=n(1005),l=n(159),c=o.View.extend({className:function(){return this.options.isReplyButTopMost?"sReplyList":""},behaviors:[l],template:i.template('<h1 class="gSrOnly">'+IM("discover.post.comment.title")+'</h1><div class="_commentListRegion"></div>'),regions:{commentListRegion:{el:"._commentListRegion",replaceElement:!0}},initialize:function(e){this._bandCore=e.bandCore,this._isReplyButTopMost=e.isReplyButTopMost,this._isCommentingPermitted=e.isCommentingPermitted,this._commentCollection=e.collection,this._shouldShowEmotionArea=1==e.forcedShowEmotionArea,this._replySupport=e.replySupport,this._muteIgnoredAuthorUserNo=e.muteIgnoredAuthorUserNo,this._isHiddenFilterIgnored=e.isHiddenFilterIgnored,this._canDownloadFile=e.canDownloadFile,this._canOpenMediaViewer=e.canOpenMediaViewer,this._canOpenSnippetUrl=e.canOpenSnippetUrl,this._canExpressEmotion=e.canExpressEmotion},onMessages:(t={},t[l.MSG.COMMENT_CHECK_REPLY_INPUT_OPENABLE]=function(e){this.spawn(l.MSG.COMMENTLIST_OPEN_REPLY_LIST_AND_REPLY_TO,e.generateViewIdentifiableData())},t),passMessages:function(){var e={};return e[l.MSG.COMMENT_CHECK_REPLY_INPUT_OPENABLE]=l.MSG.PROPAGATION_STOP,e}(),onAttach:function(){this._commentCollectionView=a.buildDCommentCollectionView({isCommentingPermitted:this._isCommentingPermitted,isReplyButTopMost:this._isReplyButTopMost,replySupport:this._replySupport,canUsePaging:!1,canExpressEmotion:this._canExpressEmotion,canOpenMediaViewer:this._canOpenMediaViewer,canDownloadFile:this._canDownloadFile,canOpenSnippetUrl:this._canOpenSnippetUrl}),this.showChildView("commentListRegion",this._commentCollectionView),this._populateFetchedCollection(this._commentCollection)},_populateFetchedCollection:function(e){if(!this._commentCollectionView.isDestroyed()){var t=this._convertCommentCollectionToViewArray(e);this._commentCollectionView.populateSimpleCollection(t,e.getTotalCount())}},_convertCommentCollectionToViewArray:function(e){var t=e.getContentKeyButCommentId();return e.map(i.bind((function(e){return r.buildBySimpleDComment(e,this._bandCore,t,this._shouldShowEmotionArea,this._muteIgnoredAuthorUserNo,this._isHiddenFilterIgnored)}),this))}});return c.buildDSimpleCommentListView=function(e){var t=e.bandCore,n=s.buildSimpleCommentCollection({bandNo:t.bandNo,contentKeyButCommentId:e.contentKeyButCommentId});return n.populateSimpleCommentData({comments:e.featuredComments}),new c({bandCore:t,collection:n,isReplyButTopMost:e.isReplyButTopMost,isCommentingPermitted:e.isCommentingPermitted,forcedShowEmotionArea:e.forcedShowEmotionArea,replySupport:e.replySupport,muteIgnoredAuthorUserNo:e.muteIgnoredAuthorUserNo,isHiddenFilterIgnored:e.isHiddenFilterIgnored,canDownloadFile:e.canDownloadFile,canOpenMediaViewer:e.canOpenMediaViewer,canOpenSnippetUrl:e.canOpenSnippetUrl,canExpressEmotion:e.canExpressEmotion})},c}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1289),s=n(9),a=n(82),r=n(164),l=n(572),c=n(174),d=n(1111),u=n(486),h=n(495),p=n(487),m=n(534),_=n(13),g=n(155),f={EDIT_PROFILE:"edit_profile",SEND_MESSAGE:"send_message",BAN_MEMBER:"ban_member",BLOCK_COMMENT_AND_CHAT:"block_comment_and_chat",GOTO_SEARCH_MEMBER_CONTENTS:"goto_search_member_contents",BAN_CHAT:"ban_chat",VIEW_JOIN_INFO:"view_join_info",REPORT_MEMBER_PROFILE:"report_member_profile",UNMUTE_MEMBER:"unmute_member"},b=i.View.extend({options:{availableFunctions:[]},behaviors:function(){var e=this.options.bandData.getBandCore().showProfileAsPageStyle()?h.SCENE.FOLLOW_PROFILE:h.SCENE.MEMBER_PROFILE;return[{behaviorClass:h,sceneId:e},p]},className:"lyWrap",attributes:{"data-viewname":"DProfileView"},template:t.template(o),templateContext:function(){var e=c.makePhoneNumberWithCountryCodeIfDifferentRegion(this.model.get("cellphone"));this.model.get("me")&&!t.isEmpty(this.model.get("cellphone"))&&(e=m.transformInternationalPhoneNumber(e));var n=a.makeGifSupportedProfileUrl(this.model.get("profileImageUrl"),r.s276_gif);return{msg_modelFetched:this._bandData.isBandDataStateLoaded(),profileImageThumbnail:n,profileInnerClass:a.makeProfileInnerClass(n),showLeaderTermAsManager:this._bandData.getBandCore().showBandLeaderTermAsManager(),createdAtText:s.format.date(this.model.get("createdAt"),"medium"),birthdayText:l.makeBirthdayLabel(this.model.get("birthday"),this.model.get("isLunar")),cellphoneText:e,pageStyle:this._bandData.getBandCore().showProfileAsPageStyle(),memberDisabledStatusText:this._getMemberDisabledStatusText(),showBtnEditProfile:this._isUseAvailableFunction(f.EDIT_PROFILE)&&this.model.isMyProfile(),showBtnSendMessage:this._isUseAvailableFunction(f.SEND_MESSAGE)&&this.model.canSendMessage()&&!this.model.isMyProfile(),showBtnGoToSearchMemberPost:this._isUseAvailableFunction(f.GOTO_SEARCH_MEMBER_CONTENTS)&&this._bandData.canAccessSearchMemberPostWebPage(),showBtnGoToSearchMemberComment:this._isUseAvailableFunction(f.GOTO_SEARCH_MEMBER_CONTENTS)&&!this._bandData.canAccessSearchMemberPostWebPage()&&this._bandData.canAccessSearchMemberCommentWebPageOfUser(this.model.isLoginUserBandMemberProfile()),showBtnUnmuteMember:this._isUseAvailableFunction(f.UNMUTE_MEMBER)&&this.model.isMuted()&&this.model.canMuteMember(),showBtnBlockCommentAndChat:this._isUseAvailableFunction(f.BLOCK_COMMENT_AND_CHAT)&&this.model.canBlockCommentAndChat(),showBtnBanMember:this._isUseAvailableFunction(f.BAN_MEMBER)&&this.model.canBanMember(),showBtnBandChat:this._isUseAvailableFunction(f.BAN_CHAT)&&this.model.canBanChat()&&this.model.get("isMember"),showBtnJoinInfo:this._isUseAvailableFunction(f.VIEW_JOIN_INFO)&&this.model.canViewJoinInfo(),showBtnReportMemberProfile:this._isUseAvailableFunction(f.REPORT_MEMBER_PROFILE)&&!this.model.get("me")&&_.getUserData().getUserNo()!==this.model.getBandMemberProfileUserNo()&&this._bandData.canReportMember()}},ui:{btnClose:"._btnClose",imgProfile:"._imgProfile",btnEditProfile:"._btnEditProfile",btnSendMessage:"._btnSendMessage",btnGotoSearchMemberContent:"._btnGotoSearchMemberContent",unmuteMember:"._unmuteMember",btnManageMember:"._btnManageMember",lyManageMember:"._lyManageMember",btnBanChat:"._btnBanChat",btnBanMember:"._btnBanMember",btnBlockCommentAndChat:"._btnBlockCommentAndChat",btnJoinInfo:"._btnJoinInfo",btnReportMemberProfile:"._btnReportMemberProfile"},modelEvents:{change:"render"},events:{"click @ui.btnClose":"destroy","click @ui.btnManageMember":function(e){this.options.bandData.getBandCore().showProfileAsPageStyle()||this._sendGroupBandProfileItemClickLog("option"),this._showMemberManagementLayer()},"click @ui.imgProfile":function(e){this.options.bandData.getBandCore().showProfileAsPageStyle()||this._sendGroupBandProfileItemClickLog("profile_photo"),this._openProfilePhoto()},"click @ui.btnSendMessage":function(){this.options.bandData.getBandCore().showProfileAsPageStyle()||this._sendGroupBandProfileItemClickLog("chat"),this.trigger(f.SEND_MESSAGE)},"click @ui.btnGotoSearchMemberContent":function(){this.options.bandData.getBandCore().showProfileAsPageStyle()?this.jplClick(p.CLASSIFIER.VIEW_COMMENTS):this._sendGroupBandProfileItemClickLog("view_post"),this.trigger(f.GOTO_SEARCH_MEMBER_CONTENTS)},"click @ui.unmuteMember":function(){this.trigger(f.UNMUTE_MEMBER)},"click @ui.btnEditProfile":function(){this.options.bandData.getBandCore().showProfileAsPageStyle()&&this.jplClick(p.CLASSIFIER.PROFILE_SETTING),this.trigger(f.EDIT_PROFILE)},"click @ui.btnBanChat":function(){this.trigger(f.BAN_CHAT)},"click @ui.btnBanMember":function(){this.trigger(f.BAN_MEMBER)},"click @ui.btnBlockCommentAndChat":function(){this.trigger(f.BLOCK_COMMENT_AND_CHAT)},"click @ui.btnJoinInfo":function(){this.trigger(f.VIEW_JOIN_INFO),this.getUI("lyManageMember").hide()},"click @ui.btnReportMemberProfile":function(){this.trigger(f.REPORT_MEMBER_PROFILE),this.getUI("lyManageMember").hide()}},initialize:function(e){this._bandData=e.bandData,this.listenTo(this._bandData,g.UPDATE_EVENT.ANY,this.render)},onAttach:function(){this.options.bandData.getBandCore().showProfileAsPageStyle()?this.jplSceneEnter(p.CLASSIFIER.FOLLOW_PROFILE):this.jplSceneEnter(p.CLASSIFIER.MEMBER_PROFILE,{user_no:this.model.getBandMemberProfileUserNo(),band_no:this._bandData.getBandNo()})},_showMemberManagementLayer:function(){this.getUI("lyManageMember").toggle()},_openProfilePhoto:function(){if(this._bandData.canOpenProfilePhoto()){var e=d.buildDProfilePhotoView(this.model.get("profileImageUrl"),this.model.get("name"));u.open(e)}},_sendGroupBandProfileItemClickLog:function(e){this.options.bandData.getBandCore().showProfileAsPageStyle()||this.jplClick(p.CLASSIFIER.PROFILE_ITEM,{item:e})},_isUseAvailableFunction:function(e){return t.contains(this.options.availableFunctions,e)},_getMemberDisabledStatusText:function(){var e=this._bandData.getBandCore();if(this.model.isReallyNotMember()){if(e.showMemberLeavedStateOnProfile())return IM("web.profile.leave");if(this._bandData.canShowMemberUnsubscribedStateOnProfile())return IM("web.profile.unsubscribed_user")}return null}});return b.AVAILABLE_FUNCTIONS=f,b}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(1022);function s(e){if(i.isEmpty(e))return[o.NO_ONE];if(i.contains(e,"modify_open_cellphone_roles_only_leader"))return i.without(o.ALL_MEMBER_ROLES,o.ANYONE,o.UNTIL_COLEADER);if(i.contains(e,"modify_open_cellphone_roles_until_coleader"))return i.without(o.ALL_MEMBER_ROLES,o.ANYONE);if(i.contains(e,"modify_open_cellphone_roles_anyone"))return o.ALL_MEMBER_ROLES.concat([]);throw new Error("Invalid Argument")}t.getAllSelectableOpenCellphoneMemberRoles=s,t.getAcceptableOpenCellphoneMemberRoles=function(e,t){var n=s(e),a=o.parseMemberRoles(t);return i.contains(n,a)?a:n[0]}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(510),a=n(513),r=n(564),l=n(519),c=n(26),d=n(153),u=n(162),h=n(544),p=n(158);function m(e,t,n){a.openGet({windowURL:e,windowName:t.replace(/\-/g,"_"),width:400,height:644,resizable:1,centerBrowser:!0,params:n}),window.getChatEventListener=function(){return c.getDGlobalChannel()}}return o.Object.extend({open:function(e,t,n){var i=d.GROUP_BAND_CHATTING_ROOM.makeUrl({band_no:e,channel_id:t}),o="band_chat_"+t,s={};n&&(s.withJoin="true"),m(i,o,s)},openWithGroupCall:function(e,t,n){m(d.GROUP_BAND_CHATTING_ROOM.makeUrl({band_no:e,channel_id:t}),"band_chat_"+t,{groupCall:n})},openRecruitingBandChattingRoom:function(e,t){m(h.LFG_BAND_CHAT.makeUrl({band_no:e,channel_id:t}),"band_chat_"+t,{})},talkToPageBand:function(e){l.talkToPage(e).then(t.bind((function(n){var i=n.channel,o=i.band;this._openChatConfirmLayer(IM("page_band.message.open_chat_confirm.desc",{name:t.escape(o.name)}),t.bind((function(){this.openPageBandChatChannel(e,i.channel_id)}),this))}),this))},talkToPageBandSubscriber:function(e,n,i){l.talkToPageSubscriber(e,n).then(t.bind((function(n){var o=n.channel;this._openChatConfirmLayer(IM("chat.message.confirm_open",{count:0,name:t.escape(i)}),t.bind((function(){this.openPageBandChatChannel(e,o.channel_id)}),this))}),this))},_openChatConfirmLayer:function(e,t){s.openLayer({headerTitle:IM("chat_open.title"),bodyDesc:p.nl2br(e),confirm:IM("chat_open.btn.open"),cancel:IM("ui.label.cancel")}).once(s.EVENTS.CONFIRM,t)},openPageBandChatChannel:function(e,t){m(u.PAGE_BAND_MESSAGE_CHANNEL.makeUrl({band_no:e,channel_id:t}),"page_band_"+t,{})},startChattingWithUsers:function(e,n){var o=t.pluck(e,"userNo");r.Commands.createChannel(o,n).then(t.bind((function(o){this._openChatConfirmLayer(IM("chat.message.confirm_open",{count:e.length-1,name:i.escapeHTML(e[0].name)}),t.bind((function(){this.open(n,o.channelId)}),this))}),this),t.bind((function(i){1001===i.result_code&&s.openLayer({headerTitle:IM("chat_open.title"),bodyDesc:IM("web.chatroom.create.fail_by_deny"),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no")}).once(s.EVENTS.CONFIRM,t.bind((function(){l.SettingApi.unblock({band_no:n,blocked_user_no:o[0]}).then((function(){this.startChattingWithUsers(e,n)}))}),this))}),this))},startChattingWithGroupCall:function(e,n,o){var a=t.pluck(e,"userNo");r.Commands.createChannel(a,n).then(t.bind((function(s){this._openChatConfirmLayer(IM("chat.message.confirm_open",{count:e.length-1,name:i.escapeHTML(e[0].name)}),t.bind((function(){this.openWithGroupCall(n,s.channelId,o)}),this))}),this),t.bind((function(i){1001===i.result_code&&s.openLayer({headerTitle:IM("chat_open.title"),bodyDesc:IM("web.chatroom.create.fail_by_deny"),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no")}).once(s.EVENTS.CONFIRM,t.bind((function(){l.SettingApi.unblock({band_no:n,blocked_user_no:a[0]}).then((function(){this.startChattingWithGroupCall(e,n,o)}))}),this))}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="answerImageItem">\n    <img src="<%- thumbnailUrl %>" alt="<%- IM(\'ui.label.photo\') %>" class="_uploadedPhoto">\n    <button type="button" class="buttonDelete _photoDeleteButton"><span class="gSrOnly"><%- IM(\'ui.label.delete\') %></span></button>\n</span>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(1308),a=n(600),r=n(82),l=n(156),c=n(164),d=n(486),u=(n(518),n(507)),h=n(521),p=n(495),m=n(487),_=n(152),g=n(1002),f=n(540),b={CONFIRM:"CONFIRM"},v=t.template('<img src="<%- image %>" width="140" height="140" alt="<%- IM("photo") %>">'),A=o.View.extend({behaviors:[{behaviorClass:p,sceneId:p.SCENE.PROFILE_SETTING_NEW},m],options:{setDefaultProfileSetOfPage:!1,bandCore:null},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DProfileSetInputView"},template:t.template(s),templateContext:function(){return{setDefaultProfileSetOfPage:!!this.options.setDefaultProfileSetOfPage,saveButtonLabel:this._joining?{join:IM("band.join.form.submit_btn.label"),subscribe:IM("page_band.label.subscribe_long"),participate:IM("recruiting.joinable.band")}[this._bandCore.getJoinTermType()]:IM("ui.label.confirm")}},serializeData:function(){return{cid:this.cid,joining:this._joining,band:this._bandCore?this._bandCore:null,authorNameMaxLength:_.AUTHOR_NAME_MAX_LENGTH}},ui:{imageWrap:"._imageWrap",menuBtn:"._menuBtn",menuWrap:"._menuWrap",fileWrap:"._fileWrap",deletePhotoLink:"._deletePhotoLink",nameInput:"._nameInput",confirmBtn:"._confirmBtn",closeBtn:"._closeBtn",useProfileImageAgreementInfo:"._useProfileImageAgreementInfo",setDefaultProfileSetOfPageCheck:"._setDefaultProfileSetOfPageCheck"},events:{"click @ui.menuBtn":function(){this._toggleLayer(this.ui.menuWrap)},"click @ui.deletePhotoLink":function(e){e.preventDefault(),this._setImage(null)},"click @ui.confirmBtn":function(){var e=i.trim(this.ui.nameInput.val());e?(this._joining&&this._bandCore.isLoggingJoiningProfileSetLayer()&&this.jplClick(m.CLASSIFIER.PROFILE_JOIN_PAGE,{band_no:this._bandCore.bandNo}),this.trigger("DProfileSetInputView",b.CONFIRM,{name:e,profileImageUrl:this._profileImageUrl,setDefaultProfileSetOfPage:this.ui.setDefaultProfileSetOfPageCheck.is(":checked")})):alert(IM("web.profile.alert.input_name"))},"click @ui.closeBtn":"destroy",click:"_closeAllLayers"},initialize:function(e){this._name=e.name,this._profileImageUrl=e.profileImageUrl,this._bandCore=e.bandCore,this._joining=!!this._bandCore},onRender:function(){this.ui.nameInput.val(i.trim(this._name)),this._setImage(this._profileImageUrl)},onAttach:function(){this._createProfilePhotoUploader(),this._getPersonalInfoAgreementData(),this._joining&&this._bandCore.isLoggingJoiningProfileSetLayer()&&this.jplSceneEnter(m.CLASSIFIER.PROFILE_SETTING_NEW)},onBeforeDetach:function(){this._destroyProfilePhotoUploader()},_getPersonalInfoAgreementData:function(){return h.buildPersonalInfoAgreementData().fetchAgreementData().then(t.bind((function(e){e.isProfileImageCollectable()||this.getUI("useProfileImageAgreementInfo").show()}),this))},_setValuesWithPhoto:function(e){e&&this._setImage(e.url)},_setImage:function(e){var t=!!e;if(t){var n=r.makeGifSupportedProfileUrl(e,c.s276_gif);this.ui.imageWrap.html(v({image:n})).toggleClass("-gifProfileBg",l.isGif(n))}else this.ui.imageWrap.empty().removeClass("-gifProfileBg");this.ui.deletePhotoLink.parent().toggle(t),this._profileImageUrl=e},_toggleLayer:function(e){e.is(":visible")||t.defer(t.bind(e.show,e))},_closeAllLayers:function(e){this.isDestroyed()||this.ui.menuWrap.hide()},_createProfilePhotoUploader:function(){this._destroyProfilePhotoUploader(),this._profilePhotoUploader=a.createProfilePhotoUploader(this.ui.fileWrap,{autoUpload:!1}),this.listenTo(this._profilePhotoUploader,u.SELECT_FILES,(function(e){if(e.files[0].type.indexOf("gif")>-1)return this._profilePhotoUploader.setContinueAutoUpload(),!1;this._profilePhotoUploader.loadFileReaderResize(e.files[0]).then(t.bind((function(e){var n={title:IM("web.upload.title.profile_photo"),cropOptions:{}},i=g.build(e,n);this.listenTo(i,"crop:complete",(function(e){i.destroy(),f.uploadDataUriImage(e).then(t.bind((function(e){this._setValuesWithPhoto(e)}),this))})),this.listenTo(i,"crop:cancel",(function(){i.destroy()}),this)}),this))})),this.listenTo(this._profilePhotoUploader,u.UPLOAD_COMPLETE,(function(e){this._setValuesWithPhoto(t.first(t.propertyOf(e)("resultList")))}))},_destroyProfilePhotoUploader:function(){this._profilePhotoUploader&&(this._profilePhotoUploader.destroy(),this._profilePhotoUploader=null)}});return A.EVENTS=b,A.openLayer=function(e){var t=new A(e);return d.open(t),t},A.openBandJoinLayer=function(e,t){var n=new A({bandCore:e,setDefaultProfileSetOfPage:t});return d.open(n),n},A}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(9),a=n(26),r=n(159),l=n(13),c=n(2152),d=n(152),u=n(556),h=n(491),p=n(1048),m=n(169),_=n(180),g=n(1120),f=n(153),b=n(162),v=n(495),A=n(487),E=n(155),T=n(1061),C=n(1640),y=n(1286),M=n(1287),I=d.MORE_OPTION_TYPE,S=[I.MODIFY_POST,I.CANCEL_MISSION_CONFIRM,I.SET_NOTICE,I.SEND_AN_ALERT,I.SHOW_POST_URL,I.SEE_TRANSLATION,I.SHARE_POST,I.BOOKMARK_POST,I.SUBSCRIBE_PAGE_BAND,I.MUTE_AUTHOR,I.REPORT_POST,I.DOWNLOAD_COMMENTS,I.DELETE_POST,I.SEE_POST_STATS,I.HIDE_POST_FROM_OTHERS],w={id:T.POST_MORE_ACTIONS.SHOW_POST_URL,urlCopySuccessId:T.POST_MORE_ACTIONS.COPY_POST_URL_SUCCESS,className:"btnCopyPostUrl"},N=t.template('<% _.each(menus, function(menu) { %><li><a href="#" data-menuEventName="<%=menu.id%>"<%if(!!menu.pageUrl){%>class="<%-menu.className%>" data-clipboard-text="<%-menu.pageUrl%>"<%}%>><%- menu.title %></a></li><% }); %>'),D=o.View.extend({_bandNo:0,_postNo:0,_moreOptionTypes:S,attributes:{"data-viewname":"DPostMoreOptionListView"},template:t.template(c),templateContext:function(){return{cid:this.cid,translatable:this._translatable}},behaviors:function(){return[{behaviorClass:v,sceneId:v.SCENE.SHARE_POST_SELECT},A,C,r]},ui:{postFunctionWrap:"._postFunctionWrap",btnPostMore:"._btnPostMore",postMoreMenu:"._postMoreMenu",postMoreMenuUl:"._postMoreMenuUl",postShareOptionListViewRegion:"._postShareOptionListViewRegion",checkInput:"._checkInput",translationSettingRegion:"._translationSettingRegion"},events:{"click @ui.btnPostMore":"_togglePostMoreMenu","click @ui.postMoreMenu A":function(e){var t=this.$(e.currentTarget).attr("data-menuEventName");if(t!=w.id||!_.isSupported()){if(t!=w.id||_.isSupported())return this._clickMoreOption(this.$(e.currentTarget).attr("data-menuEventName"));this._clickMoreOption(w.id)}},"click @ui.checkInput":function(){this.spawn(r.MSG.MEMBER_CONTENTS_MULTI_DELETE_CHECK,{checkedElement:this.getUI("checkInput")})}},regions:{postShareOptionListViewRegion:{el:"@ui.postShareOptionListViewRegion",replaceElement:!0}},initialize:function(e){var t=e.additionalParams||{};this._bandNo=e.bandNo,this._postNo=e.postNo,this.postModel=e.model,t.moreOptionTypes&&(this._moreOptionTypes=t.moreOptionTypes),this._isPostDetail=!0===t.bPostDetail,this.postModel&&this._isPostDetail&&this.listenTo(this.postModel,"change",(function(){var e=this.postModel.getBandCore(),t=e?e.bandNo:null,n=this.postModel.get("postNo");t&&n&&(this._bandNo=t,this._postNo=n)})),this._translationChannel=t.translationChannel,this._translatable=this._translationChannel&&this._translationChannel.supportsMoreOption(),this._translatable&&this.addRegions({translationSettingRegion:"@ui.translationSettingRegion"}),this.listenTo(a.getPostChannel(),a.EVENT.MEMBER_CONTENTS_MULTI_DELETE_CANCEL,(function(){this.getUI("checkInput").is(":checked")&&this.getUI("checkInput").prop("checked",!1)}))},_makePostMoreOptions:function(e,n){var i=e.get("isAuthor"),o=e.get("isRestricted"),a=e.get("isBookmarked");l.isLogedIn()||(this._moreOptionTypes=[],this._moreOptionTypes=[I.SHARE_POST]);var r=[];return t.each(this._moreOptionTypes,(function(t){switch(t){case I.MODIFY_POST:!o&&i&&n.isPostingPermitted()&&r.push({id:T.POST_MORE_ACTIONS.MODIFY_POST,title:IM("web.postdetail.menu.modify_post")});break;case I.CANCEL_MISSION_CONFIRM:this.postModel.isMissionCertifiedPost()&&n.canDeletePost(i)&&r.push({id:T.POST_MORE_ACTIONS.CANCEL_MISSION_CONFIRM_POST,title:IM("cancel.mission_confirm.option.msg")});break;case I.SET_NOTICE:if(!o&&n.isNoticeEditPermitted()){var l=e.get("isNotice");l&&r.push({id:T.POST_MORE_ACTIONS.SET_NOTICE,title:IM("page.notice.setting.title")}),r.push({id:l?T.POST_MORE_ACTIONS.UNSET_NOTICE:T.POST_MORE_ACTIONS.SET_NOTICE,title:l?IM("web.postdetail.menu.unset_notice"):IM("web.postdetail.menu.set_notice")})}break;case I.SEND_AN_ALERT:if(o)return;(n.isNotifyVirtualMemberPermitted()||n.isNotifyMemberPermitted())&&r.push({id:T.POST_MORE_ACTIONS.SEND_AN_ALERT,title:IM("post.menu.send_an_alert")});break;case I.SHARE_POST:!o&&e.get("isShareable")&&r.push({id:"postMoreAction:toggleSharePostLayer",title:IM("web.postdetail.menu.share_post")}),!o&&n.canCopyPost(i,this.postModel.getCopiableState())&&this._hasCopyableContents(e)&&r.push({id:T.POST_MORE_ACTIONS.COPY_POST,title:IM("web.postdetail.menu.copy_post")});break;case I.BOOKMARK_POST:a&&r.push({id:T.POST_MORE_ACTIONS.BOOKMARK_DELETE_POST,title:IM("web.postdetail.menu.bookmark_delete")}),a||o||r.push({id:T.POST_MORE_ACTIONS.BOOKMARK_ADD_POST,title:IM("web.postdetail.menu.bookmark_add")});break;case I.SUBSCRIBE_PAGE_BAND:if(o)return;this.postModel.getBandCore().isSubscribingAvailable()&&r.push({id:T.POST_MORE_ACTIONS.SUBSCRIBE_PAGE_BAND,title:IM("ui.label.subscribe")});break;case I.MUTE_AUTHOR:if(o)return;var c=n.canMuteOtherMemberContent(),d=this.postModel.isMutedAuthorPost();this.postModel instanceof u&&this.postModel.isUncoveredOnce()&&(d=!0),!c||this.postModel.getAuthor().isMyself()||d||r.push({id:T.POST_MORE_ACTIONS.MUTE_AUTHOR,title:IM("post.menu.mute_author")});break;case I.HIDE_POST_FROM_OTHERS:if(o)return;y.isBandLabOptionEnabled(M.OPTION_KEYS.HIDE_POST_FROM_OTHERS)&&!this.postModel.get("isVisibleOnlyToAuthor")&&n.canRecoverHiddenPost()&&!this.postModel.getAuthor().isMyself()&&r.push({id:T.POST_MORE_ACTIONS.HIDE_POST_FROM_OTHERS,title:"글 숨기기(실험실 기능)"});break;case I.REPORT_POST:if(o)return;var h=this.postModel.getAuthor();s.spec.canReport()&&n.canReportContentOfAuthor(h.get("userNo"),h.get("memberType"))&&r.push({id:T.POST_MORE_ACTIONS.REPORT_POST,title:IM("ui.label.report")});break;case I.HIDE_BAND_FROM_FEED:r.push({id:T.POST_MORE_ACTIONS.HIDE_BAND_FROM_FEED,title:IM(this.postModel.getBandCore().selectMcoResourceKey("post.menu.hide_from_feed.for_group_band","post.menu.hide_from_feed.for_page_band"))});break;case I.HIDE_POST_FROM_FEED:r.push({id:T.POST_MORE_ACTIONS.HIDE_POST_FROM_FEED,title:IM("post.menu.hide_post_from_feed")});break;case I.SEE_POST_STATS:if(o)return;n.isPermittedAccessBandPageStats()&&r.push({id:T.POST_MORE_ACTIONS.SEE_POST_STATS,title:IM("post.menu.see_stats")});break;case I.DELETE_POST:n.canDeletePost(i)&&r.push({id:T.POST_MORE_ACTIONS.DELETE_POST,title:IM("web.postdetail.menu.delete_post")});break;case I.SHOW_POST_URL:var p=this.postModel.getBandCore().makeBandRouteUrl(f.GROUP_BAND_POST_DETAIL,b.PAGE_BAND_POST_DETAIL,{band_no:this._bandNo,post_no:this._postNo});r.push({id:w.id,title:IM("web.postdetail.menu.show_post_url"),className:this._getBtnCopyUrlUniqueId(),pageUrl:[location.protocol,"//",location.hostname,p].join("")});break;case I.SEE_TRANSLATION:if(o)return;this._translatable&&r.push({id:"postMoreAction:translatePost",title:this._translationChannel.isOriginalShown()?IM("ui.label.see_translation"):IM("ui.label.view_original")});break;case I.DOWNLOAD_COMMENTS:this.postModel.get("commentCount")>0&&n.canDownloadComments(i)&&r.push({id:T.POST_MORE_ACTIONS.DOWNLOAD_COMMENTS,title:IM("post.menu.download_comments")})}}),this),r},_togglePostMoreMenu:function(){if(this.getUI("postMoreMenu").is(":hidden"))if(a.getDGlobalChannel().trigger(a.EVENT.HTML_CLICK),this.postModel){var e=E.get(this._bandNo);e.loadBandData().always(t.bind((function(){this._postMoreMenuShow(e)}),this))}else this.postModel=new u,$.when(this.postModel.fetchPost(this._bandNo,this._postNo),h.getCachedBandData(this._bandNo)).then(t.bind((function(e,t){this._postMoreMenuShow(t)}),this));else this._postMoreMenuHide();return!1},_postMoreMenuShow:function(e){var n=this._makePostMoreOptions(this.postModel,e);n&&n.length>0&&(this.getUI("postMoreMenuUl").html(N({menus:n})),this.getUI("postMoreMenu").show(),this.getUI("postFunctionWrap").addClass("menuOn"),this.getUI("btnPostMore").attr("aria-expanded","true"),this.getUI("postMoreMenu").attr("tabindex",-1).focus(),this._postMoreMenuTabKeyTrap(),this.listenTo(a.getDGlobalChannel(),a.EVENT.DOCUMENT_ESC_KEY_DOWN,this._postMoreMenuHideOnEsc),this.clickOutsideRegister(t.bind(this._closeLayer,this)),this._copyPostUrl())},_getBtnCopyUrlUniqueId:function(){return[w.className,"_",this.cid].join("")},_copyPostUrl:function(){_.isSupported()&&(this.clipboard=new _("."+this._getBtnCopyUrlUniqueId()),this.clipboard.on("success",t.bind((function(e){e.clearSelection(),this._clickMoreOption(w.urlCopySuccessId),this.clipboard.destroy()}),this)),this.clipboard.on("error",t.bind((function(e){this._clickMoreOption(w.id),this.clipboard.destroy()}),this)))},_postMoreMenuHide:function(){this.clickOutsideUnregister(),this.getUI("postMoreMenu").hide(),this.getUI("postFunctionWrap").removeClass("menuOn"),this.getUI("btnPostMore").attr("aria-expanded","false"),this._postMoreMenuTabKeyTrap({eventOff:!0})},_postMoreMenuHideOnEsc:function(){if(this.isAttached()&&this.getUI("postMoreMenu").is(":visible"))return this._postMoreMenuHide(),this.getUI("btnPostMore").focus(),this.stopListening(a.getDGlobalChannel(),a.EVENT.DOCUMENT_ESC_KEY_DOWN,this._postMoreMenuHideOnEsc),!1},_postMoreMenuTabKeyTrap:function(e){if(e&&e.eventOff)this._postMoreMenuKeyTrapEvent&&this.getUI("postMoreMenu").off("keydown",this._postMoreMenuKeyTrapEvent);else{var t=this.getUI("postMoreMenu").find(m.FOCUSABLE_ELEMENTS_STRING),n=0;this._postMoreMenuKeyTrapEvent=function(e){if(9===(e.keyCode?e.keyCode:e.which))return e.shiftKey?n<=0?n=t.length-1:n-=1:n>=t.length-1?n=0:n+=1,t[n].focus(),!1},this.getUI("postMoreMenu").on("keydown",this._postMoreMenuKeyTrapEvent)}},_clickMoreOption:function(e){return this.getUI("btnPostMore").focus(),"postMoreAction:toggleSharePostLayer"===e?(this.getUI("postFunctionWrap").addClass("menuOn"),this._togglePostShareOptionListView(),!1):"postMoreAction:translatePost"===e?(this._translatePost(),!1):(e===T.POST_MORE_ACTIONS.MODIFY_POST&&this.stopListening(a.getDGlobalChannel(),a.EVENT.DOCUMENT_ESC_KEY_DOWN,this._postMoreMenuHideOnEsc),this.trigger("postMoreOptionList:clickMenu",e),!1)},_togglePostShareOptionListView:function(){var e=this.getRegion("postShareOptionListViewRegion");p.openPostShareViewAtRegion(e,this.postModel.getBandCore(),this.postModel.get("postNo"))},_closeLayer:function(){this._postMoreMenuHide(),t.each(["postShareOptionListViewRegion","translationSettingRegion"],(function(e){var t=this.getRegion(e);null!=t&&t.hasView()&&t.empty()}),this)},isPostMoreMenuVisible:function(){return this.getUI("postMoreMenu").is(":visible")},_translatePost:function(){this._translationChannel.isOriginalShown()?this._translationChannel.isTranslatableImmediately()?this._translationChannel.seeTranslation():this.showChildView("translationSettingRegion",g.build({translationChannel:this._translationChannel})):this._translationChannel.seeOriginal()},_hasCopyableContents:function(e){if(this._hasCopyableSchedule(e))return!0;if(this._hasAttachmentsExceptScheduleGroup(e))return!0;var t=i.trim(e.get("content")).replace(/<band:attachment type="schedule_group" id="[0-9]+" \/>/g,"");return!i.isBlank(t)},_hasCopyableSchedule:function(e){var n=e.getAttachment(d.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP),i=e instanceof u?n.values():n.toArray();return t.some(i,(function(e){return e.hasCopyableSchedule()}))},_hasAttachmentsExceptScheduleGroup:function(e){var n=t.without(t.values(d.POST_ATTACHMENT_TYPE),d.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP);return t.some(n,(function(t){return e.hasAttachment(t)}))}});return D.buildOptionList=function(e,t,n,i){return new D({bandNo:e,postNo:t,model:n,additionalParams:i})},D}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(2),s=n(4),a=n(159),r=n(498),l=n(499),c=n(616),d=n(486),u=n(723),h=n(2202),p=n(2203),m=n(43),_=n(154),g=n(9),f=n(523),b=n(167),v=n(538),A=n(166),E=n(1146),T=n(600),C=n(545),y=n(1092),M=n(537),I=n(177),S=n(488),w=n(1115),N=n(2205),D=n(2206),L=n(2207),O=n(2212),P=n(610),x=n(1619),R=n(531),k=n(2219),B=n(1177),V=n(2240),U=n(495),F=n(487),H=n(507),z=n(2244),W=n(2248),G=n(510);n(194);var K,Y=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DScheduleEditView"},getTemplate:function(){return this._dataFetched?this.model.isLocalMeetup()?t.template(p):t.template(h):t.template(r)},behaviors:function(){return[{behaviorClass:U,sceneId:this.options.forModification?U.SCENE.SCHEDULE_MODIFY:U.SCENE.SCHEDULE_CREATE},F,a]},onMessages:(K={},K[a.MSG.SCHEDULE_EDIT_ALARM_RENDERED]=function(){this._toggleScrollLockByContentHeight()},K[a.MSG.SCHEDULE_EDIT_CALENDAR_CATEGORY_TOGGLE]=function(e){var t=0;this.ui.belowCalendarCategoryArea.each((function(e,n){t+=o(n).outerHeight(!0)})),this._dBandCalendarCategoryView.toggleCalendarList(e>=t)},K),ui:{scheduleArticle:"._scheduleArticle",scheduleEditArea:"._scheduleEditArea",scheduleName:"._scheduleName",description:"._description",btnImportPrevSchedule:"._btnImportPrevSchedule",popoverHelpImportSchedule:"._popoverHelpImportSchedule",btnCloseImportScheduleHelpPopover:"._btnCloseImportScheduleHelpPopover",schedulePhotoUpload:"._schedulePhotoUpload",scheduleFileUpload:"._scheduleFileUpload",attachedPhotosRegion:"._attachedPhotosRegion",attachedFilesRegion:"._attachedFilesRegion",attachedDropboxFilesRegion:"._attachedDropboxFilesRegion",attachedExternalFilesRegion:"._attachedExternalFilesRegion",attachArea:"._attachArea",photoArea:"._photoArea",btnAttachPhotoMore:"._btnAttachPhotoMore",calendarCategoryRegion:"._calendarCategoryRegion",belowCalendarCategoryArea:"._belowCalendarCategoryArea",btnSelectLocation:"._btnSelectLocation",locationWrap:"._locationWrap",locationTitle:"._locationTitle",btnRemoveLocation:"._btnRemoveLocation",locationLabel:"._locationLabel",startAtRegion:"._startAtRegion",endAtRegion:"._endAtRegion",lunarCheckbox:"._lunarCheckbox",allDayCheckbox:"._allDayCheckbox",btnTimezone:"._btnTimezone",timezoneSelectRegion:"._timezoneSelectRegion",alarmsRegion:"._alarmsRegion",recurrenceRegion:"._recurrenceRegion",rsvpRegion:"._rsvpRegion",announceableCheckbox:"._announceableCheckbox",btnSubmit:"._btnSubmit",btnClose:"._btnClose",addCustomState:"._addCustomState",secretSelectRegion:"._sharerSelectRegion",extraOptionArea:"._extraOptionArea",openExtraBtn:"._openExtraBtn",openExtraArea:"._openExtraArea"},regions:{attachedPhotosRegion:{el:"@ui.attachedPhotosRegion",replaceElement:!0},attachedFilesRegion:{el:"@ui.attachedFilesRegion",replaceElement:!0},attachedDropboxFilesRegion:{el:"@ui.attachedDropboxFilesRegion",replaceElement:!0},attachedExternalFilesRegion:{el:"@ui.attachedExternalFilesRegion",replaceElement:!0},calendarCategoryRegion:{el:"@ui.calendarCategoryRegion",replaceElement:!0},startAtRegion:"@ui.startAtRegion",endAtRegion:"@ui.endAtRegion",startDateSelectorRegion:"@ui.startDateSelectorRegion",timezoneSelectRegion:{el:"@ui.timezoneSelectRegion",replaceElement:!0},alarmsRegion:{el:"@ui.alarmsRegion",replaceElement:!0},recurrenceRegion:{el:"@ui.recurrenceRegion",replaceElement:!0},rsvpRegion:{el:"@ui.rsvpRegion",replaceElement:!0},secretSelectRegion:{el:"@ui.secretSelectRegion",replaceElement:!0}},events:{"click @ui.btnImportPrevSchedule":function(){this._didCloseImportHelpLayerEver()||this._closeImportScheduleHelpPopover();var e=this._bandNo;this._isEditForCopy&&(e=this._sourceBandNo);var t=V.openScheduleImportLayer(e,this.model.isLocalMeetup());this.listenTo(t,"select:item-import",(function(e){this._isEditingContentExist()&&!confirm(IM("web.postwrite.form_attendance_check.prev_attendance_check_import_confirm"))||(t.destroy(),this.getRegion("calendarCategoryRegion").empty(),this._dBandCalendarCategoryView=null,this._isEditForCopy?this.model.resetForCopyByImport(e.model.toJSON(),this._bandData.canAttachLocation()):this.model.resetByImport(e.model.toJSON(),this._bandData.canAttachLocation()),this._renderScheduleEditView())}))},"click @ui.btnCloseImportScheduleHelpPopover":"_closeImportScheduleHelpPopover","click @ui.btnAttachPhotoMore":function(){this.ui.schedulePhotoUpload.find("input").click()},"change @ui.lunarCheckbox":function(){this._changeIsLunar(this.ui.lunarCheckbox.is(":checked"))},"change @ui.allDayCheckbox":function(){this._changeIsAllDay(this.ui.allDayCheckbox.is(":checked"))},"click @ui.btnTimezone":"_showTimezoneSelectView","click @ui.btnSubmit":"_submitSchedule","click @ui.btnClose":function(e){e.preventDefault(),this._cancelScheduleEdit()},scroll:function(){var e=this.ui.scheduleArticle.hasClass(S.ELEMENT.FIXED),t=this.$el.scrollTop();e?t<12&&this.ui.scheduleArticle.removeClass(S.ELEMENT.FIXED):t>30&&this.ui.scheduleArticle.addClass(S.ELEMENT.FIXED)},"click @ui.btnSelectLocation":function(){B.asyncOpenDSelectLocationLayer().then(t.bind((function(e){e&&this.listenTo(e,"locationSelected",(function(t){e.destroy(),this.model.setLocation(c.buildLocationModel(t)),this._renderLocation()}))}),this))},"click @ui.btnRemoveLocation":function(){this.model.setLocation(null),this._renderLocation()},"click @ui.openExtraBtn":function(){this.ui.openExtraArea.hide(),this.ui.extraOptionArea.addClass(S.ELEMENT.ACTIVE),this._toggleScrollLockByContentHeight()}},templateContext:function(){if(!this._dataFetched)return{_loading_size:l.Size.MEDIUM,middleClass:S.ELEMENT.SCREEN_VERTICAL_MIDDLE};var e=this._postAttachable&&!this._forModification&&this._bandData.isPostingPermitted()&&this._bandData.canWritePostWithoutApproval();return this._isEditForCopy&&(e=this._canPostAnnounceForCopy),{showPosting:e,useLunar:g.spec.useLunar(),nameMaxLength:R.SCHEDULE_NAME_MAX_LENGTH,descriptionMaxLength:R.SCHEDULE_DESCRIPTION_MAX_LENGTH,submitButtonText:this._submitText,scheduleImportHelpClosed:this._didCloseImportHelpLayerEver(),editDescription:this._editDescription,canAttachLocation:this._bandData.canAttachLocation()}},initialize:function(e){this._dataFetched=!1,this._bandData=e.bandData,this._bandNo=this._bandData.getBandCore().bandNo,this._forModification=1==e.forModification,this._submitText=e.submitText,this._postAttachable=e.postAttachable,this._canPostAnnounceForCopy=e.canPostAnnounceForCopy,this._sourceBandNo=e.sourceBandNo,this._editDescription=e.editDescription,this._isEditForCopy=e.isEditForCopy,this._shouldHideSecretSelect=e.shouldHideSecretSelect,this._isSecretOriginalValue=this.model.isSecret()},layerOnEscKeyDown:function(){this._cancelScheduleEdit()},onDomRefresh:function(){this._dataFetched&&(this._applyBandThemeColor(),this._renderScheduleEditView(),this._bindPhotoUploader(),this._bindFileUploader(),this.ui.scheduleName.focus(),this.ui.description.on("elastic:heightChanged",t.bind(this._toggleScrollLockByContentHeight,this)),this.ui.description.elastic())},onAttach:function(){this._fetchCalendarAndBandOption().then(t.bind((function(){this._dataFetched=!0,this.render();var e=this._forModification?F.CLASSIFIER.SCHEDULE_MODIFY:F.CLASSIFIER.SCHEDULE_CREATE,t=this._forModification?null:{schedule_type:this.model.isLocalMeetup()?"local_meetup":"normal"};this.jplSceneEnter(e,t)}),this))},onBeforeDetach:function(){this._photoUploader&&(this._photoUploader.destroy(),this._photoUploader=null),this._fileUploader&&(this._fileUploader.destroy(),this._fileUploader=null),this.ui.description.off("elastic:heightChanged"),this.ui.description.destroyElastic()},_renderScheduleEditView:function(){this.ui.scheduleName.val(this.model.getName()),this.ui.description.val(this.model.getDescription()),this._renderPhotoArea(),this._renderFileArea(),this._renderStartAt(),this._renderLunarStartAt(),this._renderEndAt(),this._renderLunarEndAt(),this._renderIsLunar(),this._renderIsAllDay(),this._renderLocation(),this._renderCalendarCategory(),this._renderTimezoneArea(!0),this._renderRecurrence(),this._renderRsvp(),this._renderSecretSelect(),this._renderExtraAreaFoldOrNot(),this._renderRemindAlarm(),this._toggleScrollLockByContentHeight()},_cancelScheduleEdit:function(){this.trigger(Y.EVENT.SCHEDULE_EDIT_CANCEL),this.destroy()},_renderTimezoneArea:function(e){this.model.isLunar()||this.model.isAllDay()?this._hideTimezoneSelectView():!e||this.model.hasDifferentTimezone()?this._showTimezoneSelectView():this._hideTimezoneSelectView()},_didCloseImportHelpLayerEver:function(){return b.getCurrentUserEnvStorage().get([A.ScheduleImportHelpClosed])||!1},_hideTimezoneSelectView:function(){null!=this._timezoneSelectView&&(this._timezoneSelectView.destroyTimezoneSelectView(),this._timezoneSelectView=null),this._renderBtnTimezone(),this._toggleScrollLockByContentHeight()},_showTimezoneSelectView:function(){this._timezoneSelectView=new E({timezoneId:this.model.getScheduleTimeZoneId()}),this.listenTo(this._timezoneSelectView,E.EVENT.TIMEZONE_CHANGED,(function(e){this._changeScheduleTimeZoneId(e)})),this._renderBtnTimezone(),this.showChildView("timezoneSelectRegion",this._timezoneSelectView),this._toggleScrollLockByContentHeight()},_renderBtnTimezone:function(){this.model.isLunar()||this.model.isAllDay()?this.ui.btnTimezone.hide():this.ui.btnTimezone.toggle(null==this._timezoneSelectView)},_renderPhotoArea:function(){this.ui.attachArea.toggleClass(S.ELEMENT.ON,this.model.isPhotoAttached()||this.model.isAnyTypeFileAttached()),this.ui.schedulePhotoUpload.toggleClass(S.ELEMENT.DISABLED,t.size(this.model.getPhotos())>=I.SCHEDULE.PHOTO_COUNT_LIMIT);var e=this.model.getPhotos();if(t.isEmpty(e)||e.isEmpty())return this.ui.photoArea.hide(),this.getRegion("attachedPhotosRegion").empty(),void this._toggleScrollLockByContentHeight();var n=N.buildDScheduleEditAttachedPhotosView(e);this.showChildView("attachedPhotosRegion",n),this.listenTo(n,"deletePhoto",(function(e){this.model.deleteSchedulePhoto(e),this._renderPhotoArea()})),this.ui.photoArea.show(),this._toggleScrollLockByContentHeight()},_renderSecretSelect:function(){if(!this._shouldHideSecretSelect){var e=W.buildDScheduleSharerSelectView({bandData:this._bandData,isSecret:this.model.isSecret(),secretSharers:this.model.getSecretSharers(),ownerUserNo:this.model.getOwner().getUserNo()});this.showChildView("secretSelectRegion",e),this.listenTo(e,W.EVENTS.SHARER_CHANGE,(function(e){this.model.setIsSecret(e.isSecret),this.model.setSecretSharers(e.secretSharers)}))}},_renderFileArea:function(){if(this.ui.attachArea.toggleClass(S.ELEMENT.ON,this.model.isPhotoAttached()||this.model.isAnyTypeFileAttached()),this.ui.scheduleFileUpload.toggleClass(S.ELEMENT.DISABLED,t.size(this.model.getFiles())>=I.SCHEDULE.FILE_COUNT_LIMIT),!this.model.isAnyTypeFileAttached())return this.getRegion("attachedFilesRegion").empty(),void this._toggleScrollLockByContentHeight();var e=this.model.getFiles(),n=this.model.getDropboxFiles(),i=this.model.getExternalFiles(),o=D.buildDScheduleEditAttachedFilesView(n,i,e);this.showChildView("attachedFilesRegion",o),this._toggleScrollLockByContentHeight(),this.listenTo(o,"deleteFile",(function(e){this.model.deleteScheduleFile(e),this._renderFileArea()})),this.listenTo(o,"deleteDropboxFile",(function(e){this.model.deleteScheduleDropboxFile(e),this._renderFileArea()})),this.listenTo(o,"deleteExternalFile",(function(e){this.model.deleteScheduleExternalFile(e),this._renderFileArea()}))},_renderIsLunar:function(){this.ui.lunarCheckbox.val(this.model.isLunar()?["true"]:[])},_renderIsAllDay:function(){this.ui.allDayCheckbox.val(this.model.isAllDay()?["true"]:[])},_renderCalendarCategory:function(){this._dBandCalendarCategoryView=k.buildDCalendarCategoryView(this._bandNo,this._calendarCollection,this.model.getCalendar(),!this._isEditForCopy&&this._isPermittedRegisterCalendar),this.showChildView("calendarCategoryRegion",this._dBandCalendarCategoryView),this.listenTo(this._dBandCalendarCategoryView,k.EVENT.CALENDAR_SELECTED,(function(e){this.model.setCalendar(e),this._renderCalendarCategory()}))},_fetchCalendarAndBandOption:function(){return this._calendarCollection=y.build(this._isEditForCopy),_.wrapActivePromise(o.when(v.getBandOption(this._bandNo),this._calendarCollection.fetchCalendar(this._bandNo,C.TYPE.INTERNAL)),this).then(t.bind((function(e){this._isPermittedRegisterCalendar=e.isPermittedRegisterCalendar()}),this))},_renderLocation:function(){var e=this.model.getLocation(),t=null!=e;if(this.ui.locationLabel.toggle(!t),this.ui.locationWrap.toggle(t),t){var n=e.get("address");e.has("name")&&(n=e.get("name")),this.ui.locationTitle.text(n)}},_renderStartAt:function(){this.model.isLunar()||(this._startDateTimeInputView=w.buildSolarDateInputView({dateTime:this.model.getStartAtMoment(),disableTime:this.model.isAllDay(),viewFormatLocalize:"short_noweekday",timezoneId:this.model.getDefaultScheduleTimeZoneId()}),this.showChildView("startAtRegion",this._startDateTimeInputView),this.listenTo(this._startDateTimeInputView,w.EVENT.DATE_TIME_CHANGED,(function(e){this._changeStartAt(e.date+" "+e.time,e.dateFormat+" "+e.timeFormat)})))},_renderLunarStartAt:function(){this.model.isLunar()&&(this._startDateTimeInputView=w.buildLunarDateInputView({dateTime:this.model.getLunarStartAtMoment().format(R.BAND_SCHEDULE_TIME_FORMAT),disableTime:this.model.isAllDay()}),this.showChildView("startAtRegion",this._startDateTimeInputView),this.listenTo(this._startDateTimeInputView,w.EVENT.DATE_TIME_CHANGED,(function(e){var t=x.parseDateText(e.date),n=m(e.time,e.timeFormat,!0);t.hour(n.hour()),t.minute(n.minute()),this._changeStartAtAsLunar(m.tz(t.toISO(),this.model.getDefaultScheduleTimeZoneId()))})))},_renderEndAt:function(){if(!this.model.isLunar()){var e={useDelete:!0,disableTime:this.model.isAllDay(),datePlaceholder:IM("ui.datepicker.placeholder.optional"),timePlaceholder:IM("ui.timepicker.placeholder.optional"),viewFormatLocalize:"short_noweekday",timezoneId:this.model.getDefaultScheduleTimeZoneId()},t=this.model.getEndAtMoment();null!=t?e.dateTime=t:e.pickerDateTime=this.model.getStartAtMoment(),this.showChildView("endAtRegion",w.buildSolarDateInputView(e)),this.listenTo(this.getChildView("endAtRegion"),w.EVENT.DATE_TIME_CHANGED,(function(e){if(e.date){var t=this.model.getStartAtMoment(),n=m.tz(e.date+"T"+e.time,e.dateFormat+"T"+e.timeFormat,this.model.getDefaultScheduleTimeZoneId());if(null==this.model.getEndAtMoment()&&(t.isBefore(n)||(n=m(t).add(1,"hour").startOf("hour"))),this.model.isAllDay()){if(!f.isSameOrBefore(t,n,"day"))return alert(IM("web.scheduleedit.alert.endtime_invlid_before_start")),void this._renderEndAt()}else if(t.isAfter(n))return alert(IM("web.scheduleedit.alert.endtime_invlid_before_start")),void this._renderEndAt();this._changeEndAt(n)}else this._changeEndAt(null)}))}},_renderLunarEndAt:function(){if(this.model.isLunar()){var e={useDelete:!0,disableTime:this.model.isAllDay(),datePlaceholder:IM("ui.datepicker.placeholder.optional"),timePlaceholder:IM("ui.timepicker.placeholder.optional")};null!=this.model.getLunarEndAtMoment()&&(e.dateTime=this.model.getLunarEndAtMoment().format(R.BAND_SCHEDULE_TIME_FORMAT)),this.showChildView("endAtRegion",w.buildLunarDateInputView(e)),this.listenTo(this.getChildView("endAtRegion"),w.EVENT.DATE_TIME_CHANGED,(function(e){if(e.date){var t=x.parseISO(e.date+" "+e.time);t=m(t.toISO());var n=this.model.getLunarStartAtMoment();if(null!=this.model.getLunarEndAtMoment()&&!n.isBefore(t)){var i=x.parseISO(n.format(R.BAND_SCHEDULE_TIME_FORMAT));i.addOneHour(),t=m(i.toISO())}var o=this.model.isAllDay();return o&&!f.isSameOrBefore(n,t,"day")?(alert(IM("web.scheduleedit.alert.endtime_invlid_before_start")),void this._renderLunarEndAt()):o||n.isBefore(t)?void this._changeEndAtAsLunar(t):(alert(IM("web.scheduleedit.alert.endtime_invlid_before_start")),void this._renderLunarEndAt())}this._changeEndAtAsLunar(null)}))}},_renderRemindAlarm:function(){this._alarmsView=z.buildDScheduleEditAlarmCollectionView({alarms:null!=this.model.getAlarms()?this.model.getAlarms().toJSON():[],isAllDay:this.model.isAllDay()}),this.showChildView("alarmsRegion",this._alarmsView)},_renderRecurrence:function(){null==this._recurrenceView&&(this._recurrenceView=O.buildDScheduleEditRecurrenceView(this.model.getStartAtMoment(),this.model.getRecurrence(),this.model.isLunar()),this.showChildView("recurrenceRegion",this._recurrenceView),this.listenTo(this._recurrenceView,"changeRecurrence",(function(e){this._changeRecurrence(e)}))),this._recurrenceView.updateScheduleInfo(this.model.getStartAtMoment(),this.model.getRecurrence(),this.model.isLunar(),this.model.getRsvp()),this._delayedToggleScrollLock()},_renderExtraAreaFoldOrNot:function(){if(!this.model.isLocalMeetup())return this.ui.openExtraArea.hide(),void this.ui.extraOptionArea.toggleClass(S.ELEMENT.ACTIVE,!0);var e=this._isDefaultLocalMeetupRsvpStatus();this.ui.openExtraArea.toggle(e),this.ui.extraOptionArea.toggleClass(S.ELEMENT.ACTIVE,!e)},_renderRsvp:function(){if(null==this._editRsvpView){var e=0,t=this.model.getRsvp();null==t||this._isEditForCopy||(e=t.getAttendeeCount()),this._editRsvpView=L.buildDScheduleEditRsvpView(e,this.model.isLocalMeetup()),this.showChildView("rsvpRegion",this._editRsvpView),this.listenTo(this._editRsvpView,"rsvpChanged",(function(e){this.model.setRsvp(e),this._renderRsvp()}))}this._editRsvpView.updateRsvpInfo(this.model.getRsvp(),null==this.model.getRecurrence()),this._delayedToggleScrollLock()},_setEditedAlarmFromAlarmCollectionView:function(){var e=this._alarmsView.filterAlarmCollectionWithoutEmpty(this.model.isAllDay());this.model.setAlarms(new u(e,{parse:!0}))},_isDefaultLocalMeetupRsvpStatus:function(){return P.isSameRsvpInput(P.createDefaultScheduleRsvpModel(),this.model.getRsvp(),!0)},_isEditingContentExist:function(){if(!t.isEmpty(i.trim(this.ui.scheduleName.val())))return!0;if(!t.isEmpty(i.trim(this.ui.description.val())))return!0;if(this.model.isPhotoAttached())return!0;if(this.model.isAnyTypeFileAttached())return!0;if(this.model.hasRsvp()){if(!this.model.isLocalMeetup())return!0;if(!this._isDefaultLocalMeetupRsvpStatus())return!0}return!1},_submitSchedule:function(e){if(e.preventDefault(),!this._onSubmit){if(this._onSubmit=!0,this.model.setDescription(this.ui.description.val()),this.model.setName(this.ui.scheduleName.val()),this._sendScheduleCreateConfirmClickJackpotLog(),!i.trim(this.model.getName()))return alert(g.message("web.scheduleedit.alert.name_required")),void(this._onSubmit=!1);this.getChildView("rsvpRegion").editCompleted()?(this._setEditedAlarmFromAlarmCollectionView(),this._checkSecretScheduleConfirmModal().then(t.bind((function(){this.trigger(Y.EVENT.SCHEDULE_EDIT_COMPLETE,{scheduleEditModel:this.model,bandNo:this._bandNo,announceable:!this._forModification&&this.getUI("announceableCheckbox").is(":checked")})}),this))):this._onSubmit=!1}},stopSubmitPending:function(){this._onSubmit=!1},_checkSecretScheduleConfirmModal:function(){var e=o.Deferred();if(!this.model.isSecret()||this._isSecretOriginalValue)return e.resolve(),e.promise();var t=G.openLayer({bodyTitle:IM("schedule.secret.open_member.alert.title"),confirm:IM("web.modal.btn.confirm"),cancel:IM("web.modal.btn.cancel")});return this.listenTo(t,G.EVENTS.CONFIRM,(function(){e.resolve()})),this.listenTo(t,G.EVENTS.CANCEL,(function(){this.stopSubmitPending()})),e.promise()},_changeStartAt:function(e,t){var n=m.tz(e,t,this.model.getDefaultScheduleTimeZoneId());this.model.setStartAtMoment(n),this.model.setRecurrence(null),this._renderStartAt(),this._renderRecurrence();var i=this.model.getEndAtMoment();if(null!=i){var o=this.model.isAllDay();if(!o&&!n.isBefore(i)||o&&!f.isSameOrBefore(n,i,"day"))return this.model.setEndAtMoment(null),this.model.setLunarEndAtMoment(null),void this._renderEndAt();o&&!n.isBefore(i)&&this.model.setEndAtMoment(m(n).add(1,"hour").startOf("hour")),this._renderEndAt()}},_changeEndAt:function(e){if(null==e)return this.model.setEndAtMoment(null),this.model.setLunarEndAtMoment(null),void this._renderEndAt();var t=this.model.getStartAtMoment(),n=this.model.isAllDay();if((n||!e.isBefore(t))&&(!n||f.isSameOrBefore(t,e,"day"))){if(n&&!t.isBefore(e))return this.model.setEndAtMoment(m(t).add(1,"hour").startOf("hour")),void this._renderEndAt();this.model.setEndAtMoment(e),this._renderEndAt()}},_changeStartAtAsLunar:function(e){this.model.setLunarStartAtMoment(e),this.model.setRecurrence(null),this._renderRecurrence();var t=this.model.getLunarEndAtMoment();if(null!=t){var n=this.model.isAllDay();if(!n&&!e.isBefore(t)||n&&!f.isSameOrBefore(e,t,"day"))return this.model.setEndAtMoment(null),this.model.setLunarEndAtMoment(null),void this._renderLunarEndAt();if(n&&e.isBefore(t)){var i=x.parseISO(this.model.getLunarEndAtMoment().format(R.BAND_SCHEDULE_TIME_FORMAT));i.addOneHour(),i.minute(0),this.model.setLunarEndAtMoment(m(i.toISO())),this._renderLunarEndAt()}}},_changeEndAtAsLunar:function(e){if(null==e)return this.model.setEndAtMoment(null),this.model.setLunarEndAtMoment(null),void this._renderLunarEndAt();var t=this.model.isAllDay(),n=this.model.getLunarStartAtMoment();if((t||n.isBefore(e))&&(!t||f.isSameOrBefore(n,e,"day"))){if(t&&!n.isBefore(e)){var i=x.parseISO(this.model.getLunarStartAtMoment().format(R.BAND_SCHEDULE_TIME_FORMAT));return i.addOneHour(),i.minute(0),this.model.setLunarEndAtMoment(m(i.toISO())),void this._renderLunarEndAt()}this.model.setLunarEndAtMoment(e)}},_changeRecurrence:function(e){if(this.model.setRecurrence(e),this._renderRecurrence(),null!=e&&null!=this.model.getRsvp()&&null!=this.model.getRsvp().getEndedAt()){var t=this.getRsvp(),n=P.createScheduleRsvpModel({attendeeLimit:t.get("attendeeLimit"),isChildMemberAddible:t.get("isChildMemberAddible"),childMemberLimit:t.get("childMemberLimit"),isMaybeEnabled:t.get("isMaybeEnabled")});this.model.setRsvp(n),this._renderRsvp()}},_changeIsLunar:function(e){if(this.model.setIsLunar(e),this.model.setRecurrence(null),e){if(null==this.model.getLunarStartAtMoment()){var t=x.fromMoment(this.model.getStartAtMoment());this.model.setLunarStartAtMoment(m(t.toISO()))}if(null!=this.model.getEndAtMoment()&&null==this.model.getLunarEndAtMoment()){var n=x.fromMoment(this.model.getEndAtMoment());this.model.setLunarEndAtMoment(m(n.toISO()))}this.model.setScheduleTimeZoneId(null)}this._renderIsLunar(),this._renderRecurrence(),this._renderStartAt(),this._renderLunarStartAt(),this._renderEndAt(),this._renderLunarEndAt(),this._renderTimezoneArea(!0),e&&this._startDateTimeInputView.focusDate()},_changeIsAllDay:function(e){this.model.setAlarms(new u([])),this.model.setIsAllDay(e),e&&this.model.setScheduleTimeZoneId(null),this._renderStartAt(),this._renderLunarStartAt(),this._renderEndAt(),this._renderLunarEndAt(),this._renderIsAllDay(),this._renderTimezoneArea(!0),this._renderRemindAlarm()},_changeScheduleTimeZoneId:function(e){this.model.isAllDay()||this.model.isLunar()||(this.model.setScheduleTimeZoneId(e),this._renderTimezoneArea(!1),this._renderStartAt(),this._renderEndAt())},_bindPhotoUploader:function(){this._photoUploader=T.createPhotoUploader(this.ui.schedulePhotoUpload,{autoUpload:!0,fileInputTitle:window.webkitURL?" ":"",skinColor:this._bandData.getBandCore().getSkinColorClass(),data:{band_no:this._bandNo},accept:M.getSchedulePhotoAccept()}),this.listenTo(this._photoUploader,H.BEFORE_VALIDATE,(function(){var e=M.getSchedulePhotoValidator({photoCount:t.size(this.model.getPhotos())});this._photoUploader.setValidators([e])})),this.listenTo(this._photoUploader,H.UPLOAD_COMPLETE,(function(e){t.isEmpty(e.resultList)||(this.model.addPhotos(e.resultList),this._renderPhotoArea())}))},_bindFileUploader:function(){this._fileUploader=T.createFileUploader(this.ui.scheduleFileUpload,{fileInputTitle:window.webkitURL?" ":"",skinColor:this._bandData.getBandCore().getSkinColorClass()}),this.listenTo(this._fileUploader,H.BEFORE_VALIDATE,t.bind((function(){this._fileUploader.setValidators([t.partial(M.FILE_VALIDATOR,t,t.size(this.model.getFiles()),I.SCHEDULE.FILE_COUNT_LIMIT)])}),this)),this.listenTo(this._fileUploader,H.UPLOAD_COMPLETE,t.bind((function(e){t.isEmpty(e.resultList)||(this.model.addFiles(e.resultList),this._renderFileArea())}),this))},_sendScheduleCreateConfirmClickJackpotLog:function(){var e=this.model.getRsvp(),t={schedule_rsvp:!!e?"rsvp":"normal",schedule_rsvp_external:!!e&&e.get("isChildMemberAddible")?"Y":"N",schedule_post:this.getUI("announceableCheckbox").is(":checked")?"Y":"N",use_location_information:!!this.model.getLocation()?"Y":"N",attached_photo_cnt:this.model.getPhotoCount(),attached_file_cnt:this.model.getFileCount(),schedule_type:this.model.isLocalMeetup()?"local_meetup":"normal"};this.jplClick(F.CLASSIFIER.SCHEDULE_CREATE_CONFIRM,t)},_closeImportScheduleHelpPopover:function(){this.getUI("popoverHelpImportSchedule").hide(),b.getCurrentUserEnvStorage().set([A.ScheduleImportHelpClosed],!0)},_applyBandThemeColor:function(){this._bandData&&this.$el.addClass(this._bandData.getBandCore().getSkinColorClass())},_toggleScrollLockByContentHeight:function(){var e=this.$el.height(),t=this.ui.scheduleEditArea.height();this.$el.toggleClass("gScrollYDisabled",e>t+80)},_delayedToggleScrollLock:function(){_.wrapDeferPromise(this).then(t.bind((function(){this._toggleScrollLockByContentHeight()}),this))}});return Y.openScheduleEditLayer=function(e){var t=new Y({model:e.scheduleEditModel,bandData:e.bandData,forModification:e.forModification,postAttachable:e.postAttachable,submitText:e.submitText||IM("ui.label.complete"),canPostAnnounceForCopy:e.canPostAnnounceForCopy,sourceBandNo:e.sourceBandNo,editDescription:e.editDescription,isEditForCopy:e.isEditForCopy,shouldHideSecretSelect:e.shouldHideSecretSelect});return d.open(t),t},Y.EVENT={SCHEDULE_EDIT_CANCEL:"SCHEDULE_EDIT_CANCEL",SCHEDULE_EDIT_COMPLETE:"SCHEDULE_EDIT_COMPLETE"},Y}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(1329),s=i.Collection.extend({model:o,initialize:function(e,t){this.bandNo=t.bandNo,this.photoInfo=t.photoInfo,this.postNo=t.postNo,this.lastImageIndex=t.lastImageIndex,this.profileViewSupport=t.profileViewSupport,this.showUserInfo=t.showUserInfo},makeImageViewCollection:function(){var e=0;this.lastImageIndex&&(e=this.lastImageIndex+1);var n=t.map(this.photoInfo.photos,(function(t){return o.buildDImageViewerModel(t,this.bandNo,this.profileViewSupport,this.showUserInfo,e++,this.postNo)}),this);this.set(n),this.sort(),this.setTotalCount(this.photoInfo.total_count)},addCollection:function(e){this.set(e.toJSON(),{add:!0,merge:!0,remove:!1,sort:!0})},comparator:function(e){return e.getIncreasingId()},setTotalCount:function(e){this._totalCount=e},getTotalCount:function(){return this._totalCount},isAllFetched:function(){return this._totalCount==this.length}});return s.build=function(e,t){var n=new s([],t);return n.makeImageViewCollection(),n},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(26),a=n(1344),r=n(154),l=n(82),c=n(488),d=n(159),u=n(1059);n(1148);var h=o.View.extend({attributes:{"data-viewname":"DMessageInputProfileView"},behaviors:[d],getTemplate:function(){return this._currentProfileMemberType?t.template(a):t.template("")},templateContext:function(){var e=m(this._memberProfileArray,this._currentProfileMemberType);return{currentProfile:p(t.find(this._memberProfileArray,(function(e){return e.memberType===this._currentProfileMemberType}),this),this._currentProfileMemberType),inputProfileArray:e,isProfileSelectable:e.length>1}},ui:{profileSelectBtn:"._profileSelectBtn",profileListUl:"._profileListUl",eachProfileBtn:"._eachProfileBtn",currentProfile:"._currentProfile",selectableProfile:"._selectableProfile"},events:function(){return this.options.preventAllEvent?{}:{"click @ui.profileSelectBtn":function(){this.ui.profileSelectBtn.hasClass(c.ELEMENT.ACTIVE)?this._hideProfileSelectLayer():r.wrapDeferPromise(this).then(t.bind((function(){this._showProfileSelectLayer()}),this))},"click @ui.eachProfileBtn":function(e){var t=i(e.currentTarget).data("member-type");return t===this._currentProfileMemberType?(this._hideProfileSelectLayer(),!1):(this.spawn(d.MSG.MESSAGE_INPUT_PROFILE_CHANGE,t),!1)}}},initialize:function(e){this._bandNo=e.bandNo,this._currentProfileMemberType=e.currentProfileMemberType,this._memberProfileArray=e.memberProfileArray},onRender:function(){var e=t.chain(this._memberProfileArray).map((function(e){return[e.memberType,e]})).object().value();this.getUI("currentProfile").DUProfile({memberProfile:e[this._currentProfileMemberType],size:21}),this.getUI("selectableProfile").each(t.bind((function(t,n){var o=i(n);o.DUProfile({memberProfile:e[o.data("member-type")]})}),this))},onAttach:function(){this.listenTo(s.getDGlobalChannel(),s.EVENT.HTML_CLICK,(function(){this._hideProfileSelectLayer()}))},changeProfileData:function(e,t){this._currentProfileMemberType=e,this._memberProfileArray=t,this.render()},getSelectedProfileMemberType:function(){return this._currentProfileMemberType},_showProfileSelectLayer:function(){var e=this.ui.profileSelectBtn.scrollParent();if(e[0].nodeType!=u.DOCUMENT){var t=e.scrollTop(),n=t+this.ui.profileSelectBtn.offset().top-128-e.offset().top;this.ui.profileListUl.toggleClass("-bottom",t>n)}this.ui.profileListUl.show(),this.ui.profileSelectBtn.addClass(c.ELEMENT.ACTIVE),this.ui.profileSelectBtn.attr("aria-expanded","false")},_hideProfileSelectLayer:function(){this.ui.profileListUl.hide(),this.ui.profileSelectBtn.removeClass(c.ELEMENT.ACTIVE),this.ui.profileSelectBtn.attr("aria-expanded","true")}}),p=function(e,t){return null==e||null==t?null:{memberType:e.memberType,name:e.name,thumbnail:l.makeProfileThumbnailUrl(e.profileImageUrl),activeClass:e.memberType===t?c.ELEMENT.ACTIVE:""}},m=function(e,n){return null==e?[]:t.map(e,(function(e){return p(e,n)}))};return h.buildDMessageInputProfileView=function(e){return new h(e)},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(537),s={getImageFile:function(e){var t=this.getItems(e),n=i.first(t),s=n?n.getAsFile():null;return s&&o.isImageType(s)?s:null},getItems:function(e){return e?(e.originalEvent&&(e=e.originalEvent),(e.clipboardData||{}).items||null):null}};e.exports=s},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(2),s=n(4),a=n(52),r=n(159),l=n(623),c=n(1094),d=n(508),u=n(1005),h=n(565),p=n(154),m=n(505),_=n(26),g=n(1038),f=n(560),b=n(1013),v=n(509),A=n(1032),E=s.View.extend({template:i.template('<div class="_commentListRegion"></div>'),attributes:{"data-viewname":"DPhotoCommentListView"},behaviors:[r],ui:{commentListRegion:"._commentListRegion"},regions:{commentListRegion:"@ui.commentListRegion"},onMessages:(t={},t[r.MSG.COMMENT_GO_FIRST_COMMENT]=function(){this._fetchFirstCommentList()},t[r.MSG.COMMENT_PREVIOUS_MORE]=function(){this._fetchPreviousAndNextAllCommentList()},t[r.MSG.COMMENT_NEXT_MORE]=function(){this._fetchNextCommentList()},t[r.MSG.COMMENT_DELETE_COMMENT]=function(e){this._deleteComment(e)},t[r.MSG.COMMENT_SUBMIT_MODIFICATION]=function(e){this._modifyComment(e)},t[r.MSG.COMMENT_SHOW_VIDEO_CLICK]=function(e){this._checkAndShowVideo(e)},t[r.MSG.EMOTIONLIST_LAYER_OPEN]=function(e){var t=null!=e.originCommentId?A.PHOTO_COMMENT_COMMENT:A.PHOTO_COMMENT,n=v.buildByAttributes({photoNo:this._photoNo,contentType:t.getContentTypeKey(),originCommentId:e.originCommentId,commentId:e.commentId});g.openDEmotionListView(this._bandNo,n)},t[r.MSG.EMOTION_SELECT_LAYER_OPEN]=function(e){this._openEmotionSelectLayer(e)},t[r.MSG.VIDEO_AUTO_PLAY]=function(e){e.processNoplayVideo()},t),passMessages:function(){var e={};return e[r.MSG.COMMENT_AREA_CLICKED]=r.MSG.PROPAGATION_STOP,e}(),initialize:function(e){this._bandData=e.bandData,this._bandNo=this._bandData.getBandNo(),this._photoNo=e.photoNo,this._flexibleTooltipPositionSupport=e.flexibleTooltipPositionSupport,this._initCommentId=e.initCommentId,this._initCommentReplyId=e.initCommentReplyId,this._isCommentingPermitted=e.isCommentingPermitted},onAttach:function(){this._commentCollectionView=this._createCollectionView(),this._commentCollection=this._createCommentCollection(),this.showChildView("commentListRegion",this._commentCollectionView),p.wrapActivePromise(this._fetchFirstViewCommentList(),this)},isModificationStatus:function(){return!(this.isDestroyed()||!this._commentCollectionView)&&this._commentCollectionView.isModificationMode()},toggleIfInputStickerShow:function(e){this.ui.commentListRegion.toggleClass("stickerOn",e)},fetchAroundComment:function(e){return this._commentCollection.fetchAroundCommentList(e).then(i.bind((function(e){this._commentCollectionView.setOldestCommentShow(!1),this._populateFetchedCollectionWithReset(e)}),this))},setInitCommentId:function(e){this._initCommentId=e},scrollToCommentWithDelay:function(e){this._commentCollectionView.scrollToCommentWithDelay(e)},scrollToComment:function(e){this._commentCollectionView.scrollToComment(e)},_fetchNextAllCommentList:function(){return this._commentCollectionView.isEmptyCollection()?this._fetchLastCommentList():this._nextParams?void 0:this._commentCollection.fetchCommentList(this._updateParams).then(i.bind((function(e){return this._populateFetchedCollection(e,{next:!0})}),this))},_fetchFirstViewCommentList:function(){return this._initCommentId?this.fetchAroundComment(this._initCommentId).then(i.bind((function(){if(this._initCommentReplyId)return this._commentCollectionView.renderReplyListAndFocus(this._initCommentId,this._initCommentReplyId);this._commentCollectionView.scrollToComment(this._initCommentId)}),this)):this._fetchLastCommentList()},_createCollectionView:function(){var e={maxMessageLength:d.MAX_LENGTH,overMaxLengthAlertMessage:IM("comment.over_max_message",{count:d.MAX_LENGTH}),flexibleTooltipPositionSupport:this._flexibleTooltipPositionSupport,isCommentingPermitted:this._isCommentingPermitted,replySupport:this._bandData.canWriteReply(),canUsePaging:this._bandData.canMoveToMoreComment(),canExpressEmotion:this._bandData.canExpressEmotionOnComment(),canOpenMediaViewer:this._bandData.canOpenMediaViewerOnComment(),canDownloadFile:this._bandData.canDownloadFileOnComment(),canOpenSnippetUrl:this._bandData.canOpenSnippetUrlOnComment(),mentionOption:h.buildMentionOption({memberGroupMentionPossible:!0,dynamicSearchPossible:!0})};return c.buildDCommentCollectionView(e)},_populateFetchedCollection:function(e,t){if(!this._commentCollectionView.isDestroyed()){this._populatePagingParams(e,t);var n=this._convertCommentCollectionToViewArray(e);this._commentCollectionView.populateFetchedCollection(n,e.getTotalCount(),!1,null!=this._previousParams,null!=this._nextParams),this._triggerChangeCollection()}},_convertCommentCollectionToViewArray:function(e){var t=e.getContentKeyButCommentId();return e.map(i.bind((function(e){return u.buildByDetailDComment(e,this._bandData,t,!1,null,!1,!0)}),this))},_triggerChangeCollection:function(){this.spawn(r.MSG.COMMENTLIST_CHANGE_COLLECTION)},_fetchFirstCommentList:function(){return this._commentCollection.fetchCommentList(this._firstParams).then(i.bind((function(e){this._populateFetchedCollectionAndChangeSortOrder(e,!0,{previous:!0,next:!0})}),this))},_populateFetchedCollectionAndChangeSortOrder:function(e,t,n){this._commentCollectionView.isDestroyed()||(this._commentCollectionView.isOldestCommentShow()!=t?(this._commentCollectionView.setOldestCommentShow(t),this._populateFetchedCollectionWithReset(e)):this._populateFetchedCollection(e,n))},_populatePagingParams:function(e,t){var n=e.getPagingData();t.previous&&(this._previousParams=n.previous_params,this._firstParams=n.first_params),t.next&&(this._nextParams=n.next_params,this._updateParams=n.update_param)},_populateFetchedCollectionWithReset:function(e){if(!this._commentCollectionView.isDestroyed()){this._populatePagingParams(e,{previous:!0,next:!0});var t=this._convertCommentCollectionToViewArray(e);this._commentCollectionView.populateFetchedCollection(t,e.getTotalCount(),!0,null!=this._previousParams,null!=this._nextParams),this._triggerChangeCollection()}},_fetchPreviousAndNextAllCommentList:function(){o.when(this._fetchPreviousCommentList(),this._fetchNextAllCommentList())},_fetchPreviousCommentList:function(){return this._commentCollection.fetchCommentList(this._previousParams).then(i.bind((function(e){return this._populateFetchedCollection(e,{previous:!0})}),this))},_fetchLastCommentList:function(){return this._commentCollection.fetchLastCommentList().then(i.bind((function(e){this._commentCollectionView.setOldestCommentShow(!1),this._populateFetchedCollectionWithReset(e)}),this))},_fetchNextCommentList:function(){return this._commentCollection.fetchCommentList(this._nextParams).then(i.bind((function(e){return this._populateFetchedCollection(e,{next:!0})}),this))},_deleteComment:function(e){var t=IM("web.commentdetail.comment.confirm.delete_comment");if(e.isReplyExist&&(t=IM("comment.delete_parent_confirm")),confirm(t)){var n=e.contentKey,o=n.getCommentId();p.wrapActivePromise(m.deleteComment(this._bandNo,n.toApiParams(!0)),this).then(i.bind((function(){this._commentCollectionView.deleteCommentOnView(o,null!=this._previousParams,null!=this._nextParams),this._triggerChangeCollection(),_.getCommentChannel().trigger(_.EVENT.BAND_FILE_UPDATED),_.getCommentChannel().trigger(_.EVENT.COMMENT_DELETED,n)}),this))}},_modifyComment:function(e){f.modifyComment(this._bandNo,e,this).then(i.bind((function(t){var n={};n.comments=a.camelizeKeys(t.comment),n.totalCount=e.totalCount,_.getCommentChannel().trigger(_.EVENT.BAND_FILE_UPDATED);var i=this._createCommentCollection();this._populateFetchedCollection(i.populateDetailCommentData(n),{}),this.spawn(r.MSG.COMMENTLIST_SHOW_INPUT)}),this),(function(){e.modificationView.releaseModificationProgress()}))},_checkAndShowVideo:function(e){e.view.showVideo()},_openEmotionSelectLayer:function(e){var t=null!=e.originCommentId?A.PHOTO_COMMENT_COMMENT:A.PHOTO_COMMENT,n=b.buildDEmotionSelectViewByContentKey({bandNo:this._bandNo,contentKey:v.buildByAttributes({photoNo:this._photoNo,contentType:t.getContentTypeKey(),originCommentId:e.originCommentId,commentId:e.commentId}),emotionTypeByViewer:e.emotionTypeByViewer});e.view.showEmotionSelectView(n)},_createCommentCollection:function(){return l.buildDetailCommentCollection({bandNo:this._bandNo,ownerContentKey:v.buildPhotoKey(this._photoNo),contentKeyButCommentId:v.buildPhotoCommentKey(this._photoNo,null)})}});return E.buildDPhotoCommentListView=function(e){return new E(e)},E}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){n(2);var t=n(0),i=n(4),o=n(1357),s=n(1050),a=n(1120),r=(n(26),n(169)),l=i.View.extend({tagName:"div",className:r.PREVIEW_SUPPORT,attributes:{"data-viewname":"DContentTranslationView"},template:t.template(o),ui:{loading:"._loading",seeTranslationBtn:"._seeTranslationBtn",settingWrap:"._settingWrap",settingToggleBtn:"._settingToggleBtn",viewOriginalBtn:"._viewOriginalBtn",settingRegion:"._settingRegion"},regions:{settingRegion:{el:"@ui.settingRegion",replaceElement:!0}},events:{"click @ui.seeTranslationBtn":function(){this._translationChannel.seeTranslation()},"click @ui.settingToggleBtn":function(){this.getRegion("settingRegion").hasView()||t.defer(t.bind((function(){var e=a.build({translationChannel:this._translationChannel});this.listenToOnce(e,"destroy",(function(){this.isAttached()&&(this.ui.settingToggleBtn.removeClass("-underline"),this.ui.settingWrap.css({"z-index":""}))})),this.showChildView("settingRegion",e),this.ui.settingToggleBtn.addClass("-underline"),this._translationChannel.isHighZIndex()&&this.ui.settingWrap.css({"z-index":3400})}),this))},"click @ui.viewOriginalBtn":function(){this._translationChannel.seeOriginal()}},initialize:function(e){this._translationChannel=e.translationChannel,this.listenTo(this._translationChannel,s.EVENT.TRANSLATION_START,this._showLoading),this.listenTo(this._translationChannel,s.EVENT.TRANSLATION_END,(function(){this.isAttached()&&this._hideLoading()}))},onRender:function(){this._hideLoading(),this._translationChannel.supportsContentBottom()||this.$el.css({display:"none"})},_showLoading:function(){this.ui.loading.css({display:""}),this.$el.css({display:""})},_hideLoading:function(){var e=this._translationChannel.isOriginalShown();this.ui.loading.css({display:"none"}),this.ui.seeTranslationBtn.css({display:e?"":"none"}),this.ui.settingWrap.css({display:e?"none":""})}});return l.build=function(e){return new l(e)},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1358),s=n(26),a=n(531),r=n(491),l=n(514),c=n(651),d=n(503),u=i.Object.extend({initialize:function(e){this._bandNo=e.bandNo,this._owner=e.owner,this._recurrence=e.recurrence,this._contentType=e.contentType,this._photoUrl=e.photoUrl,this._scheduleId=e.scheduleId,this._reportSchedulePhoto()},_reportSchedulePhoto:function(){var e=t.bind((function(){r.getCachedBandData(this._bandNo).then(t.bind((function(e){var n=e&&e.isContentsDeletionPermitted(),i=e&&e.isBanMemberPermitted()&&!this._owner.get("role").leader,s={userNo:this._owner.get("userNo"),bandNo:this._bandNo,scheduleId:this._scheduleId,canDelete:n,canBanMember:i,isRecurrence:!!this._recurrence};if(n||i){var a=o.buildAsLayer(s);this.listenTo(a,"DScheduleDeleteWithReportView:scheduleDeleted",t.bind((function(){this._deleteScheduleConfirm(c.EDIT_TYPE.ALL)}),this))}}),this))}),this),n={};n=this._contentType==a.REPORT.TYPE.PHOTO?{contentType:a.REPORT.TYPE.PHOTO,bandNo:this._bandNo,scheduleId:this._scheduleId,schedulePhotoUrl:this._photoUrl,fnCallback:e}:{contentType:a.REPORT.TYPE.SCHEDULE,bandNo:this._bandNo,scheduleId:this._scheduleId,fnCallback:e},l.openScheduleReportPopup(n)},_deleteScheduleConfirm:function(e){confirm(IM("schedule.detail.message.confirmdelete"))&&this._deleteSchedule(e).then(t.bind((function(){s.getDGlobalChannel().trigger(s.EVENT.SCHEDULE_DELETED,{bandNo:this._bandNo,scheduleId:this._scheduleId})}),this))},_deleteSchedule:function(e){return d.deleteSchedule(this._bandNo,this._scheduleId,e)}});return u.build=function(e){return new u(e)},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(6),s=n(4),a=n(1376),r=n(1035),l=n(1151),c=n(486),d=n(516),u=n(26),h=n(153),p=n(513),m=n(720),_=n(1377),g=n(780),f=n(1004),b=n(13),v=n(152),A=n(606),E=n(1036);n(591);var T=r.WATCHER_TYPE,C=v.VIEW_POST_READERS_MAX_MEMBER_COUNT,y=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEndedLiveVideoWatcherListLayerView"},template:t.template(a),templateContext:function(){var e="";return this._isMyViewMode?e=IM("media_viewer.video.my_watch_ratio.title"):this._isWatchersMode&&(e=IM("video_viewer_list.title")),{WATCHER_TYPE:T,title:e,liveWatcherCount:this.collection.getLiveWatcherCount(),videoWatcherCount:this.collection.getVideoWatcherCount(),nonWatcherCount:this.collection.getNonWatcherCount(),isVideoWatcherTabEnabled:!!this._videoId,isMyViewMode:this._isMyViewMode,isWatchersMode:this._isWatchersMode,isBigBand:this._isBigBand}},ui:{btnWatcherList:"._btnWatcherList",tabDesc:"._tabDesc",btnChatWithNonWatchers:"._btnChatWithNonWatchers",descMaxWatcherCountOver:"._descMaxWatcherCountOver",btnMoreMenu:"._btnMoreMenu",menuLayer:"._menuLayer",btnExcelDownload:"._btnExcelDownload",btnPrint:"._btnPrint",btnConfirm:"._btnConfirm"},regions:{watcherListRegion:{el:"._watcherListRegion",replaceElement:!0}},events:{"click @ui.btnWatcherList":function(e){this._changeWatcherType($(e.currentTarget).data("watcherType"))},"click @ui.btnChatWithNonWatchers":function(e){var n=t.map(this._getChatableNonWatcherModels(),(function(e){return new g(e.getMember().toJSON(),{parse:!0})})),i=f.openAsLayer(this._bandData,new o.Collection(n,{parse:!0}));this.listenTo(i,"member:selected",(function(e){var t=e.map((function(e){return e.pick("userNo","name")}));m.startChattingWithUsers(t,this._bandNo)}))},"click @ui.btnMoreMenu":function(e){this.getUI("menuLayer").is(":visible")||t.defer(t.bind((function(){this.getUI("menuLayer").show()}),this))},"click @ui.btnExcelDownload":function(e){e.preventDefault();var t=[_.CHECKBOX_MENUS.LIVE_WATCHER];if(this._videoId&&(t.splice(1,0,_.CHECKBOX_MENUS.VIDEO_WATCHER),this._isBigBand||t.push(_.CHECKBOX_MENUS.NON_WATCHER)),this._videoId){var n=_.openAsLayer({description:IM("schedule.rsvp.select_download_item.desc"),checkboxMenus:t});this.listenTo(n,_.EVENT.SELECTED,(function(e){this._creteExcelFileAndDownload(e)}))}else{var i=[_.CHECKBOX_MENUS.LIVE_WATCHER.value];this._creteExcelFileAndDownload(i)}},"click @ui.btnPrint":function(e){e.preventDefault();var t=[_.CHECKBOX_MENUS.LIVE_WATCHER];if(this._videoId&&(t.splice(1,0,_.CHECKBOX_MENUS.VIDEO_WATCHER),this._isBigBand||t.push(_.CHECKBOX_MENUS.NON_WATCHER)),this._videoId){var n=_.openAsLayer({description:IM("schedule.rsvp.select_print_item.desc"),checkboxMenus:t});this.listenTo(n,_.EVENT.SELECTED,(function(e){this._openWatcherListPrintView(e)}))}else{var i=[_.CHECKBOX_MENUS.LIVE_WATCHER.value];this._openWatcherListPrintView(i)}},"click @ui.btnConfirm":"destroy"},initialize:function(e){if(this._bandData=e.bandData,this._bandNo=this._bandData.getBandNo(),this._liveId=e.liveId,this._videoId=e.videoId,this._isEveryMemberIncluded=!t.isBoolean(e.isEveryMemberIncluded)||e.isEveryMemberIncluded,this._isBigBand=!this._isEveryMemberIncluded,this._viewLiveWatcherRoles=e.viewLiveWatcherRoles,this._viewVideoWatcherRoles=e.viewVideoWatcherRoles,this._isMyViewMode=this._bandData.canViewMyViewingProgress(),this._isWatchersMode=this._bandData.canViewVideoWatcher(),this._isMyViewMode){var n=this.collection.get(b.getUserData().getUserNo()),i={};i[T.LIVE_WATCHER]=n.getLiveViewPercentage()||0,i[T.VIDEO_WATCHER]=n.getVideoViewPercentage()||0,n.set({watcherTypes:[T.LIVE_WATCHER,T.VIDEO_WATCHER],viewPercentage:i})}this.listenTo(u.getDGlobalChannel(),u.EVENT.HTML_CLICK,(function(){this.getUI("menuLayer").hide()}))},onAttach:function(){this._showTabDesc(T.LIVE_WATCHER),this._showWatcherList(T.LIVE_WATCHER),this._showWatcherListFooterDesc(T.LIVE_WATCHER)},_showWatcherList:function(e){this.getRegion("watcherListRegion").empty(),this._watcherListView=new l({collection:this.collection,bandData:this._bandData,watcherType:e,isEveryMemberIncluded:this._isEveryMemberIncluded}),this.showChildView("watcherListRegion",this._watcherListView)},_changeWatcherType:function(e){this.getUI("btnWatcherList").parent("span").removeClass("-on"),this.getUI("btnWatcherList").filter('[data-watcher-type="'+e+'"]').parent("span").addClass("-on"),this._showTabDesc(e),this._toggleBtnChatWithNonWatchers(e),this._watcherListView.filterWatcherType(e),this._showWatcherListFooterDesc(e)},_getChatableNonWatcherModels:function(){return t.filter(this.collection.getNonWatchers(),(function(e){return!e.getMember().isMyself()}))},_toggleBtnChatWithNonWatchers:function(e){if(this._isBigBand)this.getUI("btnChatWithNonWatchers").hide();else{var t=this._getChatableNonWatcherModels().length;e===T.NON_WATCHER&&t>0?this.getUI("btnChatWithNonWatchers").show():this.getUI("btnChatWithNonWatchers").hide()}},_showTabDesc:function(e){var n=[],o=0;switch(e){case T.LIVE_WATCHER:o=(o=i.numberFormat(this.collection.getLiveWatcherCount()))>=C?C-1+"+":o,n.push(IM("live.watcher.tab_desc.live_watcher_desc2",{watcherCount:String(o)})),this._isWatchersMode&&!t.isEmpty(this._viewLiveWatcherRoles)&&n.push(IM("media_viewer.video.watcher.tab_desc.permission_desc."+this._viewLiveWatcherRoles.join("_"))),n[n.length-1]=n[n.length-1]+" "+IM("media_viewer.video.watcher.tab_desc.initially_viewed_at");break;case T.VIDEO_WATCHER:o=(o=this.collection.getVideoWatcherCount())>=C?C-1+"+":o,n.push(IM("live.watcher.tab_desc.video_watcher_desc2",{watcherCount:String(o)})),this._isWatchersMode&&!t.isEmpty(this._viewVideoWatcherRoles)&&n.push(IM("media_viewer.video.watcher.tab_desc.permission_desc."+this._viewVideoWatcherRoles.join("_"))),n[n.length-1]=n[n.length-1]+" "+IM("media_viewer.video.watcher.tab_desc.initially_viewed_at")}t.isEmpty(n)?this.getUI("tabDesc").hide():(this.getUI("tabDesc").html(n.join("<br>")),this.getUI("tabDesc").show())},_getWatcherListFooterDesc:function(e){return e!=T.LIVE_WATCHER&&e!=T.VIDEO_WATCHER||(e===T.LIVE_WATCHER?this.collection.getLiveWatcherCount():this.collection.getVideoWatcherCount())<C?"":IM("member_list.max_count_info",{maxMemberCount:C})},_showWatcherListFooterDesc:function(e){var n=this._getWatcherListFooterDesc(e);t.isEmpty(n)?this.getUI("descMaxWatcherCountOver").hide():(this.getUI("descMaxWatcherCountOver").text(n),this.getUI("descMaxWatcherCountOver").show())},_openWatcherListPrintView:function(e){var t=h.GROUP_BAND_ENDED_LIVE_VIDEO_WATCHER_PRINT.makeUrl({band_no:this._bandNo,live_id:this._liveId},{videoId:this._videoId,watcherTypes:e.join(",")});p.openWindowXSSSafely(t,"_blank")},_creteExcelFileAndDownload:function(e){var n={A:IM("live.watcher.excel.column_title.member_name"),B:IM("live.watcher.excel.column_title.live_watcher")};this._videoId&&(n.C=IM("live.watcher.excel.column_title.video_watcher"));var i=this.collection.chain().filter((function(n){return!t.isEmpty(t.intersection(n.getWatcherTypes(),e))})).map(t.bind((function(e){var t={A:e.getMember().getName(),B:Math.floor(e.getLiveViewPercentage()||0)+""||null};return this._videoId&&(t.C=Math.floor(e.getVideoViewPercentage()||0)+""||null),t}),this)).value();i.unshift(n);var o,s=E.utils.json_to_sheet(i,{header:["A","B","C"],skipHeader:!0}),a=E.utils.book_new(),r=this._bandData.getBandName()+"_video_"+this._liveId+".xlsx";t.each(s,(function(e,t){/^[B|C]/.test(t)&&"B1"!==t&&"C1"!==t&&"s"===e.t&&(s[t].v=s[t].v/100,s[t].t="n",s[t].z="#0%")})),s["!cols"]=[{wch:30},{wch:20},{wch:20}],E.utils.book_append_sheet(a,s,IM("video_viewer_list.title")),o=E.write(a,{bookType:"xlsx",bookSST:!0,type:"binary"}),A.saveAs(new Blob([this._s2ab(o)],{type:"application/octet-stream"}),r)},_s2ab:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i!=e.length;++i)n[i]=255&e.charCodeAt(i);return t}});return y.openAsyncAsLayerForNotPostedLive=function(e,t){return this.openAsyncAsLayer(e,null,t,null,null)},y.openAsyncAsLayer=function(e,t,n,i,o){var s=e.getBandNo(),a=d.getEndedLiveVideoWatchers(s,t,n,i,o).then((function(i){return new y({bandData:e,liveId:n,videoId:t,isEveryMemberIncluded:i.is_every_member_included,viewLiveWatcherRoles:i.view_live_watcher_roles,viewVideoWatcherRoles:i.view_video_watcher_roles,collection:new r(i.watchers,{parse:!0})})}));return c.openPromiseView(a,!0,{width:480,height:544}),a},y}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1121),s=n(1122),a=n(82),r={wide:o.create([{containerClass:"-webtoon",contentClass:"gMiddleItem"},9/16,{containerClass:"-vertical",contentClass:""},.9,{containerClass:"-square",contentClass:""},1.1,{containerClass:"-horizontal",contentClass:""},3,{containerClass:"-panorama",contentClass:"gCenterItem"}]),narrow:o.create([{containerClass:"-webtoon",contentClass:"gMiddleItem"},9/16,{containerClass:"-vertical",contentClass:""},.9,{containerClass:"-square",contentClass:""},1.1,{containerClass:"-horizontal",contentClass:""},254/85,{containerClass:"-panorama",contentClass:"gCenterItem"}])},l=i.View.extend({options:{isGif:!1,photoUrl:"",width:1,height:1,ratioType:"wide"},tagName:"A",className:function(){var e=["photo"];this.options.isGif&&e.push("-gif");var t=r[this.options.ratioType].identify(this.options.width/this.options.height);return e.push(t.containerClass),Math.max(this.options.width,this.options.height)<150&&"wide"===this.options.ratioType&&e.push("-w150"),e.join(" ")},attributes:{"data-viewname":"DCommentAttachedPhotoView",href:"#",role:"button"},template:t.template('<img src="<%- photoUrl %>" alt="" class="photoImage <%- imgClass %>">'),templateContext:function(){var e=r[this.options.ratioType].identify(this.options.width/this.options.height);this.options.photoUrl;return{photoUrl:s.useHighQualityImage()?a.make(this.options.photoUrl,a.TYPE.e1280_std):a.make(this.options.photoUrl,a.TYPE.w500),imgClass:e.contentClass}},triggers:{click:"showMedia"}});return l.buildDCommentAttachedPhotoView=function(e,t,n,i,o){var s={isGif:i,photoUrl:e,width:t,height:n};return o&&(s.ratioType=o),new l(s)},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){e.exports=n(1385)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(43),s=n(52),a=n(630),r=(n(631),n(632),n(731)),l=n(734),c=n(529),d=n(13),u=n(735),h=n(666),p=n(610),m=n(722),_=n(651),g=n(616),f=n(1619),b=n(733),v=n(723),A=n(549),E=n(165),T=n(531),C=i.Model.extend({getName:function(){return this.get("name")},setName:function(e){this.set("name",e)},getDescription:function(){return this.get("description")},setDescription:function(e){this.set("description",e)},isLocalMeetup:function(){return 1==this.get("isLocalMeetup")},setIsLocalMeetup:function(e){this.set("isLocalMeetup",e)},isSecret:function(){return this.get("isSecret")},setIsSecret:function(e){this.set("isSecret",e)},getSecretSharers:function(){return this.get("secretSharers")},setSecretSharers:function(e){this.set("secretSharers",e)},createSecretSharers:function(e){this.setSecretSharers(m.buildScheduleSharerCollection(e))},getPhotos:function(){return this.get("photos")},setPhotos:function(e){this.set("photos",e)},getPhotoCount:function(){return null==this.getPhotos()?0:this.getPhotos().length},addPhotos:function(e){var t=this.getPhotos();null==t&&(t=r.buildSchedulePhotoCollection([])),t.add(e,{parse:!0}),this.setPhotos(t)},deleteSchedulePhoto:function(e){var t=this.getPhotos().find((function(t){return e.url==t.getUrl()}));this.getPhotos().remove(t)},isPhotoAttached:function(){return null!=this.getPhotos()&&!this.getPhotos().isEmpty()},getFiles:function(){return this.get("files")},setFiles:function(e){this.set("files",e)},getFileCount:function(){return null==this.getFiles()?0:this.getFiles().length},isFileAttached:function(){return null!=this.getFiles()&&!this.getFiles().isEmpty()},addFiles:function(e){var n=this.getFiles();null==n&&(n=b.buildScheduleFileCollection([])),n.add(t.map(e,(function(e){return a.buildNewUploadedFile(e)}))),this.setFiles(n)},deleteScheduleFile:function(e){this.getFiles().remove(e.getAttachId())},getDropboxFiles:function(){return this.get("dropboxFiles")},isDropboxFileAttached:function(){return null!=this.getDropboxFiles()&&!this.getDropboxFiles().isEmpty()},deleteScheduleDropboxFile:function(e){this.getDropboxFiles().remove(e.getFileId())},getExternalFiles:function(){return this.get("externalFiles")},isExternalFileAttached:function(){return null!=this.getExternalFiles()&&!this.getExternalFiles().isEmpty()},deleteScheduleExternalFile:function(e){this.getExternalFiles().remove(e.getFileId())},isAnyTypeFileAttached:function(){return this.isFileAttached()||this.isDropboxFileAttached()||this.isExternalFileAttached()},getCalendar:function(){return this.get("calendar")},setCalendar:function(e){this.set("calendar",e)},getStartAtMoment:function(){return this.get("startAtMoment")},setStartAtMoment:function(e){this.set("startAtMoment",e)},getLunarStartAtMoment:function(){return this.get("lunarStartAtMoment")},setLunarStartAtMoment:function(e){this.set("lunarStartAtMoment",e)},getEndAtMoment:function(){return this.get("endAtMoment")},setEndAtMoment:function(e){this.set("endAtMoment",e)},getLunarEndAtMoment:function(){return this.get("lunarEndAtMoment")},setLunarEndAtMoment:function(e){this.set("lunarEndAtMoment",e)},getScheduleTimeZoneId:function(){return this.get("scheduleTimeZoneId")},getDefaultScheduleTimeZoneId:function(){return this.getScheduleTimeZoneId()||E.getCurrentTimezoneId()},setScheduleTimeZoneId:function(e){this.set("scheduleTimeZoneId",e)},getOwner:function(){return this.get("owner")},getRsvp:function(){return this.get("rsvp")},hasRsvp:function(){return null!=this.getRsvp()},setRsvp:function(e){this.set("rsvp",e)},getAlarms:function(){return this.get("alarms")},setAlarms:function(e){this.set("alarms",e)},isAllDay:function(){return 1==this.get("isAllDay")},setIsAllDay:function(e){this.set("isAllDay",e)},isLunar:function(){return 1==this.get("isLunar")},setIsLunar:function(e){this.set("isLunar",e)},getLocation:function(){return this.get("location")},setLocation:function(e){this.set("location",e)},getRecurrence:function(){return this.get("recurrence")},setRecurrence:function(e){this.set("recurrence",e)},isRecurrenceExist:function(){return!t.isEmpty(this.getRecurrence())},getScheduleId:function(){return this.get("scheduleId")},setScheduleId:function(e){this.set("scheduleId",e)},hasDifferentTimezone:function(){if(null==this.getScheduleTimeZoneId())return!1;var e=E.getCurrentTimezone();return this.getScheduleTimeZoneId()!=e.id},toScheduleModel:function(e){var t=A.createScheduleModel(e,null);return t.setName(this.getName()),t.setOwner(this.getOwner()),t.setDescription(this.getDescription()),t.setIsLocalMeetup(this.isLocalMeetup()),t.setCalendar(this.getCalendar()),t.setIsLunar(this.isLunar()),t.setStartAt(y(this.getStartAtMoment())),t.setEndAt(y(this.getEndAtMoment())),t.setStartAtAsLunar(y(this.getLunarStartAtMoment())),t.setEndAtAsLunar(y(this.getLunarEndAtMoment())),t.setIsAllDay(this.isAllDay()),t.setScheduleTimeZoneId(this.getScheduleTimeZoneId()),t.setPhotos(this.getPhotos()||r.buildSchedulePhotoCollection([])),t.setFiles(this.getFiles()||b.buildScheduleFileCollection([])),t.setDropboxFiles(this.getDropboxFiles()||l.buildScheduleDropboxFileCollection([])),t.setExternalFiles(this.getExternalFiles()||u.buildScheduleExternalFileCollection([])),t.setAlarms(this.getAlarms()||new v([])),t.setLocation(this.getLocation()),t.setRecurrence(this.getRecurrence()),t.setRsvp(this.getRsvp()),t.setIsSecret(this.isSecret()),t.setSecretSharers(this.getSecretSharers()),t.setScheduleId(this.getScheduleId()),t},resetByImport:function(e,n){var i=this._convertBaseJsonForEditView(e,n),o=i.startAtMoment;if(i.startAtMoment=this._adjustStartDateForImport(o),i.endAtMoment=this._adjustEndDateForImport(o,i.endAtMoment,i.startAtMoment),i.isLunar){var s=f.fromMoment(i.startAtMoment);if(i.startAtAsLunar=s.toISO(),null!=i.endAt){var a=f.fromMoment(i.endAtMoment);i.endAtAsLunar=a.toISO()}}var r={isLocalMeetup:this.isLocalMeetup(),owner:this.getOwner()};this.clear(),this.set(t.extend(r,i))},resetForCopyByImport:function(e,n){e.calendar=null,this.clear();var i={isLocalMeetup:!1,isSecret:!1,secretSharers:m.buildScheduleSharerCollection(null),owner:this.getOwner()};this.set(t.extend(i,this._convertBaseJsonForEditView(e,n)))},_adjustStartDateForImport:function(e){var t=o(),n=o(e).year(t.year()).month(t.month()).date(t.date());return t.isBefore(e)?n:n.add(1,"day")},_adjustEndDateForImport:function(e,t,n){if(null==t)return null;var i=o(n),s=o.duration(t.diff(e));return i.add(s)},_convertBaseJsonForEditView:function(e,n){var i=s.camelizeKeys(e),a={name:i.name,description:i.description,calendar:t.isEmpty(i.calendar)?null:new h(s.decamelizeKeys(i.calendar),{parse:!0}),isLunar:i.isLunar,isSecret:i.isSecret,secretSharers:m.buildScheduleSharerCollection(i.secretSharers),startAtMoment:o(i.startAt),endAtMoment:null==i.endAt?null:o(i.endAt),lunarStartAtMoment:null==i.startAtAsLunar?null:o(i.startAtAsLunar),lunarEndAtMoment:null==i.endAtAsLunar?null:o(i.endAtAsLunar),isAllDay:i.isAllDay,scheduleTimeZoneId:i.scheduleTimeZoneId,photos:null==i.photos?null:r.buildSchedulePhotoCollection(i.photos),files:null==i.files?null:b.buildScheduleFileCollection(i.files||[],{newFileForSave:!0}),dropboxFiles:null==i.dropboxFiles?null:l.buildScheduleDropboxFileCollection(i.dropboxFiles||[],{newFileForSave:!0}),externalFiles:null==i.externalFiles?null:u.buildScheduleExternalFileCollection(i.externalFiles||[],{newFileForSave:!0}),alarms:null==i.alarms?null:new v(i.alarms,{parse:!0}),location:null!=i.location&&n?new g(i.location,{parse:!0}):null,recurrence:null==i.recurrence?null:new _(i.recurrence,{parse:!0})};if(i.rsvp){var c=o(i.rsvp.endedAt).diff(o(),"days");i.rsvp.endedAt&&c<=0&&(i.rsvp.endedAt=o().add(1,"days").add(1,"hours").valueOf()),i.rsvp.customStates&&(i.rsvp.customStates=t.map(i.rsvp.customStates,(function(e){return{title:e.title}}))),a.rsvp=new p(s.decamelizeKeys(i.rsvp),{parse:!0})}return a}});function y(e){if(null!=e)return e.format(T.BAND_SCHEDULE_TIME_FORMAT)}return C.createScheduleEditModel=function(e){var t={startAtMoment:e,owner:c.buildContentAuthorModel({userNo:d.getUserData().getUserNo()})};return new C(t)},C.createLocalMeetupModel=function(e){var t=C.createScheduleEditModel(e);return t.setIsLocalMeetup(!0),t.setRsvp(p.createDefaultScheduleRsvpModel()),t},C.createScheduleEditModelBy=function(e,t){var n=e.getFiles(),i=e.getDropboxFiles(),o=e.getExternalFiles();t&&(n=null==n?null:b.buildScheduleFileCollection(n.toJSON(),{newFileForSave:!0}),i=null==i?null:l.buildScheduleDropboxFileCollection(i.toJSON(),{newFileForSave:!0}),o=null==o?null:u.buildScheduleExternalFileCollection(o.toJSON(),{newFileForSave:!0}));var s={owner:e.getOwner(),name:e.getName(),description:e.getDescription(),isLocalMeetup:e.isLocalMeetup(),isSecret:e.isSecret(),secretSharers:e.getSecretSharers()?e.getSecretSharers().clone():e.getSecretSharers(),calendar:e.getCalendar(),isLunar:e.isLunar(),startAtMoment:e.getStartAtMoment().isValid()?e.getStartAtMoment():null,endAtMoment:e.getEndAtMoment().isValid()?e.getEndAtMoment():null,lunarStartAtMoment:e.getStartAtAsLunarMoment().isValid()?e.getStartAtAsLunarMoment():null,lunarEndAtMoment:e.getEndAtAsLunarMoment().isValid()?e.getEndAtAsLunarMoment():null,isAllDay:e.isAllDay(),scheduleTimeZoneId:e.getScheduleTimeZoneId(),photos:e.getPhotos(),files:n,dropboxFiles:i,externalFiles:o,alarms:e.getAlarms(),location:e.getLocation(),recurrence:e.getRecurrence(),rsvp:e.getRsvp(),scheduleId:e.getScheduleId()};return new C(s)},C}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){n(0);return{alertRespondedMemberExist:function(){alert(IM("postwrite.attach.poll.alert_voted_member_exist"))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){var e="notice",t="major_notice";return{isNotificationTypePost:function(n){return!!n&&(!(n.get("noticeState")!=e&&!n.get("isNotice"))||!(n.get("noticeState")!=t&&!n.get("isMajorNotice")))},isMajorNoticePost:function(e){return!!e&&!(e.get("noticeState")!=t&&!e.get("isMajorNotice"))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(4),s=n(2025),a=n(2415),r=o.Object.extend({EVENT:{UPLOAD:"UPLOAD"},initialize:function(e){this._inputElement=e.inputElement,this._inputTitle=e.inputTitle,this._inputClick=e.inputClick,this._bandNo=e.bandNo,this._skinColor=e.skinColor,this._readPhotographedAt=e.readPhotographedAt,this._countInfo=e.countInfo,this._useUploadView=!1!==e.useUploadView,this._albumNo=e.albumNo,this._albumSelectable=e.albumSelectable,this._addToAlbum=e.addToAlbum,this._submitBtnText=e.submitBtnText,this._openWithoutHiding=e.openWithoutHiding,this._uploadType=e.uploadType,this._uploadView=null,this._createUploader()},onDestroy:function(){this._destroyUploader()},_createUploader:function(){this._uploader=s.create({inputElement:this._inputElement,inputTitle:this._inputTitle,inputClick:this._inputClick,bandNo:this._bandNo,skinColor:this._skinColor,readPhotographedAt:this._readPhotographedAt,countInfo:this._countInfo,uploadType:this._uploadType,useAutoUploadType:!1,useLocalFilePreview:this._useUploadView}),this.listenTo(this._uploader,this._uploader.EVENT.ADD,(function(e){var t=e.uploadResultList,n=e.localFileList;this._uploader.resetItem(),this._useUploadView?this._openUploadView(t,n):this._triggerUpload({bandNo:this._bandNo,uploadResultList:t})}))},_destroyUploader:function(){this._uploadView&&!this._uploadView.isDestroyed()&&this._uploadView.destroy(),this._uploader&&(this._uploader.destroy(),this._uploader=null)},_openUploadView:function(e,t){var n=this._albumSelectable;i.isFunction(n)&&(n=n()),a.openLayer({bandNo:this._bandNo,skinColor:this._skinColor,readPhotographedAt:this._readPhotographedAt,countInfo:this._countInfo,albumNo:this._albumNo,albumSelectable:n,addToAlbum:this._addToAlbum,submitBtnText:this._submitBtnText,openWithoutHiding:this._openWithoutHiding,uploadType:this._uploadType,uploadResultList:e,localFileList:t}).then(i.bind((function(e){this._uploadView=e,this.listenTo(this._uploadView,this._uploadView.EVENT.SUBMIT,this._triggerUpload)}),this))},_triggerUpload:function(e){this.trigger(this.EVENT.UPLOAD,e)}});r.createPhotoUploader=function(e){return new r(i.extend({uploadType:s.UPLOAD_TYPE.PHOTO},e))},r.createVideoUploader=function(e){return new r(i.extend({uploadType:s.UPLOAD_TYPE.VIDEO},e))},r.createPhotoOrVideoUploader=function(e){return new r(i.extend({uploadType:s.UPLOAD_TYPE.PHOTO_OR_VIDEO},e))},e.exports=r},function(e,t,n){var i=n(0),o=n(16),s=n(9);function a(e){return s.format.date(e,"year_month_day")}t.formatYMD=a,t.formatStartAndEnd=function(e,t){return i.chain([e,t]).compact().map(a).value().join("-")},t.formatAttachmentPeriod=function(e,t,n,i){function o(e){return s.format.date(e,i)}return t&&n?[o(t),o(n)].join(" ~ "):t?o(t)+" ~":n?[o(e),o(n)].join(" ~ "):o(e)},t.addSheetToExcelData=function(e,t,n){"onesheet"===n.sheet&&e.sheets.length>0?e.sheets[0].data=e.sheets[0].data.concat(i.rest(t.data)):e.sheets.push(t)},t.setCreateAtToExcelData=function(e,t){if(e.properties||(e.properties={}),e.properties.createdAtFirst){var n=e.properties.createdAtFirst;e.properties.createdAtFirst>t&&(e.properties.createdAtFirst=t,t=n),(!e.properties.createdAtLast||e.properties.createdAtLast<t)&&(e.properties.createdAtLast=t)}else e.properties.createdAtFirst=t},t.createFileName=function(e,t,n){var s,a;return n.properties&&(s=n.properties.createdAtFirst,a=n.properties.createdAtLast),i.compact([e,t,s?o(s).format("YYYYMMDD"):void 0,a?o(a).format("YYYYMMDD"):void 0]).join("_")+".xlsx"}},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(2602),a=n(152),r=n(1659),l=n(154),c=n(159),d=n(633),u=n(890);n(56);var h=o.View.extend({tagName:"div",className:"uWidget",attributes:function(){var e={"data-viewname":"DPostSnippetView"};return this.options.attachmentDisplayType==a.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},template:i.template(s),ui:{snippetLink:"._snippetLink",imageWrap:"._imageWrap",youtubeVideo:"._youtubeVideo"},behaviors:function(){return[{behaviorClass:u,bandNo:this.options.bandNo,postNo:this.options.postNo,model:this.options.model,attachmentDisplayType:this.options.attachmentDisplayType,bPostDetail:this.options.bPostDetail,viewDataSetter:i.bind(this._setViewData,this),playYoutubeVideo:i.bind(this._playYoutubeVideo,this)}]},initialize:function(e){},serializeData:function(){return{isOembedStyle:this._viewData.isOembedStylePostSnippet(),oembedHtml:this._viewData.getPostSnippetOembedHtml(),linkUrl:this._viewData.isYoutubeStylePostSnippet()?null:this._viewData.getPostSnippetLinkUrl(),imageType:this._viewData.getPostSnippetImageType(),imageUrl:this._viewData.getPostSnippetImageUrl(),isVideo:this._viewData.isVideoPostSnippet(),isYoutubeStyle:this._viewData.isYoutubeStylePostSnippet(),youtubeUrl:this._viewData.getPostSnippetYoutubeUrl(),title:this._viewData.getPostSnippetTitle(),titleClass:this._getTitleClass(),description:this._viewData.getPostSnippetDescription(),descriptionClass:this._getDescriptionClass(),footerText:this._viewData.getPostSnippetFooterText()}},_setViewData:function(e){this._viewData=e},_getTitleClass:function(){var e=!i.isEmpty(this._viewData.getPostSnippetDescription());switch(this._viewData.getPostSnippetImageType()){case d.TYPE_HEIGHT_IS_LONGER:return e?"-multi3line":"-multi5line";case d.TYPE_WIDTH_IS_LONGER:return"-multiline";default:return e?"-multiline":"-multi3line"}},_getDescriptionClass:function(){return this._viewData.getPostSnippetImageType()==d.TYPE_HEIGHT_IS_LONGER?"-multi5line":"-multiline"},_playYoutubeVideo:function(){var e,n=!0,o=this.ui.imageWrap.width(),s=this.ui.imageWrap.height();return t.browser.msie&&10==t.browser.versionNumber&&(n=!1,this.ui.imageWrap.hide()),e=r.buildDVideoPlayer({$videoTag:this.ui.youtubeVideo,posterUrl:this._viewData.getPostSnippetImageUrl(),videoUrl:this._viewData.getPostSnippetYoutubeUrl(),hideBigPlayOnInit:!0,width:o,height:s,hideOnInit:n,useYoutubeControls:!0}),this.listenTo(e,"videoPlayer:play",(function(){this.spawn(c.MSG.DYOUTUBE_SNIPPET_PLAYED)})),this.listenTo(e,"videoPlayer:pause",(function(){this.spawn(c.MSG.DYOUTUBE_SNIPPET_PAUSED)})),l.wrapActivePromise(e.initVideoPlayer(),this).then(i.bind((function(){return e.showContainerAndLayers(),this.ui.imageWrap.hide(),this.ui.youtubeVideo.show(),e.playOrPause(),e}),this))}});return h.build=function(e){return new h({bandNo:e.bandNo,postNo:e.postNo,model:e.model,attachmentDisplayType:e.attachmentDisplayType})},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(82),s=n(2605),a=n(152),r=n(633),l=n(487),c=n(155),d=n(84),u=n(153),h=n(736),p=i.View.extend({options:{bandData:null,attachmentDisplayType:null},attributes:function(){var e={"data-viewname":"DPostSubpostView"};return this.options.attachmentDisplayType===a.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},className:function(){var e="uWidget";return this.options.bPostDetail&&!this.options.bandData.canOpenPostAttachmentSubpostUrl()&&(e+=" gCursorDefault"),e},template:t.template(s),behaviors:[h,l],ui:{attachmentSubpost:"._attachmentSubpost"},events:{"click @ui.attachmentSubpost":function(){var e=this.subpostModel.get("actionUrl");if(!e)return alert(IM("web.post.subpost.alert.not_supported_in_web")),!1;this._checkSubpostURLAndOpen(e),this._sendSubPostClickLog()},"ScreenIntersectionBehavior:exposed":function(e,t){this._sendSubPostExposureLog()}},initialize:function(e){this.subpostModel=e.model,this.bandNo=e.bandNo,this.postNo=e.postNo},serializeData:function(){var e=this.subpostModel.get("image");return this.attachmentDisplayType=this.options.attachmentDisplayType,null==this.subpostModel.rawResponse.body.image?this._thumbnailType="false":this._thumbnailType=r.getSnippetThumbnailTypeOfImage({url:this.subpostModel.get("image"),width:this.subpostModel.rawResponse.body.image.width,height:this.subpostModel.rawResponse.body.image.height}),this._thumbnailType!==r.TYPE_NO_IMAGE&&this.attachmentDisplayType===a.ATTACHMENT_DISPLAY_TYPE.HEADER&&(this._thumbnailType=r.TYPE_SQUARE),this._thumbnailUrl=/^https?:\/\//.test(e)?o.makePostSnippetThumbnailUrl(this._thumbnailType,e):"",{thumbnailType:this._thumbnailType,snippetImage:e,thumbnailUrl:this._thumbnailUrl,title:this.subpostModel.get("title"),description:this.subpostModel.get("description"),subtitle:this.subpostModel.get("subtitle"),titleLineClass:this._getTitleLineClass(),descriptionLineClass:this._getDescriptionLineClass()}},_openSubpostUrl:function(){return window.open(this.subpostModel.get("actionUrl"),"_blank"),this.subpostModel.requestActionCallback(),!1},_checkSubpostURLAndOpen:function(e){if(u.GROUP_BAND_MISSION_MEMBERS.isMatched(e)){var n=d.extractPageRouteData(u.GROUP_BAND_MISSION_MEMBERS,e).pathVariables.band_no,i=c.get(n);i.loadBandData().then(t.bind((function(){i.canAccessMissionConfirm()?this._openSubpostUrl():alert(IM("subpost.link.join.band.alert.msg"))}),this))}else this._openSubpostUrl()},_getTitleLineClass:function(){var e=this.subpostModel.get("description");switch(this._thumbnailType){case r.TYPE_HEIGHT_IS_LONGER:return e?"-multi3line":"-multi5line";case r.TYPE_WIDTH_IS_LONGER:return"-multiline";default:return e?"-multiline":"-multi3line"}},_getDescriptionLineClass:function(){return this._thumbnailType===r.TYPE_HEIGHT_IS_LONGER?"-multi5line":"-multiline"},_sendSubPostExposureLog:function(){this.subpostModel.rawResponse.body.action.pc&&this.jplExposure(l.CLASSIFIER.SUB_POST_AREA,{band_no:this.bandNo,post_no:this.postNo,subpost_value:this.subpostModel.rawResponse.body.action.pc})},_sendSubPostClickLog:function(){this.subpostModel.rawResponse.body.action.pc&&this.jplClick(l.CLASSIFIER.SUB_POST_AREA,{band_no:this.bandNo,post_no:this.postNo,subpost_value:this.subpostModel.rawResponse.body.action.pc})}});return p.build=function(e){return new p({model:e.model,bandNo:e.bandNo,postNo:e.postNo})},p}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(167),o=n(166),s=n(1287);return{getBandLabOptions:function(){var e=JSON.parse(i.getCurrentUserEnvStorage().get(o.BandLabOptions))||{},n=new s;return!t.isEmpty(e)&&n.setOptionValues(e),n},getBandLabOption:function(e){return window.isInHouseNetwork?this.getBandLabOptions().get(e):this.getBandLabOptions().defaults()[e]},isBandLabOptionEnabled:function(e){return window.isInHouseNetwork&&this.getBandLabOptions().get(e).enabled},setBandLabOption:function(e,t){var n=JSON.parse(i.getCurrentUserEnvStorage().get(o.BandLabOptions))||{};n[e]=t,i.getCurrentUserEnvStorage().set(o.BandLabOptions,JSON.stringify(n))},getPostTemplates:function(e){var t=this.getBandLabOption(s.OPTION_KEYS.POST_TEMPLATE);return t.enabled?(JSON.parse(i.getCurrentUserEnvStorage().get(t.envStorageKey))||{})[e]:null},savePostTemplate:function(e,t,n){var a=this.getBandLabOption(s.OPTION_KEYS.POST_TEMPLATE);if(a.enabled){var r=JSON.parse(i.getCurrentUserEnvStorage().get(a.envStorageKey))||{};r[e]||(r[e]={}),r[e][t]=n,i.getCurrentUserEnvStorage().set(o.PostTemplates,JSON.stringify(r))}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(166),s={DARK_MODE:"darkMode",POST_TEMPLATE:"postTemplate",HIDE_POST_FROM_OTHERS:"hidePostFromOthers"},a=i.Model.extend({defaults:function(){var e={};return e[s.DARK_MODE]={title:"화면 모드",desc:"화면 모드 설정입니다.",key:s.DARK_MODE,enabled:!1},e[s.POST_TEMPLATE]={title:"게시글 템플릿으로 저장하기/불러오기",desc:"작성중인 게시글을 템플릿으로 저장하고 이후에 불러올 수 있습니다.",envStorageKey:o.PostTemplates,key:s.POST_TEMPLATE,enabled:!1},e[s.HIDE_POST_FROM_OTHERS]={title:"클린 필터 글 숨기기 기능 사용",desc:"클린 필터로 숨겨진 것 것처럼 개별밴드 게시글을 숨김 처리할 수 있습니다.",key:s.HIDE_POST_FROM_OTHERS,enabled:!1},e},setOptionValues:function(e){t.each(e,t.bind((function(e,t){var n=this.get(t);n&&(n.enabled=e)}),this))}});return a.OPTION_KEYS=s,a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="profileInner <%- profileInnerClass %>">\n    <% if (roleLabel) { %>\n    <span class="gSrOnly"><%-roleLabel%></span>\n    <% } %>\n    <% if (hasProfileImage) { %>\n    <img src="<%-profileImageThumbnail%>" class="_image" width="<%-imageSize%>" height="<%-imageSize%>" alt="<%-name %>" <%= (lazyLoading) ? \'loading="lazy"\':\'\' %> <%= (useCORS) ? \'crossorigin="use-credentials"\':\'\' %>>\n    <% } %>\n</span>\n'},function(e,t){e.exports='<div class="lyContent <% if (pageStyle) { %> -flexible <% } %>" style="width: 320px; <% if (pageStyle) { %> height:412px <% } else { %> min-height:412px <% } %>">\n<% if (msg_modelFetched) { %>\n        <header class="modalHeader -profile <% if (showLeaderTermAsManager) { %> -pageProfile <% } %><% if(!pageStyle) { %> -noTitlebar <% } %>">\n            <span class="gSrOnly"><%-IM(\'web.profile.title\')%></span>\n            <% if (role) { %>\n            <p class="desc <% if (createdAt) { %> gMat15 <% } else { %> gMat40 <% } %>">\n                <% if (showLeaderTermAsManager) { %>\n                    <% if (role === \'leader\') { %>\n                    <strong class="leader"><%-IM("pageband.member.leader")%></strong>\n                    <% } else if (role === \'coleader\') { %>\n                    <strong class="coleader"><%-IM("pageband.member.coleader")%></strong>\n                    <% } %>\n                <% } else { %>\n                    <% if (role === \'leader\') { %>\n                    <strong class="leader"><%-IM(\'web.band.member.role.leader\')%></strong>\n                    <% } else if (role === \'coleader\') { %>\n                    <strong class="coleader"><%-IM(\'web.band.member.role.coleader\')%></strong>\n                    <% } else { %>\n                    <strong class="member"><%-IM(\'web.band.member.role.member\')%></strong>\n                    <% } %>\n                <% } %>\n                <% if (createdAt) { %> Since <%-createdAtText%> <% } %>\n            </p>\n            <% } %>\n        </header>\n        <div class="modalBody">\n            <div class="profileInfo <% if (pageStyle) { %> pageProfileInfo <% } else { %> -tSpace43 <% } %> ">\n                <div class="roundCover">\n                    <% if (profileImageUrl) { %>\n                    <a href="#" role="button" class="uProfile -size140 -border _imgProfile">\n                        <span class="profileInner <%- profileInnerClass %>"><img src="<%-profileImageThumbnail%>" width="140" height="140" alt="<%-name%>"></span>\n                    </a>\n                    <% } else { %>\n                    <span class="uProfile -size140">\n                        <span class="profileInner"></span>\n                    </span>\n                    <% } %>\n                </div>\n                <div class="userInfo gPal25 gPar25 gPat15 gPab38">\n                    <h1 class="userName"><%-name%></h1>\n                    <% if (description) { %>\n                    <p class="userNickname"><%-description%></p>\n                    <% } %>\n                    <% if (memberDisabledStatusText) { %>\n                    <p class="disabledText"><%- memberDisabledStatusText %></p>\n                    <% } %>\n                    <% if (birthday || cellphone) { %>\n                    <p class="userEtc">\n                        <% if (birthday) { %>\n                        <span class="birthday"><%-IM(\'web.profile.label.birthday\') %> <%-birthdayText%></span>\n                        <% } %>\n                        <% if(cellphone) { %>\n                        <span class="phoneNumber"><%-cellphoneText%></span>\n                        <% } %>\n                    </p>\n                    <% } %>\n                    <% if(showBtnSendMessage || showBtnEditProfile || showBtnGoToSearchMemberPost || showBtnGoToSearchMemberComment || showBtnUnmuteMember) { %>\n                    <div class="roundBtns gMab-5">\n                        <% if (showBtnSendMessage) { %>\n                        <button type="button" class="chat _btnSendMessage"><span></span> <%- pageStyle ? IM(\'pageband.main.page_action.send_message\') : IM(\'web.profile.label.chat\') %></button>\n                        <% } %>\n                        <% if (showBtnEditProfile) { %>\n                        <button type="button" class="set _btnEditProfile"><span></span> <%-IM(\'web.profile.label.edit\')%></button>\n                        <% } %>\n                        <% if (showBtnGoToSearchMemberPost && !showBtnUnmuteMember) { %>\n                        <button type="button" class="post _btnGotoSearchMemberContent"><span></span> <%-IM(\'web.profile.label.member_post\')%></button>\n                        <% } %>\n                        <% if (showBtnGoToSearchMemberComment) { %>\n                        <button type="button" class="comment _btnGotoSearchMemberContent"><span></span> <%-IM(\'web.profile.label.member_comment\')%></button>\n                        <% } %>\n                        <% if (showBtnUnmuteMember) { %>\n                        <button type="button" class="unBlock _unmuteMember"><span></span> <%= IM(\'web.profile.label.unmute_member\') %></button>\n                        <% } %>\n                    </div>\n                    <% } %>\n                    <% if (isMuted) { %>\n                    <div class="blockMessage gPat22 gPab0"><%= IM(\'web.profile.muted_member.guide_message\') %></div>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n        <footer class="modalFooter gPat0 gPab0">\n            <div class="memberOption">\n                <% if (showBtnBandChat || showBtnBanMember || showBtnBlockCommentAndChat || showBtnReportMemberProfile) { %>\n                <button type="button" class="btnOption _btnManageMember"><span class="gSrOnly"><%= IM("profile_layer.label.member_management") %></span></button>\n                <div class="lyMenu _lyManageMember" style="display: none;">\n                    <ul>\n                        <% if (showBtnBandChat) { %> <li><a class="_btnBanChat" href="#"><%= IM("profile_layer.label.ban_chat") %></a></li> <% } %>\n                        <% if (showBtnJoinInfo) { %><li><a class="_btnJoinInfo" href="#"><%- IM("bandjoin.join_info_show") %></a></li><% } %>\n                        <% if (showBtnBanMember) { %>\n                            <li><a class="_btnBanMember" href="#">\n                                <% if (isMember) { %>\n                                    <%= IM("profile_layer.label.ban_member") %>\n                                <% } else { %>\n                                    <%= IM("profile_layer.label.block_join") %>\n                                <% } %>\n                            </a></li>\n                        <% } %>\n                        <% if (showBtnBlockCommentAndChat) { %>\n                            <% if (isAlreadyBlockedCommentAndChat) { %>\n                            <li><a class="_btnBlockCommentAndChat" href="#"><%-IM(\'profile_layer.label.release_block_comment_and_chat\')%></a></li>\n                            <% } else { %>\n                            <li><a class="_btnBlockCommentAndChat" href="#"><%-IM(\'profile_layer.label.block_comment_and_chat\')%></a></li>\n                            <% } %>\n                        <% } %>\n                        <% // 멤버 프로필 신고하기 %>\n                        <% if (showBtnReportMemberProfile) { %>\n                        <li><a class="_btnReportMemberProfile" href="#"><%= IM("ui.label.report") %></a></li>\n                        <% } %>\n                    </ul>\n                </div>\n                <% } %>\n            </div>\n\n            <button type="button" class="uButton -iconClose btnLyClose _btnClose"><span class="gSrOnly"><%-IM(\'web.profile.btn.close\')%></span></button>\n        </footer>\n<% } %>\n</div>'},function(e,t){e.exports='<div class="lyContent -wFull -originalProfileImg _lyContent">\n    <header class="gSrOnly">\n        <h1><%-IM(\'web.profile.view_photo.title\')%></h1>\n    </header>\n\n    <div class="main -spaceNone">\n        <img src="<%-thumbnailUrl%>" alt="<%-name%>" class="originalProfileImg">\n    </div>\n\n    <footer class="footer -h0">\n        <button type="button" class="btnLyClose -fixed uButton -iconCloseL _btnClose"><%-IM(\'web.profile.btn.close\')%></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=n(4),a=n(1292),r=n(558),l=n(1033),c=n(600),d=n(157),u=n(82),h=n(156),p=n(164),m=n(486),_=n(518),g=n(1112),f=n(1297),b=n(510),v=n(507),A=n(521),E=n(572),T=n(174),C=n(534),y=n(495),M=n(487),I=n(152),S=n(1243),w=n(1022),N=n(1002),D=n(540),L=i.template('<img src="<%- image %>" width="140" height="140" alt="<%- IM("photo") %>">'),O=s.View.extend({behaviors:[{behaviorClass:y,sceneId:y.SCENE.SET_USER_BAND_PROFILE},M],tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditProfileView"},template:i.template(a),templateContext:function(){var e=this.model.isPermittedModifyOpenBirthday(),t=!i.isEmpty(this.model.getModifyOpenCellphonePermittedOperations()),n={};n[w.ANYONE]=IM("profile.edit.label.open_cellphone.setting_permission.anyone"),n[w.UNTIL_COLEADER]=IM("profile.edit.label.open_cellphone.setting_permission.coleader"),n[w.ONLY_LEADER]=IM("profile.edit.label.open_cellphone.setting_permission.leader"),n[w.NO_ONE]=IM("profile.edit.label.open_cellphone.setting_permission.not_open");var o=S.getAcceptableOpenCellphoneMemberRoles(this.model.getModifyOpenCellphonePermittedOperations(),this.model.getOpenCellphoneRoles()),s=i.map(S.getAllSelectableOpenCellphoneMemberRoles(this.model.getModifyOpenCellphonePermittedOperations()),(function(e){return{value:e.toString(),label:n[e],selected:e.isSame(o)}})),a=T.toDisplayPhoneNumber(this.model.get("cellphone"));return this.model.get("me")&&!i.isEmpty(this.model.get("cellphone"))&&(a=C.transformInternationalPhoneNumber(a)),{vid:this.cid,bandName:this._bandData.getBandCore().name,showProfileDescription:this._bandData.getBandCore().supportProfileDescription(),isPageProfileTitle:this._bandData.getBandCore().showBandTermAsPage(),showDescriptionArea:this._bandData.getBandCore().supportMemberProfileDescription(),myProfileUrl:d.GLOBAL_MY_PROFILE.makeUrl(),isShowBirthdayArea:e,isShowCellphoneArea:t,openCellphoneOptions:s,birthdayText:E.makeBirthdayLabel(this.model.get("birthday"),this.model.get("isLunar")),cellphoneText:a,showMyProfileLink:e||t,authorNameMaxLength:I.AUTHOR_NAME_MAX_LENGTH,isOpenBirthday:this.model.get("isOpenBirthday"),isUndefinedOpenBirthday:this.model.isUndefinedOpenBirthday(),isUndefinedOpenCellphoneRoles:this.model.isUndefinedOpenCellphoneRoles(),canEditBirthdayOpenOption:this._bandData.canEditBirthdayOpenOption(),canEditCellphoneOpenOption:this._bandData.canEditCellphoneOpenOption()}},ui:{helpBtn:"._helpBtn",helpWrap:"._helpWrap",imageWrap:"._imageWrap",menuBtn:"._menuBtn",menuWrap:"._menuWrap",fileWrap:"._fileWrap",deletePhotoLink:"._deletePhotoLink",otherProfilesLink:"._otherProfilesLink",nameInput:"._nameInput",descriptionInput:"._descriptionInput",selectOpenCellphoneRoles:"._selectOpenCellphoneRoles",postingWrap:"._postingWrap",postingCheckbox:"._postingCheckbox",confirmBtn:"._confirmBtn",closeBtn:"._closeBtn",useProfileImageAgreementInfo:"._useProfileImageAgreementInfo",selectOpenBirthday:"._selectOpenBirthday",closedBirthdaySet:"._closedBirthdaySet",closedCellphoneSet:"._closedCellphoneSet"},events:{"click @ui.helpBtn":function(){this._toggleLayer(this.ui.helpWrap)},"click @ui.menuBtn":function(){this._toggleLayer(this.ui.menuWrap)},"click @ui.deletePhotoLink":function(e){e.preventDefault(),this._setImage(null)},"click @ui.otherProfilesLink":function(e){e.preventDefault(),this._openOtherProfiles()},"click @ui.confirmBtn":"_setMemberProfile","click @ui.closeBtn":"_close",click:"_closeAllLayers","click @ui.closedBirthdaySet":function(){if(this.model.isUndefinedOpenBirthday())return alert(IM("profile.edit.can_not_set_open")),!1},"click @ui.closedCellphoneSet":function(){if(this.model.isUndefinedOpenCellphoneRoles())return alert(IM("profile.edit.can_not_set_open")),!1}},initialize:function(e){this._doNotRefreshPageOnChange=e.doNotRefreshPageOnChange,this._bandData=e.bandData,this._bandNo=this._bandData.getBandNo(),this._profileSetCount=e.profileSetCount,this._profileSetModel=null,this._photo=null,this._image=null,this._personalInfoAgreementData=A.buildPersonalInfoAgreementData()},onRender:function(){this.ui.nameInput.val(o.trim(this.model.get("name"))),this.ui.descriptionInput&&this.ui.descriptionInput.val(o.trim(this.model.get("description"))),this._profileSetCount<2&&this.ui.otherProfilesLink.parent().remove(),this._setImage(this.model.get("profileImageUrl"))},onAttach:function(){this._createProfilePhotoUploader(),this._getPersonalInfoAgreementData(),this.jplSceneEnter(M.CLASSIFIER.SET_USER_BAND_PROFILE,{band_no:this._bandData.getBandNo()})},onBeforeDetach:function(){this._destroyProfilePhotoUploader()},_getPersonalInfoAgreementData:function(){return this._personalInfoAgreementData.fetchAgreementData().then(i.bind((function(e){e.isProfileImageCollectable()||this.getUI("useProfileImageAgreementInfo").show()}),this))},_setValuesWithProfileSetModel:function(e){this._profileSetModel=e,this.ui.nameInput.val(o.trim(e.get("name"))),this._setImage(e.get("profileImageUrl"))},_setValuesWithPhoto:function(e){e&&(this._photo=e,this._setImage(e.url))},_setImage:function(e){var t=!!e;if(t){var n=u.makeGifSupportedProfileUrl(e,p.s276_gif);this.ui.imageWrap.html(L({image:n})).toggleClass("-gifProfileBg",h.isGif(n))}else this.ui.imageWrap.empty().removeClass("-gifProfileBg");this._image=e,this.ui.postingWrap.toggle(this._canPostProfileImageChanging()),this.ui.postingCheckbox.prop("checked",!1),this.ui.deletePhotoLink.parent().toggle(t)},_close:function(e){!0!==e||this._doNotRefreshPageOnChange?this.destroy():window.location.reload()},_setMemberProfile:function(){if(this.ui.nameInput.val()){if(!this._onsubmit){this._onsubmit=!0;var e={bandNo:this.model.get("bandNo"),name:this.ui.nameInput.val(),description:this.ui.descriptionInput?this.ui.descriptionInput.val():null,profileImageUrl:this._image,isOpenBirthday:"true"==this.getUI("selectOpenBirthday").val(),openCellphoneRoles:this.getUI("selectOpenCellphoneRoles").val()};if(this.model.hasDifferenceWith(e)){var n=this.model.hasProfileSetDifference(e),o=this.ui.postingCheckbox.prop("checked");this._makePhotoForPostingIfSizeNotExist().then(i.bind((function(){this.model.updateBandMemberProfile(e,this._profileSetModel,o,this._photo).then(i.bind((function(){this._personalInfoAgreementData.setPersonalInfoAgreements(A.AGREE_TARGET.PROFILE_IMAGE).then(i.bind((function(){n?t.when(_.fetchProfileSets(!0),r.fetchMemberWithBand(this._bandNo)).then(i.bind((function(e,t){e.hasOtherProfiles(t)?this._openBandProfileSetSelectView(e,t):this._close(!0)}),this)):this._close(!0)}),this))}),this))}),this))}else this._close()}}else alert(IM("web.profile.alert.input_name"))},_openBandProfileSetSelectView:function(e,t){var n=b.openLayer({bodyDesc:IM("profile.confirm.apply_other_bands"),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no")});n.once(b.EVENTS.CONFIRM,i.bind((function(){this._close(),f.openLayer({collection:e,beforeProfileModel:this.model,afterProfileModel:t,doNotRefreshPageOnChange:this._doNotRefreshPageOnChange})}),this)),n.once(b.EVENTS.CANCEL,i.bind((function(){this._close(!0)}),this))},_openOtherProfiles:function(){g.openLayer({profileModel:this.model,bandData:this._bandData}).then(i.bind((function(e){this.listenToOnce(e,"DProfileSetSelectView",(function(e,t){e===g.EVENTS.PROFILE_SET_SELECTED&&this._setValuesWithProfileSetModel(t)}))}),this))},_toggleLayer:function(e){e.is(":visible")||i.defer(i.bind(e.show,e))},_closeAllLayers:function(e){this.isDestroyed()||this.ui.helpWrap.is(e.target)||this.ui.helpWrap.find(e.target).length>0||(this.ui.helpWrap.hide(),this.ui.menuWrap.hide())},_extractFileData:function(e){var t=new FileReader;t.onload=i.bind((function(e){return e.target.result}),this),t.readAsDataURL(e)},_createProfilePhotoUploader:function(){this._destroyProfilePhotoUploader(),this._profilePhotoUploader=c.createProfilePhotoUploader(this.ui.fileWrap,{autoUpload:!1}),this.listenTo(this._profilePhotoUploader,v.SELECT_FILES,(function(e){if(e.files[0].type.indexOf("gif")>-1)return this._profilePhotoUploader.setContinueAutoUpload(),!1;this._profilePhotoUploader.loadFileReaderResize(e.files[0]).then(i.bind((function(e){var t={title:IM("web.upload.title.profile_photo"),cropOptions:{}},n=N.build(e,t);this.listenTo(n,"crop:complete",(function(e){n.destroy(),D.uploadDataUriImage(e).then(i.bind((function(e){this._setValuesWithPhoto(e)}),this))})),this.listenTo(n,"crop:cancel",(function(){n.destroy()}),this)}),this))})),this.listenTo(this._profilePhotoUploader,v.UPLOAD_COMPLETE,(function(e){this._setValuesWithPhoto(i.first(i.propertyOf(e)("resultList")))}))},_destroyProfilePhotoUploader:function(){this._profilePhotoUploader&&(this._profilePhotoUploader.destroy(),this._profilePhotoUploader=null)},_makePhotoForPostingIfSizeNotExist:function(){var e=t.Deferred();if(!this.ui.postingCheckbox.prop("checked")||null==this._image)return e.resolve();if(this._photo&&this._photo.height&&this._photo.width)return e.resolve();var n=new Image,o=t(n);return o.on("load",i.bind((function(){this._photo={url:this._image,width:n.width,height:n.height},o.off(),e.resolve()}),this)),n.src=this._image,e.promise()},_canPostProfileImageChanging:function(){return!(!this._bandData.canPostMyProfileChanged()||null==this._image)&&o.trim(this._image)!=o.trim(this.model.get("profileImageUrl"))}});return O.openLayer=function(e){var n=e.bandNo,o=l.createBandMemberProfileEditModel({},n),s=t.when(_.fetchProfileSetCount(),o.fetchBandMember()).then((function(t){return new O(i.extend({bandData:e.bandData,model:o,profileSetCount:t},e))}));m.openPromiseView(s,!1,{width:380,height:446})},O}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w380 _wrap">\n    <header class="modalHeader -noTitlebar -profile">\n        <h1 class="title gPat14 gPal9"><%= isPageProfileTitle ? IM(\'page_band.profile.layer.title\') : IM(\'web.profile.layer.title\') %></h1>\n        <p class="desc gMal10"><%- bandName %></p>\n        <% if (showProfileDescription) { %>\n        <dl class="uHelpGuide -w330">\n            <dt><button type="button" class="_helpBtn"><span class="gSrOnly"><%= IM(\'web.profile.btn.help\') %></span></button></dt>\n            <dd class="_helpWrap"><strong class="title"><%= IM(\'web.profile.help.title\') %></strong>\n                <%= IM(\'web.profile.help.description\') %>\n            </dd>\n        </dl>\n        <% } %>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap">\n            <div class="chooseProfilePicture">\n                <div class="profileWrap">\n                <span class="uProfile -size140 -border">\n                    <span class="profileInner _imageWrap">\n                    </span>\n                </span>\n                    <button class="photoSubmit _menuBtn"><span class="gSrOnly"><%= IM(\'web.profile.label.edit\') %></span></button>\n                    <div class="lyMenu _menuWrap" style="display:none;">\n                        <ul>\n                            <li><label class="_fileWrap"><%= IM(\'profile.choose_profile_image\') %><input type="file" accept="image/*" name="attachment"></label></li>\n                            <li><a href="#" class="_deletePhotoLink"><%= IM(\'profile.delete_photo\') %></a></li>\n                            <li><a href="#" class="_otherProfilesLink"><%= IM(\'profile.view_other_profiles\') %></a></li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n            <div class="uInput">\n                <label for="name_<%- vid %>" class="gSrOnly"><%= IM(\'web.profile.label.name\') %></label>\n                <input class="_nameInput" type="text" id="name_<%- vid %>" placeholder="<%- IM(\'web.profile.placeholder.input_name\') %>" maxlength="<%= authorNameMaxLength %>" value="<%- name %>">\n                <span class="border"></span>\n            </div>\n            <% if (showDescriptionArea) { %>\n            <div class="uInput gMat8">\n                <label for="description_<%- vid %>" class="gSrOnly"><%= IM(\'web.profile.label.desc\') %></label>\n                <input class="_descriptionInput" type="text" id="description_<%- vid %>" placeholder="<%- IM(\'web.profile.placeholder.input_desc\') %>" maxlength="50" value="<%- description %>">\n                <span class="border"></span>\n            </div>\n            <% } %>\n            <div class="profileOptionBox gMat9">\n                <ul class="profileOptionList">\n                    <% // 생일 공개 설정 %>\n                    <% if(canEditBirthdayOpenOption) { %>\n                    <li class="profileOptionItem">\n                    <% if (_.isEmpty(birthdayText)) { %>\n                        <label class="flexList">\n                            <div class="text">\n                                <%= IM(\'web.profile.label.open_birthday\') %>\n                                <p class="pText -lightGray2 gFs13 gPal1"><%= IM(\'profile.edit.desc.no_birthday\') %></p>\n                            </div>\n                        </label>\n                    <% } else { %>\n                        <label class="flexList _closedBirthdaySet">\n                            <div class="text">\n                                <%= IM(\'web.profile.label.open_birthday\') %>\n                                <p class="pText -lightGray2 gFs13 gPal1"><%= birthdayText %></p>\n                            </div>\n                            <div class="etc gMat-2">\n                                <div class="uSelect -h32 -bg -block gColorBk2" style="min-width:105px">\n                                    <select id="memberBirthday" class="_selectOpenBirthday" <% if(isUndefinedOpenBirthday){ %>disabled=\'disabled\'<% } %>>\n                                        <option value="true" <% if (isOpenBirthday) { %> selected<% } %>><%- IM(\'profile.edit.birthday.open_text\') %></option>\n                                        <option value="false" <% if (isUndefinedOpenBirthday || !isOpenBirthday) { %> selected<% } %>><%- IM(\'profile.edit.birthday.close_text\') %></option>\n                                    </select>\n                                </div>\n                            </div>\n                        </label>\n                    <% } %>\n                    </li>\n                    <% } %>\n\n                    <% // 휴대폰 공개 범위 설정 %>\n                    <% if(canEditCellphoneOpenOption) { %>\n                    <li class="profileOptionItem">\n                        <% if (_.isEmpty(cellphoneText)) { %>\n                            <label class="flexList">\n                                <div class="text">\n                                    <%= IM(\'profile.edit.label.open_cellphone\') %>\n                                    <p class="pText -lightGray2 gFs13"><%= IM(\'profile.edit.desc.no_cellphone\') %></p>\n                                </div>\n                            </label>\n                        <% } else { %>\n                            <label class="flexList _closedCellphoneSet">\n                                <div class="text">\n                                    <%= IM(\'profile.edit.label.open_cellphone\') %>\n                                    <p class="pText -lightGray2 gFs13"><%= cellphoneText %></p>\n                                </div>\n                                <div class="etc gMat-2">\n                                    <div class="uSelect -h32 -bg -block gColorBk2" style="min-width:105px">\n                                        <select id="memberCellphone" class="_selectOpenCellphoneRoles" <% if(isUndefinedOpenCellphoneRoles){ %>disabled=\'disabled\'<% } %>>\n                                        <% if(isUndefinedOpenCellphoneRoles){ %>\n                                        <option value=""><%- IM(\'profile.edit.label.open_cellphone.setting_permission.system_closed\') %></option>\n                                        <% } else {%>\n                                        <% _.each(openCellphoneOptions, function(openCellphoneOption) { %>\n                                            <option value="<%- openCellphoneOption.value %>" <% if (openCellphoneOption.selected) { %> selected<% } %>><%= openCellphoneOption.label %></option>\n                                        <% }) %>\n                                        <% } %>\n                                        </select>\n                                    </div>\n                                </div>\n                            </label>\n                        <% } %>\n                    </li>\n                    <% } %>\n\n                    <li class="profileOptionItem _postingWrap">\n                        <label for="posting_<%- vid %>" class="flexList">\n                            <span class="etc">\n                                <span class="uCheck -checkbox -noLabel">\n                                    <input type="checkbox" id="posting_<%- vid %>" class="checkInput _postingCheckbox">\n                                    <span class="checkLabel">\n                                        <span class="shape"></span>\n                                    </span>\n                                </span>\n                            </span>\n                            <span class="text"><%= IM(\'profile_layer.label.share_profile_image_changed_post\') %></span>\n                        </label>\n                    </li>\n                </ul>\n                <% if (showMyProfileLink) { %>\n                <p class="sDesc -tLine gMat9 gPat7"><%= IM(\'web.profile.txt.info_edit\', {settingUrl: myProfileUrl}) %></p>\n                <% } %>\n\n                <% // 개인정보 동의에 대한 문구 추가 %>\n                <p class="sDesc _useProfileImageAgreementInfo" style="display: none;">\n                    <span class="descInfoTxt"><%= IM("profile.edit.use_profile_image.agree_description") %></span>\n                </p>\n            </div>\n        </div>\n\n    </div>\n    <footer class="modalFooter">\n        <button type="submit" class="uButton -confirm -sizeL _confirmBtn"><%= IM(\'web.profile.btn.submit\') %></button>\n        <button type="button" class="uButton -iconClose btnLyClose _closeBtn"><span class="gSrOnly"><%= IM(\'ui.label.close_layer\') %></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(170),a=n(57),r=n(1294),l=n(537),c=n(507),d=n(35),u=n(1614),h=n(16),p=n(668);return n(202),o.Object.extend({initialize:function(e){this._initUploadUnitOption(e),this._initFileApi(this._removeNeedlessOption(e)),this._localFileProcessingPromise=t.Deferred().resolve()},onDestroy:function(){this.el&&(this.el.fileapi("abort"),this.el.fileapi("destroy"),this._inputTag.off(),this._inputTag.removeAttr("aria-disabled"),this.el.find("span:has(object)").remove(),this._removeFlashNode()),this.off(),this.el=null,this._destroyProgressBarView()},setOption:function(e){for(var t in this._initUploadUnitOption(e),e=this._removeNeedlessOption(e))e.hasOwnProperty(t)&&this.el.fileapi("option",t,e[t])},cancelUpload:function(){this.trigger(c.UPLOAD_COMPLETE,{resultList:this._uploadResult,photoUpload:this._photoUpload,videoUpload:this._videoUpload,cancelled:!0}),this.el&&this.el.fileapi("abort"),this._reset()},resume:function(e){e.event.widget.add(e.files)},resetUploader:function(){this._reset()},uploadFiles:function(e,t){if(e){i.isArray(e)||(e=[e]),t&&this.el.fileapi("option","data",t);var n=this._getWidget();n.add(e),n.active||n.options.autoUpload||n.upload()}},removeFile:function(e){if(e){var t=this._getWidget(),n=t?t.xhr:null;n&&n.remove(e),t&&t.remove(e)}},getOption:function(){return this.el&&this.el.data("fileapi")?i.clone(this.el.data("fileapi").options):{}},setValidators:function(e){this._validators=e},setShowProgress:function(e){this._showProgress=e},setContinueAutoUpload:function(){this.el.fileapi("option","autoUpload",!0)},_initUploadUnitOption:function(e){this.el=t(e.el),this._initAutoUpload=!!e.autoUpload,this._progressBarTitle=e.title||"",this._showProgress=e.showProgress||!1,this._photoUpload=1==e.photoUpload,this._videoUpload=1==e.videoUpload,this._skinColor=e.skinColor,this._readPhotographedAt=e.readPhotographedAt||!1,this.setValidators(e.validators||[])},_removeNeedlessOption:function(e){return i.omit(e,(function(e,t,n){return i.contains(["title","showProgress","validators"],t)}))},_initFileApi:function(e){var n=t.extend({multiple:!1,paramName:"attachment",maxSize:0,maxFiles:0,urlCache:!0,duplicate:!0,fileInputTitle:e.fileInputTitle||IM("web.postdetail.btn.add"),headerPopulator:function(e){var t=d.createMd(e.url);if(null!=t){var n=e.headers||{};n.md=t,e.headers=n}}},e,{clearOnSelect:!0,onClickInput:i.bind((function(e,t){this.trigger(c.INPUT_CLICK,{event:e,originalClickEvent:t})}),this),onSelect:i.bind((function(e,t){if(this.el.fileapi("option","autoUpload",!1),!this._validateFiles(t.files))return this._reset(),!1;this._initAutoUpload&&this.el.fileapi("option","autoUpload",this._initAutoUpload),this.trigger(c.SELECT_FILES,{all:t.all,duplicate:t.duplicate,files:t.files,other:t.other,photoUpload:this._photoUpload,videoUpload:this._videoUpload,event:e})}),this),onBeforeUpload:i.bind((function(e,t){if(!this._validateFiles(t.files))return this._reset(),!1;var n={files:t.files,continueUpload:!0};this.trigger(c.BEFORE_UPLOAD,n)}),this),onUpload:i.bind((function(e,t){this._showProgressBarView(),this._uploading=!0,this._uploadResult=[]}),this),onProgress:i.bind((function(e,t){}),this),onComplete:i.bind(this._onComplete,this),onFilePrepare:i.bind((function(e,t){this.trigger(c.FILE_PREPARE,{event:e,filePrepareInfo:t})}),this),onFileUpload:i.bind((function(e,t){}),this),onFileProgress:i.bind((function(e,t){var n={file:t.file,files:t.files,index:i.indexOf(t.files,t.file),fileLoadedSize:t.loaded,fileSize:t.total};t.file&&(this._showProgress&&this._progressBarView.changeProgressInfo({currentFileIndex:n.index,currentFileLoadedSize:n.fileLoadedSize,currentFileName:n.file.name,currentFileSize:n.fileSize,totalFileCount:n.files.length}),this.trigger(c.FILE_PROGRESS,n))}),this),onFileComplete:i.bind((function(e,n){if("abort"!=n.statusText)if(1==n.result.result_code){var o=n.file.type.indexOf("gif")>-1,r=n.file.type.indexOf("video")>-1;a.isWindows8Or8_1IE()&&(r=null!=n.result.result_data.playtime,o=n.result.result_data.id.indexOf(".gif")>-1);var l=t.extend({},n.result.result_data,{name:n.file.name,isGif:o,isVideo:r,isGifVideo:1==n.result.result_data.is_video,fileId:n.file.fileId});delete l.is_video;var d=t.Deferred().resolve();this._readPhotographedAt&&n.file.type.indexOf("image")>-1&&(d=t.Deferred((function(e){u.getData(n.file,(function(){var t=n.file.exifdata,o=h(t&&t.DateTimeOriginal,"YYYY:MM:DD HH:mm:ss"),s=o.isValid()?o.valueOf():void 0;s&&i.extend(l,{photographedAt:s}),e.resolve()}))}))),d=d.then(i.bind((function(){this._uploadResult.push(l),this.trigger(c.FILE_COMPLETE,n.file,l)}),this)),this._localFileProcessingPromise=t.when(this._localFileProcessingPromise,d)}else{if(200==n.result.result_code){var m="";(n.file||n.file.name)&&(m=n.file.name),p.openSimpleAlert(m+" "+IM("web.upload.noui.alert.failed"))}else if(300==n.result.result_code)return alert(IM("web.noui.alert.session_expired")),void s.goRefreshFallback();n.result.result_data||(n.result.result_data={}),this.trigger(c.FILE_ERROR,n.file,n.result.result_data?n.result.result_data.message:"")}}),this)});this._inputTag=this.el.find("input[type=file]"),1==n.multiple?this._inputTag.attr("multiple","multiple"):this._inputTag.removeAttr("multiple"),this._inputTag.attr("title",n.fileInputTitle),this.el.addClass("js-fileapi-wrapper"),this.el.fileapi(n),this._inputTag.on("click",i.bind((function(){this._inputTag.val("")}),this))},_showProgressBarView:function(){this._showProgress&&!this._uploading&&(this._destroyProgressBarView(),this._progressBarView=r.openDProgressBarView(this._progressBarTitle,this._skinColor),this.listenToOnce(this._progressBarView,"progressBar:cancelUpload",(function(){this.cancelUpload()})))},_destroyProgressBarView:function(){this._progressBarView&&this._progressBarView.destroy()},_onComplete:function(e,t){this._destroyProgressBarView(),"abort"!=t.statusText?this._localFileProcessingPromise.then(i.bind((function(){this._asyncCompleteProcess()}),this)):this._reset()},_validateFiles:function(e){var t=[];if(this.trigger(c.BEFORE_VALIDATE,t),!l.BROWSER_VALIDATOR())return!1;if(i.isEmpty(t)&&(t=this._validators),i.isEmpty(t))return!0;if(i.isEmpty(e))return!1;for(var n=0;n<t.length;n++)if(!t[n](e))return!1;return!0},_asyncCompleteProcess:function(){i.isEmpty(this._uploadResult)||this.trigger(c.UPLOAD_COMPLETE,{resultList:this._uploadResult,photoUpload:this._photoUpload,videoUpload:this._videoUpload}),this._reset()},_reset:function(){this._uploadResult=[],this._uploading=!1,this.el&&(FileAPI.reset(this._inputTag),this._inputTag=this.el.find("input[type=file]"),this._inputTag.val(""),this._getWidget().clear(!0)),this.trigger(c.RESET)},_getWidget:function(){return this.el.fileapi("widget")},_removeFlashNode:function(){if(this._inputTag&&0!=this._inputTag.length){var e=i.find(this._inputTag[0].attributes,(function(e){if("object"!=typeof e||!e.nodeName)return!1;var t=e.nodeName;return/fileapi/.test(t)}));null!=e&&this._inputTag.removeAttr(e.nodeName)}},loadFileReaderResize:function(e,n){n=n||1920;var o=new FileReader,s=new Image,a=document.createElement("canvas"),r=t.Deferred();return o.onload=i.bind((function(e){s.onload=function(){var e=s.width,t=s.height;e>t?e>n&&(t*=n/e,e=n):t>n&&(e*=n/t,t=n),a.width=e,a.height=t,a.getContext("2d").drawImage(s,0,0,e,t);var i=a.toDataURL("image/jpeg");r.resolve(i)},s.src=e.target.result})),o.onerror=i.bind((function(){r.reject()}),this),o.readAsDataURL(e),r}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(2),n(0),n(6),n(4),n(1295),n(486)],void 0===(o=function(e,t,n,i,o,s){var a=i.View.extend({tagName:"section",className:"lyWrap",template:t.template(o),attributes:{"data-viewname":"DProgressBarView",style:"display:none;"},ui:{totalProgressBar:"[data-uiselector=totalProgressBar]",totalProgressBarArea:"[data-uiselector=totalProgressBarArea]",singleProgressBar:"[data-uiselector=singleProgressBar]",uploadCancelButton:"[data-uiselector=uploadCancelButton]",currentFilePercentSpan:"[data-uiselector=currentFilePercentSpan]",currentFileNameSpan:"[data-uiselector=currentFileNameSpan]",totalFileIndexSpan:"[data-uiselector=totalFileIndexSpan]"},events:{"click @ui.uploadCancelButton":function(){return this.trigger("progressBar:cancelUpload"),this.destroy(),!1}},changeProgressInfo:function(e){if(!this.isDestroyed()&&this.isAttached()&&this.model.isProgressChanged(e)){var t=parseInt(this.ui.singleProgressBar.parent().css("width"),10),n=parseInt(this.ui.singleProgressBar.css("width"),0),i=parseInt(100*n/t,10);this.model.setProgressInfo(e,i);var o=this.model.getCurrentFileProgressPercent();if(!isNaN(o)){this.$el.show(),this.model.getTotalFileCount()>1&&this.ui.totalProgressBarArea.show(),this.ui.totalFileIndexSpan.html('<strong class="sf_color">'+(this.model.getCurrentFileIndex()+1)+"</strong>/"+this.model.getTotalFileCount()),this.ui.currentFileNameSpan.text(this.model.getCurrentFileName());var s=parseInt(o,10)+"%";this.ui.currentFilePercentSpan.text(s),this.ui.singleProgressBar.css("width",s),this.ui.totalProgressBar.css("width",parseInt(this.model.getTotalProgressPercent(),10)+"%")}}}});return a.Model=n.Model.extend({setProgressInfo:function(e,n){this._isEqualFileIndex(e)||(n=0),this.set(t.extend(e,{exPercent:n}))},isProgressChanged:function(e){return!this._isEqualFileIndex(e)||e.currentFileLoadedSize>this.getCurrentFileLoadedSize()},_isEqualFileIndex:function(e){return e.currentFileIndex==this.getCurrentFileIndex()},getCurrentFileIndex:function(){return this.get("currentFileIndex")},getCurrentFileLoadedSize:function(){return this.get("currentFileLoadedSize")},getExPercent:function(){return this.get("exPercent")},getCurrentFileSize:function(){return this.get("currentFileSize")},getTotalProgressPercent:function(){return(this.getCurrentFileIndex()+1)/this.getTotalFileCount()*100},getCurrentFileProgressPercent:function(){if(0==this.getCurrentFileSize())return 0;var e=parseInt(this.getCurrentFileLoadedSize()/this.getCurrentFileSize()*100,10);if(e<90)return e;var n=this.getExPercent();if(0==n)return t.random(90,99);var i=Math.max(Math.min(e,99),n);return t.random(i,99)},getTotalFileCount:function(){return this.get("totalFileCount")},getCurrentFileName:function(){return this.get("currentFileName")}}),a.openDProgressBarView=function(e,t){var n=new a.Model({title:e,skinColor:t||!1}),i=new a({model:n});return s.openWithoutHiding(i),i},a}.apply(t,i))||(e.exports=o)},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="header">\n        <h1 class="title"><%= title%></h1>\n    </header>\n\n    <div class="main">\n        <div class="progress<%if(skinColor){%> <%=skinColor%><%}%>">\n            <div data-uiselector="totalProgressBarArea" class="inner" style="display: none;">\n                <p class="fileName"><%- IM(\'uploading\') %></p>\n                <span class="fileBy" data-uiselector="totalFileIndexSpan"></span>\n                <div class="progressBar"><div class="bar sf_bg" data-uiselector="totalProgressBar" style="width:0%;"></div></div>\n            </div>\n\n            <div class="inner">\n                <p class="fileName" data-uiselector="currentFileNameSpan"></p>\n                <span class="fileBy" data-uiselector="currentFilePercentSpan"></span>\n                <div class="progressBar"><div class="bar sf_bg" data-uiselector="singleProgressBar" style="width:0%;"></div></div>\n            </div>\n        </div>\n    </div>\n\n    <footer class="footer">\n        <button type="button" class="uButton -cancel" data-uiselector="uploadCancelButton"><%- IM(\'ui.label.cancel\') %></button>\n    </footer>\n</div>\n'},function(e,t){e.exports='<div class="lyContent -w380">\n    <% if (joining) { %>\n        <% if (band.showBandTermAsPage()) { %>\n        <header class="header">\n            <% if(showSubscribeForEditProfile) { %>\n            <h1 class="title"><%- band.name %></h1>\n            <% } else { %>\n            <h1 class="title"><%= nl2br(IM(\'profile.profile_sets_layer.header_page.desc\')) %></h1>\n            <% } %>\n        </header>\n        <% } else { %>\n        <header class="header -subDescType">\n            <h1 class="title"><%- band.name %></h1>\n            <p class="desc"><%= IM(\'profile.profile_sets_layer.header.desc\') %></p>\n        </header>\n        <% } %>\n    <% } else { %>\n    <header class="header">\n        <h1 class="title"><%- IM(\'profile.profile_sets_layer.header.title\') %></h1>\n    </header>\n    <% } %>\n\n    <div class="main -tSpaceNone">\n        <% if (showSubscribeForEditProfile) { %>\n        <div class="topNoticeBar gMar-20 gMal-20">\n            <p class="sDesc gMat0"><%- IM(\'profile.profile_sets_layer.msg_subscribe_for_edit_profile\') %></p>\n        </div>\n        <% } %>\n        <div class="rScroll -h360">\n            <ul class="listLine">\n                <% _.each(items, function(item, index) { %>\n                <li class="tLine">\n                    <label for="uCheck_<%- cid %>_<%- index %>" class="flexList">\n                        <span class="thumb">\n                            <span class="uProfile -size40">\n                                <span class="profileInner <%- item.profileInnerClass %>">\n                                    <% if (item.profileImageUrl) { %>\n                                    <img src="<%- item.profileImageUrl %>" width="40" height="40" alt="<%- IM(\'photo\') %>">\n                                    <% } %>\n                                </span>\n                            </span>\n                        </span>\n                        <span class="text -ellipsis"><%- item.name %></span>\n                        <span class="etc">\n                            <span class="uCheck -checkbox -noLabel">\n                                <input type="radio" id="uCheck_<%- cid %>_<%- index %>" class="checkInput _radio" name="uCheck_<%- cid %>" value="<%- item.userProfileSetId %>" <%= (index === 0) ? \'checked\': \'\' %>>\n                                <span class="checkLabel">\n                                    <span class="shape"></span>\n                                </span>\n                            </span>\n                        </span>\n                    </label>\n                </li>\n                <% }); %>\n            </ul>\n        </div>\n        <% if (joining) { %>\n        <div class="newProfile">\n            <button type="button" class="addProfile _newProfileBtn"><%= IM(\'profile.profile_sets_layer.main.new_profile\') %></button>\n        </div>\n\n            <% if (band.supportDefaultProfileForPage()) { %>\n        <div class="checkOption gMat13 gPat15 -borderTop">\n            <label class="inputLabel">\n                <span class="inputCheck">\n                <span class="uCheck -checkbox -noLabel">\n                    <input type="checkbox" id="uCheck_<%- cid %>_setDefaultProfileSetOfPageCheck" class="checkInput _setDefaultProfileSetOfPageCheck" name="setDefaultProfileSetOfPage" checked>\n                    <span class="checkLabel">\n                        <span class="shape "></span>\n                    </span>\n                </span></span>\n                <span class="lableText"><%-IM("profile.profile_sets_layer.label.set_default_profile_set_of_page")%></span>\n            </label>\n        </div>\n            <% } %>\n\n        <% } %>\n\n        <% if (showAdAgreement) { %>\n        <p class="bizAdDesc"><%= band.showBandTermAsPage() ? IM(\'bandjoin.desc.ad_agreement.page_band\') : IM(\'bandjoin.desc.ad_agreement.group_band\') %></p>\n        <% } %>\n    </div>\n\n    <footer class="footer<%= !joining ? \' -tLine\' : \'\' %>">\n        <button type="button" class="uButton -confirm -sizeL _confirmBtn">\n            <%= joining ? joinButtonLabel : IM(\'ui.label.confirm\') %>\n        </button>\n        <button type="button" class="uButton -iconClose btnLyClose _closeBtn"><span class="gSrOnly"><%= IM(\'ui.label.close_layer\') %></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){n(2);var t=n(0),i=n(4),o=n(1298),s=(n(518),n(486)),a=n(82),r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DBandProfileSetSelectView"},template:t.template(o),serializeData:function(){var e=a.make(this._afterProfileModel.get("profileImageUrl"),a.TYPE.s276);return{cid:this.cid,profileImageUrl:e,profileInnerClass:a.makeProfileInnerClass(e),name:this._afterProfileModel.get("name"),items:this._items}},ui:{checkbox:"._checkbox",confirmBtn:"._confirmBtn",closeBtn:"._closeBtn"},events:{"change @ui.checkbox":"_toggleConfirmBtn","click @ui.confirmBtn":"_submit","click @ui.closeBtn":"_close"},initialize:function(e){this._doNotRefreshPageOnChange=e.doNotRefreshPageOnChange,this._beforeProfileModel=e.beforeProfileModel,this._afterProfileModel=e.afterProfileModel,this._items=this.collection.getBandProfileSets(this._beforeProfileModel,this._afterProfileModel),t.each(this._items,(function(e){e.profileImageUrl=a.make(e.profileImageUrl,a.TYPE.s75),e.profileInnerClass=a.makeProfileInnerClass(e.profileImageUrl),e.bandProfileImageThumbnail=a.make(e.bandProfileImage,a.TYPE.s75),e.cover=a.makeMediumSquareCoverUrl(e.cover)}))},onRender:function(){this._toggleConfirmBtn()},_toggleConfirmBtn:function(){this.ui.confirmBtn.prop("disabled",0===this.ui.checkbox.filter(":checked").length)},_close:function(){this._doNotRefreshPageOnChange?this.destroy():window.location.reload()},_submit:function(){var e=t.map(this.ui.checkbox.filter(":checked"),(function(e){return parseInt(e.value)}));this._onsubmit||(this._onsubmit=!0,t.isEmpty(e)||this.collection.setProfileSet(this._afterProfileModel,e).then(t.bind(this._close,this),t.bind((function(){this._onsubmit=!1}),this)))}});return r.openLayer=function(e){s.open(new r(e))},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="gSrOnly">\n        <h1><%= IM(\'profile.band_profile_set_layer.main.sub_title\') %></h1>\n    </header>\n\n    <div class="main">\n        <div class="profileInfo -tSpace24">\n            <p class="gTaC">\n                <span class="uProfile -size90 -border">\n                    <span class="profileInner <%- profileInnerClass %>">\n                        <% if (profileImageUrl) { %>\n                        <img src="<%- profileImageUrl %>" width="90" height="90" alt="<%- IM(\'photo\') %>">\n                        <% } %>\n                    </span>\n                </span>\n            </p>\n\n            <div class="userInfo -lrSpaceNone">\n                <h1 class="userName"><%- name %></h1>\n                <strong class="subTitle"><%= IM(\'profile.band_profile_set_layer.main.sub_title\') %></strong>\n                <p class="desc"><%= IM(\'profile.band_profile_set_layer.main.desc\') %></p>\n            </div>\n        </div>\n\n        <div class="profileApplyBand">\n            <div class="rScroll -h260">\n                <ul class="listLine">\n                    <% _.each(items, function(item, index) { %>\n                    <li class="tLine">\n                        <label for="uCheck_<%- cid %>_<%- index %>" class="flexList">\n\t\t\t\t\t\t\t\t<span class="thumb">\n                                    <div class="uCoverImage -w40 -border <% if (item.bandProfileImage) { %>-circle<% } %>">\n                                        <span class="coverInner">\n                                            <img src="<%- item.bandProfileImage ? item.bandProfileImageThumbnail : item.cover %>" class="coverImg" alt="<%- IM(\'web.noui.bandcreate.title.band_skin\') %>">\n                                        </span>\n                                    </div>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class="text">\n\t\t\t\t\t\t\t\t\t<span class="ellipsis"><%- item.bandName %></span>\n\t\t\t\t\t\t\t\t\t<span class="profileStatus">\n                                        <span class="uProfile -size16">\n                                            <span class="profileInner <%- item.profileInnerClass %>">\n                                                <% if (item.profileImageUrl) { %>\n                                                <img src="<%- item.profileImageUrl %>" width="16" height="16" alt="<%- IM(\'photo\') %>">\n                                                <% } %>\n                                            </span>\n                                        </span>\n\t\t\t\t\t\t\t\t\t\t<%- item.name %>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class="etc">\n                                    <% if (item.changeable) { %>\n                                    <span class="uCheck -checkbox -noLabel">\n                                        <input type="checkbox" id="uCheck_<%- cid %>_<%- index %>" class="checkInput _checkbox" value="<%- item.bandNo %>">\n                                        <span class="checkLabel">\n                                            <span class="shape"></span>\n                                        </span>\n                                    </span>\n                                    <% } else { %>\n                                    <span class="gBandColor"><%= IM(\'profile.band_profile_set_layer.main.same_profile\') %></span>\n                                    <% } %>\n\t\t\t\t\t\t\t\t</span>\n                        </label>\n                    </li>\n                    <% }); %>\n                </ul>\n            </div>\n        </div>\n    </div>\n\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -confirm -sizeL _confirmBtn"><%= IM(\'ui.label.confirm\') %></button>\n        <button type="button" class="uButton -iconClose btnLyClose _closeBtn"><span class="gSrOnly"><%= IM(\'ui.label.close_layer\') %></span></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="header">\n        <h1 class="title"><%- title %></h1>\n    </header>\n\n    <div class="main">\n        <div class="changeBandCover">\n            <div class="imageCropWrap">\n                <div class="imageCrop _cropWrap">\n\n                </div>\n            </div>\n            <div class="fileUpload _btnCamera">\n                <p id="changeBandCover_<%- viewId %>_label" class="desc"><%- IM("crop.label.size_limitation") %></p>\n                <div class="inputFile"> <input type="file" id="changeBandCover_<%- viewId %>" aria-labelledby="changeBandCover_<%- viewId %>_label" class="imageUpload"></div>\n            </div>\n            <% if(isPageBand) { %>\n            <div class="cropNotice">\n                <p class="noticeText"><%= IM("page.profile.upload.crop_info") %></p>\n            </div>\n            <% } %>\n        </div>\n    </div>\n\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _btnCancel"><%- IM("web.ui.button.label.cancel") %></button>\n        <button type="button" class="uButton -confirm _btnComplete"><%- IM("web.ui.button.label.complete") %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent" >\n        <header class="header -noTitlebar">\n            <h1 class="title">\n                <% if (isDeleted) { %>\n                    <%= IM("bandsetting.member_join_block.confirm_layer_title") %>\n                <% } else { %>\n                    <%= IM("bandsetting.member_withdrawal.txt.confirm_withdrawal") %>\n                <% } %>\n            </h1>\n        </header>\n\n        <% if (!isDeleted) { %>\n        <div class="main">\n            <ul class="selectArea">\n                <li>\n                    <label for="withdrawal_<%= cid %>" class="uCheck -radio">\n                        <input type="radio" id="withdrawal_<%= cid %>" name="Withdrawal" class="checkInput _inputWithdrawal" value="withdrawal">\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%= IM("bandsetting.member_withdrawal.label.compulsory_withdrawal") %></span>\n                        </span>\n                    </label>\n                </li>\n                <li>\n                    <label for="withdrawalWithBlock_<%= cid %>" class="uCheck -radio">\n                        <input type="radio" id="withdrawalWithBlock_<%= cid %>" name="Withdrawal" class="checkInput _inputWithdrawal" value="withdrawalWithBlock">\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%= IM("bandsetting.member_withdrawal.label.compulsory_withdrawal_and_block") %></span>\n                        </span>\n                    </label>\n                </li>\n            </ul>\n        </div>\n        <% } %>\n\n        <footer class="footer">\n            <button type="button" class="uButton -cancel _btnCancel"><%= IM("ui.label.cancel") %></button>\n\n            <% if (isDeleted) { %>\n            <button type="button" class="uButton -confirm _btnConfirm"><%= IM("profile_layer.label.block_join") %></button>\n            <% } else { %>\n            <button type="button" class="uButton -confirm -disabled _btnConfirm"><%= IM("ui.label.confirm") %></button>\n            <% } %>\n        </footer>\n    </div>\n</section>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(2),s=n(4),a=n(1302),r=n(1245),l=n(488),c=n(154),d=n(507),u=n(600),h=n(82),p=n(934),m=n(486);n(502);var _={CONFIRM:"CONFIRM"},g=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DBandJoinFormView"},template:t.template(a),templateContext:function(){return{maxAnswerLength:200,bandName:this.model.getBandName(),joinQuestionAsHtml:this.model.getJoinQuestionAsHtml()}},ui:{joinAnswer:"._joinAnswer",confirmBtn:"._confirmBtn",inputHoleBox:"._inputHoleBox",photoUploadArea:"._photoUploadArea",photoInputArea:"._photoInputArea",uploadedPhotoList:"._uploadedPhotoList",closeBtn:"._closeBtn"},events:function(){var e={"click @ui.confirmBtn":function(){if(this._canSubmit()){var e={joinAnswer:i.trim(this.ui.joinAnswer.val())};t.isEmpty(this._joinAnswerImages)||(e.joinAnswerImages=this._joinAnswerImages),this.trigger("DBandJoinFormView",_.CONFIRM,e),this.destroy()}else alert(IM("web.join_application_question.alert.answer"))},"keyup @ui.joinAnswer":function(){this._determineButtonActivation()},"cut @ui.joinAnswer":function(){this._deferredDetermineButtonActivation()},"paste @ui.joinAnswer":function(){this._deferredDetermineButtonActivation()},"focus @ui.joinAnswer":function(){this.ui.inputHoleBox.addClass(l.ELEMENT.ACTIVE)},"blur @ui.joinAnswer":function(){this.ui.inputHoleBox.removeClass(l.ELEMENT.ACTIVE)},"click @ui.closeBtn":"destroy","click @ui.uploadedPhotoList ._photoDeleteButton":function(e){var n=o(e.currentTarget).data("photo-url");this._joinAnswerImages=t.reject(this._joinAnswerImages,t.bind((function(e){return e.url==n}),this)),this.ui.uploadedPhotoList.hide(),this.ui.uploadedPhotoList.empty(),this.ui.photoInputArea.show(),this._determineButtonActivation()}};return e},initialize:function(){this._joinAnswerImages=[]},onAttach:function(){this._bindMentionsInput(),this._bindPhotoUploader()},onBeforeDetach:function(){null!=this._mentionsInput&&(this._mentionsInput.destroy(),this._mentionsInput=null),null!=this._photoUploader&&(this._photoUploader.destroy(),this._photoUploader=null)},_canSubmit:function(){var e=t.isEmpty(i.trim(this.ui.joinAnswer.val())),n=t.isEmpty(this._joinAnswerImages);return!e||!n},_determineButtonActivation:function(){var e=this._canSubmit();this.ui.confirmBtn.prop("disabled",!e).toggleClass(l.ELEMENT.CONFIRM,e).toggleClass(l.ELEMENT.DISABLED,!e)},_deferredDetermineButtonActivation:function(){c.wrapDeferPromise(this).then(t.bind((function(){this._determineButtonActivation()}),this))},_bindMentionsInput:function(){this._mentionsInput=p.buildBandMentionsInput(this.ui.joinAnswer,null,null,null,null,!0)},_bindPhotoUploader:function(){this._photoUploader=u.createSinglePhotoUploader(this.ui.photoUploadArea,{showProgress:!0,autoUpload:!0}),this.listenTo(this._photoUploader,d.UPLOAD_COMPLETE,t.bind((function(e){e&&e.resultList&&this._renderAndAddUploadedPhoto(e.resultList)}),this))},_renderAndAddUploadedPhoto:function(e){if(!this.isDestroyed()&&null!=e&&null!=e[0]){var n=e[0];this._joinAnswerImages.push({url:n.url,width:n.width,height:n.height});var i=n.url,s=h.make(i,h.TYPE.s150),a=o(t.template(r)({thumbnailUrl:s}));a.data("photo-url",i).find("._photoDeleteButton").data("photo-url",i),this.ui.uploadedPhotoList.append(a),a.find("._uploadedPhoto").setLoading(),this.ui.uploadedPhotoList.show(),this.ui.photoInputArea.hide(),this._determineButtonActivation()}}});return g.EVENTS=_,g.openLayer=function(e){var t=new g({model:e});return m.open(t),t},g}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="modalHeader">\n        <h1 class="title"><%- bandName %> <p class="titleDesc"><%- IM(\'bandjoin.answer_to_join_question\') %></p></h1>\n    </header>\n    <div class="modalBody">\n        <div class="joinQnAArea">\n            <div class="questionBox">\n                <div class="questionText"><%= joinQuestionAsHtml %></div>\n            </div>\n            <div class="answerInputBox gMat10 _inputHoleBox">\n                <div class="answerInputWrap">\n                    <textarea class="_joinAnswer" maxlength="<%- maxAnswerLength %>" placeholder="<%- IM(\'web.application_question.please_answer\') %>" style="width:100%;height:43px;"></textarea>\n\n                    <div class="photoBox _uploadedPhotoList" style="display: none;"></div>\n                    <div class="btnUploadWrap _photoInputArea">\n                        <label class="uploadImg _photoUploadArea"><input type="file" title="<%= IM(\'profile.choose_profile_image\') %>"></label>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter">\n        <button type="button" class="uButton -cancel _closeBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -disabled _confirmBtn" disabled><%- IM(\'web.band_join.btn.next\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(188),a=n(179),r=n(169),l=n(569),c=n(1304),d=n(1305),u=n(1306),h=n(82),p=n(172);n(193);var m=null,_=Promise.resolve().then(n.t.bind(null,934,7)).then((function(e){m=e.default})),g=o.Object.extend({initialize:function(e){this._bandNo=e.bandNo,this._selectedBandNo=this._bandNo,this.$el=t(e.el),this._autoCompleteListElParent=e.autoCompleteListElParent,this._offsetAdjustEl=e.offsetAdjustEl,this._autoCompleteListClass=e.autoCompleteListClass||"",this._mentionArray=e.mentionArray,this._preventControlLayerOffset=1==e.preventControlLayerOffset,this._dynamicSearchRequired=1==e.dynamicSearchRequired,this._hideCompleteListOnEmptyQuery=e.hideCompleteListOnEmptyQuery,this._currentMemberType=null,this._disableMention=1==e.disableMention,this.$el.hide(),this.$el.addClass(r.USE_KEYUP_EVENT),this._autoCompleteListTemplate=i.bind(i.template(c),i,{autoCompleteListClass:this._autoCompleteListClass}),this._createMentionsInput(),this._bindEvent()},onDestroy:function(){null!=this.$el&&null!=this.$el.mentionsInput&&(this.$el.mentionsInput("destroy"),this.$el=null)},val:function(e){if("string"!=typeof e)return this.$el.mentionsInput("updateValues"),s.convertToApiContent(this.$el.data("messageText")||this.$el.val());var t=s.parseContent(e);this.$el.val(t.text),this.$el.mentionsInput("addMentions",t.mentions),this.$el.trigger("update"),this.$el.mentionsInput("updateValues")},getNotEscapedVal:function(){return this.$el.data("messageText")||this.$el.val()},appendNewMention:function(e,t,n){var i;i=n?p.buildPageProfileMention(t):p.buildBandMemberMention(e,t),this.$el.mentionsInput("appendNewMention",i)},stopMentionsInput:function(){this._disableMention=!0,this.emptyMentionedArray(),this.setHideCompleteListOnEmptyQuery(!0),this.hideAutoCompleteList()},resumeMentionsInput:function(){this._disableMention=!1,this.setHideCompleteListOnEmptyQuery(this._hideCompleteListOnEmptyQuery)},resetMentionInput:function(){this.$el.mentionsInput("reset")},changeSelectedBandInfo:function(e,t){this._selectedBandNo=e,this._changeSelectedBandName(t)},changeMentionArrayAndInputOptions:function(e){this.changeMentionArray(e.mentionArray),this.setDynamicSearchRequired(e.dynamicSearchRequired),this._hideCompleteListOnEmptyQuery=e.hideCompleteListOnEmptyQuery,this._canMentionMemberGroup=e.canMentionMemberGroup,this.setHideCompleteListOnEmptyQuery(this._hideCompleteListOnEmptyQuery)},changeMentionArray:function(e){null!=this.$el&&null!=this.$el.mentionsInput&&(this._mentionArray=e)},injectBandData:function(e){null!=this.$el&&null!=this.$el.mentionsInput&&(this._messageInputBandData=e,this.changeSelectedBandInfo(e.getBandCore().bandNo,e.getBandCore().name),this.changeCurrentMemberType(e.getCurrentSelectedMemberProfileMemberType()))},setMaxMentionCount:function(e){null!=this.$el&&null!=this.$el.mentionsInput&&null!=e&&this.$el.mentionsInput("changeMaxMentionCount",e)},changeCurrentMemberType:function(e){this._messageInputBandData&&(this._currentMemberType=e,this._canMentionToPageProfile=this._messageInputBandData.getBandCore().supportMentionToPageProfileFor(this._currentMemberType),this.$el.mentionsInput("setPreventHideOnPopulateDropDown",this._messageInputBandData.getBandCore().supportSelectOtherBandOnMentionFor(this._currentMemberType)))},setDynamicSearchRequired:function(e){this._dynamicSearchRequired=e},setHideCompleteListOnEmptyQuery:function(e){null!=this.$el&&null!=this.$el.mentionsInput&&this.$el.mentionsInput("setHideCompleteListOnEmptyQuery",e)},emptyMentionedArray:function(){null!=this.$el&&null!=this.$el.mentionsInput&&this.$el.mentionsInput("emptyMentionedArray")},hideAutoCompleteList:function(){null!=this.$el&&null!=this.$el.mentionsInput&&this.$el.mentionsInput("hideAutoComplete")},isMentionExist:function(){if(null==this.$el||null==this.$el.mentionsInput)return!1;var e=this.$el.getFromMentionInput("getMentionedArray");return!i.isEmpty(e)},_createMentionsInput:function(){if(null!=this.$el&&null!=this.$el.mentionsInput){var e=this.$el.val();this.$el.mentionsInput({minChars:0,elastic:!0,templates:{wrapper:i.template('<div class="mentions-input _prevent_toggle" ></div>'),autocompleteList:this._autoCompleteListTemplate,notMentionedItemSyntax:s.getNotMentionedItemTemplate(),autocompleteListItemAvatar:i.template(d)},onDataRequest:i.bind((function(e,t,n){this._disableMention?n([]):this._asyncSearchMentions(t).then(i.bind((function(e){if(null!=this.$el){this._findTarget$El("._bandSelectionHead").toggle(this._messageInputBandData.getBandCore().supportSelectOtherBandOnMentionFor(this._currentMemberType));var t=this.$el.getFromMentionInput("getMentionedArray"),o=i.find(e,(function(e){return null==i.find(t,(function(t){return e.isSameMentionOnType(t)}))}));n(o?e:t)}}),this))}),this),onHideAutoComplete:i.bind((function(){this._bandSelectRegion&&this._releaseBandSelectStatus()}),this),autoCompleteListElParent:this._autoCompleteListElParent,offsetAdjustEl:this._offsetAdjustEl,defaultProfileImage:a.PROFILE_DEFAULT_R1,skipHideOnBlur:!0,preventControlLayerOffset:this._preventControlLayerOffset,hideCompleteListOnEmptyQuery:this._hideCompleteListOnEmptyQuery,escapeUserInputTags:function(e){return s.escapeUserInputTags(e)}}),this.$el.show(),this.val(e),i.isEmpty(e)||this.$el.mentionsInput("focusCursorToEnd")}},_asyncSearchMentions:function(e){var n=t.Deferred(),o=[];if(!this._dynamicSearchRequired)return o=this._filterListByTypeStr(this._mentionArray,e),n.resolve(o),n;this._lastCallQuery=e;var s=l.debouncedFetchMemberList(this._selectedBandNo,e,this._fetchMemberTimer);this._fetchMemberTimer=s.timer;var a=t.Deferred().resolve([]);return this._canMentionMemberGroup&&(a=l.fetchCachedBandMemberGroups(this._selectedBandNo)),t.when(s.promise,a).then(i.bind((function(t,s){if(this._lastCallQuery==t.query){var a=l.extractMatchingMentionsButEmptyQuery(s,t.query);if(o=l.convertCollectionToMentionArray(t.firstMatchingList,this._getSelectBandNoForMention()),o=l.concatMentionArrayAndSort(a,o),o=this._filterListByTypeStr(o,e),i.isEmpty(o)){var r=l.extractMatchingMentionsButEmptyQuery(s,t.query.slice(0,-1));o=l.convertCollectionToMentionArray(t.secondMatchingList,this._getSelectBandNoForMention()),o=l.concatMentionArrayAndSort(r,o),o=this._filterListByTypeStr(o,e),n.resolve(o)}else n.resolve(o)}}),this)),n},_filterListByTypeStr:function(e,t){if(""==t&&this._canMentionToPageProfile&&this._bandNo==this._selectedBandNo)return[p.buildPageProfileMention(this._messageInputBandData.getBandCore().name,h.makeProfileThumbnailUrl(this._messageInputBandData.getBandCore().profileImage))];var n=i.filter(e,(function(e){return e.getLowerCaseMentionName().indexOf(t.toLowerCase())>-1}));return!i.isEmpty(n)||t.length<=1?n:i.filter(e,(function(e){return e.getLowerCaseMentionName().indexOf(t.slice(0,-1).toLowerCase())>-1}))},_bindEvent:function(){null!=this._autoCompleteListElParent&&this._autoCompleteListElParent.on("click","._selectOtherBandBtn",i.bind((function(){return this._openBandSelectView(),!1}),this))},_openBandSelectView:function(){this._bandSelectRegion=new(o.Region.extend({el:this._autoCompleteListElParent.find("._bandSelectRegion")}));var e=u.buildDMentionBandSelectView(this._bandNo,this._selectedBandNo,this._currentMemberType);this._bandSelectRegion.show(e),this.listenTo(e,u.EVENT.CANCEL_CLICKED,(function(){this._releaseBandSelectStatus(),this.$el.mentionsInput("focusCursorToLastPosition"),this.$el.mentionsInput("checkAndDoSearch"),this.$el.mentionsInput("adjustLayerOffset")})),this.listenTo(e,u.EVENT.BAND_LIST_FETCHED,(function(){this._findTarget$El("._bandSelectionHead").hide(),this._findTarget$El("._mentionTargetList").hide(),this._findTarget$El("._bandSelectArea").show(),this.$el.mentionsInput("adjustLayerOffset")})),this.listenTo(e,u.EVENT.BAND_SELECTED,(function(e,n){var o=t.Deferred().resolve();this._mentionArray=[],(e!=this._bandNo||this._messageInputBandData.canMentionToCurrentBandMember())&&(o=_.then(i.bind((function(){var t=e!=this._bandNo?e:null;return m.fetchMembersAndPopulateMentionsInput(e,this,t,!0)}),this))),o.then(i.bind((function(){null!=this.$el&&null!=this.$el.mentionsInput&&(this._findTarget$El("._targetMentionUl").empty(),this.changeSelectedBandInfo(e,n),this._releaseBandSelectStatus(),this.$el.mentionsInput("focusCursorToLastPosition"),this.$el.mentionsInput("checkAndDoSearch"))}),this))}))},_releaseBandSelectStatus:function(){this._bandSelectRegion&&this._bandSelectRegion.hasView()&&(this._bandSelectRegion.empty(),this._findTarget$El("._bandSelectionHead").show(),this._findTarget$El("._mentionTargetList").show(),this._findTarget$El("._bandSelectArea").hide())},_findTarget$El:function(e){return this._autoCompleteListElParent.find(e)},_getSelectBandNoForMention:function(){return this._bandNo==this._selectedBandNo?null:this._selectedBandNo},_changeSelectedBandName:function(e){this._findTarget$El("._bandNameSpan").html(i.escape(e))}});return g.buildDMentionsInput=function(e){return new g(e)},g}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<article class="cAutoCompleteList <%- autoCompleteListClass %>">\n    <header class="header _bandSelectionHead">\n        <h1 class="gSrOnly"><%- IM(\'mention.select_other_band\') %></h1>\n        <h2 class="title _bandNameSpan"></h2>\n        <a href="#" class="moreBand _selectOtherBandBtn"><%- IM(\'mention.select_other_band\') %></a>\n    </header>\n\n    <div class="bandSelectArea _bandSelectArea" style="display: none;">\n        <h1 class="gSrOnly"><%- IM(\'bandsetting.member_withdrawal.txt.member_list\') %></h1>\n        <div class="_bandSelectRegion"></div>\n    </div>\n</article>'},function(e,t){e.exports='<% if ( memberGroup ) { %>\n<span class="groupProfileThumb"></span>\n<% } else { %>\n<span class="thumb <%- thumbnailInnerClass %>"><img src="<%- thumbnail %>" /></span>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(1307),a=n(154),r=n(569),l=n(491),c=n(82),d=n(555),u=o.View.extend({tagName:"article",attributes:{"data-viewname":"DMentionBandSelectView",tabindex:0},getTemplate:function(){return this._dataFetched?t.template(s):t.template("")},templateContext:function(){var e=this._convertBandCollectionToViewData();return{canSelectPageBand:this._canSelectPageBand,bandList:e,pageName:this._pageName,pageThumbnail:this._pageThumbnail,bandNo:this._bandNo,isBandListExist:!t.isEmpty(e)}},ui:{eachBandLi:"._eachBandLi",cancelSelection:"._cancelSelection",bandListDiv:"._bandListDiv"},events:{"click @ui.eachBandLi":function(e){var t=i(e.currentTarget);return this._selectBand(t),!1},"click @ui.cancelSelection":function(){return this._cancelSelection(),!1},keydown:function(e){switch(e.keyCode){case d.DOWN:return this._makeActiveBand(this._selectedIndex+1),!1;case d.UP:return this._makeActiveBand(this._selectedIndex-1),!1;case d.TAB:case d.ENTER:return this._selectBand(i(this.ui.eachBandLi[this._selectedIndex])),!1;case d.BACKSPACE:case d.ESCAPE:return this._cancelSelection(),!1}}},initialize:function(e){this._bandNo=e.bandNo,this._selectedBandNo=e.selectedBandNo,this._pageName="",this._pageThumbnail="",this._canSelectPageBand=!1,this._currentMemberType=e.currentMemberType},onDomRefresh:function(){this._dataFetched&&a.wrapDeferPromise(this).then(t.bind((function(){this._makeActiveBand(0),this.$el.focus()}),this))},onAttach:function(){a.wrapActivePromise(i.when(l.getCachedBandData(this._bandNo),r.fetchBandListForMention(this._bandNo,this._selectedBandNo)),this).then(t.bind((function(e,t){this._bandDataCollection=t,this._dataFetched=!0,this._canSelectPageBand=this._bandNo!=this._selectedBandNo&&e.getBandCore().supportMentionToPageProfileFor(this._currentMemberType),this._canSelectPageBand&&(this._pageName=e.getBandName(),this._pageThumbnail=c.makeSmallCoverUrl(e.getBandCore().getBandMainImageUrl())),this.render(),this.trigger(u.EVENT.BAND_LIST_FETCHED)}),this))},_cancelSelection:function(){this.trigger(u.EVENT.CANCEL_CLICKED)},_selectBand:function(e){this.trigger(u.EVENT.BAND_SELECTED,e.data("band-no"),e.data("band-name"),e.data("page-band"))},_makeActiveBand:function(e){var t=i(this.ui.eachBandLi[e]);if(0!=t.length){this.ui.eachBandLi.removeClass("active"),t.addClass("active"),this._selectedIndex=e;var n=t.offset().top-this.ui.bandListDiv.offset().top-32+this.ui.bandListDiv.scrollTop();this.ui.bandListDiv.stop().animate({scrollTop:n},200)}},_convertBandCollectionToViewData:function(){return null==this._bandDataCollection?[]:this._bandDataCollection.map((function(e){return{bandNo:e.getBandNo(),thumbnail:e.getCoverThumbnail(),bandName:e.getBandName()}}))}});return u.EVENT={BAND_LIST_FETCHED:"DMentionBandSelectView_bandListFetched",BAND_SELECTED:"DMentionBandSelectView_bandSelected",CANCEL_CLICKED:"DMentionBandSelectView_cancelClicked"},u.buildDMentionBandSelectView=function(e,t,n){return new u({bandNo:e,selectedBandNo:t,currentMemberType:n})},u}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="<% if ( canSelectPageBand ) { %>pageBandSelect<% } %>">\n    <div class="header"><a href="#" role="button" class="btnBandSelect _cancelSelection"><%- IM(\'web.copypostwrite.btn.back\') %></a></div>\n\n    <div class="scrollWrap _bandListDiv" >\n<%\nif ( canSelectPageBand ) {\n%>\n        <section>\n            <h1 class="subTitle"><%- IM(\'pageband.page\') %></h1>\n            <ul class="roundThumbList">\n                <li role="button" data-band-no="<%- bandNo %>" data-band-name="<%- pageName %>" data-page-band="true" class="_eachBandLi"><span class="thumb"><img src="<%- pageThumbnail %>" alt=""></span><span class="name"><%- pageName %></span></li>\n            </ul>\n        </section>\n<%\n} if ( isBandListExist ) {\n%>\n        <section>\n            <h1 class="subTitle"><%- IM(\'web.noui.band.title.band\') %></h1>\n            <ul class="coverThumbList">\n<%\n    _.each(bandList, function(eachBand) {\n%>\n                <li role="button" data-band-no="<%- eachBand.bandNo %>" data-band-name="<%- eachBand.bandName %>" data-page-band="false" class="_eachBandLi">\n                    <span class="thumb"><img src="<%- eachBand.thumbnail %>" alt=""></span>\n                    <span class="name"><%- eachBand.bandName %></span>\n                </li>\n<%\n    });\n%>\n            </ul>\n        </section>\n<%\n}\n%>\n    </div>\n</div>'},function(e,t){e.exports='<div class="lyContent -w380 _wrap">\n    <header class="header -noTitlebar -profile">\n        <h1 class="title"><%- joining ? band.name : IM(\'my_profiles.edit_profile\') %></h1>\n        <% if (joining) { %>\n            <% if (band.showBandTermAsPage()) { %>\n        <p class="desc"><%- IM(\'profile.profile_sets_layer.header_page.desc\') %></p>\n            <% } else { %>\n        <p class="desc"><%= IM(\'profile.profile_sets_layer.header.desc\') %></p>\n            <% } %>\n        <% } %>\n    </header>\n    <div class="main">\n        <div class="chooseProfilePicture">\n            <div class="profileWrap">\n                <span class="uProfile -size140 -border">\n                    <span class="profileInner _imageWrap">\n                        \x3c!--<img src="" width="140" height="140" alt="">--\x3e\n                    </span>\n                </span>\n                <button class="photoSubmit _menuBtn"><span class="gSrOnly"><%= IM(\'web.profile.label.edit\') %></span></button>\n                <div class="lyMenu _menuWrap" style="display:none;">\n                    <ul>\n                        <li><label class="_fileWrap"><%= IM(\'profile.choose_profile_image\') %><input type="file" accept="image/*" name="attachment"></label></li>\n                        <li><a href="#" class="_deletePhotoLink"><%= IM(\'profile.delete_photo\') %></a></li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n        <div class="uInput">\n            <label for="profileName_<%- cid %>" class="gSrOnly"><%= IM(\'web.profile.label.name\') %></label>\n            <input class="_nameInput" type="text" id="profileName_<%- cid %>" placeholder="<%- IM(\'web.profile.placeholder.input_name\') %>" maxlength="<%= authorNameMaxLength %>">\n            <span class="border"></span>\n        </div>\n        <% if (joining && band.supportDefaultProfileForPage()) { %>\n        <div class="checkOption gMat20 -alignC">\n            <label class="inputLabel">\n                <span class="inputCheck">\n                <span class="uCheck -checkbox -noLabel">\n                    <input type="checkbox" id="uCheck_<%- cid %>_setDefaultProfileSetOfPageCheck" class="checkInput _setDefaultProfileSetOfPageCheck" name="setDefaultProfileSetOfPage" <% if (setDefaultProfileSetOfPage) { %>checked<% } %>>\n                    <span class="checkLabel">\n                        <span class="shape "></span>\n                    </span>\n                </span></span>\n                <span class="lableText"><%-IM("profile.profile_sets_layer.label.set_default_profile_set_of_page")%></span>\n            </label>\n        </div>\n        <% } %>\n        <% // 개인정보 동의에 대한 문구 추가 %>\n        <p class="sDesc gMat13 _useProfileImageAgreementInfo" style="display: none;">\n            <span class="descInfoTxt"><%= IM("profile.edit.use_profile_image.agree_description") %></span>\n        </p>\n    </div>\n    <footer class="footer">\n        <button type="submit" class="uButton -confirm -sizeL _confirmBtn">\n            <%= saveButtonLabel %>\n        </button>\n        <button type="button" class="uButton -iconClose btnLyClose _closeBtn"><span class="gSrOnly"><%= IM(\'ui.label.close_layer\') %></span></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="lyContent" style="width:340px">\n    <div class="modalBody">\n        <header class="modalHeader -noTitlebar">\n            <h1 class="title"><%= IM(\'bandjoin.join_application.send_verification_email.txt.input_email_id\') %></h1>\n        </header>\n        <div class="modalContentWrap gMat17">\n            <div class="uInputWrap">\n                <label for="emailId" class="labelText gFs11 gColorBk4"><%= IM(\'bandjoin.join_application.send_verification_email.txt.email_id\') %></label>\n                <div class="uInput -simpleLine -borderColorGr4 -h32 gMat2">\n                    <input type="text" id="emailId" placeholder="<%= IM(\'bandjoin.join_application.send_verification_email.txt.id\') %>" class="gFs14 gPab3" value="<%- verifiedEmailId %>">\n                    <span class="border"></span>\n                </div>\n            </div>\n            <div class="selectBox gMat13">\n                <label class="labelText gFs11 gColorBk4"><%= IM(\'bandjoin.join_application.send_verification_email.txt.domain_address\') %></label>\n                <div class="uSelect -lineColorE6 -bgFd gMat6 <%= domains.length === 1 ? \'-arrowNone\':\'\' %>" style="width:100%">\n                    <select title="<%= IM(\'bandjoin.join_application.send_verification_email.txt.domain_address\') %>" class="gFs15 _selectDomain">\n                        <% _.each(domains, function(domain) { %>\n                        <option value="<%= domain %>" <%= domain === verifiedDomain ? \'selected\':\'\' %>>@<%= domain %></option>\n                        <% }) %>\n                    </select>\n                </div>\n            </div>\n            <p class="sDesc gColorGr1 gMat13"><%= IM(\'bandjoin.join_application.send_verification_email.txt.desc\') %></p>\n        </div>\n    </div>\n    <footer class="modalFooter">\n        <button type="button" class="uButton -cancel _btnCancel"><%= IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton <%= !verifiedEmailId ? \'-disabled\':\'\' %> _btnNext" <%= !verifiedEmailId ? \'disabled="disabled"\':\'\' %>><%= IM(\'ui.label.next\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1311),s=n(486),a=n(54),r=n(555),l=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DGroupBandJoinEmailVerificationCodeSendLayerView"},template:t.template(o),templateContext:function(){return{email:this._email}},ui:{inputVerificationCode:"#inputVerificationCode",btnCancel:"._btnCancel",btnConfirm:"._btnConfirm",btnResendEmail:"._btnResendEmail",messageAlert:"#messageAlert"},events:{"keydown @ui.inputVerificationCode":function(e){if((e.ctrlKey||e.metaKey)&&e.keyCode===r.KEY_V)return!0;if(t.contains([r.RIGHT,r.LEFT,r.BACKSPACE,r.END,r.HOME],e.keyCode))return!0;var n=String.fromCharCode(e.keyCode);return 0===n.length||!!/\d/.test(n)},"keyup @ui.inputVerificationCode":function(e){e.keyCode!==r.ENTER?this.getUI("inputVerificationCode").val().trim().length>0?this.getUI("btnConfirm").removeClass("-disabled").prop("disabled",!1):(this.getUI("btnConfirm").addClass("-disabled").prop("disabled",!0),this._hideMessageAlert()):this.getUI("btnConfirm").click()},"click @ui.btnCancel":"destroy","click @ui.btnConfirm":function(e){var n=this.getUI("inputVerificationCode").val();a.verifyEmail(this._email,n,!1).done(t.bind((function(e){this.trigger("confirm",e.verification_token),this.destroy()}),this)).fail(t.bind((function(e,t,n){e.result_code&&1007===e.result_code?this._showMessageAlert("inputError",e.result_data.message):e.result_data&&e.result_data.message?alert(e.result_data.message):alert(IM("response.result_data.message"))}),this))},"click @ui.btnResendEmail":function(e){a.sendAuthEmail(this._email).then(t.bind((function(){this._showMessageAlert("guideText",IM("bandjoin.join_application.email_verification.txt.email_sent")),this._hideMessageAlert(3e3),this.getUI("inputVerificationCode").val("")}),this))}},initialize:function(e){this._email=e.email},_showMessageAlert:function(e,t){this.getUI("messageAlert").removeClass().addClass(["gMat9",e].join(" ")).text(t).show()},_hideMessageAlert:function(e){setTimeout(t.bind((function(){this.getUI("messageAlert").fadeOut()}),this),e||0)}});return l.openAsLayer=function(e){var t=new l({email:e});return s.open(t),t},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent" style="width: 340px">\n    <header class="modalHeader -noTitlebar">\n        <h1 class="gSrOnly"><%= IM(\'bandjoin.join_application.email_verification.code_input_layer.title\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gTaC">\n            <p class="headingMsg gPat32"><%= IM(\'bandjoin.join_application.email_verification.txt.email_sent\') %></p>\n            <p class="headingMsgDesc gMat5"><%= IM(\'bandjoin.join_application.email_verification.code_input_layer.desc\') %></p>\n            <div class="uInputWrap">\n                <div class="uInput -simpleLine -code -displayInline -borderColorGr4 gMat17 gMab5" style="width: 214px;">\n                    <label class="gSrOnly" for="inputVerificationCode"><%= IM(\'bandjoin.join_application.email_verification.code_input_layer.title\') %></label>\n                    <input type="text" id="inputVerificationCode" minlength="4" maxlength="4">\n                    <span class="border"></span>\n                </div>\n                <p id="messageAlert" style="display: none"></p>\n            </div>\n            <div class="emailIdSent gMat17"><%- email %></div>\n            <button type="button" class="buttonText -pointColor gFs14 gFw6 gMat6 _btnResendEmail"><%= IM(\'bandjoin.join_application.email_verification.code_input_layer.resend_email\') %></button>\n        </div>\n    </div>\n    <footer class="modalFooter">\n        <button type="button" class="uButton -cancel _btnCancel"><%= IM(\'ui.label.prev\') %></button>\n        <button type="button" class="uButton _btnConfirm" disabled="disabled"><%= IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="lyContent" style="width:320px">\n    <header class="modalHeader -noTitlebar -profile">\n        <h1 class="title gPat17 gPal11"><%- IM(\'bandjoin.join_info_show\') %></h1>\n        <p class="desc gMal8"><%- joinDateText %></p>\n    </header>\n\n    <div class="modalBody gMal20 gMar20">\n        <div class="modalContentWrap">\n<% if ( isApplicationExist ) { %>\n            <div class="joinInfoBox gMat14">\n                <p class="infoText"><%- joinApplicaionDateText %></p>\n                <p class="infoText"><%= acceptorHtml %></p>\n            </div>\n<% } %>\n<% if ( isJoinQuestiionExist ) { %>\n            <div class="joinQnaBox gMat12">\n                <div class="title gMat4"><%= joinQuestionAsHtml %></div>\n                <div class="answerInfoBox gMat8">\n                    <div class="answerInfoText"><%= joinAnswerAsHtml %></div>\n<%      if ( isJoinAnswerImagesExist ) { %>\n                    <div class="photoBox gMat9">\n                        <a href="#" class="answerImageItem _showMediaViewer">\n                            <img src="<%- joinAnswerThumbnail %>" class="_joinAnswerImage" alt="answerImage">\n                        </a>\n                    </div>\n<%      } %>\n                </div>\n            </div>\n<% } %>\n        </div>\n    </div>\n\n    <div class="modalFooter <%- modalFooterExtraClass %>">\n<% if ( hasApplicantComment ) { %>\n        <button type="button" class="uButton -confirm _openJoinTimeQnAApp"><%- IM(\'bandjoin.detail_button\') %></button>\n<% } %>\n        <button type="button" class="uButton -iconClose btnLyClose _closeBtn"><span class="gSrOnly"><%- IM(\'ui.label.close_layer\') %></span></button>\n    </div>\n</div>'},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="header">\n        <h1 class="title"><%- title %></h1>\n    </header>\n    <div class="main">\n        <p class="p"><%- description %></p>\n        <div class="p -tSpace">\n            <div class="uInput">\n                <label class="gSrOnly" for="copyTargetText"><%- title %></label>\n                <input type="text" id="copyTargetText" value="<%- copyTargetText %>">\n                <span class="border"></span>\n            </div>\n        </div>\n    </div>\n    <footer class="footer">\n        <button type="button" class="uButton _btnCopy" data-clipboard-target="#copyTargetText"><%- copyButtonText %></button>\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM("ui.label.close") %></span></button>\n    </footer>\n</div>'},function(e,t,n){var i,o;i=[n(0),n(2),n(4),n(16),n(488),n(2173),n(523),n(26),n(9)],void 0===(o=function(e,t,n,i,o,s,a,r,l){function c(e){return e?l.format.time(i(e,"HH:mm"),"hour_minute"):""}var d=n.View.extend({tagName:"div",className:"uInput -dropDown -h32 -bg -block",attributes:{"data-viewname":"DTimeInputView"},template:e.template(s),ui:{timeInput:"._timeInput",timePicker:"._timePicker",btnTime:"._btnTime",deleteBtn:"._deleteBtn"},events:{"focus @ui.timeInput":function(){this.trigger(d.EVENT.FOCUSED),this._showTimePicker()},"change @ui.timeInput":"_triggerTimeChangedEvent","keydown @ui.timeInput":"_keydown","keyup @ui.timeInput":"_keyup","blur @ui.timeInput":function(e){null==e.relatedTarget||this.el.contains(e.relatedTarget)||this._hideTimePicker()},"click @ui.btnTime":function(e){return e.stopPropagation(),this._selectTimeByIndex(t(e.currentTarget).data("index")),this._applySelectedTime(),!1},"wheel @ui.timePicker":"_wheeled","scroll @ui.timePicker":function(e){return e.preventDefault(),e.stopPropagation(),!1},"click @ui.timePicker":function(e){e.stopPropagation()},"click @ui.deleteBtn":function(){this.ui.timeInput.val("").change(),this._hideTimePicker()}},templateContext:function(){return{cid:this.cid,readOnlyInput:this._readOnlyInput,pickerDirection:this._pickerDirection,times:this._times,inputTime:c(this._inputTime),placeholder:this._placeholder,useTimeDelete:this._useTimeDelete}},initialize:function(e){this._minutesInterval=e.minutesInterval||30,this._times=this._getTimes(),this._inputTime=this._parseInputTime(e.inputTime||""),e.pickerTime?this._pickerTime=this._parseInputTime(e.pickerTime||""):this._inputTime?this._pickerTime=this._inputTime:this._pickerTime=a.startOfMinuteOfUnit(i(),30).format("HH:mm"),this._selectedTimeIndex=this._getTimeIndex(this._inputTime),this._readOnlyInput=e.readOnlyInput,this._pickerDirection=e.pickerDirection,this._placeholder=e.placeholder||IM("web.timepicker.topbar.text.title"),this._useTimeDelete=!!e.useTimeDelete},onAttach:function(){this.listenTo(r.getDGlobalChannel(),r.EVENT.HTML_CLICK,(function(e){this.el.contains(e.target)||this._hideTimePicker()}))},getTime:function(){return{time:this._inputTime,format:d.TIME_FORMAT}},setTime:function(e){this._inputTime=this._parseInputTime(e||""),this._inputTime&&(this._pickerTime=this._inputTime),this.ui.timeInput.val(c(this._inputTime))},disable:function(){this.$el.addClass(o.ELEMENT.DISABLED),this.ui.timeInput.prop("disabled",!0)},enable:function(){this.$el.removeClass(o.ELEMENT.DISABLED),this.ui.timeInput.prop("disabled",!1)},getElementId:function(){return this.ui.timeInput.attr("id")},_triggerTimeChangedEvent:function(){var e=this._parseInputTime(this.ui.timeInput.val());if(this._isValidTime(e)){var t=c(e);this.ui.timeInput.val()!=t&&this.ui.timeInput.val(t),this._inputTime=e,this._inputTime&&(this._pickerTime=this._inputTime),this.trigger(d.EVENT.TIME_CHANGED,this.getTime())}else this.ui.timeInput.val(c(this._inputTime))},_applySelectedTime:function(){var e=this._times[this._selectedTimeIndex];this._hideTimePicker(),this._isValidTime(e)&&this.ui.timeInput.val(e).change()},_isValidTime:function(e){return""==e||(!!i(e,d.TIME_FORMAT).isValid()||(alert(IM("web.scheduleedit.alert.wrong_time_format")),!1))},_showTimePicker:function(){this.ui.timePicker.is(":visible")||(this.$el.addClass("-dropDownOn"),this.ui.btnTime.removeClass("selected"),this._selectTime(this._pickerTime))},_hideTimePicker:function(){this.$el.removeClass("-dropDownOn"),this.ui.btnTime.removeClass("selected")},_selectTime:function(e){var t=this._getTimeIndex(e);this._selectTimeByIndex(t,!0)},_selectTimeByIndex:function(e,n){if(!(null==e||e<0||e>=this._times.length)){var i=e<=this._selectedTimeIndex;this._selectedTimeIndex=e,this.ui.btnTime.removeClass("selected");var o=this.ui.btnTime[this._selectedTimeIndex];t(o).addClass("selected"),this._scrollIntoTime(this._selectedTimeIndex,i,n)}},_scrollIntoTime:function(e,n,i){var o=t(this.ui.btnTime[e]),s=o.scrollParent(),a=s.height(),r=s.scrollTop(),l=r+a,c=o.outerHeight(),d=e*c;(i||!(r<=d&&d+c<=l))&&(i||n?s.scrollTop(d):s.scrollTop(d-(a-c)))},_wheeled:function(e){var t=this.ui.timePicker.scrollTop(),n=this.ui.timePicker.get(0).scrollHeight,i=t+this.ui.timePicker.outerHeight(),o=e.originalEvent.deltaY,s=o>0;if(0==t&&o<0)e.preventDefault();else{if(i!=n||!s)return!0;e.preventDefault()}},_keydown:function(e){if(e.stopPropagation(),this.ui.timePicker.is(":visible"))switch(e.which||e.keyCode){case 13:e.preventDefault();break;case 38:if(e.preventDefault(),0==this._selectedTimeIndex)return;this._selectTimeByIndex(this._selectedTimeIndex-1);break;case 40:if(e.preventDefault(),this._selectedTimeIndex>=this._times.length)return;this._selectTimeByIndex(this._selectedTimeIndex+1);break;default:this._hideTimePicker()}else switch(e.which||e.keyCode){case 13:e.preventDefault();break;case 38:e.preventDefault(),this._pickerDirection==d.PICKER_DIRECTION.UP&&this._showTimePicker();break;case 40:e.preventDefault(),this._pickerDirection==d.PICKER_DIRECTION.DOWN&&this._showTimePicker()}},_keyup:function(e){switch(e.stopPropagation(),e.which||e.keyCode){case 13:if(e.preventDefault(),!this.ui.timePicker.is(":visible"))return;return this._applySelectedTime(),this.ui.timeInput.blur(),!0;case 38:case 40:return!0;default:return!1}},_getTimeIndex:function(e){var t=i(e,d.TIME_FORMAT),n=60*t.hour()+t.minute();return Math.floor(n/this._minutesInterval)},_parseInputTime:function(e){if(""==(e=e.trim()))return"";var t=["a h:mm","h:mm a","HH:mm"],n=i(e,t);return!n.isValid()&&3===n.invalidAt()&&/^[^0-9]*?24.*?$/.test(e)&&(n=i(e.replace("24","00"),t)),n.format("HH:mm")},_getTimes:function(){var t=i().startOf("day"),n=i().add(1,"day").startOf("day"),o=a.momentsBy(t,n,this._minutesInterval,"minute");return e.map(o,(function(e){return l.format.time(e,"hour_minute")}),this)}});return d.TIME_FORMAT="HH:mm",d.PICKER_DIRECTION={UP:"up",DOWN:"down"},d.EVENT={TIME_CHANGED:"time:changed",FOCUSED:"FOCUSED"},d.buildTimeInputView=function(e){return new d(e)},d}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(1316);return t.View.extend({attributes:{"data-viewname":"DGroupBandMemberGroupSelectItemView"},className:"tLine",tagName:"li",template:i.template(o),ui:{checkInput:"._checkInput"},events:{"click @ui.checkInput":function(){this.model.toggleCheckState(),this.trigger("selectItemView:set_check_state")}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="flexList">\n    <label for="memberGroupItem_<%- memberGroupId %>" class="text -flex gCursorPointer gPat20 gPab20">\n        <span class="ellipsis"><%- name %></span>\n        <span class="memberNum gPal3">(<%- memberCount %>)</span>\n    </label>\n    <span class="etc gPat20 gPab20">\n        <span class="uCheck -checkbox -noLabel">\n            <input type="checkbox" id="memberGroupItem_<%- memberGroupId %>" class="checkInput _checkInput">\n            <span class="checkLabel">\n                <span class="shape "></span>\n            </span>\n        </span>\n    </span>\n</div>'},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'band.member.group.select_member_groups_title\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="rScroll -lrSpace -h360 -tLine gMat-1 _memberGroupsRegion"></div>\n            <p class="uEmpty -h360 _emptyView" style="display: none;">\n                <span><%- IM(\'band.member.group.empty_group_list\') %></span>\n            </p>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnCloseLayer"><span class="gSrOnly">돌아가기</span></button>\n        <button type="button" class="uButton -cancel _btnCloseLayer"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _btnConfirm -disabled" disabled="disabled"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="lyContent">\n    <header class="modalHeader">\n        <h1 class="title"><%= title %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContent gPat20 gPal20 gPar20">\n            <% if ( description ) { %>\n            <p class="p gMat-5 gMab15"><%= description %></p>\n            <% } %>\n            <ul class="selectArea">\n                <% _.each(radioItems, function(element, index) { %>\n                <li>\n                    <label for="radio_<%- viewId %>_<%- index %>" class="uCheck -radio">\n                        <input data-uiselector="inputRadio" type="radio" id="radio_<%- viewId %>_<%- index %>" name="check" class="checkInput" value="<%- element.value %>"<% if (element.value === initialCheckedValue) { %> checked="checked"<% } %>>\n                        <span class="checkLabel">\n                        <span class="shape"></span>\n                        <span class="text"><%- element.label %></span>\n                    </span>\n                    </label>\n                </li>\n                <% }) %>\n            </ul>\n        </div>\n    </div>\n\n    <footer class="modalFooter">\n        <button data-uiselector="btnCancel" type="button" class="uButton -cancel"><%- cancel %></button>\n        <button data-uiselector="btnConfirm" type="button" class="uButton -confirm"><%- confirm %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(2223),s=n(521),a=n(1555),r=n(13),l=n(506);function c(){var e=s.buildPersonalInfoAgreementData();return e.fetchAgreementData().then((function(){if(!e.isLocationCollectable()){var n=i.Deferred(),l=o.openLayer(),c=s.AGREE_TARGET.LOCATION;return l.once(o.EVENTS.CONFIRM,t.bind((function(){e.setPersonalInfoAgreements(c).then((function(){n.resolve()}),(function(i){if(1002===i.result_code){var o=t.propertyOf(i.result_data)("message"),l=r.getUserData().getBirthDate();a.openAsLayer({noticeMessage:o,type:s.AGREE_TARGET.LOCATION,birthday:l,onAfterGuardianAgreementCompleted:function(){e.setPersonalInfoAgreements(c).then((function(){n.resolve()}))},onAfterGuardianAgreementCanceled:function(){n.reject()}})}else n.reject(IM("error.wrong_request"))}))}),this)),l.once(o.EVENTS.CANCEL,t.bind((function(){n.reject()}),this)),n.promise()}})).then((function(){}),(function(e){var n;return t.isString(e)?n=e:t.isObject(e)&&(n=l.get(e,"result_data.message")),n&&alert(n),i.Deferred().reject()}))}function d(){return!!window.navigator.geolocation}function u(){return i.Deferred((function(e){(i.browser.msie||i.browser.msedge)&&t.delay((function(){e.reject(IM("geolocation.msg.browser_geolocation_permission.required"))}),2e4),i.Deferred((function(e){d()?window.navigator.geolocation.getCurrentPosition((function(t){e.resolve(t)}),(function(t){t&&1===t.code?e.reject(IM("geolocation.msg.browser_geolocation_permission.required")):e.reject(IM("geolocation.msg.browser_geolocation_unsupport"))}),{maximumAge:1/0,enableHighAccuracy:!1}):e.reject(IM("geolocation.msg.browser_geolocation_unsupport"))})).promise().then((function(t){e.resolve(t)}),(function(t){e.reject(t)}))})).promise()}return{isSupportGeoLocation:d,checkLocationPersonalInfoAgreement:c,requestCurrentPosition:u,requestCurrentPositionWithAgreement:function(){return d()?r.isLogedIn()?c().then(u):u():i.Deferred().reject(IM("geolocation.msg.browser_geolocation_unsupport"))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent <% if (wideView) { %> -w480<% } else { %> -w380<% } %>">\n    <header class="modalHeader">\n        <h1 class="title"><%- titleText %></h1>\n    </header>\n\n    <div class="modalBody -spaceNone">\n        <div class="modalContentWrap -heightFix gMal-20 gMar-20  _mainContainer" style="height: 390px;">\n            <form class="searchWrap columnFixed" autocomplete="off">\n                <label for="searchMember_<%- cid %>" class="searchIcon"><span class="gSrOnly"><%- IM("band_member_select.label.name") %></span></label>\n                <span class="inputWrap">\n                    <input type="text" id="searchMember_<%- cid %>" class="inputSearch _memberSearchInput" placeholder="<%- IM(\'band_member_select.label.name\') %>">\n                </span>\n                <button type="submit" class="btnSearch uButton -sizeS -default -disabled _btnSearch"><%- IM("ui.label.search") %></button>\n            </form>\n\n            <div class="selectedMembersWrap columnFixed _selectedMemberArea" style="display: none;">\n                <ul class="_selectedMemberListRegion"></ul>\n            </div>\n\n            <div class="btnGroupMemberSelect gMat-1 _memberGroupArea" style="display:none">\n                <a href="#" role="button" class="button _btnMemberGroupSelect"><%- IM(\'band.member.group.select_member_groups\') %></a>\n            </div>\n\n            <%if(descriptionExist){%>\n            <div class="msgWrap -tLine gPab15 gMat-1">\n                <div class="pText -smallFont -lightGray2 -lineHH"><%- descriptionText %></div>\n            </div>\n            <% } %>\n\n            <div class="gMat-1 columnFixed _memberSortArea" style="display: none;">\n                <div class="subTitleWrap -justifyBetween">\n                    <h2 class="subTitle _memberSortTitle"></h2>\n                    <div class="uSelect -textTypeSmall -taR -h20 _memberSortSelectArea">\n                        <select class="_memberSortSelect" title="<%- IM(\'member_list.sort.title\') %>"></select>\n                    </div>\n                </div>\n            </div>\n\n            <div class="_memberListArea selectBeforeList rScroll -lrSpace -tLine gMat-1 <% if (wideView) { %> -flexibleHeight<% } else { %> columnFlexible<% } %>" >\n                <p class="uLoading cMiddle _loadingArea">\n                    <img src="data:image/gif;base64,R0lGODlhQABAAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnaOjo6urq7Ozs7u7u8DAwMTExMfHx8nJycvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc3Nzc7Ozs7Ozs/Pz8/Pz8/Pz8/Pz9DQ0NDQ0NPT09fX19nZ2dzc3N/f3+Li4uTk5Ofn5+rq6uvr6+zs7O3t7e3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vb29vf39/j4+Pr6+v39/f7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////////////yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJBAD5ACwAAAAAQABAAAAI/gDzCRxIsKDBgezIZbM2zZfDh9SqZQPH7qDFixgzrrvm7KHHjx6nXVuXsaRJgtyogVzJ0hc1cCdjGmSXrWPLmyClaaso8+Q4aTiDrnSmrWdGdtWEKl1JjafRgtxs4pRGzRo2btywYWMo1BnMpwOt4XRmbdxRcNeA3qwGNp/YltS4OT2Z8qa1p2+ZkmyLLi/IuzHZ+fXojFvbguOkfgRsMulKa3MPC0TKkjFGcCwNS7bILbNGxQ81b+Y8NHJBlSBFjyb996K2lapXs/5odiZoX2xllxzsS5rp1x+dmdZtGyQ2g2o91iaesfNHaQUxL2Z+ErXHrwKtP0RH3eQ6kLnz/n3/SK17dZB7r6U2b9K5x+P5GnqEzr4kO9DQ2YG8Vt8kb3bSXddfSeOANA42IA03YEHGOfbQNAuWlJxD1mjni2URHmShfO9liBFvxnl4EYI4xSbiQO61ZOKJ+aTIEnwsEkSiXTEWNOOD5NVI0GBVfQShjgJx6FA1NzoEZD76fYRNgbQBGeBDFLWmo3ofVTShL8LpOI41Uv1YpC8rnggOl/yJB1J5RyI0kIMP7ZUmSme+adBtYQL5ZZZyDnQlbnkOxORHderIZmh9InkbmIUCt16fIOKmYI2NOrPcm41eOOmRFpIXqIeC4YShjuAc6tCmIrKTKZaF5qMNaJ++yQ43Eclhl2o+4FDjzKwGuYlrjAEBACH5BAkEAPkALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnaCgoKSkpKqqqrGxsbi4uL29vcHBwcXFxcfHx8nJycrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc7Ozs/Pz9DQ0NHR0dLS0tLS0tLS0tjY2Nvb297e3uHh4ePj4+Tk5OXl5eXl5ebm5ufn5+np6erq6uvr6+zs7O3t7e7u7vDw8PHx8fPz8/T09PX19fb29vb29vb29vf39/f39/n5+fv7+/39/f39/f7+/v7+/v7+/v///////////////////////////////////////////////////wj+APMJHEiwoEGC5LRJkwasocOF2rixO0ixosWL6BQ63MhxIzRr4i6KHEnwG7SOKFMCg8bNHcmXBd1pY6ayJkpm2lzCJDnTps+bIXdaZMfwp9GO0iYKNSiOpk9p07JJ/SbVWlGbzIIuFajNJjRq33RWJJftaspvW/OZRUpOKDlqNa0thZuSmtKtRFVS22ktJTR0aQuKO4lS2stvKaeJDTzQHd2O2UaKS8mNccXHHLVSZOeUI1rLFRF3ZHb34NqGn0GHLlxxcse9qi9yQxnZoLvODmHHvjht9GKBfTlC+737oDvCG2s3xt1Qc/GK6EYXnM1x2nOSmFETRO6w9HXoHaH+DXS9Uff3i6cB5wu+se15keQ6Vs7HHZjh9yPrW2cHGf/I7MDkQ117/okkWnvZdFSgSPxxVBZH9y1okX5rmSfhQb1tdJpyFx6U4EbMAcNhhwV9WFNqJJbo04gpCjSgSiy2aCKMLRo0Y0NrWVcjQdlBJdyOBK0lzY3AeNciZPFlBmQ+SW5UWUdyAUnkREIuWZ94+RDpXotNOhRllzjumOFGWtVXZIsNelTSay2eNt9AIap3IXkOMfMbkcNdeFt/MYWo44KccWSnhyi9WaA7ZjkXJEooFvhhhAcF2lGj/qGT1EV0lrfkQexxZOimAo3pUJ6gFpSdnKUSxN6nqQ6E2J8PrTJFXKy01mrrrbjmWlxAACH5BAkEAPkALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnaOjo6urq7Ozs7q6ur+/v8PDw8bGxsjIyMrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc7Ozs/Pz9DQ0NHR0dHR0dLS0tLS0tTU1NbW1tjY2NnZ2dvb293d3d/f3+Hh4ePj4+Tk5OXl5ebm5ufn5+jo6Ojo6Onp6evr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09Pb29vn5+fv7+/z8/P39/f7+/v7+/v7+/v///////////////////////////////////////////////////wj+APMJHEiwoMGB7MBxo0btl8OHDLmlO0ixosWL+cplg/awo8eO1MCtw0iypDtwHD+qXAlNXMmXBt1lW7ayZs1l3NzBfFmOps2fK3HuvMiuIdCjK6WxG3qw59Fp2bZtEyd1mzVpR5eVY0pQ3E9p29ARFXctZU1uXPNls3lN7E5002xSY3qtprWladnVXXltp9GP0LamJbjOrMdsL7fx1Tm4oDtrK11iLMe3cUVwKwVXZOfTo2TLFL1+XIaXItaPn0GHVjmXouKP4FRj3OtRM0F3nR9ak02S9sNljAm+7ggtOO+KuD9uc5zb4cjjk0cbF92xL3SScT3GHmjYYenrFtn+AR647uM08CV9OxSM2aNb9BfRfUScL/tDaPBLdsef76P1/BcN9xA78nkGIEYFdgSOgA4ZdyBFykHWkTQPYmSfQ9Nc+MtuFVqknoa/LNdhRQyqJOKIB5WoHIquAZUaiwOp6NGJMMYIFI015sPgMhrSl6NAEj6UoUfn/ShQd9aUaGQ+4s3YXkfv1UjdQ+g02RGOLKq3zJEe8ZcjkgKp90uUKCb40HaUefQfi3899Fw+3f3yXYfldUnQkxDBKGZqydWGYp3EGVSilw+6EyeWfToEzZsPBvmbgwKl+Us2kOaH50NYDjSNVihO+RCFm1Wan6cOkbYkQWI6ROaP7qQa4qkmBIH4S5GwCsSZmrUWJOmkuRq01i8v9pqPO9PYJuyxyCar7LI/BgQAIfkECQQA+AAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2doKCgpKSkqqqqr6+vtbW1ubm5vr6+wsLCxcXFx8fHycnJysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzc3Nzc3Nzs7Ozs7Oz8/P0tLS1NTU1tbW2NjY2tra3d3d39/f4uLi5OTk5ubm6Ojo6enp6+vr6+vr7Ozs7u7u7+/v8PDw8fHx8vLy8/Pz8/Pz9PT09fX19vb2+Pj4+fn5+vr6/Pz8/f39/f39/f39/v7+/v7+////////////////////////////////////////////////////////CP4A8QkcSLCgwYHswGWrRg2Yw4fSrGUrx+6gxYsYM6q7Ju2hx48eoWVTl7GkSYLgGoJcybIauJMwDbLbBo2lTZvPslWMeXLbs5tAbUIbxzMjO5VBk66strNoQXA/g0bMls2bt2zWptUM+sybU4LWgEK7Bq6pxXHWotq09hVfWJvTvMZk523aTbZF3660hq4tPnV2WeKFqffjM6J+B3pT+3FwycIemSYuyA7yw2omwbGUO9mgN5YvMbJj/JBzZ88rn5k1WG2l6dOoQVK7OM417IyfQW47yG5r5NslWxtejS8bSNXAjZIGtrug79LJS9b+CO0pyGnRTVoOLVC4R5LZM/6ikz1QHUhp4U0G/i7wGsjX6Q/m9nhN4HNgyONnvI+eHUjH+lnk3kfsTOcRYgFepNlHCoGUoFEgYUXdgxl1FJmFD2FH4UWQrfcQgBsSZBxQ2YRo0Yg3wWciPtsEpaKJ89lU4ooFoSgjjQVZ5iEwIK64ozQ/4kjQfRKBRJyJES7oEXc0GvjQOP6F9CKFllXU0Vh9CYnPaBPiMw54WgoUo0MzhlkQhg+BaaZA5n2E2ZoEIfUQk2uOCUx1cArE5UdlwundQ9AcKaSdwCBY51554kNofofatiY7f3rUY5PLOTSpiehY9qGZ3sj5X5jo3PdpmFGy9AydQkZ6maA02vlMcxJ5lnrnNqxq2dE0qCb6ZaLRBQQAIfkECQQA+gAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6eoaGhpaWlq6urr6+vtbW1urq6vr6+wcHBxMTExsbGyMjIysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzs7Oz8/P0dHR09PT1dXV2NjY2dnZ3Nzc3d3d3t7e39/f4eHh4uLi4+Pj5OTk5eXl5eXl5ubm5ubm5+fn6Ojo6enp6enp6urq6+vr7Ozs7e3t7u7u8PDw8vLy9PT09fX19vb29/f3+fn5+/v7/Pz8/v7+/v7+/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////CP4A9QkcSLCgwYHtxG2r9uwZM2DAmjXctk1cu4MYM2rcmG5bM4ggQ4qE2Gxbuo0oUyLc9nCky5fMtl1USbPgNmUvc+ZUtq1mTXEtdQp1yUycz43rPg5d+rLZuqMHzeEc6szZtGxYs02rOlWnspNQB4oTyqxaOZTlqgV9aTTsNJ3TwNZM9zbnNKh1XTqTCzWds5zQfOYV2cxcWIPmlI6sRnOs3pmHC7b767LtRnMvGUfOODgk34Ppuoa0vBmjY5HKnmZUPLo0ytMhm2WEDVKz642dIZJGuBZi4NspKYdkdjDbyGaQgWtsxxpiNsmiIRpWnhIz6uTGRTqjTlM4yOcDe/4DU80dZbqRxAWeF3m3vMrcYLN7dq9yfchvApunp5+yt+x1i/GnUjUjJTTSWQKiNZI48oGUoEojYaXdg8GJlI13wGxH4UYYVsXehrhpFx14IGLUYERZVVPVbiUSdCIwLdL0YowqnSgbjSh1piGOGnXII4cW/qhRhEJiVM6CRR5EoEjJJSmQf04WZB9I+EU5EHxWqodelgI9Q2SW1oWkTJNFMvellV6KtF+UuQHDopC0kZRlnMCkZmWbwHz2YztpIulkYpk5mU6fI7UnJF062YZjWuKJ9KaA61A0TUPRufRVjGEy5RSNmZL1KIWdvqQMiTiGqmY2ZGLa1Dd68ohZMwdVYWVRaQEBACH5BAkEAPoALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5+fn6KioqioqK2trbKysra2trm5ub29vcHBwcTExMfHx8nJycrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc3Nzc7OztDQ0NHR0dLS0tTU1NbW1tfX19nZ2dvb293d3d/f3+Hh4eTk5Obm5unp6erq6uvr6+vr6+zs7Ozs7Ozs7O3t7e7u7u/v7/Dw8PHx8fHx8fLy8vX19fb29vj4+Pn5+fn5+fr6+vv7+/39/f7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////wj+APUJHEiwoMGB7MhZm+asl8OH0KRZA8fuoMWLGDOms8bsocePHp1RS5expEmC3KSBXMmyFzRwJ2MetKaspc2VzK5VlHmSXMebQEEqu8YzIzuVQZOChLazaMFrNYE6gzbNGjdu1hY2BKoMptOB024qm0bOKDhqP1tK+6ovbEto3Jqe5AbN5jSnbldCI8nWXF6Qd2Oyq7tSGTe2BclFBRzzr8dpchELPMoycEZwLA9Ltsgts9HFHjVv5lw4ckHCH0WPJs3Y4rWVqlez/ljWIDvQDtfKLum4FzPTrz/+3l3yNkhrBtM+rE08Y2fhBZ8/bn4S9UOvAq07NEfdZDqQuvX+pcMNrfvJrR75CgQ3LSp28xilP0RekB03y/AxGvfILD/i3qb51xNIzAnI03EGOqVcL/glWN1HzjjIU28SymQNSBXGJJ9DGc6FYYclXfgRiCF+SOJFjpV34kXo5baiRewg+KJBmH303owCUQNSgC8uGCGOKIFEDZAEadeLekCasxSRYIF044w18sekPvt5RBSTSHmkDI8kbujQlUB62Ut4OIq5JZFi9vIkiZSt1OCJ3OD20JsgpmPknC/a12Jr1JFDDUUZkdPeTXTKlpczVVmF1TTQLMiSYfnJqdRjXK4W5aTCFWheb5MyY02lu0kalDRrmscONXve5CmSErIDjjUK0hiJqDXkgGpSQAAh+QQJBAD6ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSpqamurq60tLS8vLzCwsLGxsbIyMjKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Pz8/Q0NDT09PU1NTW1tbY2Nja2trd3d3f39/j4+Pk5OTk5OTl5eXl5eXm5ubm5ubn5+fo6Ojp6enq6urs7Ozt7e3v7+/x8fHz8/P19fX29vb39/f4+Pj4+Pj5+fn7+/v9/f39/f39/f3+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////////8I/gD1CRxIsKBBguS2TZM2rKFDadK2eVN3sKLFixgTMnTIsaNDZ9XEYRxJkiA4Zx5TqhzmzBu7kjALstvGbKXNlMy2vYxZkubNnzhF8ryoDhrQoymlURxqUFzNn86mZZsKbiq1aECZCWUqsNpNaCGXWiSXDaVNcFz1TbMZjdxQctRsVmMaVyU1sUzVYbXL02tKZ+bSFhRn1qM0mOBUTtspmCC7uh6zkRSn0ltji5A7brXIbm1HtJctJvbIDK9FbxxBhxadElpJcyiprR6JOnJJdpZnj/TMkRlj3ZfZFXYoGfhqc6SNz87cULVywcg7Onseei/HwNQFk/OYO3va4cOm/nkXzHzY+LSjObo9P1SdbfZDwYuHz5N3w2j0eWbryCx/zP0d+QcTgBwJWFJtBRo4EoEOKbigRw5ixBx+EVpk3X0VWvRehgVt11F3HA7EYEOmhQjedCEi5NFcKQ5kX0ObheiedC0OtBFHIIZIGX+/ccjOUxwV12J5vtVY3jAxZpgeRxSmuKRDpbWIoGaCqdNjY52p5NxQPzqTJFewqcRiWjcqBd2RDckm2IjDULNeTOTcmFKTYK4EzTZvVqQOONSAt2FaRv0kDTXbSFSoQn7ilGdaeiHlqEPQlCiYU49mJaRu7GQDZKXSZXMlpt4kipQzW3onTjWiKuYNdgKq4002DNFcOAwz0Ui1KFcBAQAh+QQJBAD5ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWqqqqvr6+zs7O6urrAwMDFxcXIyMjKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Pz8/R0dHT09PW1tbY2Nja2trc3Nze3t7g4ODj4+Pk5OTl5eXl5eXm5ubm5ubm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3v7+/x8fHz8/P09PT29vb39/f5+fn7+/v8/Pz9/f3+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////////////8I/gDzCRxIsKDBgeq+bZMmjZjDh9KmbTN3sKLFixjzkav27KHHjx6nfUOXsaRJdt86glzJ8pk4kzANstvWjKVNm822sYsJk1zNm0BZ5uSJUV3DoEhZQlNHtCK7nzejWcuWTRzVbNOgIW1GrulBci2zUbzIThxHoNu8GrT2sdrYmOai3ZSmliA7ldGYqkVXzWa1ugPRPesKWKBgltYKKy7IbhrLl4sj5/vGkrBkxeJWNtN7uXBmkHQ7K+4L0rLouqQ9Ntt5uu5TkNlaAwb7cbXsunI/frutVh3IZ7zVpn5oOjhMcyATGyeq8iHw5TyzgeQMvSRy3dVjws4OM/fDaNxN/g4nBj58RukfzZ8HqR4jeo/tL75/GN/ifIf1K95vlv+gY4/l9UdQcw5NIyBBvn0U24ECfebRWweORwyDAxFIjIEUXufRbhQe5RFJDKLzG4X5SAjZgSJ+9FxGrBl313ZFSfPXcv+p1mJFPjk0I2+UwegUWx6d2JqDHkGDkXdBykbkQ5thRBtIHHYmoUMQWrTkQ9PcWBg7UxKzYElA/gZiYTmuFKB4fo3ZlFF+NYUkaFVaV+NKyjV132/ViEPdQeZsYyFIQjZVJlDQSLTNNgptU42HN3GlmDpaJSUpgHsClg1UkwLlaGfsZPNnpkxmo2Vn4nwq6TPfjNoaOt/MGdQzEtYUV505WEWDKXnRZPNNpUQFBAAh+QQJBAD6ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+ioqKmpqarq6uysrK3t7e9vb3BwcHExMTHx8fJycnKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Ozs7Pz8/Q0NDR0dHT09PV1dXW1tbZ2dnc3Nze3t7g4ODi4uLk5OTm5ubn5+fp6enq6urr6+vr6+vs7Ozt7e3t7e3u7u7w8PDx8fH09PT4+Pj7+/v9/f3+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////8I/gD1CRxIsKDBgejGZaM2LZjDh9GsZSuH7qDFixgz6iMX7aHHjx6hXTOnsaRJguZAqlRJbdzJlxmhrZwZMltFmDgHXqPJ0yE0cjlzpuzZk9rNoCebOYyYLdu3b9msTZPZs5lLpCa/jTtqkZw1pTStYR1rEN23jjPFkl070FzDlWrZsv0GFmRcuWTRUYOLV+63lVf7kv0LshlXwUgJf5yGeK1ij9sak9370bBkrOjqPox8Gek4kNA6Y7UGMrBomEM9Mj6d861HkqxhPnZ4LTZOqhBtw9z58bBujJ8/mv6NER3IbMRNon1ILXlJ0qqda8wGUnpG6h+tY9xWXbvF2cG8/lvE7lH8QejlzRd0vVR9QdwO77o/7n4gOZBAC6KDLR39w6Nm7RWadJl9NCBHH30jHXjI6ZPaQ6slt9xD/LHnEH+6PehQcwMF55F8sVkYzHDwOZSfbeANSBB3lfl2WYEfNUgQjB5xyBplIbnIYoKsgRfMiQaJGIyCnfkI4oyaPURkYz5aBtxKS/bl45Al4fiRNS4ipRdfJvnnUTNRYjVOkg8diZGXqmGIkzlolplTmxB+k+VF3wjpZlBwPtSMNUAelNA1Jdo1Fl1EQTONRE81Zc2EM1m11pZERQrSNHPmRE6gkjbKWV/oZINppg9Bs02la41jJajBTDNcZ+Z4mmk0DyM5hw45UTGaKjXZbEVWQAAh+QQJBAD6ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKoqKivr6+1tbW7u7vAwMDFxcXIyMjKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Pz8/R0dHS0tLU1NTV1dXX19fY2NjZ2dnc3Nze3t7f39/h4eHj4+Pk5OTl5eXm5ubn5+fn5+fo6Ojp6enr6+vs7Ozt7e3u7u7v7+/y8vL09PT29vb5+fn9/f3+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////////8I/gD1CRxIsKDBgwS1OZs2bdu2cOgQSpxIsaJBbcMyahwG7ds5iyBDUsS4saSzbelEqlRJraTLYcxQrpxJUdrLl87C0dxp0ObNl9A+8uQZTps1aT5/ZmRWbqjTgeSwOVM6TOfTq+esKcV2teu5pC6tde1aDtpNsWOfpmv50mpap1pfCn07NNxLZhHp1gWq1ym2tn2Hgs3oLDDPdGZLajO8s5xLZikZzxw8bLHkledcFr68Mu7GuZxBZi75LbTKqRuhmRb5t2Tk1RXJuXQLm6JLy7VrKs5dcbA03hQ9Z/wNXCJJjdDMKV+et/jxn7iBP8+YWGN03tOhDUZbXPgwpCWJ/hf3PV088MHapjMrLvC23ZLkissuGS6dS67AW29MWZ1wcdTICTTdMKCtNtpGpelzoEbcweYdgQMBqFGBnC3o30ADTlPbNLcRlA4zLjVlmmMlQVbQgNC8JhliHRokYUbUhMahSQi9VxJ+jD1YlUT9aUSbXjamNhE6IM4WWJAa4UURiffppSOEFSGp0TQqOpXOjEaC9CQ0IjpV1k04gsTWS9NQKNI5WIY105MZWWMmRVlttZOUJmETH0VRvZhlY0UqxQxD1jjkkDUMUbXUmyqd06OhjKbW3FPh6NmoUjnppU2fk97EzHVvpaNQppppU2Vg52izqFIdIcpYOkVpg1RiCNpJk159TgUEACH5BAkEAPkALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnaOjo6urq7Ozs7u7u8HBwcXFxcjIyMnJycrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc7OztDQ0NHR0dPT09TU1NbW1tjY2NnZ2dzc3N/f3+Hh4ePj4+Xl5ejo6Onp6erq6uzs7Ozs7O3t7e7u7u/v7/Dw8PDw8PHx8fHx8fLy8vb29vn5+fv7+/z8/P39/f7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////////wj+APMJHEiwoMGDCBMqXMiwocN85R5KnPhwWTRvFDNqHOjtl8dm285tHOlwmseTy7CRXInw3MmXv6KJZEkz3zaYL5dhrLnSJM6X1Wby3LgN2s+T0oauHOfz5zSlS5cdfQp15DlpU6uSvPlTpVaiP5cJ/UqRK8ykZDWafTkurUasMJu5zXhOKkxrc8viXJaXolGY2/pKLIcTbb6xghH+fRkxX7Vl03YmNrjWI958z1BOazt5YN24h3FW60yw6clzHWFKJp2arTWciDvjtAb35DPSBZvBnLbYI1XcAnv/ynwX+EDTRy8bf330ZGDjNps7hx5d+i/lwJlL/50dJ/GT0Kj+I4eG/Db07x6laT8J3eXdcTg542590pv7l9w7V4OdT3fO2IL5Z5tA63n0XGeV/TIaRDhFg1s0ODWWT20nSSgYOTiFN1CCDk6G3C+r5WPXSwfmRd9HBhX4i1h9fQaTVwSdI+BJ+ZFFoUcsGgQfTiV+leAvMBp0o4Fp/WjYQS4C5mNYABL04y891vRkiAh9mF6TGl2VVUlHLSPfViPuNpGVvpEzUjkQbjmmdNFEudA526CHU40PDRlXNfYtxFSYTpHkDZ9HPTONNdZss40100QzY3PLuEnROcJZJ+mcWGaEDaCTWtfMlzWdg82imf7UjDWVsuRNpKH+Ig2VX5VTjZwRmlpjoWCo0RapoNaMU2pDAQEAIfkECQQA+gAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6en5+foKCgoaGhoqKio6OjpKSkpaWlpqamqamprq6utra2vb29w8PDx8fHycnJysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzs7Oz8/P0NDQ0tLS1NTU1tbW19fX2dnZ29vb3t7e4eHh4+Pj5eXl5ubm5+fn6Ojo6enp6urq6+vr7Ozs7e3t7u7u7u7u7+/v8PDw8fHx8vLy8/Pz9PT09fX19vb29/f3+Pj4+Pj4+fn5+vr6/Pz8/f39/f39/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////CP4A9QkcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyJFjO3AdQw6MRoybyI7ZiKmkdlLjOZUwpbW82I4ZTJjRZlZMeRMmS50TpfWEOW7hOmfngBbkNpSYsnYKoanMppQg06HQEoK7CQ1qVX08e1Y72E5ZT2XrvuojedYrQWpDmblVWnPoWIJlh4JUq+9lT2YFw+LkO1BoT5MDbfZMS1jfurgDt/aU2Vig1J5F9cHFXFngOLsCFcN01nmgs55ZH4stLdDwTbBDM5e+evNctaGsBaq+me0yzKy59YlWGc33yuBrUYMOfvum2dXMmx5G3ly6yru5q1vHzlq7dO6lvf4TM04sZ3DXKqGRJx2cPDTxczvb/TydNX3e+oZSDj80LXnArA1HDIDiydbYfT4J5BdXpbF1017C9VfZbjABKBBtMVVGHjFUEfRcbYRJ5lx84smlVl7Q4fXhYF+hp9JTB4nHYVUuqgShQacNhdhMGP6m0DorwrSjSD2+yJhW0u2HknQ3JiQjMdLER5OD9TW0oUrMNFnROQImCFGNvx050TlgqqTkQ5slaaBD41zpI0VF/mUNOUZxI02XKVIETpDSQSONNdZkA6g10eA5lDJrUrSOm9Y12pQzYmK0p6OUNqUMeBq1Uw2flTbFTDVSepSNoZ0yMyRQ4FBDalPRZJPUhA3ZVKPeWdBEU02iEwUEACH5BAkEAPkALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKurq7CwsLW1tby8vMLCwsbGxsjIyMrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzM3Nzc3Nzc7Ozs/Pz9HR0dTU1NbW1tjY2Nra2tzc3N/f3+Li4uTk5OXl5efn5+fn5+jo6Onp6enp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PLy8vT09Pb29vf39/n5+fv7+/39/f7+/v7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////////////wj+APMJHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Chx3LR1HEMOBHfsmDWRIa2VLDkOpcZqK0s6A+nS4rSYK6fVrIgN58pqNHdCHOezZDWhEtM5KwoOqcF16RRGY+q04DhnOhH29Nmt6sB1KlkeXLcUJzWvAs89iznT4NaYz4JWXYsTm8GyMc+hFUgUZ9uRPo/uFSiNK0G6MaMOzpfO57OB53xKWzwQJs6W+d6uLEdZYDmfJ/MVhtt5IOKSj/MFLi1Qc8l0n3E2ZR07ZjfXx+R29olt9MporAf6Lilt+LGzwfNZXmn8mN3kuHknz1y07vRu1WPODh7dOvTsK5/+c/drPHRwajiLp58+NSY13Mkb18WOkzNrkvXlxxTfeflKgacdAxxrASIXVkz2UVbbSl3l01dMglF2E056AeiTYoMtiBpB9LlHmX8lbZcPWT5hhlZkOKVGEG5xobVOgM49hddPaKHnl258FRWhUNHxV1Bzx4joEn44DYiQUlTVRCRbGCL0IE4NigTiZg0t6R6OFq0zZUk+KnRgihVidFV1k0G0pVFhTpTOhDpOBGROCT5Ujo3VmSdRdys9Uw04TR5kTjYwynbRmOCVFA012STaTaLVsAmeMyZalE57hVaanTR9XoTNjJZaCilK62zaaaXOYIMlR+AEOuoz3ZyK0jkW3dBp6TPWRJohNtRIw2lx2HSTqUQBAQAh+QQJBAD5ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKirq6uwsLC1tbW6urrAwMDExMTHx8fJycnKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Q0NDS0tLU1NTY2Njd3d3g4ODl5eXo6Ojq6urr6+vt7e3t7e3u7u7u7u7u7u7v7+/v7+/w8PDw8PDy8vLz8/P09PT19fX29vb4+Pj5+fn6+vr7+/v8/Pz9/f39/f3+/v7+/v7+/v7+/v7///////////////////////////////////////////////////8I/gDzCRxIsKDBgwgTKlzI8GC6cQ0jSpwoENw0ZNIoatw4kB22aMhCImPHsWREbNBEitRmsiVCdhdViqTmsuZAcCllqiRpsyU1nTKjnetpshpQkdNYEi1p9Gi1oUuZHoUGMapUoNR4Wt2o7ajSrRvZ5ZT5FazGnzrLmp04DqjatRHZgZRZDe5GazqhabUrcexKvhS7ypwGmGJMlekKS0ynk7DiiE1Vvn1M8KFAv8j0UjZ4rhrIjOx01t08UBtmdm1lViWdD5xOcHhlsu6o01rkkBlnC5QmkxpvlY5130Z2WORo3bGPhrSmW2By5ZMpY1P+t7lg6sybPz+aXXhjus3z/hXHiFZkbt1zjW8f2VwnNtcywelOrXJcaPCzh7P/LTLabLFBCaRfdHxdJ1J2jA3GGn8iJSbQeMhA9ViCKtF0k2ibQSgfQemJtBpgBobkX0HTyaQZYADK1F1HmCFjIV/l9bfXQCWSVSBQHxYEITIE9hRiSMcdlKKNYP2Y2YwGwZfWVkYis+FCMapUDZImsROlcRLpFxI0PU6Ek1MUaRnSNA5y1JlyQWZJXVJUKqTNjlhyJKZI0FSTo0HsgOMZdcikqZFpfIo4TTXWaKONNbYxqBw0T1Z5ZaCQztQmR+N0GGmg0GBjFTvWWHqpTtFgM6lN4Dx66TSNwpVOp59KU02ZDY+hlmhj1FgDzqgRBQQAIfkECQQA+AAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6en5+foKCgoaGhoqKio6OjpKSkpaWlpqamp6enrKystLS0u7u7wcHBxcXFyMjIysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nz8/P0NDQ0dHR0tLS1NTU19fX2tra3Nzc39/f4eHh5OTk5eXl5ubm5+fn6Ojo6enp6urq6+vr7Ozs7Ozs7e3t8PDw8vLy9fX19/f3+Pj4+fn5+/v7/Pz8/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////////////////////CP4A8QkcSLCgwYHnvF27Fi3aM2LhDkqcSLHiwXHXHhLbyBGixY8gKZ675qyjyY0RQ6oMOXLZyZcpV8qc6K3kS5gzcxYcp/EmTp06w7n0uXEZNGjTrFkrBzSnN6LEnFED17QqvmlEp42zalWaT2hMuVbF+vJZTLFAn76Udg5t1XA3qbmtOm6oSW9zq/bsiDdv2pdy/eo8Z7OjNMFArZ181hbxzHN2OZ51rFKxSWiUcxbmGDazynEnp3mWabnj1tEq90ZFrbLcycCsP6rtSDX2x9JFbYOkdln3R2i9fVcE3lG0cIqbiVk7TvHkcuYSnUPH563htIUkTT5njjsqcY7Gmf6T5Xg0OPPvG6Hx7ogZumqlJpdNdz6bY23h4E6CO/da/EmmqjnDXHLPCNQdMafpBppJ2gi0YHHCjcdRgskhqOBJAg50YDS6RSMdQpGhFBtc8TWm4WImZkbYhwStaNJho3llUoYG1ccRbI5JyFFfB6m2EY+C2ZgeReWE+CNiQhKzTIISkdhfXuudNJlESRITTYpVnePhS0BWpCNHZnEVjo8b4fiRjC9Fw6RM42z5UngqfVncmh+NIyd4OlXJkVT3TQQONRXe1ZRQUClpHXbXTNNQoUrSOVM5ZDIq6TOdWVWTpJhG1aVY1hiZaUfLbOfXOdYEiqkz1mCJ2DjaRHrTMxLaOOpZQkodpdEzRynljaoyBQQAIfkECQQA9wAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6en5+foKCgoaGhp6enrq6utra2vLy8wsLCxcXFyMjIycnJysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzs7Oz8/P0NDQ0tLS1NTU19fX2tra3Nzc4ODg4uLi4+Pj5OTk5ubm5+fn6Ojo6urq6urq6+vr7Ozs7e3t7e3t7u7u7+/v7+/v8fHx8/Pz9fX19/f3+Pj4+vr6+/v7/Pz8/f39/f39/v7+/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////////////////////////////CP4A7wkcSLCgwYHmwE17tuyXw4fNnE3zZu6gxYsYM5Kbpuyhx48el0GrmLGkyYHZmoFcuRLZyZcXzU1DxrLmx2cwcxIE19GmT4fedOY05+ynUZdCX2aj+XMZs2fTsmWbtrChQ5xJTT7ziewZuIzmvEH7mjXj1prMspEsy1bg2ZXMyLWde8/c24/IstGlW3Tls7V7y3pjqTdwW3JMPxY2zFYlyMWMs1pbCTmyUHOJHzqzzHYyXsCcdfb0SDa00ME3TWd17FGcaqHkQDJ7LRTaY9o6rT5UhnsoSGi9YaL2GDT4yWkgQRu/2PfhsuUnmaWGXhLkNOrVP17HjvE294vev/4ftC7eIkis5Qvqdjg7fcG7v3i7J4j84/ydIEvPN3f+/sDRDiGjXHDPqGWQbYphl02AzxQnUGwfNYMdawHKJZB0H1loHDiyEbRghNDB94uDAmXmUGWvcfiRfPSBJGBvmIWHEIBX9dbcQy8apGKCr3n2kTXMUabahx+1Z1GMMjJGpEc5XrSkRyjS9eRDJF4kokPODJgVUSwBd9KVvyCjX1lLsZQlTGD+8oxrWZFD4XQ5pflLM1FiZE5KNqGn040rKQMNRRl584yJ/QlG6ErLQBXVVM80QyNLec1lDoZGVXqTlklZc6ilLCkzJl3mWPMop0xuF5o3lJKKZZ2WkQPNehQ/KTONhsaFNY0zqTqU6DTgYPpSQAAh+QQJBAD3ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+ioqKmpqarq6uysrK5ubm+vr7Dw8PGxsbIyMjKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Pz8/Q0NDR0dHT09PV1dXY2Njc3Nzf39/h4eHj4+Pk5OTk5OTl5eXl5eXl5eXm5ubm5ubn5+fo6Ojp6enq6urq6urr6+vs7Ozu7u7w8PDx8fHy8vLz8/P09PT19fX39/f6+vr7+/v8/Pz8/Pz9/f3+/v7+/v7+/v7///////////////////////////////////////////////////////////////////8I/gDvCRxIsKBBguOuMWPWq6HDhde0nTtIsaLFi+YUOtzIcaMyaOAuihxJ0JuyjihT9lKmTR3JlwXVXTumsibKY9dcwiQ506bPmyF3Wjy37KdRlMwmCjUIjqbPZc2oSfUmFRrDp0sLXrOpzJk3nRXFUSua0lzWgVdTMhMnVJyzjtrOCnyb0pnSrOfSMpN7D1pKZWb5CgSn7BjYpd5SNjssWN3dpeBSxhVMeeA5pxy9Vd58L+1GzZwpR+7oLDRldZgdljYt2C9HZYxZC0XdMajss9o6NrvN9yTHx7x3jt64OvhSuhvZGl/q2+Gy5UvPdaQGXWhujsqrv6TWUftOz732/np/CR7a+JfTz5NMr15kR9DtLbKPX3E+/YP27xcEv1v/QfDP+WcQdxzF5p847wloEGkK7vdagwQRmByEApnTkXgUNucQcAImxlFxEKbWUGAQSugQbBTSxlF/0LVEkokOTWbcW4CRRFZmxnnYkIxDidgQfKzp6NBiIg33oWzX1TYSjKoZeJY6zaQE5EXgnWgbX+ZouJF5MCF3IYcwmePlkUK5Vld2L4lT5UYsCiUkSspcM85F53gDzY0pcXlWUz8x48w1gAbajJYpHYPmWXkdpehDTmbF56I+HUOdaepQ4yOkDSlDTaOnaUOoospMGRw40HyqEjPUHKrdOdpQsxBHCccw04w2JMoVEAAh+QQJBAD4ACwAAAAAQABAAIcAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6hoaGlpaWrq6uxsbG4uLi+vr7Dw8PGxsbJycnKysrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzNzc3Nzc3Ozs7Pz8/Q0NDS0tLU1NTX19fZ2dnb29vc3Nzd3d3f39/g4ODi4uLj4+Pk5OTl5eXl5eXm5ubm5ubn5+fo6Ojo6Ojp6enq6urr6+vs7Ozt7e3v7+/x8fH09PT29vb4+Pj5+fn7+/v9/f3+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7///////////////////////////////////////////////////////////8I/gDxCRxIsKDBgea4YWPGrJfDhwyxjTtIsaLFi/jCSUv2sKPHjsy4kcNIsiQ6bhw/qlyZ7FvJlwbRSTu2smbNY9jQwXwZjqbNnytx7rxoriHQoyuVmRt6sOdRZtKsWfsm1ZozZUePhWNK8NtPZdbEEf0GLWVNbFzxSbMJTexOcUZXMmMKraazpWnN1V0JbWdcj8m2piVIzqxHaS+t8dU5uCA6ZytdYgzHt3FFbisFVzTn06NkyxS9fpxrEevHz6BDH2ZMUfFHbqkx7tV6EV3nh85ik4TGjHVF1x2T+dZNcXjx2w5HEgctumPf5aANO8QLfbC40dUtA3/oNnvav72S/nlv/PH5eKbXPZ/nut2h8fUkwSuDzxR8bvo7P1rDn9/jfv4v6QdggOoNSJKABmKEYIIWgYcYgw16RBqErX1E4WUfdXchQeYsuCFB0s33YUFreaThiJR5ZN6IAknXC3UsYubRfSziY9tHmrHYXnjvUXijijUKlCKQQYLnEGofcqYSkhsO6RFsNTY3Y48MlvhRMspZFg6WoO2lEjRZMlWUQ8KBZiRIJ5IkjpcOPajdT8lA8w2VAo2DjYsO5TiYU0Ap4ww2gCqEDW9AHUMnTOaYhtSiEMGoHXKM1hQYdOhYA2mkDx1jzaGWfYPnoslww2ls5HADGajS6MmfOFYxgxxDB9Zw4yhTAQEAIfkECQQA+AAsAAAAAEAAQACHAAAAAQEBAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyMzMzNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWV1dXWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6eoaGhpaWlq6ursbGxuLi4vr6+w8PDxsbGycnJysrKy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzc3Nzs7Oz8/P0NDQ0dHR1NTU1tbW2dnZ3Nzc39/f4ODg4eHh4uLi4+Pj5OTk5eXl5eXl5ubm6Ojo6enp6urq6urq6+vr7Ozs7e3t7u7u7+/v8fHx8/Pz9fX19vb2+Pj4+fn5+/v7/Pz8/f39/v7+/v7+/v7+/v7+/v7+/v7+/v7+////////////////////////////////////////////////////////CP4A8QkcSLCgwYHpwmF75uyXw4fNoGEbl+6gxYsYM56b1uyhx48el2E7l7GkSYLhGoJcyfJZuJMwDabTtoylTZvJsFWMeVJbsptAbS4bx1OjyqBIVz7bWbRguJ9BI1675s3bNWjOagZN5q0pwmdAl00Lx9TiOGhQbULzig/aTWddY6bzdnTl2qJuWUIrxxbfubof78LMCzIZ0b4DvaUNPLhlWcT40hFmXNIby7iQDVpe+RJjusUPMWfWvDLZ44JgQYoeTRqks4vjVq5m3fqjtoPptHoUTPtiao+mDV4rfLp3wc8gbxcE/Wu2cYOxPy4ruNnj6+clJzvsLBDwL5LYM/6Wcz3wHPnwJb2Dn6YafeWPzg6DDu4+Y81n3pimA8m7vsVyp0Xn0WH+8TTcRwU2pV0zCRbVkXUN8sRfhDGBdA2FMLWHoUkabpiRhR6WBGKIGAHWH4mofcQgihYd6FFxLIYDEncsErTfR9PUeNCDD02nY0HsfeQci+bB92NB3vF1pEAyUrYkPro9ROCR2hD3JHIfPfMkPlV2eKR3zV3JXJhLNumljto9tNSSaTrEFZs2OQMemjc1kx+dNyUDzZS4hTMkbU8htYwzEnmjDTbYQPOgj+6l81tSLClZ3zhRQupRjgWmc02lljKaYDiPWjpng+dsamkzfEaYzjhX8fiQMwfPXEMWZAEBACH5BAkEAPcALAAAAABAAEAAhwAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKampq2trbW1tby8vMLCwsbGxsjIyMrKysvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM7Ozs/Pz9DQ0NLS0tPT09PT09XV1dbW1tfX19nZ2dvb293d3d/f3+Hh4eLi4uPj4+Xl5ebm5ufn5+jo6Onp6erq6uvr6+3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09Pf39/v7+/7+/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////////////////////////wj+AO8JHEiwoMGB6cBp0yZN2jNgwJ41XAgu3cGLGDNqRKftIcSPIENG1IZOo8mTCLUxE8myJTBm2iyinEkwnTZlLnOyVKaNJk1wK3UKFckMnM+NHocqDflM5tGC5XDqVNawWrar2ao1lJpTWcmnA8HpZHZNnElx14K6NAq2Ws5qX2mic+uy2lNqLqU5fYpOmktqPumKfFYOrMFySUNemymWJbW9hhH6ZclWY7mWiyNjFBwy7kV0XEFW1nyxcUhlkAsm/jiadGmWzzCaBpnZtUbOrA+mU/sRsO2Tk0EyO5htcOrfulcDy1YwXWiIhZGfvHx6b/GQ0qTPDP6R+UDeEI/+az+IjujA8iHtjkeJG9jX6yA9r8+IHmQ3gauHz0cJPnY6kbXtp9E1IiUkklkCniUSOPBBpEyCKD2XDYEgZQehSdwtl6GFF2a0YYbqdbgZduB5J+JFDUYkkoknGpQiSyy2WFM5NNZYoowogYgjcNjtaBKFH3HoI4oiDZnRbBAhaKRB/ym25EX5PUmcSPJJWd9HIUr5HZVaEvSikFo6J1J0Xd7zYlNlCgQeMGBKiSREAWqpHDCtPSnmgmleCVKWbrb0WJntQUQYoHlVOSSQLMGl5ZshkaXkkFENJVE12tTZITpz5jUkUEq1KWM2z8FoZzZrghSjkeh0M+epdopzVUMFzLDqWkAAOwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="\n                         width="32" height="32" alt="loading">\n                </p>\n\n                <ul class="listLine _memberListRegion" style="display: none;"></ul>\n                <button class="flexList -wFull listLine -tLine _btnSearchMoreMember" style="display:none;">\n                    <span class="thumb -searchIcon"></span>\n                    <span class="text gTaL">\n                        <span class="gFs13 gColorBk2 _searchMoreBtnText"></span>\n                    </span>\n                </button>\n            </div>\n\n            <div class="uEmpty  columnFlexible _emptyArea" style="display: none;">\n                <span class="_emptyMessage"><%- IM(\'member_list.label.nobody_available\') %></span>\n            </div>\n        </div>\n\n    </div>\n\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -cancel _btnClose"><%- cancelBtnText %></button>\n        <button type="button" class="uButton -confirm -disabled _btnSubmit"><%- submitBtnText %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(1322),o=t.CollectionView.extend({attributes:{"data-viewname":"DMemberSelectionMemberListView"},tagName:"ul",className:"listLine",childView:i,childViewOptions:function(){return{onlySingleSelection:this._onlySingleSelection,profileClickAsSelect:this._profileClickAsSelect}},initialize:function(e){this._onlySingleSelection=e.onlySingleSelection,this._profileClickAsSelect=e.profileClickAsSelect},onAttach:function(){this._renderSelectAllBtn()},selectMember:function(e){this.children.each((function(t){t.toggleSelectStatus(e,!0)})),this._renderSelectAllBtn()},deselectMember:function(e){this.children.each((function(t){t.toggleSelectStatus(e,!1)})),this._renderSelectAllBtn()},deselectAllMembers:function(){this.children.each((function(e){e.makeUnselectStatus()})),this._renderSelectAllBtn()},getMemberModelsOnly:function(){return this.collection.filter((function(e){return!e.isSelectAllBtn()}))},_renderSelectAllBtn:function(){var e=this._isAllMemberSelected();this.children.each((function(t){t.toggleAllBtnSelectStatus(e)}))},_isAllMemberSelected:function(){return this.collection.chain().filter((function(e){return!e.isSelectAllBtn()})).every((function(e){return e.isSelected()})).value()}});return o.buildDMemberSelectionMemberListView=function(e){return new o({collection:e.collection,onlySingleSelection:e.onlySingleSelection,profileClickAsSelect:e.profileClickAsSelect})},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1323),s=n(154),a=n(82),r=n(159);return i.View.extend({attributes:{"data-viewname":"DMemberSelectionMemberView"},tagName:"li",className:"tLine",behaviors:[r],template:t.template(o),templateContext:function(){var e=a.makeProfileThumbnailUrl(this.model.getProfileImageUrl());return{descriptionExist:this.model.isDescriptionExist(),profileThumbnail:e,profileInnerClass:a.makeProfileInnerClass(e),onlySingleSelection:this._onlySingleSelection,extraTextExist:this.model.isExtraTextExist()}},ui:{btnProfileImage:"._btnProfileImage",memberSelectInput:"._memberSelectInput"},events:{"click @ui.memberSelectInput":function(e){var n=this.ui.memberSelectInput.prop("checked"),i={memberSelectModel:this.model,toBeSelect:n};e.preventDefault(),s.wrapDeferPromise(this).then(t.bind((function(){this.spawn(r.MSG.MEMBER_SELECTION_MEMBER_CLICK,i)}),this))},"click @ui.btnProfileImage":function(){if(!this._profileClickAsSelect)return this.spawn(r.MSG.MEMBER_SELECTION_PROFILE_CLICK,{userNo:this.model.getUserNo(),name:this.model.getUserName(),profileImageUrl:this.model.getProfileImageUrl()}),!1;this.spawn(r.MSG.MEMBER_SELECTION_MEMBER_CLICK,{memberSelectModel:this.model,toBeSelect:!this.ui.memberSelectInput.prop("checked")})}},initialize:function(e){this._onlySingleSelection=e.onlySingleSelection,this._profileClickAsSelect=e.profileClickAsSelect},toggleAllBtnSelectStatus:function(e){this.model.isSelectAllBtn()&&this.model.isSelected()!=e&&(this.model.setSelected(e),this.render())},toggleSelectStatus:function(e,t){this.model.getUserNo()==e&&(this.model.setSelected(t),this.render())},makeUnselectStatus:function(){this.model.isSelected()&&this.toggleSelectStatus(this.model.getUserNo(),!1)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<label class="flexList">\n    <span class="thumb">\n        <a href="#" role="button" class="uProfile -size40 _btnProfileImage">\n            <span class="profileInner <%- profileInnerClass %>">\n                <img src="<%- profileThumbnail %>" alt="<%- userName %>">\n            </span>\n        </a>\n    </span>\n    <span class="text">\n        <span class="ellipsis"><%- userName %></span>\n        <% if (descriptionExist) { %>\n        <span class="sub2 -ellipsis"><%- description %></span>\n        <% } %>\n\n        <% if (extraTextExist) { %>\n        <span class="sub2"><%- extraText %></span>\n        <% } %>\n    </span>\n    <span class="etc">\n        <%\n            var className = onlySingleSelection ? " -radio" : " -checkbox";\n            var inputType = onlySingleSelection ? "radio" : "checkbox";\n        %>\n        <span class="uCheck <%- className %> <% if (disabled) { %>-disabled<% } %>">\n            <input type="<%- inputType %>" class="checkInput _memberSelectInput" value="<%- userNo %>" <% if (onlySingleSelection) { %> name="radio"<% } %><% if (selected) { %>checked="checked" <% } %> <% if (disabled) { %>disabled<% } %>>\n            <span class="checkLabel">\n                <span class="shape"></span>\n            </span>\n        </span>\n    </span>\n</label>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(1325),o=t.CollectionView.extend({attributes:{"data-viewname":"DMemberSelectionSelectedMemberListView"},tagName:"ul",className:"selectedMembers",childView:i,addSelectedMember:function(e){this.collection.set(e,{add:!0,merge:!0,remove:!1,at:0})},removeSelectedMember:function(e){this.isDestroyed()||this.collection.remove(e)},removeAllSelectedMembers:function(){this.isDestroyed()||this.collection.reset([])},isEmptyCollection:function(){return this.getSelectedMemberCount()<=0},getSelectedModels:function(){return this.collection.models},getSelectedMemberCount:function(){return this.collection.length},getSelectedMemberUserNos:function(){return this.isEmptyCollection()?[]:this.collection.map((function(e){return e.getUserNo()}))}});return o.buildDMemberSelectionSelectedMemberListView=function(e){return new o({collection:e.collection})},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1326),s=n(159);return i.View.extend({attributes:{"data-viewname":"DMemberSelectionSelectedMemberView"},tagName:"li",behaviors:[s],template:t.template(o),ui:{btnMemberDelete:"._btnMemberDelete"},events:{"click @ui.btnMemberDelete":function(){this.spawn(s.MSG.MEMBER_SELECTION_MEMBER_CLICK,{memberSelectModel:this.model,toBeSelect:!1})}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="uProfile -size40">\n\t<span class="profileInner <%- profileInnerClass %>">\n\t\t<img src="<%- profileThumbnail %>" alt="<%- userName %>">\n\t</span>\n</span>\n<span class="text"><%- userName %></span>\n<button type="button" class="delete _btnMemberDelete" ><span class="gSrOnly"><%= IM(\'ui.label.del\') %></span></button>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(581),o=t.Collection.extend({model:i});return o.buildMemberSelectionViewCollection=function(e){return new o(e||[],{})},o}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<section class="lyWrap lyPhotoViewer -darkBg _imageSectionArea">\n    <div class="photoViewer">\n        <header class="gSrOnly">\n            <h1><%= IM(\'photo.image_viewer\') %></h1>\n        </header>\n\n        <div class="photoContent">\n            <% if(isVideoExpired) { %>\n            <div class="uVideoExpired -size65"><span class="cont"><i></i><span><%= IM(\'storage_period.video.expired.msg\') %></span></span></div>\n            <% } else { %>\n            <div class="mediaWrap _mediaWrap">\n                <% if(isVideoExist) { %>\n                <div class="videoWrap _videoWrap"></div>\n                <% } %>\n            </div>\n            <% } %>\n            <% if ( showPrevNextButtons && !msg_popupOpen ) { %>\n            <% if (imageIndex > 0) { %>\n            <span class="btnArea leftArea _previousImageButton">\n                <button type="button" class="btnPrev"><span class="gSrOnly"><%= IM(\'photo.previous_photo\') %></span></button>\n            </span>\n            <% } %>\n            <% if (imageIndex < totalCount - 1 && imageIndex < finalIndex) { %>\n            <span class="btnArea rightArea _nextImageButton">\n                <button type="button" class="btnNext"><span class="gSrOnly"><%= IM(\'photo.next_photo\') %></span></button>\n            </span>\n            <% } %>\n            <% } %>\n            <% if(!isVideoExist && !expandSupport) { %>\n            <div class="preventSaveContent"></div>\n            <% } %>\n\n            <% if (!isVideoExpired && expiresAt) { %>\n            <div class="videoSaveExpire _expiresText">\n                <span class="expireText"><%- expiresAt %></span>\n            </div>\n            <% } %>\n        </div>\n\n        \x3c!-- 하단 푸터 영역 --\x3e\n        <div class="photoViewNavi <% if (!showPrevNextButtons) { %>-singlePhoto<% } %> _viewerFooterArea">\n\n            <% if ( showPrevNextButtons ) { %>\n            <div class="pageView">\n                <% if (msg_popupOpen) { %>\n                <button type="button" class="btnPrev <% if (imageIndex == 0) { %>-disabled<% } %> _previousImageButton" ><span class="gSrOnly"><%= IM(\'photo.previous_photo\') %></span></button>\n                <% } %>\n                <div class="box">\n                    <% if ( !hidePageIndex ) { %>\n                    <strong class="thisNum"><%- (pageNumber) %></strong><span class="totalNum"><%- pageCount %></span>\n                    <% } %>\n                </div>\n                <% if (msg_popupOpen) { %>\n                <button type="button" class="btnNext <% if (imageIndex == totalCount - 1) { %>-disabled<% } %> _nextImageButton"><span class="gSrOnly"><%= IM(\'photo.next_photo\') %></span></button>\n                <% } %>\n            </div>\n            <% } %>\n\n            <% if ( canGoPost ) { %>\n            <button type="button" class="goPost _goPostButton"><%= IM(\'web.imageviewer.topbar.btn.show_post\') %></button>\n            <% } %>\n            <% if ( canGoAlbum ) { %>\n            <button type="button" class="goAlbum _goAlbumButton"><%= IM(\'web.imageviewer.topbar.btn.albumGo\') %></button>\n            <% } %>\n\n            <div class="controlArea">\n                <% if ( msg_useEmotionOrComment ) { %>\n                <div class="infoBox _footerInfoBox" style="display:none">\n                    <div class="_emotionCountViewRegion"></div>\n                    <a href="#" class="comment _footerInfoComment"><em class="cnt"><%=comment_count%></em></a>\n                </div>\n                <% } %>\n\n                <% if (expandSupport) { %>\n                <div class="slideBox">\n                    <button type="button" class="btn zoomout _sliderZoomOut"><span class="gSrOnly"><%- IM("downsize") %></span></button>\n                    <div class="slider">\n                        <div class="sliderContainer _sliderWrapper">\n                            <div class="sliderRange _sliderRange"></div>\n                            <span class="sliderHandle _sliderHandle"></span>\n                        </div>\n                    </div>\n                    <button type="button" class="btn zoomin _sliderZoomIn"><span class="gSrOnly"><%- IM("enlargement") %></span></button>\n                    <button type="button" class="btn origin _originSizeButton"><span class="gSrOnly"><%- IM("original_view") %></span></button>\n                    <button type="button" class="btn fit _fitSizeButton" style="display:none;"><span class="gSrOnly"><%- IM("original_view") %></span></button>\n                </div>\n                <% } %>\n\n                <div class="optionBox">\n                    <div class="moreArea">\n                        <button type="button" class="btn save _downloadButton <%- isVideoExpiredClass %>" <%= (!isMediaDownloadPermitted) ? \'disabled\' : \'\' %>><span class="gSrOnly"><%- IM(\'ui.label.save\') %></span></button>\n                        <div class="lyMenu _downloadMenu" style="display:none"></div>\n                    </div>\n\n                    <% if (canClipboardImageCopy) { %>\n                    <button type="button" class="btn copy _btnCopyImage" title="<%= IM(\'ui.label.copy2\') %>"><span class="gSrOnly"><%- IM(\'media_viewer.clipboard_image_copy.btn_label\') %></span></button>\n                    <% } %>\n\n                    <div class="moreArea">\n                        <button type="button" class="btn more _moreButton" style="display:none"><span class="gSrOnly"><%= IM(\'ui.label.more.short\') %></span></button>\n                        <div class="_moreOptionListRegion lyMenu" style="display:none"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \x3c!-- // 하단 푸터 영역 --\x3e\n    </div>\n    <aside class="cContentsCard postPhoto <%- isLive ? \'isLive\' : \'\' %> _emotionCommentRegion" data-type="single comment" style="display: none;"></aside>\n\n    <% if ( !msg_popupOpen ) { %>\n    <span class="btnToggleArea">\n        <% if (msg_useEmotionOrComment) { %>\n            <button type="button" class="btnCommentToggle _fullScreenButton"><span class="gSrOnly"><%- IM("fold_comment")%></span></button>\n        <% } %>\n        <button type="button" class="btnLyClose _directCloseButton"><span class="gSrOnly"><%= IM(\'ui.label.close_layer\') %></span></button>\n    </span>\n    <% } %>\n</section>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=n(6),a=n(16),r=n(82),l=n(9),c=n(550),d=n(156),u=n(52),h=s.Model.extend({getImageIndex:function(){return this.get("imageIndex")},requestVideoUrl:function(){return this.isVideoExist()?this._hasValidVideoUrl()?t.Deferred().resolve(this._videoUrlResultData).promise():this._fetchVideoPromise?this._fetchVideoPromise:(this._fetchVideoPromise=t.Deferred(),this.trigger("model_fetchVideoUrl",this.cid,this.getVideoId(),this.getPhotoNo(),this.getMessageId()),this._fetchVideoPromise.promise()):t.Deferred().reject().promise()},resolveVideoFetchPromise:function(e){var t=o.trim(e.streaming)||e.streaming_url,n=e.download||e.download_url;if(!i.isEmpty(n)){var s=!!t||!n[c.QUALITY_480];this.setSosId(e.sos_id),this.setVideoUrl(o.trim(n[c.QUALITY_480])||o.trim(n[c.QUALITY_360])||t),this.setEncodingProgress(s),this.setGifUrl(n.gif),s||(this._videoUrlResultData=e,this._videoUrlExpationTime=Date.now()+6e5),this._fetchVideoPromise.resolve(e),this._fetchVideoPromise=null}},_hasValidVideoUrl:function(){return!(!this._videoUrlResultData||!this._videoUrlExpationTime)&&this._videoUrlExpationTime>Date.now()},getVideoUrl:function(){return this.get("videoUrl")},getVideoId:function(){return this._getVideo().videoId},isGifVideo:function(){return this._getVideo().is_gif},getSosId:function(){return this._getVideo().sosId},setSosId:function(e){var t=this._getVideo();t.sosId=e,this.set("video",t)},setVideoUrl:function(e){this.set("videoUrl",e,{silent:!0})},getVideoFileSize:function(){if(this.isVideoExist())return this._getVideo().size},getBandNo:function(){return this.get("bandNo")},getPhotoNo:function(){return this.get("photo_no")},isVideoExist:function(){return this.get("isVideoExist")},getAlbumName:function(){return this.getAlbum().name||IM("web.albumdetail.title.txt.total")},getAlbum:function(){return this.get("album")||{}},getIncreasingId:function(){return this.get("increasingId")},getPhotoUrl:function(){return this.get("photo_url")},getAuthorNo:function(){return this.getAuthor().user_no},getAuthorMemberType:function(){return this.getAuthor().member_type},isPostMedia:function(){return null!=this.getPostNo()},getAlbumNo:function(){return this.get("album_no")},getPostNo:function(){return this.get("post_no")},getAuthor:function(){return this.get("author")||{}},getEmotionCount:function(){return this.get("emotion_count")},setEmotionCount:function(e){this.set("emotion_count",e)},isProfileViewSupport:function(){return 1==this.get("profileViewSupport")},isRestricted:function(){return 1==this.get("is_restricted")},getMessageId:function(){return this.get("messageId")},isHidePageNumber:function(){return this.get("hidePageNumber")},getPageNumber:function(){return this.get("pageNumber")},getPageCount:function(){return this.get("pageCount")},getDownloadFileName:function(){return this.get("downloadFileName")},getPhotoListDownloadParams:function(){return this.get("photoListDownloadParams")},getChannelId:function(){return this.get("channelId")},isWidthHeightExist:function(){return null!=this.getWidth()&&null!=this.getHeight()},getWidth:function(){return this.get("width")},getHeight:function(){return this.get("height")},setPlaying:function(e){this.set("playing",e,{silent:!0})},isPlaying:function(){return 1==this.get("playing")},setEncodingProgress:function(e){this.set("encodingProgress",e)},isEncodingProgress:function(){return 1==this.get("encodingProgress")},getCommentCount:function(){return this.get("comment_count")},setCommentCount:function(e){this.set("comment_count",e)},isShowUserInfo:function(){return this.get("showUserInfo")},isShowEmotionOrComment:function(){return null!=this.get("comment_count")&&null!=this.get("emotion_count")},getProfileImageUrl:function(){return this.get("profileImageUrl")},getCreatedAt:function(){return this.get("createdAt")},setDownloadable:function(e){this.set("downloadable",e)},isDownloadable:function(){return 1==this.get("downloadable")},getVideoExpiresAt:function(){if(this.isVideoExist())return this._getVideo().expires_at},isVideoExpired:function(){return this.get("isVideoExpired")},isVideoExpiredSoon:function(){var e=this._getVideo().expires_at;return!!e&&d.isRemainExpireDays(e,90)},_getVideo:function(){return this.get("video")||{}},setGifUrl:function(e){this.set("gifUrl",e,{silent:!0})},getGifUrl:function(){return this.get("gifUrl")},isGiphy:function(){return"GIPHY"==this.get("originSource")},_isVideo:function(){return this.get("video")||!1},isLive:function(){return this._getVideo().is_live||!1},getLiveId:function(){return this._getVideo().live_id||null},getSavableState:function(){return this.get("savableState")},setSavableState:function(e){this.set("savableState",e)}});return h.buildDImageViewerModel=function(e,t,n,s,c,p){(e=u.decamelizeKeys(e)).video&&(e.video.video_id&&(e.video.videoId=e.video.video_id,delete e.video.video_id),e.video.sos_id&&(e.video.sosId=e.video.sos_id,delete e.video.sos_id)),e.channel_id&&(e.channelId=e.channel_id,delete e.channel_id),e.savable_state&&(e.savableState=e.savable_state,delete e.savable_state);var m=e.author,_=r.makeProfileThumbnailUrl(m?m.profile_image_url||m.face:void 0);return new h(i.extend(e,{imageIndex:c,increasingId:o.toNumber(i.uniqueId()),isVideoExist:!!e.video,isVideoExpired:!!e.video&&d.isExpiredFile(e.video.expires_at),bandNo:t,imageUrl:e.photo_url,profileImageUrl:_,createdAt:l.format.date(a(e.created_at),"long"),videoUrl:null,showEmotionIcon:!1,profileViewSupport:n,showUserInfo:s,originPhotoUrl:e.photo_url,originSource:e.source||null,postNo:p,messageId:e.message_id||null,downloadFileName:e.download_file_name||null,hidePageNumber:e.hide_page_number||!1,pageNumber:e.page_number||null,pageCount:e.page_count||null,photoListDownloadParams:e.photo_list_download_params||null}))},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(2),o=n(0),s=n(6),a=n(4),r=n(16),l=n(1331),c=n(9),d=n(533),u=n(551),h=n(1332),p=n(1182),m=n(1038),_=n(499),g=n(498),f=n(169),b=n(488),v=n(154),A=n(159),E=n(26),T=n(888),C=n(619),y=n(618),M=n(163),I=n(509),S=a.View.extend({attributes:{"data-viewname":"DImageViewerEmotionCommentView"},behaviors:{CourierBehavior:""},ui:{photoCommentRegion:"[data-uiselector=photoCommentRegion]",emotionRegion:"[data-uiselector=emotionRegion]",commentCountSpan:"[data-uiselector=commentCountSpan]",emotionCountViewRegion:"._emotionCountViewRegion",authorProfileImageRegion:"._authorProfileImage"},regions:{photoCommentRegion:"@ui.photoCommentRegion",emotionRegion:{el:"@ui.emotionRegion",replaceElement:!0},emotionCountViewRegion:{el:"@ui.emotionCountViewRegion",replaceElement:!0},authorProfileImageRegion:{el:"@ui.authorProfileImageRegion",replaceElement:!0}},onMessages:(t={},t[A.MSG.COMMENTLIST_CHANGE_COLLECTION]=function(){this._everCommentChangeTriggered?C.fetchPhotoTotalCommentCount(this.model.get("bandNo"),this.model.get("photoNo"),this).then(o.bind((function(e){null!=e&&(this.ui.commentCountSpan.text(e),this.model.set("commentCount",e),this.trigger("emotionCommentView:resetCommentCount",this,e))}),this)):this._everCommentChangeTriggered=!0},t[A.MSG.MESSAGE_INPUT_TEXTAREA_FOCUS]=function(){this.trigger("emotionCommentView:commentTyping")},t),events:{click:function(e){E.getDGlobalChannel().trigger(E.EVENT.HTML_CLICK);var t=i(e.target);return!("file"!=t.attr("type")&&!t.hasClass(f.OUTER_LINK))&&(e.stopPropagation(),!0)}},initialize:function(e){this._dataFetched=!1,this._isCommentingPermitted=e.isCommentingPermitted,this._enableEmotionComment=!e.disableEmotionComment},getTemplate:function(){return this._dataFetched?o.template(l):o.template(g)},serializeData:function(){if(!this._dataFetched)return{dataFetched:!1,_loading_size:_.Size.MEDIUM,middleClass:b.ELEMENT.AREA_VERTICAL_MIDDLE};var e=c.format.relative(this.model.get("createdAt"),"year_month_day",[{start:r.duration(1,"days").asMilliseconds(),end:r.duration(6,"months").asMilliseconds(),style:"month_day_time"}]);return{dataFetched:!0,isCertifiedAuthor:this.model.get("isCertifiedAuthor"),authorMemberProfile:this.model.get("authorMemberProfile"),authorDescription:this.model.get("authorDescription"),createdAt:e,commentCount:this.model.get("commentCount"),isCommentExist:null!=this.model.get("commentCount"),enableEmotionComment:this._enableEmotionComment}},onDomRefresh:function(){this._dataFetched&&!this.isDestroyed()&&(this.showChildView("authorProfileImageRegion",y.buildContentCreatorProfileImageView({memberProfile:this.model.get("authorMemberProfile"),userNoOrMemberKey:this.model.get("authorUserNo"),bandCore:this.options.bandData.getBandCore(),role:this.model.get("authorRole")})),this._enableEmotionComment&&(this._renderEmotionCountViewRegion(),this._renderCommentList(),this._renderEmotion()))},fetchDataAndShowLoadingView:function(e){this.model.set({bandNo:e.bandNo,photoNo:e.photoNo}),v.wrapActivePromise(d.getPhotoDetail(e.bandNo,e.photoNo),this).then(o.bind((function(t){this.trigger("emotionCommentView:fetchedPhotoInfo",this,e.imageIndex,t)}),this)),this._dataFetched=!1,this.render()},drawView:function(e,t,n){this._resetModelAttributes(e),this._dataFetched=!0,this._initCommentId=t,this._initCommentReplyId=n,this.render()},isMessageInputFocused:function(){return!!this._mediaCommentMainView&&this._mediaCommentMainView.isMessageInputFocused()},isModificationMode:function(){return!!this._mediaCommentMainView&&this._mediaCommentMainView.isModificationMode()},hasFocusingInput:function(){return this._mediaCommentMainView&&this._mediaCommentMainView.hasFocusingInput()},hasWritingComment:function(){return this._mediaCommentMainView&&this._mediaCommentMainView.hasWritingComment()},_renderCommentList:function(){this._mediaCommentMainView=h.buildDImageViewerCommentMainView({bandNo:this.model.get("bandNo"),photoNo:this.model.get("photoNo"),initCommentId:this._initCommentId,initCommentReplyId:this._initCommentReplyId,bandData:this.options.bandData,isCommentingPermitted:this._isCommentingPermitted}),this.showChildView("photoCommentRegion",this._mediaCommentMainView)},_renderEmotion:function(){var e=this.model.get("bandNo"),t=this.model.get("photoNo"),n=this.model.get("emotionTypeByViewer"),i=u.buildByResponse(this._photoDetailResultData.emotions),s=p.buildPhotoEmotionViewWithCollection(i,{bandCore:this.options.bandData.getBandCore(),photoNo:t,emotionTypeByViewer:n});this.listenTo(s,p.EVENT.SET_EMOTION,(function(n){this.model.set(n),this._renderEmotionCountViewRegion(),this._triggerResetEmotionCount(n),v.wrapActivePromise(d.getPhotoDetail(e,t),this).then(o.bind((function(e){this._resetModelAttributes(e),this._renderEmotionCountViewRegion(),this._renderEmotion()}),this))})),this.listenTo(s,p.EVENT.SHOW_EMOTION_LIST,(function(){m.openDEmotionListView(e,I.buildPhotoKey(t))})),this.showChildView("emotionRegion",s)},_triggerResetEmotionCount:function(e){this.trigger("emotionCommentView:resetEmotionCount",e)},_renderEmotionCountViewRegion:function(){var e=this.model.get("commonEmotionType"),t=this.getRegion("emotionCountViewRegion");null!=e?t.show(T.buildPostEmotionCountView(e,this.model.get("emotionCount"),this.model.get("emotionTypeByViewer"),!1)):t.hasView()&&t.empty()},_resetModelAttributes:function(e){this._photoDetailResultData=e,this.model.set({authorUserNo:e.photo.author.user_no,isCertifiedAuthor:e.photo.author.member_certified||!1,authorDescription:e.photo.author.description,authorRole:e.photo.author.role,authorMemberProfile:new M({name:e.photo.author.name,memberType:e.photo.author.member_type,profileImageUrl:e.photo.author.profile_image_url}),createdAt:e.photo.created_at,emotionCount:e.photo.emotion_count,commentCount:e.photo.comment_count,emotionTypeByViewer:o.pick(e.photo.emotion_by_viewer,"type").type,commonEmotionType:e.photo.common_emotion_type}),this._triggerResetEmotionCount(this.model.pick("emotionCount","emotionTypeByViewer","commonEmotionType"))}});return S.Model=s.Model.extend({defaults:function(){return{bandNo:null,photoNo:null,authorUserNo:null,authorDescription:null,authorRole:null,authorMemberProfile:null,createdAt:0,emotionCount:0,commentCount:0,emotionTypeByViewer:null,commonEmotionType:null}}}),S.buildDEmotionCommentView=function(e){var t=e.bandData,n=new S.Model({bandNo:t.getBandCore().bandNo});return e=o.extend({model:n},e),new S(e)},S}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="postWriter uFlexItem">\n    <span class="_authorProfileImage"></span>\n    <span class="postWriterInfoWrap">\n        <span class="ellipsis">\n            <strong class="text"><% if (isCertifiedAuthor) { %><span class="uOfficialBand -sizeS"><%= IM(\'ui.label.official_page_band\') %></span><% } %> <%- authorMemberProfile.name %></strong>\n            <span class="memo"><%- authorDescription %></span>\n        </span>\n        <time class="time"><%= createdAt %></time>\n    </span>\n</div>\n<% if (enableEmotionComment) { %>\n<div class="postCount">\n    <div class="faceComment">\n        <div class="_emotionCountViewRegion"></div>\n        <% if(isCommentExist) { %>\n        <span class="comment"><%-IM("web.postdetail.comment.title")%><span class="count" data-uiselector="commentCountSpan"><%-commentCount%></span></span>\n        <% } %>\n    </div>\n</div>\n<div class="postAdded">\n    <div data-uiselector="emotionRegion"></div>\n</div>\n\n<%\n/**\n댓글 스크롤 높이 계산\n상당 프로필 91px\n표정 101px\n\n부모 전체 높이에서 위에 여역을 뺀 높이 값\n*/\n%>\n<div data-uiselector="photoCommentRegion"></div>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(4),s=n(159),a=n(1049),r=n(508),l=n(26),c=n(1252),d=n(560),u=n(1037),h=n(565),p=n(509),m=n(487),_=o.View.extend({template:i.template('<h1 class="gSrOnly">'+IM("discover.post.comment.title")+'</h1><div class="_photoCommentListRegion scrollWrap faceTxt"></div><div class="cCommentWrite _commentInputRegion" ></div>'),ui:{photoCommentListRegion:"._photoCommentListRegion",commentInputRegion:"._commentInputRegion"},attributes:{"data-viewname":"DImageViewerCommentMainView"},regions:{photoCommentListRegion:"@ui.photoCommentListRegion",commentInputRegion:"@ui.commentInputRegion"},behaviors:[s,m],onMessages:(t={},t[s.MSG.MESSAGE_INPUT_TEXTAREA_FOCUS]=function(e){this._mostRecentlyFocusedInputView=e},t[s.MSG.COMMENT_SUMMON_AUTHOR]=function(e){this._summonAuthor(e)},t[s.MSG.COMMENT_CHANGE_TO_MODIFICATION_MODE]=function(){this._hideInputView()},t[s.MSG.COMMENT_CANCEL_MODIFICATION]=function(){this._showInputView()},t[s.MSG.COMMENTLIST_SHOW_INPUT]=function(){this._showInputView()},t[s.MSG.COMMENT_GO_FIRST_COMMENT]=function(){this._showInputView()},t[s.MSG.MESSAGE_INPUT_SUBMIT]=function(e){var t=e.submitData;d.writeComment(this._bandNo,p.buildPhotoKey(this._photoNo).toApiParams(!0),e.isSecret,t,e.memberType,this).then(i.bind((function(t){var n=t.comment.comment_id;this._photoCommentListView.setInitCommentId(n),this._photoCommentListView.fetchAroundComment(n).then(i.bind((function(){l.getCommentChannel().trigger(l.EVENT.BAND_FILE_UPDATED),this._photoCommentListView.scrollToComment(n),this._photoCommentListView.setInitCommentId(null),this._sendCreateConfirmLog(e)}),this))}),this)).always(i.bind((function(){this._commentInputView.releaseStandByMode()}),this))},t[s.MSG.MESSAGE_INPUT_SHOW_STICKER]=function(){this._photoCommentListView.toggleIfInputStickerShow(!0)},t[s.MSG.MESSAGE_INPUT_HIDE_STICKER]=function(){this._photoCommentListView.toggleIfInputStickerShow(!1)},t),initialize:function(e){this._bandNo=e.bandNo,this._photoNo=e.photoNo,this._initCommentId=e.initCommentId,this._initCommentReplyId=e.initCommentReplyId,this._isCommentingPermitted=e.isCommentingPermitted,this._bandData=e.bandData},onAttach:function(){this._photoCommentListView=c.buildDPhotoCommentListView({bandData:this._bandData,photoNo:this._photoNo,initCommentId:this._initCommentId,initCommentReplyId:this._initCommentReplyId,flexibleTooltipPositionSupport:!0,isCommentingPermitted:this._isCommentingPermitted}),this.showChildView("photoCommentListRegion",this._photoCommentListView),this._isCommentingPermitted&&(this.$el.addClass("-commentAccess"),this._commentInputView=this._createCommentInputView(),this.showChildView("commentInputRegion",this._commentInputView))},isMessageInputFocused:function(){return!(this.isDestroyed()||!this._commentInputView)&&this._commentInputView.isMessageInputFocused()},isModificationMode:function(){return!(this.isDestroyed()||!this._photoCommentListView)&&this._photoCommentListView.isModificationStatus()},hasFocusingInput:function(){return!(!this._commentInputView||!this._commentInputView.isMessageInputFocused())||u.hasFocusingInputDescendantOf(this.$el)},hasWritingComment:function(){return!(!this._commentInputView||!this._commentInputView.hasInputContent())||u.hasWritingInputDescendantOf(this.$el)},_createCommentInputView:function(){return a.buildDCommentInputView({messageLabel:IM("web.photodetail.comment.label.input_comment"),textareaPlaceHolder:IM("web.photodetail.comment.placeholder.input_comment"),buttonLabel:IM("ui.label.send"),textareaHeight:"25px",maxMessageLength:r.MAX_LENGTH,overMaxLengthAlertMessage:IM("web.photodetail.comment.message.over_max_message",{count:r.MAX_LENGTH}),bandNo:this._bandNo,standByMessage:IM("ui.label.sending"),currentProfileMemberType:this._bandData.getCurrentSelectedMemberProfileMemberTypeAtComment(),memberProfileArray:this._bandData.getSelectableMemberProfilesAtComment(),isStickerOnTop:!0,topWriteMoreWrap:!0,mentionOption:h.buildMentionOption({memberGroupMentionPossible:!0,dynamicSearchPossible:!0})})},_hideInputView:function(){this.ui.photoCommentListRegion.attr("data-status","commentHide"),this.ui.commentInputRegion.hide()},_showInputView:function(){this.ui.photoCommentListRegion.removeAttr("data-status"),this.ui.commentInputRegion.show()},_summonAuthor:function(e){this._isCommentingPermitted&&(this._mostRecentlyFocusedInputView&&!this._mostRecentlyFocusedInputView.isDestroyed()?this._mostRecentlyFocusedInputView.appendMention(e.userNo,e.userName,e.isPageProfile):this._commentInputView.appendMention(e.userNo,e.userName,e.isPageProfile))},_sendCreateConfirmLog:function(e){var t=i.extend({band_no:this._bandNo,photo_no:this._photoNo},e.jplExtra);this.jplClick(m.CLASSIFIER.COMMENT_CREATE_CONFIRM,t)}});return _.buildDImageViewerCommentMainView=function(e){return new _(e)},_}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<h1 class="gSrOnly"><%- messageLabel %></h1>\n\n<% if ( topWriteMoreWrap ) { %>\n<div class="writeMoreWrap _photoArea" style="display: none;">\n    <div class="commentMediaListBox">\n        <div class="attachPhotoList _photoList"></div>\n        <label class="btnPhotoUpload _photoInputArea">\n            <input type="file" accept="image/*" title="<%= IM(\'profile.choose_profile_image\') %>" name="attachment" class="imageUpload _imageUploadButton">\n        </label>\n    </div>\n</div>\n<% } %>\n\n<div class="writeMain _writeMain">\n<% if ( isStickerOnTop ) { %>\n    <div class="stickerSelectRegion _stickerSelectRegion" style="display:none;"></div>\n<% } %>\n    <div class="writeBtn">\n        <div class="btnUploadWrap">\n            <button type="button" class="btnUpload _btnUpload"><span class="gSrOnly"><%= IM(\'web.postwrite.attach.d_title.file\') %></span></button>\n            <div class="lyMenu _lyMenu">\n                <ul class="uploadItemList">\n                    <li class="uploadItem _mediaUploadArea"><label><% // 동적으로 label문구를 바꿔야 하는 경우 고려 span추가  %><span class="_mediaUploadLabel"><%= IM(\'albumdetail.media.btn.select\') %></span><input type="file" accept="image/*" title="<%= IM(\'albumdetail.media.btn.select\') %>" name="attachment" class="inputUploadFile _imageUploadButton"></label></li>\n                    <li class="uploadItem _fileUploadArea" style="display: none;"><label><%= IM(\'web.postwrite.attach.d_title.file\') %><input type="file" title="<%= IM(\'web.postwrite.attach.d_title.file\') %>" name="attachment" class="inputUploadFile _fileUploadButton"></label></li>\n                </ul>\n            </div>\n        </div>\n    </div>\n\n    <div class="writeWrap">\n        <div class="flexBox">\n            <div class="profileStatus _profileInputRegion"></div>\n            <div class="mentionsWrap">\n                <div class="uInputComment">\n                    <label class="gSrOnly" for="write_comment_<%= cid %>"><%= messageLabel %></label>\n                    <textarea cols="20" rows="1" class="commentWrite _use_keyup_event _messageTextArea" id="write_comment_<%= cid %>" placeholder="<%- textareaPlaceHolder %>" style="<%= msg_getTextAreaStyle() %>"></textarea>\n                </div>\n            </div>\n\n            <button type="button" class="btnSecret _secretModeButton"><span class="gSrOnly"><%- IM(\'bandsetting.home.btn.secret_comment_use\') %></span></button>\n            <button type="button" class="btnSticker _stickerInputButton"><span class="gSrOnly"><%= IM(\'sticker\') %></span></button>\n\n<% if ( !isStickerOnTop ) { %>\n            <div class="stickerSelectRegion _stickerSelectRegion" style="display:none;"></div>\n<% } %>\n            <div class="lyAutoComplete _mentionListParent _offsetAdjustEl"></div>\n        </div>\n    </div>\n    <div class="submitWrap">\n        <div class="uploadPreviewWrap _previewArea" style="display:none;">\n            <div class="uploadPreview">\n                <div class="_uploadContextWrap"><% // fileWrap, mediaWrap(이미지, 동영상), 로드 후 동영상은 video 스타일 추가 %>\n                    <img src="" alt="" class="_prevent_context _previewImage" style="display:none;">\n                    <span class="fileName _previewFile" style="display:none;"></span>\n                    <img class="loading _loadingImage" src="<%= resBaseUrl %>/images/common/loading4.gif" width="32" height="32">\n                </div>\n                <button class="_closePreviewButton" type="button"><span class="gSrOnly"><%= IM(\'ui.label.cancel\') %></span></button>\n            </div>\n            <span class="arrow"></span>\n        </div>\n        <button type="submit" class="writeSubmit uButton -disabled _sendMessageButton"><%- buttonLabel %></button>\n    </div>\n</div>\n\n<% if ( !topWriteMoreWrap ) { %>\n<div class="writeMoreWrap _photoArea" style="display: none;">\n    <div class="commentMediaListBox">\n        <div class="attachPhotoList _photoList"></div>\n        <label class="btnPhotoUpload _photoInputArea">\n            <input type="file" accept="image/*" title="<%= IM(\'profile.choose_profile_image\') %>" name="attachment" class="imageUpload _imageUploadButton">\n        </label>\n    </div>\n</div>\n<% } %>\n\n\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(2),n(6)),o=n(4),s=n(1335),a=n(1336),r=n(195),l="LEFT",c="RIGHT",d=o.View.extend({className:"stickerHeader",attributes:{"data-viewname":"DStickerUsingPackListView"},ui:{usingPackRegion:"._usingPackRegion",prevButton:"._prevButton",nextButton:"._nextButton",stickerNav:"._stickerNav"},regions:{usingPackRegion:{el:"._usingPackRegion"}},template:t.template(s),events:{"click @ui.prevButton":function(){this._goToPage(l)},"click @ui.nextButton":function(){this._goToPage(c)}},initialize:function(){this._iScroll=null},onAttach:function(){this._destroyIScroll();var e=this.getRegion("usingPackRegion").currentView.children;e.isEmpty()||(t.defer(t.bind((function(){e.first().clickPack()}),this)),this._createIScroll())},onBeforeDetach:function(){this._destroyIScroll()},onRender:function(){var e=new u({collection:this.collection});this.listenTo(e,"childview:packClicked",t.bind((function(e){this._selectedPackNo!=e.getPackNo()&&(this._selectedPackNo=e.getPackNo(),this.trigger("usingPack:change",e.getPackNo()),this.collection.each((function(t){t!=e?t.isSelected()&&t.unselect():t.isSelected()||t.select()})))}),this)),this.showChildView("usingPackRegion",e)},resetPacks:function(e){this.collection.reset(d.packNosToModels(e)),this._selectedPackNo=null,this.onAttach()},_createIScroll:function(){var e=this.getUI("usingPackRegion").innerWidth(),n=this.getChildView("usingPackRegion").children.first().$el.outerWidth(!0),i=Math.round(e/n),o=this.collection.size()-i;this.getUI("usingPackRegion").width(this.getUI("usingPackRegion").prop("scrollWidth")).data("endPage",o),this._iScroll=new r(this.ui.stickerNav.get(0),{scrollX:!0,scrollY:!1,eventPassthrough:!1,momentum:!0,snap:!0,snapSpeed:600}),this._iScroll.on("scrollEnd",t.bind((function(){this.ui.prevButton.toggleClass("-active",this._iScroll.currentPage.pageX>0),this.ui.nextButton.toggleClass("-active",this._iScroll.currentPage.pageX<o)}),this)),this._iScroll.goToPage(0,0)},_destroyIScroll:function(){null!=this._iScroll&&(this._iScroll.off("scrollEnd"),this._iScroll.destroy(),this._iScroll=null,this.getUI("usingPackRegion").attr("style",""))},_goToPage:function(e){var t=this.getUI("usingPackRegion").data("endPage");null!=this._iScroll&&(e===l&&this._iScroll.currentPage.pageX>0?this._iScroll.prev():e===c&&this._iScroll.currentPage.pageX<t&&this._iScroll.next())}}),u=o.CollectionView.extend({tagName:"ul",childView:a});return d.Collection=i.Collection.extend({model:a.Model}),d.packNosToModels=function(e){return t.map(e,(function(e){return a.Model.buildDStickerUsingPackItemViewModel(e)}))},d.buildDStickerUsingPackListView=function(e){return new d({collection:new d.Collection(d.packNosToModels(e))})},d}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button type="button" class="buttonNav -prev _prevButton"><span class="gSrOnly">IM(\'ui.label.prev\')</span></button>\n<div class="stickerNav _stickerNav">\n    <div class="_usingPackRegion"></div>\n</div>\n<button type="button" class="buttonNav -next _nextButton"><span class="gSrOnly">IM(\'ui.label.next\')</span></button>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(2),n(6)),o=n(4),s=n(1337),a=o.View.extend({ui:{usingPackRegion:"[data-uiselector=usingPackRegion]",eachPack:"[data-uiselector=eachPack]",onImage:"[data-uiselector=onImage]",offImage:"[data-uiselector=offImage]"},attributes:{"data-viewname":"DStickerUsingPackItemView","data-uiselector":"eachPackItemLi"},idAttribute:"packNo",tagName:"li",template:t.template(s),templateContext:{stickerBasePath:window.stickerBasePath},modelEvents:{change:function(){this.render()}},events:{click:function(){return this.clickPack(),!1},mousedown:function(){return!1},"click @ui.eachPack":function(){return this.clickPack(),!1},"mousedown @ui.eachPack":function(){return!1}},onRender:function(){this.ui.eachPack.toggleClass("active",this.model.isSelected())},onBeforeDetach:function(){this.ui.onImage.off(),this.ui.offImage.off()},clickPack:function(){this.trigger("packClicked",this.model)}});return a.Model=i.Model.extend({idAttribute:"packNo",getPackNo:function(){return this.get("packNo")},select:function(){this.set("isSelected",!0)},unselect:function(){this.set("isSelected",!1)},isSelected:function(){return 1==this.get("isSelected")}}),a.Model.buildDStickerUsingPackItemViewModel=function(e){return new a.Model({packNo:e,isSelected:!1})},a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% if ( isSelected ) { %>\n<button type="button" data-uiselector="eachPack" style="background-image:url(<%=stickerBasePath%>/band/sticker/v2/<%-packNo%>/tab/on?resolution_type=retina)">\n    <span class="gSrOnly" style="background-image:url(<%=stickerBasePath%>/band/sticker/v2/<%-packNo%>/tab/off?resolution_type=retina)"></span>\n</button>\n<% } else { %>\n<button type="button" data-uiselector="eachPack" style="background-image:url(<%=stickerBasePath%>/band/sticker/v2/<%-packNo%>/tab/off?resolution_type=retina)">\n    <span class="gSrOnly" style="background-image:url(<%=stickerBasePath%>/band/sticker/v2/<%-packNo%>/tab/on?resolution_type=retina)"></span>\n</button>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(2),n(6)),o=n(4),s=n(1339),a=n(1340),r=n(695),l=n(499),c=n(498),d=n(488),u=n(154),h=(n(1178),o.View.extend({className:"stickerCollect",ui:{spriteImage:"[data-uiselector=spriteImage]"},attributes:{"data-viewname":"DStickerSpritesListView"},behaviors:{CustomScrollBehavior:{}},regions:{spritesRegion:{el:"._spritesRegion",replaceElement:!0}},initialize:function(){this._spritesCollection=r.singletonBuildStickerSpritesDataCollection(),this._dataFetched=!1},getTemplate:function(){return this._dataFetched?t.template(s):t.template(c+'<div class="_spritesRegion" style="display: none;"></div>')},serializeData:function(){return this._dataFetched?{stickerAreaID:(new h.TemporaryModel).cid}:{_loading_size:l.Size.SMALL,middleClass:d.ELEMENT.AREA_VERTICAL_MIDDLE}},onRender:function(){this._dataFetched&&(this.showChildView("spritesRegion",new p({collection:this.collection})),this.triggerMethod("customScroll:init",!0))},renderSpriteView:function(e){this._dataFetched=!1,this.collection.reset([],{silent:!0});var n=this._spritesCollection.asyncFetchStickerSpritesData(e);u.wrapActivePromise(n,this).then(t.bind((function(e){var n=1,i=e.getStickerIdList(),o=[];t.each(i,(function(t){var i=a.Model.buildDStickerSpritesItemViewModel(e,t,n++);o.push(i.toJSON())})),this.collection.reset(o,{silent:!0}),this._dataFetched=!0,this.render()}),this))}})),p=o.CollectionView.extend({tagName:"ul",childView:a});return h.Collection=i.Collection.extend({model:a.Model}),h.buildDStickerSpritesView=function(){return new h({collection:new h.Collection})},h.TemporaryModel=i.Model.extend({}),h}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="nano"><div class="nano-content">\n<div class="_sticker<%= stickerAreaID %> stickerList" data-sticker="<%= stickerAreaID %>">\n\t<div class="_spritesRegion">\n\t</div>\n</div>\n</div></div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(2),n(6)),o=n(4),s=n(159),a=n(154),r=n(1341),l=o.View.extend({idAttribute:"stickerId",attributes:{"data-viewname":"DStickerSpritesItemView"},tagName:"li",template:t.template(r),behaviors:{CourierBehavior:""},events:{click:function(){this.spawn(s.MSG.DSTICKER_CLICK,{packNo:this.model.getPackNo(),stickerId:this.model.getStickerId()}),clearTimeout(this._timer);var e=a.wrapActiveSetTimeout(200,this);this._timer=e.timer,e.then(t.bind((function(){this.spawn(s.MSG.DSTICKER_SELECT,{packNo:this.model.getPackNo(),stickerId:this.model.getStickerId()})}),this))},dblclick:function(){clearTimeout(this._timer),this.spawn(s.MSG.DSTICKER_DOUBLE_CLICK,{packNo:this.model.getPackNo(),stickerId:this.model.getStickerId()})}}});return l.Model=i.Model.extend({getPackNo:function(){return this.get("packNo")},getStickerId:function(){return this.get("stickerId")}}),l.Model.buildDStickerSpritesItemViewModel=function(e,t,n){return new l.Model({index:n,stickerId:t,packNo:e.getPackNo(),spriteImgUrl:window.stickerBasePath+e.getSpriteImgUrl(),spriteBgSize:e.getSpriteBgSize()})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button type="button" class="thumb stkr_<%= index %> _prevent_context" style="background-image:url(<%- spriteImgUrl %>);background-size:<%= spriteBgSize %>"><span class="alt"><%= packNo %>-<%= stickerId %></span></button>'},function(e,t,n){var i,o;i=[n(2)],void 0===(o=function(e){return function(e,t,n){"use strict";var i,o,s,a,r,l,c,d,u,h,p,m,_,g,f,b;d={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",enabledClass:"has-scrollbar",flashedClass:"flashed",activeClass:"active",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},r="scroll",l="up",s="DOMMouseScroll",i="Microsoft Internet Explorer"===t.navigator.appName&&/msie 7./i.test(t.navigator.appVersion)&&t.ActiveXObject,o=null,m=t.requestAnimationFrame,c=t.cancelAnimationFrame,g=n.createElement("div").style,f=function(){var e,t,n,i;for(e=n=0,i=(t=["t","webkitT","MozT","msT","OT"]).length;n<i;e=++n)if(t[e],t[e]+"ransform"in g)return t[e].substr(0,t[e].length-1);return!1}(),b="transform",_=!1!==f&&(""===f?b:f+b.charAt(0).toUpperCase()+b.substr(1)),h=!1!==_,u=function(){var e,t,i;return(t=(e=n.createElement("div")).style).position="absolute",t.width="100px",t.height="100px",t.overflow=r,t.top="-9999px",n.body.appendChild(e),i=e.offsetWidth-e.clientWidth,n.body.removeChild(e),i},p=function(){var e,n,i;return n=t.navigator.userAgent,!!(e=/(?=.+Mac OS X)(?=.+Firefox)/.test(n))&&((i=/Firefox\/\d{2}\./.exec(n))&&(i=i[0].replace(/\D+/g,"")),e&&+i>23)},a=function(){function a(i,s){this.el=i,this.options=s,o||(o=u()),this.$el=e(this.el),this.doc=e(this.options.documentContext||n),this.win=e(this.options.windowContext||t),this.body=this.doc.find("body"),this.$content=this.$el.children("."+this.options.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return a.prototype.preventScrolling=function(e,t){if(this.isActive)if(e.type===s)("down"===t&&e.originalEvent.detail>0||t===l&&e.originalEvent.detail<0)&&e.preventDefault();else if("mousewheel"===e.type){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;("down"===t&&e.originalEvent.wheelDelta<0||t===l&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},a.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},a.prototype.updateScrollValues=function(){var e,t;e=this.content,this.maxScrollTop=e.scrollHeight-e.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=e.scrollTop,t=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==t&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:t}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},a.prototype.setOnScrollStyles=function(){var e,t;h?(e={})[_]="translate(0, "+this.sliderTop+"px)":e={top:this.sliderTop},m?(c&&this.scrollRAF&&c(this.scrollRAF),this.scrollRAF=m((t=this,function(){return t.scrollRAF=null,t.slider.css(e)}))):this.slider.css(e)},a.prototype.createEvents=function(){var e;this.events={down:(e=this,function(t){return e.isBeingDragged=!0,e.offsetY=t.pageY-e.slider.offset().top,e.slider.is(t.target)||(e.offsetY=0),e.pane.addClass(e.options.activeClass),e.doc.bind("mousemove",e.events.drag).bind("mouseup",e.events.up),e.body.bind("mouseenter",e.events.enter),!1}),drag:function(e){return function(t){return e.sliderY=t.pageY-e.$el.offset().top-e.paneTop-(e.offsetY||.5*e.sliderHeight),e.scroll(),e.contentScrollTop>=e.maxScrollTop&&e.prevScrollTop!==e.maxScrollTop?e.$el.trigger("scrollend"):0===e.contentScrollTop&&0!==e.prevScrollTop&&e.$el.trigger("scrolltop"),!1}}(this),up:function(e){return function(t){return e.isBeingDragged=!1,e.pane.removeClass(e.options.activeClass),e.doc.unbind("mousemove",e.events.drag).unbind("mouseup",e.events.up),e.body.unbind("mouseenter",e.events.enter),!1}}(this),resize:function(e){return function(t){e.reset()}}(this),panedown:function(e){return function(t){return e.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(t),!1}}(this),scroll:function(e){return function(t){e.updateScrollValues(),e.isBeingDragged||(e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.setOnScrollStyles()),null!=t&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(t,"down"),e.prevScrollTop!==e.maxScrollTop&&e.$el.trigger("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(t,l),0!==e.prevScrollTop&&e.$el.trigger("scrolltop"))))}}(this),wheel:function(e){return function(t){var n;if(null!=t)return(n=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail)&&(e.sliderY+=-n/3),e.scroll(),!1}}(this),enter:function(e){return function(t){var n;if(e.isBeingDragged)return 1!==(t.buttons||t.which)?(n=e.events).up.apply(n,arguments):void 0}}(this)}},a.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind("resize",e.resize),this.iOSNativeScrolling||(this.slider.bind("mousedown",e.down),this.pane.bind("mousedown",e.panedown).bind("mousewheel "+s,e.wheel)),this.$content.bind(r+" mousewheel "+s+" touchmove",e[r])},a.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind("resize",e.resize),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(r+" mousewheel "+s+" touchmove",e[r])},a.prototype.generate=function(){var e,n,i,s,a;return s=(n=this.options).paneClass,a=n.sliderClass,n.contentClass,(i=this.$el.children("."+s)).length||i.children("."+a).length||this.$el.append('<div class="'+s+'"><div class="'+a+'" /></div>'),this.pane=this.$el.children("."+s),this.slider=this.pane.find("."+a),0===o&&p()?e={right:-14,paddingRight:+t.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,"")+14}:o&&(e={right:-o},this.$el.addClass(n.enabledClass)),null!=e&&this.$content.css(e),this},a.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},a.prototype.reset=function(){var e,t,n,s,a,l,c,d,u,h,p;if(!this.iOSNativeScrolling)return this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),a=(s=(e=this.content).style).overflowY,i&&this.$content.css({height:this.$content.height()}),t=e.scrollHeight+o,(u=parseInt(this.$el.css("max-height"),10))>0&&(this.$el.height(""),this.$el.height(e.scrollHeight>u?u:e.scrollHeight)),c=(l=this.pane.outerHeight(!1))+(d=parseInt(this.pane.css("top"),10))+parseInt(this.pane.css("bottom"),10),(p=Math.round(c/t*l))<this.options.sliderMinHeight?p=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&p>this.options.sliderMaxHeight&&(p=this.options.sliderMaxHeight),a===r&&s.overflowX!==r&&(p+=o),this.maxSliderTop=c-p,this.contentHeight=t,this.paneHeight=l,this.paneOuterHeight=c,this.sliderHeight=p,this.paneTop=d,this.slider.height(p),this.events.scroll(),this.pane.show(),this.isActive=!0,e.scrollHeight===e.clientHeight||this.pane.outerHeight(!0)>=e.scrollHeight&&a!==r?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&a===r?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),"static"!==(n=this.$content.css("position"))&&"relative"!==n||(h=parseInt(this.$content.css("right"),10))&&this.$content.css({right:"",marginRight:h}),this;this.contentHeight=this.content.scrollHeight},a.prototype.scroll=function(){if(this.isActive)return this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this},a.prototype.scrollBottom=function(e){if(this.isActive)return this.$content.scrollTop(this.contentHeight-this.$content.height()-e).trigger("mousewheel"),this.stop().restore(),this},a.prototype.scrollTop=function(e){if(this.isActive)return this.$content.scrollTop(+e).trigger("mousewheel"),this.stop().restore(),this},a.prototype.scrollTo=function(e){if(this.isActive)return this.scrollTop(this.$el.find(e).get(0).offsetTop),this},a.prototype.stop=function(){return c&&this.scrollRAF&&(c(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},a.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),i&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass(this.options.enabledClass)&&(this.$el.removeClass(this.options.enabledClass),this.$content.css({right:""})),this},a.prototype.flash=function(){var e;if(!this.iOSNativeScrolling&&this.isActive)return this.reset(),this.pane.addClass(this.options.flashedClass),setTimeout((e=this,function(){e.pane.removeClass(e.options.flashedClass)}),this.options.flashDelay),this},a}(),e.fn.nanoScroller=function(t){return this.each((function(){var n,i;if((i=this.nanoscroller)||(n=e.extend({},d,t),this.nanoscroller=i=new a(this,n)),t&&"object"==typeof t){if(e.extend(i.options,t),null!=t.scrollBottom)return i.scrollBottom(t.scrollBottom);if(null!=t.scrollTop)return i.scrollTop(t.scrollTop);if(t.scrollTo)return i.scrollTo(t.scrollTo);if("bottom"===t.scroll)return i.scrollBottom(0);if("top"===t.scroll)return i.scrollTop(0);if(t.scroll&&t.scroll instanceof e)return i.scrollTo(t.scroll);if(t.stop)return i.stop();if(t.destroy)return i.destroy();if(t.flash)return i.flash()}return i.reset()}))},e.fn.nanoScroller.Constructor=a}(e,window,document)}.apply(t,i))||(e.exports=o)},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="header">\n        <h1 class="title"><%= IM(\'punishment.title.band_restricted\') %></h1>\n    </header>\n\n    <div class="main">\n        <div class="restrict">\n            <h2 class="title"><%= IM(\'punishment.content_creation.title\') %></h2>\n\n            <p class="desc"><%= IM(\'punishment.content_creation.desc\') %></p>\n\n            <div class="p -dotList -tLine -bLine -fs13">\n                <ul>\n                    <li><%= IM(\'punishment.start_date\') %> : <%- penaltyStart %></li>\n                    <li><%= IM(\'punishment.end_date\') %> : <%- penaltyEnd %></li>\n                    <li><%= IM(\'punishment.reason\') %> : <%- penaltyReason %></li>\n                    <li><%= IM(\'punishment.reported_band\') %> : <%- reportedBand %></li>\n                    <li class="multi3line"><%= IM(\'punishment.reported_contents\') %> : <%- penaltyContent %></li>\n                </ul>\n            </div>\n        </div>\n    </div>\n\n    <footer class="footer">\n        <button type="button" class="uButton -confirm _confirmBtn"><%= IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<%\nif ( !isProfileSelectable ) {\n%>\n<span class="current -border _currentProfile"></span>\n<%\n} else {\n%>\n<button type="button" class="current -multiProfileSelect _profileSelectBtn _currentProfile" aria-haspopup="true" aria-expanded="false"></button>\n\n<ul class="lyProfile _profileListUl">\n<%\n    _.each(inputProfileArray, function(profile) {\n%>\n    <li>\n        <button type="button" class="item _eachProfileBtn <%- profile.activeClass %>" data-member-type="<%- profile.memberType %>">\n\t\t\t<span class="uProfile _selectableProfile" data-member-type="<%- profile.memberType %>"></span>\n            <span class="name"><%- profile.name %></span>\n        </button>\n    </li>\n<%\n    });\n%>\n</ul>\n<%\n}\n%>\n\n'},function(e,t){e.exports='<% if (profileImageUrl) { %>\n<span class="profileInner _profileInner <%- profileInnerClass %>"><img class="_img" src="<%-profileThumbnail%>" width="21" height="21" alt="<%-name%>"></span>\n<% } else { %>\n<span class="profileInner"></span>\n<% } %>\n<% if (description) { %>\n<span class="gSrOnly"><%-description %></span>\n<% } %>'},function(e,t){e.exports='<div class="addContents -commentMedia -photo _inputPhoto">\n    <img src="<%- thumbnailUrl %>" class="_inputPhotoImg"><button type="button" class="delete _deleteAttachedPhoto" ><span class="gSrOnly"><%- IM("web.commentmodify.attach.btn.delete_attach_info") %></span></button>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(488),o=n(4),s=n(1348),a=n(1391),r=n(154),l=n(159),c=n(560),d=n(26),u=n(619),h=n(487),p=null,m=n.e(165).then(n.t.bind(null,1186,7)).then((function(e){p=e.default})),_=null,g=n.e(177).then(n.t.bind(null,1751,7)).then((function(e){_=e.default}));return o.View.extend({template:t.template(a),className:function(){return this.model.isMoreButton()?"":this.model.isSmallBox()?"cComment -commentSimple":"cComment"},tagName:"div",templateContext:function(){return{moreCommentExistExceptLatest:this.model.isMoreCommentExistExceptLatest(),replyCountExceptLatest:this.model.getReplyCountExceptLatest()+""}},ui:{eachCommentRegion:"._eachCommentRegion",replyRegion:"._replyRegion",openReplyListBtn:"._openReplyListBtn"},attributes:{"data-viewname":"DCommentLayoutView"},regions:{eachCommentRegion:{el:"@ui.eachCommentRegion",replaceElement:!0},replyRegion:{el:"@ui.replyRegion",replaceElement:!0}},behaviors:[l,h],events:{"click @ui.openReplyListBtn":function(){return this.renderReplyList(),d.getDGlobalChannel().trigger(d.EVENT.HTML_CLICK),!1}},initialize:function(e){this._isReplyButTopMost=e.isReplyButTopMost,this._replySupport=e.replySupport,this._canDownloadFile=e.canDownloadFile,this._canOpenMediaViewer=e.canOpenMediaViewer,this._canOpenSnippetUrl=e.canOpenSnippetUrl,this._canExpressEmotion=e.canExpressEmotion,this._isCommentingPermitted=e.isCommentingPermitted,this._mentionOption=e.mentionOption,this._isSimpleReplyListShow=!0,this._bandNo=this.model.getBandNo(),this._replyListView=null,this._generateOnMessages(),this._generateOnPassmessages()},onAttach:function(){this._commentView=s.buildDCommentView(this.options),this.showChildView("eachCommentRegion",this._commentView),this.model.isReplyExist()&&(this._isSimpleReplyListShow?this._renderSimpleList():this.renderReplyList())},renderReplyList:function(e,n){this.model.isRestricted()||(this.ui.openReplyListBtn.remove(),this._isSimpleReplyListShow=!1,r.wrapActivePromise(g,this).then(t.bind((function(){this._replyListView=_.buildDReplyListView({bandNo:this._bandNo,initCommentReplyId:e,ownerContentKey:this.model.getContentKey(),contentKeyButCommentId:this.model.getContentKeyForReply(),openReplyInput:n&&this._isCommentingPermitted,muteIgnoredAuthorUserNo:this.model.getMuteIgnoredAuthorUserNo(),isHiddenFilterIgnored:this.model.isHiddenFilterIgnored(),isCommentingPermitted:this._isCommentingPermitted,showEmotionArea:this.model.canShowEmotionArea(),mentionOption:this._mentionOption}),this.showChildView("replyRegion",this._replyListView)}),this)))},hasModificationCommentReply:function(){return!!this._replyListView&&this._replyListView.hasModificationComment()},cancelChildrenModificationMode:function(){this._replyListView&&this._replyListView.cancelChildrenModificationMode()},highlightForAWhile:function(){this.isDestroyed()||(this.$el.addClass(i.ELEMENT.FOCUS),r.wrapActiveSetTimeout(3e3,this).then(t.bind((function(){this.$el&&this.$el.removeClass&&this.$el.removeClass(i.ELEMENT.FOCUS)}),this)))},hideReplyInputArea:function(){this.isDestroyed()||(this.$el.removeClass(i.ELEMENT.ACTIVE),this._commentView.hideReplyInputArea(),null!=this._replyListView&&this._replyListView.hideEveryReplyInputArea())},openReplyInputIfSameCommentId:function(e){!this.isDestroyed()&&this._commentView&&this._commentView.openReplyInputIfSameCommentId(e)},_generateOnMessages:function(){var e={};e[l.MSG.COMMENT_CHANGE_TO_ACTIVE]=function(){r.wrapDeferPromise(this).then(t.bind((function(){this.$el.addClass(i.ELEMENT.ACTIVE)}),this))},e[l.MSG.COMMENT_HIDE_SELF_REPLY_INPUT]=function(){this.hideReplyInputArea()},e[l.MSG.MESSAGE_INPUT_SUBMIT]=function(e){if(!this._isReplyButTopMost){var n=e.submitData;c.writeComment(this._bandNo,this.model.getContentKey().toApiParams(!0),e.isSecret,n,e.memberType,this).then(t.bind((function(n){d.getCommentChannel().trigger(d.EVENT.BAND_FILE_UPDATED);var i=n.comment.comment_id;null==this._replyListView?this.renderReplyList(i):this._replyListView.fetchAroundComment(i).then(t.bind((function(){this._replyListView.scrollToComment(i)}),this)),this._refreshReplyCount(),this._sendCreateConfirmLog(e)}),this)).always(t.bind((function(){this.$el.removeClass(i.ELEMENT.ACTIVE),this.hideReplyInputArea()}),this))}},this._isReplyButTopMost||(e[l.MSG.COMMENT_AREA_CLICKED]=function(e){this._renderReplyListByMessage(e,!1)},e[l.MSG.COMMENTLIST_OPEN_REPLY_LIST_AND_REPLY_TO]=function(e){this._renderReplyListByMessage(e,!0)},e[l.MSG.COMMENT_CHANGE_TO_MODIFICATION_MODE]=function(){this.hideReplyInputArea()},e[l.MSG.COMMENT_REPLY_DELETED]=function(){this._refreshReplyCount()},e[l.MSG.COMMENT_DELETE_COMMENT]=function(e){e.isReplyExist=this.model.isReplyExist()}),this.onMessages=e},_generateOnPassmessages:function(){var e={};e[l.MSG.COMMENT_CHANGE_TO_ACTIVE]=l.MSG.PROPAGATION_STOP,this._isReplyButTopMost||(e[l.MSG.MESSAGE_INPUT_SUBMIT]=l.MSG.PROPAGATION_STOP,e[l.MSG.COMMENT_REPLY_DELETED]=l.MSG.PROPAGATION_STOP,e[l.MSG.COMMENT_HIDE_SELF_REPLY_INPUT]=l.MSG.PROPAGATION_STOP),this.passMessages=e},_renderSimpleList:function(){t.isEmpty(this.model.getLatestComment())||r.wrapActivePromise(m,this).then(t.bind((function(){if(this._isSimpleReplyListShow){var e=p.buildDSimpleCommentListView({bandCore:this.model.getBandCore(),featuredComments:this.model.getLatestComment(),isReplyButTopMost:!0,isCommentingPermitted:this._isCommentingPermitted,forcedShowEmotionArea:this.model.canShowEmotionArea(),replySupport:this._replySupport,muteIgnoredAuthorUserNo:this.model.getMuteIgnoredAuthorUserNo(),isHiddenFilterIgnored:this.model.isHiddenFilterIgnored(),canDownloadFile:this._canDownloadFile,canOpenMediaViewer:this._canOpenMediaViewer,canOpenSnippetUrl:this._canOpenSnippetUrl,contentKeyButCommentId:this.model.getContentKeyForReply(),canExpressEmotion:this._canExpressEmotion});this.showChildView("replyRegion",e)}}),this))},_renderReplyListByMessage:function(e,t){this._isSimpleReplyListShow&&e.fromReply&&this.renderReplyList(e.commentId,t)},_refreshReplyCount:function(){u.fetchCommentReplyCount(this._bandNo,this.model.getContentKey(),this).then(t.bind((function(e){this.model.setReplyCountSilently(e)}),this))},_sendCreateConfirmLog:function(e){var n=t.extend({band_no:this.model.getBandNo(),is_reply:!0},this.model.getContentKey().makeJackpotParamExceptCommentInfo(),e.jplExtra);this.jplClick(h.CLASSIFIER.COMMENT_CREATE_CONFIRM,n)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(488),a=n(1349),r=n(1350),l=n(1351),c=n(1352),d=n(1119),u=n(638),h=n(26),p=n(82),m=n(155),_=n(159),g=n(589),f=n(169),b=n(154),v=n(559),A=n(888),E=n(522),T=n(510),C=n(590),y=n(1050),M=n(1120),I=n(1253),S=n(1179),w=n(933),N=n(156),D=n(1256),L=n(1379),O=n(1381),P=n(1049),x=n(508),R=n(514),k=n(505),B=n(487),V=n(516),U=n(163),F=n(618),H=n(592),z=n(626),W=n(55),G=n(1124),K=n(493),Y=n(84),j=n(1023),Q=n(562),q=n(166),J=n(17),X=n(1125);n(185),n(1095),n(608);var Z,$=o.View.extend({className:function(){return this.model.isMoreButton()?"moreComment":""},ui:{previousCommentButton:"[data-uiselector=previousCommentButton]",nextCommentButton:"[data-uiselector=nextCommentButton]",authorProfileImage:"._authorProfileImage",audioRegion:"[data-uiselector=audioRegion]",optionButton:"[data-uiselector=optionButton]",showMedia:"._showMedia",goFirstCommentButton:"[data-uiselector=goFirstCommentButton]",modifyButton:"[data-uiselector=modifyButton]",deleteButton:"[data-uiselector=deleteButton]",btnMuteMember:"._btnMuteMember",reportButton:"[data-uiselector=reportButton]",optionMenuLayer:"[data-uiselector=optionMenuLayer]",authorNameButton:"[data-uiselector=authorNameButton]",bandRefer:"[data-uiselector=bandRefer]",showMentionedMemberGroup:"._showMentionedMemberGroup",snippetAnchor:"._snippetAnchor",hideCommentButton:"._hideCommentButton",hideInfoButton:"._hideInfoButton",showButton:"[data-uiselector=showButton]",hiddenInfo:"._hiddenInfo",commentBody:".commentBody",writeInfo:".writeInfo",emotionIconBtn:"._emotionIconBtn",emotionLabelBtn:"._emotionLabelBtn",fileDownload:"._fileDownload",stickerImage:"._stickerImage",contentTranslationRegion:"._contentTranslationRegion",translationOptionMenuBtn:"._translationOptionMenuBtn",translationSettingRegion:"._translationSettingRegion",emoticonSelectViewRegion:"._emoticonSelectViewRegion",emotionCountViewRegion:"._emotionCountViewRegion",settingSave:"._settingSave",attached:"._attached",replyBtn:"._replyBtn",replyInputRegion:"._replyInputRegion",commentContent:"._commentContent",dimArea:"._dimArea",copyCommentUriButton:"._copyCommentUriButton"},attributes:{"data-viewname":"DCommentView"},templateContext:function(){var e=this.model,t=e.getAuthorRealName()||e.getAuthorNickname(),n=!this.model.isRestricted()&&this.model.isSecretAndUnknownToViewer(),i=!this.model.isRestricted()&&!n&&this.model.getContents();return{modificationMode:this.model.isModificationMode(),isMsgAuthorNickName:!!t,msg_authorNickName:function(){return t},isCertifiedAuthor:this.model.isCertifiedAuthor(),msg_emotionLabel:E.getLabel(this.model.getEmotionTypeByViewer()),expiresFileSchedule:this.model.getExpiresFileSchedule(),externalFileSource:this.model.getExternalFileSource(),msg_videoThumbnail:p.make(this.model.getVideoThumbnail(),p.TYPE.w520),isExpiredFile:N.isExpiredFile(this.model.get("expiresAt")),isMessageHidden:this.model.isHiddenComment(),isQuotaStatus:this.model.isFileExist()&&this._isQuotaStatus(),originalShown:this._translatable&&this._translationChannel.isOriginalShown(),canReply:this._replySupport&&!this.model.isHiddenComment()&&!this.model.isRestricted()&&this._isCommentingPermitted,showRestrictStyleContent:this.model.isRestricted(),showSecretStyleContent:n,showDefaultStyleContent:i}},modelEvents:{change:function(){this.render()}},regions:{commentModification:"._commentModification",attached:{el:"@ui.attached",replaceElement:!0},authorProfileImage:{el:"@ui.authorProfileImage",replaceElement:!0},audioRegion:{el:"@ui.audioRegion",replaceElement:!0},showMedia:"@ui.showMedia",emoticonSelectViewRegion:{el:"@ui.emoticonSelectViewRegion",replaceElement:!0},emotionCountViewRegion:{el:"@ui.emotionCountViewRegion",replaceElement:!0},translationSettingRegion:"@ui.translationSettingRegion",contentTranslationRegion:{el:"@ui.contentTranslationRegion",replaceElement:!0},replyInputRegion:"@ui.replyInputRegion"},behaviors:[_,B],events:function(){var e={"click @ui.optionButton":function(){return this.ui.optionMenuLayer.is(":hidden")&&h.getDGlobalChannel().trigger(h.EVENT.HTML_CLICK),this.ui.optionMenuLayer.is(":visible")||this._adjustOptionMenuOffset(),this.ui.optionMenuLayer.toggle(),this.ui.optionButton.toggleClass("menuOn"),!1},"click @ui.showMedia":function(){return this._showMedia(),!1},"click @ui.fileDownload":function(e){if(this.model.isHiddenComment()||!this._canDownloadFile)return!!this.model.isSmallBox()&&void e.preventDefault();var t=this.model.get("dropboxFileLink")||this.model.get("externalFileLink");return t?window.open(t):this._fetchInternalFileDownload(),!1},"click @ui.modifyButton":function(){return C.isContentCreationPunished()||this.spawn(_.MSG.COMMENT_CHECK_COMMENT_MODIFIABLE,this),!1},"click @ui.copyCommentUriButton":function(){var e=J.appendCurrentDomainOnPathUrl(this.model.getContentUrl());return j.openUrlCopyLayerView(e),!1},"click @ui.deleteButton":function(){return this._triggerDeleteComment(),!1},"click @ui.hideCommentButton":function(){return this._hideComment(),!1},"click @ui.showButton":function(){return this._checkAndUnhideComment(),!1},"click ._stickerImage":function(e){this._renderAniSticker(e.currentTarget)},"click @ui.btnMuteMember":function(){T.openLayer({bodyTitle:IM("mute_author.confirm.title"),bodyDesc:IM("mute_author.confirm.desc"),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no"),withoutHiding:!0}).once(T.EVENTS.CONFIRM,t.bind((function(){return K.muteMember(this.model.getAuthorUserNo(),this.model.getBandNo()).then(t.bind((function(){Y.refreshCurrentPage()}),this))}),this))},"click @ui.reportButton":function(){return R.openReportPopupByContentKey(this.model.getBandNo(),this.model.getContentKey()),this.ui.optionMenuLayer.hide(),!1},"click @ui.authorNameButton":function(){return h.getDGlobalChannel().trigger(h.EVENT.HTML_CLICK),this.spawn(_.MSG.COMMENT_SUMMON_AUTHOR,{userNo:this.model.getAuthorUserNo(),userName:this.model.getAuthorName(),isPageProfile:this.model.isAuthorPageProfileMemberType()}),!1},"click @ui.bandRefer":"_openReferUserProfile","click @ui.showMentionedMemberGroup":function(e){if(this.model.canClickMention()){var t=i(e.currentTarget);return X.buildAsyncLayerView(this._bandNo,t.data("member-group-id")),!1}e.preventDefault()},"click @ui.snippetAnchor":function(e){if(this._canOpenSnippetUrl)return window.open(this.model.getSnippetUrl()),!1;e.preventDefault()},"click @ui.hideInfoButton":function(){return this.model.getHasHiddenCommentInfo()&&(this.ui.hiddenInfo.is(":hidden")?(h.getDGlobalChannel().trigger(h.EVENT.HTML_CLICK),this.ui.hiddenInfo.show().removeClass("-down").toggleClass("-down",this._makeHideInfoClass()),this.ui.hideInfoButton.addClass("-active")):(this.ui.hiddenInfo.hide(),this.ui.hideInfoButton.removeClass("-active"))),!1},"click @ui.replyBtn":function(){this._openReplyInputIfPossible()},"click @ui.emotionIconBtn,@ui.emotionLabelBtn":"_toggleEmotionSelectLayer","click @ui.settingSave":"_fileQuotaSettingController","click @ui.translationOptionMenuBtn":"_onClickTranslationOptionMenuBtn","click @ui.dimArea":function(e){this.model.isSmallBox()||T.openLayer({bodyTitle:IM("member.unmute.confirm.title"),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no"),withoutHiding:!0}).once(T.EVENTS.CONFIRM,t.bind((function(){K.unmuteMember(this.model.getAuthorUserNo(),this.model.getBandNo()).then(t.bind((function(){Y.refreshCurrentPage()}),this))}),this))},click:function(e){var t=i(e.target);return!(!this.model.isModificationMode()&&!t.hasClass(f.OUTER_LINK)&&"file"!=t.attr("type"))||(this.spawn(_.MSG.COMMENT_AREA_CLICKED,this.generateViewIdentifiableData()),h.getDGlobalChannel().trigger(h.EVENT.HTML_CLICK),!1)}};return e["click ."+u.EMOTION_COUNT_VIEW_CLASS]=function(){return this._fetchBandData().then(t.bind((function(e){e.canShowEmotionList()||(this.spawn(_.MSG.COMMENT_AREA_CLICKED,this.generateViewIdentifiableData()),h.getDGlobalChannel().trigger(h.EVENT.HTML_CLICK))}),this)),!1},this.options.canUsePaging&&t.extend(e,{"click @ui.previousCommentButton":function(){return this.spawn(_.MSG.COMMENT_PREVIOUS_MORE),!1},"click @ui.goFirstCommentButton":function(){return this.spawn(_.MSG.COMMENT_GO_FIRST_COMMENT),!1},"click @ui.nextCommentButton":function(){return this.spawn(_.MSG.COMMENT_NEXT_MORE),!1}}),e},onMessages:(Z={},Z[_.MSG.AUDIOPLAYER_FILE_URL_REQUIRED]=function(e){this._fetchAudioFileUrlAndPlay(e)},Z[_.MSG.COMMENT_CANCEL_MODIFICATION]=function(){this._scrollCommentInScreen(),this.model.setModificationMode(!1)},Z[_.MSG.COMMENT_SUBMIT_MODIFICATION]=function(){this._aniStickerRendered=!1},Z[_.MSG.COMMENT_OPEN_MEDIA_VIEWER]=function(e){this._showPhoto(e)},Z),childViewEvents:{showMedia:function(){this._showMedia()},"DEmotionCountView:clickView":"_showEmotionListLayer","DEmotionSelectView:changeEmotion":function(e){this._closeEmotionSelectLayer(),this.model.set(e)}},getTemplate:function(){return this.model.isPreviousButton()?t.template(r):this.model.isNextButton()?t.template(l):t.template(a)},initialize:function(e){this._overMaxLengthAlertMessage=e.overMaxLengthAlertMessage,this._maxMessageLength=e.maxMessageLength,this._flexibleTooltipPositionSupport=e.flexibleTooltipPositionSupport,this._isCommentingPermitted=e.isCommentingPermitted,this._replySupport=e.replySupport,this._messageSubmitKeyType=e.messageSubmitKeyType||v.NONE,this._isReplyButTopMost=1==e.isReplyButTopMost,this._bandNo=this.model.getBandNo(),this._canUsePaging=e.canUsePaging,this._canExpressEmotion=e.canExpressEmotion,this._canOpenMediaViewer=e.canOpenMediaViewer,this._canDownloadFile=e.canDownloadFile,this._canOpenSnippetUrl=e.canOpenSnippetUrl,this._mentionOption=e.mentionOption,this._initTranslationChannel()},onRender:function(){this.model.isMoreButton()||this.showChildView("authorProfileImage",F.buildContentCreatorProfileImageView({memberProfile:this.model.getAuthorMemberProfile(),userNoOrMemberKey:this.model.getAuthorUserNo(),bandCore:this.model.getBandCore(),role:this.model.get("authorRole").name,size:this._isReplyButTopMost?21:34}))},onDomRefresh:function(){if(this.spawn(_.MSG.COMMENT_HIDE_SELF_REPLY_INPUT),this.model.isModificationMode())return this.showChildView("commentModification",c.buildDCommentModificationView(this.model,{flexibleTooltipPositionSupport:this._flexibleTooltipPositionSupport,overMaxLengthAlertMessage:this._overMaxLengthAlertMessage,maxMessageLength:this._maxMessageLength,messageSubmitKeyType:this._messageSubmitKeyType,mentionOption:this._mentionOption})),void this._scrollCommentInScreen();if(this.model.isPhotoExist())if(this.model.isMultiplePhotoAttached())this.showChildView("attached",L.buildDCommentAttachedMultiplePhotoView(this.model.getPhotos()));else{var e=this.$el.width()>400?"wide":"narrow";this.showChildView("attached",D.buildDCommentAttachedPhotoView(this.model.getFirstPhotoUrl(),this.model.getFirstPhotoWidth(),this.model.getFirstPhotoHeight(),this.model.isFirstPhotoGif(),e))}this._canUsePaging||(this.ui.previousCommentButton.addClass("-disabled"),this.ui.goFirstCommentButton.addClass("-disabled")),this.$el.toggleClass("-commentHidden",this.model.isHiddenComment()),this._isCommentingPermitted||(this.ui.writeInfo.addClass("gCursorDefault"),this.ui.commentBody.addClass("gCursorDefault")),this.model.isMoreButton()||(this.model.canClickMention()||(this.ui.bandRefer.addClass("gCursorDefault"),this.ui.showMentionedMemberGroup.addClass("gCursorDefault")),this.model.isAudioExist()&&(this._audioPlayerView=d.buildDAudioPlayerView(this.model.getAudioDuration(),this.model.isHiddenComment()),this.getRegion("audioRegion").show(this._audioPlayerView)),this.model.isVideoExist()&&this.spawn(_.MSG.VIDEO_AUTO_PLAY,this),this._canShowEmotionCountView()&&this._fetchBandData().then(t.bind((function(e){this.getRegion("emotionCountViewRegion").show(A.buildCommentEmotionCountView(this.model.getCommonEmotionType(),this.model.getEmotionCount(),this.model.getEmotionTypeByViewer(),e.canShowEmotionList()))}),this)),this._renderAniStickerOnDomRefresh(),this.model.isSmallBox()&&!this._isReplyButTopMost&&(this._dotdotdotContent=this.ui.commentContent.dotdotdot({ellipsis:"...",after:i('<button type="button" class="btnMore">'+IM("ui.label.more.long")+"</button>"),wrap:"letter",height:39,noSpaceWrapBr:!0})),this._showTranslation())},onAttach:function(){this.listenTo(h.getDGlobalChannel(),h.EVENT.HTML_CLICK,(function(){this.ui.optionMenuLayer.hide(),this.ui.hiddenInfo.hide(),this.ui.hideInfoButton.removeClass("-active"),this._closeEmotionSelectLayer()}))},onBeforeDetach:function(){this._dotdotdotContent&&(this._dotdotdotContent.trigger("destroy.dot"),this._dotdotdotContent=null),this._apngSticker&&(this._apngSticker.stop(),this._apngSticker=null)},processNoplayVideo:function(){this.showChildView("attached",O.buildDCommentAttachedVideoView(this.model,{getVideoUrl:t.noop,noplay:!0,areaWidth:254})),this.listenTo(this.getChildView("attached"),"videoPlayer:openMediaViewer",this.showVideo)},processAutoPlay:function(){this.showChildView("attached",O.buildDCommentAttachedVideoView(this.model,{getVideoUrl:t.bind((function(){return this._getVideoUrl()}),this)})),this.listenTo(this.getChildView("attached"),"videoPlayer:openMediaViewer",this.showVideo),this.listenTo(this.getChildView("attached"),"videoPlayer:play",(function(e,n){this.jplOccur(B.CLASSIFIER.VIDEO_PLAY_START,t.extend({band_no:this._bandNo,comment_no:this.model.getCommentId(),is_auto:n.isAutoPlayed,type:"uploaded",video_url:e.model.get("source"),total_duration_ms:1e3*n.duration,start_position_ms:1e3*n.currentTime},this.model.getContentKey().makeJackpotParamExceptCommentInfo()))})),this.listenTo(this.getChildView("attached"),"videoPlayer:pause",(function(e,n){this.jplOccur(B.CLASSIFIER.VIDEO_PLAY_STOP,t.extend({band_no:this._bandNo,comment_no:this.model.getCommentId(),is_auto:n.isAutoPlayed,type:"uploaded",video_url:e.model.get("source"),total_duration_ms:1e3*n.duration,stop_position_ms:1e3*n.currentTime},this.model.getContentKey().makeJackpotParamExceptCommentInfo()))}))},processCommentModify:function(){this.spawn(_.MSG.COMMENT_CHANGE_TO_MODIFICATION_MODE),this.model.setModificationMode(!0)},processReplyInputOpen:function(){this._replyInputProgress=!0,this._fetchBandData().then(t.bind((function(e){this.spawn(_.MSG.COMMENT_REPLY_INPUT_OPEN),this.spawn(_.MSG.COMMENT_CHANGE_TO_ACTIVE),this._replyInputView=P.buildDCommentInputView({messageLabel:IM("comment.write_reply_placeholder"),textareaPlaceHolder:IM("comment.write_reply_placeholder"),buttonLabel:IM("ui.label.send"),maxMessageLength:x.MAX_LENGTH,overMaxLengthAlertMessage:IM("comment.over_max_message",{count:x.MAX_LENGTH}),bandNo:this.model.getBandNo(),standByMessage:IM("ui.label.sending"),currentProfileMemberType:e.getCurrentSelectedMemberProfileMemberTypeAtComment(),memberProfileArray:e.getSelectableMemberProfilesAtComment(),initSecretMode:this.model.isSecret(),secretCommentStorageKey:q.SecretCommentReplyUseGuide,mentionOption:this._mentionOption}),this.showChildView("replyInputRegion",this._replyInputView),this._replyInputView.focusMessageTextArea(),this._adjustScrollToShowFullContent(),this._canMentionAuthorOnReply(e)&&this._replyInputView.appendMention(this.model.getAuthorUserNo(),this.model.getAuthorName(),this.model.isAuthorPageProfileMemberType()),this.jplClick(B.CLASSIFIER.COMMENT_REPLY,t.extend({band_no:this.model.getBandNo(),is_preview:e.isPreviewForJplExtra()},this.model.getContentKey().makeJackpotParamExceptCommentInfo()))}),this)).always(t.bind((function(){this._replyInputProgress=!1}),this))},showVideo:function(){var e={bandNo:this._bandNo,contentKey:this.model.getContentKey(),view:this,resultData:{photos:[{photo_url:this.model.getVideoThumbnail(),author:{user_no:this.model.getAuthorUserNo(),name:this.model.getAuthorName()},width:this.model.getVideoWidth(),height:this.model.getVideoHeight(),video:{videoId:this.model.getVideoId(),expires_at:this.model.getVideoExpiresAt(),is_gif:this.model.isGifVideo()}}],total_count:1},photo:!1,video:!0};S.openDCommentMediaViewer(e)},showEmotionSelectView:function(e){this.showChildView("emoticonSelectViewRegion",e),this.ui.emotionLabelBtn.addClass("-hover")},hideReplyInputArea:function(){if(!this.isDestroyed()){var e=this.getRegion("replyInputRegion");e&&(e.empty(),this._replyInputView=null)}},generateViewIdentifiableData:function(){return{fromReply:this._isReplyButTopMost,commentId:this.model.getCommentId(),originCommentId:this.model.getOriginCommentId()}},openReplyInputIfSameCommentId:function(e){this.isDestroyed()||this.model.getCommentId()!=e||this._openReplyInputIfPossible()},_scrollCommentInScreen:function(){this._stopListenHeightDetectors(),this._$scrollParent||(this._$scrollParent=this.$el.scrollParent()),this._adjustScrollToShowFullContent(),this._heightDetectorForComment=new H,this.listenTo(this._heightDetectorForComment,H.EVENT.HEIGHT_CHANGED,this._adjustScrollToShowFullContent);var e=i(this.$el.parents("."+f.HEIGHT_DETECT_AREA_FOR_COMMENT)[0]);this._heightDetectorForComment.startDetecting(e,200,6),this._documentHeightDetector=new H,this.listenTo(this._documentHeightDetector,H.EVENT.HEIGHT_CHANGED,this._adjustScrollToShowFullContent),this._documentHeightDetector.startDetecting(document,200,6)},_stopListenHeightDetectors:function(){this._heightDetectorForComment&&this.stopListening(this._heightDetectorForComment),this._documentHeightDetector&&this.stopListening(this._documentHeightDetector)},_adjustScrollToShowFullContent:function(){if(this.$el&&!this.isDestroyed()){var e,t,n=this.$el.offset().top,i=this.$el.outerHeight(),o=this.$el.scrollParent(),s=0;if(z.isElementDocument(o)){if(e=W.getHeight(),n-(t=o.scrollTop())<=e-i)return;o.scrollTop(n-(e-i))}else{if(e=o.outerHeight(),s=o.offset().top,t=o.scrollTop()-s,n-s<=e-i)return;o.scrollTop(t+n-(e-i))}}},_adjustOptionMenuOffset:function(){var e,t,n=this.ui.optionButton.offset().top,i=this.ui.optionButton.scrollParent();z.isElementDocument(i)?(t=i.scrollTop(),e=W.getHeight()):(t=i.offset().top,e=i.height());var o=n-t-e+230>0;this.ui.optionMenuLayer.toggleClass(s.ELEMENT.UP,o)},_isQuotaStatus:function(){return w.canSetFileIntoQuota(this._bandNo,this.model.get("expiresAt"),this.model.get("fileSize"))},_openReferUserProfile:function(e){var t=i(e.currentTarget);return g.openMemberProfileLayer(new U({name:t.text(),profileImageUrl:null,memberType:"membership"}),t.data("no"),this._bandNo),!1},_makeHideInfoClass:function(){return!!this._flexibleTooltipPositionSupport&&this.ui.hiddenInfo.offset().top<this.ui.hiddenInfo.scrollParent().offset().top},_triggerDeleteComment:function(){this.spawn(_.MSG.COMMENT_DELETE_COMMENT,{contentKey:this.model.getContentKey()})},_fetchInternalFileDownload:function(){k.getCommentFileUrl(this._bandNo,this.model.getContentKey().toApiParams(!0)).then((function(e){location.href=e.file_url}))},_showMedia:function(){!this.model.isHiddenComment()&&this._canOpenMediaViewer&&(this.model.isPhotoExist()?this._showPhoto():this.model.isVideoExist()&&this.spawn(_.MSG.COMMENT_SHOW_VIDEO_CLICK,{view:this,gifVideo:this.model.isGifVideo()}))},_showPhoto:function(e){var n=t.map(this.model.getPhotos(),(function(e){return{photo_url:e.url,author:{user_no:this.model.getAuthorUserNo(),name:this.model.getAuthorName()},width:e.width,height:e.height}}),this),i={bandNo:this._bandNo,contentKey:this.model.getContentKey(),view:this,resultData:{photos:n,total_count:this.model.getPhotoCount()},photo:!0,video:!1,openIndex:e||0};S.openDCommentMediaViewer(i)},_getVideoUrl:function(){return b.wrapActivePromise(V.getVideoUrlByComment(this._bandNo,this.model.getContentKey().toApiParams(!0)),this).then((function(e){return e}))},_canShowEmotionCountView:function(){return!!this.model.canShowEmotionArea()&&(!this.model.isHiddenComment()&&(!!this.model.isEmotionExist()&&!this.model.isRestricted()))},_showEmotionListLayer:function(){var e=this.model;this._fetchBandData().then(t.bind((function(t){t.canShowEmotionList()&&this.spawn(_.MSG.EMOTIONLIST_LAYER_OPEN,{commentId:e.getCommentId(),originCommentId:this.model.getOriginCommentId()})}),this))},_toggleEmotionSelectLayer:function(){if(this._fetchBandData().then(t.bind((function(e){this.jplClick(B.CLASSIFIER.COMMENT_EMOTION,t.extend({band_no:this.model.getBandNo(),is_preview:e.isPreviewForJplExtra()},this.model.getContentKey().makeJackpotParamExceptCommentInfo()))}),this)),this._canExpressEmotion&&!this.model.isHiddenComment()){if(!this.model.isSecretAndUnknownToViewer()){if(this.getRegion("emoticonSelectViewRegion").hasView())return h.getDGlobalChannel().trigger(h.EVENT.HTML_CLICK),!1;var e={commentId:this.model.getCommentId(),emotionTypeByViewer:this.model.getEmotionTypeByViewer(),view:this};return this._isReplyButTopMost&&(e.originCommentId=this.model.getOriginCommentId()),t.defer(t.bind((function(){this.spawn(_.MSG.EMOTION_SELECT_LAYER_OPEN,e)}),this)),!1}Q.openLayer({bodyTitle:IM("comment.secret_comment_emotion_impossible_description"),withoutHiding:!0})}},_closeEmotionSelectLayer:function(){var e=this.getRegion("emoticonSelectViewRegion");e.hasView()&&(e.empty(),this.ui.emotionLabelBtn.removeClass("-hover"))},_fileQuotaSettingController:function(e){e.stopPropagation();var n=w.startSettingFileIntoQuota({bandNo:this._bandNo,fileId:this.model.getFileId(),withoutHiding:!0});b.wrapActivePromise(n,this).then(t.bind((function(){this.model.set("expiresAt",null),this.render()}),this))},_initTranslationChannel:function(){this._translationChannel=this.model.getTranslationChannel(),this._translatable=this.model.isTranslatable(),this.listenTo(this._translationChannel,y.EVENT.SEE_TRANSLATION,(function(e){this._translationChannel.translateComment(this._bandNo,this.model.getContentKey().toApiParams(!0),e.targetLanguage,e.sourceLanguage)})),this.listenTo(this._translationChannel,y.EVENT.TRANSLATION_END,(function(e){var t=e.content;t&&this.model.setTranslatedContent(t)}))},_onClickTranslationOptionMenuBtn:function(e){e.preventDefault(),this._translationChannel.isOriginalShown()?this._translationChannel.isTranslatableImmediately()?this._translationChannel.seeTranslation():this.showChildView("translationSettingRegion",M.build({translationChannel:this._translationChannel})):this._translationChannel.seeOriginal()},_showTranslation:function(){this._translatable&&this.showChildView("contentTranslationRegion",I.build({translationChannel:this._translationChannel}))},_fetchAudioFileUrlAndPlay:function(e){b.wrapActivePromise(k.getCommentAudioUrl(this._bandNo,this.model.getContentKey().toApiParams(!0)),this).then(t.bind((function(t){e.playerView.loadAudioFile(t.audio_url)}),this))},_hideComment:function(){this.model.isReplyExist()&&!confirm(IM("comment.hide_confirm_message"))||b.wrapActivePromise(k.hideCommentFromOthers(this._bandNo,this.model.getContentKey().toApiParams(!0)),this).then(t.bind((function(){this.model.fetchAndRefresh(this._bandNo)}),this))},_checkAndUnhideComment:function(){if(this.model.getReplyCount()<=0)this._unhideComment();else{var e=G.getHidableCommentReplyLimitPromise();b.wrapActivePromise(e,this).then(t.bind((function(e){(null==e||this.model.getReplyCount()<=e||confirm(IM("comment.unhide_cofirm_message",{count:e+""})))&&this._unhideComment()}),this))}},_unhideComment:function(){b.wrapActivePromise(k.showCommentFromOthers(this._bandNo,this.model.getContentKey().toApiParams(!0)),this).then(t.bind((function(){this.model.fetchAndRefresh(this._bandNo)}),this),(function(){h.getDGlobalChannel().trigger(h.EVENT.HTML_CLICK)}))},_canMentionAuthorOnReply:function(e){return e.canMentionOnCommentReplyByClick(this.model.getAuthorUserNo(),this.model.getAuthorMemberType())},_fetchBandData:function(){var e=m.get(this.model.getBandNo());return b.wrapActivePromise(e.loadBandData(),this).then(t.bind((function(){return e}),this))},_renderAniStickerOnDomRefresh:function(){this.model.isStickerExist()&&(this._apngSticker=null,this._aniStickerRendered||this._renderAniSticker(this.ui.stickerImage[0]))},_renderAniSticker:function(e){if(this.model.isAniSticker()){if(this._aniStickerRendered=!0,this._apngSticker){if(this._apngSticker.isPlayed()&&!this._apngSticker.isFinished())return;return this._apngSticker.rewind(),void this._apngSticker.play()}b.wrapActivePromise(APNG.animateImage(e,this.model.getConvertedStickerWidth(),this.model.getStickerImageWidth(),this.model.getConvertedStickerHeight(),this.model.getStickerImageHeight()),this).then(t.bind((function(e){this._apngSticker=e}),this))}},_openReplyInputIfPossible:function(){this._replyInputView||this._replyInputProgress||this.model.isRestricted()||!this._isCommentingPermitted||this.spawn(_.MSG.COMMENT_CHECK_REPLY_INPUT_OPENABLE,this)}});return $.buildDCommentView=function(e){return new $(e)},$}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<h1 class="gSrOnly"><%- IM("web.postlist.comment.title") %></h1>\n<div class="itemWrap">\n    <div class="_dimArea <%= isMutedComment ? \'gDimmed\' : \'\' %>"></div>\n    <div class="writeInfo <% if (modificationMode) { %>-modify<% } %>">\n        <span class="_authorProfileImage"></span>\n        <button type="button" class="nameWrap <% if(isMsgAuthorNickName) { %>-manager<% } %>" data-uiselector="authorNameButton">\n            <strong class="name"><% if (isCertifiedAuthor) { %><span class="uOfficialBand -sizeS"><%= IM(\'ui.label.official_page_band\') %></span><% } %><%- authorName %></strong>\n            <% if (isMsgAuthorNickName) { %>\n            <span class="nickname"><%- msg_authorNickName() %></span>\n            <% } %>\n        </button>\n        <% if (modificationMode) { %>\n        <span class="time" title="<%- longRelativeAddTime %>"><%- shortRelativeAddTime %></span>\n        <% } %>\n<%\nif ( isSecretKnownToViewer ) {\n%>\n        <span class="iconSecret"><span class="gSrOnly"><%- IM(\'secret_comment\') %></span></span>\n<%\n}\n%>\n    </div>\n    <div class="commentBody _commentModification">\n\n<%\nif (showRestrictStyleContent) {\n%>\n        <div class="blindGuideBox">\n            <p class="blindGuideText gFs13 gFw5 gColorGr2"><%= contents %></p>\n        </div>\n<%\n}\n\nif ( showSecretStyleContent ) {\n%>\n        <div class="secretGuideBox">\n            <p class="secretGuideText gFs13 gFw5 gColorGr5"><%= contents %></p>\n        </div>\n<%\n}\n\nif ( showDefaultStyleContent ) {\n%>\n        <p class="txt _commentContent"><%= contents %></p>\n        <div class="_contentTranslationRegion"></div>\n<%\n}\n\nif ( isStickerExist ) {\n%>\n        <div class="sticker _apngParent">\n            <img src="<%- stickerImageUrl %>" class="_prevent_context _stickerImage" data-apng-url="<%- aniStickerImageUrl %>"  alt="" style="width:<%- convertedStickerWidth %>px;height:<%- convertedStickerHeight %>px" >\n        </div>\n<%\n} else if ( isPhotoExist ) {\n%>\n        <div class="_attached"></div>\n<%\n} else if ( isVideoExist ) {\n%>\n        <div class="_attached"></div>\n<%\n} else if ( isFileExist ) {\n%>\n        <div class="uWidget" data-widget="expanded">\n            <div class="item -file <%- isExpiredFile ? \'-disabled\' : \'\' %>">\n                <div class="addHead -downloadL <%- isExpiredFile ? \'\' : \'_fileDownload\' %>">\n                    <p class="addTitle"><%- fileName %></p>\n                    <div class="addInfo">\n                        <span class="addInfoVolume"><%= fileSiUnit %></span>\n                        <% if (!!expiresFileSchedule) { %>\n                        <span class="addInfoSaveInfo"><%= expiresFileSchedule %></span>\n                        <% if (isQuotaStatus ) { %><span class="addInfoSetting"><button type="button" class="buttonSetting _settingSave"><%= IM(\'web.postdetail.attachfile.settingSave\') %></button></span><% } %>\n                        <% } %>\n\n                    </div>\n                </div>\n            </div>\n        </div>\n<%\n} else if ( isDropboxFileExist ) {\n%>\n        <div class="uWidget" data-widget="expanded">\n            <div class="item -file">\n                <div class="addHead -downloadL _fileDownload">\n                    <p class="addTitle"><%- dropboxFileName %></p>\n                    <div class="addInfo">\n                        <span class="addInfoVolume"><%= dropboxFileSize %></span>\n                        <span class="addInfoSaveInfo">Dropbox</span>\n                        <% if (!!expiresFileSchedule) { %>\n                        <span class="addInfoSaveInfo"><%= expiresFileSchedule %></span>\n                        <% } %>\n                    </div>\n                </div>\n            </div>\n        </div>\n<%\n} else if ( isExternalFileExist ) {\n%>\n        <div class="uWidget" data-widget="expanded">\n            <div class="item -file">\n                <div class="addHead -downloadL _fileDownload">\n                    <p class="addTitle"><%- externalFileName %></p>\n                    <div class="addInfo">\n                        <span class="addInfoVolume"><%= externalFileSize %></span>\n                        <span class="addInfoSaveInfo"><%- externalFileSource %></span>\n                        <% if (!!expiresFileSchedule) { %>\n                        <span class="addInfoSaveInfo"><%= expiresFileSchedule %></span>\n                        <% } %>\n\n                    </div>\n                </div>\n            </div>\n        </div>\n<%\n} else if ( isSnippetExist ) {\n%>\n            <div class="uWidget">\n                <a href="<%- snippetUrl %>" target="_blank" class="snippet _snippetAnchor" data-thumbnail="<%= snippetImage ? \'type4\' : \'false\' %>">\n                    <% if (snippetImage) { %>\n                    <span class="snippetThumb<%= snippetType === \'video\' ? \' player\' : \'\' %>">\n                        <img src="<%- snippetImage %>" alt="<%- snippetTitle %>" class="thumb">\n                    </span>\n                    <% } %>\n                    <span class="snippetInfo">\n                        <span class="snippetTit"><%- snippetTitle %></span>\n                        <span class="snippetTxt"><%- snippetDescription %></span>\n                        <span class="snippetLink"><%- snippetDomain %></span>\n                    </span>\n                </a>\n            </div>\n<%\n}\n%>\n            <div data-uiselector="audioRegion"></div>\n\n        <div class="func">\n            <time class="time" title="<%- longRelativeAddTime %>"><%- shortRelativeAddTime %></time>\n<%\nif ( showEmotionArea ) {\n    if ( isMessageHidden ) {\n        if ( hasHiddenCommentInfo ) {\n%>\n            <div class="hideInfoArea">\n                <button type="button" class="hideText _hideInfoButton"><%- IM("web.commentdetail.comment.hidden_info") %></button>\n\n                <div class="hiddenInfo _hiddenInfo" style="display:none">\n                    <strong class="name"><%- punishTitle %></strong>\n                    <p class="desc"><%= IM("web.commentdetail.comment.hiddeninfo.desc", {punishedAt : punishedAt}) %></p>\n                </div>\n            </div>\n<%\n        }\n    } else if (!isRestricted) {\n        if (emotionCount === 0) {\n%>\n            \x3c!-- 스마일 아이콘 버튼 --\x3e\n            <button type="button" class="likeCount _emotionIconBtn"><%= IM(\'web.emotion.selectface.btn\') %></button>\n<%\n        } else {\n%>\n            \x3c!--  표정 카운트 뷰 region --\x3e\n            <div class="_emotionCountViewRegion"></div>\n<%\n        }\n%>\n            <div class="emotionSection">\n                \x3c!-- 표정 선택 레이어 열렸을 때 -hover 클래스 추가 --\x3e\n                <button type="button" class="likeText<%= msg_emotionLabel ? \' -active\' : \'\' %> _emotionLabelBtn"><%= msg_emotionLabel ? msg_emotionLabel : IM(\'web.emotion.selectface.btn\') %></button>\n                \x3c!-- 표정 선택 레이어 뷰 region --\x3e\n                <div class="_emoticonSelectViewRegion"></div>\n            </div>\n<%\n    }\n}\n\nif ( canReply ) {\n%>\n            <button type="button" class="reply _replyBtn" ><%- IM(\'comment.write_reply\') %></button>\n<%\n}\n%>\n        </div>\n    </div>\n</div>\n\n<div class="cCommentWrite _replyInputRegion replyCommentWrite"></div>\n\n<div class="feedback">\n<%\nif (modificationMode) {\n%>\n    <button type="button" class="commentEdit gIcon icon-more" data-uiselector="optionButton"><%= IM(\'comment.modify_comment\') %></button>\n    <div class="lyMenu" style="min-width:145px;display:none;" data-uiselector="optionMenuLayer">\n        <ul>\n            <li><a href="#" data-uiselector="deleteButton"><%= IM(\'comment.delete_comment\') %></a></li>\n        </ul>\n    </div>\n<%\n} else {\n    if ( showOptionButton ) {\n%>\n    <button type="button" class="commentEdit" data-uiselector="optionButton"><span class="gSrOnly"><%= IM(\'comment.modify_comment\') %></span></button>\n    <div class="lyMenu" style="min-width:145px;display:none;" data-uiselector="optionMenuLayer">\n        <ul>\n<%\n        if ( isModifiable ) {\n%>\n            <li><a href="#" data-uiselector="modifyButton"><%= IM(\'comment.modify_comment\') %></a></li>\n<%\n        }\n\n        if ( isContentUrlExist ) {\n%>\n            <li><a href="#" class="_copyCommentUriButton"><%= IM(\'ui.label.copy_url\') %></a></li>\n<%\n        }\n\n        if (isPossibleToHide && !isVisibleOnlyToAuthor) {\n%>\n            <li><a href="#" class="_hideCommentButton"><%= IM(\'web.postdetail.comment.btn.hide_comment\') %></a></li>\n<%\n        }\n\n        if ( isPossibleToRecover && isVisibleOnlyToAuthor ) {\n%>\n            <li><a href="#" data-uiselector="showButton"><%= IM(\'web.postdetail.comment.btn.show_comment\') %></a></li>\n<%\n        }\n\n        if ( isMuteMemberAvailable ) {\n%>\n            <li><a href="#" class="_btnMuteMember"><%= IM(\'comment.menu.mute_author\') %></a></li>\n<%\n        }\n\n        if ( isPossibleToReport ) {\n%>\n            <li><a href="#" data-uiselector="reportButton"><%= IM(\'ui.label.report\') %></a></li>\n<%\n        }\n\n        if ( contentsDeletionPermitted ) {\n%>\n            <li><a href="#" data-uiselector="deleteButton"><%= IM(\'comment.delete_comment\') %></a></li>\n<%\n        }\n\n        if ( translatable ) {\n%>\n            <li><a href="#" class="_translationOptionMenuBtn"><%- originalShown ? IM(\'ui.label.see_translation\') : IM(\'ui.label.view_original\') %></a></li>\n<%\n        }\n%>\n        </ul>\n    </div>\n<%\n    }\n}\n%>\n\n    <div class="translationBox _translationSettingRegion"></div>\n</div>\n'},function(e,t){e.exports='<button type="button" class="prevComment" data-uiselector="previousCommentButton">\n<% if ( isReply ) { %>\n    <%- IM(\'comment.previous_comment_reply\') %>\n<% } else { %>\n    <%- IM(\'comment.fetch_previous_comment\') %>\n<% } %>\n</button>\n<button type="button" class="goFirstComment" data-uiselector="goFirstCommentButton">\n<% if ( isReply ) { %>\n    <%- IM(\'comment.show_first_comment_reply\') %>\n<% } else { %>\n    <%- IM(\'comment.go_first_comment\') %>\n<% } %>\n</button>'},function(e,t){e.exports='<button type="button" class="moreView" data-uiselector="nextCommentButton">\n<% if ( isReply ) { %>\n    <%- IM(\'comment.next_comment_reply\') %>\n<% } else { %>\n    <%- IM(\'comment.fetch_next_comment\') %>\n<% } %>\n</button>\n\n\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(1353),a=n(934),r=n(600),l=n(507),c=n(537),d=n(582),u=n(159),h=n(82),p=n(559),m=n(1093),_=n(1059),g=n(555),f=n(508),b=n(552),v=n(487),A=n(154),E=n(491),T=n(498),C=n(499),y=n(488),M=n(562),I=n(1149),S=n(1118),w=n(166);n(502);var N,D="_prevent_context",L="commentPhoto",O="commentSticker",P="-commentMedia -photo",x="-commentMedia -video",R="-commentMedia -commentFile",k="-commentMedia -commentSticker",B="-commentMedia -gif",V=o.View.extend({options:{flexibleTooltipPositionSupport:!1,overMaxLengthAlertMessage:"",maxMessageLength:f.MAX_LENGTH,messageSubmitKeyType:p.NONE},behaviors:[u,v],tagName:"FORM",className:"commentModify",attributes:{"data-viewname":"DCommentModificationView"},getTemplate:function(){return this._dataFetched?t.template(s):t.template(T)},templateContext:function(){return this._dataFetched?{modificationImageUrl:t.find([this.model.getStickerImageUrl(),h.make(this.model.getVideoThumbnail(),h.TYPE.s276)],(function(e){return null!=e})),showSecretButton:this._bandData.canUseSecretComment()||this.model.isSecret()}:{_loading_size:C.Size.MEDIUM,middleClass:y.ELEMENT.SCREEN_VERTICAL_MIDDLE}},ui:{attachedInfoArea:"._attachedInfoArea",singleAttachArea:"._singleAttachArea",attachInputDiv:"._attachInputDiv",cancelAttachInfoButton:"._cancelAttachInfoButton",cancelModificationButton:"._cancelModificationButton",stickerSelectRegion:"._stickerSelectRegion",modificationTextarea:"._modificationTextarea",textareaWrap:"._textareaWrap",mentionListParent:"._mentionListParent",stickerInputButton:"._stickerInputButton",submitButton:"._submitButton",commentImageUploadArea:"._commentImageUploadArea",commentFileUploadArea:"._commentFileUploadArea",commentImageInput:"._commentImageInput",commentFileInput:"._commentFileInput",previewImage:"._previewImage",previewFile:"._previewFile",secretModeButton:"._secretModeButton",emptyAttachSecretButton:"._emptyAttachSecretButton",attachedSecretButton:"._attachedSecretButton",photoArea:"._photoArea",photoInputArea:"._photoInputArea",photoList:"._photoList"},events:function(){var e={};return e["click @ui.photoList "+b.INPUT_PHOTO_DELETE_BUTTON_SELECTOR]=function(e){var t=i(e.currentTarget).data(b.INPUT_PHOTO_DATA_KEY);return this._commentInputData.removePhotoInfoByUrl(t),this.ui.photoList.find(b.INPUT_PHOTO_SELECTOR).filter((function(e,n){return i(n).data(b.INPUT_PHOTO_DATA_KEY)==t})).remove(),this.ui.photoInputArea.toggle(!this._commentInputData.isMaxPhotoCount()),this.ui.photoArea.toggle(this._commentInputData.isPhotoExist()),this.ui.attachInputDiv.toggle(!this._commentInputData.isPhotoExist()),this.ui.textareaWrap.toggleClass("-attached",this._commentInputData.isPhotoExist()),this._determineSaveBtnActivation(),!1},t.extend(e,{"click @ui.cancelAttachInfoButton":function(){return this._commentInputData.resetCommentInput(),this._showMediaAndStickerInput(),this._determineSaveBtnActivation(),!1},"click @ui.stickerInputButton":function(){return this._toggleStickerSelectRegion(),!1},"click @ui.submitButton":function(){return this._submitModification(),!1},"cut @ui.modificationTextarea":function(){this._deferedDetermineSaveBtnActivation()},"paste @ui.modificationTextarea":function(){this._fnDebouncedCheckIfValidLengh(),this._deferedDetermineSaveBtnActivation()},"input @ui.modificationTextarea":function(){this._deferedDetermineSaveBtnActivation()},"keyup @ui.modificationTextarea":function(){this._fnDebouncedCheckIfValidLengh(),this._deferedDetermineSaveBtnActivation()},"keydown @ui.modificationTextarea":function(e){if(e.keyCode!=g.ENTER)return!0;switch(this._messageSubmitKeyType){case p.ENTER:return!!e.shiftKey||(this._submitModification(),!1);case p.SHIFT_ENTER:if(e.shiftKey)return this._submitModification(),!1;break;case p.CONTROL_ENTER:if(e.shiftKey)return!0;if(e.ctrlKey||e.metaKey)return this._submitModification(),!1}return!0},"focus @ui.modificationTextarea":function(){this.ui.textareaWrap.addClass("-focus"),this.spawn(u.MSG.MESSAGE_INPUT_TEXTAREA_FOCUS,this)},"blur @ui.modificationTextarea":function(){this.ui.textareaWrap.removeClass("-focus")},"click @ui.commentFileInput":function(){this._closeStickerSelectRegion()},"click @ui.cancelModificationButton":function(){this.spawn(u.MSG.COMMENT_CANCEL_MODIFICATION)},"click @ui.secretModeButton":function(){if(!this._secretMode)return I.alertDSecretCommentUseGuide(this.model.isReply()?w.SecretCommentReplyUseGuide:w.SecretCommentUseGuide),this._secretMode=!0,void this.ui.secretModeButton.addClass(y.ELEMENT.ACTIVE);this._secretMode=!1,this.ui.secretModeButton.removeClass(y.ELEMENT.ACTIVE),this._bandData.canUseSecretComment()||M.openLayer({bodyTitle:IM("comment.back_to_secret_impossible_description"),withoutHiding:!0})}})},regions:{stickerSelectRegion:{el:"@ui.stickerSelectRegion"}},onMessages:(N={},N[u.MSG.DSTICKER_SELECT]=function(e){var t=e.packNo,n=e.stickerId;this._commentInputData.resetCommentInput(),this._commentInputData.setStickerInfo(t,n),this._showAttachedView("image",h.makeStickerImageUrl(t,n)),this._closeStickerSelectRegion(),this._determineSaveBtnActivation()},N[u.MSG.DSTICKER_DOUBLE_CLICK]=function(e){var t=e.packNo,n=e.stickerId;this._commentInputData.resetCommentInput(),this._commentInputData.setStickerInfo(t,n),this._submitModification()},N),initialize:function(e){this._progressModification=!1,this._secretMode=this.model.isSecret(),this._dataFetched=!1,this._messageSubmitKeyType=e.messageSubmitKeyType,this._maxMessageLength=e.maxMessageLength,this._overMaxLengthAlertMessage=e.overMaxLengthAlertMessage,this._flexibleTooltipPositionSupport=e.flexibleTooltipPositionSupport,this._mentionOption=e.mentionOption,this._fnDebouncedCheckIfValidLengh=t.debounce(this._checkIfValidLength,100)},onAttach:function(){A.wrapActivePromise(E.getCachedBandData(this.model.getBandNo()),this).then(t.bind((function(e){this._dataFetched=!0,this._bandData=e,this.render(),this._bindMentionInput(),this._mentionsInput.val(this.model.getBody()),this._bindUploaders();var t={stickerPackNo:this.model.getStickerPackNo(),stickerId:this.model.getStickerId(),photos:this.model.getPhotos(),fileName:this.model.getFileName(),fileId:this.model.getFileId(),fileSize:this.model.getFileSize(),dropboxFileName:this.model.getDropboxFileName(),dropboxFileId:this.model.getDropboxFileId(),dropboxFileSize:this.model.getDropboxFileSize(),externalFileName:this.model.getExternalFileName(),externalFileId:this.model.getExternalFileId(),externalFileSize:this.model.getExternalFileSize(),videoId:this.model.getVideoId(),videoUrl:this.model.getVideoThumbnail(),videoWidth:this.model.getVideoWidth(),videoHeight:this.model.getVideoHeight(),gifVideo:this.model.isGifVideo()};this._commentInputData=d.buildCommentOrJoinQnAInputData(t),this._renderAttachArea(),this.ui.modificationTextarea.focus(),this.jplExposure(v.CLASSIFIER.COMMENT_MODIFY_FORM)}),this))},appendMention:function(e,t,n){this._mentionsInput&&!this._secretMode&&(this._mentionsInput.appendNewMention(e,t,n),this._deferedDetermineSaveBtnActivation())},releaseModificationProgress:function(){this._progressModification=!1,this.ui.submitButton.addClass("buttonPoint")},_bindMentionInput:function(){this._mentionsInput||(this._mentionsInput=a.buildBandMentionsInput(this.ui.modificationTextarea,this.model.getBandNo(),this.ui.mentionListParent,this._makeAutoCompleteListClass(),this.ui.mentionListParent,!1),this._mentionsInput.injectBandData(this._bandData.getMessageInputBandDataAtComment()),this._mentionsInput.setMaxMentionCount(f.MAX_MENTION_COUNT),this._mentionsInput.changeCurrentMemberType(this.model.getAuthorMemberType()),this._bandData.canMentionToCurrentBandMember()&&a.fetchMembersAndGroupsAndPopulateMentionsInput(this.model.getBandNo(),this._mentionsInput,null,!this._bandData.canMentionToCurrentBandMemberGroup()&&this._bandData.getBandCore().supportSelectOtherBandOnMentionFor(this.model.getAuthorMemberType()),this._mentionOption))},_makeAutoCompleteListClass:function(){return this._flexibleTooltipPositionSupport?this.$el.offset().top-i(this.ui.modificationTextarea).closest("._commentListRegion").offset().top<=120?"":"up":""},_bindUploaders:function(){this._destroyUploaders(),this._bindMediaUploader(),this._bindFileUploader(),this._bindPhotoUploader()},_bindMediaUploader:function(){var e={multiple:!0,showProgress:!0,autoUpload:!0};this._bandData.getBandCore().supportAttachVideoOnComment()?this._mediaUploader=r.createPhotoOrVideoUploader(this.ui.commentImageUploadArea,e):this._mediaUploader=r.createPhotoUploader(this.ui.commentImageUploadArea,e),this.listenTo(this._mediaUploader,l.BEFORE_VALIDATE,(function(e){var n={photoCount:this._commentInputData.getPhotoCount()};if(this._bandData.getBandCore().supportAttachVideoOnComment()){var i=c.makeCommentMediaValidator(n),o=t.throttle(i,1e3,{trailing:!1});e.push(o)}else{var s=c.makeCommentPhotoValidator(n),a=t.throttle(s,1e3,{trailing:!1});e.push(a)}})),this.listenTo(this._mediaUploader,l.UPLOAD_COMPLETE,t.bind((function(e){if(e&&e.resultList&&e.resultList[0]){this._closeStickerSelectRegion(),this._commentInputData.resetCommentInput();var n=e.resultList[0];if(n.isVideo||n.isGifVideo)return this._commentInputData.setVideoInfo(n.id,n.url,n.width,n.height,n.name,n.isGifVideo),this._showAttachedView("image",h.make(n.url,h.TYPE.s150)),void this._determineSaveBtnActivation();t.each(e.resultList,(function(e){this._commentInputData.addInputPhoto(e.url,e.width,e.height)}),this),this._renderUploadedPhotoList(e.resultList)}}),this))},_renderUploadedPhotoList:function(e){this.isDestroyed()||(t.each(e,(function(e){var t=S.createDInputPhotoElement(e.url);this.ui.photoList.append(t),t.find(b.INPUT_PHOTO_IMG_SELECTOR).setLoading()}),this),this.ui.photoInputArea.toggle(!this._commentInputData.isMaxPhotoCount()),this.ui.photoArea.toggle(this._commentInputData.isPhotoExist()),this._determineSaveBtnActivation())},_bindFileUploader:function(){this._bandData.getBandCore().supportAttachFileOnComment()&&(this.ui.commentFileUploadArea.show(),this._fileUploader=r.createFileUploader(this.ui.commentFileUploadArea,{multiple:!1,showProgress:!0,autoUpload:!0}),this.listenTo(this._fileUploader,l.UPLOAD_COMPLETE,t.bind((function(e){if(e&&e.resultList&&e.resultList[0]){this._closeStickerSelectRegion();var t=e.resultList[0];this._commentInputData.resetCommentInput(),this._commentInputData.setFileInfo(t.name,t.id,t.file_size),this._showAttachedView("file",t.name),this._determineSaveBtnActivation()}}),this)))},_bindPhotoUploader:function(){var e={multiple:!0,autoUpload:!0,accept:c.getCommentMultiplePhotoAccept(),elements:{dnd:null}};this._photoUploader=r.createPhotoUploader(this.ui.photoInputArea,e),this.listenTo(this._photoUploader,l.BEFORE_VALIDATE,(function(e){var n={photoCount:this._commentInputData.getPhotoCount()},i=c.makeCommentMediaValidator(n),o=t.throttle(i,1e3,{trailing:!1});e.push(o)})),this.listenTo(this._photoUploader,l.UPLOAD_COMPLETE,t.bind((function(e){this._photoUploading=!1,e&&!e.cancelled&&e.resultList&&e.resultList[0]&&this._renderAndAddUploadedPhotoList(e.resultList)}),this))},_renderAndAddUploadedPhotoList:function(e){this.isDestroyed()||(t.each(e,(function(e){this._commentInputData.addInputPhoto(e.url,e.width,e.height);var t=S.createDInputPhotoElement(e.url);this.ui.photoList.append(t),t.find(b.INPUT_PHOTO_IMG_SELECTOR).setLoading()}),this),this.ui.photoInputArea.toggle(!this._commentInputData.isMaxPhotoCount()),this.ui.photoArea.toggle(this._commentInputData.isPhotoExist()),this._deferedDetermineSaveBtnActivation())},_deferedDetermineSaveBtnActivation:function(){t.defer(t.bind((function(){this._determineSaveBtnActivation()}),this))},_determineSaveBtnActivation:function(){null!=this._mentionsInput&&(this._commentInputData.setMessage(this._mentionsInput.val()),this._commentInputData.isAbleToSubmit()?this.ui.submitButton.removeAttr("disabled"):this.ui.submitButton.attr("disabled",""))},_showMediaAndStickerInput:function(){this.ui.singleAttachArea.hide(),this.ui.attachInputDiv.show(),this.ui.textareaWrap.removeClass("-attached"),this.ui.emptyAttachSecretButton.toggle(!0),this.ui.attachedSecretButton.toggle(!1),this._bindUploaders()},_closeStickerSelectRegion:function(){this.getRegion("stickerSelectRegion").empty(),this._makeStickerInputButtonOnOff(!1)},_toggleStickerSelectRegion:function(){if(this.getRegion("stickerSelectRegion").hasView())this._closeStickerSelectRegion();else{this._adjustStickerLayerOffset();var e=m.buildDStickerSelectionLayoutView({bandNo:this.model.getBandNo()});this.getRegion("stickerSelectRegion").show(e),this._makeStickerInputButtonOnOff(!0)}},_adjustStickerLayerOffset:function(){this.ui.stickerSelectRegion.removeClass("-stickerTop");var e,t,n=this.ui.stickerSelectRegion.scrollParent();if(n[0].nodeType==_.DOCUMENT){var o=i(window);e=o.scrollTop()+o.height(),t=this.ui.stickerInputButton.offset().top+322}else{e=n.height()+n.offset().top,t=this.ui.stickerInputButton.offset().top+322}t>e&&this.ui.stickerSelectRegion.addClass("-stickerTop")},_makeStickerInputButtonOnOff:function(e){e?this.ui.stickerInputButton.addClass("-active"):this.ui.stickerInputButton.removeClass("-active")},_showAttachedView:function(e,t){return"image"==e?(this.ui.previewImage.data("source",t),void this._renderAttachArea()):"file"==e?(this.ui.previewFile.html(t),void this._renderAttachArea()):void this._renderAttachArea()},_renderAttachArea:function(){var e=this._commentInputData.isAttachedDataExist();if(this.ui.cancelAttachInfoButton.hide(),this.ui.attachInputDiv.toggle(!this._commentInputData.isPhotoExist()&&!e),this.ui.emptyAttachSecretButton.toggle(!e),this.ui.attachedSecretButton.toggle(e),this.ui.singleAttachArea.toggle(e),this.ui.textareaWrap.toggleClass("-attached",e),this.ui.attachedInfoArea.removeClass([R,P,x,k,B].join(" ")),this.ui.previewImage.removeClass([L,O,D].join(" ")),!this._commentInputData.isStickerExist())return this._commentInputData.isPhotoExist()?(t.each(this._commentInputData.getInputPhotos(),(function(e){var t=S.createDInputPhotoElement(e.url);this.ui.photoList.append(t),t.find(b.INPUT_PHOTO_IMG_SELECTOR).setLoading()}),this),void this.ui.photoInputArea.toggle(!this._commentInputData.isMaxPhotoCount())):void(this._commentInputData.isGifVideo()?this._delayedLoadPreview().then(t.bind((function(){this.ui.previewImage.addClass(L),this.ui.attachedInfoArea.addClass(B)}),this)):this._commentInputData.isVideoExist()?this._delayedLoadPreview().then(t.bind((function(){this.ui.attachedInfoArea.addClass(x),this.ui.previewImage.addClass(L)}),this)):(this._commentInputData.isFileExist()||this.model.isDropboxFileExist()||this.model.isExternalFileExist())&&(this.ui.attachedInfoArea.addClass(R),this.ui.cancelAttachInfoButton.show(),this.ui.previewImage.hide(),this.ui.previewFile.show()));this._delayedLoadPreview().then(t.bind((function(){this.ui.attachedInfoArea.addClass(k),this.ui.previewImage.addClass([O,D].join(" "))}),this))},_delayedLoadPreview:function(){var e=i.Deferred();return this.ui.cancelAttachInfoButton.hide(),this.ui.previewImage.off("setLoading:done").one("setLoading:done",t.bind((function(){this.isDestroyed()||(this.ui.previewFile.hide(),this.ui.previewImage.show(),this.ui.cancelAttachInfoButton.show(),e.resolve())}),this)),this.ui.previewImage.prop("src",this.ui.previewImage.data("source")),this.ui.previewImage.setLoading(),e.promise()},_submitModification:function(){if((this._checkIfValidLength()||this._commentInputData.isAttachedDataExist())&&!this._progressModification){this.ui.submitButton.removeClass("buttonPoint"),this._progressModification=!0,this.spawn(u.MSG.COMMENT_SUBMIT_MODIFICATION,{modificationView:this,contentKey:this.model.getContentKey(),isSecret:this._secretMode,message:this._mentionsInput.val(),memberType:this.model.getAuthorMemberType(),submitData:this._commentInputData,originalSubmitData:d.buildCommentOrJoinQnAInputData({stickerPackNo:this.model.getStickerPackNo(),stickerId:this.model.getStickerId(),photos:this.model.getPhotos(),fileName:this.model.getFileName(),fileId:this.model.getFileId(),fileSize:this.model.getFileSize(),dropboxFileName:this.model.getDropboxFileName(),dropboxFileId:this.model.getDropboxFileId(),dropboxFileSize:this.model.getDropboxFileSize(),externalFileName:this.model.getExternalFileName(),externalFileId:this.model.getExternalFileId(),externalFileSize:this.model.getExternalFileSize(),videoId:this.model.getVideoId(),videoUrl:this.model.getVideoThumbnail(),videoWidth:this.model.getVideoWidth(),videoHeight:this.model.getVideoHeight(),gifVideo:this.model.isGifVideo()})});var e=t.extend({band_no:this.model.getBandNo(),is_preview:this._bandData.isPreviewForJplExtra(),is_reply:this.model.isReply(),is_modify:!0},this.model.getContentKey().makeJackpotParamExceptCommentInfo(),this._commentInputData.makeJackpotExtra());this.jplClick(v.CLASSIFIER.COMMENT_CREATE_CONFIRM,e)}},_checkIfValidLength:function(){if(this.isDestroyed())return!1;var e=this._mentionsInput.val();return!e||e.length<=this._maxMessageLength||(alert(this._overMaxLengthAlertMessage),A.wrapDeferPromise(this).then(t.bind((function(){var e=this._mentionsInput.val();this._mentionsInput.val(e.substring(0,this._maxMessageLength))}),this)),!1)},onBeforeDetach:function(){this._destroyModificationMode()},_destroyModificationMode:function(){this._mentionsInput&&(this._mentionsInput.destroy(),this._mentionsInput=null),this._destroyUploaders()},_destroyUploaders:function(){this._mediaUploader&&(this._mediaUploader.destroy(),this._mediaUploader=null),this._fileUploader&&(this._fileUploader.destroy(),this._fileUploader=null),this._photoUploader&&(this._photoUploader.destroy(),this._photoUploader=null)}});return V.buildDCommentModificationView=function(e,t){return new V({model:e,flexibleTooltipPositionSupport:t.flexibleTooltipPositionSupport,overMaxLengthAlertMessage:t.overMaxLengthAlertMessage,maxMessageLength:t.maxMessageLength,messageSubmitKeyType:t.messageSubmitKeyType,mentionOption:t.mentionOption})},V}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="commentContents">\n    <div class="mentionsWrap">\n        <div class="uInputComment -flexFlexible _textareaWrap">\n            <textarea cols="20" rows="1" style="height:32px;" class="commentWrite _modificationTextarea"></textarea>\n<%\nif ( showSecretButton ) {\n%>\n            <button type="button" class="addSecret _secretModeButton _attachedSecretButton <% if (isSecret) { %>-active<% } %> "><span class="gSrOnly"><%- IM(\'bandsetting.home.btn.secret_comment_use\') %></span></button>\n<%\n}\n%>\n        </div>\n        <div class="lyAutoComplete _mentionListParent"></div>\n        <div class="attachInputBox _attachInputDiv">\n            <button type="button" class="addSticker _stickerInputButton">\n                <span class="gSrOnly"><%= IM(\'ui.label.attach_sticker\') %></span>\n            </button>\n            <span class="addPhoto _commentImageUploadArea"><input type="file" accept="image/*"  class="imageUpload _commentImageInput"><span class="gSrOnly"><%= IM(\'ui.label.upload_photo\') %></span></span>\n            <span class="addFile _commentFileUploadArea" style="display: none;"><input type="file" class="imageUpload _commentFileInput"><span class="gSrOnly"><%= IM("web.postwrite.attach.d_title.file") %></span></span>\n<%\nif ( showSecretButton ) {\n%>\n            <button type="button" class="addSecret _secretModeButton <% if (isSecret) { %>-active<% } %> _emptyAttachSecretButton"><span class="gSrOnly"><%- IM(\'bandsetting.home.btn.secret_comment_use\') %></span></button>\n<%\n}\n%>\n        </div>\n    </div>\n\n    <div class="commentMediaListBox _photoArea" <% if ( !isPhotoExist ) { %>style="display: none;" <% } %>>\n        <div class="attachPhotoList _photoList"></div>\n        <label class="btnPhotoUpload _photoInputArea">\n            <input type="file" accept="image/*" title="<%= IM(\'profile.choose_profile_image\') %>" name="attachment" class="imageUpload _imageUploadButton">\n        </label>\n    </div>\n\n    <div class="commentMediaListBox _singleAttachArea" <% if ( isPhotoExist ) { %>style="display: none;" <% } %>>\n        <div class="addContents _attachedInfoArea">\n            <img src="" data-source="<%- modificationImageUrl %>" class="_previewImage"<% if (!modificationImageUrl) { %> style="display:none;"<% } %>>\n            <span class="_previewFile">\n                <% if (isFileExist) { %>\n                <%- fileName %>\n                <% } if (isDropboxFileExist) { %>\n                <%- dropboxFileName %>\n                <% } if (isExternalFileExist) { %>\n                <%- externalFileName %>\n                <% } %>\n                </span>\n            <button type="button" class="delete _cancelAttachInfoButton"><span class="gSrOnly"><%= IM(\'web.commentmodify.attach.btn.delete_attach_info\') %></span></button>\n        </div>\n    </div>\n\n</div>\n\n<div class="stickerSelectRegion _stickerSelectRegion"></div>\n\n<button type="button" class="buttonCommentModi _cancelModificationButton"><%= IM(\'ui.label.cancel\') %></button>\n<button type="button" class="buttonCommentModi buttonPoint _submitButton"><%= IM(\'ui.label.save\') %></button>'},function(e,t){e.exports='<div class="_audioPlayer"></div>\n<button type="button" class="control -stop _controlBtn"><%- IM("web.audioplayer.player.btn.ready") %></button>\n<div class="status">\n\t<span class="timeText">\n\t\t<span class="minute _minuteLabel">0</span>:<span class="second _secondLabel">00</span>\n\t</span>\n</div>'},function(e,t){e.exports='<% if (clickable) { %>\n<button type="button" class="emotionWrap _iconBtn">\n    <% _.each(emotions, function(emotion) { %>\n    <span class="icon"><span class="uFaceIcon -<%= emotion.iconName %><%= sizeType %>"><%= emotion.label %></span></span>\n    <% }); %>\n</button>\n<button type="button" class="count<%= active ? \' -active\' : \'\' %> _countBtn"><%= emotionCount %></button>\n<% } else { %>\n<span class="emotionWrap">\n    <% _.each(emotions, function(emotion) { %>\n    <span class="icon"><span class="uFaceIcon -<%= emotion.iconName %><%= sizeType %>"><%= emotion.label %></span></span>\n    <% }); %>\n</span>\n<span class="count<%= active ? \' -active\' : \'\' %>"><%= emotionCount %></span>\n<% } %>'},function(e,t){e.exports='<div class="uInput -h32 -dropDown -bgNone _wrap" style="min-width:160px">\n    <button type="button" aria-haspopup="true" aria-expanded="false" class="dropdownToggle _toggleBtn" id="dropdown1_<%- cid %>"><%- sourceLanguage.name %></button>\n    <span class="border"></span>\n    <ul class="dropDown" aria-labelledby="dropdown1_<%- cid %>">\n        <% _.each(sourceLanguages, function(item) { %>\n        <li role="option" aria-selected="<%- item == sourceLanguage %>" class="dropDownItem"><button type="button" class="btnDropDown _sourceLanguageBtn" data-code="<%- item.code %>"><%- item.name %></button></li>\n        <% }); %>\n    </ul>\n</div>\n<span class="icon-arrow"></span>\n\x3c!-- [D] 드랍다운박스 토글 : -dropDownOn 클래스 사용시 aria-expanded="true" 로 변경 --\x3e\n<div class="uInput -h32 -dropDown -bgNone _wrap" style="min-width:160px">\n    <button type="button" aria-haspopup="true" aria-expanded="false" class="dropdownToggle _toggleBtn" id="dropdown2_<%- cid %>"><%- targetLanguage.name %></button>\n    <span class="border"></span>\n    <ul class="dropDown" aria-labelledby="dropdown2_<%- cid %>">\n        <% _.each(targetLanguages, function(item) { %>\n        <li role="option" aria-selected="<%- item == targetLanguage %>" class="dropDownItem"><button type="button" class="btnDropDown _targetLanguageBtn" data-code="<%- item.code %>"><%- item.name %></button></li>\n        <% }); %>\n    </ul>\n</div>\n<div class="buttonBox">\n    <button type="button" class="uButton -sizeS _translationBtn"><%- IM(\'ui.label.see_translation\') %></button>\n    <button type="button" class="uButton -text _settingBtn"><%- IM(\'translation.settings\') %></button>\n</div>'},function(e,t){e.exports='<div class="translationBox">\n    <button type="button" class="button _seeTranslationBtn"><%- IM(\'ui.label.see_translation\') %></button>\n    <p class="text _loading">\n        <span class="uLoading">\n            <img src="<%- resBaseUrl %>/images/common/loading.gif" width="14" height="14" alt="<%- IM(\'ui.message.loading\') %>">\n        </span>\n        <%- IM(\'ui.label.translating\') %>\n    </p>\n</div>\n<div class="translationBox _settingWrap">\n    <% /* \x3c!-- [D] settingBox 열리면 -underline 클래스 추가 --\x3e */ %>\n    <button type="button" class="button -setting _settingToggleBtn"><%- IM(\'translation.settings\') %></button>\n    <button type="button" class="button -viewOrigin _viewOriginalBtn"><%- IM(\'ui.label.view_original\') %></button>\n\n    <div class="_settingRegion"></div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(493),s=n(486),a=n(1359),r=i.View.extend({attributes:{"data-viewname":"DScheduleDeleteWithReportView"},template:t.template(a),templateContext:function(){return{msg_deleteScheduleLabel:this.isRecurrence?IM("schedule.report.delete_schedule.recurrence"):IM("schedule.report.delete_schedule.oneday")}},ui:{checkDeleteSchedule:"._checkDeleteSchedule",checkMemberWithdrawalAndBlock:"._checkMemberWithdrawalAndBlock",btnCancel:"._btnCancel",btnConfirm:"._btnConfirm"},events:{"click @ui.checkDeleteSchedule":"_setActiveButtonStyle","click @ui.checkMemberWithdrawalAndBlock":"_setActiveButtonStyle","click @ui.btnConfirm":"_confirmScheduleDeleteAndMemberWithdrawal","click @ui.btnCancel":"destroy"},initialize:function(e){this.bandNo=e.bandNo,this.userNo=e.userNo,this.canDelete=e.canDelete,this.canBanMember=e.canBanMember,this.isRecurrence=e.isRecurrence},serializeData:function(){return{canDelete:this.canDelete,canBanMember:this.canBanMember}},onAttach:function(){this._setActiveButtonStyle()},_setActiveButtonStyle:function(){this.getUI("checkDeleteSchedule").is(":checked")||this.getUI("checkMemberWithdrawalAndBlock").is(":checked")?this.getUI("btnConfirm").removeClass("-disabled").prop("disabled",!1):this.getUI("btnConfirm").addClass("-disabled").prop("disabled",!0)},_confirmScheduleDeleteAndMemberWithdrawal:function(){if(!this.getUI("checkDeleteSchedule").is(":checked")&&!this.getUI("checkMemberWithdrawalAndBlock").is(":checked"))return this.destroy(),!1;if(this.getUI("checkMemberWithdrawalAndBlock").is(":checked")){o.doWithdrawBandMember(this.bandNo,this.userNo,!0)}this.getUI("checkDeleteSchedule").is(":checked")&&this.trigger("DScheduleDeleteWithReportView:scheduleDeleted"),this.destroy()}});return r.buildAsLayer=function(e){var t=new r(e);return s.open(t),t},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent -w360">\n        <header class="header -noTitlebar">\n            <h1 class="title"><%- IM("bandsetting.member_withdrawal.txt.description.done_report") %></h1>\n        </header>\n        <div class="main">\n            <p class="p"><%- IM("schedule.report.member_withdrawal.desc") %></p>\n            <ul class="selectArea">\n                <% if (canDelete) { %>\n                <li>\n                    <label for="checkbox1" class="uCheck -checkbox">\n                        <input type="checkbox" id="checkbox1" class="checkInput _checkDeleteSchedule" checked>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%- msg_deleteScheduleLabel %></span>\n                        </span>\n                    </label>\n                </li>\n                <% } %>\n                <% if (canBanMember) { %>\n                <li>\n                    <label for="checkbox2" class="uCheck -checkbox">\n                        <input type="checkbox" id="checkbox2" class="checkInput _checkMemberWithdrawalAndBlock">\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%- IM("bandsetting.member_withdrawal.label.compulsory_withdrawal_and_block") %></span>\n                        </span>\n                    </label>\n                </li>\n                <% } %>\n            </ul>\n        </div>\n        <footer class="footer">\n            <button type="button" class="uButton -cancel _btnCancel"><%= IM("ui.label.cancel") %></button>\n            <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n        </footer>\n    </div>\n</section>'},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="header">\n        <h1 class="title"><%-IM(\'web.postwrite.album.title\')%></h1>\n    </header>\n\n    <div class="main -tSpaceNone">\n        <ul class="listLine rScroll -h360">\n            <li class="tLine">\n                <a href="#" class="flexList" role="button" data-uiselector="makeAlbum">\n\t\t\t\t\t\t<span class="thumb -square50">\n\t\t\t\t\t\t\t<span class="makeAlbum">+</span>\n\t\t\t\t\t\t</span>\n                    <span class="text"><%= IM(\'web.postwrite.album.label.create_album\') %></span>\n                    <span class="etc -arrow"></span>\n                </a>\n            </li>\n<%\n_.each(items, function(album, index) {\n%>\n            <li class="tLine _eachAlbumLi">\n                <label class="flexList">\n\n                    <span class="thumb -square50">\n                        <% if (album.cover) { %>\n                        <img src="<%-msg_ThumbnailUrl(album.cover)%>" alt="<%-album.name%>">\n                        <% } else { %>\n                        <span class="noCover"></span>\n                        <% } %>\n                    </span>\n\n                    <span class="text">\n                        <span class="ellipsis"><%- album.name %></span>\n                        <time class="blockTime" datetime="<%- msg_displayDate(album.createdAt) %>"><%- msg_displayDate(album.createdAt) %></time>\n                    </span>\n\n                    <span class="etc">\n                        <span for="album_choice_<%-index%>" class="uCheck -radio">\n                            <input type="radio" id="album_choice_<%-index%>" name="radio" class="checkInput _checkInput" value="<%-index%>" data-albumno="<%= album.albumNo %>" data-uiselector="albumRadioButton">\n                            <span class="checkLabel">\n                                <span class="shape sf_tAfterBg"></span>\n                            </span>\n                        </span>\n                    </span>\n                </label>\n            </li>\n<% }); %>\n        </ul>\n    </div>\n\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -cancel" data-uiselector="cancelButton"><%-IM(\'ui.label.cancel\')%></button>\n        <button type="button" class="uButton -confirm -disabled" data-uiselector="btnSaveAlbum"><%= saveButtonText %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title"><%-msg_title%></h1>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap">\n            <% if (msg_desc) { %>\n            <div class="msgWrap gPa0 gMat17">\n                <p class="pText"><%=msg_desc%></p>\n            </div>\n            <% } %>\n\n            <div class="uInputTableWrap">\n                <% if(multiline) { %>\n                <div class="uTextarea" style="height:110px">\n                    <textarea class="_inputText" maxlength="<%-msg_maxlength%>" placeholder="<%- placeholder %>"><%= msg_defaultText %></textarea>\n                    <span class="border"></span>\n                </div>\n                <% } else { %>\n                <div class="uInput -h38">\n                    <label class="gSrOnly" for="promptLabelId"><%= msg_labelName %></label>\n                    <input type="text" id="promptLabelId" maxlength="<%-msg_maxlength%>" value="<%= msg_defaultText %>" placeholder="<%- placeholder %>" class="_inputText">\n                    <span class="border"></span>\n                </div>\n                <% } %>\n                <% if (helpGuide) { %>\n                <p class="sDesc gMat10"><%- helpGuide %></p>\n                <% } %>\n            </div>\n        </div>\n    </div>\n\n    <footer class="modalFooter">\n        <button type="button" class="uButton -cancel _cancelButton"><%-IM(\'web.modal.btn.cancel\')%></button>\n        <button type="button" class="uButton _confirmButton"><%-IM(\'web.modal.btn.confirm\')%></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(10),n(6)),o=n(4),s=n(1363),a=n(1035),r=n(1151),l=n(486),c=n(516),d=n(26),u=n(153),h=n(513),p=n(720),m=n(1367),_=n(780),g=n(1004),f=n(13),b=n(152),v=n(606),A=n(1036);n(591);var E=a.WATCHER_TYPE,T=b.VIEW_POST_READERS_MAX_MEMBER_COUNT,C=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DVideoWatcherListLayerView"},template:t.template(s),templateContext:function(){var e="";return this._isMyViewMode?e=IM("media_viewer.video.my_watch_ratio.title"):this._isWatchersMode&&(e=IM("video_viewer_list.title")),{WATCHER_TYPE:E,title:e,videoWatcherCount:this.collection.getVideoWatcherCount(),nonWatcherCount:this.collection.getNonWatcherCount(),isMyViewMode:this._isMyViewMode,isWatchersMode:this._isWatchersMode,isBigBand:this._isBigBand}},ui:{btnWatcherList:"._btnWatcherList",descMaxWatcherCountOver:"._descMaxWatcherCountOver",tabDesc:"._tabDesc",btnChatWithNonWatchers:"._btnChatWithNonWatchers",btnMoreMenu:"._btnMoreMenu",menuLayer:"._menuLayer",btnExcelDownload:"._btnExcelDownload",btnPrint:"._btnPrint",btnConfirm:"._btnConfirm"},regions:{watcherListRegion:{el:"._watcherListRegion",replaceElement:!0}},events:{"click @ui.btnWatcherList":function(e){this._changeWatcherType($(e.currentTarget).data("watcherType"))},"click @ui.btnChatWithNonWatchers":function(e){var n=t.map(this._getChatableNonWatcherModels(),(function(e){return new _(e.getMember().toJSON(),{parse:!0})})),o=g.openAsLayer(this._bandData,new i.Collection(n,{parse:!0}));this.listenTo(o,"member:selected",(function(e){var t=e.map((function(e){return e.pick("userNo","name")}));p.startChattingWithUsers(t,this._bandNo)}))},"click @ui.btnMoreMenu":function(e){this.getUI("menuLayer").is(":visible")||t.defer(t.bind((function(){this.getUI("menuLayer").show()}),this))},"click @ui.btnExcelDownload":function(e){if(e.preventDefault(),this._isBigBand)this._creteExcelFileAndDownload(["videoWatcher"]);else{var t=m.openAsLayer({description:IM("schedule.rsvp.select_download_item.desc")});this.listenTo(t,m.EVENT.SELECTED,(function(e){this._creteExcelFileAndDownload(e)}))}},"click @ui.btnPrint":function(e){if(e.preventDefault(),this._isBigBand)this._openWatcherListPrintView(["videoWatcher"]);else{var t=m.openAsLayer({description:IM("schedule.rsvp.select_print_item.desc")});this.listenTo(t,m.EVENT.SELECTED,(function(e){this._openWatcherListPrintView(e)}))}},"click @ui.btnConfirm":"destroy"},initialize:function(e){if(this._bandData=e.bandData,this._bandNo=this._bandData.getBandNo(),this._videoId=e.videoId,this._isEveryMemberIncluded=!t.isBoolean(e.isEveryMemberIncluded)||e.isEveryMemberIncluded,this._isBigBand=!this._isEveryMemberIncluded,this._viewVideoWatcherRoles=e.viewVideoWatcherRoles,this._isMyViewMode=this._bandData.canViewMyViewingProgress(),this._isWatchersMode=this._bandData.canViewVideoWatcher(),this._isMyViewMode){var n=this.collection.get(f.getUserData().getUserNo()),i={};i[E.VIDEO_WATCHER]=n.getVideoViewPercentage()||0,n.set({watcherTypes:[E.VIDEO_WATCHER],viewPercentage:i})}this.listenTo(d.getDGlobalChannel(),d.EVENT.HTML_CLICK,(function(){this.getUI("menuLayer").hide()}))},onAttach:function(){this._showTabDesc(E.VIDEO_WATCHER),this._showWatcherList(E.VIDEO_WATCHER),this._showWatcherListFooterDesc(E.VIDEO_WATCHER)},_showWatcherList:function(e){this.getRegion("watcherListRegion").empty(),this._watcherListView=new r({collection:this.collection,bandData:this._bandData,watcherType:e,isEveryMemberIncluded:this._isEveryMemberIncluded}),this.showChildView("watcherListRegion",this._watcherListView)},_changeWatcherType:function(e){this.getUI("btnWatcherList").parent("span").removeClass("-on"),this.getUI("btnWatcherList").filter('[data-watcher-type="'+e+'"]').parent("span").addClass("-on"),this._showTabDesc(e),this._toggleBtnChatWithNonWatchers(e),this._watcherListView.filterWatcherType(e),this._showWatcherListFooterDesc(e)},_getChatableNonWatcherModels:function(){return t.filter(this.collection.getNonWatchers(),(function(e){return!e.getMember().isMyself()}))},_toggleBtnChatWithNonWatchers:function(e){if(this._isBigBand)this.getUI("btnChatWithNonWatchers").hide();else{var t=this._getChatableNonWatcherModels().length;e===E.NON_WATCHER&&t>0?this.getUI("btnChatWithNonWatchers").show():this.getUI("btnChatWithNonWatchers").hide()}},_showTabDesc:function(e){var n=[];if(e===E.VIDEO_WATCHER){var i=this.collection.getVideoWatcherCount();i=i>=T?T-1+"+":i,n.push(IM("media_viewer.video.watcher.tab_desc.video_watcher2",{watcherCount:String(i)})),this._isWatchersMode&&!t.isEmpty(this._viewVideoWatcherRoles)&&n.push(IM("media_viewer.video.watcher.tab_desc.permission_desc."+this._viewVideoWatcherRoles.join("_"))),n[n.length-1]=n[n.length-1]+" "+IM("media_viewer.video.watcher.tab_desc.initially_viewed_at")}t.isEmpty(n)?this.getUI("tabDesc").hide():(this.getUI("tabDesc").html(n.join("<br>")),this.getUI("tabDesc").show())},_getWatcherListFooterDesc:function(e){return e!=E.VIDEO_WATCHER||this.collection.getVideoWatcherCount()<T?"":IM("member_list.max_count_info",{maxMemberCount:T})},_showWatcherListFooterDesc:function(e){var n=this._getWatcherListFooterDesc(e);t.isEmpty(n)?this.getUI("descMaxWatcherCountOver").hide():(this.getUI("descMaxWatcherCountOver").text(n),this.getUI("descMaxWatcherCountOver").show())},_openWatcherListPrintView:function(e){var t=u.GROUP_BAND_VIDEO_WATCHER_PRINT.makeUrl({band_no:this._bandNo,video_id:this._videoId},{watcherTypes:e.join(",")});h.openWindowXSSSafely(t,"_blank")},_creteExcelFileAndDownload:function(e){var n={A:IM("media_viewer.view_percentage.excel.header1"),B:IM("media_viewer.view_percentage.excel.header2")},i=this.collection.chain().filter((function(n){return!t.isEmpty(t.intersection(n.getWatcherTypes(),e))})).map((function(e){return{A:e.getMember().getName(),B:Math.floor(e.getVideoViewPercentage()||0)+""||null}})).value();i.unshift(n);var o,s=A.utils.json_to_sheet(i,{header:["A","B"],skipHeader:!0}),a=A.utils.book_new(),r=this._bandData.getBandName()+"_video_"+this._videoId+".xlsx";t.each(s,(function(e,t){/^B/.test(t)&&"B1"!==t&&"s"===e.t&&(s[t].v=s[t].v/100,s[t].t="n",s[t].z="#0%")})),s["!cols"]=[{wch:30},{wch:20}],A.utils.book_append_sheet(a,s,IM("video_viewer_list.title")),o=A.write(a,{bookType:"xlsx",bookSST:!0,type:"binary"}),v.saveAs(new Blob([this._s2ab(o)],{type:"application/octet-stream"}),r)},_s2ab:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i!=e.length;++i)n[i]=255&e.charCodeAt(i);return t}});return C.openAsyncAsLayer=function(e,t,n,i){var o=e.getBandNo(),s=c.getVideoWatchers(o,t,n,i).then((function(n){return new C({bandData:e,videoId:t,isEveryMemberIncluded:n.is_every_member_included,viewVideoWatcherRoles:n.view_video_watcher_roles,collection:new a(n.watchers,{parse:!0})})}));return l.openPromiseView(s,!0,{width:480,height:544}),s},C}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w380">\n\n    <header class="modalHeader">\n        <h1 class="title"><%= title %></h1>\n        <% if (isWatchersMode) { %>\n        <div class="moreMenuWrap">\n            <button class="btnMoreMenu _btnMoreMenu"><%- IM(\'ui.label.more.short\') %></button>\n            <div class="menuBox _menuLayer" style="display:none;">\n                <ul class="menuList">\n                    <li class="menuItem"><button type="button" class="btnMenuText _btnExcelDownload"><%- IM(\'ui.label.excel_download\') %></button></li>\n                    <li class="menuItem"><button type="button" class="btnMenuText _btnPrint"><%- IM(\'ui.label.print\') %></button></li>\n                </ul>\n            </div>\n        </div>\n        <% } %>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gPa0">\n            <% if (isWatchersMode) { %>\n            <div class="tab">\n                <span class="cell sf_color -on">\n                    <button type="button" class="_btnWatcherList" data-watcher-type="<%= WATCHER_TYPE.VIDEO_WATCHER %>"><%= IM(\'media_viewer.video.watcher.tab_name.video_watcher\') %> <span class="sf_color"><%= videoWatcherCount %></span></button>\n                </span>\n                <span class="cell sf_color">\n                    <button type="button" class="_btnWatcherList" data-watcher-type="<%= WATCHER_TYPE.NON_WATCHER %>"><%= IM(\'media_viewer.video.watcher.tab_name.non_watcher\') %> <% if (!isBigBand) { %><span class="sf_color"><%= nonWatcherCount %></span><% } %></button>\n                </span>\n            </div>\n            <% } %>\n\n            <div class="tabContent gPal20 gPar20 -verticalFlexible -h390">\n                <p class="sDesc -bLine -flexFixed _tabDesc"></p>\n\n                <button type="button" class="_btnChatWithNonWatchers buttonMemberChat -arrow -borderBottom" style="display: none;">\n                    <span class="iconChatPlus"></span>\n                    <span class="text"><%= IM(\'ui.label.chat_with_following_members\') %></span>\n                </button>\n\n                <div class="_watcherListRegion"></div>\n                <p class="sDesc -tLine gPat10 gMab10 _descMaxWatcherCountOver" style="display:none;"></p>\n            </div>\n        </div>\n    </div>\n\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -confirm _btnConfirm"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(52),o=n(6),s=n(490),a=n(516),r=n(529),l=a.WATCHER_TYPE,c=o.Model.extend({parse:function(e){return{id:(e=i.camelizeKeys(e)).member.userNo,watcherTypes:e.watcherTypes,viewPercentage:e.viewPercentage,initiallyViewedAt:e.initiallyViewedAt,member:new r(e.member,{parse:!0})}},toJSON:function(){return s.toRecursiveJSON(this)},getWatcherTypes:function(){return this.get("watcherTypes")},containsWatcherType:function(e){return t.contains(this.getWatcherTypes(),e)},isWatcher:function(){return!this.isNonWatcher()},isVideoWatcher:function(){return t.contains(this.getWatcherTypes(),l.VIDEO_WATCHER)},isLiveWatcher:function(){return t.contains(this.getWatcherTypes(),l.LIVE_WATCHER)},isNonWatcher:function(){return t.contains(this.getWatcherTypes(),l.NON_WATCHER)},getViewPercentage:function(){return this.get("viewPercentage")},getLiveViewPercentage:function(){return this.getViewPercentage()[l.LIVE_WATCHER]},getVideoViewPercentage:function(){return this.getViewPercentage()[l.VIDEO_WATCHER]},getInitiallyViewedAt:function(){return this.get("initiallyViewedAt")},getMember:function(){return this.get("member")}});return c.WATCHER_TYPE=l,c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1366),s=n(618),a=n(720),r=n(9);return i.View.extend({tagName:"li",className:"tLine flexList",attributes:{"data-viewname":"DVideoWatcherListItemView"},template:t.template(o),templateContext:function(){var e=this.model.getInitiallyViewedAt()[this._watcherType];return{watcherType:this._watcherType,isWatcher:this.model.isWatcher(),isChatPossible:!this.model.getMember().isMyself(),getViewPercentage:t.bind((function(e){return Math.floor(this.model.getViewPercentage()[e])+"%"}),this),initiallyViewedAtText:e?r.format.date(e,"short_date_time"):""}},regions:{profileImage:{el:"._profileImage",replaceElement:!0}},events:{"click ._chatBtn":function(){var e=this.model.getMember(),t=e.getUserNo(),n=e.getName(),i=this._bandData.getBandNo();a.startChattingWithUsers([{userNo:t,name:n}],i)}},initialize:function(e){this._bandData=e.bandData,this._watcherType=e.watcherType},onRender:function(){var e=this.model.getMember();this.showChildView("profileImage",s.buildContentCreatorProfileImageView({memberProfile:e.getMemberProfile(),userNoOrMemberKey:e.getUserNo()||e.getContentAuthorMemberKey(),bandCore:this._bandData.getBandCore(),role:e.get("role")}))},serializeData:function(){return this.model.toJSON()}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="thumb">\n    <div class="_profileImage"></div>\n</span>\n<span class="text">\n    <span class="ellipsis"><%- member.name %></span>\n    <span class="sub3 ellipsis"><%- member.desc %></span>\n    <% if (initiallyViewedAtText) { %><span class="sub2"><%- IM(\'media_viewer.video.watcher.item.initially_viewed_at\', {date: initiallyViewedAtText}) %></span><% } %>\n</span>\n<% if (isWatcher) { %>\n<span class="etc -text gColorBk2"><%= getViewPercentage(watcherType) %></span>\n<% } else if (isChatPossible) { %>\n<span class="etc">\n    <button type="button" class="buttonChatting _chatBtn">\n        <span class="gSrOnly"><%- IM(\'chat.btn.private_chat\') %></span>\n        <svg class="svgIcon sf_color" aria-hidden="true">\n        <use xlink:href="#ico-chat"></use>\n        </svg>\n    </button>\n</span>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1368),s=n(486),a={SELECTED:"SELECTED"},r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DVideoWatcherTypeSelectView"},template:t.template(o),ui:{checkboxAll:"._checkboxAll",checkbox:"._checkbox",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},events:{"change @ui.checkboxAll":function(){this.ui.checkbox.prop("checked",this.ui.checkboxAll.prop("checked")),this._toggleConfirmBtn()},"change @ui.checkbox":function(){this.ui.checkboxAll.prop("checked",0==this.ui.checkbox.filter(":not(:checked)").length),this._toggleConfirmBtn()},"click @ui.cancelBtn":"_closeSelf","click @ui.confirmBtn":function(){var e=t.map(this.ui.checkbox.filter(":checked").get(),(function(e){return e.value}));this.trigger(a.SELECTED,e),this._closeSelf()}},initialize:function(e){this._description=e.description},serializeData:function(){return{description:this._description,checkboxes:[{value:"videoWatcher",label:IM("media_viewer.video.watcher.watcher_type_select.video_watcher")},{value:"nonWatcher",label:IM("media_viewer.video.watcher.watcher_type_select.non_watcher")}]}},_toggleConfirmBtn:function(){this.ui.confirmBtn.prop("disabled",0==this.ui.checkbox.filter(":checked").length)},_closeSelf:function(){s.closeTop()}});return r.EVENT=a,r.openAsLayer=function(e){var t=new r(e);return s.openWithoutHiding(t),t},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent">\n    <header class="header -subDescType">\n        <h1 class="title"><%- IM(\'schedule.rsvp.select_print_item.title\') %></h1>\n        <p class="desc"><%- description %></p>\n    </header>\n\n    <div class="main">\n        <ul class="selectArea">\n            <li>\n                <label for="check_all" class="uCheck -checkbox">\n                    <input type="checkbox" id="check_all" class="checkInput _checkboxAll">\n                    <span class="checkLabel">\n                        <span class="shape"></span>\n                        <span class="text"><%- IM(\'ui.label.all_select\') %></span>\n                    </span>\n                </label>\n            </li>\n            <% _.each(checkboxes, function(checkbox, index) { %>\n            <li>\n                <label for="check_<%- index %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="check_<%- index %>" class="checkInput _checkbox" value="<%- checkbox.value %>">\n                    <span class="checkLabel">\n                        <span class="shape"></span>\n                        <span class="text"><%- checkbox.label %></span>\n                    </span>\n                </label>\n            </li>\n            <% }); %>\n        </ul>\n    </div>\n\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn" disabled><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="lyContent" style="width: <%= viewWidth %>; height: 560px">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'web.bandmemberselection.title\') %></h1>\n    </header>\n\n    <div class="modalBody -heightFix" style="height:436px">\n        <div class="searchNListWrap">\n            <form class="searchWrap columnFixed _formSearch">\n                <label for="searchMember" class="searchIcon"><span class="gSrOnly"><%-IM(\'web.bandmemberselection.member_query\')%></span></label>\n                <span class="inputWrap">\n            <input type="search" id="searchMember" class="inputSearch _inputSearchQuery" placeholder="<%-IM(\'web.profile.label.name\')%>">\n        </span>\n                <button type="submit" class="btnSearch uButton -sizeS -default -disabled _btnSearch" disabled><%- IM(\'ui.label.search\') %></button>\n            </form>\n            <div class="_selectedMembersWrap selectedMembersWrap columnFixed -lrSpaceNone">\n                <div class="_selectedMemberListRegion"></div>\n            </div>\n            <div class="btnGroupMemberSelect gMat-1 _groupMemberSelectBtnArea" style="display: none;">\n                <a href="#" role="button" class="button _btnMemberGroupSelect"><%- IM(\'band.member.group.select_member_groups\') %></a>\n            </div>\n            <div class="_memberListWrap modalContentWrap rScroll -lrSpace -tLine gMat-1 columnFlexible">\n                <div class="_memberSelectionListRegion"></div>\n            </div>\n        </div>\n    </div>\n\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="uButton -cancel _btnCancel"><%-IM(\'ui.label.cancel\')%></button>\n        <button type="button" class="uButton -confirm _btnConfirm" disabled><%-IM(\'ui.label.confirm\')%>&nbsp;<span class="_spanSelectedUserCount"></span></button>\n    </footer>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(6),s=n(4),a=n(780),r=n(1371),l=a.getUserNoForSelectAll(),c={BAND_MEMBER_SELECTED:"bandMember:selected",BAND_MEMBER_DESELECTED:"bandMember:deselected"},d=s.CollectionView.extend({tagName:"ul",className:"listLine",attributes:{"data-viewname":"DSimpleMemberSelectionListView"},collection:new o.Collection(null,{model:a}),collectionEvents:{reset:"_configureModelForSelectAll"},childView:r,childViewEvents:{"bandMember:selected":"_bandMemberSelected","bandMember:deselected":"_bandMemberDeselected"},emptyView:function(){return s.View.extend({tagName:"p",className:"uEmpty -h320",template:t.template("<span><%- emptyMessage %></span>"),templateContext:function(){return{emptyMessage:this.options.message}}})},emptyViewOptions:function(){return{message:this._query?IM("ui.message.no_search_result"):IM("member_list.label.nobody_available")}},filter:function(e,n,o){return!!t.isFunction(this.collection.search)||(!this._query||e.getUserNo()!==a.getUserNoForSelectAll()&&i.include(e.getName(),this._query.toLowerCase()))},initialize:function(e){this._bandData=e.bandData},deselectChildSilently:function(e){t.each(e,t.bind((function(e){var t=this.collection.find((function(t){return t.getUserNo()==e.getUserNo()}));t&&t.set("selected",!1)}),this)),this._configureModelForSelectAll()},hasMemberGroup:function(){return this.collection.hasMemberGroup()},searchMembers:function(e,n){var i=$.Deferred();return this._query=e,t.isFunction(this.collection.search)?this.collection.search(this._query,n).then(t.bind((function(){i.resolve()}),this)):(this.render(),i.resolve()),i.promise()},addMembersByMemberGroupSelect:function(e){var n=e.map((function(e){return e.getUserNo()}));this.collection.chain().filter((function(e){return t.contains(n,e.getUserNo())})).each((function(e){e.setSelected(!0)})),this._configureModelForSelectAll(),this.trigger(c.BAND_MEMBER_SELECTED,e)},_bandMemberSelected:function(e){var n=[];if(e.getUserNo()==l){var i=this.collection.filter(t.bind((function(e){return e.getUserNo()!=l&&!e.get("selected")}),this));if(!i||0==i.length)return;n=i,t.each(n,(function(e){e.set("selected",!0)}))}else this._configureModelForSelectAll(),n=[e];n.length>0&&this.trigger(c.BAND_MEMBER_SELECTED,n)},_bandMemberDeselected:function(e){var n=[];if(e.getUserNo()==l){var i=this.collection.filter(t.bind((function(e){return e.getUserNo()!=l&&e.get("selected")}),this));if(!i||0==i.length)return;n=i,t.each(n,(function(e){e.set("selected",!1)}))}else this._configureModelForSelectAll(),n=[e];n.length>0&&this.trigger(c.BAND_MEMBER_DESELECTED,n)},_configureModelForSelectAll:function(){var e=this.collection.get(l);e&&e.set("selected",this._isAllSelected())},_isAllSelected:function(){return!this.collection.find((function(e){return e.getUserNo()!=l&&!e.get("selected")}))}});return d.EVENT=c,d.USER_NO_FOR_SELLECT_ALL=l,d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1372),s=n(82);return i.View.extend({tagName:"li",className:"tLine",attributes:{"data-viewname":"DSimpleMemberSelectionListItemView"},template:t.template(o),templateContext:function(){var e=s.makeProfileThumbnailUrl(this.model.getProfileImageUrl());return{faceThumb:s.makeProfileThumbnailUrl(this.model.getProfileImageUrl()),profileInnerClass:s.makeProfileInnerClass(e)}},ui:{checkboxMemberSelect:"._checkboxMemberSelect"},modelEvents:{"change:selected":function(e,t){this.ui.checkboxMemberSelect.prop("checked",t)}},events:{"click @ui.checkboxMemberSelect":function(e){this.ui.checkboxMemberSelect.prop("checked")?(this.model.set({selected:!0},{silent:!0}),this.trigger("bandMember:selected",this.model)):(this.model.set({selected:!1},{silent:!0}),this.trigger("bandMember:deselected",this.model))}},initialize:function(e){e.model.has("selected")||e.model.set("selected",!1)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<label class="flexList">\n    <span class="thumb">\n        <span class="uProfile -size40">\n            <span class="profileInner <%- profileInnerClass %>">\n                <% if (!!profileImageUrl) { %><img src="<%- faceThumb %>" width="40" height="40" alt="<%- name %>"><% } %>\n            </span>\n        </span>\n    </span>\n    <span class="text">\n        <span class="ellipsis"><%- name %></span>\n        <span class="sub2 -ellipsis"><%- desc %></span>\n    </span>\n    <span class="etc">\n        <span class="uCheck -checkbox -noLabel">\n            <input type="checkbox" class="checkInput _checkboxMemberSelect" <%- selected ? \'checked\' : \'\' %>>\n            <span class="checkLabel">\n                <span class="shape"></span>\n            </span>\n        </span>\n    </span>\n</label>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(4),s=n(780),a=n(1374),r=o.CollectionView.extend({tagName:"ul",className:"selectedMembers",attributes:{"data-viewname":"DSimpleMemberSelectedListView"},collection:new i.Collection(null,{model:s}),childView:a,childViewEvents:{"bandMember:deselected":function(e){this.collection.remove(e),this.trigger("bandMember:deselected",e)}},addSelectedMembers:function(e){var n=t.map(e,(function(e){return e.clone()}));this.collection.add(n)},removeSelectedMembers:function(e){this.collection.remove(e)},getSelectedUserNos:function(){return this.collection.pluck("userNo")}});return r.EVENT={BAND_MEMBER_DESELECTED:"bandMember:deselected"},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1375),s=n(82);return i.View.extend({tagName:"li",attributes:{"data-viewname":"DSimpleMemberSelectedListItemView"},template:t.template(o),templateContext:function(){var e=s.makeProfileThumbnailUrl(this.model.getProfileImageUrl());return{faceThumb:e,profileInnerClass:s.makeProfileInnerClass(e)}},ui:{btnDeselectMember:"._btnDeselectMember"},events:{"click @ui.btnDeselectMember":function(e){this.model.set({selected:!1}),this.trigger("bandMember:deselected",this.model)}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="uProfile -size40">\n    <span class="profileInner <%- profileInnerClass %>">\n        <% if (!!profileImageUrl) { %><img src="<%- faceThumb %>" width="40" height="40" alt="<%- name %>"><% } %>\n    </span>\n</span>\n<span class="text"><%- name %></span>\n<button type="button" class="delete _btnDeselectMember"><span class="gSrOnly"><%= IM(\'ui.label.del\') %></span></button>'},function(e,t){e.exports='<div class="lyContent -w380">\n\n    <header class="modalHeader">\n        <h1 class="title"><%= title %></h1>\n        <% if (isWatchersMode) { %>\n        <div class="moreMenuWrap">\n            <button class="btnMoreMenu _btnMoreMenu"><%- IM(\'ui.label.more.short\') %></button>\n            <div class="menuBox _menuLayer" style="display:none;">\n                <ul class="menuList">\n                    <li class="menuItem"><button type="button" class="btnMenuText _btnExcelDownload"><%- IM(\'ui.label.excel_download\') %></button></li>\n                    <li class="menuItem"><button type="button" class="btnMenuText _btnPrint"><%- IM(\'ui.label.print\') %></button></li>\n                </ul>\n            </div>\n        </div>\n        <% } %>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gPa0">\n            <% if (isVideoWatcherTabEnabled) { %>\n            <div class="tab">\n                <span class="cell sf_color -on">\n                    <button type="button" class="_btnWatcherList" data-watcher-type="<%= WATCHER_TYPE.LIVE_WATCHER %>"><%= IM(\'live.watcher.tab_name.live_watcher\') %> <span class="sf_color"><%= liveWatcherCount %></span></button>\n                </span>\n                <% if (isVideoWatcherTabEnabled) { %>\n                <span class="cell sf_color">\n                    <button type="button" class="_btnWatcherList" data-watcher-type="<%= WATCHER_TYPE.VIDEO_WATCHER %>"><%= IM(\'live.watcher.tab_name.video_watcher\') %> <span class="sf_color"><%= videoWatcherCount %></span></button>\n                </span>\n                <% } %>\n                <% if (isVideoWatcherTabEnabled && isWatchersMode) { %>\n                <span class="cell sf_color">\n                    <button type="button" class="_btnWatcherList" data-watcher-type="<%= WATCHER_TYPE.NON_WATCHER %>"><%= IM(\'live.watcher.tab_name.non_watcher\') %> <% if (!isBigBand) { %><span class="sf_color"><%= nonWatcherCount %></span><% } %></button>\n                </span>\n                <% } %>\n            </div>\n            <% } %>\n\n            <div class="tabContent gPal20 gPar20 -verticalFlexible -h390">\n                <p class="sDesc -bLine -flexFixed _tabDesc"></p>\n\n                <button type="button" class="_btnChatWithNonWatchers buttonMemberChat -arrow -borderBottom" style="display: none;">\n                    <span class="iconChatPlus"></span>\n                    <span class="text"><%= IM(\'ui.label.chat_with_following_members\') %></span>\n                </button>\n\n                <div class="_watcherListRegion"></div>\n                <p class="sDesc -tLine gPat10 gMab10 _descMaxWatcherCountOver" style="display: none;"></p>\n            </div>\n        </div>\n    </div>\n\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -confirm _btnConfirm"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1378),s=n(486),a={SELECTED:"SELECTED"},r={LIVE_WATCHER:{value:"liveWatcher",label:IM("live.watcher.watcher_type_select.live_watcher")},VIDEO_WATCHER:{value:"videoWatcher",label:IM("live.watcher.watcher_type_select.video_watcher")},NON_WATCHER:{value:"nonWatcher",label:IM("live.watcher.watcher_type_select.non_watcher")}},l=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEndedLiveVideoWatcherTypeSelectView"},template:t.template(o),ui:{checkboxAll:"._checkboxAll",checkbox:"._checkbox",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},events:{"change @ui.checkboxAll":function(){this.ui.checkbox.prop("checked",this.ui.checkboxAll.prop("checked")),this._toggleConfirmBtn()},"change @ui.checkbox":function(){this.ui.checkboxAll.prop("checked",0==this.ui.checkbox.filter(":not(:checked)").length),this._toggleConfirmBtn()},"click @ui.cancelBtn":"_closeSelf","click @ui.confirmBtn":function(){var e=t.map(this.ui.checkbox.filter(":checked").get(),(function(e){return e.value}));this.trigger(a.SELECTED,e),this._closeSelf()}},initialize:function(e){this._checkboxMenus=e.checkboxMenus||[],this._description=e.description},serializeData:function(){return{description:this._description,checkboxes:this._checkboxMenus}},_toggleConfirmBtn:function(){this.ui.confirmBtn.prop("disabled",0==this.ui.checkbox.filter(":checked").length)},_closeSelf:function(){s.closeTop()}});return l.EVENT=a,l.CHECKBOX_MENUS=r,l.openAsLayer=function(e){var t=new l(e);return s.openWithoutHiding(t),t},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent">\n    <header class="header -subDescType">\n        <h1 class="title"><%- IM(\'schedule.rsvp.select_print_item.title\') %></h1>\n        <p class="desc"><%- description %></p>\n    </header>\n\n    <div class="main">\n        <ul class="selectArea">\n            <li>\n                <label for="check_all" class="uCheck -checkbox">\n                    <input type="checkbox" id="check_all" class="checkInput _checkboxAll">\n                    <span class="checkLabel">\n                        <span class="shape"></span>\n                        <span class="text"><%- IM(\'ui.label.all_select\') %></span>\n                    </span>\n                </label>\n            </li>\n            <% _.each(checkboxes, function(checkbox, index) { %>\n            <li>\n                <label for="check_<%- index %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="check_<%- index %>" class="checkInput _checkbox" value="<%- checkbox.value %>">\n                    <span class="checkLabel">\n                        <span class="shape"></span>\n                        <span class="text"><%- checkbox.label %></span>\n                    </span>\n                </label>\n            </li>\n            <% }); %>\n        </ul>\n    </div>\n\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn" disabled><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(82),a=n(1380),r=n(159),l=o.View.extend({className:"multiPhotoBox",attributes:{"data-viewname":"DCommentAttachedMultiplePhotoView"},template:t.template(a),templateContext:function(){return{photos:t.chain(this.options.photos).first(2).map((function(e){return t.extend({},e,{thumbnailUrl:s.make(e.url,s.TYPE.s480)},this)})).value(),moreCount:this.options.photos.length-2}},behaviors:[r],ui:{multiplePhoto:"._multiplePhoto"},events:{"click @ui.multiplePhoto":function(e){var t=i(e.currentTarget).data("photo-index");return this.spawn(r.MSG.COMMENT_OPEN_MEDIA_VIEWER,t),!1}}});return l.buildDCommentAttachedMultiplePhotoView=function(e){return new l({photos:e})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<%\n_.each(photos, function(eachPhoto, photoIndex) {\n%>\n<span class="photoItem">\n    <a href="#" role="button" class="photoItemLink _multiplePhoto" data-photo-index="<%- photoIndex %>"><img src="<%- eachPhoto.thumbnailUrl %>" alt="" class="photoItemImage"></a>\n</span>\n<%\n});\n\nif ( moreCount > 0 ) {\n%>\n<a href="#" role="button" class="photoNum _multiplePhoto" data-photo-index="1">+<%- moreCount %></a>\n<%\n}\n%>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(697),s=n(1051);var a=i.View.extend({options:{noplay:!1,areaWidth:320},tagName:"A",attributes:{"data-viewname":"DCommentAttachedVideoView",role:"button"},className:function(){return this.model.get("isGifVideo")?"photo":"mov"},template:t.template('<span class="_child"></span>'),regions:{child:{el:"._child",replaceElement:!0}},events:{click:function(){return this.trigger("videoPlayer:openMediaViewer"),!1}},childViewTriggers:{"videoPlayer:openMediaViewer":"videoPlayer:openMediaViewer","videoPlayer:play":"videoPlayer:play","videoPlayer:pause":"videoPlayer:pause"},onDomRefresh:function(){Math.max(this.model.getVideoWidth(),this.model.getVideoHeight())<150&&this.$el.addClass("-w150");var e,n,i,a,r,l={model:o.createVideoPlayerModel({videoId:this.model.getVideoId(),sources:this.options.getVideoUrl,expiresAt:this.model.getVideoExpiresAt()}),poster:this.model.getVideoThumbnail(),videoWidth:this.model.getVideoWidth(),videoHeight:this.model.getVideoHeight(),noplay:this.options.noplay};this.model.get("isGifVideo")?(l=t.extend(l,(e=this.model.getVideoWidth(),n=this.model.getVideoHeight(),i=this.options.areaWidth,r=e/n,Math.max(e,n)<150?(a=150/r,{playerWidth:150,playerHeight:Math.min(Math.max(a,50),267)}):r<1.1?(a=230/r,{playerWidth:230,playerHeight:Math.min(a,409)}):(a=i/r,{playerWidth:i,playerHeight:Math.max(a,107)}))),this.showChildView("child",s.buildGifVideoPlayer(l))):(l=t.extend(l,function(e,t,n){var i,o=e/t;return Math.max(e,t)<150?(i=150/o)>=150?{playerWidth:150,playerHeight:Math.min(i,267)}:{playerWidth:150,playerHeight:150,containerHeight:Math.max(i,50)}:o<1.1?(i=230/o,{playerWidth:230,playerHeight:Math.min(i,409)}):(i=n/o)>=150?{playerWidth:n,playerHeight:i}:{playerWidth:n,playerHeight:150,containerHeight:Math.max(i,107)}}(this.model.getVideoWidth(),this.model.getVideoHeight(),this.options.areaWidth)),this.showChildView("child",s.buildThinVideoPlayer(l)))}});return a.buildDCommentAttachedVideoView=function(e,n){return new a(t.extend({},n,{model:e}))},a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% if (isLive) { %>\n<div class="liveState -finished">\n    <span class="liveStateText"><%= IM(\'ui.label.live_end\') %></span>\n</div>\n<% } %>\n\n<% if (!source) { %>\n<div class="mejs-container svg mejs-video"\n     tabindex="0"\n     role="application"\n     aria-label="Video Player">\n    <div class="mejs-inner">\n        <% if (useGaussianblur) { %>\n        <div style="background-image:url(<%=poster%>);" class="gaussianblur" ></div>\n        <% } %>\n        <div class="mejs-layers">\n            <div class="mejs-poster mejs-layer <%-contentClass%>" style="background-image: url(<%=poster%>);<% if(containerHeight) { %>height:<%-containerHeight%>px;<% } %><% if(containerWidth) { %>width:<%-containerWidth%>px;<% } %>"><img width="100%" height="100%" alt="" src="<%=poster%>"></div>\n            <% if (showBigPlay) { %>\n            <div class="mejs-overlay mejs-layer mejs-overlay-play"><button type="button" class="mejs-overlay-button player _btnStartPlay"><span class="gSrOnly"><%= IM(\'web.audioplayer.player.btn.play\') %></span></button></div>\n            <% } %>\n        </div>\n        <% if (showExpired) { %>\n        <a href="#" role="spinbutton" class="uVideoExpired -size60 _btnVideoExpired"><span class="cont"><i></i><span><%= IM(\'storage_period.video.expired.msg\') %></span></span></a>\n        <% } %>\n    </div>\n</div>\n<% } else { %>\n<video\n        preload="none"\n<% if(muted) { %>muted<% } %>\n<% if(loop) { %>loop<% } %>><source\n        src="<%=source%>"\n        type="video/mp4"\n/></video>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=new(n(60))(20);return{registerPlayTime:function(e,n){t.setItem(e,n)},getPlayTime:function(e){return t.getItem(e)},unregisterPlayTime:function(e){t.removeItem(e)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(1257),o=n(157),s=n(0),a=s.template('<div class="mejs-overlay mejs-layer"><div class="mejs-button mejs-band-offvolume-button mejs-unmute"><button type="button" title="<%-IM("mute")%>" aria-label="<%-IM("mute")%>"><%-IM("mute")%></button></div></div>'),r=s.template('<div class="mejs-overlay mejs-layer"></div>');function l(e,n,i){var o=i.container.find(".mejs-overlay-play"),a=t(e),r=!1;a.on("playing",s.bind((function(){r=!1,i.options.alwaysShowControls=!1}),this)),a.on("pause",s.bind((function(){r||(i.options.alwaysShowControls=!0,o.hide())}),this)),a.on("ended",s.bind((function(){r=!0,i.options.alwaysShowControls=!1,o.show(),i.hideControls(!1)}),this))}return function(e){e.extend(i.MepDefaults,{}),e.extend(i.MediaElementPlayer.prototype,{buildbandoffvolume:function(t,n,o,r){var l=e(a());o.before(l);var c=this,d=l.find(".mejs-button"),u=d.find("button"),h=function(){if(r.muted)d.removeClass("mejs-mute -low").addClass("mejs-unmute"),u.text(IM("unmute"));else{var e=i.VOLUME_LEVEL.high.ui,t=i.VOLUME_LEVEL.middle.ui+" "+i.VOLUME_LEVEL.low.ui;r.volume<=i.VOLUME_LEVEL.low.maxVolume?(e=i.VOLUME_LEVEL.low.ui,t=i.VOLUME_LEVEL.high.ui+" "+i.VOLUME_LEVEL.middle.ui):r.volume<=i.VOLUME_LEVEL.middle.maxVolume&&(e=i.VOLUME_LEVEL.middle.ui,t=i.VOLUME_LEVEL.high.ui+" "+i.VOLUME_LEVEL.low.ui),d.removeClass("mejs-unmute").addClass("mejs-mute "+e).removeClass(t),u.text(IM("mute"))}};h(),r.addEventListener("volumechange",h,!1),s.defer((function(){l.click(c.clickToPlayPauseCallback)}))},buildbandpreventvideo:function(t,n,i,o){var a=e(r());i.before(a);var l=this;s.defer((function(){a.click(l.clickToPlayPauseCallback)}))},buildbandpreventoverlay:function(){var t=e(r());this.layers.before(t)}})}(i.$),function(e){e.extend(i.MepDefaults,{bandMediaviewerText:IM("video_player.btn.open_with_mediaviewer")}),e.extend(i.MediaElementPlayer.prototype,{buildbandmediaviewer:function(t,n,i,o){if(t.isVideo){var s=this;e('<div class="mejs-button mejs-band-mediaviewer-button"><button type="button" aria-controls="'+s.id+'" title="'+s.options.bandMediaviewerText+'" aria-label="'+s.options.bandMediaviewerText+'"></button></div>').appendTo(n).on("click",(function(){s.container.trigger("mediaviewer:open")}))}}})}(i.$),function(e){e.extend(i.MepDefaults,{bandSettingText:IM("video_player.btn.player_setting"),bandSettingUrl:o.GLOBAL_SETTING.makeUrl({},{detail:"video_play"})}),e.extend(i.MediaElementPlayer.prototype,{buildbandsetting:function(t,n,i,o){if(t.isVideo){var s=this,a=e('<ul class="band-setting-list"><li class="band-setting-item"><a href="'+s.options.bandSettingUrl+'" class="band-setting-link">'+IM("video_player.btn.video_play_setting")+"</a></li></ul>").click((function(){window.open(s.options.bandSettingUrl)}));e('<div class="mejs-button mejs-band-setting-button"><button type="button" aria-controls="'+s.id+'" title="'+s.options.bandSettingText+'" aria-label="'+s.options.bandSettingText+'"></button></div>').appendTo(n).append(a).find("BUTTON").on("click",(function(){a.toggleClass("active")}))}}})}(i.$),function(e){e.extend(i.MepDefaults,{}),e.extend(i.MediaElementPlayer.prototype,{buildbandbackground:function(e,t,n,i){if(e.isVideo){this.container.find(".mejs-inner").prepend('<div style="background-image:url('+this.options.poster+');" class="gaussianblur" ></div>')}}})}(i.$),function(e){e.extend(i.MediaElementPlayer.prototype,{bandcleanup:function(e,t,n,o){var s,a,r=this;for(s in r.container.prev(".mejs-offscreen").remove(),r.options.features)if(r["clean"+(a=r.options.features[s])])try{r["clean"+a](r)}catch(e){}"native"!==r.media.pluginType&&r.media.remove(),delete i.players[r.id],"object"==typeof r.container&&r.container.remove(),r.globalUnbind(),delete r.node.player}})}(i.$),function(e){e.extend(i.MediaElementPlayer.prototype,{buildhighquality:function(t,n,i,o){if(t.isVideo){var s=this,a=IM("ui.label.high_quality"),r='<button type="button" aria-controls="'+s.id+'" title="'+a+'" aria-label="'+a+'">'+a+"</button>",l=s.options.isHighQuality?"":" -off";e('<div class="mejs-button mejs-high-quality-button'+l+'">'+r+"</div>").appendTo(n).on("click",(function(){s.container.trigger("highquality:click")}))}}})}(i.$),{static:function(e,t){var n=t.disabledKeys,i=t.seekInterval,o=t.startVolume,a={pluginPath:"/script/_libs/mediaelement/",fullscreenText:IM("full_screen"),fullscreenCancelText:IM("close_full_screen"),playText:IM("web.audioplayer.player.btn.play"),pauseText:IM("pause"),muteText:IM("mute"),unmuteText:IM("unmute"),setDimensions:!1,enableAutosize:!1,hideVideoControlsOnLoad:!0,pauseOtherPlayers:!1,poster:t.poster,features:t.useControl?t.features:["bandpreventoverlay"],clickToPlayPause:t.useControl,enableKeyboard:t.enableKeyboard,isHighQuality:t.isHighQuality,success:function(e,n,i){t.useControl&&l(e,0,i),t.success.apply(this,arguments)}};s.isArray(n)&&!s.isEmpty(n)&&(a.disabledKeys=n),s.isNumber(i)&&i>0&&(a.defaultSeekBackwardInterval=function(){return i},a.defaultSeekForwardInterval=function(){return i}),s.isNumber(o)&&o>=0&&(a.startVolume=o),e.mediaelementplayer(a)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t){var n=n||{};n.version="2.21.2",n.meIndex=0,n.plugins={silverlight:[{version:[3,0],types:["video/mp4","video/m4v","video/mov","video/wmv","audio/wma","audio/m4a","audio/mp3","audio/wav","audio/mpeg"]}],flash:[{version:[9,0,124],types:["video/mp4","video/m4v","video/mov","video/flv","video/rtmp","video/x-flv","audio/flv","audio/x-flv","audio/mp3","audio/m4a","audio/mpeg","video/dailymotion","video/x-dailymotion","application/x-mpegURL"]}],youtube:[{version:null,types:["video/youtube","video/x-youtube","audio/youtube","audio/x-youtube"]}],vimeo:[{version:null,types:["video/vimeo","video/x-vimeo"]}]},n.VOLUME_LEVEL={low:{maxVolume:.3,ui:"-low"},middle:{maxVolume:.6,ui:"-mid"},high:{maxVolume:1,ui:"-high"}},n.Utility={encodeUrl:function(e){return encodeURIComponent(e)},escapeHTML:function(e){return e.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},absolutizeUrl:function(e){var t=document.createElement("div");return t.innerHTML='<a href="'+this.escapeHTML(e)+'">x</a>',t.firstChild.href},getScriptPath:function(e){for(var t,n,i,o,s,a=0,r="",l="",c=document.getElementsByTagName("script"),d=c.length,u=e.length;a<d;a++){for((n=(i=c[a].src).lastIndexOf("/"))>-1?(s=i.substring(n+1),o=i.substring(0,n+1)):(s=i,o=""),t=0;t<u;t++)if(l=e[t],s.indexOf(l)>-1){r=o;break}if(""!==r)break}return r},calculateTimeFormat:function(e,t,n){e<0&&(e=0),void 0===n&&(n=25);var i=t.timeFormat,o=i[0],s=i[1]==i[0],a=s?2:1,r=":",l=Math.floor(e/3600)%24,c=Math.floor(e/60)%60,d=Math.floor(e%60),u=[[Math.floor((e%1*n).toFixed(3)),"f"],[d,"s"],[c,"m"],[l,"h"]];i.length<a&&(r=i[a]);for(var h=!1,p=0,m=u.length;p<m;p++)if(-1!==i.indexOf(u[p][1]))h=!0;else if(h){for(var _=!1,g=p;g<m;g++)if(u[g][0]>0){_=!0;break}if(!_)break;s||(i=o+i),i=u[p][1]+r+i,s&&(i=u[p][1]+i),o=u[p][1]}t.currentTimeFormat=i},twoDigitsString:function(e){return e<10?"0"+e:String(e)},secondsToTimeCode:function(e,t){if(e<0&&(e=0),"object"!=typeof t){var n="m:ss";n=arguments[1]?"hh:mm:ss":n,t={currentTimeFormat:n=arguments[2]?n+":ff":n,framesPerSecond:arguments[3]||25}}var o=t.framesPerSecond;void 0===o&&(o=25);n=t.currentTimeFormat;var s=Math.floor(e/3600)%24,a=Math.floor(e/60)%60,r=Math.floor(e%60),l=Math.floor((e%1*o).toFixed(3));lis=[[l,"f"],[r,"s"],[a,"m"],[s,"h"]];var c=n;for(i=0,len=lis.length;i<len;i++)c=(c=c.replace(lis[i][1]+lis[i][1],this.twoDigitsString(lis[i][0]))).replace(lis[i][1],lis[i][0]);return c},timeCodeToSeconds:function(e,t,n,i){void 0===n?n=!1:void 0===i&&(i=25);var o=e.split(":"),s=parseInt(o[0],10),a=parseInt(o[1],10),r=parseInt(o[2],10),l=0;return n&&(l=parseInt(o[3])/i),3600*s+60*a+r+l},convertSMPTEtoSeconds:function(e){if("string"!=typeof e)return!1;var t=0,n=-1!=(e=e.replace(",",".")).indexOf(".")?e.split(".")[1].length:0,i=1;e=e.split(":").reverse();for(var o=0;o<e.length;o++)i=1,o>0&&(i=Math.pow(60,o)),t+=Number(e[o])*i;return Number(t.toFixed(n))},removeSwf:function(e){var t=document.getElementById(e);t&&/object|embed/i.test(t.nodeName)&&(n.MediaFeatures.isIE?(t.style.display="none",function(){4==t.readyState?n.Utility.removeObjectInIE(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))},removeObjectInIE:function(e){var t=document.getElementById(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}},determineScheme:function(e){return e&&-1!=e.indexOf("://")?e.substr(0,e.indexOf("://")+3):"//"}},n.PluginDetector={hasPluginVersion:function(e,t){var n=this.plugins[e];return t[1]=t[1]||0,t[2]=t[2]||0,n[0]>t[0]||n[0]==t[0]&&n[1]>t[1]||n[0]==t[0]&&n[1]==t[1]&&n[2]>=t[2]},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(e,t,n,i,o){this.plugins[e]=this.detectPlugin(t,n,i,o)},detectPlugin:function(e,t,n,i){var o,s,a,r=[0,0,0];if(void 0!==this.nav.plugins&&"object"==typeof this.nav.plugins[e]){if((o=this.nav.plugins[e].description)&&(void 0===this.nav.mimeTypes||!this.nav.mimeTypes[t]||this.nav.mimeTypes[t].enabledPlugin))for(r=o.replace(e,"").replace(/^\s+/,"").replace(/\sr/gi,".").split("."),s=0;s<r.length;s++)r[s]=parseInt(r[s].match(/\d+/),10)}else if(void 0!==window.ActiveXObject)try{(a=new ActiveXObject(n))&&(r=i(a))}catch(e){}return r}},n.PluginDetector.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",(function(e){var t=[],n=e.GetVariable("$version");return n&&(n=n.split(" ")[1].split(","),t=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)]),t})),n.PluginDetector.addPlugin("silverlight","Silverlight Plug-In","application/x-silverlight-2","AgControl.AgControl",(function(e){var t=[0,0,0,0],n=function(e,t,n,i){for(;e.isVersionSupported(t[0]+"."+t[1]+"."+t[2]+"."+t[3]);)t[n]+=i;t[n]-=i};return n(e,t,0,1),n(e,t,1,1),n(e,t,2,1e4),n(e,t,2,1e3),n(e,t,2,100),n(e,t,2,10),n(e,t,2,1),n(e,t,3,1),t})),n.MediaFeatures={init:function(){var e,t,i,o,s,a,r=this,l=document,c=n.PluginDetector.nav,d=n.PluginDetector.ua.toLowerCase(),u=["source","track","audio","video"];r.isiPad=null!==d.match(/ipad/i),r.isiPhone=null!==d.match(/iphone/i),r.isiOS=r.isiPhone||r.isiPad,r.isAndroid=null!==d.match(/android/i),r.isBustedAndroid=null!==d.match(/android 2\.[12]/),r.isBustedNativeHTTPS="https:"===location.protocol&&(null!==d.match(/android [12]\./)||null!==d.match(/macintosh.* version.* safari/)),r.isIE=-1!=c.appName.toLowerCase().indexOf("microsoft")||null!==c.appName.toLowerCase().match(/trident/gi),r.isChrome=null!==d.match(/chrome/gi),r.isChromium=null!==d.match(/chromium/gi),r.isFirefox=null!==d.match(/firefox/gi),r.isWebkit=null!==d.match(/webkit/gi),r.isGecko=null!==d.match(/gecko/gi)&&!r.isWebkit&&!r.isIE,r.isOpera=null!==d.match(/opera/gi),r.hasTouch="ontouchstart"in window,r.svgAsImg=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1");for(e=0;e<u.length;e++)t=document.createElement(u[e]);r.supportsMediaTag=void 0!==t.canPlayType||r.isBustedAndroid;try{t.canPlayType("video/mp4")}catch(e){r.supportsMediaTag=!1}r.supportsPointerEvents=(o=document.createElement("x"),s=document.documentElement,a=window.getComputedStyle,"pointerEvents"in o.style&&(o.style.pointerEvents="auto",o.style.pointerEvents="x",s.appendChild(o),i=a&&"auto"===a(o,"").pointerEvents,s.removeChild(o),!!i)),r.hasFirefoxPluginMovingProblem=!1,r.hasiOSFullScreen=void 0!==t.webkitEnterFullscreen,r.hasNativeFullscreen=void 0!==t.requestFullscreen,r.hasWebkitNativeFullScreen=void 0!==t.webkitRequestFullScreen,r.hasMozNativeFullScreen=void 0!==t.mozRequestFullScreen,r.hasMsNativeFullScreen=void 0!==t.msRequestFullscreen,r.hasTrueNativeFullScreen=r.hasWebkitNativeFullScreen||r.hasMozNativeFullScreen||r.hasMsNativeFullScreen,r.nativeFullScreenEnabled=r.hasTrueNativeFullScreen,r.hasMozNativeFullScreen?r.nativeFullScreenEnabled=document.mozFullScreenEnabled:r.hasMsNativeFullScreen&&(r.nativeFullScreenEnabled=document.msFullscreenEnabled),r.isChrome&&(r.hasiOSFullScreen=!1),r.hasTrueNativeFullScreen&&(r.fullScreenEventName="",r.hasWebkitNativeFullScreen?r.fullScreenEventName="webkitfullscreenchange":r.hasMozNativeFullScreen?r.fullScreenEventName="mozfullscreenchange":r.hasMsNativeFullScreen&&(r.fullScreenEventName="MSFullscreenChange"),r.isFullScreen=function(){return r.hasMozNativeFullScreen?l.mozFullScreen:r.hasWebkitNativeFullScreen?l.webkitIsFullScreen:r.hasMsNativeFullScreen?null!==l.msFullscreenElement:void 0},r.requestFullScreen=function(e){r.hasWebkitNativeFullScreen?e.webkitRequestFullScreen():r.hasMozNativeFullScreen?e.mozRequestFullScreen():r.hasMsNativeFullScreen&&e.msRequestFullscreen()},r.cancelFullScreen=function(){r.hasWebkitNativeFullScreen?document.webkitCancelFullScreen():r.hasMozNativeFullScreen?document.mozCancelFullScreen():r.hasMsNativeFullScreen&&document.msExitFullscreen()}),r.hasiOSFullScreen&&d.match(/mac os x 10_5/i)&&(r.hasNativeFullScreen=!1,r.hasiOSFullScreen=!1)}},n.MediaFeatures.init(),n.HtmlMediaElement={pluginType:"native",isFullScreen:!1,setCurrentTime:function(e){this.currentTime=e},setMuted:function(e){this.muted=e},setVolume:function(e){this.volume=e},stop:function(){this.pause()},setSrc:function(e){for(var t,n,i=this.getElementsByTagName("source");i.length>0;)this.removeChild(i[0]);if("string"==typeof e)this.src=e;else for(t=0;t<e.length;t++)if(n=e[t],this.canPlayType(n.type)){this.src=n.src;break}},setVideoSize:function(e,t){this.width=e,this.height=t}},n.PluginMediaElement=function(e,t,n){this.id=e,this.pluginType=t,this.src=n,this.events={},this.attributes={}},n.PluginMediaElement.prototype={pluginElement:null,pluginType:"",isFullScreen:!1,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:!0,ended:!1,seeking:!1,duration:0,error:null,tagName:"",muted:!1,volume:1,currentTime:0,play:function(){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType?this.pluginApi.playVideo():this.pluginApi.playMedia(),this.paused=!1)},load:function(){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType||this.pluginApi.loadMedia(),this.paused=!1)},pause:function(){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType?1==this.pluginApi.getPlayerState()&&this.pluginApi.pauseVideo():this.pluginApi.pauseMedia(),this.paused=!0)},stop:function(){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType?this.pluginApi.stopVideo():this.pluginApi.stopMedia(),this.paused=!0)},canPlayType:function(e){var t,i,o,s=n.plugins[this.pluginType];for(t=0;t<s.length;t++)if(o=s[t],n.PluginDetector.hasPluginVersion(this.pluginType,o.version))for(i=0;i<o.types.length;i++)if(e==o.types[i])return"probably";return""},positionFullscreenButton:function(e,t,n){null!=this.pluginApi&&this.pluginApi.positionFullscreenButton&&this.pluginApi.positionFullscreenButton(Math.floor(e),Math.floor(t),n)},hideFullscreenButton:function(){null!=this.pluginApi&&this.pluginApi.hideFullscreenButton&&this.pluginApi.hideFullscreenButton()},setSrc:function(e){var t,i;if("string"==typeof e)this.pluginApi.setSrc(n.Utility.absolutizeUrl(e)),this.src=n.Utility.absolutizeUrl(e);else for(t=0;t<e.length;t++)if(i=e[t],this.canPlayType(i.type)){this.pluginApi.setSrc(n.Utility.absolutizeUrl(i.src)),this.src=n.Utility.absolutizeUrl(i.src);break}},setCurrentTime:function(e){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType?this.pluginApi.seekTo(e):this.pluginApi.setCurrentTime(e),this.currentTime=e)},setVolume:function(e){console.log("setVolume",e),null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.setVolume(100*e):this.pluginApi.setVolume(e),this.volume=e)},setMuted:function(e){null!=this.pluginApi&&("youtube"==this.pluginType?(e?this.pluginApi.mute():this.pluginApi.unMute(),this.muted=e,this.dispatchEvent({type:"volumechange"})):this.pluginApi.setMuted(e),this.muted=e)},setVideoSize:function(e,t){this.pluginElement&&this.pluginElement.style&&(this.pluginElement.style.width=e+"px",this.pluginElement.style.height=t+"px"),null!=this.pluginApi&&this.pluginApi.setVideoSize&&this.pluginApi.setVideoSize(e,t)},setFullscreen:function(e){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.pluginApi.setFullscreen(e)},enterFullScreen:function(){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.setFullscreen(!0)},exitFullScreen:function(){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.setFullscreen(!1)},addEventListener:function(e,t,n){this.events[e]=this.events[e]||[],this.events[e].push(t)},removeEventListener:function(e,t){if(!e)return this.events={},!0;var n=this.events[e];if(!n)return!0;if(!t)return this.events[e]=[],!0;for(var i=0;i<n.length;i++)if(n[i]===t)return this.events[e].splice(i,1),!0;return!1},dispatchEvent:function(e){var t,n=this.events[e.type];if(n)for(t=0;t<n.length;t++)n[t].apply(this,[e])},hasAttribute:function(e){return e in this.attributes},removeAttribute:function(e){delete this.attributes[e]},getAttribute:function(e){return this.hasAttribute(e)?this.attributes[e]:""},setAttribute:function(e,t){this.attributes[e]=t},remove:function(){n.Utility.removeSwf(this.pluginElement.id)}},n.MediaElementDefaults={mode:"auto",plugins:["flash","silverlight","youtube","vimeo"],enablePluginDebug:!1,httpsBasicAuthSite:!1,type:"",pluginPath:n.Utility.getScriptPath(["mediaelement.js","mediaelement.min.js","mediaelement-and-player.js","mediaelement-and-player_dCustom.js"]),flashName:"flashmediaelement.swf",flashStreamer:"",flashScriptAccess:"sameDomain",enablePluginSmoothing:!1,enablePseudoStreaming:!1,pseudoStreamingStartQueryParam:"start",silverlightName:"silverlightmediaelement.xap",defaultVideoWidth:480,defaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,pluginVars:[],timerRate:250,startVolume:.8,success:function(){},error:function(){}},n.MediaElement=function(e,t){return n.HtmlMediaElementShim.create(e,t)},n.HtmlMediaElementShim={create:function(e,t){var i,o,s={},a="string"==typeof e?document.getElementById(e):e,r=a.tagName.toLowerCase(),l="audio"===r||"video"===r,c=l?a.getAttribute("src"):a.getAttribute("href"),d=a.getAttribute("poster"),u=a.getAttribute("autoplay"),h=a.getAttribute("preload"),p=a.getAttribute("controls");for(o in n.MediaElementDefaults)s[o]=n.MediaElementDefaults[o];for(o in t)s[o]=t[o];return c=null==c||""==c?null:c,d=null==d?"":d,h=null==h||"false"===h?"none":h,u=!(null==u||"false"===u),p=!(null==p||"false"===p),(i=this.determinePlayback(a,s,n.MediaFeatures.supportsMediaTag,l,c)).url=null!==i.url?n.Utility.absolutizeUrl(i.url):"",i.scheme=n.Utility.determineScheme(i.url),"native"==i.method?(n.MediaFeatures.isBustedAndroid&&(a.src=i.url,a.addEventListener("click",(function(){a.play()}),!1)),this.updateNative(i,s,u,h)):""!==i.method?this.createPlugin(i,s,d,u,h,p):(this.createErrorMessage(i,s,d),this)},determinePlayback:function(e,t,i,o,s){var a,r,l,c,d,u,h,p,m,_,g,f=[],b={method:"",url:"",htmlMediaElement:e,isVideo:"audio"!=e.tagName.toLowerCase(),scheme:""};if(void 0!==t.type&&""!==t.type)if("string"==typeof t.type)f.push({type:t.type,url:s});else for(a=0;a<t.type.length;a++)f.push({type:t.type[a],url:s});else if(null!==s)u=this.formatType(s,e.getAttribute("type")),f.push({type:u,url:s});else for(a=0;a<e.childNodes.length;a++)1==(d=e.childNodes[a]).nodeType&&"source"==d.tagName.toLowerCase()&&(s=d.getAttribute("src"),u=this.formatType(s,d.getAttribute("type")),(!(g=d.getAttribute("media"))||!window.matchMedia||window.matchMedia&&window.matchMedia(g).matches)&&f.push({type:u,url:s}));if(!o&&f.length>0&&null!==f[0].url&&this.getTypeFromFile(f[0].url).indexOf("audio")>-1&&(b.isVideo=!1),n.MediaFeatures.isBustedAndroid&&(e.canPlayType=function(e){return null!==e.match(/video\/(mp4|m4v)/gi)?"maybe":""}),n.MediaFeatures.isChromium&&(e.canPlayType=function(e){return null!==e.match(/video\/(webm|ogv|ogg)/gi)?"maybe":""}),i&&("auto"===t.mode||"auto_plugin"===t.mode||"native"===t.mode)&&(!n.MediaFeatures.isBustedNativeHTTPS||!0!==t.httpsBasicAuthSite)){for(o||(_=document.createElement(b.isVideo?"video":"audio"),e.parentNode.insertBefore(_,e),e.style.display="none",b.htmlMediaElement=e=_),a=0;a<f.length;a++)if("video/m3u8"==f[a].type||""!==e.canPlayType(f[a].type).replace(/no/,"")||""!==e.canPlayType(f[a].type.replace(/mp3/,"mpeg")).replace(/no/,"")||""!==e.canPlayType(f[a].type.replace(/m4a/,"mp4")).replace(/no/,"")){b.method="native",b.url=f[a].url;break}if("native"===b.method&&(null!==b.url&&(e.src=b.url),"auto_plugin"!==t.mode))return b}if("auto"===t.mode||"auto_plugin"===t.mode||"shim"===t.mode)for(a=0;a<f.length;a++)for(u=f[a].type,r=0;r<t.plugins.length;r++)for(h=t.plugins[r],p=n.plugins[h],l=0;l<p.length;l++)if(null==(m=p[l]).version||n.PluginDetector.hasPluginVersion(h,m.version))for(c=0;c<m.types.length;c++)if(u.toLowerCase()==m.types[c].toLowerCase())return b.method=h,b.url=f[a].url,b;return"auto_plugin"===t.mode&&"native"===b.method||""===b.method&&f.length>0&&(b.url=f[0].url),b},formatType:function(e,t){return e&&!t?this.getTypeFromFile(e):t&&~t.indexOf(";")?t.substr(0,t.indexOf(";")):t},getTypeFromFile:function(e){var t=(e=e.split("?")[0]).substring(e.lastIndexOf(".")+1).toLowerCase(),n=/(mp4|m4v|ogg|ogv|m3u8|webm|webmv|flv|wmv|mpeg|mov)/gi.test(t)?"video/":"audio/";return this.getTypeFromExtension(t,n)},getTypeFromExtension:function(e,t){switch(t=t||"",e){case"mp4":case"m4v":case"m4a":case"f4v":case"f4a":return t+"mp4";case"flv":return t+"x-flv";case"webm":case"webma":case"webmv":return t+"webm";case"ogg":case"oga":case"ogv":return t+"ogg";case"m3u8":return"application/x-mpegurl";case"ts":return t+"mp2t";default:return t+e}},createErrorMessage:function(e,t,i){var o=e.htmlMediaElement,s=document.createElement("div"),a=t.customError;s.className="me-cannotplay";try{s.style.width=o.width+"px",s.style.height=o.height+"px"}catch(e){}a||(a='<a href="'+e.url+'">',""!==i&&(a+='<img src="'+i+'" width="100%" height="100%" alt="" />'),a+="<span>"+n.i18n.t("Download File")+"</span></a>"),s.innerHTML=a,o.parentNode.insertBefore(s,o),o.style.display="none",t.error(o)},createPlugin:function(e,t,i,o,s,a){var r,l,c,d=e.htmlMediaElement,u=1,h=1,p="me_"+e.method+"_"+n.meIndex++,m=new n.PluginMediaElement(p,e.method,e.url),_=document.createElement("div");m.tagName=d.tagName;for(var g=0;g<d.attributes.length;g++){var f=d.attributes[g];f.specified&&m.setAttribute(f.name,f.value)}for(l=d.parentNode;null!==l&&null!=l.tagName&&"body"!==l.tagName.toLowerCase()&&null!=l.parentNode&&null!=l.parentNode.tagName&&null!=l.parentNode.constructor&&"ShadowRoot"===l.parentNode.constructor.name;){if("p"===l.parentNode.tagName.toLowerCase()){l.parentNode.parentNode.insertBefore(l,l.parentNode);break}l=l.parentNode}switch(e.isVideo?(u=parseInt(t.pluginWidth,10)>0?t.pluginWidth:t.videoWidth>0?t.videoWidth:null!==d.getAttribute("width")?d.getAttribute("width"):t.defaultVideoWidth,h=parseInt(t.pluginHeight,10)>0?t.pluginHeight:t.videoHeight>0?t.videoHeight:null!==d.getAttribute("height")?d.getAttribute("height"):t.defaultVideoHeight,u=n.Utility.encodeUrl(u),h=n.Utility.encodeUrl(h)):t.enablePluginDebug&&(u=320,h=240),m.success=t.success,m.youtubeBlocked=t.youtubeBlocked,_.className="me-plugin",_.id=p+"_container",e.isVideo?d.parentNode.insertBefore(_,d):document.body.insertBefore(_,document.body.childNodes[0]),"flash"!==e.method&&"silverlight"!==e.method||(c=["id="+p,"isvideo="+(e.isVideo?"true":"false"),"autoplay="+(o?"true":"false"),"preload="+s,"width="+u,"startvolume="+t.startVolume,"timerrate="+t.timerRate,"flashstreamer="+t.flashStreamer,"height="+h,"pseudostreamstart="+t.pseudoStreamingStartQueryParam],null!==e.url&&("flash"==e.method?c.push("file="+n.Utility.encodeUrl(e.url)):c.push("file="+e.url)),t.enablePluginDebug&&c.push("debug=true"),t.enablePluginSmoothing&&c.push("smoothing=true"),t.enablePseudoStreaming&&c.push("pseudostreaming=true"),a&&c.push("controls=true"),t.pluginVars&&(c=c.concat(t.pluginVars)),window[p+"_init"]=function(){switch(m.pluginType){case"flash":m.pluginElement=m.pluginApi=document.getElementById(p);break;case"silverlight":m.pluginElement=document.getElementById(m.id),m.pluginApi=m.pluginElement.Content.MediaElementJS}null!=m.pluginApi&&m.success&&m.success(m,d)},window[p+"_event"]=function(e,t){var n,i,o;for(i in n={type:e,target:m},t)m[i]=t[i],n[i]=t[i];o=t.bufferedTime||0,n.target.buffered=n.buffered={start:function(e){return 0},end:function(e){return o},length:1},m.dispatchEvent(n)}),e.method){case"silverlight":_.innerHTML='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="'+p+'" name="'+p+'" width="'+u+'" height="'+h+'" class="mejs-shim"><param name="initParams" value="'+c.join(",")+'" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="'+t.pluginPath+t.silverlightName+'" /></object>';break;case"flash":n.MediaFeatures.isIE?(r=document.createElement("div"),_.appendChild(r),r.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+p+'" width="'+u+'" height="'+h+'" class="mejs-shim"><param name="movie" value="'+t.pluginPath+t.flashName+"?"+(new Date).getTime()+'" /><param name="flashvars" value="'+c.join("&amp;")+'" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="'+t.flashScriptAccess+'" /><param name="allowFullScreen" value="true" /><param name="scale" value="default" /></object>'):_.innerHTML='<embed id="'+p+'" name="'+p+'" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="'+t.flashScriptAccess+'" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" src="'+t.pluginPath+t.flashName+'" flashvars="'+c.join("&")+'" width="'+u+'" height="'+h+'" scale="default"class="mejs-shim"></embed>';break;case"youtube":var b=this.extractVideoId(e.url);youtubeSettings={container:_,containerId:_.id,pluginMediaElement:m,pluginId:p,videoId:b,height:h,width:u,scheme:e.scheme,useYoutubeControls:t.useYoutubeControls},window.postMessage?n.YouTubeApi.enqueueIframe(youtubeSettings):n.PluginDetector.hasPluginVersion("flash",[10,0,0])&&n.YouTubeApi.createFlash(youtubeSettings,t);break;case"vimeo":var v=p+"_player";if(m.vimeoid=e.url.substr(e.url.lastIndexOf("/")+1),_.innerHTML='<iframe src="'+e.scheme+"player.vimeo.com/video/"+m.vimeoid+"?api=1&portrait=0&byline=0&title=0&player_id="+v+'" width="'+u+'" height="'+h+'" frameborder="0" class="mejs-shim" id="'+v+'" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',"function"==typeof $f){var A=$f(_.childNodes[0]),E=-1;A.addEvent("ready",(function(){function e(e,t,n,i){var o={type:n,target:t};"timeupdate"==n&&(t.currentTime=o.currentTime=i.seconds,t.duration=o.duration=i.duration),t.dispatchEvent(o)}A.playVideo=function(){A.api("play")},A.stopVideo=function(){A.api("unload")},A.pauseVideo=function(){A.api("pause")},A.seekTo=function(e){A.api("seekTo",e)},A.setVolume=function(e){A.api("setVolume",e)},A.setMuted=function(e){e?(A.lastVolume=A.api("getVolume"),A.api("setVolume",0)):(A.api("setVolume",A.lastVolume),delete A.lastVolume)},A.getPlayerState=function(){return E},A.addEvent("play",(function(){E=1,e(0,m,"play"),e(0,m,"playing")})),A.addEvent("pause",(function(){E=2,e(0,m,"pause")})),A.addEvent("finish",(function(){E=0,e(0,m,"ended")})),A.addEvent("playProgress",(function(t){e(0,m,"timeupdate",t)})),A.addEvent("seek",(function(t){E=3,e(0,m,"seeked",t)})),A.addEvent("loadProgress",(function(t){E=3,e(0,m,"progress",t)})),m.pluginElement=_,m.pluginApi=A,m.success(m,m.pluginElement)}))}else console.warn("You need to include froogaloop for vimeo to work")}return d.style.display="none",d.removeAttribute("autoplay"),m},extractVideoId:function(e){var t;return-1==e.lastIndexOf("youtu.be")?this.extractVideoIdFromQSV(e):(null!=(t=this.extractVideoIdFromQSV(e))||-1!=(t=e.substr(e.lastIndexOf("/")+1)).indexOf("?")&&(t=t.substr(0,t.indexOf("?"))),t)},extractVideoIdFromQSV:function(e){var t=e.match(/[?&]v=([^&#]+)|&|#|$/);return t?t[1]:null},updateNative:function(e,t,i,o){var s,a=e.htmlMediaElement;for(s in n.HtmlMediaElement)a[s]=n.HtmlMediaElement[s];return t.success(a,a),a}},n.YouTubeApi={isIframeStarted:!1,isIframeLoaded:!1,loadIframeApi:function(e){if(!this.isIframeStarted){var t=document.createElement("script");t.src=e.scheme+"www.youtube.com/player_api";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),this.isIframeStarted=!0}},iframeQueue:[],enqueueIframe:function(e){this.isLoaded?this.createIframe(e):(this.loadIframeApi(e),this.iframeQueue.push(e))},createIframe:function(e){var t=e.pluginMediaElement,i=new YT.Player(e.containerId,{height:e.height,width:e.width,videoId:e.videoId,playerVars:{controls:1,wmode:"transparent"},events:{onReady:function(){i.setVideoSize=function(e,t){i.setSize(e,t)},e.pluginMediaElement.pluginApi=i,e.pluginMediaElement.pluginElement=document.getElementById(e.containerId),t.success(t,t.pluginElement),setInterval((function(){n.YouTubeApi.createEvent(i,t,"timeupdate")}),250)},onStateChange:function(e){n.YouTubeApi.handleStateChange(e.data,i,t)},onError:function(e){!e||101!=e.data&&150!=e.data&&2!=e.data||t.youtubeBlocked()}}})},createEvent:function(e,t,n){var i={type:n,target:t};if(e&&e.getDuration){t.currentTime=i.currentTime=e.getCurrentTime(),t.duration=i.duration=e.getDuration(),i.paused=t.paused,i.ended=t.ended,i.muted=e.isMuted(),i.volume=e.getVolume()/100,i.bytesTotal=e.getVideoBytesTotal(),i.bufferedBytes=e.getVideoBytesLoaded();var o=i.bufferedBytes/i.bytesTotal*i.duration;i.target.buffered=i.buffered={start:function(e){return 0},end:function(e){return o},length:1}}t.dispatchEvent(i)},iFrameReady:function(){for(this.isLoaded=!0,this.isIframeLoaded=!0;this.iframeQueue.length>0;){var e=this.iframeQueue.pop();this.createIframe(e)}},flashPlayers:{},createFlash:function(e){this.flashPlayers[e.pluginId]=e;var t,i=e.scheme+"www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid="+e.pluginId+"&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0";n.MediaFeatures.isIE?(t=document.createElement("div"),e.container.appendChild(t),t.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+e.scheme+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+e.pluginId+'" width="'+e.width+'" height="'+e.height+'" class="mejs-shim"><param name="movie" value="'+i+'" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="'+options.flashScriptAccess+'" /><param name="allowFullScreen" value="true" /></object>'):e.container.innerHTML='<object type="application/x-shockwave-flash" id="'+e.pluginId+'" data="'+i+'" width="'+e.width+'" height="'+e.height+'" style="visibility: visible; " class="mejs-shim"><param name="allowScriptAccess" value="'+options.flashScriptAccess+'"><param name="wmode" value="transparent"></object>'},flashReady:function(e){var t=this.flashPlayers[e],i=document.getElementById(e),o=t.pluginMediaElement;o.pluginApi=o.pluginElement=i,t.success(o,o.pluginElement),i.cueVideoById(t.videoId);var s=t.containerId+"_callback";window[s]=function(e){n.YouTubeApi.handleStateChange(e,i,o)},i.addEventListener("onStateChange",s),setInterval((function(){n.YouTubeApi.createEvent(i,o,"timeupdate")}),250),n.YouTubeApi.createEvent(i,o,"canplay")},handleStateChange:function(e,t,i){switch(e){case-1:i.paused=!0,i.ended=!0,n.YouTubeApi.createEvent(t,i,"loadedmetadata");break;case 0:i.paused=!1,i.ended=!0,n.YouTubeApi.createEvent(t,i,"ended");break;case 1:i.paused=!1,i.ended=!1,n.YouTubeApi.createEvent(t,i,"play"),n.YouTubeApi.createEvent(t,i,"playing");break;case 2:i.paused=!0,i.ended=!1,n.YouTubeApi.createEvent(t,i,"pause");break;case 3:n.YouTubeApi.createEvent(t,i,"progress")}}},window.onYouTubePlayerAPIReady=function(){n.YouTubeApi.iFrameReady()},window.onYouTubePlayerReady=function(e){n.YouTubeApi.flashReady(e)},window.mejs=n,window.MediaElement=n.MediaElement,function(e,t,n){"use strict";var i={locale:{language:t.i18n&&t.i18n.locale.language||"",strings:t.i18n&&t.i18n.locale.strings||{}},ietf_lang_regex:/^(x\-)?[a-z]{2,}(\-\w{2,})?(\-\w{2,})?$/,methods:{},getLanguage:function(){var e=i.locale.language||window.navigator.userLanguage||window.navigator.language;return i.ietf_lang_regex.exec(e)?e:null}};"undefined"!=typeof mejsL10n&&(i.locale.language=mejsL10n.language),i.methods.checkPlain=function(e){var t,n,i={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};for(t in e=String(e),i)i.hasOwnProperty(t)&&(n=new RegExp(t,"g"),e=e.replace(n,i[t]));return e},i.methods.t=function(e,t){return i.locale.strings&&i.locale.strings[t.context]&&i.locale.strings[t.context][e]&&(e=i.locale.strings[t.context][e]),i.methods.checkPlain(e)},i.t=function(e,t){if("string"==typeof e&&e.length>0){var n=i.getLanguage();return t=t||{context:n},i.methods.t(e,t)}throw{name:"InvalidArgumentException",message:"First argument is either not a string or empty."}},t.i18n=i}(document,n),function(e,t){"use strict";"undefined"!=typeof mejsL10n&&(e[mejsL10n.language]=mejsL10n.strings)}(n.i18n.locale.strings),"undefined"!=typeof jQuery?n.$=jQuery:"undefined"!=typeof Zepto?(n.$=Zepto,Zepto.fn.outerWidth=function(e){var t=$(this).width();return e&&(t+=parseInt($(this).css("margin-right"),10),t+=parseInt($(this).css("margin-left"),10)),t}):"undefined"!=typeof ender&&(n.$=ender),function(e){n.MepDefaults={poster:"",showPosterWhenEnded:!1,defaultVideoWidth:480,defaultVideoHeight:270,videoWidth:-1,videoHeight:-1,defaultAudioWidth:400,defaultAudioHeight:30,defaultSeekBackwardInterval:function(e){return.05*e.duration},defaultSeekForwardInterval:function(e){return.05*e.duration},setDimensions:!0,audioWidth:-1,audioHeight:-1,startVolume:.8,loop:!1,autoRewind:!0,enableAutosize:!0,timeFormat:"",alwaysShowHours:!1,showTimecodeFrameCount:!1,framesPerSecond:25,autosizeProgress:!0,alwaysShowControls:!1,hideVideoControlsOnLoad:!1,clickToPlayPause:!0,iPadUseNativeControls:!1,iPhoneUseNativeControls:!1,AndroidUseNativeControls:!1,features:["playpause","current","progress","duration","tracks","volume","fullscreen"],isVideo:!0,enableKeyboard:!0,pauseOtherPlayers:!0,keyActions:[{keys:[32,179],action:function(e,t){t.paused||t.ended?t.play():t.pause()}},{keys:[38],action:function(e,t){e.container.find(".mejs-volume-slider").css("display","block"),e.isVideo&&(e.showControls(),e.startControlsTimer());var n=Math.min(t.volume+.1,1);t.setVolume(n)}},{keys:[40],action:function(e,t){e.container.find(".mejs-volume-slider").css("display","block"),e.isVideo&&(e.showControls(),e.startControlsTimer());var n=Math.max(t.volume-.1,0);t.setVolume(n)}},{keys:[37,227],action:function(e,t){if(!isNaN(t.duration)&&t.duration>0){e.isVideo&&(e.showControls(),e.startControlsTimer());var n=Math.max(t.currentTime-e.options.defaultSeekBackwardInterval(t),0);t.setCurrentTime(n)}}},{keys:[39,228],action:function(e,t){if(!isNaN(t.duration)&&t.duration>0){e.isVideo&&(e.showControls(),e.startControlsTimer());var n=Math.min(t.currentTime+e.options.defaultSeekForwardInterval(t),t.duration);t.setCurrentTime(n)}}},{keys:[70],action:function(e,t){void 0!==e.enterFullScreen&&(e.isFullScreen?e.exitFullScreen():e.enterFullScreen())}},{keys:[77],action:function(e,t){e.container.find(".mejs-volume-slider").css("display","block"),e.isVideo&&(e.showControls(),e.startControlsTimer()),e.media.muted?e.setMuted(!1):e.setMuted(!0)}}],disabledKeys:[]},n.mepIndex=0,n.players={},n.MediaElementPlayer=function(t,i){if(!(this instanceof n.MediaElementPlayer))return new n.MediaElementPlayer(t,i);var o=this;return o.$media=o.$node=e(t),o.node=o.media=o.$media[0],o.node?void 0!==o.node.player?o.node.player:(void 0===i&&(i=o.$node.data("mejsoptions")),o.options=e.extend({},n.MepDefaults,i),o.options.timeFormat||(o.options.timeFormat="mm:ss",o.options.alwaysShowHours&&(o.options.timeFormat="hh:mm:ss"),o.options.showTimecodeFrameCount&&(o.options.timeFormat+=":ff")),n.Utility.calculateTimeFormat(0,o.options,o.options.framesPerSecond||25),o.id="mep_"+n.mepIndex++,n.players[o.id]=o,o.init(),o):void 0},n.MediaElementPlayer.prototype={hasFocus:!1,controlsAreVisible:!0,init:function(){var t=this,i=n.MediaFeatures,o=e.extend(!0,{},t.options,{success:function(e,n){t.meReady(e,n)},error:function(e){t.handleError(e)}}),s=t.media.tagName.toLowerCase();if(t.isDynamic="audio"!==s&&"video"!==s,t._playedEver=!1,t.isDynamic?t.isVideo=t.options.isVideo:t.isVideo="audio"!==s&&t.options.isVideo,i.isiPad&&t.options.iPadUseNativeControls||i.isiPhone&&t.options.iPhoneUseNativeControls)t.$media.attr("controls","controls"),i.isiPad&&null!==t.media.getAttribute("autoplay")&&t.play();else if(i.isAndroid&&t.options.AndroidUseNativeControls);else{t.$media.removeAttr("controls");var a=t.isVideo?n.i18n.t("Video Player"):n.i18n.t("Audio Player");e('<span class="mejs-offscreen">'+a+"</span>").insertBefore(t.$media),t.container=e('<div id="'+t.id+'" class="mejs-container '+(n.MediaFeatures.svgAsImg?"svg":"no-svg")+'" tabindex="0" role="application" aria-label="'+a+'"><div class="mejs-inner"><div class="mejs-mediaelement"></div><div class="mejs-layers"></div><div class="mejs-controls"></div><div class="mejs-clear"></div></div></div>').addClass(t.$media[0].className).insertBefore(t.$media).focus((function(e){t.controlsAreVisible||(t.showControls(!0),t.container.find(".mejs-playpause-button > button").focus())})),t.container.addClass((i.isAndroid?"mejs-android ":"")+(i.isiOS?"mejs-ios ":"")+(i.isiPad?"mejs-ipad ":"")+(i.isiPhone?"mejs-iphone ":"")+(t.isVideo?"mejs-video ":"mejs-audio ")),t.container.find(".mejs-mediaelement").append(t.$media),t.node.player=t,t.controls=t.container.find(".mejs-controls"),t.layers=t.container.find(".mejs-layers");var r=t.isVideo?"video":"audio",l=r.substring(0,1).toUpperCase()+r.substring(1);t.options[r+"Width"]>0||t.options[r+"Width"].toString().indexOf("%")>-1?t.width=t.options[r+"Width"]:""!==t.media.style.width&&null!==t.media.style.width?t.width=t.media.style.width:null!==t.media.getAttribute("width")?t.width=t.$media.attr("width"):t.width=t.options["default"+l+"Width"],t.options[r+"Height"]>0||t.options[r+"Height"].toString().indexOf("%")>-1?t.height=t.options[r+"Height"]:""!==t.media.style.height&&null!==t.media.style.height?t.height=t.media.style.height:null!==t.$media[0].getAttribute("height")?t.height=t.$media.attr("height"):t.height=t.options["default"+l+"Height"],t.options.hideOnInit&&(t.container.hide(),t.layers.hide()),t.setPlayerSize(t.width,t.height),o.pluginWidth=t.width,o.pluginHeight=t.height}n.MediaElement(t.$media[0],o),void 0!==t.container&&t.controlsAreVisible&&t.container.trigger("controlsshown")},showControls:function(e){var t=this;e=void 0===e||e,t.controlsAreVisible||(e?(t.controls.removeClass("mejs-offscreen").stop(!0,!0).fadeIn(200,(function(){t.controlsAreVisible=!0,t.container.trigger("controlsshown")})),t.container.find(".mejs-control").removeClass("mejs-offscreen").stop(!0,!0).fadeIn(200,(function(){t.controlsAreVisible=!0}))):(t.controls.removeClass("mejs-offscreen").css("display","block"),t.container.find(".mejs-control").removeClass("mejs-offscreen").css("display","block"),t.controlsAreVisible=!0,t.container.trigger("controlsshown")),t.setControlsSize())},hideControls:function(t){var n=this;t=void 0===t||t,!n.controlsAreVisible||n.options.alwaysShowControls||n.keyboardAction||(t?(n.controls.stop(!0,!0).fadeOut(200,(function(){e(this).addClass("mejs-offscreen").css("display","block"),n.controlsAreVisible=!1,n.container.trigger("controlshidden")})),n.container.find(".mejs-control").stop(!0,!0).fadeOut(200,(function(){e(this).addClass("mejs-offscreen").css("display","block")}))):(n.controls.addClass("mejs-offscreen").css("display","block"),n.container.find(".mejs-control").addClass("mejs-offscreen").css("display","block"),n.controlsAreVisible=!1,n.container.trigger("controlshidden")))},controlsTimer:null,startControlsTimer:function(e){var t=this;e=void 0!==e?e:1500,t.killControlsTimer("start"),t.controlsTimer=setTimeout((function(){t.hideControls(),t.killControlsTimer("hide")}),e)},killControlsTimer:function(e){var t=this;null!==t.controlsTimer&&(clearTimeout(t.controlsTimer),delete t.controlsTimer,t.controlsTimer=null)},controlsEnabled:!0,disableControls:function(){this.killControlsTimer(),this.hideControls(!1),this.controlsEnabled=!1},enableControls:function(){this.showControls(!1),this.controlsEnabled=!0},meReady:function(t,i){var o,s,a=this,r=n.MediaFeatures,l=i.getAttribute("autoplay"),c=!(null==l||"false"===l);if(!a.created){if(a.created=!0,a.media=t,a.domNode=i,!(r.isAndroid&&a.options.AndroidUseNativeControls||r.isiPad&&a.options.iPadUseNativeControls||r.isiPhone&&a.options.iPhoneUseNativeControls)){for(o in a.buildposter(a,a.controls,a.layers,a.media),a.buildkeyboard(a,a.controls,a.layers,a.media),a.buildoverlays(a,a.controls,a.layers,a.media),a.findTracks(),a.options.features)if(s=a.options.features[o],a["build"+s])try{a["build"+s](a,a.controls,a.layers,a.media)}catch(e){}a.container.trigger("controlsready"),a.setPlayerSize(a.width,a.height),a.setControlsSize(),a.isVideo&&(n.MediaFeatures.hasTouch?a.$media.bind("touchstart",(function(){a.controlsAreVisible?a.hideControls(!1):a.controlsEnabled&&a.showControls(!1)})):(a.clickToPlayPauseCallback=function(){a.options.clickToPlayPause&&(a.media.paused?a.play():(a.pause(),a.$media.trigger("clickToPause")))},a.media.addEventListener("click",a.clickToPlayPauseCallback,!1),a.container.bind("click",(function(){a.container.trigger("clickContainer")})),a.container.bind("mouseenter",(function(){a.controlsEnabled&&(a.options.alwaysShowControls||(a.killControlsTimer("enter"),!a._playedEver&&a.options.hideControlsBeforePlay||a.showControls(),a.startControlsTimer(2500)))})).bind("mousemove",(function(){a.controlsEnabled&&(a.controlsAreVisible||!a._playedEver&&a.options.hideControlsBeforePlay||a.showControls(),a.options.alwaysShowControls||a.startControlsTimer(2500))})).bind("mouseleave",(function(){a.controlsEnabled&&(a.media.paused||a.options.alwaysShowControls||a.startControlsTimer(1e3))}))),a.options.hideVideoControlsOnLoad&&a.hideControls(!1),c&&!a.options.alwaysShowControls&&a.hideControls(),a.options.enableAutosize&&a.media.addEventListener("loadedmetadata",(function(e){a.options.videoHeight<=0&&null===a.domNode.getAttribute("height")&&!isNaN(e.target.videoHeight)&&(a.setPlayerSize(e.target.videoWidth,e.target.videoHeight),a.setControlsSize(),a.media.setVideoSize(e.target.videoWidth,e.target.videoHeight))}),!1),a.options.useYoutubeControls&&a.disableControls()),t.addEventListener("play",(function(){var e;for(e in n.players){var t=n.players[e];t.id==a.id||!a.options.pauseOtherPlayers||t.paused||t.ended||t.pause(),t.hasFocus=!1}a.hasFocus=!0,a._playedEver=!0}),!1),a.media.addEventListener("ended",(function(t){if(a.options.autoRewind)try{a.media.setCurrentTime(0),window.setTimeout((function(){e(a.container).find(".mejs-overlay-loading").parent().hide()}),20)}catch(e){}a.media.pause(),a.setProgressRail&&a.setProgressRail(),a.setCurrentRail&&a.setCurrentRail(),a.options.loop?a.play():!a.options.alwaysShowControls&&a.controlsEnabled&&a.showControls(),a._playedEver=!1}),!1),a.media.addEventListener("loadedmetadata",(function(e){a.updateDuration&&a.updateDuration(),a.updateCurrent&&a.updateCurrent(),a.isFullScreen||(a.setPlayerSize(a.width,a.height),a.setControlsSize())}),!1);var d=null;a.media.addEventListener("timeupdate",(function(){d!==this.duration&&(d=this.duration,n.Utility.calculateTimeFormat(d,a.options,a.options.framesPerSecond||25),a.updateDuration&&a.updateDuration(),a.updateCurrent&&a.updateCurrent(),a.setControlsSize())}),!1),a.container.focusout((function(t){if(t.relatedTarget){var n=e(t.relatedTarget);a.keyboardAction&&0===n.parents(".mejs-container").length&&(a.keyboardAction=!1,a.hideControls(!0))}})),setTimeout((function(){a.setPlayerSize(a.width,a.height),a.setControlsSize()}),50),a.globalBind("resize",(function(){a.isFullScreen||n.MediaFeatures.hasTrueNativeFullScreen&&document.webkitIsFullScreen||a.setPlayerSize(a.width,a.height),a.setControlsSize()})),"youtube"==a.media.pluginType&&(r.isiOS||r.isAndroid)&&(a.container.find(".mejs-overlay-play").hide(),a.container.find(".mejs-poster").hide())}c&&"native"==t.pluginType&&a.play(),a.options.success&&("string"==typeof a.options.success?window[a.options.success](a.media,a.domNode,a):a.options.success(a.media,a.domNode,a))}},handleError:function(e){var t=this;t.controls&&t.controls.hide(),t.options.error&&t.options.error(e)},setPlayerSize:function(t,n){var i=this;if(!i.options.setDimensions)return!1;if(void 0!==t&&(i.width=t),void 0!==n&&(i.height=n),i.height.toString().indexOf("%")>0||"none"!==i.$node.css("max-width")&&"t.width"!==i.$node.css("max-width")||i.$node[0].currentStyle&&"100%"===i.$node[0].currentStyle.maxWidth){var o=i.isVideo?i.media.videoWidth&&i.media.videoWidth>0?i.media.videoWidth:null!==i.media.getAttribute("width")?i.media.getAttribute("width"):i.options.defaultVideoWidth:i.options.defaultAudioWidth,s=i.isVideo?i.media.videoHeight&&i.media.videoHeight>0?i.media.videoHeight:null!==i.media.getAttribute("height")?i.media.getAttribute("height"):i.options.defaultVideoHeight:i.options.defaultAudioHeight,a=i.container.parent().closest(":visible").width(),r=i.container.parent().closest(":visible").height(),l=i.isVideo||!i.options.autosizeProgress?parseInt(a*s/o,10):s;isNaN(l)&&(l=r),i.container.parent().length>0&&"body"===i.container.parent()[0].tagName.toLowerCase()&&(a=e(window).width(),l=e(window).height()),l&&a&&(i.container.width(a).height(l),i.$media.add(i.container.find(".mejs-shim")).width("100%").height("100%"),i.isVideo&&i.media.setVideoSize&&i.media.setVideoSize(a,l),i.layers.children(".mejs-layer").width("100%").height("100%"))}else i.container.width(i.width).height(i.height),i.layers.children(".mejs-layer").width(i.width).height(i.height)},setControlsSize:function(){var t=this,n=0,i=0,o=t.controls.find(".mejs-time-rail"),s=t.controls.find(".mejs-time-total"),a=o.siblings(),r=a.last(),l=null;if(t.container.is(":visible")&&o.length&&o.is(":visible")){t.options&&!t.options.autosizeProgress&&(i=parseInt(o.css("width"),10)),0!==i&&i||(a.each((function(){var t=e(this);"absolute"!=t.css("position")&&t.is(":visible")&&(n+=e(this).outerWidth(!0))})),i=t.controls.width()-n-(o.outerWidth(!0)-o.width()));do{o.width(i),s.width(i-(s.outerWidth(!0)-s.width())),"absolute"!=r.css("position")&&(l=r.length?r.position():null,i--)}while(null!==l&&l.top.toFixed(2)>0&&i>0);t.container.trigger("controlsresize")}},buildposter:function(t,n,i,o){var s=e('<div class="mejs-poster mejs-layer"></div>').appendTo(i),a=t.$media.attr("poster");""!==t.options.poster&&(a=t.options.poster),a?this.setPoster(a):s.hide(),o.addEventListener("playing",(function(){s.hide()}),!1),t.options.showPosterWhenEnded&&t.options.autoRewind&&o.addEventListener("ended",(function(){s.show()}),!1)},setPoster:function(t){var n=this.container.find(".mejs-poster"),i=n.find("img");0===i.length&&(i=e('<img width="100%" height="100%" alt="" />').appendTo(n)),i.attr("src",t),n.css({"background-image":"url("+t+")"}),this.$media.removeAttr("poster")},buildoverlays:function(t,i,o,s){var a=this;if(t.isVideo){var r=e('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-loading"><span></span></div></div>').hide().appendTo(o),l=e('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-error"></div></div>').hide().appendTo(o),c=e('<div class="mejs-overlay mejs-layer mejs-overlay-play"><button type="button" class="mejs-overlay-button player _btnVideoPlay"><span class="gSrOnly">'+IM("web.audioplayer.player.btn.play")+"</span></button></div>").appendTo(o).bind("click",(function(){a.options.clickToPlayPause&&s.paused&&s.play()}));a.options.hideBigPlay&&c.hide(),s.addEventListener("play",(function(){c.hide(),r.hide(),i.find(".mejs-time-buffering").hide(),l.hide()}),!1),s.addEventListener("playing",(function(){c.hide(),r.hide(),i.find(".mejs-time-buffering").hide(),l.hide()}),!1),s.addEventListener("seeking",(function(){r.show(),i.find(".mejs-time-buffering").show()}),!1),s.addEventListener("seeked",(function(){r.hide(),i.find(".mejs-time-buffering").hide()}),!1),s.addEventListener("pause",(function(){n.MediaFeatures.isiPhone||a.options.useYoutubeControls||c.show()}),!1),s.addEventListener("waiting",(function(){r.show(),i.find(".mejs-time-buffering").show()}),!1),s.addEventListener("loadeddata",(function(){r.show(),i.find(".mejs-time-buffering").show(),n.MediaFeatures.isAndroid&&(s.canplayTimeout=window.setTimeout((function(){if(document.createEvent){var e=document.createEvent("HTMLEvents");return e.initEvent("canplay",!0,!0),s.dispatchEvent(e)}}),300))}),!1),s.addEventListener("canplay",(function(){r.hide(),i.find(".mejs-time-buffering").hide(),clearTimeout(s.canplayTimeout)}),!1),s.addEventListener("error",(function(e){a.handleError(e),a.options.doNotShowErrorView||(r.hide(),c.hide(),l.show(),l.find(".mejs-overlay-error").html("Error loading this resource"))}),!1),s.addEventListener("keydown",(function(e){a.onkeydown(t,s,e)}),!1)}},buildkeyboard:function(t,n,i,o){var s=this;s.container.keydown((function(){s.keyboardAction=!0})),s.globalBind("keydown",(function(n){return t.hasFocus=0!==e(n.target).closest(".mejs-container").length&&e(n.target).closest(".mejs-container").attr("id")===t.$media.closest(".mejs-container").attr("id"),s.onkeydown(t,o,n)})),s.globalBind("click",(function(n){t.hasFocus=0!==e(n.target).closest(".mejs-container").length}))},onkeydown:function(e,t,n){if(e.hasFocus&&e.options.enableKeyboard&&-1==e.options.disabledKeys.indexOf(n.keyCode))for(var i=0,o=e.options.keyActions.length;i<o;i++)for(var s=e.options.keyActions[i],a=0,r=s.keys.length;a<r;a++)if(n.keyCode==s.keys[a])return"function"==typeof n.preventDefault&&n.preventDefault(),s.action(e,t,n.keyCode,n),!1;return!0},findTracks:function(){var t=this,n=t.$media.find("track");t.tracks=[],n.each((function(n,i){i=e(i),t.tracks.push({srclang:i.attr("srclang")?i.attr("srclang").toLowerCase():"",src:i.attr("src"),kind:i.attr("kind"),label:i.attr("label")||"",entries:[],isLoaded:!1})}))},changeSkin:function(e){this.container[0].className="mejs-container "+e,this.setPlayerSize(this.width,this.height),this.setControlsSize()},play:function(){this.load(),this.media.play()},pause:function(){try{this.media.pause()}catch(e){}},load:function(){this.isLoaded||this.media.load(),this.isLoaded=!0},setMuted:function(e){this.media.setMuted(e)},setCurrentTime:function(e){this.media.setCurrentTime(e)},getCurrentTime:function(){return this.media.currentTime},setVolume:function(e){this.media.setVolume(e)},getVolume:function(){return this.media.volume},setSrc:function(e){this.media.setSrc(e)},remove:function(){var e,t,i=this;for(e in i.container.prev(".mejs-offscreen").remove(),i.options.features)if(i["clean"+(t=i.options.features[e])])try{i["clean"+t](i)}catch(e){}i.isDynamic?i.$node.insertBefore(i.container):(i.$media.prop("controls",!0),i.$node.clone().insertBefore(i.container).show(),i.$node.remove()),"native"!==i.media.pluginType&&i.media.remove(),delete n.players[i.id],"object"==typeof i.container&&i.container.remove(),i.globalUnbind(),delete i.node.player},rebuildtracks:function(){var e=this;e.findTracks(),e.buildtracks(e,e.controls,e.layers,e.media)},resetSize:function(){var e=this;setTimeout((function(){e.setPlayerSize(e.width,e.height),e.setControlsSize()}),50)}},function(){var t=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;function i(n,i){var o={d:[],w:[]};return e.each((n||"").split(" "),(function(e,n){var s=n+"."+i;0===s.indexOf(".")?(o.d.push(s),o.w.push(s)):o[t.test(n)?"w":"d"].push(s)})),o.d=o.d.join(" "),o.w=o.w.join(" "),o}n.MediaElementPlayer.prototype.globalBind=function(t,n,o){var s=this,a=s.node?s.node.ownerDocument:document;(t=i(t,s.id)).d&&e(a).bind(t.d,n,o),t.w&&e(window).bind(t.w,n,o)},n.MediaElementPlayer.prototype.globalUnbind=function(t,n){var o=this,s=o.node?o.node.ownerDocument:document;(t=i(t,o.id)).d&&e(s).unbind(t.d,n),t.w&&e(window).unbind(t.w,n)}}(),void 0!==e&&(e.fn.mediaelementplayer=function(t){return!1===t?this.each((function(){var t=e(this).data("mediaelementplayer");t&&t.remove(),e(this).removeData("mediaelementplayer")})):this.each((function(){e(this).data("mediaelementplayer",new n.MediaElementPlayer(this,t))})),this},e(document).ready((function(){e(".mejs-player").mediaelementplayer()}))),window.MediaElementPlayer=n.MediaElementPlayer}(n.$),function(e){e.extend(n.MepDefaults,{playText:"Play",pauseText:"Pause"}),e.extend(MediaElementPlayer.prototype,{buildplaypause:function(t,n,i,o){var s=this.options,a=e('<div class="mejs-button mejs-playpause-button mejs-play" ><button type="button" aria-controls="'+this.id+'" title="'+s.playText+'" aria-label="'+s.playText+'"></button></div>').appendTo(n).click((function(e){return e.preventDefault(),o.paused?o.play():o.pause(),!1})),r=a.find("button");function l(e){"play"===e?(a.removeClass("mejs-play").addClass("mejs-pause"),r.attr({title:s.pauseText,"aria-label":s.pauseText})):(a.removeClass("mejs-pause").addClass("mejs-play"),r.attr({title:s.playText,"aria-label":s.playText}))}l("pse"),o.addEventListener("play",(function(){l("play")}),!1),o.addEventListener("playing",(function(){l("play")}),!1),o.addEventListener("pause",(function(){l("pse")}),!1),o.addEventListener("paused",(function(){l("pse")}),!1)}})}(n.$),function(e){e.extend(n.MepDefaults,{stopText:"Stop"}),e.extend(MediaElementPlayer.prototype,{buildstop:function(t,i,o,s){var a=this;e('<div class="mejs-button mejs-stop-button mejs-stop"><button type="button" aria-controls="'+a.id+'" title="'+a.options.stopText+'" aria-label="'+a.options.stopText+'"></button></div>').appendTo(i).click((function(){s.paused||s.pause(),s.currentTime>0&&(s.setCurrentTime(0),s.pause(),i.find(".mejs-time-current").width("0px"),i.find(".mejs-time-handle").css("left","0px"),i.find(".mejs-time-float-current").html(n.Utility.secondsToTimeCode(0,t.options)),i.find(".mejs-currenttime").html(n.Utility.secondsToTimeCode(0,t.options)),o.find(".mejs-poster").show())}))}})}(n.$),function(e){e.extend(n.MepDefaults,{progessHelpText:n.i18n.t("Use Left/Right Arrow keys to advance one second, Up/Down arrows to advance ten seconds.")}),e.extend(MediaElementPlayer.prototype,{buildprogress:function(t,i,o,s){e('<div class="mejs-time-rail"><span  class="mejs-time-total mejs-time-slider"><span class="mejs-time-buffering"></span><span class="mejs-time-loaded"></span><span class="mejs-time-current"></span><span class="mejs-time-handle"></span><span class="mejs-time-float"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></span></div>').appendTo(i),i.find(".mejs-time-buffering").hide();var a=this,r=i.find(".mejs-time-total"),l=i.find(".mejs-time-loaded"),c=i.find(".mejs-time-current"),d=i.find(".mejs-time-handle"),u=i.find(".mejs-time-float"),h=i.find(".mejs-time-float-current"),p=i.find(".mejs-time-slider"),m=function(e){var i,o=r.offset(),a=r.width(),l=0,c=0,d=0;i=e.originalEvent&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].pageX:e.changedTouches?e.changedTouches[0].pageX:e.pageX,s.duration&&(i<o.left?i=o.left:i>a+o.left&&(i=a+o.left),c=(l=(d=i-o.left)/a)<=.02?0:l*s.duration,_&&c!==s.currentTime&&s.setCurrentTime(c),n.MediaFeatures.hasTouch||(u.css("left",d),h.html(n.Utility.secondsToTimeCode(c,t.options)),u.show()))},_=!1,g=0,f=!1,b=t.options.autoRewind,v=function(){new Date-g>=1e3&&s.play()};p.bind("focus",(function(e){t.options.autoRewind=!1})),p.bind("blur",(function(e){t.options.autoRewind=b})),p.bind("keydown",(function(e){new Date-g>=1e3&&(f=s.paused);var n=e.keyCode,i=s.duration,o=s.currentTime,a=t.options.defaultSeekForwardInterval(i),r=t.options.defaultSeekBackwardInterval(i);if(t.options.enableKeyboard&&-1==t.options.disabledKeys.indexOf(e.keyCode)){switch(n){case 37:case 40:o-=r;break;case 39:case 38:o+=a;break;case 36:o=0;break;case 35:o=i;break;case 32:case 13:return void(s.paused?s.play():s.pause());default:return}return o=o<0?0:o>=i?i:Math.floor(o),g=new Date,f||s.pause(),o<s.duration&&!f&&setTimeout(v,1100),s.setCurrentTime(o),e.preventDefault(),e.stopPropagation(),!1}})),r.bind("mousedown touchstart",(function(e){1!==e.which&&0!==e.which||(_=!0,m(e),a.globalBind("mousemove.dur touchmove.dur",(function(e){m(e)})),a.globalBind("mouseup.dur touchend.dur",(function(e){_=!1,u.hide(),a.globalUnbind(".dur")})))})).bind("mouseenter",(function(e){!0,a.globalBind("mousemove.dur",(function(e){m(e)})),n.MediaFeatures.hasTouch||u.show()})).bind("mouseleave",(function(e){!1,_||(a.globalUnbind(".dur"),u.hide())})),s.addEventListener("progress",(function(e){t.setProgressRail(e),t.setCurrentRail(e)}),!1),s.addEventListener("timeupdate",(function(e){var i,o,a,r;t.setProgressRail(e),t.setCurrentRail(e),i=s.currentTime,o=n.i18n.t("Time Slider"),a=n.Utility.secondsToTimeCode(i,t.options),r=s.duration,p.attr({"aria-label":o,"aria-valuemin":0,"aria-valuemax":r,"aria-valuenow":i,"aria-valuetext":a,role:"slider",tabindex:0})}),!1),a.container.on("controlsresize",(function(){t.setProgressRail(),t.setCurrentRail()})),a.loaded=l,a.total=r,a.current=c,a.handle=d},setProgressRail:function(e){var t=this,n=void 0!==e?e.target:t.media,i=null;if(n&&n.buffered&&n.buffered.length>0&&n.buffered.end&&n.duration?i=n.buffered.end(n.buffered.length-1)/n.duration:n&&void 0!==n.bytesTotal&&n.bytesTotal>0&&void 0!==n.bufferedBytes?i=n.bufferedBytes/n.bytesTotal:e&&e.lengthComputable&&0!==e.total&&(i=e.loaded/e.total),null!==i&&(i=Math.min(1,Math.max(0,i)),t.loaded&&t.total)){var o=t.loaded.width(),s=t.total.width(),a=s*i;if(o<=s&&a<o)return;t.loaded.width(a)}},setCurrentRail:function(){var e=this;if(void 0!==e.media.currentTime&&e.media.duration&&e.total&&e.handle){var t=Math.round(e.total.width()*e.media.currentTime/e.media.duration),n=t-Math.round(e.handle.outerWidth(!0)/2);e.current.width(t),e.handle.css("left",n)}}})}(n.$),function(e){e.extend(n.MepDefaults,{duration:-1,timeAndDurationSeparator:"<span> | </span>"}),e.extend(MediaElementPlayer.prototype,{buildcurrent:function(t,i,o,s){e('<div class="mejs-time" role="timer" aria-live="off"><span class="mejs-currenttime">'+n.Utility.secondsToTimeCode(0,t.options)+"</span></div>").appendTo(i),this.currenttime=this.controls.find(".mejs-currenttime"),s.addEventListener("timeupdate",(function(){t.updateCurrent()}),!1)},buildduration:function(t,i,o,s){var a=this;i.children().last().find(".mejs-currenttime").length>0?e(a.options.timeAndDurationSeparator+'<span class="mejs-duration">'+n.Utility.secondsToTimeCode(a.options.duration,a.options)+"</span>").appendTo(i.find(".mejs-time")):(i.find(".mejs-currenttime").parent().addClass("mejs-currenttime-container"),e('<div class="mejs-time mejs-duration-container"><span class="mejs-duration">'+n.Utility.secondsToTimeCode(a.options.duration,a.options)+"</span></div>").appendTo(i)),a.durationD=a.controls.find(".mejs-duration"),s.addEventListener("timeupdate",(function(){t.updateDuration()}),!1)},updateCurrent:function(){var e=this,t=e.media.currentTime;isNaN(t)&&(t=0),e.currenttime&&e.currenttime.html(n.Utility.secondsToTimeCode(t,e.options))},updateDuration:function(){var e=this,t=e.media.duration;e.options.duration>0&&(t=e.options.duration),isNaN(t)&&(t=0),e.container.toggleClass("mejs-long-video",t>3600),e.durationD&&t>0&&e.durationD.html(n.Utility.secondsToTimeCode(t,e.options))}})}(n.$),function(e){e.extend(n.MepDefaults,{muteText:"Mute",unmuteText:"Unmute",allyVolumeControlText:n.i18n.t("Use Up/Down Arrow keys to increase or decrease volume."),hideVolumeOnTouchDevices:!0,audioVolume:"horizontal",videoVolume:"vertical"}),e.extend(MediaElementPlayer.prototype,{buildvolume:function(t,i,o,s){if(!n.MediaFeatures.isAndroid&&!n.MediaFeatures.isiOS||!this.options.hideVolumeOnTouchDevices){var a=this,r=a.isVideo?a.options.videoVolume:a.options.audioVolume,l="horizontal"==r?e('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+a.id+'" title="'+a.options.muteText+'" aria-label="'+a.options.muteText+'"></button></div><a href="javascript:void(0);" class="mejs-horizontal-volume-slider"><span class="mejs-offscreen">'+a.options.allyVolumeControlText+'</span><div class="mejs-horizontal-volume-total"></div><div class="mejs-horizontal-volume-current"></div><div class="mejs-horizontal-volume-handle"></div></a>').appendTo(i):e('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+a.id+'" title="'+a.options.muteText+'" aria-label="'+a.options.muteText+'"></button><a href="javascript:void(0);" class="mejs-volume-slider"><span class="mejs-offscreen">'+a.options.allyVolumeControlText+'</span><div class="mejs-volume-total"></div><div class="mejs-volume-current"></div><div class="mejs-volume-handle"></div></a></div>').appendTo(i),c=a.container.find(".mejs-volume-slider, .mejs-horizontal-volume-slider"),d=a.container.find(".mejs-volume-total, .mejs-horizontal-volume-total"),u=a.container.find(".mejs-volume-current, .mejs-horizontal-volume-current"),h=a.container.find(".mejs-volume-handle, .mejs-horizontal-volume-handle"),p=function(e,t){if(!c.is(":visible")&&void 0===t)return c.show(),p(e,!0),void c.hide();if(e=Math.max(0,e),0===(e=Math.min(e,1)))l.removeClass("mejs-mute").addClass("mejs-unmute"),l.children("button").attr("title",a.options.unmuteText).attr("aria-label",a.options.unmuteText);else{var i=n.VOLUME_LEVEL.high.ui,o=n.VOLUME_LEVEL.middle.ui+" "+n.VOLUME_LEVEL.low.ui;e<=n.VOLUME_LEVEL.low.maxVolume?(i=n.VOLUME_LEVEL.low.ui,o=n.VOLUME_LEVEL.high.ui+" "+n.VOLUME_LEVEL.middle.ui):e<=n.VOLUME_LEVEL.middle.maxVolume&&(i=n.VOLUME_LEVEL.middle.ui,o=n.VOLUME_LEVEL.high.ui+" "+n.VOLUME_LEVEL.low.ui),l.removeClass("mejs-unmute").addClass("mejs-mute "+i).removeClass(o),l.children("button").attr("title",a.options.muteText).attr("aria-label",a.options.muteText)}var s=d.position();if("vertical"==r){var m=d.height(),_=m-m*e;h.css("top",Math.round(s.top+_-h.height()/2)),u.height(m-_),u.css("top",s.top+_)}else{var g=d.width()*e;h.css("left",Math.round(s.left+g-h.width()/2)),u.width(Math.round(g))}},m=function(e){var t=null,n=d.offset();if("vertical"===r){var i=d.height();if(t=(i-(e.pageY-n.top))/i,0===n.top||0===n.left)return}else{var o=d.width();t=(e.pageX-n.left)/o}t=Math.max(0,t),t=Math.min(t,1),p(t),0===t?s.setMuted(!0):s.setMuted(!1),s.setVolume(t)},_=!1,g=!1;l.hover((function(){c.show(),g=!0}),(function(){g=!1,_||"vertical"!=r||c.hide()}));c.bind("mouseover",(function(){g=!0})).bind("mousedown",(function(e){return m(e),a.globalBind("mousemove.vol",(function(e){m(e)})),a.globalBind("mouseup.vol",(function(){_=!1,a.globalUnbind(".vol"),g||"vertical"!=r||c.hide()})),_=!0,!1})).bind("keydown",(function(e){var t=e.keyCode,n=s.volume;switch(t){case 38:n=Math.min(n+.1,1);break;case 40:n=Math.max(0,n-.1);break;default:return!0}return _=!1,p(n),s.setVolume(n),!1})),l.find("button").click((function(){s.setMuted(!s.muted)})),l.find("button").bind("focus",(function(){c.show()})),s.addEventListener("volumechange",(function(e){var t;_||(s.muted?(p(0),l.removeClass("mejs-mute").addClass("mejs-unmute")):(p(s.volume),l.removeClass("mejs-unmute").addClass("mejs-mute"))),t=Math.floor(100*s.volume),c.attr({"aria-label":n.i18n.t("Volume Slider"),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":t,"aria-valuetext":t+"%",role:"slider",tabindex:0})}),!1),0===t.options.startVolume&&s.setMuted(!0),"native"===s.pluginType&&s.setVolume(t.options.startVolume),a.container.on("controlsresize",(function(){s.muted?(p(0),l.removeClass("mejs-mute").addClass("mejs-unmute")):(p(s.volume),l.removeClass("mejs-unmute").addClass("mejs-mute"))}))}}})}(n.$),function(e){e.extend(n.MepDefaults,{usePluginFullScreen:!0,newWindowCallback:function(){return""},fullscreenText:"Go Fullscreen",fullscreenCancelText:"Turn off Fullscreen"}),e.extend(MediaElementPlayer.prototype,{isFullScreen:!1,isNativeFullScreen:!1,isInIframe:!1,fullscreenMode:"",buildfullscreen:function(t,i,o,s){if(t.isVideo){t.isInIframe=window.location!=window.parent.location,s.addEventListener("loadstart",(function(){t.detectFullscreenMode()}));var a=this,r=null,l=e('<div class="mejs-button mejs-fullscreen-button"><button type="button" aria-controls="'+a.id+'" title="'+a.options.fullscreenText+'" aria-label="'+a.options.fullscreenText+'"></button></div>').appendTo(i).on("click",(function(){n.MediaFeatures.hasTrueNativeFullScreen&&n.MediaFeatures.isFullScreen()||t.isFullScreen?t.exitFullScreen():t.enterFullScreen()})).on("mouseover",(function(){if("plugin-hover"==a.fullscreenMode){null!==r&&(clearTimeout(r),delete r);var e=l.offset(),n=t.container.offset();s.positionFullscreenButton(e.left-n.left,e.top-n.top,!0)}})).on("mouseout",(function(){"plugin-hover"==a.fullscreenMode&&(null!==r&&(clearTimeout(r),delete r),r=setTimeout((function(){s.hideFullscreenButton()}),1500))}));if(t.fullscreenBtn=l,a.globalBind("keyup",(function(e){27==e.keyCode&&(n.MediaFeatures.hasTrueNativeFullScreen&&n.MediaFeatures.isFullScreen()||a.isFullScreen)&&t.exitFullScreen()})),a.normalHeight=0,a.normalWidth=0,n.MediaFeatures.hasTrueNativeFullScreen){t.globalBind(n.MediaFeatures.fullScreenEventName,(function(e){t.isFullScreen&&(n.MediaFeatures.isFullScreen()?(t.isNativeFullScreen=!0,t.setControlsSize()):(t.isNativeFullScreen=!1,t.exitFullScreen()))}))}}},detectFullscreenMode:function(){var e=this,t="",i=n.MediaFeatures;return i.hasTrueNativeFullScreen&&"native"===e.media.pluginType?t="native-native":i.hasTrueNativeFullScreen&&"native"!==e.media.pluginType&&!i.hasFirefoxPluginMovingProblem?t="plugin-native":e.usePluginFullScreen?n.MediaFeatures.supportsPointerEvents?(t="plugin-click",e.createPluginClickThrough()):t="plugin-hover":t="fullwindow",e.fullscreenMode=t,t},isPluginClickThroughCreated:!1,createPluginClickThrough:function(){var t=this;if(!t.isPluginClickThroughCreated){var n,i,o=!1,s=function(){if(o){for(var e in a)a[e].hide();t.fullscreenBtn.css("pointer-events",""),t.controls.css("pointer-events",""),t.media.removeEventListener("click",t.clickToPlayPauseCallback),o=!1}},a={},r=["top","left","right","bottom"],l=function(){var e=fullscreenBtn.offset().left-t.container.offset().left,i=fullscreenBtn.offset().top-t.container.offset().top,o=fullscreenBtn.outerWidth(!0),s=fullscreenBtn.outerHeight(!0),r=t.container.width(),l=t.container.height();for(n in a)a[n].css({position:"absolute",top:0,left:0});a.top.width(r).height(i),a.left.width(e).height(s).css({top:i}),a.right.width(r-e-o).height(s).css({top:i,left:e+o}),a.bottom.width(r).height(l-s-i).css({top:i+s})};for(t.globalBind("resize",(function(){l()})),n=0,i=r.length;n<i;n++)a[r[n]]=e('<div class="mejs-fullscreen-hover" />').appendTo(t.container).mouseover(s).hide();fullscreenBtn.on("mouseover",(function(){if(!t.isFullScreen){var e=fullscreenBtn.offset(),i=player.container.offset();for(n in media.positionFullscreenButton(e.left-i.left,e.top-i.top,!1),t.fullscreenBtn.css("pointer-events","none"),t.controls.css("pointer-events","none"),t.media.addEventListener("click",t.clickToPlayPauseCallback),a)a[n].show();l(),o=!0}})),media.addEventListener("fullscreenchange",(function(e){t.isFullScreen=!t.isFullScreen,t.isFullScreen?t.media.removeEventListener("click",t.clickToPlayPauseCallback):t.media.addEventListener("click",t.clickToPlayPauseCallback),s()})),t.globalBind("mousemove",(function(e){if(o){var n=fullscreenBtn.offset();(e.pageY<n.top||e.pageY>n.top+fullscreenBtn.outerHeight(!0)||e.pageX<n.left||e.pageX>n.left+fullscreenBtn.outerWidth(!0))&&(fullscreenBtn.css("pointer-events",""),t.controls.css("pointer-events",""),o=!1)}})),t.isPluginClickThroughCreated=!0}},cleanfullscreen:function(e){e.exitFullScreen()},containerSizeTimeout:null,enterFullScreen:function(){var t=this;t.container.trigger("enterFullScreen"),t.fullscreenBtn.find("button").attr({title:t.options.fullscreenCancelText,"aria-label":t.options.fullscreenCancelText}),n.MediaFeatures.hasiOSFullScreen?t.media.webkitEnterFullscreen():(e(document.documentElement).addClass("mejs-fullscreen"),t.normalHeight=t.container.height(),t.normalWidth=t.container.width(),"native-native"===t.fullscreenMode||"plugin-native"===t.fullscreenMode?(n.MediaFeatures.requestFullScreen(t.container[0]),t.isInIframe&&setTimeout((function n(){if(t.isNativeFullScreen){var i=e(window).width(),o=screen.width;Math.abs(o-i)>.002*o?t.exitFullScreen():setTimeout(n,500)}}),1e3)):t.fullscreeMode,t.container.addClass("mejs-container-fullscreen").width("100%").height("100%"),t.containerSizeTimeout=setTimeout((function(){t.container.css({width:"100%",height:"100%"}),t.setControlsSize()}),500),"native"===t.media.pluginType?t.$media.width("100%").height("100%"):(t.container.find(".mejs-shim").width("100%").height("100%"),setTimeout((function(){var n=e(window),i=n.width(),o=n.height();t.media.setVideoSize(i,o)}),500)),t.layers.children("div").width("100%").height("100%"),t.fullscreenBtn&&t.fullscreenBtn.removeClass("mejs-fullscreen").addClass("mejs-unfullscreen"),t.setControlsSize(),t.isFullScreen=!0,t.container.find(".mejs-captions-text").css("font-size",screen.width/t.width*1*100+"%"),t.container.find(".mejs-captions-position").css("bottom","45px"),t.container.trigger("enteredfullscreen"))},exitFullScreen:function(){var t=this;clearTimeout(t.containerSizeTimeout),t.container.trigger("exitFullScreen"),t.fullscreenBtn.find("button").attr({title:t.options.fullscreenText,"aria-label":t.options.fullscreenText}),n.MediaFeatures.hasTrueNativeFullScreen&&(n.MediaFeatures.isFullScreen()||t.isFullScreen)&&n.MediaFeatures.cancelFullScreen(),e(document.documentElement).removeClass("mejs-fullscreen"),t.container.removeClass("mejs-container-fullscreen").width(t.normalWidth).height(t.normalHeight),"native"===t.media.pluginType?t.$media.width(t.normalWidth).height(t.normalHeight):(t.container.find(".mejs-shim").width(t.normalWidth).height(t.normalHeight),t.media.setVideoSize(t.normalWidth,t.normalHeight)),t.layers.children("div").width(t.normalWidth).height(t.normalHeight),t.fullscreenBtn.removeClass("mejs-unfullscreen").addClass("mejs-fullscreen"),t.setControlsSize(),t.isFullScreen=!1,t.container.find(".mejs-captions-text").css("font-size",""),t.container.find(".mejs-captions-position").css("bottom",""),t.container.trigger("exitedfullscreen")}})}(n.$),function(e){e.extend(n.MepDefaults,{speeds:["2.00","1.50","1.25","1.00","0.75"],defaultSpeed:"1.00",speedChar:"x"}),e.extend(MediaElementPlayer.prototype,{buildspeed:function(t,n,i,o){var s=this;if("native"==s.media.pluginType){for(var a=null,r=null,l=null,c=null,d=[],u=!1,h=0,p=s.options.speeds.length;h<p;h++){var m=s.options.speeds[h];"string"==typeof m?(d.push({name:m+s.options.speedChar,value:m}),m===s.options.defaultSpeed&&(u=!0)):(d.push(m),m.value===s.options.defaultSpeed&&(u=!0))}u||d.push({name:s.options.defaultSpeed+s.options.speedChar,value:s.options.defaultSpeed}),d.sort((function(e,t){return parseFloat(t.value)-parseFloat(e.value)}));var _=function(e){for(h=0,p=d.length;h<p;h++)if(d[h].value===e)return d[h].name},g='<div class="mejs-button mejs-speed-button"><button type="button">'+_(s.options.defaultSpeed)+'</button><div class="mejs-speed-selector"><ul>';for(h=0,il=d.length;h<il;h++)c=s.id+"-speed-"+d[h].value,g+='<li><input type="radio" name="speed" value="'+d[h].value+'" id="'+c+'" '+(d[h].value===s.options.defaultSpeed?" checked":"")+' /><label for="'+c+'" '+(d[h].value===s.options.defaultSpeed?' class="mejs-speed-selected"':"")+">"+d[h].name+"</label></li>";a=e(g+="</ul></div></div>").appendTo(n),r=a.find(".mejs-speed-selector"),l=s.options.defaultSpeed,o.addEventListener("loadedmetadata",(function(e){l&&(o.playbackRate=parseFloat(l))}),!0),r.on("click",'input[type="radio"]',(function(){var t=e(this).attr("value");l=t,o.playbackRate=parseFloat(t),a.find("button").html(_(t)),a.find(".mejs-speed-selected").removeClass("mejs-speed-selected"),a.find('input[type="radio"]:checked').next().addClass("mejs-speed-selected")})),a.one("mouseenter focusin",(function(){r.height(a.find(".mejs-speed-selector ul").outerHeight(!0)+a.find(".mejs-speed-translations").outerHeight(!0)).css("top",-1*r.height()+"px")}))}}})}(n.$),function(e){e.extend(n.MepDefaults,{startLanguage:"",tracksText:n.i18n.t("Captions/Subtitles"),tracksAriaLive:!1,hideCaptionsButtonWhenEmpty:!0,toggleCaptionsButtonWhenOnlyOne:!1,slidesSelector:""}),e.extend(MediaElementPlayer.prototype,{hasChapters:!1,cleartracks:function(e,t,n,i){e&&(e.captions&&e.captions.remove(),e.chapters&&e.chapters.remove(),e.captionsText&&e.captionsText.remove(),e.captionsButton&&e.captionsButton.remove())},buildtracks:function(t,i,o,s){if(0!==t.tracks.length){var a,r=this,l=r.options.tracksAriaLive?'role="log" aria-live="assertive" aria-atomic="false"':"";if(r.domNode.textTracks)for(a=r.domNode.textTracks.length-1;a>=0;a--)r.domNode.textTracks[a].mode="hidden";r.cleartracks(t,i,o,s),t.chapters=e('<div class="mejs-chapters mejs-layer"></div>').prependTo(o).hide(),t.captions=e('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover" '+l+'><span class="mejs-captions-text"></span></div></div>').prependTo(o).hide(),t.captionsText=t.captions.find(".mejs-captions-text"),t.captionsButton=e('<div class="mejs-button mejs-captions-button"><button type="button" aria-controls="'+r.id+'" title="'+r.options.tracksText+'" aria-label="'+r.options.tracksText+'"></button><div class="mejs-captions-selector"><ul><li><input type="radio" name="'+t.id+'_captions" id="'+t.id+'_captions_none" value="none" checked="checked" /><label for="'+t.id+'_captions_none">'+n.i18n.t("None")+"</label></li></ul></div></div>").appendTo(i);var c=0;for(a=0;a<t.tracks.length;a++)"subtitles"==t.tracks[a].kind&&c++;for(r.options.toggleCaptionsButtonWhenOnlyOne&&1==c?t.captionsButton.on("click",(function(){null===t.selectedTrack?lang=t.tracks[0].srclang:lang="none",t.setTrack(lang)})):(t.captionsButton.on("mouseenter focusin",(function(){e(this).find(".mejs-captions-selector").removeClass("mejs-offscreen")})).on("click","input[type=radio]",(function(){lang=this.value,t.setTrack(lang)})),t.captionsButton.on("mouseleave focusout",(function(){e(this).find(".mejs-captions-selector").addClass("mejs-offscreen")}))),t.options.alwaysShowControls?t.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover"):t.container.bind("controlsshown",(function(){t.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover")})).bind("controlshidden",(function(){s.paused||t.container.find(".mejs-captions-position").removeClass("mejs-captions-position-hover")})),t.trackToLoad=-1,t.selectedTrack=null,t.isLoadingTrack=!1,a=0;a<t.tracks.length;a++)"subtitles"==t.tracks[a].kind&&t.addTrackButton(t.tracks[a].srclang,t.tracks[a].label);t.loadNextTrack(),s.addEventListener("timeupdate",(function(e){t.displayCaptions()}),!1),""!==t.options.slidesSelector&&(t.slidesContainer=e(t.options.slidesSelector),s.addEventListener("timeupdate",(function(e){t.displaySlides()}),!1)),s.addEventListener("loadedmetadata",(function(e){t.displayChapters()}),!1),t.container.hover((function(){t.hasChapters&&(t.chapters.removeClass("mejs-offscreen"),t.chapters.fadeIn(200).height(t.chapters.find(".mejs-chapter").outerHeight()))}),(function(){t.hasChapters&&!s.paused&&t.chapters.fadeOut(200,(function(){e(this).addClass("mejs-offscreen"),e(this).css("display","block")}))})),r.container.on("controlsresize",(function(){r.adjustLanguageBox()})),null!==t.node.getAttribute("autoplay")&&t.chapters.addClass("mejs-offscreen")}},setTrack:function(e){var t,n=this;if("none"==e)n.selectedTrack=null,n.captionsButton.removeClass("mejs-captions-enabled");else for(t=0;t<n.tracks.length;t++)if(n.tracks[t].srclang==e){null===n.selectedTrack&&n.captionsButton.addClass("mejs-captions-enabled"),n.selectedTrack=n.tracks[t],n.captions.attr("lang",n.selectedTrack.srclang),n.displayCaptions();break}},loadNextTrack:function(){var e=this;e.trackToLoad++,e.trackToLoad<e.tracks.length?(e.isLoadingTrack=!0,e.loadTrack(e.trackToLoad)):(e.isLoadingTrack=!1,e.checkForTracks())},loadTrack:function(t){var i=this,o=i.tracks[t];e.ajax({url:o.src,dataType:"text",success:function(e){"string"==typeof e&&/<tt\s+xml/gi.exec(e)?o.entries=n.TrackFormatParser.dfxp.parse(e):o.entries=n.TrackFormatParser.webvtt.parse(e),o.isLoaded=!0,i.enableTrackButton(o.srclang,o.label),i.loadNextTrack(),"chapters"==o.kind&&i.media.addEventListener("play",(function(e){i.media.duration>0&&i.displayChapters(o)}),!1),"slides"==o.kind&&i.setupSlides(o)},error:function(){i.removeTrackButton(o.srclang),i.loadNextTrack()}})},enableTrackButton:function(t,i){var o=this;""===i&&(i=n.language.codes[t]||t),o.captionsButton.find("input[value="+t+"]").prop("disabled",!1).siblings("label").html(i),o.options.startLanguage==t&&e("#"+o.id+"_captions_"+t).prop("checked",!0).trigger("click"),o.adjustLanguageBox()},removeTrackButton:function(e){this.captionsButton.find("input[value="+e+"]").closest("li").remove(),this.adjustLanguageBox()},addTrackButton:function(t,i){var o=this;""===i&&(i=n.language.codes[t]||t),o.captionsButton.find("ul").append(e('<li><input type="radio" name="'+o.id+'_captions" id="'+o.id+"_captions_"+t+'" value="'+t+'" disabled="disabled" /><label for="'+o.id+"_captions_"+t+'">'+i+" (loading)</label></li>")),o.adjustLanguageBox(),o.container.find(".mejs-captions-translations option[value="+t+"]").remove()},adjustLanguageBox:function(){var e=this;e.captionsButton.find(".mejs-captions-selector").height(e.captionsButton.find(".mejs-captions-selector ul").outerHeight(!0)+e.captionsButton.find(".mejs-captions-translations").outerHeight(!0))},checkForTracks:function(){var e=this,t=!1;if(e.options.hideCaptionsButtonWhenEmpty){for(i=0;i<e.tracks.length;i++)if("subtitles"==e.tracks[i].kind&&e.tracks[i].isLoaded){t=!0;break}t||(e.captionsButton.hide(),e.setControlsSize())}},displayCaptions:function(){if(void 0!==this.tracks){var e,t=this,n=t.selectedTrack;if(null!==n&&n.isLoaded){for(e=0;e<n.entries.times.length;e++)if(t.media.currentTime>=n.entries.times[e].start&&t.media.currentTime<=n.entries.times[e].stop)return t.captionsText.html(n.entries.text[e]).attr("class","mejs-captions-text "+(n.entries.times[e].identifier||"")),void t.captions.show().height(0);t.captions.hide()}else t.captions.hide()}},setupSlides:function(e){var t=this;t.slides=e,t.slides.entries.imgs=[t.slides.entries.text.length],t.showSlide(0)},showSlide:function(t){if(void 0!==this.tracks&&void 0!==this.slidesContainer){var n=this,i=n.slides.entries.text[t],o=n.slides.entries.imgs[t];void 0===o||void 0===o.fadeIn?n.slides.entries.imgs[t]=o=e('<img src="'+i+'">').on("load",(function(){o.appendTo(n.slidesContainer).hide().fadeIn().siblings(":visible").fadeOut()})):o.is(":visible")||o.is(":animated")||o.fadeIn().siblings(":visible").fadeOut()}},displaySlides:function(){if(void 0!==this.slides){var e,t=this,n=t.slides;for(e=0;e<n.entries.times.length;e++)if(t.media.currentTime>=n.entries.times[e].start&&t.media.currentTime<=n.entries.times[e].stop)return void t.showSlide(e)}},displayChapters:function(){var e,t=this;for(e=0;e<t.tracks.length;e++)if("chapters"==t.tracks[e].kind&&t.tracks[e].isLoaded){t.drawChapters(t.tracks[e]),t.hasChapters=!0;break}},drawChapters:function(t){var i,o,s=this,a=0,r=0;for(s.chapters.empty(),i=0;i<t.entries.times.length;i++)o=t.entries.times[i].stop-t.entries.times[i].start,((a=Math.floor(o/s.media.duration*100))+r>100||i==t.entries.times.length-1&&a+r<100)&&(a=100-r),s.chapters.append(e('<div class="mejs-chapter" rel="'+t.entries.times[i].start+'" style="left: '+r.toString()+"%;width: "+a.toString()+'%;"><div class="mejs-chapter-block'+(i==t.entries.times.length-1?" mejs-chapter-block-last":"")+'"><span class="ch-title">'+t.entries.text[i]+'</span><span class="ch-time">'+n.Utility.secondsToTimeCode(t.entries.times[i].start,s.options)+"&ndash;"+n.Utility.secondsToTimeCode(t.entries.times[i].stop,s.options)+"</span></div></div>")),r+=a;s.chapters.find("div.mejs-chapter").click((function(){s.media.setCurrentTime(parseFloat(e(this).attr("rel"))),s.media.paused&&s.media.play()})),s.chapters.show()}}),n.language={codes:{af:"Afrikaans",sq:"Albanian",ar:"Arabic",be:"Belarusian",bg:"Bulgarian",ca:"Catalan",zh:"Chinese","zh-cn":"Chinese Simplified","zh-tw":"Chinese Traditional",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",et:"Estonian",fl:"Filipino",fi:"Finnish",fr:"French",gl:"Galician",de:"German",el:"Greek",ht:"Haitian Creole",iw:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",ga:"Irish",it:"Italian",ja:"Japanese",ko:"Korean",lv:"Latvian",lt:"Lithuanian",mk:"Macedonian",ms:"Malay",mt:"Maltese",no:"Norwegian",fa:"Persian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian",sr:"Serbian",sk:"Slovak",sl:"Slovenian",es:"Spanish",sw:"Swahili",sv:"Swedish",tl:"Tagalog",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",cy:"Welsh",yi:"Yiddish"}},n.TrackFormatParser={webvtt:{pattern_timecode:/^((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,parse:function(t){for(var i,o,s,a=0,r=n.TrackFormatParser.split2(t,/\r?\n/),l={text:[],times:[]};a<r.length;a++){if((i=this.pattern_timecode.exec(r[a]))&&a<r.length){for(a-1>=0&&""!==r[a-1]&&(s=r[a-1]),o=r[++a],a++;""!==r[a]&&a<r.length;)o=o+"\n"+r[a],a++;o=e.trim(o).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),l.text.push(o),l.times.push({identifier:s,start:0===n.Utility.convertSMPTEtoSeconds(i[1])?.2:n.Utility.convertSMPTEtoSeconds(i[1]),stop:n.Utility.convertSMPTEtoSeconds(i[3]),settings:i[5]})}s=""}return l}},dfxp:{parse:function(t){var i,o,s=0,a=(t=e(t).filter("tt")).children("div").eq(0),r=a.find("p"),l=t.find("#"+a.attr("style")),c={text:[],times:[]};if(l.length){var d=l.removeAttr("id").get(0).attributes;if(d.length)for(i={},s=0;s<d.length;s++)i[d[s].name.split(":")[1]]=d[s].value}for(s=0;s<r.length;s++){var u,h={start:null,stop:null,style:null};if(r.eq(s).attr("begin")&&(h.start=n.Utility.convertSMPTEtoSeconds(r.eq(s).attr("begin"))),!h.start&&r.eq(s-1).attr("end")&&(h.start=n.Utility.convertSMPTEtoSeconds(r.eq(s-1).attr("end"))),r.eq(s).attr("end")&&(h.stop=n.Utility.convertSMPTEtoSeconds(r.eq(s).attr("end"))),!h.stop&&r.eq(s+1).attr("begin")&&(h.stop=n.Utility.convertSMPTEtoSeconds(r.eq(s+1).attr("begin"))),i)for(var p in u="",i)u+=p+":"+i[p]+";";u&&(h.style=u),0===h.start&&(h.start=.2),c.times.push(h),o=e.trim(r.eq(s).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),c.text.push(o),0===c.times.start&&(c.times.start=2)}return c}},split2:function(e,t){return e.split(t)}},3!="x\n\ny".split(/\n/gi).length&&(n.TrackFormatParser.split2=function(e,t){var n,i=[],o="";for(n=0;n<e.length;n++)o+=e.substring(n,n+1),t.test(o)&&(i.push(o.replace(t,"")),o="");return i.push(o),i})}(n.$),function(e){e.extend(n.MepDefaults,{contextMenuItems:[{render:function(e){return void 0===e.enterFullScreen?null:e.isFullScreen?n.i18n.t("Turn off Fullscreen"):n.i18n.t("Go Fullscreen")},click:function(e){e.isFullScreen?e.exitFullScreen():e.enterFullScreen()}},{render:function(e){return e.media.muted?n.i18n.t("Unmute"):n.i18n.t("Mute")},click:function(e){e.media.muted?e.setMuted(!1):e.setMuted(!0)}},{isSeparator:!0},{render:function(e){return n.i18n.t("Download Video")},click:function(e){window.location.href=e.media.currentSrc}}]}),e.extend(MediaElementPlayer.prototype,{buildcontextmenu:function(t,n,i,o){t.contextMenu=e('<div class="mejs-contextmenu"></div>').appendTo(e("body")).hide(),t.container.bind("contextmenu",(function(e){if(t.isContextMenuEnabled)return e.preventDefault(),t.renderContextMenu(e.clientX-1,e.clientY-1),!1})),t.container.bind("click",(function(){t.contextMenu.hide()})),t.contextMenu.bind("mouseleave",(function(){t.startContextMenuTimer()}))},cleancontextmenu:function(e){e.contextMenu.remove()},isContextMenuEnabled:!0,enableContextMenu:function(){this.isContextMenuEnabled=!0},disableContextMenu:function(){this.isContextMenuEnabled=!1},contextMenuTimeout:null,startContextMenuTimer:function(){var e=this;e.killContextMenuTimer(),e.contextMenuTimer=setTimeout((function(){e.hideContextMenu(),e.killContextMenuTimer()}),750)},killContextMenuTimer:function(){var e=this.contextMenuTimer;null!=e&&(clearTimeout(e),delete e,e=null)},hideContextMenu:function(){this.contextMenu.hide()},renderContextMenu:function(t,n){for(var i=this,o="",s=i.options.contextMenuItems,a=0,r=s.length;a<r;a++)if(s[a].isSeparator)o+='<div class="mejs-contextmenu-separator"></div>';else{var l=s[a].render(i);null!=l&&(o+='<div class="mejs-contextmenu-item" data-itemindex="'+a+'" id="element-'+1e6*Math.random()+'">'+l+"</div>")}i.contextMenu.empty().append(e(o)).css({top:n,left:t}).show(),i.contextMenu.find(".mejs-contextmenu-item").each((function(){var t=e(this),n=parseInt(t.data("itemindex"),10),o=i.options.contextMenuItems[n];void 0!==o.show&&o.show(t,i),t.click((function(){void 0!==o.click&&o.click(i),i.contextMenu.hide()}))})),setTimeout((function(){i.killControlsTimer("rev3")}),100)}})}(n.$),function(e){e.extend(n.MepDefaults,{skipBackInterval:30,skipBackText:n.i18n.t("Skip back %1 seconds")}),e.extend(MediaElementPlayer.prototype,{buildskipback:function(t,n,i,o){var s=this,a=s.options.skipBackText.replace("%1",s.options.skipBackInterval);e('<div class="mejs-button mejs-skip-back-button"><button type="button" aria-controls="'+s.id+'" title="'+a+'" aria-label="'+a+'">'+s.options.skipBackInterval+"</button></div>").appendTo(n).click((function(){o.setCurrentTime(Math.max(o.currentTime-s.options.skipBackInterval,0)),e(this).find("button").blur()}))}})}(n.$),function(e){e.extend(n.MepDefaults,{postrollCloseText:n.i18n.t("Close")}),e.extend(MediaElementPlayer.prototype,{buildpostroll:function(t,n,i,o){var s=this,a=s.container.find('link[rel="postroll"]').attr("href");void 0!==a&&(t.postroll=e('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">'+s.options.postrollCloseText+'</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(i).hide(),s.media.addEventListener("ended",(function(n){e.ajax({dataType:"html",url:a,success:function(e,t){i.find(".mejs-postroll-layer-content").html(e)}}),t.postroll.show()}),!1))}})}(n.$),e.exports=n},function(e,t){e.exports='<div class="lyContent -w480 -h515 -flexColumWrap">\n    <header class="modalHeader">\n        <h1 class="title"><%- memberGroupName %> (<span class="_memberCount"><%- memberCount %></span>)</h1>\n        <% if(canManageMemberGroups) { %>\n        <button class="btnSettingManager _btnMoreMenu"><span class="gSrOnly">설정</span></button>\n        <div class="lyMenu _moreMenuLayer" style="margin-top: 13px;top: 30px;left: 16px;display:none;">\n            <ul>\n                <li><a href="#" class="btnListItem _modifyGroupName"><%- IM(\'band.member.group.edit_group_name\') %></a></li>\n            </ul>\n        </div>\n        <% } %>\n    </header>\n    <div class="modalBody -spaceNone -heightFlexWrap" style="height: 412px">\n        <% if(!isHideMemberGroupUseGuide) { %>\n        <div class="bandManagerSummary _bandManagerSummary">\n            <div class="bandManagerSummaryText">\n                <%- IM(\'band.member.group.how_to_mention\') %>\n            </div>\n            <button class="btnCloseSummary _btnCloseSummary"><span class="gSrOnly">운영멤버 설명글 닫기</span></button>\n        </div>\n        <% } %>\n        <form class="searchWrap _searchWrap">\n            <label for="searchMember1" class="searchIcon"><span class="gSrOnly">멤버 검색</span></label>\n            <span class="inputWrap">\n                <input type="text" id="searchMember1" class="inputSearch _inputSearch" placeholder="<%- IM(\'band_member_select.label.name\') %>">\n            </span>\n            <button type="submit" class="btnSearch uButton -sizeS -default -disabled _btnSearch"><%- IM(\'web.bandmember.search\') %></button>\n        </form>\n        <% if(canManageMemberGroups) { %>\n        <div class="btnGroupMemberAdd"><a href="#" role="button" class="button _addMembers"><%- IM(\'band.member.group.member_add_menu\') %></a></div>\n        <% } %>\n        <div class="modalContentWrap rScroll -lrSpace -tLine gMat-1 _groupMemberListRegion">\n\n        </div>\n        <div class="uEmpty _emptyWrap" style="height: 100%">\n            <span><%- IM(\'band.member.group.empty_list\') %></span>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine">\n        <button type="button" class="btnLyClose uButton -iconClose _btnLayerClose"><span class="gSrOnly">레이어 닫기</span></button>\n        <button type="button" class="uButton -confirm _btnLayerClose"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(82),s=n(1388);return t.View.extend({attributes:{"data-viewname":"DGroupBandMemberGroupItemDetailMemberItemView"},tagName:"li",className:"tLine",ui:{btnExcludeFromGroup:"._btnExcludeFromGroup"},events:{"click @ui.btnExcludeFromGroup":function(){this.trigger("groupMemberView:exclude_from_group",this.model)}},initialize:function(e){this._canManageMemberGroups=e.canManageMemberGroups},template:i.template(s),templateContext:function(){var e=o.makeProfileThumbnailUrl(this.model.get("profileImageUrl"));return{profileImageUrl:e,profileInnerClass:o.makeProfileInnerClass(e),canManageMemberGroups:this._canManageMemberGroups}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="flexList">\n<span class="thumb">\n    <%if (role==\'leader\'|| role==\'coleader\'){%>\n    <span class="uProfile -size40 -<%- role %>">\n    <% } else { %>\n    <span class="uProfile -size40">\n    <% } %>\n        <span class="profileInner <%- profileInnerClass %>">\n        <img src="<%- profileImageUrl %>" width="40" height="40" alt="">\n        </span>\n    </span>\n</span>\n    <span class="text">\n<span class="ellipsis -displayInlineBlock"><%- name %></span>\n</span>\n<% if(canManageMemberGroups) { %>\n<span class="etc">\n    <button class="uButton -sizeS -confirm2 _btnExcludeFromGroup"><%- IM(\'ui.label.delete\') %></button>\n</span>\n<% } %>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(1390),s=n(493),a=n(486),r=n(26),l=t.View.extend({attributes:{"data-viewname":"DGroupBandMemberGroupModifyNameView"},tagName:"section",className:"lyWrap",template:i.template(o),ui:{modifyMemberGroupName:"._modifyMemberGroupName",btnConfirm:"._btnConfirm",btnCancel:"._btnCancel"},events:{"keydown @ui.modifyMemberGroupName":"_setMemberGroupNameLimitMaxLength","keyup @ui.modifyMemberGroupName":function(){this.getUI("modifyMemberGroupName").val().trim().length>0?this.getUI("btnConfirm").addClass("-active").removeClass("-disabled").attr("disabled",!1):this.getUI("btnConfirm").removeClass("-active").addClass("-disabled").attr("disabled",!0)},"click @ui.btnConfirm":function(){this._setMemberGroupNameLimitMaxLength(),s.updateMemberGroup(this._bandNo,this._memberGroupId,this._modifyMemberGroupName).then(i.bind((function(){r.getBandChannel(this._bandNo).trigger(r.EVENT.REFRESH_MEMBER_GROUPS),this.trigger("modifyGroupName:resolved",this._modifyMemberGroupName),a.closeTop()}),this))},"click @ui.btnCancel":function(){a.closeTop()}},initialize:function(e){this._bandNo=e.bandNo,this._memberGroupName=e.memberGroupName,this._memberGroupId=e.memberGroupId},templateContext:function(){return{memberGroupName:this._memberGroupName}},_setMemberGroupNameLimitMaxLength:function(){var e=this.getUI("modifyMemberGroupName");e.val().trim().length>20&&e.val(e.val().trim().substr(0,20)),this._modifyMemberGroupName=e.val().trim()}});return l.buildLayerView=function(e,t,n){var i=new l({bandNo:e,memberGroupId:t,memberGroupName:n});return a.open(i),i},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="header">\n        <h1 class="title"><%- IM(\'band.member.group.edit_group_name\') %></h1>\n    </header>\n    <div class="main">\n        <p class="p"><%- IM(\'band.member.group.please_enter_name\') %></p>\n        <div class="p -tSpace">\n            <div class="uInput">\n                <label class="gSrOnly" for="modifyMemberGroupName"><%- IM(\'band.member.group.name\') %></label>\n                <input type="text" id="modifyMemberGroupName" class="_modifyMemberGroupName" maxlength="20" placeholder="<%- IM(\'band.member.group.name\') %>" value="<%- memberGroupName %>">\n                <span class="border"></span>\n            </div>\n        </div>\n    </div>\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _btnCancel"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -disabled _btnConfirm"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="_eachCommentRegion"></div>\n\n<%\nif ( moreCommentExistExceptLatest ) {\n    var existReplyCountText = IM(\'comment.reply_exist_with_the_count\', {count: replyCountExceptLatest});\n\n    if ( isRestricted ) {\n%>\n<span class="moreReply _openReplyListBtn"><%- existReplyCountText %></span>\n<%\n    } else {\n%>\n<button type="button" class="moreReply _openReplyListBtn"><%- existReplyCountText %></button>\n<%\n    }\n}\n%>\n<div class="_replyRegion"></div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(1060),o=n(508),s=t.Collection.extend({model:i,comparator:function(e){return e.getCommentId()},putComments:function(e){this.add(e,{add:!0,merge:!0,remove:!1,sort:!0})},isEmpty:function(){return 0==this.length},isAllCommentFetched:function(){return this.totalCount<=this.getMeaningfulLength()},getMeaningfulLength:function(){return 0==this.length?this.length:this.first().isMoreButton()||this.last().isMoreButton()?this.length-1:this.length},setTotalCount:function(e){this.totalCount=e},decreaseTotalCount:function(){this.totalCount--},getTotalCount:function(){return this.totalCount},removeMoreButtons:function(){this.remove(o.PREVIOUS_MORE_BUTTON_ID),this.remove(o.NEXT_MORE_BUTTON_ID)}});return s.buildDCommentViewCollection=function(){return new s},s}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent <%=lyWidth%>">\n    <header class="modalHeader">\n        <h1 class="title"><%= title %></h1>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            \x3c!-- [D] prev 버튼은 기본 display:none 상태이며, .btnNext 버튼 선택시 .tabWrap에 -alignR 추가하면 버튼 토글되도록 스타일 정의함 --\x3e\n            <div class="tabWrap _tabWrap">\n                <% if (emotions) { %>\n                <div class="prev">\n                    <button type="button" class="btnPrev _prevBtn"><span class="gSrOnly"><%= IM(\'ui.label.prev\') %></span></button>\n                </div>\n\n                <div class="tab _tab">\n                    <span class="cell sf_color<% if (!emotionType) { %> -on<% } %>"><button type="button" class="emotion _emotionTypeBtn"><strong><%= IM(\'ui.label.total_n\', {value: total}) %></strong></button></span>\n                    <% _.each(emotions, function(emotion) { %>\n                    <span class="cell sf_color<% if (emotionType === emotion.type) { %> -on<% } %>"><button type="button" class="emotion _emotionTypeBtn" data-emotion-type="<%= emotion.type %>"><span class="icon uFaceIcon -<%= emotion.iconName %>-s-20"><%= emotion.label %></span> <%= emotion.count %></button></span>\n                    <% }); %>\n                </div>\n\n                <div class="next">\n                    <button type="button" class="btnNext _nextBtn"><span class="gSrOnly"><%= IM(\'ui.label.next\') %></span></button>\n                </div>\n                <% } %>\n            </div>\n\n            <div class="gPal20 gPar20 _listRegion"></div>\n            <div class="gPal20 gPar20 _loading" style="display:none;"><div class="listLine rScroll -h360 _loadingRegion"></div></div>\n        </div>\n    </div>\n\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -confirm _confirmBtn"><%= IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<span class="thumb">\n    <span class="_profileImage"></span>\n</span>\n<span class="etc gMal5">\n    <span class="uFaceIcon -<%= emotionClass %>-34"><%= emotionLabel %></span>\n</span>\n<span class="text -ellipsis gPal5"><%- actorName %></span>'},function(e,t){e.exports='<% if (isChangeableProfiles) { %>\n<div class="selProfile _selProfile" data-member-type="<%-selectedMemberProfile.memberType%>">\n    <button type="button" class="_btnSelProfile"></button>\n\n    <div class="profileList">\n        <% _.each(memberProfiles, function(memberProfile) { %>\n        <button type="button" class="<%- (selectedMemberType === memberProfile.memberType) ? \'-outline\': \'\' %> _btnChangeMemberProfile" data-member-type="<%-memberProfile.memberType%>"></button>\n        <% }); %>\n    </div>\n</div>\n<% } %>\n\n<div class="list">\n    \x3c!-- 선택된 표정의 버튼에는 on 클래스 추가 --\x3e\n    <% _.each(emotions, function(emotion) { %>\n    <button type="button" class="btnEmotionItem _selectBtn<%- emotion.selected ? \' on\' : \'\' %>" data-emotion-type="<%- emotion.type %>">\n        <span class="uFaceIcon -<%= emotion.iconName %>"><%- emotion.label %></span>\n    </button>\n    <% }); %>\n</div>\n<span class="arrow _arrow"></span>'},function(e,t){e.exports='<% if (!hideInput) { %>\n<button type="button" class="selectFace _selectFace"><span class="gSrOnly"><%- IM(\'web.emotion.selectface.btn\') %></span></button>\n<div class="_emoticonSelectViewRegion"></div>\n<% } %>\n\n<% if (items.length === 0 && !hideInput) { %>\n<p class="firstText _giveMeFace"><%- IM(\'web.emotion.emptyface.txt\') %></p>\n<% } else if ( items.length > 0 ) { %>\n<div class="faceAddedList" >\n    <div class="_emotionFaceListRegion"></div>\n    <% if ( items.length > 0 ) { %>\n    <button type="button" class="moreFace _viewFace"><%- IM(\'web.emotion.moreface.label\') %></button>\n    <% } %>\n</div>\n<% } %>\n'},function(e,t){e.exports='<% if(clickAvailable) { %>\n<a href="#" class="_actorFace">\n<% } else { %>\n<span>\n<% } %>\n    <span class="uProfile -size34 -border <%- (isPageProfile) ? \'-pageProfile\': \'\' %>">\n        <span class="profileInner <%- profileInnerClass %>"><img src="<%- actorFaceThumb %>" width="21" height="21" alt="<%- IM(\'web.emotion.face.img.txt\', {userName: actorName}) %>" class="_profileImage" loading="lazy"></span>\n    </span>\n    <span class="uFaceIcon -<%= EmotionType.getIconName(emotionType) %>-s" style="<%= isMutedActorEmotion ? \'z-index:100;\' : \'\' %>"><%- EmotionType.getLabel(emotionType) %></span>\n<% if(clickAvailable) { %>\n</a>\n<% } else { %>\n</span>\n<% } %>'},function(e,t,n){var i;!function(o,s,a){var r;o((function(){r=o(a)}));function l(e,t,n,i){return e/=i,-n*(--e*e*e*e-1)+t}!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!s.requestAnimationFrame;++n)s.requestAnimationFrame=s[t[n]+"RequestAnimationFrame"],s.cancelAnimationFrame=s[t[n]+"CancelAnimationFrame"]||s[t[n]+"CancelRequestAnimationFrame"];s.requestAnimationFrame||(s.requestAnimationFrame=function(t,n){var i=(new Date).getTime(),o=Math.max(0,16-(i-e)),a=s.setTimeout((function(){t(i+o)}),o);return e=i+o,a}),s.cancelAnimationFrame||(s.cancelAnimationFrame=function(e){clearTimeout(e)})}();var c=function(e){this.$wrapEl=o(e.wrapEl),this.$preventSaveImageEl=o("<div class='preventSaveContent'></div>"),this.$imageEl=o("<img/>"),this.$imageEl.attr("src",e.imageSrc),e.useCORS&&this.$imageEl.attr("crossorigin","use-credentials"),this.imageWidth=e.imageWidth,this.imageHeight=e.imageHeight,this.maxZoom=e.maxZoom||200,this.useZoom=e.useZoom,this.onZoomListener=e.onZoom,this.useCORS=e.useCORS,this._viewerId="iv"+Math.floor(1e6*Math.random()),this._loaded=!1,this.EVENT={IMG_CORS_ERROR:"IMG_CORS_ERROR"},this._init()};c.prototype={constructor:c,_init:function(){var e=this,t=!1,n="."+e._viewerId;e._calculateDimensions();var i=(e.wrapElSize.width-e.initWidth)/2,o=(e.wrapElSize.height-e.initHeight)/2;e.$imageEl.css({position:"absolute",left:i+"px",top:o+"px",width:e.initWidth+"px",height:e.initHeight+"px",transform:"translate3d(0,0,0)",zIndex:1}),e.$wrapEl.append(e.$imageEl).append(this.$preventSaveImageEl),e.$imageEl.on("error"+n,(function(){e.$imageEl.off("error"+n),e.useCORS&&(e.$imageEl.removeAttr("crossorigin"),e.$imageEl.attr("src",e.$imageEl.attr("src")),e.$imageEl.trigger(e.EVENT.IMG_CORS_ERROR))})),e.$wrapEl.on("touchmove"+n+" mousewheel"+n+" DOMMouseScroll"+n,(function(e){e.preventDefault()})),e.$preventSaveImageEl.on("click"+n,(function(){if(e._mouseMove)return!1})),e.$preventSaveImageEl.on("touchstart"+n+" mousedown"+n,(function(i){if(i.preventDefault(),e._loaded&&!t){var o=("touchstart"==i.type?"touchmove":"mousemove")+n,s=("touchstart"==i.type?"touchend":"mouseup")+n,a=i.originalEvent,c=a.clientX||a.touches[0].clientX,d=a.clientY||a.touches[0].clientY,u=e.imageWidth*e.zoomValue/100,h=e.imageHeight*e.zoomValue/100,p=parseInt(e.$imageEl.css("top")),m=parseInt(e.$imageEl.css("left")),_=[{x:c,y:d},{x:c,y:d}];e._clearFrames(),e._dragMomentumCheck=setInterval((function(){e.currentPos&&(_.shift(),_.push({x:e.currentPos.x,y:e.currentPos.y}))}),50),e._mouseMove=!1;var g=function(n){if(n.preventDefault(),!t){e._mouseMove=!0;var i=(a=n.originalEvent).clientX||(a.touches?a.touches[0].clientX:0),o=a.clientY||(a.touches?a.touches[0].clientY:0),s=i-c,r=o-d,l=e.wrapElSize,_=u<l.width?(l.width-u)/2:Math.max(l.width-u,Math.min(0,m+s)),g=h<l.height?(l.height-h)/2:Math.max(l.height-h,Math.min(0,p+r));e.currentPos={x:i,y:o},e.$imageEl.css({left:_,top:g})}},f=function(){if(r.off(o,g),r.off(s,f),clearInterval(e._dragMomentumCheck),!t&&e._mouseMove){var n=_[1].x-_[0].x,i=_[1].y-_[0].y;if(Math.abs(n)>30||Math.abs(i)>30){var a=1,c=0,d=0,p=parseInt(e.$imageEl.css("top")),m=parseInt(e.$imageEl.css("left"));!function t(){a<=60&&(e._dragMomentumFrame=requestAnimationFrame(t)),c+=l(a,n/3,-n/3,60),d+=l(a,i/3,-i/3,60);var o=e.wrapElSize,s=u<o.width?(o.width-u)/2:Math.max(o.width-u,Math.min(0,m+c)),r=h<o.height?(o.height-h)/2:Math.max(o.height-h,Math.min(0,p+d));e.$imageEl.css({left:s,top:r}),a++}()}}};r.on(o,g),r.on(s,f)}})),e.$preventSaveImageEl.on("wheel"+n,(function(n){return n.ctrlKey?function(t){if(!e._loaded||!e.useZoom)return;e._clearFrames();var n=-Math.max(-1,Math.min(1,t.originalEvent.deltaY)),i=e.zoomValue*(100+15*n)/100;(i<e.minZoom||i>e.maxZoom)&&n==s?a+=Math.abs(n):a=0;if(s=n,a>5)return;t.preventDefault(),e.zoom(i,{x:t.pageX||t.originalEvent.pageX,y:t.pageY||t.originalEvent.pageY})}(n):function(n){if(!e._loaded||t)return;e._clearFrames();var i=e.wrapElSize,o=-Math.max(-1,Math.min(1,n.originalEvent.deltaX)),s=-Math.max(-1,Math.min(1,n.originalEvent.deltaY)),a=e.imageHeight*e.zoomValue/100,r=e.imageWidth*e.zoomValue/100,l=i.height-a,c=i.width-r,d=(i.height-a)/2,u=(i.width-r)/2,h=e.$imageEl.css(["top","left"]),p=parseFloat(h.top)+15*s,m=parseFloat(h.left)+15*o;p=a<i.height?d:Math.max(l,Math.min(0,p)),m=r<i.width?u:Math.max(c,Math.min(0,m)),e.$imageEl.css({top:p,left:m}),n.preventDefault()}(n)}));var s=0,a=0;e.$preventSaveImageEl.on("touchstart"+n,(function(n){if(e._loaded&&e.useZoom){var i=n.originalEvent.touches[0],o=n.originalEvent.touches[1];if(i&&o){t=!0;var s=Math.sqrt(Math.pow(o.pageX-i.pageX,2)+Math.pow(o.pageY-i.pageY,2)),a=e.zoomValue,l={x:(o.pageX+i.pageX)/2-parseFloat(e.$imageEl.css("left")),y:(o.pageY+i.pageY)/2-parseFloat(e.$imageEl.css("top"))},c=function(t){t.preventDefault();var n=t.originalEvent.touches[0],i=t.originalEvent.touches[1],o=Math.sqrt(Math.pow(i.pageX-n.pageX,2)+Math.pow(i.pageY-n.pageY,2)),r=a+(o-s)/2;e.zoom(r,l)},d=function(){r.off("touchmove",c),r.off("touchend",d),t=!1};r.on("touchmove",c),r.on("touchend",d)}}})),e.$imageEl[0].complete?e._loaded=!0:e.$imageEl.one("load",(function(){e._loaded=!0}))},_calculateDimensions:function(){this.wrapElSize={width:this.$wrapEl.innerWidth(),height:this.$wrapEl.innerHeight()};var e=this.imageWidth,t=this.imageHeight,n=this.$wrapEl.width(),i=this.$wrapEl.height();e>n&&(t*=n/e,e=n),t>i&&(e*=i/t,t=i),this.minZoom=this.zoomValue=e/this.imageWidth*100,this.initWidth=e,this.initHeight=t},_clearFrames:function(){clearInterval(this._dragMomentumCheck),cancelAnimationFrame(this._zoomFrame),cancelAnimationFrame(this._dragMomentumFrame)},zoom:function(e,t,n){e=Math.max(this.minZoom,e),e=Math.min(this.maxZoom,e),t="boolean"==typeof t?{x:this.wrapElSize.width/2,y:this.wrapElSize.height/2}:t||{x:this.wrapElSize.width/2,y:this.wrapElSize.height/2};var i=this,o=this.zoomValue,s=this.$imageEl,a=this.wrapElSize,r=parseFloat(s.css("left")),c=parseFloat(s.css("top"));i._clearFrames();var d=0;!function u(){++d<20&&(i._zoomFrame=requestAnimationFrame(u));var h,p,m,_,g=l(d,o,e-o,20),f=g/o,b=i.imageWidth*g/100,v=i.imageHeight*g/100,A=-((t.x-r)*f-t.x),E=-((t.y-c)*f-t.y);p=E,E=(h=v)<=a.height?(a.height-h)/2:p>0?0:a.height-h>p?a.height-h:p,_=A,A=(m=b)<=a.width?(a.width-m)/2:_>0?0:a.width-m>_?a.width-m:_,s.css({top:E+"px",left:A+"px",width:b+"px",height:v+"px"}),i.zoomValue=g,n||i.onZoomListener(g),b<a.width&&v<a.height?i.$preventSaveImageEl.css({cursor:"default","z-index":"1"}):i.$preventSaveImageEl.css({cursor:"move","z-index":"3"})}()},refresh:function(){if(this._loaded){this._clearFrames();var e=(this.zoomValue-this.minZoom)/(this.maxZoom-this.minZoom);this._calculateDimensions(),this.zoomValue=(this.maxZoom-this.minZoom)*e+this.minZoom,this.zoom(this.zoomValue)}},destroy:function(){var e="."+this._viewerId;this.$imageEl.off(e),this.$wrapEl.off(e),this.$preventSaveImageEl.off(e)}},void 0===(i=function(){return c}.call(t,n,t,e))||(e.exports=i)}(window.jQuery,window,document)},function(e,t,n){var i=n(0),o=n(10),s=n(505),a=n(516),r=n(82),l=n(506),c=n(156),d="BLOB",u="PHOTO",h="VIDEO",p="AUDIO",m="FILE";function _(e){this._bandNo=e.bandNo,this._entryType=e.entryType,this._entryName=e.entryName,this._contentUrl=e.contentUrl,this._contentKey=e.contentKey,this._contentBlob=e.contentBlob,this._folderNames=e.folderNames,this._fileUrl=null}function g(){this._entries=[]}_.prototype.getEntryPathName=function(){var e=c.convertToSafeFileNameAgainstOS(o.trim(this._entryName));if(this._fileUrl){var t=c.getFileExtension(this._fileUrl);t&&(t="."+t,o.endsWith(e.toLowerCase(),t)||(e+=t))}var n=i.map(this._folderNames,(function(e){return c.convertToSafeFileNameAgainstOS(o.trim(e))}));return n.length>0?n.join("/")+"/"+e:e},_.prototype.hasFailureMark=function(){return!0===this._failureMark},_.prototype.markFailure=function(){this._failureMark=!0},_.prototype.getEntryLog=function(){return{entryType:this._entryType,entryName:this._entryName,bandNo:this._bandNo,contentUrl:this._contentUrl,contentKey:this._contentKey?this._contentKey.toApiParams(!1):null,contentBlob:this._contentBlob?this._contentBlob.size:null,folderNames:this._folderNames,fileUrl:this._fileUrl}},_.prototype.fetchStream=function(e){return this._entryType===d?Promise.resolve(this._contentBlob.stream()):this._fetchUrl().then(i.bind((function(t){return this._fileUrl=t,this._fetchFile(e)}),this))},_.prototype._fetchFile=function(e){return fetch(this._fileUrl,{signal:e}).then((function(e){if(e.ok)return e.body;throw new Error("File fetch error - "+e.status)}))},_.prototype._fetchUrl=function(){if(this._fileUrl)return Promise.resolve(this._fileUrl);if(this._entryType===d)return Promise.resolve(null);if(this._entryType===u){var e=r.makeOriginalCorsUrl(this._contentUrl);return Promise.resolve(e)}var t=this._contentKey.getContentType();return t.isPostComment()||t.isPostCommentReply()?this._fetchCommentAttachmentUrl():Promise.reject("Unknown entry type")},_.prototype._fetchCommentAttachmentUrl=function(){var e=this._contentKey.toApiParams(!0);switch(this._entryType){case h:return this._getUrlPromise(a.getVideoUrlByComment(this._bandNo,e,!0),"download.480p");case p:return this._getUrlPromise(s.getCommentAudioUrl(this._bandNo,e,!0),"audio_url");case m:return this._getUrlPromise(s.getCommentFileUrl(this._bandNo,e,!0),"file_url");default:return Promise.reject("Unknown entry type")}},_.prototype._getUrlPromise=function(e,t){return new Promise((function(n,o){e.then((function(e){var i=l.get(e,t);i?n(i):o("empty - "+t)}),(function(e){o(i.isObject(e)?JSON.stringify(e):e)}))}))},g.prototype._addEntry=function(e){return this._entries.push(new _(e)),this},g.prototype.addBlob=function(e,t,n,i){return this._addEntry({entryType:d,bandNo:e,entryName:t,contentBlob:n,folderNames:i})},g.prototype.addPhoto=function(e,t,n,i){return this._addEntry({entryType:u,bandNo:e,entryName:t,contentUrl:n,folderNames:i})},g.prototype.addVideo=function(e,t,n,i){return this._addEntry({entryType:h,bandNo:e,entryName:t,contentKey:n,folderNames:i})},g.prototype.addAudio=function(e,t,n,i){return this._addEntry({entryType:p,bandNo:e,entryName:t,contentKey:n,folderNames:i})},g.prototype.addFile=function(e,t,n,i){return this._addEntry({entryType:m,bandNo:e,entryName:t,contentKey:n,folderNames:i})},g.prototype.size=function(){return this._entries.length},g.prototype.toArray=function(){return this._entries.slice()},g.create=function(){return new g},e.exports=g},function(e,t){e.exports='<div class="lyContent -w360">\n    <% if (title) { %>\n    <header class="modalHeader">\n        <h1 class="title -multiEllipsis2"><%- title %></h1>\n    </header>\n    <% } %>\n\n    <div class="modalBody gPat16 gPal20 gPar20">\n        <div class="progress <%- skinColor %>">\n            <div class="inner">\n                <p class="fileName"><%= desc ? desc : \'&nbsp;\' %></p>\n                <span class="fileBy _progressText">&nbsp;</span>\n                <div class="progressBar"><div class="bar sf_bg _progressBar" style="width:0%;"></div></div>\n            </div>\n        </div>\n    </div>\n\n    <footer class="modalFooter">\n        <% if (!noCancel) { %>\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <% } %>\n    </footer>\n</div>\n'},function(e,t){e.exports='<div class="lyContent -w360">\n\t<header class="modalHeader -noTitlebar">\n\t\t<h1 class="title gSrOnly"><%- IM(\'unsupported_browser.msg.description\') %></h1>\n\t</header>\n\t<div class="modalBody">\n\t\t<div class="modalContentWrap">\n\t\t\t<h2 class="modalContentTitle -center gMat30">\n\t\t\t\t<strong class="mainTitle -small gPat14"><%= nl2br(IM(\'unsupported_browser.msg.description\')) %></strong>\n\t\t\t\t<span class="subTitle gMat6"><%= nl2br(isSuggestWhale ? IM(\'unsupported_browser.msg.browsers_suggestion\') : IM(\'unsupported_browser.msg.browsers_suggestion.with_edge\')) %></span>\n\t\t\t</h2>\n\t\t</div>\n\t</div>\n\t<div class="modalFooter">\n\t\t<a href="https://www.google.com/chrome/" target="_blank" class="btnDownLoad -chrome"><%- IM(\'chrome_download\') %></a>\n\t\t<% if (isSuggestWhale) { %>\n\t\t<a href="https://whale.naver.com/download" target="_blank" class="btnDownLoad -whale"><%- IM(\'whale_download\') %></a>\n\t\t<% } else { %>\n\t\t<a href="https://www.microsoft.com/edge" target="_blank" class="btnDownLoad -edge"><%- IM(\'edge_download\') %></a>\n\t\t<% } %>\n\t\t<button type="button" class="btnLyClose uButton -iconClose _closeBtn"><span class="gSrOnly"><%- IM(\'ui.label.close\') %></span></button>\n\t</div>\n</div>'},function(e,t,n){var i=n(0),o=n(4),s=n(600),a=n(507),r=n(537),l=o.Object.extend({initialize:function(e){this._element=e.element,this._count=e.count||i.constant(0),this._limit=e.limit||1,this._skinColor=e.skinColor,this._createUploader()},onBeforeDestroy:function(){this._destroyUploader()},_destroyUploader:function(){this._uploader&&(this._uploader.destroy(),this._uploader=null)},_createUploader:function(){this._destroyUploader(),this._uploader=s.createPhotoUploader(this._element,{multiple:this._limit>1,accept:r.getStillImageAccept(),autoUpload:!0,fileInputTitle:IM("ui.label.upload_photo"),skinColor:this._skinColor}),this.listenTo(this._uploader,a.BEFORE_VALIDATE,(function(){var e=r.getStillImageValidator({count:this._count(),limit:this._limit});this._uploader.setValidators([e])})),this.listenTo(this._uploader,a.INPUT_CLICK,(function(e){this.trigger("inputClick",e)})),this.listenTo(this._uploader,a.UPLOAD_COMPLETE,(function(e){var t=i.map(e.resultList,(function(e){return{url:e.url,width:e.width,height:e.height}}));this.trigger("complete",t)}))}});l.createUploader=function(e){return new l(e)},e.exports=l},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i=n(13),o="/v2.0.0/cancel_mission_confirm",s="/v2.0.0/get_mission_confirm_posts_with_mission",a="/v2.0.0/get_mission_confirm_posts_with_author";return{getApiClient:function(){return this.apiClient||(i.isLogedIn()?this.apiClient=t.getLoginV1Client():this.apiClient=t.getNoLoginV1Client()),this.apiClient},cancelMissionConfirmPost:function(e,n){return t.getLoginV1Client().send({url:"https://api.band.us"+o,data:{post_no:n,band_no:e}}).fail((function(e){alert(e.result_data.message)}))},getMissionConfirmPostsWithMission:function(e){return t.getLoginV1Client().send({url:"https://api.band.us"+s,data:e})},getMissionConfirmPostsWithAuthor:function(e){return this.getApiClient().send({url:"https://api.band.us"+a,data:e})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{PREVIEW:"PREVIEW",PREVIEW_TIME_OVER:"PREVIEW_TIME_OVER",STARTING:"STARTING",LOADING:"LOADING",PLAYING:"PLAYING",ENDED:"ENDED",FORCE_ENDED:"FORCE_ENDED"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(52),o=n(34),s=n(529),a={NORMAL:"NORMAL",HIDDEN:"HIDDEN",BLIND:"BLIND",RECLAIM:"RECLAIM",CANCEL:"CANCEL"},r=t.Model.extend({default:function(){return{mid:null,sender:null,videoOffset:null,messageTime:null,messageTypeCode:null,messageStatusType:null,content:null,extras:null,createdAt:null,updatedAt:null}},idAttribute:"mid",parse:function(e){var t=i.camelizeKeys(e),n=t.sender;return t.mid=t.messageTime+"_"+n.memberKey,t.sender=s.buildContentAuthorModel(n),t},getLiveChatMessageSender:function(){return this.get("sender")},getLiveChatMessageVideoOffset:function(){return this.get("videoOffset")},getLiveChatMessageMessageTime:function(){return this.get("messageTime")},getLiveChatMessageTypeCode:function(){return this.get("messageTypeCode")},getLiveChatMessageStatusType:function(){return this.get("messageStatusType")},setLiveChatMessageStatusType:function(e){this.isBlindLiveChatMessage()||(e==a.CANCEL&&(e=a.NORMAL),this.set("messageStatusType",e))},getLiveChatMessageContent:function(){return this.get("content")},getLiveChatMessageExtras:function(){return this.get("extras")},getLiveChatMessageCreatedAt:function(){return this.get("createdAt")},getLiveChatMessageUpdatedAt:function(){return this.get("updatedAt")},isNormalLiveChatMessage:function(){return this.getLiveChatMessageStatusType()==a.NORMAL},isHiddenLiveChatMessage:function(){return this.getLiveChatMessageStatusType()==a.HIDDEN},isBlindLiveChatMessage:function(){return this.getLiveChatMessageStatusType()==a.BLIND},isSameLiveChatMessage:function(e){return!!e&&e.get("mid")==this.get("mid")},isTextLiveChatMessage:function(){return 1==this.getLiveChatMessageTypeCode()}});return r.MESSAGE_STATUS_TYPE=a,r.buildFromLiveChatReceivedMessage=function(e){var t=o.parse(e.profile||{});return t.member_key=e.mbrKey,new r({sender:t,videoOffset:e.offset,messageTime:e.msgTime,messageTypeCode:e.msgTypeCode,messageStatusType:a.NORMAL,content:e.msg,extras:o.parse(e.extras||"{}"),createdAt:e.ctime,updatedAt:e.utime},{parse:!0})},r.buildFromLiveChatMessage=function(e){var t=o.parse(e.profile||{});return t.member_key=e.memberKey,new r({sender:t,videoOffset:e.videoOffset,messageTime:e.messageTime,messageTypeCode:e.messageTypeCode,messageStatusType:e.messageStatusType,content:e.content,extras:o.parse(e.extras||"{}"),createdAt:e.createTime,updatedAt:e.updateTime},{parse:!0})},r.buildFromLiveVodMessage=function(e){return new r({sender:e.creator,videoOffset:e.video_offset,messageTime:e.message_time,messageTypeCode:e.type,messageStatusType:e.message_status_type,content:e.content,extras:o.parse(e.extras||"{}"),createdAt:e.created_at},{parse:!0})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(1184);t.EVENT=i.extend({COMPLETED_PLAYING:"completedPlaying",PROTOCOL_CHANGED:"protocolChanged",STALL_OCCURRED:"stallOccurred",SLOW_NETWORK_DETECTED:"slowNetworkDetected",ERROR_OCCURRED:"errorOccurred",ERROR_RECOVERED:"errorRecovered",FATAL_ERROR_OCCURRED:"fatalErrorOccurred"},o),t.FATAL_ERROR={NETWORK_ERROR:"NETWORK_ERROR",SOURCE_ERROR:"SOURCE_ERROR",NOT_SUPPORT_BROWSER_ERROR:"NOT_SUPPORT_BROWSER_ERROR"},t.VIDEO_QUALITY=["360P","480P","720P"]},function(e,t,n){var i;void 0===(i=function(e){var t=n(0);return n(4).View.extend({attributes:{"data-viewname":"DVideoBigPlaybackButtonView"},className:"livingStopState",template:t.template('<button class="btnLivePlay"><span class="gSrOnly"><%-IM("web.audioplayer.player.btn.play")%></span></button>'),triggers:{click:{event:"clickPlayback",preventDefault:!0,stopPropagation:!1}},toggleBtnDisplay:function(e){this.$el.toggleClass("-btnHide",!e)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(1409),o=t.Collection.extend({model:i,initialize:function(e,t){this._bandNo=t.bandNo,this._contentKeyButCommentId=t.contentKeyButCommentId,this._pagingData={},this._totalCount=0},getTotalCount:function(){return this._totalCount},populateSimpleCommentData:function(e){return e?(this._totalCount=e.totalCount||e.total,this.reset(e.comments||e.items),this._pagingData=e.paging||{},this._pagingData.update_param=e.update_param,this):this},getContentKeyButCommentId:function(){return this._contentKeyButCommentId}});return o.buildSimpleCommentCollection=function(e){return new o([],e)},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(660);return i.Model.extend(t.extend({},o,{getFileSource:function(){return this._getFile().source},getFileName:function(){return this._getFile().name},getFileSize:function(){return this._getFile().size},getExpires:function(){return this._getFile().expiresAt},getFileLink:function(){return this._getFile().link},_getFile:function(){return this.get("file")||{}}}))}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2225),s=n(486),a=n(1623),r=n(154),l=i.View.extend({attributes:{"data-viewname":"DGetGuardianAgreementConfirmView"},template:t.template(o),serializeData:function(){return{noticeMessage:this.options.noticeMessage}},ui:{btnConfirm:"._btnConfirm",btnCancel:"._btnCancel"},events:{"click @ui.btnConfirm":"startGetGuardianAgreementProcess","click @ui.btnCancel":"cancelGuardianAgreementProcess"},startGetGuardianAgreementProcess:function(){a.openGetGuardianAgreement({type:this.options.type,birthdate:this.options.birthday,callback:t.bind((function(e){if(!r.isNotActiveView(this)){var n=this.options.onAfterGuardianAgreementCompleted;this.destroy(),1===e.resultCode?t.isFunction(n)&&n():e.message&&alert(e.message)}}),this)})},cancelGuardianAgreementProcess:function(){var e=this.options.onAfterGuardianAgreementCanceled;t.isFunction(e)&&e(),this.destroy()}});return l.openAsLayer=function(e){var t=new l({noticeMessage:e.noticeMessage,type:e.type||null,birthday:e.birthday,onAfterGuardianAgreementCompleted:e.onAfterGuardianAgreementCompleted,onAfterGuardianAgreementCanceled:e.onAfterGuardianAgreementCanceled||null});s.open(t)},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){var e=/^([-+]?(?:[1-8]?\d(?:\.\d+)?|90(?:\.0+)?)),\s*([-+]?(?:180(?:\.0+)?|(?:(?:1[0-7]\d)|(?:[1-9]?\d))(?:\.\d+)?))$/;function t(t){return"string"==typeof t&&e.test(t)}function n(e,n){if(this._lat=e,this._lng=n,this._urlValue=function(e,t){return e+","+t}(e,n),!t(this._urlValue))throw new Error("Invalid latitude or longitude")}return n.prototype.toUrlValue=function(){return this._urlValue},n.prototype.lat=function(){return this._lat},n.prototype.lng=function(){return this._lng},n.prototype.latLng=function(){return{lat:this._lat,lng:this._lng}},n.prototype.coordinates=function(){return{latitude:this._lat,longitude:this._lng}},n.isValidGeoUrlValue=t,n.fromCoordinates=function(e){return new n(e.latitude,e.longitude)},n.fromGeoUrlValue=function(i){if(!t(i))throw new Error("Invalid geo url Value");var o=e.exec(i);return new n(Number(o[1]),Number(o[2]))},n}.call(t,n,t,e))||(e.exports=i)},function(e,t){},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=function(e){t.each(e,(function(e){i(e.target).trigger("intersect",e)}))},a=new IntersectionObserver(s);return o.Behavior.extend({events:{intersect:function(e){e.preventDefault(),e.stopPropagation()}},initialize:function(e){this._observations=e.observations,this._viewObservers=[],this._globalObserverElements=[]},onBeforeRender:function(){this._stopObserving()},onDomRefresh:function(){this._startObserving()},onBeforeDetach:function(){this._stopObserving()},_startObserving:function(){t.each(this._getObservations(),(function(e){e.root?this._startViewObserving(e):this._startGlobalObserving(e)}),this)},_stopObserving:function(){for(;this._globalObserverElements.length>0;)a.unobserve(this._globalObserverElements.shift());for(;this._viewObservers.length>0;)this._viewObservers.shift().disconnect()},_startViewObserving:function(e){var n=new IntersectionObserver(s,{root:e.root,rootMargin:e.rootMargin,threshold:e.threshold});this._viewObservers.push(n),t.each(e.elements,(function(e){n.observe(e)}))},_startGlobalObserving:function(e){t.each(e.elements,(function(e){a.observe(e),this._globalObserverElements.push(e)}),this)},_getObservations:function(){var e=this._observations;return t.isFunction(e)&&(e=e()),t.isArray(e)||(e=[e]),t.map(e,(function(e){var n=e.elements,i=e.root;return t.isString(n)&&(n=this.view.$(n).toArray()),t.isString(i)&&(i=this.view.$(i).get(0)),{elements:n,root:i,rootMargin:e.rootMargin,threshold:e.threshold}}),this)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(6),s=n(1024),a=n(627),r=o.Collection.extend({model:s,modelId:function(e){return e.folderId||e.folder_id},fetchFolders:function(e){return a.getFolders(e).then(i.bind((function(e){this.reset(e.items,{parse:!0})}),this))},searchFolders:function(e,t){return a.searchFolders(e,t).then(i.bind((function(e){this.reset(e.items,{parse:!0})}),this))},sortByUpdateDesc:function(){this._sortBy((function(e){return-(e.getFolderLatestFileCreatedAt()||e.getFolderCreatedAt())}))},sortByNameAsc:function(){this._sortBy((function(e){return e.getFolderName()}))},_sortBy:function(e){this.comparator=e,this.sort()}});r.build=function(e){return new r(e,{parse:!0})},e.exports=r},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(158),s=n(10),a=n(206),r=n(188),l=n(61),c=n(718),d=n(488),u=/(\n)?<band:attachment type="([a-z0-9_]+)"(?: id="([a-zA-Z0-9]+)")? \/>(\n)?/g,h=new RegExp(l.BAND_MEMBER_MENTION_REG_STR,"g"),p=new RegExp(l.BAND_MEMBER_GROUP_MENTION_REG_STR,"g"),m=/<band:hashtag>(.+?)<\/band:hashtag>/g,_=/(\n)?<band:attachment[\s\S]*?<\/band:attachment>(\n(?=<band:attachment>))?/g,g=/<p[\s\S]*?>([\s\S]*?)<\/p>/g,f=/<input[\s\S]*?\/>/g,b=new RegExp('(\\S\\S\\S?)(<span[\\s\\S]*?class="'+d.ELEMENT.HASHTAG+'"[\\s\\S]*?>)#',"g"),v=new RegExp('(class="'+d.ELEMENT.HASHTAG+'"[\\s\\S]*?>#.*?</span>)(\\S[^/])?',"g");return{convertToHtml:function(e){if(!e||!e.get("content"))return"";var t=e.get("content").trim();t=(t=(t=(t=(t=(t=t.replace(u,(function(t,n,i,o,a){var r=e.getAttachment(s.camelize(i)),l=n?"\n\n":"",c=a?"\n\n":"";return r?o?r.get(o)?l+'<band:attachment&tnbsp;data-cke-filter="off"&tnbsp;type="'+i+'"&tnbsp;id="'+o+'"></band:attachment>'+c:"":l+'<band:attachment&tnbsp;data-cke-filter="off"&tnbsp;type="'+i+'"></band:attachment>'+c:""}))).replace(/<\/band:attachment>\n\n(?=<band:attachment)/g,"</band:attachment>\n\n\n")).replace(m,(function(e,t){return'<span&tnbsp;data-cke-filter="off"&tnbsp;data-nostyle="true"&tnbsp;class="'+d.ELEMENT.HASHTAG+'">'+t+"</span>"}))).replace(o.URL_REGEX,(function(e){return'<span&tnbsp;data-cke-filter="off"&tnbsp;data-nostyle="true"&tnbsp;class="gOuterLink">'+e+"</span>"}))).replace(h,(function(e,t,n,i){return'<span&tnbsp;data-cke-filter="off"&tnbsp;class="mentionUser&tnbsp;_modificationMemberMention"&tnbsp;data-userno="'+t+'"&tnbsp;style="display:inline-block;vertical-align:top;">'+i+"</span>"}))).replace(p,(function(e,t,n){return'<span&tnbsp;data-cke-filter="off"&tnbsp;class="mentionUser&tnbsp;_modificationMemberGroupMention"&tnbsp;data-member-group-id="'+t+'"&tnbsp;style="display:inline-block;vertical-align:top;">'+n+"</span>"})),t=a.convertToEditorFontTag(t);var n=function(e){return e.replace(/ /g,"&nbsp;").replace(/&tnbsp;/g," ")};return t="\n"+t+"\n",t=i.reduce(t.split("\n"),(function(e,t){if(0===t.indexOf("<ul>")){var i=t.split("</ul>");e.push(n(i[0])),e.push("</ul>"),e.push("<p>"),e.push(n(i[1])),e.push("</p>")}else if(0===t.indexOf("<ol>")){i=t.split("</ol>");e.push(n(i[0])),e.push("</ol>"),e.push("<p>"),e.push(n(i[1])),e.push("</p>")}else e.push("<p>"),e.push(n(t)),e.push("</p>");return e}),[]).join("")},convertNewLineToP:function(e,t){var n=t?e:i.escape(e);return i.reduce(n.split("\n"),(function(e,t){return e.push("<p>"),e.push(t),e.push("</p>"),e}),[]).join("")},removeHtmlComments:function(e){return e.replace(/<!--(.*?)-->/g,"")},removeListElements:function(e){return e.replace(/<\/?ul>|<\/?li>/g,"")},convertToText:function(e){if(!e)return"";var n=e;return n=(n=n.replace(new RegExp("<span [^<>]+\\b"+c.PLACE_HOLDER_CLASS+"\\b[^<>]+>.*?<\\/span>"),"")).replace(/(&nbsp;)|[\u3000]/g," "),(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=a.convertToApiFontTag(n)).replace(/\n/g,"")).replace(/<br\s?\/?>/g,"")).replace(b,(function(e,t,n){return"<p>"==t?e:t+" "+n+"#"}))).replace(v,(function(e,t,n){return i.isUndefined(n)?e:t+" "+n}))).replace(/<\/?span[\s\S]*?>/g,"")).replace(/<\/?font[\s\S]*?>/g,"")).replace(/\u00a0+$/,"")).replace(/<(b|i|u|del)(\s+[^>]*?)>/gi,(function(e,t,n){return e.replace(n,"")}))).replace(g,(function(e,n){return t.trim(n)?n+"\n":"\n"}))).replace(/<\/?p[\s\S]*?>/g,"")).replace(/\n$/,"")).replace(f,(function(e){var n=t(e);if(n.hasClass("_mentionMember"))return'<band:refer user_no="'+n.attr("data-userno")+'">'+r.escapeForBandContents(n.attr("value"))+"</band:refer>";if(n.hasClass("_mentionMemberGroup")){var i=r.escapeForBandContents(n.attr("value"));return'<band:refer_members group_id="'+n.data("member-group-id")+'">'+i+"</band:refer_members>"}return""}))).replace(_,(function(e,n,i){var o=t(e),s=o.attr("type"),a=o.attr("id");return void 0===a?'<band:attachment type="'+s+'" />':'<band:attachment type="'+s+'" id="'+a+'" />'}))).trim()},makePlaceholderByBandOpenType:function(e){var t=IM("web.post.write.placeholder");return e?t+="<br>"+IM("post.editor.public_band_placeholder"):t}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{MARKDOWN:1}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){n(2);var t=n(4),i=n(13),o=n(162),s=n(538);return t.Behavior.extend({initialize:function(e,t){this._bandNo=e.bandNo,this._view=t,this._isLogged()||this._goPageHome()},onAttach:function(){this._isLogged()&&s.getBandOption(this._bandNo).then(_.bind((function(e){e.isPermittedAccessBandStats()?this._view.viewStart():this._goPageHome()}),this)).fail(_.bind((function(){this._goPageHome()}),this))},_isLogged:function(){return!!i.isLogedIn()},_goPageHome:function(){o.PAGE_BAND_HOME.goDForced({band_no:this._bandNo})}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(158),a=n(589),r=n(153),l=n(162),c=n(26),d=n(2458),u=n(487),h=n(163),p=n(155),m=n(154),_=n(1125),g=/youtube/i,f=o.View.extend({options:{bPostDetail:!1},className:"dPostTextView",attributes:{"data-viewname":"DPostTextView"},template:t.template(d),behaviors:[u],ui:{postText:"._postText",bandRefer:"[data-uiselector=bandRefer]",showMentionedMemberGroup:"._showMentionedMemberGroup",bandHashTag:"[data-uiselector=bandHashTag]"},events:{"click a":function(e){var t=i(e.currentTarget).attr("href");t&&this._sendUrlClickMessage(t),g.test(t)&&c.getDGlobalChannel().trigger(c.EVENT.YOUTUBE_LINK_OPEN),e.stopPropagation()},"click @ui.postText":"_showPostDetailLayer","click @ui.bandRefer":"_openReferUserProfile","click @ui.showMentionedMemberGroup":"_openMemberGroupLayer","click @ui.bandHashTag":"_searchHashTagOrShowPostDetailLayer"},initialize:function(e){this.bandNo=e.bandNo,this.postNo=e.postNo,this.guideBand=e.guideBand,this.preventMentionAnchor=e.preventMentionAnchor,this.isRestricted=e.isRestricted,this.textModel=e.model,this.textModel&&this.textModel.get("content")&&""!=this.textModel.get("content")?this.textContent=this.textModel.get("content"):e.textContent&&(this.textContent=e.textContent),this.hasAttachment=e.hasAttachment,this.bPostDetail=e.bPostDetail},serializeData:function(){return{bPostDetail:this.bPostDetail,content:this._getSplitBodyContents(),isRestricted:this.isRestricted}},onRender:function(){""==this.textContent&&this.ui.postText.hide()},_sendUrlClickMessage:function(e){this.jplClick(u.CLASSIFIER.URL_IN_POST,{band_no:this.bandNo,post_no:this.postNo,url:e,type:"url_open"})},_openReferUserProfile:function(e){if(this.options.bPostDetail&&this.options.clickDisabledPostTypeOnDetail)return!1;var t=i(e.currentTarget);return a.openMemberProfileLayer(new h({name:t.text(),profileImageUrl:null,memberType:"membership"}),t.data("no"),this.bandNo),!1},_openMemberGroupLayer:function(e){if(this.options.bPostDetail&&this.options.clickDisabledPostTypeOnDetail)return!1;var t=i(e.currentTarget);return _.buildAsyncLayerView(this.bandNo,t.data("member-group-id")),!1},_searchHashTagOrShowPostDetailLayer:function(e){if(this.options.bPostDetail&&this.options.clickDisabledPostTypeOnDetail)return!1;var n=p.get(this.bandNo);return m.wrapActivePromise(n.loadBandData(),this).then(t.bind((function(){if(n.canAccessHashTagRoute()){var t=i(e.currentTarget).text();t&&(t=encodeURIComponent(t.substring(1)),n.getBandCore().goBandDForced(r.GROUP_BAND_HASHTAG,l.PAGE_BAND_HASHTAG,{band_no:this.bandNo,query:t}))}else this._showPostDetailLayer()}),this)),!1},_showPostDetailLayer:function(){this.bPostDetail||this.trigger("textContent:showPostDetailLayer")},_getSplitBodyContents:function(){var e,t=s.convertPostText(this.textContent,{preventMentionAnchor:this.preventMentionAnchor,postFontTagEnabled:this.bPostDetail});return this.bPostDetail?t:(this.hasAttachment?(e=6,t=t.replace(/(<br>)+/g,"<br>")):(e=9,t=t.replace(/(<br>){2,}/g,"<br><br>")),s.splitForTruncate(t,e,45))}});return f.build=function(e){return new f({bandNo:e.bandNo,postNo:e.postNo,textContent:e.textContent,hasAttachment:e.hasAttachment,guideBand:e.guideBand,preventMentionAnchor:e.preventMentionAnchor,isRestricted:e.isRestricted})},f}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(4),o=n(0),s=n(800),a=n(1128),r=n(1098),l=n(1565),c=n(1262),d=n(803),u=n(158),h={POLL:l.POLL.id,TODO:l.TODO.id,BILL_SPLIT:l.BILL_SPLIT.id,ATTENDANCE_CHECK:l.ATTENDANCE_CHECK.id,SIGN_UP:l.SIGN_UP.id},p=i.Behavior.extend({initialize:function(){this.view.startDownload=o.bind((function(e,t,n){return o.defer(o.bind(this._confirmAndStart,this,e,t,n))}),this)},_confirmAndStart:function(e,t,n){if(t.length>1){var i=s.openAsLayer({title:u.nl2br(IM("attachments.excel_download.confirm_multi_download_sheet_mode.title")),radioItems:[{label:IM("attachments.excel_download.confirm_multi_download_sheet_mode.onesheet.label"),value:"onesheet"},{label:IM("attachments.excel_download.confirm_multi_download_sheet_mode.persheet.label"),value:"persheet"}],confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel")});this.listenTo(i,"modal:confirm",(function(i){this._startDownload(e,t,o.extend({sheet:i},n))}))}else this._startDownload(e,t,n)},_startDownload:function(e,t,n){o.defer((function(){var i=a.openProgressModal({title:IM("ui.label.excel_download"),desc:IM("ui.label.progress_all"),withoutHiding:!0,progressMode:a.MODE.COUNT,total:t.length});i.setProgress(0);var o=l.getPostAttachmentType(e);d.doAsyncJobsSequencial(t,(function(e,t,s){return i.isDestroyed()?$.Deferred().reject():o.fetch(e).then((function(e){return o.excelDataAppender(e,n,s),i.setProgress(t+1),s}))}),{sheets:[],filename:void 0}).then((function(e){var t=c.createFileName(n.bandCore&&n.bandCore.name,o.name,e);1===e.sheets.length&&(e.sheets[0].name=o.name);try{r.downloadAsExcelFile({sheets:e.sheets,filename:t})}catch(e){throw alert(IM("error.wrong_request")),console.error(e),e}finally{i.destroy()}}))}))}});p.KEY=h,e.exports=p},function(e,t,n){var i=n(0),o=n(152),s=n(487),a={FILE:{id:o.POST_ATTACHMENT_TYPE.FILE,name:IM("web.noui.bandfiles.title.band_files")},POLL:{id:o.POST_ATTACHMENT_TYPE.POLL,apiKey:"poll",urlKey:"poll",name:IM("web.postwrite.attach.title.poll"),jplClassifier:s.CLASSIFIER.ATTACHMENTS_POLL,fetch:function(e){return n(615).buildForGetPoll({bandNo:e.band_no,postNo:e.post_no,pollId:e.attachment_id})},printItemView:n(2469),excelDataAppender:n(2471),checkAccessible:function(e){return e.canGetAllPollVoterAtOnce()}},TODO:{id:o.POST_ATTACHMENT_TYPE.TODO,apiKey:"todo",urlKey:"todo",name:IM("web.postwrite.attach.title.todo"),jplClassifier:s.CLASSIFIER.ATTACHMENTS_TODO,fetch:function(e){return n(706).getTodo(e.band_no,e.post_no,e.attachment_id).then((function(e){return new Backbone.Model(e.todo)}))},printItemView:n(2472),excelDataAppender:n(2474),checkAccessible:function(e){return e.canGetAllPollVoterAtOnce()}},BILL_SPLIT:{id:o.POST_ATTACHMENT_TYPE.BILL_SPLIT,apiKey:"bill_split",urlKey:"bill-split",name:IM("web.postwrite.attach.title.billsplit"),jplClassifier:s.CLASSIFIER.ATTACHMENTS_BILLSPLIT,fetch:function(e){return n(687).getBillSplit(e.band_no,e.post_no).then((function(e){return new Backbone.Model(e.bill_split)}))},printItemView:n(2475),excelDataAppender:n(2477),checkAccessible:function(e){return e.canGetAllPollVoterAtOnce()}},ATTENDANCE_CHECK:{id:o.POST_ATTACHMENT_TYPE.ATTENDANCE_CHECK,apiKey:"attendance_check",urlKey:"attendance-check",name:IM("post.attendance_check.title"),jplClassifier:s.CLASSIFIER.ATTACHMENTS_ATTENDANCE,fetch:function(e){return n(667).fetchAttendanceCheck(e.band_no,e.post_no,e.attachment_id)},printItemView:n(2478),printOptionKeys:["states"],excelDataAppender:n(2480),checkAccessible:function(e){return e.canAccessSavePostAttendanceCheckDetail()}},SIGN_UP:{id:o.POST_ATTACHMENT_TYPE.SIGNUP,apiKey:"sign_up",urlKey:"sign-up",name:IM("signup.type_name"),jplClassifier:s.CLASSIFIER.ATTACHMENTS_SIGNUP,fetch:function(e){return n(832).fetchSignup(e.band_no,e.post_no,e.attachment_id)},printItemView:n(2481),printOptionKeys:["task"],excelDataAppender:n(2483),checkAccessible:function(e){return e.canAccessSavePostSignupDetail()}},getPostAttachmentType:function e(t){return i.chain(a).values().find((function(n){return n!==e&&(n.id===t||n.apiKey===t||n.urlKey===t)})).value()}};e.exports=a},function(e,t){e.exports='<div class="snippet" tabindex="-1" data-thumbnail="type0">\n    <span class="snippetInfo">\n        <span class="snippetTxt"><%= IM("web.postlist.attachschedule.title.deleted_or_secret_schedule") %></span>\n    </span>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(2511),s=n(503),a=n(511),r=n(157),l=n(153),c=n(9),d=n(606),u=n(491),h=n(16),p=n(1098),m=n(490),_=n(57),g=n(1036);return n(591),{buildDBandScheduleExportView:function(e,n,s){var a=n.band_no,c=n.schedule_id,d=s.token;return t.when(u.getCachedBandData(a),this._hasSpecialLinkOrCanUseSchedule(a,d)).then(i.bind((function(e,n){return!e.isNotNormal()||n?this._getSchedule(a,c,d).then(i.bind((function(e){if(!!e.SCHEDULE.rsvp&&e.SCHEDULE.rsvp.is_rsvp_visible_to_viewer){var t=m.convertUriQueryJsonToObject(s.selectedRsvpInfo);return this._getRsvp(a,c,e,t).then(i.bind((function(e){var t=this._optionsArrange(a,c,e,s);return o.build(t)}),this))}var n=this._optionsArrange(a,c,[e],s);return o.build(n)}),this)):e.isNotNormal()?(_.isBandDesktopApp()||window.opener?window.close():e.isPreview()||e.isCardView()?l.GROUP_BAND_HOME.goDForced({band_no:a}):r.GLOBAL_HOME.goDForced(),t.when()):void 0}),this))},_getRsvp:function(e,n,o,s){var r=[];return s&&(i.each(s.normalRsvpType,(function(t){r.push(this._getRsvpMembers(e,n,t))}),this),i.each(s.customRsvpType,(function(t){var i=this._getRsvpMembers(e,n,a.CUSTOM,t).then((function(e){return e[a.CUSTOM].custom_state_id=t,e}));r.push(i)}),this)),t.when.apply(t,r).then(i.bind((function(){var e=Array.prototype.slice.call(arguments);return o&&e.push(o),e}),this))},_optionsArrange:function(e,t,n,o){var s={};return i.each(n,(function(e){var t=i.keys(e);if(t==a.CUSTOM){var n=[];i.isEmpty(s[t])||(n=s[t]),n.push(i.values(e)[0]),s[t]=n}else s[t]=i.values(e)[0]})),{bandNo:e,scheduleId:t,schedule:s.SCHEDULE,rsvp:{ATTENDANCE:s.ATTENDANCE||null,PENDING_ATTENDANCE:s.PENDING_ATTENDANCE||null,ABSENCE:s.ABSENCE||null,MAYBE:s.MAYBE||null,NONRESPONSE:s.NONRESPONSE||null,CUSTOM:s.CUSTOM||null},params:o||null}},_getSchedule:function(e,t,n){return this._getValidToken(e,n).then(i.bind((function(n){return s.getSchedule(e,t,!1,n).then(i.bind((function(e){return this._returnObjAddKeyName(e,"SCHEDULE")}),this))}),this))},_getRsvpMembers:function(e,t,n,o){return s.getRsvpMembers(e,t,n,o).then(i.bind((function(e){return this._returnObjAddKeyName(e,n)}),this))},_returnObjAddKeyName:function(e,t){var n={};return n[t]=e,n},_getValidToken:function(e,t){return this._hasSpecialLinkOrCanUseSchedule(e,t).then((function(e){return e?t:null}))},_hasSpecialLinkOrCanUseSchedule:function(e,t){return u.getCachedBandData(e).then(i.bind((function(e){return null!=t||e.getBandCore().supportSchedule()}),this))},excelDownload:function(e){var t=e.bandNo,n=e.scheduleId,o=m.convertUriQueryJsonToObject(e.selectedRsvpInfo);if(null!=o)return this._getSchedule(t,n).then(i.bind((function(e){return this._getRsvp(t,n,e,o).then(i.bind((function(e){var i=this._optionsArrange(t,n,e,{selectedRsvpInfo:o});this._creteExcelFile(i)}),this))}),this))},_creteExcelFile:function(e){if(e.rsvp){var t,n=[e.schedule.name,h(e.schedule.start_at).format("L").replace(/\/|\./g,"-")].join("-")+".xlsx",o=[],s=g.utils.book_new(),r=null;i.each(e.rsvp,(function(e,t){if(e)if(t!=a.CUSTOM){var n=this._getScheduleUserRsvpStatusTypeMesaage(t);o=o.concat(this._makeExcelOneRowData(e,n)||[])}else i.each(e,(function(e){var t=i.find(e.custom_states,(function(t){return t.custom_state_id==e.custom_state_id}));o=o.concat(this._makeExcelOneRowData(e,t.title)||[])}),this)}),this),i.isEmpty(o)&&(o=[{A:""}]);var l=["A","B","C","D"];(r=g.utils.json_to_sheet(o,{header:l,skipHeader:!0}))["!cols"]=p.makeMaxColumnWidthData(o,l,50),g.utils.book_append_sheet(s,r,IM("schedule.rsvp.excel_download.sheet_label")),t=g.write(s,{bookType:"xlsx",bookSST:!0,type:"binary"}),d.saveAs(new Blob([this._s2ab(t)],{type:"application/octet-stream"}),n)}},_makeExcelOneRowData:function(e,t){return i.map(e.members,(function(e){var n=e.member.name,i=c.format.date(e.replied_at,"short_date_time"),o="";return e.member.user_no!=e.actor.user_no&&(o=IM("schedule.rsvp.excel_download.actor_name",{name:e.actor.name})),{A:t,B:n,C:i,D:o}}),this)},_s2ab:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i!=e.length;++i)n[i]=255&e.charCodeAt(i);return t},_getScheduleUserRsvpStatusTypeMesaage:function(e){switch(e){case a.ATTENDANCE:return IM("schedule.rsvp.attendance");case a.PENDING_ATTENDANCE:return IM("schedule.rsvp.pending_attendance");case a.ABSENCE:return IM("schedule.rsvp.absentee");case a.MAYBE:return IM("schedule.rsvp.maybe")}},openPrintWin:function(e){if(!e)return alert("schedule print page parameter error"),!1;var t=e.bandNo,n=e.scheduleId,i=e.params||null,o=l.GROUP_BAND_SCHEDULE_PRINT.makeUrl({band_no:t,schedule_id:n},i);window.open(o)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(486),s=n(152),a=n(13),r=n(589),l=n(1642),c=n(523),d=n(2528),u=n(82),h=n(16),p=n(159),m=n(555),_=n(9),g=i.View.extend({options:{attachmentDisplayType:null,bPostDetail:!1,bandData:null},attributes:function(){var e={"data-viewname":"DPostTodoView"};return this.options.attachmentDisplayType===s.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},className:function(){var e="uWidget";return(this.options.bPostDetail&&!this.options.bandData.canUsePostTodoItemOfSelfOrOwnerless()||this.options.clickDisabledPostTypeOnDetail)&&(e+=" gCursorDefault"),e},behaviors:[p],template:t.template(d),templateContext:function(){return{makeProfileInnerClass:function(e){return u.makeProfileInnerClass(e)}}},ui:{attachmentTodo:"._attachmentTodo",todoCheck:"._todoCheck",btnTodoHistory:"._btnTodoHistory",todoFaceThumb:"._todoFaceThumb",btnAddTodoTaskWrap:"._btnAddTodoTaskWrap",btnAddTodoTask:"._btnAddTodoTask",addTodoTaskWrap:"._addTodoTaskWrap",textAddTodoTask:"._textAddTodoTask",btnCancelAddTodoTask:"._btnCancelAddTodoTask",btnConfirmAddTodoTask:"._btnConfirmAddTodoTask"},events:function(){return!this.options.bPostDetail||this.options.bandData.canUsePostTodoItemOfSelfOrOwnerless()&&!this.options.clickDisabledPostTypeOnDetail?{"click @ui.attachmentTodo":"_showPostDetailLayer","click @ui.todoCheck":"_checkTodo","click @ui.todoFaceThumb":"_openTodoProfile","click @ui.btnTodoHistory":"_openTodoSubjectHistory","click @ui.btnAddTodoTask":"_showAddTodoTaskForm","click @ui.btnConfirmAddTodoTask":"_submitAddTodoTask","click @ui.btnCancelAddTodoTask":"_cancelAddTodoTask","keyup @ui.textAddTodoTask":function(e){var t=e.keyCode;if(37==t||39==t)return!1;this._confirmAddTodoTask(e)}}:{}},initialize:function(e){this.todoModel=e.model,this.postModel=e.postModel,this.bPostDetail=e.bPostDetail,this.attachmentDisplayType=e.attachmentDisplayType,this._isOpen=!h().isAfter(h(this.todoModel.get("endedAt"))),this._isClickable=this.bPostDetail&&this.options.bandData.canUsePostTodoItemOfSelfOrOwnerless()&&!this.options.clickDisabledPostTypeOnDetail},serializeData:function(){var e=this.todoModel.get("numberOfDone")||"0",n=this.todoModel.get("numberOfTasks")||"0",i=this.todoModel.get("title"),o=this._getRemainingTime(),a={showDetail:this.attachmentDisplayType===s.ATTACHMENT_DISPLAY_TYPE.DETAIL,doneCount:e,taskCount:n,isAllDone:e===n,title:i,remainingTime:o,isOpen:this._isOpen};if(this.attachmentDisplayType===s.ATTACHMENT_DISPLAY_TYPE.DETAIL){var r={tasks:this.todoModel.get("tasks").toJSON(),Localize:_,condition:{todoTaskMaxLength:s.TODO_TASK_MAX_LENGTH,isCheckboxClickable:this.options.bandData.canUseAttachedPostTodo()&&!this.options.clickDisabledPostTypeOnDetail,isCheckableOnlyByAuthor:this.todoModel.get("isCheckableOnlyByAuthor"),isTaskAddible:this.todoModel.get("isTaskAddible")}};return t.extend(a,r)}return t.extend(a,{todoCount:this.postModel.get("todoAllCount")})},_showPostDetailLayer:function(){return this.bPostDetail||this.trigger("attachmentTodo:showPostDetailLayer"),!1},_checkTodo:function(e){var n=$(e.currentTarget),i=n.is(":checked"),o=n.data("taskid"),s=n.data("index"),r=(this.todoModel.get("bandNo"),this.todoModel.get("isAuthor")),l=this.todoModel.getTask(o);if(!this._isOpen)return alert(IM("todo.label.participation_ended")),!1;if(!r&&this.todoModel.get("isCheckableOnlyByAuthor"))return i?alert(IM("web.postdetail.todo.message.isCheckableOnlyByAuthor")):alert(IM("web.postdetail.todo.message.permission.alert")),!1;if((r||this.options.bandData.isContentsDeletionPermitted())&&!l.isCheckedByMe()&&!i&&!confirm(IM("ui.label.check_clear_confirm")))return!1;if(i)return this.todoModel.checkTask(o).always(t.bind(this._fetchPostDetailAndTriggerTaskCheckChanged,this)),!1;var c=(l=this.todoModel.get("tasks").at(s)).get("actor").get("userNo"),d=a.getUserData().getUserNo()==c;return this.options.bandData.canUncheckPostOthersTodoItem()||r||d?(this.todoModel.uncheckTask(o).always(t.bind((function(){n.removeClass("checked"),this._fetchPostDetailAndTriggerTaskCheckChanged()}),this)),!1):(alert(IM("web.postdetail.todo.message.permission.alert")),!1)},_fetchPostDetailAndTriggerTaskCheckChanged:function(){this.postModel.fetchPostDetail().then(t.bind((function(){this.spawn(p.MSG.POST_TODO_CHECKED,this.postModel.getCommentCount())}),this))},_openTodoProfile:function(e){var t=this.todoModel.get("bandNo"),n=$(e.currentTarget).data("index"),i=this.todoModel.get("tasks").at(n).get("actor");return r.openMemberProfileLayer(i.getMemberProfile(),i.get("userNo"),t),!1},_openTodoSubjectHistory:function(e){var t,n=this.todoModel.get("bandNo"),i=this.todoModel.get("postNo"),s=$(e.currentTarget).data("taskid");if(this.todoModel.isV1())t=l.buildForTodoSubjectHistroyV1(n,i,s);else{var a=this.todoModel.get("todoId");t=l.buildForTodoSubjectHistroyV2(n,i,a,s)}return o.openWithoutHiding(t),!1},_showAddTodoTaskForm:function(){if(!this._isClickable)return!1;this.ui.btnAddTodoTaskWrap.hide(),this.ui.addTodoTaskWrap.show(),this.ui.textAddTodoTask.val(""),this.ui.textAddTodoTask.triggerHandler("update"),this.ui.textAddTodoTask.focus()},_cancelAddTodoTask:function(){this.ui.btnAddTodoTaskWrap.show(),this.ui.addTodoTaskWrap.hide()},_confirmAddTodoTask:function(e){e.keyCode==m.ENTER&&this._submitAddTodoTask()},_submitAddTodoTask:function(){var e=this.ui.textAddTodoTask.val();this.todoModel.addTask(e).then(t.bind((function(){this.postModel.fetchPostDetail()}),this))},_getRemainingTime:function(){var e=this.todoModel.get("endedAt");if(null==e)return null;var t=c.getRemainingTime(e);return t.close?IM("todo.label.participation_ended"):IM("todo.label.remaining_time_format_"+t.format,{value:t.value})}});return g.buildListItemView=function(e){return new g({model:e.model,postModel:e.postModel,bandData:e.bandData})},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(889),s=n(877),a=n(26),r=n(1023),l=n(510),c=n(1048),d=n(17),u=n(514),h=n(168),p=n(13),m=n(2045),_={SEE_LIVE_VIEWERS:{id:"SEE_LIVE_VIEWERS",title:IM("live.see_live_viewers")},COPY_LIVE_URL:{id:"COPY_LIVE_URL",title:IM("ui.label.copy_url")},SHARE_LIVE:{id:"SHARE_LIVE",title:IM("ui.label.share")},REPORT_LIVE:{id:"REPORT_LIVE",title:IM("ui.label.report")},OFF_LIVE_FORCIBLY:{id:"OFF_LIVE_FORCIBLY",title:IM("live.off_live_forcibly")},HIDE_BAND_FROM_FEED:{id:"HIDE_BAND_FROM_FEED",title:IM("post.menu.hide_from_feed.for_group_band")}},g={OPTION_LIST_OPEN:"OPTION_LIST_OPEN",OPTION_LIST_CLOSE:"OPTION_LIST_CLOSE",DO_ACTION:"DO_ACTION"},f=i.Behavior.extend({initialize:function(e){this._moreOptionListRegionName=e.moreOptionListRegionName,this._filteredMoreOptionList=[],this.listenTo(this.view,g.OPTION_LIST_OPEN,this._openOptionList),this.listenTo(this.view,g.OPTION_LIST_CLOSE,this._closeOptionList)},_filterMoreOptionList:function(e){this._filteredMoreOptionList=t.filter(e,t.bind((function(e){if(e.id===_.HIDE_BAND_FROM_FEED.id){var t=this._liveModel.getLiveBandData().getBandCore().selectMcoResourceKey("post.menu.hide_from_feed.for_group_band","post.menu.hide_from_feed.for_page_band");e.title=IM(t)}return this._isPermittedOption(e.id)}),this))},_isPermittedOption:function(e){var t=this._liveModel.getLiveMe();switch(e){case _.SEE_LIVE_VIEWERS.id:return t&&t.isViewLiveViewingMemberPermittedContentAuthor();case _.COPY_LIVE_URL.id:return!0;case _.SHARE_LIVE.id:return!!p.isLogedIn()&&this._liveModel.isLiveShareable();case _.REPORT_LIVE.id:if(!p.isLogedIn())return!1;if(!this._liveCreatorUserNo)return!1;var n=this._liveModel.getLiveCreator().getMemberType();return this._liveModel.getLiveBandData().canReportContentOfAuthor(this._liveCreatorUserNo,n);case _.OFF_LIVE_FORCIBLY.id:return!!p.isLogedIn()&&(!!this._liveCreatorUserNo&&(!this._liveModel.isLiveCreatorMe()&&(this._liveModel.getLiveMe()&&this._liveModel.getLiveMe().isOffLivePermittedContentAuthor())));case _.HIDE_BAND_FROM_FEED.id:return!!p.isLogedIn()}return!1},_resetParams:function(e){return e&&e.liveModel&&e.moreOptionList?(this._liveModel=e.liveModel,this._fetchLiveCreatorUserNo(this._liveModel.getLiveBandNo(),this._liveModel.getLiveCreator()).then(t.bind((function(){this._filterMoreOptionList(e.moreOptionList)}),this))):$.Deferred().reject()},_fetchLiveCreatorUserNo:function(e,n){var i=$.Deferred();if(n.getUserNo())return this._liveCreatorUserNo=userNo,i.resolve();var o=n.getContentAuthorMemberKey();return h.getUserNoByMemberKey(e,o).done(t.bind((function(e){this._liveCreatorUserNo=e}),this)).always((function(){i.resolve()})),i.promise()},_openOptionList:function(e){var n=this.view.getRegion(this._moreOptionListRegionName);n.hasView()||this._resetParams(e).then(t.bind((function(){t.defer(t.bind((function(){var e=o.build(this._filteredMoreOptionList,{listClass:"moreMenuList -active",listItemClass:"moreMenuItem",btnClass:"btnMoreMenu"});this.listenTo(e,o.EVENTS.MENU_SELECTED,this._handleMoreOption),n.show(e)}),this))}),this))},_closeOptionList:function(){var e=this.view.getRegion(this._moreOptionListRegionName);e.hasView()&&e.empty()},_handleMoreOption:function(e){switch(e){case _.SEE_LIVE_VIEWERS.id:this._handleSeeLiveViewers();break;case _.COPY_LIVE_URL.id:this._handleCopyLiveUrl();break;case _.SHARE_LIVE.id:this._handleShareLive();break;case _.REPORT_LIVE.id:this._handleReportLive();break;case _.OFF_LIVE_FORCIBLY.id:this._handleOffLiveForcibly();break;case _.HIDE_BAND_FROM_FEED.id:this._handleHideBandFromFeed()}},_handleSeeLiveViewers:function(){m.openOnAirMemberListLayer(this._liveModel)},_handleCopyLiveUrl:function(){var e=location.origin+this._liveModel.getLiveUrl();r.openUrlCopyLayerView(e)},_handleShareLive:function(){if(!this.view.getRegion("urlShareViewRegion")){var e=this.view.getChildView(this._moreOptionListRegionName).$el;e.after('<div class="_urlShareViewRegion"></div>'),this.view.addRegion("urlShareViewRegion",{el:e.next()[0],replaceElement:!0})}t.defer(t.bind((function(){this.view.showChildView("urlShareViewRegion",c.buildUrlShareView({shareUrl:d.appendCurrentDomainOnPathUrl(this._liveModel.getLiveUrl()),message:IM("live.shared_post.message"),excludedBandNos:[this._liveModel.getLiveBandNo()],isSingleSelectionOnMoreBandSelection:!1,withoutHidingOnLayerOpen:!0,gotoBandOnNewTab:!0}))}),this))},_handleReportLive:function(){u.openLiveReportPopup(this._liveModel.getLiveBandNo(),this._liveModel.getLiveId())},_handleOffLiveForcibly:function(){l.openLayer({bodyTitle:IM("live.live_off_confirm"),withoutHiding:!0}).once(l.EVENTS.CONFIRM,t.bind((function(){s.offLive(this._liveModel.getLiveBandNo(),this._liveModel.getLiveId()).then(t.bind((function(){var e=this._liveModel.getLiveBandNo(),t=this._liveModel.getLiveId();a.getLiveChannel().trigger(a.EVENT.LIVE_CLOSED,{bandNo:e,liveId:t})}),this))}),this))},_handleHideBandFromFeed:function(){var e=this._liveModel.getBandCore();l.openLayer({headerTitle:IM("feed.hide_from_my_feed.confirm.title",{bandName:e.name}),bodyDesc:IM("feed.hide.confirm.desc")}).once(l.EVENTS.CONFIRM,t.bind((function(){a.getFeedChannel().trigger(a.EVENT.HIDE_BAND_FROM_FEED,e.bandNo)}),this))}});return f.LIVE_MORE_OPTION=_,f.TRIGGERING_EVENTS={},f.LISTENING_EVENTS=g,f}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(201),a=n(2046),r=n(1406),l=r.EVENT;function c(e){return e&&t.isFunction(e.then)?e:i.Deferred().resolve(e).promise()}var d=r.FATAL_ERROR,u={DEAD_END:function(){this._changePlaying(!1)},INIT:function(){return s.isSupported()?this._isPlaying?(this._isDestroyed&&(this._video.pause(),this._hls&&(this._hls.destroy(),this._hls=void 0),i(this._video).off("ended",this._triggerEnded),this._isDestroyed=!1),this._startDateTime=void 0,this._createHls(),this._hls.attachMedia(this._video),i(this._video).one("ended",this._triggerEnded),{to:u.LOAD_SOURCE,value:0}):void 0:(this.trigger(l.FATAL_ERROR_OCCURRED,d.NOT_SUPPORT_BROWSER_ERROR),{to:u.DEAD_END})},LOAD_SOURCE:function(e){return this._isDestroyed?{to:u.INIT}:this._isPlaying?e<this._maxSourceRetryCount?c(this._source.call()).then(t.bind((function(e){return{to:u.LOAD_MANIFEST,value:e}}),this),t.bind((function(){return c({to:u.LOAD_SOURCE_RETRY,value:e})}),this)):(this._isDestroyed=!0,this._changePlaying(!1),{to:u.INIT}):void 0},LOAD_SOURCE_RETRY:function(e){if(this._isDestroyed)return{to:u.INIT};if(!this._isPlaying)return{to:u.LOAD_SOURCE,value:e};var t=i.Deferred();return setTimeout((function(){t.resolve({to:u.LOAD_SOURCE,value:e+1})}),this._retryInterval),t.promise()},LOAD_MANIFEST:function(e){if(this._isDestroyed)return{to:u.INIT};if(this._isPlaying){var n=i.Deferred(),o=t.bind((function(t,i){this._hls.off(s.Events.MANIFEST_PARSED,a),this._hls.off(s.Events.ERROR,o),console.log("handled error,",t,i),n.resolve({to:u.LOAD_MANIFEST_RETRY,value:e})}),this),a=t.bind((function(){this._hls.off(s.Events.MANIFEST_PARSED,a),this._hls.off(s.Events.ERROR,o),this.changeQuality(this._currentQuality),this.trigger(l.READY_PLAYING),n.resolve({to:u.REGISTER_ERROR_HANDLER})}),this);return this._hls.on(s.Events.ERROR,o),this._hls.on(s.Events.MANIFEST_PARSED,a),this._hls.loadSource(e),n.promise()}},LOAD_MANIFEST_RETRY:function(e){if(this._isDestroyed)return{to:u.INIT};if(!this._isPlaying)return{to:u.LOAD_MANIFEST,value:e};var t=i.Deferred();return setTimeout((function(){t.resolve({to:u.LOAD_MANIFEST,value:e})}),this._retryInterval),t.promise()},REGISTER_ERROR_HANDLER:function(){return this._isDestroyed?{to:u.INIT}:(this._hls.on(s.Events.ERROR,t.bind(this.handleError,this)),{to:u.LOAD_COMPLETE})},LOAD_COMPLETE:function(){return this._isDestroyed?{to:u.INIT}:this._isPlaying?(this._hls.startLoad(),{to:u.PREPARE_PLAY}):void 0},PREPARE_PLAY:function(){if(this._isDestroyed)return{to:u.INIT};if(!this._isPlaying)return this._video.paused||this._video.pause(),this._hls&&this._hls.stopLoad(),{to:u.LOAD_COMPLETE};var e=t.bind((function(){return this._video.paused?i(this._video).trigger("pause"):this._video.pause(),this._hls&&this._hls.stopLoad(),this._changePlaying(!1),c({to:u.PAUSED})}),this),n=this._video.play();return n?n.then((function(){return{to:u.PLAYING}}),t.bind((function(){return this._video.muted?e():c({to:u.PREPARE_RETRY_WITH_MUTE})}),this)):{to:u.PLAYING}},PREPARE_RETRY_WITH_MUTE:function(){return this._isDestroyed?{to:u.INIT}:this._isPlaying?(this._video.muted=!0,{to:u.PREPARE_PLAY}):{to:u.PREPARE_PLAY}},PLAYING:function(){return this._isDestroyed?{to:u.INIT}:this._isPlaying?void 0:(this._video.paused||this._video.pause(),this._hls&&this._hls.stopLoad(),{to:u.PAUSED})},PAUSED:function(){if(this._isDestroyed)return{to:u.INIT};if(this._isPlaying){this._hls.currentLevel=-1,this._hls.startLoad();var e=i.Deferred();return this._hls.once(s.Events.LEVEL_LOADED,t.bind((function(t,n){this._video.currentTime=this._hls.streamController.computeLivePosition.call(this._hls,0,n.details),e.resolve({to:u.PREPARE_PLAY})}),this)),e.promise()}}},h=/START-DATE=["']([^"']+)["']/,p=o.Object.extend({initialize:function(e){this._maxSourceRetryCount=5,this._retryInterval=500,this._stallingTimeout=5e3,this._hls=void 0,this._video=e.video,this._setSource(e.source),this._currentQuality=e.quality,this._isPlaying=!1,this._isDestroyed=!1,this._startDateTime=void 0,this._triggerEnded=t.bind((function(){this.trigger(l.COMPLETED_PLAYING)}),this),this._commander=new a(u)},_setSource:function(e){t.isFunction(e)?this._source=e:e&&t.isFunction(e.then)?this._source=t.constant(e):this._source=t.constant(i.Deferred().resolve(e).promise())},_createHls:function(){this._hls=new s({autoStartLoad:!1,capLevelToPlayerSize:!0,liveBackBufferLength:0,liveMaxLatencyDurationCount:8,levelLoadingMaxRetryTimeout:15e3,levelLoadingMaxRetry:120})},play:function(){this._isPlaying||(this._changePlaying(!0),this._process())},pause:function(){this._isPlaying&&(this._changePlaying(!1),this._process())},_process:function(){this._commander.startProcess(this)},_changePlaying:function(e){var t=this._isPlaying!==e;this._isPlaying=e,t&&this.trigger(l.CHANGE_PLAYING,this._isPlaying)},isPlaying:function(){return this._isPlaying},handleError:function(e,n){if(n.type===s.ErrorTypes.MEDIA_ERROR&&(n.details===s.ErrorDetails.BUFFER_STALLED_ERROR||n.details===s.ErrorDetails.BUFFER_NUDGE_ON_STALL)){if(console.log("handled error,",e,n),this._stallingTimer||this._networkErrorTriggerred)return;return this._stallingTimer=setTimeout(t.bind((function(){console.error("stall timeout from",e,n),this.trigger(l.ERROR_OCCURRED),this._networkErrorTriggerred=!0,this._stallingTimeout=void 0}),this),this._stallingTimeout),void i(this._video).one("canplay",t.bind((function(){this._stallingTimer&&(clearTimeout(this._stallingTimer),this._stallingTimer=void 0),this._networkErrorTriggerred&&(this.trigger(l.ERROR_RECOVERED),this._networkErrorTriggerred=!1)}),this))}n.fatal?(console.error(e,n),this.trigger(l.ERROR_OCCURRED),this.trigger(l.FATAL_ERROR_OCCURRED,d.NETWORK_ERROR),this._isDestroyed=!0,this._changePlaying(!1),this._process()):console.log("handled error,",e,n)},destroy:function(){this._changePlaying(!1),this._video.pause(),i(this._video).off("ended",this._triggerEnded),this._hls&&(this._hls.destroy(),this._hls=void 0),this._isDestroyed=!0,this._isPlaying=!1},changeSource:function(e){this._setSource(e),this._isDestroyed=!0,this._process()},changeQuality:function(e){this._currentQuality=e,this._hls.loadLevel=t.findIndex(r.VIDEO_QUALITY,(function(t){return t===e}))},getQualityInfo:function(){return{supports:["AUTO"].concat(r.VIDEO_QUALITY),current:this._currentQuality}},getVideoResolution:function(){if(this._hls&&this._hls.levels&&!(this._hls.levels.length<=0)){var e=this._hls.levels[this._hls.levels.length-1];return{width:e.width,height:e.height}}},getPlayTimeMilli:function(){if(this._hls&&this._hls.levels){var e=this._hls.levels[this._hls.currentLevel];if(e&&e.details&&e.details.fragments&&e.details.fragments[0]){var n=e.details.fragments[0];if(this._video&&this._video.currentTime){if(!this._startDateTime){var i=t.find(n.tagList,(function(e){return"EXT-X-DATERANGE"===e[0]}));if(!i)return;var o=h.exec(i[1]);if(!o||!o[1])return;this._startDateTime=Date.parse(o[1])}return 1e3*this._video.currentTime-1e3*n.start+n.programDateTime-this._startDateTime}}}}});return p.EVENT=l,p.FATAL_ERROR=d,p}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{TOGGLE_CHAT:"toggle_chat",CLOSE_LIVE:"close_live",PLAY_READY:"play_ready",PLAY_ENDED:"play_ended",PLAY_TIME_UPDATE:"play_time_update",ERROR_OCCURRED:"error_occurred",ERROR_RECOVERED:"error_recovered"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2571);return i.Behavior.extend({options:{regionName:"",playController:"playController"},onRender:function(){this.view.showChildView(this.options.regionName,o.buildDLiveVideoTimeUIView()),this.getUI("video").on("timeupdate",t.bind(this._renderControlView,this))},_renderControlView:function(){var e=this.view.getLiveModel();if(e&&e.getLivePlayInfo()&&e.getLiveStartAt())if(e.isLiveCreatorMe()){var t=e.getLiveMaxRunningTimeMins(),n=Date.now()-e.getLiveStartAt();n>60*(t-10)*1e3?this._getControlView().setPlayTimeMilli(60*t*1e3-n,!0):this._getControlView().setPlayTimeMilli(n,!1)}else this._getControlView().setPlayTimeMilli(this._getPlayController().getPlayTimeMilli(),!1)},_getControlView:function(){return this.view.getChildView(this.options.regionName)},_getPlayController:function(){return this.view[this.options.playController]}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2588);return i.Behavior.extend({options:{regionName:"",noclick:!1},onRender:function(){this.view.showChildView(this.options.regionName,new o({muted:this.getUI("video")[0].muted})),this.options.noclick||(this.listenTo(this._getView(),"changeMutedUI",(function(e){this.getUI("video")[0].muted=e})),this.getUI("video").on("volumechange",t.bind((function(){this._getView().setMuted(this.getUI("video")[0].muted)}),this)))},_getView:function(){return this.view.getChildView(this.options.regionName)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1121),s=n(1654),a=n(1185),r=n(1655),l=n(1656),c=i.CollectionView.extend({options:{photos:[],collageType:"square",useMore:!1,noplay:!1},tagName:"ul",attributes:{"data-viewname":"DPhotoCollageView"},className:function(){return"uCollage "+c.CollageType[this.options.collageType].additionalClass},childViewTriggers:function(){var e={};return e[a.VIDEO_PLAYER_PLAY]=a.VIDEO_PLAYER_PLAY,e[a.VIDEO_PLAYER_PAUSE]=a.VIDEO_PLAYER_PAUSE,e},onRender:function(){this._childrenIndexes={};var e=Math.min(this.options.photos.length,4),n=c.CollageType[this.options.collageType].itemScales[e];t.each(n,(function(e,t){var n,i=this.options.photos[t];n="dynamic"===e[0]?i.video&&i.videoPlayerModel&&!i.isLiveVideo?new s({photoUrl:i.photoUrl,width:i.width,height:i.height,videoPlayerModel:i.videoPlayerModel,isGifVideo:i.isGifVideo,noplay:this.options.noplay}):l.buildPostCardDynamicItemView({photoUrl:i.photoUrl,width:i.width,height:i.height,video:i.video,isLiveVideo:i.isLiveVideo}):r.buildDPhotoCollageImageItemView({thumbnailScale:e[0],playerIconScale:e[1],photoUrl:i.photoUrl,video:i.video,expiresAt:i.expiresAt,isGifVideo:i.isGifVideo,isLiveVideo:i.isLiveVideo,showMore:this.options.useMore&&t===this.options.photos.length-1}),this._childrenIndexes[n.cid]=t,this.addChildView(n,this.children.length)}),this),this.$el.attr("data-collage",e)},childViewEvents:function(){var e={};return e[a.OPEN_MEDIA]=function(e){this.trigger(a.OPEN_MEDIA,this._childrenIndexes[e.cid])},e}});c.CollageType={horizontal:{additionalClass:"-horizontal",itemScales:{1:[["dynamic","big"]],2:[["2:1","big"],["2:1","big"]],3:[["2:1","big"],["1:1","big"],["1:1","big"]],4:[["3:2","big"],["1:1","middle"],["1:1","middle"],["1:1","middle"]]}},vertical:{additionalClass:"-vertical",itemScales:{1:[["dynamic","big"]],2:[["2:3","big"],["2:3","big"]],3:[["2:3","big"],["1:1","big"],["1:1","big"]],4:[["2:3","big"],["1:1","middle"],["1:1","middle"],["1:1","middle"]]}},square:{additionalClass:"-square",itemScales:{1:[["dynamic","big"]],2:[["1:1","big"],["1:1","big"]],3:[["1:1","big"],["1:1","middle"],["1:1","middle"]],4:[["1:1","big"],["1:1","big"],["1:1","big"],["1:1","big"]]}},video:{additionalClass:"-video",itemScales:{4:[["1:1","big"],["1:1","small"],["1:1","small"],["1:1","small"]]}}},c.EVENTS=a;var d=o.create(["vertical",[1,"square"],"horizontal"]);function u(e){if(2===e.length){var t=d.identify(e[0].width/e[0].height);return t===d.identify(e[1].width/e[1].height)?t:"square"}var n=d.identify(e[0].width/e[0].height);return 4===e.length&&"square"===n&&e[0].video?"video":n}return c.buildDPhotoCollageView=function(e,n){return new c(t.extend({},n,{photos:e,collageType:u(e)}))},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(152),s=n(154),a=n(2603),r=n(933),l=n(156),c=i.View.extend({options:{bandData:null,attachmentDisplayType:null,bPostDetail:!1,postModel:null},attributes:function(){var e={"data-viewname":"DPostFileView"};return this.options.attachmentDisplayType===o.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},className:function(){return"uWidget"},template:t.template(a),ui:{attachmentFile:"._attachmentFile",settingSave:"._settingSave"},events:{"click @ui.attachmentFile":"_showPostDetailLayerOrDownloadFile","click @ui.settingSave":"_fileQuotaSettingController"},initialize:function(e){this.bPostDetail=e.bPostDetail,this.bPostDetail?(this.fileModel=e.model,this.bandNo=e.postModel.getBandNo()):this.fileModel=e.collection&&e.collection.length>=1?e.collection.at(0):null},serializeData:function(){return{bPostDetail:this.bPostDetail,title:this.fileModel.get("title"),fileCountText:this._getFileCountText(),fileInfoText:this._getFileInfoText(),fileSizeText:this.fileModel.get("fileSizeText"),isQuotaStatus:this.bPostDetail&&this._isQuotaStatus(),isExpiredFile:this.bPostDetail&&l.isExpiredFile(this.fileModel.get("expiresAt"))}},onRender:function(){this.ui.attachmentFile.toggleClass("-disabled",this._isDisabled()),this.options.bPostDetail&&!this.options.bandData.canDownloadFileOnPost()&&this.ui.attachmentFile.addClass("gCursorDefault")},_isQuotaStatus:function(){return r.canSetFileIntoQuota(this.bandNo,this.fileModel.get("expiresAt"),this.fileModel.get("fileSize"))},_isDisabled:function(){return!!this.bPostDetail&&("ndrive"===this.fileModel.get("type")&&!(!this.fileModel.get("isRestricted")&&!this.fileModel.isExpired()))},_showPostDetailLayerOrDownloadFile:function(){return this.bPostDetail&&this.options.bandData.canDownloadFileOnPost()&&!this.options.clickDisabledPostTypeOnDetail?this._downloadFile():this.trigger("attachmentFile:showPostDetailLayer"),!1},_downloadFile:function(){var e=this.fileModel.get("type");return"ndrive"==e?this.fileModel.isExpired()?alert(IM("web.postdetail.attachfile.alert.expired")):this.fileModel.getFileUrl(this.options.postModel.getBandNo()).then((function(e){window.location.href=e})):"dropbox"!=e&&"one_drive"!=e||window.open(this.fileModel.get("link"),"_blank"),!1},_getFileCountText:function(){var e=this.options.collection,t=e?e.length:0;return this.bPostDetail||t<=1?null:IM("web.postlist.attachfile.total_n",{fileCount:t})},_getFileInfoText:function(){return this.bPostDetail?"dropbox"==this.fileModel.get("type")?"Dropbox":"one_drive"==this.fileModel.get("type")?"OneDrive":this.fileModel.makeExpirationText():null},_fileQuotaSettingController:function(e){e.stopPropagation();var n=r.startSettingFileIntoQuota({bandNo:this.bandNo,fileId:this.fileModel.get("id"),withoutHiding:!0});s.wrapActivePromise(n,this).then(t.bind((function(){this.fileModel.set("expiresAt",null),this.render()}),this))}});return c.build=function(e){return new c({collection:e.collection,attachmentDisplayType:o.ATTACHMENT_DISPLAY_TYPE.HEADER})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(637),s=n(2604),a=n(152),r=n(487),l=i.View.extend({options:{bandData:null,attachmentDisplayType:null,bPostDetail:!1},behaviors:[r],attributes:function(){var e={"data-viewname":"DPostLocationView"};return this.options.attachmentDisplayType===a.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},className:"uWidget",template:t.template(s),ui:{link:"._link"},events:{"click @ui.link":function(){return this.bPostDetail?this.options.bandData.canOpenLargeMap()&&this._openLargeMap():this._showPostDetailLayer(),!1}},initialize:function(e){this.locationModel=e.model,this.bPostDetail=e.bPostDetail,this.attachmentDisplayType=e.attachmentDisplayType,this.clickable=!this.bPostDetail||this.options.bandData.canOpenLargeMap()},serializeData:function(){var e=this.locationModel.get("latitude"),t=this.locationModel.get("longitude");return{isShowMapImage:this.attachmentDisplayType===a.ATTACHMENT_DISPLAY_TYPE.DETAIL,staticMapUrl:o.getStaticMapUrl(e,t),placeName:this.locationModel.get("name"),address:this.locationModel.get("address")}},onRender:function(){this.ui.link.toggleClass("gCursorDefault",!this.clickable)},_showPostDetailLayer:function(e){return this.bPostDetail||this.trigger("attachmentLocation:showPostDetailLayer"),!1},_openLargeMap:function(){var e=this.locationModel.get("latitude"),t=this.locationModel.get("longitude"),n=o.getLargeMapUrl(e,t);window.open(n,"_blank")}});return l.build=function(e){return new l({model:e.model,attachmentDisplayType:e.attachmentDisplayType})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2619),a=n(2058),r=n(884),l=n(154),c=n(26),d=n(851),u=n(498),h=n(499),p=n(488),m=n(152),_=n(159),g=o.View.extend({attributes:function(){var e={"data-viewname":"DPostAddonView"};return this.options.attachmentDisplayType===m.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},className:function(){var e="uWidget -addon";return this.options.attachmentDisplayType==m.ATTACHMENT_DISPLAY_TYPE.DETAIL&&this.options.postModel.isApprovablePost()&&(e+=" -detailWidget"),e},behaviors:[_],getTemplate:function(){return this._dataFetched?this._currentTypeSupported?t.template(s):t.template(a):t.template(u)},ui:{addonIframe:"._addonIframe"},events:function(){if(!this.options.bPostDetail)return{click:function(){this.trigger("attachmentAddon:showPostDetailLayer")}}},initialize:function(e){var t=e.postModel;this._bandNo=t.get("band").bandNo,this._postNo=t.get("postNo"),this._bPostDetail=!!e.bPostDetail,this._currentTypeSupported=!1,this._needShowHeaderView=!this._bPostDetail||this._bPostDetail&&this.options.postModel.isApprovablePost()},serializeData:function(){if(!this._dataFetched)return{_loading_size:h.Size.SMALL,middleClass:p.ELEMENT.AREA_VERTICAL_MIDDLE};if(!this._currentTypeSupported)return{};var e={needShowHeaderView:this._needShowHeaderView};return this._needShowHeaderView?t.extend(e,{addonName:this._allowedAddonModel.getLocaleName(),description:this.model.getDescription(),svgUrl:this._bPostDetail&&this.options.postModel.isApprovablePost()?"#ico-markdown-acttachment-small":"#ico-markdown-attachment"}):t.extend(e,{addonUri:this._allowedAddonModel.makeViewUri(this.model.getOneTimeToken())})},onAttach:function(){this._needShowHeaderView?this._renderAddonHeaderView():this._renderAddonDetailView()},_renderAddonHeaderView:function(){l.wrapActivePromise(d.getCachedAllowedAddonCollection(),this).then(t.bind(this._renderAfterDataFetched,this))},_renderAddonDetailView:function(){l.wrapActivePromise(i.when(d.getCachedAllowedAddonCollection(),r.getAddonToken(this._bandNo,this._postNo,this.model.getPostAddonId(),"VIEW")),this).then(t.bind(this._renderAfterDataFetched,this))},_renderAfterDataFetched:function(e,t){this._dataFetched=!0,this._allowedAddonModel=e.findAllowedAddonModelByType(this.model.getAddonType()),null!=this._allowedAddonModel&&this.model.isSupportVersion()?(this._currentTypeSupported=!0,t&&(this.model.setOneTimeToken(t.token_info.oneTimeToken),this.listenTo(c.getAddonChannel(),c.ADDON_EVENT.ADDON_HEIGHT_CHANGED,(function(e,t){t&&!isNaN(t.height)&&t.oneTimeToken==this.model.getOneTimeToken()&&(this.ui.addonIframe.css("height",t.height+"px"),this.spawn(_.MSG.ADDON_HEIGHT_CHANGED))}))),this.render()):this.render()}});return g.buildListItemView=function(e){return new g({model:e.model,postModel:e.postModel,attachmentDisplayType:e.attachmentDisplayType})},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2620),s=n(2621),a=n(9),r=n(2625),l=n(523),c=n(26),d=n(513),u=(n(832),n(43)),h=n(553),p=n(1564),m=i.CollectionView.extend({tagName:"ul",className:"signupViewList",childView:s,childViewOptions:function(){return this.options},initialize:function(e){}}),_=i.View.extend({behaviors:[p],tagName:"div",className:"uWidget",options:{bandData:null},attributes:{"data-viewname":"DPostSignupView"},template:t.template(o),ui:{menuToggleBtn:"._menuToggleBtn",menuLayer:"._menuLayer",excelLink:"._excelLink",printLink:"._printLink",timeBtn:"._timeBtn"},events:function(){return this.options.bPostDetail&&this.options.clickDisabledPostTypeOnDetail?{}:{"click @ui.menuToggleBtn":function(){this.ui.menuLayer.is(":visible")||t.defer(t.bind((function(){this.ui.menuLayer.show()}),this))},"click @ui.excelLink":function(e){e.preventDefault(),this._createExcelFile()},"click @ui.printLink":function(e){e.preventDefault(),this._openPrintView()},"click @ui.timeBtn":function(e){var t=$(e.currentTarget),n=!t.data("local"),i=this._taskGroups[t.data("index")],o=n?i.localTime:i.time,s=n?IM("ui.label.view_original_time"):IM("ui.label.view_in_my_time_zone");t.data("local",n).html(s),this.$("#"+t.attr("aria-controls")).html(o)},click:function(){this._bPostDetail||this.trigger("postAttachment:showPostDetailLayer")}}},initialize:function(e){this._postModel=e.postModel,this._bandNo=this._postModel.get("band").bandNo,this._postNo=this._postModel.get("postNo"),this._isAuthor=this._postModel.get("isAuthor"),this._bPostDetail=!!e.bPostDetail,this._moreCount=0,this._taskGroups=null,this._taskGroupRegions={},this._bandData=this.options.bandData,this._bPostDetail?(this._taskGroups=this._getTaskGroups(),this._menuAvailable=this._bandData.canAccessSavePostSignupDetail(),t.each(this._taskGroups,(function(e){this._taskGroupRegions[e.regionName]={el:"."+e.className,replaceElement:!0}}),this),this.addRegions(this._taskGroupRegions),this.listenTo(c.getDGlobalChannel(),c.EVENT.HTML_CLICK,this._closeLayers)):this._moreCount=this._postModel.getSignupCount()-1},serializeData:function(){var e=this.model.get("startAt"),t=e?u.tz(e,this.model.get("timeZoneId")).format("YYYY-MM-DD"):null,n=null,i=null,o=null,s=this._isClosed();return this._bPostDetail?i=a.format.date(t,"full"):(n=a.format.date(t,"year_month_day"),o=IM("web.postlist.todo.txt.in_progress",{doneCount:this.model.get("completedTaskCount")||"0",taskCount:this.model.get("taskCount")})),{cid:this.cid,bPostDetail:this._bPostDetail,title:this.model.get("title"),doneCount:o,remainingTime:this._getRemainingTime(),headStartDate:n,detailStartDate:i,moreCount:this._moreCount,menuAvailable:this._menuAvailable,taskGroups:this._taskGroups,childMemberGuidable:!s&&this.model.get("isChildMemberAddible")}},onRender:function(){this._bPostDetail?this._onRenderDetailSignup():this._onRenderListSignup()},_isClosed:function(){var e=this.model.get("endedAt");return!!e&&e<=(new Date).getTime()},_onRenderListSignup:function(){this.$el.removeAttr("data-widget"),this.$el.attr("tabindex","-1")},_onRenderDetailSignup:function(){this.$el.attr("data-widget","expanded"),this.$el.removeAttr("tabindex"),t.each(this._taskGroups,(function(e){this.showChildView(e.regionName,new m({collection:e.tasks,bandData:this._bandData,postModel:this._postModel,clickDisabledPostTypeOnDetail:this.options.clickDisabledPostTypeOnDetail}))}),this)},_getTaskGroups:function(){return t.map(this.model.getTaskGroups(),(function(e,t){var n="taskGroupRegion"+t;return{regionName:n,className:"_"+n,time:e.time,localTime:e.localTime,tasks:e.tasks}}))},_getRemainingTime:function(){var e=l.getRemainingTime(this.model.get("endedAt"));return null==e?null:e.close?IM("post.attendance_check.expired"):IM("todo.label.remaining_time_format_"+e.format,{value:e.value})},_closeLayers:function(){try{this.ui.menuLayer.hide()}catch(e){}},_openPrintView:function(){var e=r.openAsLayer({model:this.model,description:IM("signup.select_to_print")});this.listenTo(e,r.EVENT.SELECTED,(function(e){var t=h.attachmentPrint(this._bandData.getBandCore(),"sign-up",[{post_no:this._postNo,attachment_id:this.model.get("signupId")}],{task:e.join(",")}).url;d.openWindowXSSSafely(t,"_blank")}))},_createExcelFile:function(){var e=r.openAsLayer({model:this.model,description:IM("signup.select_to_save")});this.listenTo(e,r.EVENT.SELECTED,(function(e){this.startDownload(p.KEY.SIGN_UP,[{band_no:this._bandNo,post_no:this._postNo,attachment_id:this.model.get("signupId")}],{bandCore:this.options.bandData.getBandCore(),taskIds:e})}))}});return _.build=function(e){return new _(e)},_}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2666),s=n(26),a=n(486),r=n(2667),l=n(1182),c=n(1038),d=n(551),u=n(522),h=n(556),p=n(1013),m=n(888),_=n(578),g=n(1048),f=n(13),b=n(154),v=n(155),A=n(562),E=n(487),T=n(509),C=n(2032),y=i.View.extend({attributes:{"data-viewname":"DPostCountView"},className:"dPostCountView",template:t.template(o),behaviors:[E],ui:{commentCountBtn:"._commentCountBtn",sharedCountBtn:"._sharedCountBtn",commentToggleBtn:"._commentToggleBtn",commentDownloadBtn:"._commentDownloadBtn",postAdded:"._postAdded",emoteMainBtn:"._emoteMainBtn",commentMainBtn:"._commentMainBtn",shareMainBtn:"._shareMainBtn",emoticonSelectViewRegion:"._emoticonSelectViewRegion",emoteLayerBtn:"._emoteLayerBtn",emotionCountLayerBtn:"._emotionCountLayerBtn",commentLayerBtn:"._commentLayerBtn",commentCountLayerBtn:"._commentCountLayerBtn",shareLayerBtn:"._shareLayerBtn",sharedCountLayerBtn:"._sharedCountLayerBtn",emotionViewRegion:"._emotionViewRegion",emotionCountViewRegion:"._emotionCountViewRegion",postShareOptionListViewRegion:"._postShareOptionListViewRegion"},events:function(){var e={"click @ui.shareMainBtn":function(){this._togglePostShareOptionListView("postShareOptionListViewRegion"),this.jplClick(E.CLASSIFIER.POST_SHARE,{band_no:this._bandNo,post_no:this._postNo})},"click @ui.shareLayerBtn":function(){this._togglePostShareOptionListView("postShareOptionListViewLayerRegion")},"click @ui.commentCountLayerBtn":"_scrollToCommentArea","click @ui.emotionCountLayerBtn":"_scrollToFaceList","click @ui.commentDownloadBtn":function(){this._loadBandData().then(t.bind((function(e){C.downloadCommentList(e.getBandCore(),this._postNo,this._createdAt)}),this))}};return this.options.preventUnfoldEmotionCommentArea||t.extend(e,{"click @ui.commentCountBtn,@ui.commentToggleBtn":function(){this.toggleEmotionCommentArea()}}),f.canSetEmotion()&&t.extend(e,{"click @ui.emoteMainBtn":function(){this._toggleEmotionSelectView("emoticonSelectViewRegion")},"click @ui.emoteLayerBtn":function(){this._toggleEmotionSelectView("emoticonSelectViewLayerRegion")}}),this.options.additionalParams&&this.options.additionalParams.isCommentingPermitted&&t.extend(e,{"click @ui.commentMainBtn":function(e){var t=v.get(this._bandNo);this._showCommentInputBoxArea(e),this.jplClick(E.CLASSIFIER.COMMENT_WRITE,{band_no:this._bandNo,post_no:this._postNo,is_preview:t.isPreviewForJplExtra()})},"click @ui.commentLayerBtn":"_showCommentInputBoxArea"}),this._isProperToLinkClickShareMemberList()&&t.extend(e,{"click @ui.sharedCountBtn,@ui.sharedCountLayerBtn":"_showSharedMemberList"}),e},regions:{emoticonSelectViewRegion:{el:"@ui.emoticonSelectViewRegion",replaceElement:!0},emotionViewRegion:{el:"@ui.emotionViewRegion",replaceElement:!0},emotionCountViewRegion:{el:"@ui.emotionCountViewRegion",replaceElement:!0},postShareOptionListViewRegion:{el:"@ui.postShareOptionListViewRegion",replaceElement:!0}},modelEvents:{change:"render"},childViewEvents:{"DEmotionSelectView:changeEmotion":function(e){this._closeEmotionSelectView(),this.model.set(e),(new h).fetchPostDetail(this._bandNo,this._postNo,!0).then(t.bind(this._resetModelAttributes,this))},"DEmotionCountView:clickView":"toggleEmotionCommentArea","DEmotionCountView:clickIcon":function(){this._toggleEmotionSelectView("emoticonSelectViewLayerRegion")},"DEmotionCountView:clickCount":"_scrollToFaceList"},initialize:function(e){var t=e.postModel,n=e.additionalParams||{};this._bandCore=t.getBandCore(),this._bandNo=this._bandCore.bandNo,this._postNo=t.get("postNo"),this._contentKey=T.buildPostKey(this._postNo),this._createdAt=t.get("createdAt"),this._emotionCollection=d.build(),this._bPostDetail=n.bPostDetail||!1,this._preventUnfoldEmotionCommentArea=n.preventUnfoldEmotionCommentArea||!1,this._isCommentingPermitted=n.isCommentingPermitted||!1,this._showEmotionCommentArea=n.showEmotionCommentArea||!1,this._isSimpleCountView=e.isSimpleCountView||!1,this._showPostAdded=!this._isSimpleCountView,this._canDownloadPostComments=n.canDownloadPostComments,this._resetModelAttributes(t),this._bPostDetail&&(this.addRegions({emotionCountViewLayerRegion:{el:"._emotionCountViewLayerRegion",replaceElement:!0},emoticonSelectViewLayerRegion:{el:"._emoticonSelectViewLayerRegion",replaceElement:!0}}),this.model.get("isShareable")&&this.addRegions({postShareOptionListViewLayerRegion:{el:"._postShareOptionListViewLayerRegion",replaceElement:!0}})),this._bPostDetail||(this.listenTo(s.getPostChannel(),s.EVENT.POST_EMOTION_CHANGED,(function(e){this._bandNo===e.get("band").bandNo&&this._postNo===e.get("postNo")&&this._resetModelAttributes(e)})),this.listenTo(s.getPostChannel(),s.EVENT.POST_COMMENT_COUNT_CHANGED,(function(e){this._bandNo===e.bandNo&&this._postNo===e.postNo&&this.model.set("commentCount",e.count)}))),this.listenTo(s.getDGlobalChannel(),s.EVENT.HTML_CLICK,this._closeLayer)},_resetModelAttributes:function(e){this._emotionCollection.reset(e.emotions,{parse:!0}),this.model.set({discriminant:t.uniqueId(),bandNo:e.get("band").bandNo,bandName:e.get("band").name,postNo:e.get("postNo"),isRestricted:e.get("isRestricted"),isShareable:e.get("isShareable"),sharedCount:e.get("sharedCount"),commentCount:e.get("commentCount"),postReadCount:e.get("postReadCount")||e.get("readCount"),emotionCount:e.get("emotionCount"),emotionTypeByViewer:e.get("emotionTypeByViewer"),commonEmotionType:e.get("commonEmotionType"),canDownloadPostComments:this._canDownloadPostComments}),this._triggerChangeCountAttributes(),this._bPostDetail&&s.getPostChannel().trigger(s.EVENT.POST_EMOTION_CHANGED,e)},templateContext:function(){return{preventUnfoldEmotionCommentArea:this._preventUnfoldEmotionCommentArea,bPostDetail:this._bPostDetail,isCommentingPermitted:this._isCommentingPermitted,isSimpleCountView:this._isSimpleCountView,showPostAdded:this._showPostAdded,commentCount:this._getCommaCount(this.model.get("commentCount")),sharedCount:this._getCommaCount(this.model.get("sharedCount")),postReadCount:this._getCommaCount(this.model.get("postReadCount")),emotionByViewer:u.getDetailAttribute(this.model.get("emotionTypeByViewer"))}},_getCommaCount:function(e){return e>0?_.numberWithCommas(e):0},_isProperToLinkClickShareMemberList:function(){var e=v.get(this.options.postModel.get("band").bandNo);return!e.isBandDataStateLoaded()||e.canShowShareCountList()},onRender:function(){var e=!this._preventUnfoldEmotionCommentArea;this._renderEmotionCountView("emotionCountViewRegion",e,!1),this._bPostDetail&&this._renderEmotionCountView("emotionCountViewLayerRegion",f.canSetEmotion(),!0),this._showEmotionCommentArea&&this._openEmotionView(),this.ui.commentToggleBtn.toggleClass("gCursorDefault",!e).toggleClass("-active",this._showEmotionCommentArea),this.ui.sharedCountBtn.toggleClass("gCursorDefault",!this._isProperToLinkClickShareMemberList()),this.ui.commentCountBtn.toggleClass("gCursorDefault",!e),this.ui.emoteMainBtn.toggleClass("gCursorDefault",!f.canSetEmotion()),this.ui.commentMainBtn.toggleClass("gCursorDefault",!this._isCommentingPermitted),this.ui.commentLayerBtn.toggleClass("gCursorDefault",!this._isCommentingPermitted)},changeCommentCount:function(e){this.isDestroyed()||null==e||(this.model.set("commentCount",e),this._bPostDetail&&s.getPostChannel().trigger(s.EVENT.POST_COMMENT_COUNT_CHANGED,{bandNo:this._bandNo,postNo:this._postNo,count:e}))},showEmotionRegion:function(e){this._loadBandData().then(t.bind((function(){this._showPostAdded=!0,this._showEmotionCommentArea=!0,this._resetModelAttributes(e)}),this))},closeEmotionRegion:function(){this._showPostAdded=!this._isSimpleCountView,this._showEmotionCommentArea=!1,this.render()},isEmotionRegionOpen:function(){return this._showEmotionCommentArea},toggleEmotionCommentArea:function(e){e=e||{},this._preventUnfoldEmotionCommentArea||this.trigger("DPostCountView:toggleEmotionComment",e)},_renderEmotionCountView:function(e,t,n){var i=this.model.get("commonEmotionType"),o=this.model.get("emotionCount"),s=this.model.get("emotionTypeByViewer");o>0&&this.getRegion(e).show(m.buildPostEmotionCountView(i,o,s,t,n))},_triggerChangeCountAttributes:function(){this.trigger("DPostCountView:changeCountAttributes",this.model.pick("sharedCount","commentCount","postReadCount","emotionCount","emotionTypeByViewer","commonEmotionType"))},_scrollToCommentArea:function(){return this.trigger("DPostCountView:moveToCommentArea"),!1},_scrollToFaceList:function(){var e=this.$el.scrollParent(),t=this.ui.postAdded.position().top+this.ui.postAdded.height()-e.height();return e.scrollTop(t),!1},_showSharedMemberList:function(){return this._loadBandData().then(t.bind((function(e){var t;e.canShowShareCountList()?a.openWithoutHiding(r.buildDShareCountListView(this._bandNo,this._postNo)):(t=e.getBandCore().showBandMemberTermAsSubscriber()?IM("page_band.post.alert.cannot_open_share_list"):IM("group_band.post.alert.cannot_open_share_list"),A.openLayer({bodyTitle:t}))}),this)),!1},_toggleEmotionSelectView:function(e){var n=this.getRegion(e);!f.canSetEmotion()||this.model.get("isRestricted")||n.hasView()||t.defer(t.bind((function(){n.show(p.buildDEmotionSelectViewByContentKey({bandNo:this._bandNo,contentKey:this._contentKey,emotionTypeByViewer:this.model.get("emotionTypeByViewer")}))}),this))},_closeEmotionSelectView:function(){this._emptyRegions(["emoticonSelectViewRegion","emoticonSelectViewLayerRegion"])},_emptyRegions:function(e){t.each(e,(function(e){var t=this.getRegion(e);null!=t&&t.hasView()&&t.empty()}),this)},_togglePostShareOptionListView:function(e){g.openPostShareViewAtRegion(this.getRegion(e),this._bandCore,this.model.get("postNo"))},_closePostShareOptionListView:function(){this._emptyRegions(["postShareOptionListViewRegion","postShareOptionListViewLayerRegion"])},_showCommentInputBoxArea:function(e){e.preventDefault(),this._showEmotionCommentArea?this.trigger("DPostCountView:moveToCommentInputBox"):this.toggleEmotionCommentArea({scrollToInput:!0})},_openEmotionView:function(){if(this._closeEmotionView(),0!==this._emotionCollection.size()){var e=l.buildPostEmotionViewWithCollection(this._emotionCollection,{useSetEmotion:f.canSetEmotion(),useShowEmotionList:v.get(this._bandNo).canShowEmotionList(),bandCore:this._bandCore,hideInput:!0});this.listenTo(e,l.EVENT.SHOW_EMOTION_LIST,(function(){c.openDEmotionListView(this._bandNo,this._contentKey)})),this.getRegion("emotionViewRegion").show(e)}},_closeEmotionView:function(){this.getRegion("emotionViewRegion").empty()},_closeLayer:function(){this._closeEmotionSelectView(),this._closePostShareOptionListView()},_loadBandData:function(){var e=v.get(this._bandNo);return b.wrapActivePromise(e.loadBandData(),this).then((function(){return e}))}});return y.build=function(e,t){return new y({model:new Backbone.Model,postModel:e,additionalParams:t})},y.buildSimpleCountView=function(e,t){return new y({model:new Backbone.Model,postModel:e,isSimpleCountView:!0,additionalParams:t})},y}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(4),s=n(1186),a=n(1049),r=n(1037),l=n(508),c=n(565),d=n(592),u=n(159),h=n(154),p=n(26),m=n(2669),_=n(560),g=n(509),f=n(487),b=o.View.extend({template:i.template('<div class="_commentListRegion"></div><section class="cCommentWrite _commentInputRegion"></section>'),ui:{commentListRegion:"._commentListRegion",commentInputRegion:"._commentInputRegion"},attributes:{"data-viewname":"DPostCommentMainView"},className:"dPostCommentMainView",regions:{commentListRegion:{el:"@ui.commentListRegion",replaceElement:!0},commentInputRegion:"@ui.commentInputRegion"},behaviors:[u,f],onMessages:(t={},t[u.MSG.COMMENT_SUMMON_AUTHOR]=function(e){this._summonAuthor(e)},t[u.MSG.COMMENT_CHANGE_TO_MODIFICATION_MODE]=function(){this._hideInputView()},t[u.MSG.COMMENT_CANCEL_MODIFICATION]=function(){this._showInputView()},t[u.MSG.COMMENTLIST_SHOW_INPUT]=function(){this._showInputView()},t[u.MSG.COMMENT_GO_FIRST_COMMENT]=function(){this._showInputView()},t[u.MSG.COMMENT_REPLY_INPUT_OPEN]=function(){this._showInputView()},t[u.MSG.MESSAGE_INPUT_SUBMIT]=function(e){var t=e.submitData;_.writeComment(this._bandNo,g.buildPostKey(this._postNo).toApiParams(!0),e.isSecret,t,e.memberType,this).then(i.bind((function(t){if(this._initCommentId=t.comment.comment_id,p.getCommentChannel().trigger(p.EVENT.BAND_FILE_UPDATED),this._simpleMode)return this._renderTotalCommentView(this._initCommentId),void this._sendCreateConfirmLog(e);this._commentListView.fetchAroundComment(this._initCommentId).then(i.bind((function(){this._commentListView.scrollToCommentWithDelay(this._initCommentId),this._sendCreateConfirmLog(e)}),this))}),this)).always(i.bind((function(){this._messageInputView.releaseStandByMode()}),this))},t[u.MSG.MESSAGE_INPUT_TEXTAREA_FOCUS]=function(e){this._mostRecentlyFocusedInputView=e},t),initialize:function(e){this._bandCore=e.bandCore,this._bandNo=this._bandCore.bandNo,this._bandName=this._bandCore.bandName,this._postNo=e.postNo,this._token=e.token,this._isCommentingPermitted=e.isCommentingPermitted,this._totalCount=e.totalCount,this._simpleMode=1==e.simple,this._domHeightDectector=new d,this._featuredComments=e.featuredComments,this._initCommentId=e.initCommentId,this._initCommentReplyId=e.initCommentReplyId,this._memberProfileArray=e.memberProfileArray,this._currentProfileMemberType=e.currentProfileMemberType,this._muteIgnoredAuthorUserNo=e.muteIgnoredAuthorUserNo,this._isHiddenFilterIgnored=e.isHiddenFilterIgnored,this._hideEmotion=e.hideEmotion},onAttach:function(){if(this._simpleMode)return this._commentListView=s.buildDSimpleCommentListView({bandCore:this._bandCore,featuredComments:this._featuredComments,isCommentingPermitted:this._isCommentingPermitted,contentKeyButCommentId:g.buildPostCommentKey(this._postNo,null),canExpressEmotion:!1}),this.showChildView("commentListRegion",this._commentListView),void this._renderSimpleModeInputView();this._renderTotalCommentView(this._initCommentId,this._initCommentReplyId),this._renderInputView()},openTotalCommentView:function(e,t,n){this._renderTotalCommentView(t,n),this._renderInputView(),this._showIfHidden(),e&&this.scrollToMessageInput()},renderTotalListInCaseCommentCountNotSame:function(e){this._commentListView&&this._commentListView.getTotalCommentCount()!=e&&this.openTotalCommentView()},hideView:function(){this.$el.hide(),this._hideInputView()},scrollToMessageInput:function(){this._isCommentingPermitted&&!this.isDestroyed()&&(this._scrollToInputAndFocus(),this.stopListening(this._domHeightDectector),this.listenTo(this._domHeightDectector,d.EVENT.HEIGHT_CHANGED,this._scrollToInputAndFocus),this._domHeightDectector.startDetecting(this._messageInputView.getScrollParent(),100,5))},scrollToCommentArea:function(){var e=this.$el.scrollParent(),t=this.$el.position().top-200;e.scrollTop(t)},fetchLastCommentList:function(){if(!this.isDestroyed())return this._commentListView.fetchLastCommentList()},isMessageInputFocused:function(){return!(!this._messageInputView||this._messageInputView.isDestroyed())&&this._messageInputView.isMessageInputFocused()},isModificationStatus:function(){return!(this._simpleMode||!this._commentListView||this._commentListView.isDestroyed())&&this._commentListView.isModificationStatus()},hasWritingComment:function(){return!(!this._messageInputView||!this._messageInputView.hasInputContent())||r.hasWritingInputDescendantOf(this.$el)},hasFocusingInput:function(){return!(!this._messageInputView||!this._messageInputView.isMessageInputFocused())||r.hasFocusingInputDescendantOf(this.$el)},_showIfHidden:function(){this.$el.show(),this._showInputView()},_hideInputView:function(){this.ui.commentInputRegion.hide()},_showInputView:function(){this.ui.commentInputRegion.show()},_renderSimpleModeInputView:function(){this.ui.commentInputRegion.removeClass("cCommentWrite"),this._isCommentingPermitted&&(this._simpleMode&&i.isEmpty(this._featuredComments)||this._renderInputView())},_renderTotalCommentView:function(e,t){this._commentListView=m.buildDPostCommentListView({bandNo:this._bandNo,postNo:this._postNo,token:this._token,isCommentingPermitted:this._isCommentingPermitted,initCommentId:e,initCommentReplyId:t,muteIgnoredAuthorUserNo:this._muteIgnoredAuthorUserNo,isHiddenFilterIgnored:this._isHiddenFilterIgnored,hideEmotion:this._hideEmotion}),this.showChildView("commentListRegion",this._commentListView),this._simpleMode=!1,this.spawn(u.MSG.COMMENTLIST_TOTAL_LIST_OPEN)},_renderInputView:function(){this._isCommentingPermitted&&(this.showChildView("commentInputRegion",this._generateSingletonInput()),this.ui.commentInputRegion.addClass("cCommentWrite"))},_generateSingletonInput:function(){return this._messageInputView&&!this._messageInputView.isDestroyed()||(this._messageInputView=a.buildDCommentInputView({messageLabel:IM("comment.write_comment"),textareaPlaceHolder:IM("comment.write_comment"),buttonLabel:IM("ui.label.send"),maxMessageLength:l.MAX_LENGTH,overMaxLengthAlertMessage:IM("comment.over_max_message",{count:l.MAX_LENGTH}),bandNo:this._bandNo,standByMessage:IM("ui.label.sending"),readOnlyTextarea:!this._isCommentingPermitted,preventAllEvent:!this._isCommentingPermitted,memberProfileArray:this._memberProfileArray,currentProfileMemberType:this._currentProfileMemberType,isStickerOnTop:!0,mentionOption:c.buildMentionOption({memberGroupMentionPossible:!0,dynamicSearchPossible:!0})})),this._messageInputView},_summonAuthor:function(e){this._isCommentingPermitted&&this._messageInputView&&!this._messageInputView.isDestroyed()&&(this._mostRecentlyFocusedInputView&&!this._mostRecentlyFocusedInputView.isDestroyed()?this._mostRecentlyFocusedInputView.appendMention(e.userNo,e.userName,e.isPageProfile):this._messageInputView.appendMention(e.userNo,e.userName,e.isPageProfile))},_scrollToInputAndFocus:function(){clearTimeout(this._scrollTimer);var e=h.wrapActiveSetTimeout(100,this).then(i.bind((function(){this._messageInputView.scrollToInput(this._getInputPosition()).then(i.bind((function(){this._messageInputView.focusMessageTextArea()}),this))}),this));this._scrollTimer=e.timer},_getInputPosition:function(){var e=this.getUI("commentInputRegion");return{isInLayer:!!e.closest(".lyWrap").length,position:e.position(),offset:e.offset()}},_sendCreateConfirmLog:function(e){var t=i.extend({band_no:this._bandNo,post_no:this._postNo},e.jplExtra);this.jplClick(f.CLASSIFIER.COMMENT_CREATE_CONFIRM,t)}});return b.buildDPostCommentMainView=function(e){return new b(e)},b}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(167),s=n(166),a=n(2670),r=i.View.extend({options:{subscribed:!1},attributes:{"data-viewname":"DPageBandSubscriptionButtonView"},template:t.template(a),templateContext:function(){return{message:this.setSubscriptionMessage()}},ui:{btnPageSubscription:"._btnPageSubscription",subscribeMessage:"._subscribeMessage"},events:{"click @ui.btnPageSubscription":function(){this.trigger("DPageBandSubscriptionButtonView:clickSubscription")}},initialize:function(e){this._subscribed=e.subscribed},onRender:function(){if(this._subscribed)this.ui.btnPageSubscription.addClass("-disabled").attr("disabled","disabled");else{this.ui.btnPageSubscription.removeClass("-disabled").removeAttr("disabled");var e=o.getCurrentUserEnvStorage(),n=[s.SubscriptionMessageClosed];e.get(n)?this.ui.subscribeMessage.hide():(this.ui.subscribeMessage.show(),e.set(n,!0),setTimeout(t.bind((function(){this.isDestroyed()||this.ui.subscribeMessage.hide()}),this),3e3))}},renderAsSubscribed:function(){this._subscribed=!0,this.render()},setSubscriptionMessage:function(){return this._subscribed?IM("page_band.label.is_subscribing"):IM("page_band.label.subscribe_long")}});return r.buildNoTextButtonView=function(e){return new r({subscribed:e})},r}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(6);return{startRouter:function(e,n,i){if(!t.History.started)return e?(i.start({silent:!0}),void i.loadUrl(e)):void i.start({pushState:!0})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(655),o=n(13),s=n(801),a=n(54),r=n(167),l=n(166),c=n(1056),d=n(176);return{doRouteChangeAction:function(){return t.Deferred((function(e){return t.when(i.fetchContentCreationPunishmentInfo(),function(){if(!o.isLogedIn())return t.Deferred().resolve();var e=[s.MESSAGE_SEND_KEY.API_KEY_NAME.COMMENT,s.MESSAGE_SEND_KEY.API_KEY_NAME.CHAT].join(",");return a.getUserConfig(e).then(_.bind((function(e){var t=!!e&&JSON.parse(e[0].value)||!1,n=!!e&&JSON.parse(e[1].value)||!1;r.getCurrentUserEnvStorage().set([l.MessageSendKey,s.MESSAGE_SEND_KEY.API_KEY_NAME.COMMENT],t),r.getCurrentUserEnvStorage().set([l.MessageSendKey,s.MESSAGE_SEND_KEY.API_KEY_NAME.CHAT],n)}),this))}(),c.prepareTranslation(),d.fetchBandJoin()).always((function(){e.resolve()}))})).promise()}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(2),n(0),n(6),n(4),n(26),n(555),n(577)],void 0===(o=function(e,t,n,i,o,s,a){var r={ESCAPE:{CODE:s.ESCAPE,KEY_DOWN:o.EVENT.DOCUMENT_ESC_KEY_DOWN,KEY_UP:o.EVENT.DOCUMENT_ESC_KEY_UP},RIGHT:{CODE:s.RIGHT,KEY_UP:o.EVENT.DOCUMENT_RIGHT_KEY_UP},LEFT:{CODE:s.LEFT,KEY_UP:o.EVENT.DOCUMENT_LEFT_KEY_UP}},l=function(e){return null==e?null:t.find(r,(function(t){return t.CODE==e}))};return new(i.Object.extend({initialize:function(){this._document=e(document),this._isFullScreenKeyEvent=!1,this._document.on("keydown",t.bind((function(e){var t=l(e.keyCode);null==t||null==t.KEY_DOWN||this._isFullScreenKeyEvent||o.getDGlobalChannel().trigger(t.KEY_DOWN,e)}),this)),this._document.on("keyup",t.bind((function(e){var t=l(e.keyCode);null==t||null==t.KEY_UP||this._isFullScreenKeyEvent?this._isFullScreenKeyEvent=!1:o.getDGlobalChannel().trigger(t.KEY_UP,e)}),this)),e.browser.msie&&this._document.on("fullscreenchange MSFullscreenChange",t.bind((function(e){a.isFullScreenMode()&&(this._isFullScreenKeyEvent=!0)}),this))},onDestroy:function(){this._document.off("keydown"),this._document.off("keyup"),e.browser.msie&&this._document.off("fullscreenchange MSFullscreenChange")}}))}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(2),o=n(0),s=n(4),a=n(152),r=n(26),l=n(486),c=n(491),d=n(2150),u=n(1110),h=n(1247),p=n(2453),m=n(2457),_=n(1579),g=n(1580),f=n(159),b=n(1061),v=n(1050),A=n(1253),E=n(153),T=n(154),C=n(495),y=n(619),M=n(1581),I=n(487),S=n(2671),w=n(1041),N=n(656);return s.View.extend({attributes:{"data-viewname":"DPostDetailView"},ui:{dimArea:"._dimArea",postAuthorRegion:"._postAuthorRegion",postReaderWrap:"._postReaderWrap",postReaders:"._postReaders",contentListRegion:"._contentListRegion",contentTranslationRegion:"._contentTranslationRegion",moreOptionListRegion:"._moreOptionListRegion",postCountAndEmotionRegion:"._postCountAndEmotionRegion",pageSubscriptionRegion:"._pageSubscriptionRegion",commentRegion:"._commentRegion",postWrapper:"._postWrapper",linkBand:"._linkBand",missionInfo:"._missionInfo",postPinnedHashtagsRegion:"._postPinnedHashtagsRegion"},regions:{postAuthorRegion:{el:"@ui.postAuthorRegion",replaceElement:!0},contentListRegion:{el:"@ui.contentListRegion",replaceElement:!0},contentTranslationRegion:{el:"@ui.contentTranslationRegion",replaceElement:!0},moreOptionListRegion:"@ui.moreOptionListRegion",postCountAndEmotionRegion:{el:"@ui.postCountAndEmotionRegion",replaceElement:!0},commentRegion:{el:"@ui.commentRegion",replaceElement:!0},pageSubscriptionRegion:"@ui.pageSubscriptionRegion",postPinnedHashtagsRegion:{el:"@ui.postPinnedHashtagsRegion",replaceElement:!0}},events:{"click @ui.postReaders > a":"_openPostReaderList"},modelEvents:{change:"_renderContents","DPostPollVIew:closeVote":"_fetchLatestCommentList"},onMessages:(t={},t[f.MSG.COMMENTLIST_CHANGE_COLLECTION]=function(){this.changeCommentCountOnCommentListChange()},t[f.MSG.POST_TODO_CHECKED]=function(e){this._commentMainView&&this._commentMainView.renderTotalListInCaseCommentCountNotSame(e)},t),parentBehaviors:[{behaviorClass:C,sceneId:C.SCENE.POST_DETAIL},I,b,f,w.withUI("dimArea",b.POST_MORE_ACTIONS.UNCOVER_DIMMED_POST)],initialize:function(e){this.bPostDetail=!0,this._initCommentId=e.initCommentId,this._initCommentReplyId=e.initCommentReplyId,this._translationChannel=this._createTranslationChannel(),this._isPageSubscribedRecently=!1,this._isApprovablePost=this.model.isApprovablePost(),this._token=e.token,e.uncoverOnce&&this.uncoverOnce(),this.listenTo(r.getPostChannel(),r.EVENT.POST_UPDATED,(function(e){this.model.getPostNo()===e&&(this._expireRenderedContents(),this.model.fetchPostDetail())})),this.listenTo(r.getPostChannel(),r.EVENT.POST_DELETED,(function(e){this.model.getPostNo()===e.postNo&&this.model.getBandNo()===e.bandNo&&this.destroy()})),this.on("DPostMoreActionBehavior:pageSubscriptionCompleted",(function(){this._isPageSubscribedRecently=!0,r.getPostChannel().trigger(r.EVENT.POST_UPDATED,this.model.get("postNo"))})),this.listenTo(r.getPostChannel(),r.EVENT.CANCEL_MISSION_CONFIRM,(function(e){this.model.getPostNo()===e.postNo&&this.model.fetchPostDetail()})),this.listenTo(r.getShortcutChannel(),r.SHORTCUT_EVENT.BOOKMARK_POST,(function(e){this.model.getPostNo()===e.postNo&&this.model.getBandNo()===e.bandNo&&this.trigger(b.POST_MORE_ACTIONS.BOOKMARK_ADD_POST)}))},onRender:function(){this._expireRenderedContents(),this._isApprovablePost?this._renderContentsForApprovablePost():this._renderContents()},getCommentMainView:function(){return this._commentMainView},changeCommentCountOnCommentListChange:function(){return this._everCommentChangeTriggered?y.fetchPostTotalCommentCount(this.model.getBandNo(),this.model.getPostNo(),this).then(o.bind((function(e){this.postCountView.changeCommentCount(e)}),this)):(this._everCommentChangeTriggered=!0,i.Deferred().resolve())},_canWriteComment:function(){return!this.model.get("shouldDisableComment")&&this._bandData.canWriteComment()},_renderContentsForApprovablePost:function(){c.getCachedBandData(this.model.getBandNo()).then(o.bind((function(e){this._bandData=e,this._resetTranslationChannel(),this._showPostAuthor(e),this._showContents(e,!0),this._toggleTranslationView(),this._showMissionForPost(),this.triggerMethod("complete:_renderContents",{renderedOtherPost:!0})}),this))},uncoverOnce:function(){this._uncoveredOnce=!0,this.model.uncoverOnce(),this.render()},_updateDimArea:function(){w.renderDimOfView(this,o.bind((function(e){this.getUI("postWrapper").toggleClass("-blockUserPost",e)}),this))},_renderContents:function(){var e=this.model.getPostNo();e&&(this._showMissionForPost(),c.getCachedBandData(this.model.getBandNo()).then(o.bind((function(t){this._bandData=t,this._resetTranslationChannel(),this._showPostAuthor(t),this._checkPostReadUserCount(t),this._renderMoreOptionList(t),this._showContents(t),this._showPostCount(t),this._showPostPinnedHashtagsView(t),this.getUI("pageSubscriptionRegion").length>0&&(this.showChildView("pageSubscriptionRegion",M.buildNoTextButtonView(!this.model.getBandCore().isSubscribingAvailable())),this.listenTo(this.getChildView("pageSubscriptionRegion"),"DPageBandSubscriptionButtonView:clickSubscription",(function(){var e=this.model.getBandNo();this.jplClick(I.CLASSIFIER.JOIN_PAGE,{band_no:e,position:"page_post_writer"},e),this.trigger(b.POST_MORE_ACTIONS.SUBSCRIBE_PAGE_BAND)})));var n=[this.model.getBandNo(),e].join("_"),i=n!==this._contentId,o=this._contentsExpired;this._contentId=n,this._contentsExpired=!1,(i||o)&&(this._showCommentList(t),this._toggleTranslationView()),this._updateDimArea(),this.triggerMethod("complete:_renderContents",{renderedOtherPost:i})}),this)))},_expireRenderedContents:function(){this._contentsExpired=!0},_showPostPinnedHashtagsView:function(e){if(e.getBandCore().supportPinnedHashtags()){var t=S.build({bandData:e,postModel:this.model});this.showChildView("postPinnedHashtagsRegion",t)}},_showMissionForPost:function(){if(N.hasRestriction(this.model))this.ui.missionInfo.hide();else{var e,t=this.model.getMissionInfoForPost(),n='<span class="missonName -pointColor"><span class="iconMisson"></span><%- title %></span>';t?(n=t.isRestrictedPostMission()||this.options.approachedPostListType==a.POST_LIST_TYPE.CONFIRM_POST_LIST_WITH_MISSION?"<div>"+n+"</div>":'<a href="<%- href %>" class="linkText">'+n+"</a>",e={title:t.getPostMissionConfirmCompleteText(),href:E.GROUP_BAND_MISSION_CONFIRM_POST.makeUrl({band_no:this.model.getBandNo(),mission_id:this.model.getMissionInfoForPost().getMissionId()})},this.ui.missionInfo.html(o.template(n)(e)),this.ui.missionInfo.show()):this.ui.missionInfo.hide()}},_isShowPostReaderArea:function(e){return e.getBandCore().supportPostReaderView()&&e.isViewPostReaderPermitted()},_showPostAuthor:function(e){var t=u.build(this.model,{bPostDetail:this.bPostDetail,showReaderCount:!this._isApprovablePost&&!this._isShowPostReaderArea(e)});this.getRegion("postAuthorRegion").show(t)},_checkPostReadUserCount:function(e){this._isShowPostReaderArea(e)&&!this.model.isRestricted()?(this.ui.postReaders.html('<a href="#" role="button">'+IM("post.read_post.message.read_user",{count:this.model.get("readCount")||"0"})+"</a>"),this.ui.postReaderWrap.show()):this.ui.postReaderWrap.hide()},_renderMoreOptionList:function(e){if(this.model.get("isRestricted")&&!this.model.get("isAuthor")&&!e.isContentsDeletionPermitted()||N.hideAllMoreOption(this.model)?this.ui.moreOptionListRegion.hide():this.ui.moreOptionListRegion.show(),!this.getChildView("moreOptionListRegion")){var t=this.model.getBandNo(),n=this.model.getPostNo(),i=h.buildOptionList(t,n,this.model,{bPostDetail:this.bPostDetail,translationChannel:this._translationChannel});this.listenTo(i,"postMoreOptionList:clickMenu",(function(e){this.triggerMethod(e)})),this.getRegion("moreOptionListRegion").show(i)}},_isNotice:function(){return!N.hasRestriction(this.model)&&this.model.get("isNotice")},_openPostReaderList:function(){this._isNotice()?this._openBandNoticeReaders():this._openPostReaders()},_openPostReaders:function(){var e=this.model.getBandNo(),t=this.model.getPostNo();return(new d).fetchPostReaders(e,t).then(o.bind((function(e){var t=new p.build({model:e,bandData:this._bandData});return l.open(t),!1}),this))},_openBandNoticeReaders:function(){var e=this.model.getBandNo(),t=this.model.getPostNo();return(new d).fetchBandNoticeReaders(e,t).then(o.bind((function(e){var t=new p.build({model:e,bandData:this._bandData});return l.open(t),!1}),this))},_showContents:function(e,t){this.showChildView("contentListRegion",m.build({postModel:this.model,bandNo:this.model.getBandNo(),postNo:this.model.getPostNo(),bPostDetail:this.bPostDetail,attachmentDisplayType:a.ATTACHMENT_DISPLAY_TYPE.DETAIL,isPreviewBand:e.isPreview(),guideBand:e.isGuide(),bandData:e,preventMentionAnchor:!e.getBandCore().supportMentionClick(),clickDisabledPostTypeOnDetail:t,isRestricted:this.model.isRestricted()}))},_showPostCount:function(e){var t=this.getRegion("postCountAndEmotionRegion");if(this.model.isRestricted())return t.empty(),void(this.postCountView=null);var n={isCommentingPermitted:this._canWriteComment(),bPostDetail:this.bPostDetail,showEmotionCommentArea:!0,preventUnfoldEmotionCommentArea:!0,canDownloadPostComments:this.model.getCommentCount()>0&&e.canDownloadComments(this.model.get("isAuthor"))};this.postCountView=_.build(this.model,n),this.listenTo(this.postCountView,"DPostCountView:moveToCommentInputBox",(function(){this._commentMainView.scrollToMessageInput()})),this.listenTo(this.postCountView,"DPostCountView:moveToCommentArea",(function(){this._commentMainView.scrollToCommentArea()})),t.show(this.postCountView)},_showCommentList:function(e){var t=this.getRegion("commentRegion");if(this.model.get("isRestricted"))return t.empty(),void(this._commentMainView=null);var n=!1,i=!1;if(this._uncoveredOnce){var o=this.model.getOriginalRestriction();n=o===a.RESTRICTION_TYPE.MUTE_AUTHOR,i=o===a.RESTRICTION_TYPE.HIDE_POST}this._commentMainView=g.buildDPostCommentMainView({bandCore:this.model.getBandCore(),postNo:this.model.getPostNo(),token:this._token,totalCount:this.model.get("commentCount"),simple:!1,isCommentingPermitted:!N.hasRestriction(this.model)&&this._canWriteComment(),initCommentId:this._initCommentId,initCommentReplyId:this._initCommentReplyId,currentProfileMemberType:e.getCurrentSelectedMemberProfileMemberTypeAtComment(),memberProfileArray:e.getSelectableMemberProfilesAtComment(),muteIgnoredAuthorUserNo:n?this.model.getAuthor().getUserNo():void 0,hideIgnoredAuthorUserNo:i?this.model.getAuthor().getUserNo():void 0,isPostVisibleOnlyToAuthor:this.model.get("isVisibleOnlyToAuthor"),isPostRecoverableByViewer:this.model.get("isRecoverableByViewer"),isHiddenFilterIgnored:i,hideEmotion:this.model.get("isVisibleOnlyToAuthor")&&!i}),t.show(this._commentMainView),this._initCommentId=null,this._initCommentReplyId=null},_fetchLatestCommentList:function(){var e=this.model.getPostModelId();T.wrapActiveSetTimeout(1e3,this).then(o.bind((function(){this._commentMainView&&e===this.model.getPostModelId()&&this._commentMainView.fetchLastCommentList()}),this))},_createTranslationChannel:function(){var e=v.build();return this.listenTo(e,v.EVENT.SEE_TRANSLATION,(function(t){var n=this.model.getBandNo(),i=this.model.getPostNo();e.translatePost(n,i,t.targetLanguage,t.sourceLanguage)})),this.listenTo(e,v.EVENT.TRANSLATION_END,(function(e){var t=e.content;t&&(this.model.set({content:t},{silent:!0}),this._showContents(this._bandData))})),e},_resetTranslationChannel:function(){this._translationChannel.resetProperties({isTranslatable:this.model.get("isTranslatable"),writtenIn:this.model.get("writtenIn"),content:this.model.get("content"),highZIndex:!0})},_toggleTranslationView:function(){var e=this.getRegion("contentTranslationRegion");N.hasRestriction(this.model)?e.show(A.build({translationChannel:this._translationChannel})):e.empty()}})}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2154),o=n(510),s=n(153),a=n(162),r=n(53),l=n(1097),c=n(2431),d=n(22),u=n(1039),h=n(167),p=n(166),m=n(590),_=n(26),g=n(513),f=n(84),b=n(486),v=n(1153),A=n(13),E=n(2433),T=n(2027),C=n(556),y=n(553);return{WRITE_ACTION:{NEW_POST:"_newPost",NEW_POST_WITH_SCHEDULE:"_newPostWithSchedule",NEW_POST_WITH_LIVE:"_newPostWithLive",MODIFY_POST:"_modifyPost",COPY_POST:"_copyPost",SHARE_URL_WITH_BAND_SELECTION:"_shareUrlWithBandSelection",SHARE_URL_ON_BANDS:"_shareUrlOnBands",NEW_POST_WITH_MISSION:"_newPostWithMission",NEW_POST_WITH_SHARE_MISSION_CONFIRM_RANK:"_newPostWithShareMissionConfirmRanking"},onDestroy:function(){console.log("destroy")},writePost:function(e,t){var n=this[e];n&&"function"==typeof n&&this._isValidAction()&&this[e](t)},_isValidAction:function(){return!m.isContentCreationPunished()},_newPost:function(e){var n=e.bandData,a=e.showBandNameLabel,l=e.confirmModalInfo,c=e.attachment,d=e.mission,u=i.openNewLayer(n,{showBandNameLabel:a,attachment:c,mission:d}),h=function(){o.openLayer({bodyDesc:l.bodyDesc}).once(o.EVENTS.CONFIRM,l.confirmHandler)};u.once("postEditor:reservedPostAdded",t.bind((function(e){_.getPostChannel().trigger(_.EVENT.RESERVED_POST_ADDED,e),l&&h()}),this)),u.once("postEditor:postAdded",t.bind((function(e){_.getPostChannel().trigger(_.EVENT.POST_ADDED,e),l&&h()}),this)),u.once("postEditor:approvablePostAdded",t.bind((function(e){_.getPostChannel().trigger(_.EVENT.MY_APPROVABLE_POST_ADDED,e)}),this)),u.once("destroy",t.bind((function(){r.getCurrentRouteInfo().routeInfo==s.GROUP_BAND_POST_CREATE&&s.GROUP_BAND_HOME.goDForced({band_no:n.getBandNo()})}),this))},_newPostWithSchedule:function(e){var n=e.bandData,o=e.scheduleModel,s=i.openNewLayerWithSchedule(n.getBandCore(),o);s.once("postEditor:reservedPostAdded",t.bind((function(e){b.closeAll(),_.getPostChannel().trigger(_.EVENT.RESERVED_POST_ADDED,e)}),this)),s.once("postEditor:postAdded",t.bind((function(e){b.closeAll(),_.getPostChannel().trigger(_.EVENT.POST_ADDED,e)}),this)),s.once("postEditor:approvablePostAdded",t.bind((function(e){b.closeAll(),_.getPostChannel().trigger(_.EVENT.MY_APPROVABLE_POST_ADDED,e)}),this))},_newPostWithLive:function(e){var n=e.bandData,o=e.liveVideo,s=n.getBandCore();h.getCurrentUserEnvStorage().get([p.PostWriteWithLive])||(h.getCurrentUserEnvStorage().set([p.PostWriteWithLive],!0),alert(IM("post.write.with.live.message"))),i.openNewLayerWithLiveVideo(s,o).once("postEditor:postAdded",t.bind((function(e){_.getPostChannel().trigger(_.EVENT.POST_ADDED,e)}),this))},_newPostWithShareMissionConfirmRanking:function(e){i.openNewLayerWithShareMissionConfirmRanking(e)},_newPostWithMission:function(e){var n=e.bandData,o=e.bandMissionModel,s=v.createBandMissionConfirmSummaryModel(o.getBandNo(),o.getMissionId(),A.getUserData().getUserNo());s.fetchBandMissionConfirmSummary().then((function(){var a=i.openNewLayerWithMission(t.extend({},e,{bandMissionConfirmSummaryModel:s}));a.once("postEditor:postAdded",t.bind((function(e){_.getPostChannel().trigger(_.EVENT.POST_ADDED,e),E.openDMissionConfirmCelebrationLayer(o,s,n)}),this)),a.once("postEditor:approvablePostAdded",t.bind((function(e){_.getPostChannel().trigger(_.EVENT.MY_APPROVABLE_POST_ADDED,e),E.openDMissionConfirmCelebrationLayer(o,s,n)}),this))})),T.loadLottie()},_modifyPost:function(e){var n=e.bandNo,o=e.postNo,s=e.postModel,a=i.openModifyLayer(n,o,s);a.once("postEditor:postUpdated",t.bind((function(e){_.getPostChannel().trigger(_.EVENT.POST_UPDATED,e.postNo)}),this)),a.once("postEditor:reservedPostUpdated",t.bind((function(e){_.getPostChannel().trigger(_.EVENT.RESERVED_POST_UPDATED,e.reservedPostId)}),this)),a.once("postEditor:approvablePostUpdated",t.bind((function(e){_.getPostChannel().trigger(_.EVENT.MY_APPROVABLE_POST_UPDATED,e.approvablePostId)}),this))},_copyPost:function(e){var n=e.bandNo,s=e.postNo,a=e.hasScheduleAttachment,r=[u.BAND_FILTER.POSTING];a&&r.push(u.BAND_FILTER.REGISTER_SCHEDULE),(new C).fetchPost(n,s,"copy").then((function(e){c.openLayer({title:IM("web.inviteband.btn.choice_band"),excludedBandNos:[n],bandTypes:e.getCopiableBandTypes(),groupBandFilters:r,pageBandFilters:[u.BAND_FILTER.PAGE,u.BAND_FILTER.POSTING]}).once("multipleBand:selected",t.bind((function(s){i.openCopyLayer(n,e,s).once("postEditor:postCopied",t.bind((function(e){o.openLayer({bodyDesc:IM("postwrite.confirm.write_complete_goto_band")}).once(o.EVENTS.CONFIRM,t.bind((function(){y.latestContents(e.bandCore).go()}),this))}),this))}),this))}))},_shareUrlWithBandSelection:function(e){var n=e.shareUrl,i=e.message,o=e.excludedBandNos,s=e.isSingleBandSelection,a=!!e.withoutHiding,r=!!e.gotoBandOnNewTab,c=l.SELECTION_TYPE.MULTIPLE_SELECT;s&&(c=l.SELECTION_TYPE.SINGLE_SELECT);var h=l.openLayer({title:IM("web.postwrite.title.new_post"),selectionType:c,bandTypes:[d.BAND_TYPE.GROUP],excludedBandNos:o,groupBandFilters:[u.BAND_FILTER.POSTING],pageBandFilters:[],withoutHiding:a});h.on("multipleBand:selected",t.bind((function(e){this._shareUrlOnBands({shareUrl:n,message:i,bandList:e,withoutHiding:a,gotoBandOnNewTab:r})}),this)),h.on("singleBand:selected",t.bind((function(e){this._shareUrlOnBands({shareUrl:n,message:i,bandList:[e],withoutHiding:a,gotoBandOnNewTab:r})}),this))},_shareUrlOnBands:function(e){var n=e.shareUrl,r=e.message,l=e.bandList,c=e.withoutHiding,d=!!e.gotoBandOnNewTab;i.openUrlShareLayer(n,r,l,c).then(t.bind((function(e){var i=s.GROUP_BAND_POST_DETAIL.isMatched(n)||a.PAGE_BAND_POST_DETAIL.isMatched(n);1===l.length&&e.once("postEditor:approvablePostAdded",t.bind((function(e){var t=s.GROUP_BAND_MY_APPROVABLE_POST.makeUrl({band_no:e.bandNo});d?g.openWindowXSSSafely(t,"_blank"):f.go(t)}),this));var r=i?"postEditor:postShared":"postEditor:postAdded";e.once(r,t.bind((function(n){o.openLayer({bodyDesc:IM("postwrite.confirm.write_complete_goto_band"),withoutHiding:c}).once(o.EVENTS.CONFIRM,t.bind((function(){var e=s.GROUP_BAND_HOME.makeUrl({band_no:n.bandNo});d?g.openWindowXSSSafely(e,"_blank"):f.go(e)}),this)),e.destroy()}),this))}),this))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(2),n(0),n(4),n(189)],void 0===(o=function(e,t,n,i){var o=n.Behavior.extend({ui:{image:"img"},onRender:function(){t.bindAll(this,"_onImageLoaded");var e=this.view.model.get("width");e?this._setWidth(e):this.ui.image.on("load",this._onImageLoaded)},_onImageLoaded:function(t){var n=e(t.currentTarget);n.attr("width",n.width()),this._setWidth(n.width())},_setWidth:function(e){this.view.trigger("set:width",e)},onBeforeDetach:function(){this.ui.image.off("load",this._onImageLoaded)}});return i.ImageWidthSettingBehavior=o,o}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(16),s=n(4),a=n(167),r=n(166),l=n(152),c=n(2166),d=n(2167),u=n(1618),h=n(486),p=n(197),m=n(2168),_=n(1115),g=n(906);n(185);var f=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorPollAttachView"},template:i.template(c),templateContext:function(){return{msg_cid:this.model.cid,msg_title_maxlength:l.POLL_TITLE_MAX_LENGTH,msg_parseISO:function(e){return o(e).format("YYYY-MM-DD")},pollImportHelpClosed:a.getCurrentUserEnvStorage().get([r.PollImportHelpClosed])||!1,isExistVotedMember:this.model.hasVotedMember(),voteVisibleQualificationOptions:this._getVoteVisibleQualificationOptions()}},ui:{titleWrap:"._titleWrap",pollTitle:"#pollTitle",pollSubjectTitle:"._pollSubjectTitle",pollSubjectList:"._pollSubjectList",btnAddPollSubject:"._btnAddPollSubject",btnImportPrevPoll:"._btnImportPrevPoll",popoverHelpImportPoll:"._popoverHelpImportPoll",btnCloseImportPollHelpPopover:"._btnCloseImportPollHelpPopover",scrollArea:"._scrollArea",btnClose:"._btnClose",btnComplete:"._btnComplete",chkMultipleSelect:"._chkMultipleSelect",votableLimitWrapper:"._votableLimitWrapper",votableLimit:"._votableLimit",chkAnonymous:"._chkAnonymous",orderBySelector:"._orderBySelector",chkEndedAt:"._chkEndedAt",endedAtWrapper:"._endedAtWrapper",endedAtInputRegion:"._endedAtInputRegion"},regions:{endedAtInputRegion:{el:"@ui.endedAtInputRegion",replaceElement:!0}},events:{"focus @ui.pollTitle":function(){this.getUI("titleWrap").addClass("-focus")},"keydown @ui.pollTitle":function(){var e=this._validateTitleModifiable();e&&alert(e)},"click @ui.titleWrap":function(){var e=this._validateTitleModifiable();e&&alert(e)},"blur @ui.pollTitle":function(){this.getUI("titleWrap").removeClass("-focus")},"keypress @ui.pollSubjectTitle":function(e){var n=t(e.currentTarget);n.parent("li").is(":last-child")&&n.val().length>0&&this._addSubjectAndScroll(),n.attr("value",t.trim(n.val()))},"blur @ui.pollSubjectTitle":function(e){var n=t(e.currentTarget);n.prop("value",t.trim(n.val()))},"click @ui.btnAddPollSubject":"_addSubjectAndScroll","click @ui.chkMultipleSelect":function(e){var t=this._validateMultipleSelectModifiable();if(t)return alert(t),void this._toggleChecked(e);this._toggleLimitMultipleSelect(),this._updateValidStatus()},"click @ui.votableLimit":function(e){var t=this._validateMultipleSelectModifiable();if(t)return this.getUI("votableLimit").blur(),alert(t),!1},"click @ui.chkAnonymous":function(e){var t=this._validateAnonymousModifiable();if(t)return alert(t),void this._toggleChecked(e)},"click @ui.btnImportPrevPoll":function(){"none"!==this.getUI("popoverHelpImportPoll").css("display")&&this._closeImportPollHelpPopover();var e=m.openAsLayer(this.bandNo);this.listenTo(e,"select:item-import",i.bind((function(t){(!i.isEmpty(this.model.get("title"))||this.model.get("subjects").models.length>0||this.model.hasChanged())&&!confirm(IM("web.postwrite.form_attendance_check.prev_attendance_check_import_confirm"))||(e.destroy(),this.model.setImportJSON(t.model.toJSON()),this.render())}),this))},"click @ui.btnCloseImportPollHelpPopover":"_closeImportPollHelpPopover","change @ui.chkEndedAt":"_toggleEndedAt","click @ui.btnClose":"_cancel","click @ui.btnComplete":"_complete",input:"_updateValidStatus",change:"_updateValidStatus"},initialize:function(e){this.bandNo=e.bandNo,this._body=t("body"),this._canSetEndedAt=!!this.model.get("endedAt"),this.model.set({isNotInitiaStatus:!1})},serializeData:function(){var e=this.model.toJSON();return e.canSetEndedAt=this._canSetEndedAt,e},layerOnEscKeyDown:function(){this._cancel()},onRender:function(){0===this.model.get("subjects").length?(this._addSubject(),this._addSubject(),this._addSubject()):(this.model.get("subjects").each(i.bind((function(e){this._addSubject(e.get("title"),e.get("pollSubjectId"))}),this)),this._addSubject()),setTimeout(i.bind((function(){this._canSetEndedAt||this.ui.endedAtWrapper.hide(),this.model.get("isMultipleSelect")||this.ui.votableLimitWrapper.hide()}),this),0),this.ui.btnComplete.toggleClass("-disabled",!this.model.isValid()),this.model.hasChanged()&&this.onAttach()},onAttach:function(){t.browser.msie&&t.browser.versionNumber<=8?this.ui.pollSubjectList.sortable({items:"li",cursor:"move"}):this._sortable=p.create(this.ui.pollSubjectList[0],{scrollSensitivity:70,handle:".dragBar",onEnd:i.bind((function(){this._updateValidStatus()}),this),setData:null}),this.ui.pollTitle.focus(),this._toggleEndedAt()},onBeforeDetach:function(){this._sortable&&this._sortable.destroy()},_syncModelEndedAt:function(){var e=null;if(this._canSetEndedAt){var t=this.getChildView("endedAtInputRegion").getDateTime();if(!this._isValidEndedAtInputValue(t))return!1;e=o(t.date+" "+t.time,t.dateFormat+" "+t.timeFormat).valueOf()}return this.model.set("endedAt",e),!0},_validateTitleModifiable:function(){if(this.model.hasVotedMember())return IM("postwrite.attach.poll.alert_voted_member_exist")},_validateMultipleSelectModifiable:function(){if(this.model.hasVotedMember())return IM("postwrite.attach.poll.alert_voted_member_exist")},_validateAnonymousModifiable:function(){if(this.model.hasVotedMember())return IM("postwrite.attach.poll.alert_voted_member_exist")},_toggleChecked:function(e){$target=t(e.currentTarget);var n=$target.prop("checked");$target.prop("checked",!n)},_toggleLimitMultipleSelect:function(){this.getUI("chkMultipleSelect").is(":checked")?this.getUI("votableLimitWrapper").show():this.getUI("votableLimitWrapper").hide()},_syncModelData:function(){var e=u.extractModelData("postPoll",this);e.votableLimit?(e.isVoteLimited=!0,e.votableLimit=parseInt(e.votableLimit)):(e.isVoteLimited=!1,delete e.votableLimit),this.model.set(e)},_updateValidStatus:function(){this._syncModelData(),this.ui.btnComplete.toggleClass("-disabled",!this.model.isValid())},_complete:function(){this._syncModelData(),this._syncModelEndedAt()&&this.model.isValid()&&(this.trigger(g.EVENT.ATTACH,this.model),this.destroy())},_cancel:function(){this.trigger(g.EVENT.CANCEL),this.destroy()},_toggleEndedAt:function(){var e=this.getRegion("endedAtInputRegion");if(!this.ui.chkEndedAt.prop("checked"))return this.ui.endedAtWrapper.hide(),this._canSetEndedAt=!1,void e.empty();this.ui.endedAtWrapper.show(),this._canSetEndedAt=!0,e.show(_.buildSolarDateInputView({dateTime:this._getEndedAtInputInitValue(),canTextEdit:!1,timeMinutesInterval:30,datepickerDirection:_.DATEPICKER_DIRECTION.UP,timepickerDirection:_.TIMEPICKER_DIRECTION.UP,dateValidator:{isValid:i.bind(this._isValidEndedAtInputValue,this),getMinDate:i.bind(this._getEndedAtMinDate,this),getMaxDate:i.bind(this._getEndedAtMaxDate,this)}}))},_getEndedAtInputInitValue:function(){return o(this.model.get("endedAt")||this._getDefaultEndedAt())},_getEndedAtMinDate:function(){return o()},_getEndedAtMaxDate:function(){return o().add(90,"days").endOf("day")},_isValidEndedAtInputValue:function(e){var t=o(e.date+" "+e.time,e.dateFormat+" "+e.timeFormat);return!(null==t||!t.isValid()||t.isBefore(this._getEndedAtMinDate())||t.isAfter(this._getEndedAtMaxDate()))||(alert(IM("postwrite.attach.poll.alert_invalid_ended_at")),!1)},_getDefaultEndedAt:function(){return o().add({days:1,hours:1}).valueOf()},_addSubject:function(e,t){"string"!=typeof e&&(e=void 0);var n=this.$el.find("._pollSubjectList li").length;if(n<l.POLL_SUBJECT_LIMIT){var o={index:n,title:e,pollSubjectId:t,subjectMaxLength:l.POLL_SUBJECT_MAX_LENGTH};this.ui.pollSubjectList.append(i.template(d)(o))}return n+1===l.POLL_SUBJECT_LIMIT&&this.ui.btnAddPollSubject.hide(),!1},_addSubjectAndScroll:function(){return this._addSubject(),this.ui.scrollArea.stop().animate({scrollTop:this.ui.pollSubjectList.height()-this.ui.scrollArea.height()/2}),!1},_closeImportPollHelpPopover:function(){this.getUI("popoverHelpImportPoll").hide(),a.getCurrentUserEnvStorage().set([r.PollImportHelpClosed],!0)},_getVoteVisibleQualificationOptions:function(){var e=l.POLL_VOTE_VISIBLE_QUALIFICATION,t=[e.ALL,e.ALL_AFTER_VOTE,e.ALL_AFTER_POLL_END,e.ONLY_MANAGER];return i.map(t,(function(e){return{value:e,label:this._getVoteVisibleQualificationLabel(e),selected:e===this.model.get("voteVisibleQualification")}}),this)},_getVoteVisibleQualificationLabel:function(e){switch(e){case l.POLL_VOTE_VISIBLE_QUALIFICATION.ALL:return IM("postwrite.form_poll.poll_status.label.view_always");case l.POLL_VOTE_VISIBLE_QUALIFICATION.ALL_AFTER_VOTE:return IM("postwrite.form_poll.poll_status.label.view_before_poll");case l.POLL_VOTE_VISIBLE_QUALIFICATION.ALL_AFTER_POLL_END:return IM("postwrite.form_poll.poll_status.label.view_before_poll_end");case l.POLL_VOTE_VISIBLE_QUALIFICATION.ONLY_MANAGER:return IM("post.vote_visible_qualification.only_manager.label");default:return""}}});return f.openLayer=function(e,t){var n=new f({bandNo:t,model:e});return h.openWithoutHiding(n),n},f}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s="bm-bind",a="bm-repeat",r="bm-value",l=/\|/g,c={extractModelJson:function(e,t){return h(e,t)},extractModelData:function(e,t){var n=this.extractModelJson(e,t.$el),i=t.model;return i?m(n,i):n},extractModelArray:function(e,t){return p(e,t.$el)}},d=function(e){var t=e.attr(r);return t||(e.is("input[type=checkbox]")?e.prop("checked"):!e.is("input[type=radio]")||e.is(":checked")?e.is("button")||e.is("span")||e.is("div")?e.text():e.is("img")?e.attr("src"):e.val():void 0)},u=function(e,t){return e.find("["+s+'^="'+t+'|"]').length>0},h=function(e,n){var o={},r=n.find("["+s+'^="'+e+'|"]'),l=n.find("["+a+'^="'+e+'|"]');if(i.each(r,(function(n){var a=t(n),r=i.last(a.attr(s).split("|")),l=e+"-"+r;if(u(a,l))o[r]=h(l,a);else{var c=d(a);void 0!==c&&(o[r]=c)}})),l.length>0){var c=i.uniq(i.map(l,(function(e){var n=t(e);return i.last(n.attr(a).split("|"))})));i.each(c,(function(t){var i=e+"|"+t;o[t]=p(i,n)}))}return o},p=function(e,n){var o=[],s=n.find("["+a+'^="'+e+'"]');return i.each(s,(function(n){var i=t(n),s=e.replace(l,"-");if(u(i,s))o.push(h(s,i));else{var a=d(i);void 0!==a&&o.push(a)}})),o},m=function(e,t){var n=t.attributes;for(var i in n){var s=n[i];s instanceof o.Model?(s.set(m(e[i],s),{silent:!0}),e[i]=s):s instanceof o.Collection&&(s.reset(e[i],{silent:!0,validate:!0}),e[i]=s)}return e};return c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(16),s=n(2177);function a(e){return e>=1990&&e<=2037}function r(e){return e>=1&&e<=12}function l(e){return e>=1&&e<=30}function c(e){return e>=0&&e<=23}var d=function(e,t,n,i,o){this._val={year:e,month:t,date:n,hour:i,minute:o}};d.prototype.set=function(e,t,n,i,o){this.year(e),this.month(t),this.date(n),this.hour(i),this.minute(o)},d.prototype._addOneYear=function(){this.year(this.year()+1)},d.prototype._addOneMonth=function(){var e=this.month()+1;r(e)?this.month(e):(this._addOneYear(),this.month(0))},d.prototype._addOneDate=function(){var e=this.date()+1;l(e)?this.date(e):(this._addOneMonth(),this.date(1))},d.prototype._addOneHour=function(){var e=this.hour()+1;c(e)?this.hour(e):(this._addOneDate(),this.hour(0))},d.prototype.addOneHour=d.prototype._addOneHour,t.each(["year","month","date","hour","minute"],(function(e){d.prototype[e]=function(n){if(!(t.isNumber(n)&&n>=0))return this._val[e];this._val[e]=n}}));var u=t.template("<%=year%>-<%=month%>-<%=day%>T<%=hour%>:<%=minute%>:00<%=zone%>");d.prototype.toISO=function(){return u({year:i.pad(this._val.year,4,"0"),month:i.pad(this._val.month+1,2,"0"),day:i.pad(this._val.date,2,"0"),hour:i.pad(this._val.hour,2,"0"),minute:i.pad(this._val.minute,2,"0"),zone:o().format("ZZ")})};var h=t.template("<%=year%>-<%=month%>-<%=day%>");d.prototype.toDateText=function(){return h({year:i.pad(this._val.year,4,"0"),month:i.pad(this._val.month+1,2,"0"),day:i.pad(this._val.date,2,"0"),hour:i.pad(this._val.hour,2,"0"),minute:i.pad(this._val.minute,2,"0"),zone:o().format("ZZ")})},d.prototype.toDateISOText=d.prototype.toDateText;var p=t.template("<%=ampm %> <%=h%>:<%=minute%>");d.prototype.toTimeText=function(){return p({year:i.pad(this._val.year,4,"0"),month:i.pad(this._val.month+1,2,"0"),day:i.pad(this._val.date,2,"0"),hour:i.pad(this._val.hour,2,"0"),ampm:this._val.hour<12?"오전":"오후",h:i.pad(12===this._val.hour?12:this._val.hour%12,2,"0"),minute:i.pad(this._val.minute,2,"0"),zone:o().format("ZZ")})};var m=t.template("<%=hour%>:<%=minute%>");d.prototype.toTimeISOText=function(){return m({year:i.pad(this._val.year,4,"0"),month:i.pad(this._val.month+1,2,"0"),day:i.pad(this._val.date,2,"0"),hour:i.pad(this._val.hour,2,"0"),ampm:this._val.hour<12?"오전":"오후",h:i.pad(12===this._val.hour?12:this._val.hour%12,2,"0"),minute:i.pad(this._val.minute,2,"0"),zone:o().format("ZZ")})},d.prototype.isSame=function(e){return e instanceof d&&(this.year()===e.year()&&this.month()===e.month()&&this.date()===e.date()&&this.hour()===e.hour()&&this.minute()===e.minute())},d.prototype.isSameDate=function(e){return e instanceof d&&(this.year()===e.year()&&this.month()===e.month()&&this.date()===e.date())},d.prototype._toCompareValue=function(){return this.minute()+60*this.hour()+60*this.date()*24+60*this.month()*24*30+60*this.year()*24*30*12},d.prototype.isBefore=function(e){return e instanceof d&&this._toCompareValue()<e._toCompareValue()},d.prototype.isBeforeDate=function(e){if(!(e instanceof d))return!1;var t=this.clone();t.hour(0),t.minute(0);var n=e.clone();return n.hour(0),n.minute(0),t._toCompareValue()<n._toCompareValue()},d.prototype.isSameOrBeforeDate=function(e){return e instanceof d&&(this.isSameDate(e)||this.isBeforeDate(e))},d.prototype.isSameOrAfterDate=function(e){return e instanceof d&&(this.isSameDate(e)||this.isAfterDate(e))},d.prototype.isAfter=function(e){return e instanceof d&&this._toCompareValue()>e._toCompareValue()},d.prototype.isAfterDate=function(e){if(!(e instanceof d))return!1;var t=this.clone();t.hour(0),t.minute(0);var n=e.clone();return n.hour(0),n.minute(0),t._toCompareValue()>n._toCompareValue()},d.prototype.clone=function(){return new d(this.year(),this.month(),this.date(),this.hour(),this.minute())};var _=[/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})\+(\d{1,4})$/,/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2})$/,/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2})$/];d.parseISO=function(e){var t=function(e){for(var t,n=null,i=0;(t=_[i++])&&!(n=t.exec(e)););return n}(e);if(!t)return null;var n=parseInt(t[1]);if(!a(n))return null;var i=parseInt(t[2]);if(!r(i))return null;var o=parseInt(t[3]);if(!l(o))return null;var s=parseInt(t[4]);if(!c(s))return null;var u=parseInt(t[5]);return function(e){return e>=0&&e<=59}(u)?new d(n,i-1,o,s,u):null};var g=/^(\d{4})[\/\.\-](\d{1,2})[\/\.\-](\d{2})$/;return d.parseDateText=function(e){var t=g.exec(e);if(!t)return null;var n=parseInt(t[1]);if(!a(n))return null;var i=parseInt(t[2]);if(!r(i))return null;var o=parseInt(t[3]);return l(o)?new d(n,i-1,o,0,0):null},d.fromMoment=function(e){var t=s.solarToLunar(e.format("YYYY-MM-DD"));return new d(parseInt(t.lunarYear),parseInt(t.lunarMonth)-1,parseInt(t.lunarDay),e.hour(),e.minute())},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(167),a=n(166),r=n(152),l=n(2181),c=n(2182),d=n(1618),u=n(486),h=n(197),p=n(2183),m=n(1115),_=n(16),g=n(491),f=n(906);n(185);var b=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorTodoAttachView"},template:i.template(l),templateContext:function(){return{todoImportHelpClosed:s.getCurrentUserEnvStorage().get([a.TodoImportHelpClosed])||!1,msg_titleMaxLength:r.TODO_TITLE_MAX_LENGTH,msg_checkableOnlyAuthorEnabled:this._bandData&&this._bandData.getBandCore().supportPostTodoCheckableOnlyByAuthor()}},ui:{todoTitle:"._todoTitle",todoSubjectTitle:"._todoSubjectTitle",todoTaskList:"._todoTaskList",titleWrap:"._titleWrap",btnAddTodoTask:"._btnAddTodoTask",scrollArea:"._scrollArea",btnClose:"._btnClose",btnComplete:"._btnComplete",endedAtCheckbox:"._endedAtCheckbox",additionalOptionsWrap:"._additionalOptionsWrap",endedAtInputRegion:"._endedAtInputRegion",btnImportPrevTodo:"._btnImportPrevTodo",popoverHelpImportTodo:"._popoverHelpImportTodo",btnCloseImportTodoHelpPopover:"._btnCloseImportTodoHelpPopover"},regions:{endedAtInputRegion:{el:"@ui.endedAtInputRegion",replaceElement:!0}},events:{"click @ui.btnAddTodoTask":"_addTaskAndScroll","focus @ui.todoTitle":function(){this.getUI("titleWrap").addClass("-focus")},"blur @ui.todoTitle":function(){this.getUI("titleWrap").removeClass("-focus")},"keyup @ui.todoSubjectTitle":function(e){var n=t(e.currentTarget);n.parent("li").is(":last-child")&&n.val().length>0&&this._addTaskAndScroll(),n.attr("value",n.val())},"click @ui.btnClose":"_cancel","click @ui.btnComplete":"_complete","change @ui.endedAtCheckbox":"_toggleEndedAtInputRegion","click @ui.btnImportPrevTodo":function(){"none"!==this.getUI("popoverHelpImportTodo").css("display")&&this._closeImportTodoHelpPopover();var e=p.openAsLayer(this.bandNo);this.listenTo(e,"select:item-import",i.bind((function(t){(!i.isEmpty(this.model.get("title"))||this.model.get("tasks").models.length>0||this.model.hasChanged())&&!confirm(IM("web.postwrite.form_attendance_check.prev_attendance_check_import_confirm"))||(e.destroy(),this.model.setImportJSON(t.model.toJSON()),this.render())}),this))},"click @ui.btnCloseImportTodoHelpPopover":"_closeImportTodoHelpPopover",input:"_updateValidStatus",change:"_updateValidStatus"},initialize:function(e){this.bandNo=e.bandNo,this._body=t("body"),g.getCachedBandData(this.bandNo).then(i.bind((function(e){this._bandData=e}),this))},layerOnEscKeyDown:function(){this._cancel()},onDomRefresh:function(){if(0===this.model.get("tasks").length)for(var e=0;e<4;e++)this._addTask();else this.model.get("tasks").each(i.bind((function(e){this._addTask(e.get("subject"),e.get("taskId"))}),this)),this._addTask();this.ui.btnComplete.toggleClass("-disabled",!this.model.isValid()),this.model.hasChanged()&&this.onAttach()},onAttach:function(){t.browser.msie&&t.browser.versionNumber<=8?this.ui.todoTaskList.sortable({items:"li",cursor:"move"}):this._sortable=h.create(this.ui.todoTaskList[0],{scrollSensitivity:100,handle:".dragBar",onEnd:i.bind((function(){this.$el.find("._todoTaskLabel").each((function(e,n){t(n).text(e+1)})),this._updateValidStatus()}),this),setData:null}),this.ui.todoTitle.focus(),this._toggleEndedAtInputRegion()},onBeforeDetach:function(){this._sortable&&this._sortable.destroy()},_closeImportTodoHelpPopover:function(){this.getUI("popoverHelpImportTodo").hide(),s.getCurrentUserEnvStorage().set([a.TodoImportHelpClosed],!0)},_syncModelData:function(){var e=d.extractModelData("postTodo",this);e.numberOfTasks=e.tasks.length,this.model.set(e)},_updateValidStatus:function(){this._syncModelData(),this.ui.btnComplete.toggleClass("-disabled",!this.model.isValid())},_addTask:function(e,t){"string"!=typeof e&&(e=void 0);var n=this.$el.find("._todoTaskList li").length;return n<r.TODO_TASK_LIMIT&&this.ui.todoTaskList.append(i.template(c)({index:n,subject:e,taskId:t,taskMaxLength:r.TODO_TASK_MAX_LENGTH})),n+1===r.TODO_TASK_LIMIT&&this.ui.btnAddTodoTask.hide(),!1},_addTaskAndScroll:function(){this._addTask(),this.ui.scrollArea.stop().animate({scrollTop:this.ui.todoTaskList.height()-this.ui.scrollArea.height()/2})},_cancel:function(){this.trigger(f.EVENT.CANCEL),this.destroy()},_complete:function(){this._syncModelData(),this._syncModelEndedAt()&&this.model.isValid()&&(this.trigger(f.EVENT.ATTACH,this.model),this.destroy())},_syncModelEndedAt:function(){var e=null;if(this.ui.endedAtCheckbox.prop("checked")){var t=this.getChildView("endedAtInputRegion").getDateTime();if(!this._isValidEndedAtInputValue(t))return!1;e=_(t.date+" "+t.time,t.dateFormat+" "+t.timeFormat).valueOf()}return this.model.set("endedAt",e),!0},_getEndedAtMinDate:function(){return _()},_getEndedAtMaxDate:function(){return _().add(90,"days")},_isValidEndedAtInputValue:function(e){var t=_(e.date+" "+e.time,e.dateFormat+" "+e.timeFormat);return t.isBefore(this._getEndedAtMinDate())?(alert(IM("postwrite.attach.poll.alert_invalid_ended_at")),!1):!t.isAfter(this._getEndedAtMaxDate())||(alert(IM("todo.set_ended_at.alert_maximum",{maximum:90})),!1)},_toggleEndedAtInputRegion:function(e){var t=this.getRegion("endedAtInputRegion");if(!this.ui.endedAtCheckbox.prop("checked"))return this.ui.additionalOptionsWrap.hide(),void t.empty();this.ui.additionalOptionsWrap.show(),t.show(m.buildSolarDateInputView({dateTime:this._getEndedAtInputInitValue(),canTextEdit:!1,timeMinutesInterval:30,datepickerDirection:m.DATEPICKER_DIRECTION.UP,timepickerDirection:m.TIMEPICKER_DIRECTION.UP,viewFormatLocalize:"short_noweekday",dateValidator:{isValid:i.bind(this._isValidEndedAtInputValue,this),getMinDate:i.bind(this._getEndedAtMinDate,this),getMaxDate:i.bind(this._getEndedAtMaxDate,this)}}))},_getEndedAtInputInitValue:function(){var e=this.model.get("endedAt");if(null!=e)return _(e);var t=_().add(1,"hours");return t.date()===_().date()&&(t=t.add(1,"days")),t}});return b.openLayer=function(e,t,n){var i=new b({bandNo:t,model:e,bandPostEdit:n});return u.openWithoutHiding(i),i},window.eegg1=!1,b}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return _.template(n(2218))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(486),s=n(545),a=n(570),r=n(666),l=n(2220),c=n(9),d=n(154),u=n(635),h=t.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DBandCalendarManageView"},template:i.template(l),ui:{calendarName:"._calendarName",calendarColor:"._calendarColor",btnCancel:"._btnCancel",btnConfirm:"._btnConfirm",refreshExternalCalendar:"._refreshCalendar",refreshedAt:"._refreshedAt"},events:{"keyup @ui.calendarName":"_adaptButtonStyle","click @ui.btnCancel":"destroy","click @ui.btnConfirm":"_manipulateCalendar","click @ui.refreshExternalCalendar":"_refreshExternalCalendar"},initialize:function(e){this.bandNo=e.bandNo,this.isCreateCalendar=e.isCreateCalendar,this.calendarType=e.calendarType,this.model=e.model,this.calendarId=this.model.get("calendarId")},serializeData:function(){var e=this.model.get("name")?this.model.get("name"):"",t=this.model.get("color");return this.model.get("isDefault")&&!this.model.get("color")&&(t=a.getCalendarColor()),{MAX_LENGTH_OF_CALENDAR_NAME:s.MAX_LENGTH_OF_CALENDAR_NAME,isCreateCalendar:this.isCreateCalendar,isDefault:this.model.get("isDefault"),calendarName:e,calendarUrl:this.model.get("url")?this.model.get("url"):"",calendarColor:t,supportColorList:s.CALENDAR_COLOR,refreshedAt:this._refreshedAtFormatDateToMonthDayTime()}},onRender:function(){null!==this.model.get("url")&&this._updateRefreshedAt(),this._adaptButtonStyle()},_manipulateCalendar:function(){this.model.get("calendarId")||this.model.get("isDefault")?this._updateCalendar():this._createCalendar()},_createCalendar:function(){var e={type:this.calendarType,name:this.getUI("calendarName").val(),color:this.getUI("calendarColor").filter(":checked").val()};return this.model.createCalendar(e).then(i.bind((function(e){this.trigger("bandCalendar:createCalendar",e),this.destroy()}),this))},_updateCalendar:function(){var e={name:this.getUI("calendarName").val(),color:this.getUI("calendarColor").filter(":checked").val()};return this.model.updateCalendar(e).then(i.bind((function(){this.destroy()}),this))},_adaptButtonStyle:function(){var e=this.getUI("calendarName").val();!i.isEmpty(e.trim())&&e.length>0?(this.getUI("btnConfirm").removeClass("-disabled"),this.getUI("btnConfirm").removeAttr("disabled")):(this.getUI("btnConfirm").addClass("-disabled"),this.getUI("btnConfirm").attr("disabled","true"))},_refreshExternalCalendar:function(){var e=IM("alert.calendar.external.sync");d.wrapActivePromise(u.refreshExternalCalendar(this.bandNo,this.model.get("calendarId")),this).then((function(){alert(e+" "+IM("alert.calendar.external.application_time"))}),i.bind((function(t){1001===t.result_code?alert(e+" "+IM("alert.calendar.external.completed_wait")):this.model.setStatusError()}),this))},_refreshedAtFormatDateToMonthDayTime:function(){var e=this.model.get("refreshedAt");return e?c.format.date(e,"month_day_time"):""},_updateRefreshedAt:function(){u.getCalendars(this.bandNo,s.TYPE.EXTERNAL).then(i.bind((function(e){var t=i.findWhere(e.external_calendars,{calendar_id:this.calendarId});if(this.model.set("refreshedAt",t.refreshed_at),t){var n=this._refreshedAtFormatDateToMonthDayTime();this.ui.refreshedAt.attr("datetime",n).text(n)}}),this))}});return h.openAsLayer=function(e,t){var n={bandNo:e,isCreateCalendar:t.isCreateCalendar};n.model=t.model?t.model:r.createNewCalendar(e),t&&t.type&&(n.type=t.type);var i=new h(n);return o.open(i),i},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(513),o=n(26);return{openGetGuardianAgreement:function(e){if(!e.birthdate)throw new Error("no birthdate param");o.getExternalProfileChannel().on(o.EXTERNAL_EVENT.PROFILE.GUARDIAN_AGREEMENT_COMPLETED,(function(t){o.getExternalProfileChannel().off(o.EXTERNAL_EVENT.PROFILE.GUARDIAN_AGREEMENT_COMPLETED),e.callback(t)})),i.openGet({windowURL:"https://"+window.passDomain+"/b/get_guardian_agreement",windowName:"band_get_guardian_agreement",centerBrowser:1,params:t.extend({type:e.type,birthdate:e.birthdate,callback:location.protocol+"//"+location.host+"/guardianAgreementResult"})})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(4),o=n(2251),s=i.CollectionView.extend({tagName:"ul",className:"listLine rScroll -lrSpace",attributes:{"data-viewname":"DMemberEntryCollectionView"},childView:o,childViewTriggers:{"entry:remove":"entry:remove"}});e.exports=s},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(4),o=n(0),s=n(549),a=n(570),r=n(1626),l=n(26),c={OPEN_SCHEDULE:"openSchedule"},d=r.SCHEDULE_TYPE,u=i.CollectionView.extend({tagName:"span",className:"scheduleItemWrap",attributes:{"data-viewname":"DBandCalendarScheduleEventListView"},childView:r,childViewOptions:function(){return{scheduleDate:this._scheduleDate,scheduleType:this._scheduleType}},childViewTriggers:{openSchedule:c.OPEN_SCHEDULE},initialize:function(e){this._scheduleDate=e.scheduleDate,this._scheduleType=e.scheduleType||d.CALENDAR_SCHEDULE_LIST_ITEM,this.listenTo(l.getDGlobalChannel(),l.EVENT.SCHEDULE_DELETED,(function(e){this.collection.remove(e.scheduleId)}))}});return u.Collection=t.Collection.extend({model:s}),u.build=function(e){var t=e.scheduleDate,n=e.scheduleEvents;return o.isArray(n)&&n.length>1&&t&&(n=a.adjustEventListOrder(n,t)),new u({collection:new u.Collection(n),scheduleDate:t,scheduleType:e.scheduleType})},u.EVENTS=c,u.SCHEDULE_TYPE=d,u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(653),s=n(82),a=n(156),r=n(526),l=n(511),c=n(2006),d=n(611),u=n(2260),h=n(849),p=n(26),m=n(833),_={FEED_UPCOMING_SCHEDULE:"FEED_UPCOMING_SCHEDULE",UPCOMING_LOCAL_MEETUP_SCHEDULE:"UPCOMING_LOCAL_MEETUP_SCHEDULE",CALENDAR_SCHEDULE_LIST_ITEM:"CALENDAR_SCHEDULE_LIST_ITEM"},g=t.View.extend({tagName:"a",className:"scheduleItem",attributes:{"data-viewname":"DBandCalendarScheduleEventItemView"},template:i.template(u),ui:{openScheduleWithScrollToFile:"._openScheduleWithScrollToFile",openScheduleImageViewer:"._openScheduleImageViewer",openScheduleWithScrollToComment:"._openScheduleWithScrollToComment"},events:{click:"_openScheduleDetailLayer","click @ui.openScheduleWithScrollToFile":"_openScheduleWithScrollToFile","click @ui.openScheduleImageViewer":"_openScheduleImageViewer","click @ui.openScheduleWithScrollToComment":"_openScheduleWithScrollToComment"},modelEvents:{change:"render"},initialize:function(e){this._scheduleDate=e.scheduleDate,this._scheduleType=e.scheduleType||_.CALENDAR_SCHEDULE_LIST_ITEM,this.bandNo=this.model.getBandNo(),this.listenTo(p.getDGlobalChannel(),p.EVENT.SCHEDULE_UPDATED,(function(e){e.bandNo==this.model.getBandNo()&&e.exScheduleId==this.model.getScheduleId()&&(this.model.setScheduleIdSilently(e.scheduleId),this.model.fetchSchedule())}))},serializeData:function(){var e,t=this.model.get("location");return t&&(e=t.get("name")||t.get("address")),{band:this._scheduleType===_.FEED_UPCOMING_SCHEDULE?this.model.get("band"):null,scheduleTime:this._getScheduleTimeText(),scheduleType:{isBirthday:this.model.get("scheduleType")==r.BIRTHDAY,isBandOpen:this.model.get("scheduleType")==r.BAND_OPEN,isNormal:this.model.get("scheduleType")==r.NORMAL,isHoliday:this.model.get("scheduleType")==r.HOLIDAY,isExternal:this.model.get("scheduleType")==r.EXTERNAL},isNewSchedule:this.model.get("isNew"),scheduleName:this.model.get("name"),mapName:e,rsvpInfo:this._getRsvpInfo(),calendarInfo:this._getCalendarInfo(),fileInfo:this._getFileInfo(),photoInfo:this._getPhotoInfo(),ownerName:this.model.get("owner")?this.model.get("owner").get("name"):"",commentCount:this.model.get("commentCount"),isSecret:this.model.isSecret()}},_getScheduleTimeText:function(){return this._scheduleType===_.FEED_UPCOMING_SCHEDULE||this._scheduleType===_.UPCOMING_LOCAL_MEETUP_SCHEDULE?o.upcomingMessage(this.model.get("startAt"),this.model.get("endAt"),this.model.isAllDay()):this._scheduleDate?o.makeScheduleTimeOfDailyMessage(this.model.toJSON(),this._scheduleDate):o.formatScheduleTime(this.model)},_getRsvpInfo:function(){var e=this.model.get("rsvp");return i.isEmpty(e)?null:{isAttendanceStatus:e.get("viewerRsvpState")==l.ATTENDANCE,isPendingAttendanceStatus:e.get("viewerRsvpState")==l.PENDING_ATTENDANCE,isAbsenceStatus:e.get("viewerRsvpState")==l.ABSENCE,isMaybeStatus:e.get("viewerRsvpState")==l.MAYBE,attendeeCount:e.get("attendeeCount"),absenteeCount:e.get("absenteeCount"),maybeCount:e.get("maybeCount"),pendingAttendeeCount:e.get("pendingAttendeeCount"),isMaybeEnabled:e.isMaybeEnabled(),hasCustomState:e.hasCustomRsvpStatus(),isCustomStatus:e.get("viewerRsvpState")==l.CUSTOM,customCount:e.getRsvpCustomTotalCount()}},_getCalendarInfo:function(){var e=this.model.get("calendar");return i.isEmpty(e)?null:{name:e.get("name"),color:e.get("color"),serviceProvider:e.get("serviceProvider")?e.get("serviceProvider"):""}},_getFileInfo:function(){var e=this.model.getFiles();return e.isEmpty()?null:{fileCount:e.length,hasExpiredFile:this._hasExpiredFile(e)}},_hasExpiredFile:function(e){return e.find((function(e){return a.isExpiredFile(e.getExpiresAt())}))},_getPhotoInfo:function(){var e=this.model.get("photos"),t="";if(!i.isEmpty(e)&&e.length>0){var n=e.at(0).get("url");return t=s.makeSmallCoverUrl(n),{photoCount:e.length,thumbnailUrl:t}}return null},_openScheduleDetailLayer:function(e){e.preventDefault(),e.stopPropagation(),this.trigger("openSchedule",{scheduleId:this.model.get("scheduleId")})},_openScheduleWithScrollToFile:function(e){e.preventDefault(),e.stopPropagation(),this.trigger("openSchedule",{scheduleId:this.model.get("scheduleId"),scrollTo:h.FILE})},_openScheduleWithScrollToComment:function(){return this.trigger("openSchedule",{scheduleId:this.model.get("scheduleId"),scrollTo:h.COMMENT}),!1},_openScheduleImageViewer:function(e){e.preventDefault(),e.stopPropagation();var t=this.model.get("photos").toJSON(),n=c.convertPhotosForImageViewer(t,this.model.getOwner().toJSON());d.openDPhotoVideoImageViewer({result_data:n,bandNo:this.model.get("bandNo"),openIndex:0,goPostSupport:!1,profileViewSupport:!1,moreOptionList:[m.MEDIA_MORE_OPTION.REPORT,m.MEDIA_MORE_OPTION.SAVE_TO_ALBUM],schedulePhotoReportBaseOptions:{bandNo:this.model.getBandNo(),owner:this.model.get("owner"),recurrence:this.model.get("recurrence"),scheduleId:this.model.get("scheduleId")}})}});return g.SCHEDULE_TYPE=_,g}.call(t,n,t,e))||(e.exports=i)},function(e,t){},function(e,t){},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(6),o=n(0),s=n(493),a=n(486),r=n(2278),l=n(2279),c=n(52),d=n(555),u=t.View.extend({tagName:"section",attributes:{"data-viewname":"DBandChildMemberListView"},className:"lyWrap layer_wrap",ui:{formChildMemberAdd:"._formChildMemberAdd",childMemberNameInput:"._childMemberNameInput",btnAddChildMember:"._btnAddChildMember",descriptionForEmpty:"._descriptionForEmpty",childMemberListRegionWrap:"._childMemberListRegionWrap",selectChildMemberCount:"._selectChildMemberCount",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},events:{"click @ui.btnAddChildMember":"_addChildMember","submit @ui.formChildMemberAdd":function(){return!1},"keyup @ui.childMemberNameInput":"_updateBtnAddChildMember","click @ui.cancelBtn":function(){a.closeTop()},"click @ui.confirmBtn":"_confirmSelectChildMemberList"},regions:{childMemberListRegionWrap:{replaceElement:!1,el:"@ui.childMemberListRegionWrap"}},template:o.template(r),templateContext:function(){return{nameMaxCount:30}},initialize:function(e){this._bandNo=e.bandNo,this._selectChildMemberList=[],this._unselectableChildMembers=e.unselectableChildMembers,this._isAddingNow=!1},onAttach:function(){s.getChildMemberList(this._bandNo).then(o.bind((function(e){if(!this.isDestroyed()){var t=o.each(c.camelizeKeys(e),o.bind((function(e){if(o.contains(this._unselectableChildMembers,e.childMembershipId))return e.isDisabled=!0;e.isDisabled=!1}),this));this._childMemberCollection=new p(t),this._childMemberCollectionView=new m({collection:this._childMemberCollection}),this._attachChildMemberBody(),this.listenTo(this._childMemberCollectionView,"childMemberCollectionView:selectMember",o.bind((function(e){this._setSelectChildMemberList(e)}),this)),this.listenTo(this._childMemberCollectionView,"childMemberCollectionView:deleteMember",o.bind((function(e){this._deleteChildMember(e)}),this))}}),this))},_attachChildMemberBody:function(){this._childMemberCollection.isEmpty()?(this.getUI("descriptionForEmpty").show(),this.getUI("childMemberListRegionWrap").hide()):(this.getUI("descriptionForEmpty").hide(),this.getUI("childMemberListRegionWrap").show(),this.showChildView("childMemberListRegionWrap",this._childMemberCollectionView))},_setSelectChildMemberList:function(e){var t=[];e.getIsSelected()?this._selectChildMemberList.push({childMembershipId:e.get("childMembershipId"),name:e.get("name")}):(t=o.filter(this._selectChildMemberList,(function(t){return e.get("childMembershipId")!=t.childMembershipId})),this._selectChildMemberList=t),this._setChildMemberViewConfirmBtn()},_updateBtnAddChildMember:function(e){if(e.keyCode==d.ENTER){if(this._isAddingNow)return;e.preventDefault(),this._addChildMember()}var t=this.getUI("childMemberNameInput").val(),n=this.getUI("btnAddChildMember");o.isEmpty(t)?n.removeClass("-active").addClass("-disabled").attr("disabled",!0):n.removeClass("-disabled").addClass("-active").attr("disabled",!1)},_addChildMember:function(){var e=this.getUI("childMemberNameInput").val().trim();""!==e?e.length>30?alert(IM("child_member.over.limit",{count:30})):(this._isAddingNow=!0,s.addChildMember(this._bandNo,e).then(o.bind((function(t){var n=new h(o.extend(c.camelizeKeys(t),{name:e,isSelected:!0}));this._childMemberCollection.add(n),this._setSelectChildMemberList(n),this._attachChildMemberBody(),this._isAddingNow=!1,this.getUI("childMemberNameInput").val(""),this.getUI("btnAddChildMember").removeClass("-active").addClass("-disabled").attr("disabled",!0)}),this),o.bind((function(){this._isAddingNow=!1}),this))):alert(IM("schedule.view.rsvp.add_child_member.alert.input_name"))},_deleteChildMember:function(e){s.deleteChildMember(this._bandNo,e.get("childMembershipId")).then(o.bind((function(){this._childMemberCollection.remove(e),this._selectChildMemberList=o.filter(this._selectChildMemberList,(function(t){return e.get("childMembershipId")!=t.childMembershipId})),this._attachChildMemberBody(),this._setChildMemberViewConfirmBtn()}),this))},_setChildMemberViewConfirmBtn:function(){0==this._selectChildMemberList.length?(this.getUI("confirmBtn").addClass("-disabled").attr("disabled",!0),this.getUI("selectChildMemberCount").text("")):(this.getUI("confirmBtn").removeClass("-disabled").attr("disabled",!1),this.getUI("selectChildMemberCount").text("("+this._selectChildMemberList.length+")"))},_confirmSelectChildMemberList:function(){o.isEmpty(this._selectChildMemberList)?a.closeTop():this.trigger("confirm:addChildMembers",this._selectChildMemberList)}}),h=i.Model.extend({defaults:function(){return{name:"",isDisabled:!1,isSelected:!1}},getIsSelected:function(){return this.get("isSelected")},setIsSelected:function(e){return this.set("isSelected",e)}}),p=i.Collection.extend({model:h,initialize:function(e){this.reset(e)},comparator:function(e){return-e.get("childMembershipId")}}),m=t.CollectionView.extend({tagName:"ul",className:"listLine",attributes:{"data-viewname":"DBandChildMemberCollectionView"},childView:l,childViewEvents:{"childMemberItemView:selectMember":function(e){this.trigger("childMemberCollectionView:selectMember",e)},"childMemberItemView:deleteMember":function(e){this.trigger("childMemberCollectionView:deleteMember",e)}}});return u.buildChildMemberListView=function(e){return new u({bandNo:e.bandNo,unselectableChildMembers:e.unselectableChildMembers})},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2314),s=n(152),a=n(2012),r=n(800),l=n(26),c=n(156),d=[s.POST_ATTACHMENT_TYPE.FILE,s.POST_ATTACHMENT_TYPE.DROPBOX_FILE,s.POST_ATTACHMENT_TYPE.EXTERNAL_FILE];return i.View.extend({attributes:{"data-viewname":"FileWidgetView"},template:t.template(o),templateContext:function(){var e=IM("file");return"dropbox"==this.fileType&&(e="Dropbox"),"one_drive"==this.fileType&&(e="OneDrive"),{outputFileType:e,folderBtn:this._isMovable()}},initialize:function(e){this.fileType=e.model.get("type"),this._postModel=e.postModel,this._bandNo=this._postModel.getBandCore().bandNo,this._postNo=this._postModel.getPostNo(),this.listenTo(l.getBandChannel(this._bandNo),l.EVENT.POST_FILE_WIDGET_CHANGED,(function(e){this._postNo===e&&this.$el.attr("data-model",encodeURIComponent(JSON.stringify(this.model.toJSON())))}))},ui:{folderBtn:"._folderBtn",btnDelete:"._btnDelete"},events:{"click @ui.folderBtn":"_openFolderSelectLayer"},triggers:{"click @ui.btnDelete":"remove"},_isMovable:function(){return!c.isExpiredFile(this.model.get("expiresAt"))},_openFolderSelectLayer:function(){var e=a.openFolderSelectLayer({bandNo:this._bandNo,folderId:this.model.get("folderId")});this.listenToOnce(e,"confirm",(function(e){var t=e.folderId;this._postModel.getFileCount()>1?this._openChangeOptionLayer(t):(this._setFolderIdToModel(this.model,t),this._triggerWidgetChanged())}))},_triggerWidgetChanged:function(){l.getBandChannel(this._bandNo).trigger(l.EVENT.POST_FILE_WIDGET_CHANGED,this._postModel.getPostNo())},_openChangeOptionLayer:function(e){var n=r.openAsLayer({title:IM("post.folder_option_title"),cancel:IM("ui.label.cancel"),confirm:IM("ui.label.confirm"),radioItems:[{label:IM("post.folder_option_this_file"),value:"this_file"},{label:IM("post.folder_option_all_files"),value:"all_files"}],initialCheckedValue:"this_file",withoutHiding:!0});this.listenToOnce(n,"modal:confirm",(function(n){switch(n){case"all_files":t.each(d,(function(t){this._setFolderIdToTypeModels(t,e)}),this);break;default:this._setFolderIdToModel(this.model,e)}this._triggerWidgetChanged()}))},_setFolderIdToTypeModels:function(e,n){var i=this._postModel.getAttachment(e)||{},o=t.values(i.attributes);t.each(o,(function(e){this._setFolderIdToModel(e,n)}),this)},_setFolderIdToModel:function(e,t){e.set("folderId",t)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(4),o=n(2316),s=i.CollectionView.extend({tagName:"ul",className:"cFolder",attributes:{"data-viewname":"DBandFolderListView"},reorderOnSort:!0,childView:o,childViewOptions:function(e){return{bandData:this._bandData,checkable:this._checkable,checked:this._folderId===e.getFolderId()}},childViewEvents:{"folder:checked":function(e){this._folderId=e.checked?e.folder.getFolderId():null,this.trigger("folder:checked",e)}},initialize:function(e){this._bandData=e.bandData,this._checkable=!0===e.checkable,this._folderId=e.folderId||null}});s.buildFolderListView=function(e){return new s(e)},e.exports=s},function(e,t,n){var i=n(0),o=n(4),s=n(2352),a=n(82),r=n(1012);n(502);var l=o.View.extend({EVENT:{DELETE:"DELETE"},tagName:"div",className:"photoBox",attributes:{"data-viewname":"DQuizQuestionImageEditView"},template:i.template(s),ui:{thumbImg:"._thumbImg",deleteBtn:"._deleteBtn"},events:{"click @ui.deleteBtn":function(){this.trigger(this.EVENT.DELETE)}},initialize:function(e){this._image=e.image,this._video=e.video,this._deletable=e.deletable},serializeData:function(){var e=this._video?this._video.url:this._image.url;return{imgUrl:a.make(e,a.TYPE.s150),playIcon:!!this._video&&!this._video.isGif,deleteBtn:this._deletable}},onDomRefresh:function(){this._setLoading()},_setLoading:function(){this.ui.thumbImg.setLoading({tag:r.html(r.Size.SMALL,r.MiddleClass.AREA_VERTICAL_MIDDLE),timeout:2e3})}});l.build=function(e){return new l(e)},e.exports=l},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2382),s=n(1259),a=n(1402),r=n(82),l={NAME:"QUESTION-IMAGE",CHANGE:"CHANGE"},c=i.View.extend({tagName:"div",attributes:{"data-viewname":"DEditorSurveyQuestionImageView"},template:t.template(o),ui:{imageDelBtn:"._imageDelBtn",imageFile:"._imageFile"},events:{"click @ui.imageDelBtn":function(){this._survey.isRespondedMemberExist()?s.alertRespondedMemberExist():this._setImage(null)},"click @ui.imageFile":function(e){this._survey.isRespondedMemberExist()&&(e.preventDefault(),s.alertRespondedMemberExist())}},initialize:function(e){this._image=e.image,this._deletable=e.deletable,this._uploadable=e.uploadable,this._survey=e.survey},serializeData:function(){var e=!!this._image;return{imageUrl:e?r.make(this._image.url,r.TYPE.s150):null,imgDelBtn:e&&this._deletable,imgFile:!e&&this._uploadable}},onBeforeRender:function(){this._destroyUploader()},onRender:function(){this.$el.toggleClass("btnUploadWrap",!this._image),this.$el.toggleClass("photoBox",!!this._image),this._createUploader()},onBeforeDetach:function(){this._destroyUploader()},_createUploader:function(){this._survey.isRespondedMemberExist()||!this._image&&this._uploadable&&(this._uploader=a.createUploader({element:this.ui.imageFile}),this.listenTo(this._uploader,"complete",(function(e){this._setImage(e[0])})))},_destroyUploader:function(){this._uploader&&this._createUploader()},_setImage:function(e){this._image=e,this._triggerImageEvent(l.CHANGE,this._image)},_triggerImageEvent:function(e,t){this.trigger(l.NAME,e,t)}});return c.IMAGE_EVENT=l,c.build=function(e){return new c(e)},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){var e=n(165),t=n(43),i=n(9);return{makeDateTimeHtmlForReservePostList:function(t,n,o,s){var a=i.format.dateByTimezone(t,n,e.getCurrentTimezoneId());return a+=" "+s,this._isNoneOrSameGmtWithCurrent(o)?a:(a+="<br />",a+=this.makeDateTimeText(t,n,o))},makeDateTimeText:function(t,n,o){var s=e.getCurrentTimezoneId(),a=o||s,r=i.format.dateByTimezone(t,n,a);return this._isNoneOrSameGmtWithCurrent(o)||(r+=" ("+e.getTimezone(a).gmtString+")"),r},_isNoneOrSameGmtWithCurrent:function(n){return null==n||t().tz(e.getCurrentTimezoneId()).format("Z")==t().tz(n).format("Z")}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(4),s=n(600),a=n(507),r=n(177),l=n(537),c=n(2403),d=o.Object.extend({EVENT:{COMPLETE:"COMPLETE",FOLDER_CREATED:"FOLDER_CREATED"},initialize:function(e){this._bandData=e.bandData,this._element=e.element,this._inputTitle=e.inputTitle,this._fileCount=e.fileCount||i.constant(0),this._countLimit=e.countLimit||r.FILE.COUNT_LIMIT,this._inputClick=e.inputClick,this._uploadOnly=!0===e.uploadOnly,this._folder=e.folder,this._createUploader()},onBeforeDestroy:function(){this._destroyUploader()},_destroyUploader:function(){this._uploader&&(this._uploader.destroy(),this._uploader=null)},_createUploader:function(){this._destroyUploader(),this._uploader=s.createFileUploader(this._element,{fileInputTitle:this._inputTitle,skinColor:this._bandData.getBandCore().getSkinColorClass()}),this.listenTo(this._uploader,a.BEFORE_VALIDATE,(function(){this._uploader.setValidators([i.partial(l.FILE_VALIDATOR,i,this._fileCount(),this._countLimit)])})),this.listenTo(this._uploader,a.UPLOAD_COMPLETE,this._handleUploadComplete),this._inputClick&&this.listenTo(this._uploader,a.INPUT_CLICK,(function(){this._inputClick()}))},_handleUploadComplete:function(e){var t=i.map(e.resultList,(function(e){return{id:e.id,file_name:e.name,file_size:e.file_size}}));this._uploadOnly?this._triggerComplete({files:t}):this._openFileUploadLayer(t)},_openFileUploadLayer:function(e){var t=c.openLayer({bandData:this._bandData,files:e,folder:this._folder,fileCount:this._fileCount,countLimit:this._countLimit});this.listenTo(t,t.EVENT.CONFIRM,this._triggerComplete),this.listenTo(t,t.EVENT.FOLDER_CREATED,(function(e){this.trigger(this.EVENT.FOLDER_CREATED,e)}))},_triggerComplete:function(e){this.trigger(this.EVENT.COMPLETE,e)}});d.createBandFileUploader=function(e){return new d(e)},e.exports=d},function(e,t,n){var i=n(0),o=["photo","sticker","video","live","poll","file","schedule","todo","signup","attendance","quiz","survey","location","billsplit","markdown"],s=function(e){this._allToolbars={photo:!0,sticker:!0,video:!0,live:e.canCreateLive(),poll:!0,file:!0,schedule:e.canCreateSchedule(),todo:!0,signup:!0,attendance:e.getBandCore().supportPostAttendanceCheck(),quiz:e.canCreateQuiz(),survey:e.canCreateSurvey(),location:e.canAttachLocation(),billsplit:e.canUsePostBillSplit(),markdown:!0}};s.prototype.splitWithMainAndMore=function(){var e=i.filter(o,(function(e){return this._allToolbars[e]}),this);return e.length<=13?[e,[]]:i.chunk(e,12)},s.prototype.getMainToolbar=function(){var e=this.splitWithMainAndMore();return i.object(e[0],i.chain(e[0].length).range().map(i.constant(!0)).value())},s.prototype.getMore=function(){var e=this.splitWithMainAndMore();return i.object(e[1],i.chain(e[1].length).range().map(i.constant(!0)).value())},s.prototype.needShowMore=function(){return this.splitWithMainAndMore()[1].length>0},e.exports=s},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2443),s=n(486),a=n(43),r=n(165),l=n(1146),c=n(1115),d=n(9),u="off",h="notice",p="major_notice",m=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DNoticeSettingView"},template:t.template(o),templateContext:function(){return{msg_hasLinkedBand:this._hasLinkedBand,msg_isLinkedBandNotice:this._post.isLinkedBandNotice,msg_isMajorNotice:this._post.isMajorNotice,msg_isNotice:this._post.isNotice,msg_unsetAt:this._post.unset_at}},ui:{cancelBtn:".-cancel",confirmBtn:".-confirm",checkNotice:"._checkNotice",noticeSettingWrap:"._noticeSettingWrap",checkMajorNotice:"._checkMajorNotice",checkLinkedBandNotice:"._checkLinkedBandNotice",checkNoticeUnset:"._checkNoticeUnset",noticeEndItemWrap:"._noticeEndItemWrap",noticeEndDataWrap:"._noticeEndDataWrap",noticeUnSetTextSpan:"._noticeUnSetTextSpan",noticeGmtText:"._noticeGmtText",noticeDateInputRegion:"._noticeDateInputRegion",noticeTimezoneRegion:"._noticeTimezoneRegion",noticeNewsDescription:"._noticeNewsDescription"},regions:{noticeDateInputRegion:{el:"@ui.noticeDateInputRegion",replaceElement:!0},noticeTimezoneRegion:{el:"@ui.noticeTimezoneRegion",replaceElement:!0}},events:{"click @ui.checkNotice":"_toggleNoticeSettingWrap","click @ui.cancelBtn":"destroy","click @ui.confirmBtn":function(){this._noticeState=u,this.ui.checkNotice.is(":checked")&&this.ui.checkMajorNotice.is(":checked")?this._noticeState=p:this.ui.checkNotice.is(":checked")&&(this._noticeState=h),this._setLinkedBandNotice(),this.ui.checkNoticeUnset.is(":checked")?this._unsetAt=this._unsetAt.valueOf():this._unsetAt=null,this._noticeState!=u||this._originNoticeState.isNotice?(this.trigger("modal:confirm",{bandNo:this._bandNo,postNo:this._post.postNo,noticeState:this._noticeState,isLinkedBandNotice:this._isLinkedBandNotice,alertMessage:t.bind((function(){var e=!this._post.unset_at&&this.ui.checkNoticeUnset.is(":checked"),t=this._post.isMajorNotice===this.ui.checkMajorNotice.is(":checked"),n=this._post.isNotice&&this.ui.checkNotice.is(":checked");return e&&t&&n?IM("notice.setting.on.notice_end"):this._noticeState==u?IM("page.notice.setting.off.notice"):this._originNoticeState.isMajorNotice&&this._noticeState==h?IM("page.notice.setting.off.majorNotice"):this._noticeState==p?IM("page.notice.setting.on.majorNotice"):this._noticeState==h?IM("page.notice.setting.on.notice"):void 0}),this)(),unsetAt:this._unsetAt,timezoneId:this._timezoneId}),this.destroy()):this.destroy()},"click @ui.checkNoticeUnset":function(){this.ui.checkNoticeUnset.is(":checked")?this._openNoticeDateInputRegion():this._closeNoticeDateInputRegion()},"click @ui.noticeGmtText":"_showNoticeTimezoneSettingArea"},initialize:function(e){this._post=e.post,this._bandNo=e.bandNo,this._noticeState=this._isLinkedBandNotice=null,this._hasLinkedBand=e.hasLinkedBand,this._unsetAt=this._post.unset_at?a(this._post.unset_at):this._getMinimumTime(),this._timezoneId=this._post.time_zone_id||r.getCurrentTimezoneId()},onAttach:function(){this._originNoticeState={isNotice:this._post.isNotice,isMajorNotice:this._post.isMajorNotice,isLinkedBandNotice:this._post.isLinkedBandNotice},this.ui.noticeNewsDescription.toggle(this.ui.checkNotice.is(":checked")),this._post.isNotice||this.ui.noticeSettingWrap.hide(),this.ui.noticeSettingWrap.toggle(this._post.isNotice),this._post.isNotice&&this._post.unset_at?this._openNoticeDateInputRegion():this._closeNoticeDateInputRegion()},_setLinkedBandNotice:function(){this._isLinkedBandNotice=this.ui.checkLinkedBandNotice.is(":checked"),this._originNoticeState.isLinkedBandNotice==this.ui.checkLinkedBandNotice.is(":checked")&&(this._isLinkedBandNotice=null),this._noticeState==u&&(this._isLinkedBandNotice=!1)},_toggleNoticeSettingWrap:function(){var e=this.ui.checkNotice.is(":checked");e?(this._noticeState=h,this.ui.noticeSettingWrap.slideDown(),this.ui.noticeEndItemWrap.show()):(this.ui.noticeSettingWrap.slideUp(),this._noticeState=u,this.ui.noticeEndItemWrap.hide()),this.ui.noticeNewsDescription.toggle(e)},_getMinimumTime:function(){var e=a().add(30,"m").startOf("minute");return e.add(10-e.minute()%10,"m").second(0)},_renderNoticeUnsetAtUI:function(){var e=this.ui.checkNoticeUnset.is(":checked");e&&(this.ui.noticeUnSetTextSpan.text(d.format.dateByTimezone(this._unsetAt,"date_time",this._timezoneId)),this.ui.noticeUnSetTextSpan.css({display:"block"})),this.ui.noticeUnSetTextSpan.toggle(e)},_renderNoticeGmtText:function(){var e=this.getUI("checkNoticeUnset").is(":checked");e&&(this.getUI("noticeGmtText").text(r.getTimezone(this._timezoneId).gmtString),this.getUI("noticeGmtText").css("display","block")),this.getUI("noticeGmtText").toggle(e)},_showNoticeTimezoneSettingArea:function(){if(this.getRegion("noticeTimezoneRegion").hasView())this.getRegion("noticeTimezoneRegion").empty();else{var e=new l({timezoneId:this._timezoneId,isShowTimezoneTitle:!1});this.getRegion("noticeTimezoneRegion").show(e),this.listenTo(e,l.EVENT.TIMEZONE_CHANGED,(function(e){this._timezoneId=e;var t=this._getNoticeAtMinDate();this._unsetAt.isBefore(t)&&(this._unsetAt=t);var n=this._getNoticeAtMaxDate();this._unsetAt.isAfter(n)&&(this._unsetAt=n);var i=a.tz(this._unsetAt,this._timezoneId),o=i.format("YYYY-MM-DD"),s=i.format("HH:mm");this._noticeDateTimePickerView.setDateTime(o,s),this._renderNoticeUnsetAtUI(),this._renderNoticeGmtText()}))}},_openNoticeDateInputRegion:function(){var e=this.getRegion("noticeDateInputRegion");e&&e.hasView()||(this._noticeDateTimePickerView=c.buildSolarDateInputView({dateTime:this._unsetAt,timezoneId:this._timezoneId,canTextEdit:!0,timeMinutesInterval:5,datepickerDirection:c.DATEPICKER_DIRECTION.DOWN,timepickerDirection:c.TIMEPICKER_DIRECTION.DOWN,dateValidator:{isValid:t.bind(this._isValidNoticeDateTime,this),getMinDate:t.bind(this._getNoticeAtMinDate,this),getMaxDate:t.bind(this._getNoticeAtMaxDate,this)}}),this.listenTo(this._noticeDateTimePickerView,"dateTimeChanged",(function(e){this._noticeDateTimePickerView.isDestroyed()||(this._unsetAt=a.tz(e.date+" "+e.time,e.dateFormat+" "+e.timeFormat,this._timezoneId),this._renderNoticeUnsetAtUI())})),this.ui.noticeEndDataWrap.show(),e.show(this._noticeDateTimePickerView),this._renderNoticeUnsetAtUI(),this._renderNoticeGmtText(),this._timezoneId!=r.getCurrentTimezoneId()&&this._showNoticeTimezoneSettingArea())},_closeNoticeDateInputRegion:function(){var e=this.getRegion("noticeDateInputRegion");this.ui.noticeEndDataWrap.hide(),e&&e.hasView()&&e.empty(),this._renderNoticeUnsetAtUI(),this._renderNoticeGmtText(),this.getUI("noticeTimezoneRegion").hide(),this.getRegion("noticeTimezoneRegion")&&this.getRegion("noticeTimezoneRegion").hasView()&&this.getRegion("noticeTimezoneRegion").empty()},_getNoticeAtMinDate:function(){return a.tz(this._getMinimumTime(),this._timezoneId)},_getNoticeAtMaxDate:function(){return a().tz(this._timezoneId).add(59,"days").endOf("day")},_isValidNoticeDateTime:function(e){var t=a.tz(e.date+" "+e.time,e.dateFormat+" "+e.timeFormat,this._timezoneId);return!t.isBefore(this._getNoticeAtMinDate())&&!t.isAfter(this._getNoticeAtMaxDate())||(alert(IM("postwrite.attach.poll.alert_invalid_ended_at")),!1)}});return m.openAsLayer=function(e){var t=new m({post:e.post,hasLinkedBand:e.hasLinkedBand,bandNo:e.bandNo});return s.openWithoutHiding(t),t},m}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21);return{_getApiClient:function(){return this.apiClient||(this.apiClient=t.getLoginV1Client()),this.apiClient},getPageStatsSummary:function(e){var t={band_no:e};return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/page_stats/page_stats_summary",data:t,method:"GET"})},getPageStatsDaily:function(e,t,n){var i={band_no:e,from:t,to:n};return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/page_stats/page_stats_daily",data:i,method:"GET"})},getPageDayStats:function(e){var t={band_no:e};return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/page_stats/page_day_stats",data:t,method:"GET"})},getPageDemographics:function(e){var t={band_no:e};return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/page_stats/page_demographics",data:t,method:"GET"})},getPagePostStatsSummary:function(e,t){var n={band_no:e,post_no:t};return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/page_stats/page_post_stats_summary",data:n,method:"GET"})},getPagePostStatsDaily:function(e,t,n,i){var o={band_no:e,post_no:t,from:n,to:i};return this._getApiClient().sendAndThenProcess({url:"https://api.band.us/v2.0.0/page_stats/page_post_stats_daily",data:o,method:"GET"})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(4),a=n(931),r=n(486),l=n(493),c=n(9),d=n(174),u=n(2452),h=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DVirtualMemberAddOrModifyView"},template:i.template(u),templateContext:function(){return{countryCodeList:this.countryCodeList,regionCode:this.regionCode,phoneNumber:this.phoneNumber,email:this.email||""}},ui:{inputName:"._inputName",inputEmail:"._inputEmail",inputCellphone:"._inputCellphone",inputErrorEmail:"._inputErrorEmail",inputErrorCellphone:"._inputErrorCellphone",selectCountryCode:"._selectCountryCode",btnConfirm:"._btnConfirm",btnDelete:"._btnDelete",btnCancel:"._btnCancel"},events:{"keyup @ui.inputName":"_setButtonStyle","keyup @ui.inputEmail":"_setButtonStyle","keyup @ui.inputCellphone":"_setButtonStyle","change @ui.inputEmail":function(){this._validateFormData(),this._setButtonStyle()},"change @ui.inputCellphone":function(){this._validateFormData(),this._setButtonStyle()},"change @ui.selectCountryCode":"_setButtonStyle","click @ui.btnConfirm":"_registrationVirtualMember","click @ui.btnDelete":"_deleteVirtualMember","click @ui.btnCancel":"_layerClose"},initialize:function(e){if(this.bandNo=e.bandNo,this.virtualMemberId=this.model.get("virtual_member_id"),this.email=this.model.get("email")||"",this.virtualMemberId){var t=d.getPhoneNumberInfoFromFullNumber(this.model.get("cellphone"));this.phoneNumber=t.nationalNumber,this.regionCode=t.regionCode}else this.regionCode="",this.phoneNumber="";this.countryCodeList=c.getSortedNationInfoList()},_layerClose:function(){this.destroy()},_setButtonStyle:function(){var e=this.ui.inputName.val(),n=this.ui.inputEmail.val(),i=this.ui.selectCountryCode.val(),o=t.trim(this.ui.inputCellphone.val()),s=d.getPhoneNumberInfoFromLocalNumber(o,i),r=!0,l=!1;e||(r=!1),e!=this.model.get("name")&&(l=!0),a.EMAIL.validateEmail(n)===a.EMAIL.RESULT.WRONG_FORM&&(r=!1),o&&(s.isValidNumber||(r=!1)),n||o||(r=!1),n===this.email&&s.nationalNumber===this.phoneNumber||(l=!0),r&&l?this.ui.btnConfirm.removeClass("-disabled").prop("disabled",!1):this.ui.btnConfirm.addClass("-disabled").prop("disabled",!0)},_validateFormData:function(){var e=this.ui.inputEmail.val(),n=this.ui.selectCountryCode.val(),i=t.trim(this.ui.inputCellphone.val());(this.ui.inputErrorEmail.hide(),a.EMAIL.validateEmail(e)==a.EMAIL.RESULT.WRONG_FORM&&this.ui.inputErrorEmail.show(),this.ui.inputErrorCellphone.hide(),""!=i)&&(d.getPhoneNumberInfoFromLocalNumber(i,n).isValidNumber||this.ui.inputErrorCellphone.show())},_registrationVirtualMember:function(){var e,n,o=this.ui.inputName.val(),s=t.trim(this.ui.inputEmail.val()),a=this.ui.selectCountryCode.find("option:selected").val(),r=t.trim(this.ui.inputCellphone.val()),c=d.getPhoneNumberInfoFromLocalNumber(r,a);e=c.isValidNumber?c.formatE164:"",this.virtualMemberId?(n={bandNo:this.bandNo,virtualMemberId:this.virtualMemberId,name:o,cellphone:e,email:s},l.modifyVirtualMembers(n).then(i.bind((function(){this.trigger("modify:VirtualMember"),this.destroy()}),this))):(n={bandNo:this.bandNo,name:o,cellphone:e,email:s},l.addVirtualMembers(n).then(i.bind((function(e){this.trigger("add:VirtualMember",e),this.destroy()}),this)).fail(i.bind((function(e){201===e.result_code&&this.destroy()}),this)))},_deleteVirtualMember:function(){var e={bandNo:this.bandNo,virtualMemberId:this.virtualMemberId};l.delVirtualMembers(e).then(i.bind((function(){this.trigger("delete:VirtualMember"),this.destroy()}),this))}});return h.buildAsLayer=function(e,t){var n=new h({bandNo:e,model:t||new o.Model({name:"",email:"",cellphone:"",virtual_member_id:""})});return r.open(n),n},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(4).Behavior.extend({options:{eventName:"clickOutside"},initialize:function(){this._onClickOutside=this._triggerViewEvent,this._onClickDocumentOnCapture=i.bind(this._onClickDocumentOnCapture,this),this.view.clickOutsideRegister=i.bind(this._registerClickOutside,this),this.view.clickOutsideUnregister=i.bind(this._unregisterClickOutside,this)},onBeforeDetach:function(){this._unregisterClickOutside()},_registerClickOutside:function(e){i.isFunction(e)?this._onClickOutside=e:this._onClickOutside=this._triggerViewEvent,this._unregisterClickOutside(),document.addEventListener("click",this._onClickDocumentOnCapture,!0)},_unregisterClickOutside:function(){document.removeEventListener("click",this._onClickDocumentOnCapture,!0)},_onClickDocumentOnCapture:function(e){this.view.el.contains(e.target)||this._onClickOutside()},_triggerViewEvent:function(){this.view.trigger(this.options.eventName)}});e.exports=o},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(4),o=n(556);return i.CollectionView.extend({constructor:function(e){if(!(e.postModel&&e.postModel instanceof o))throw new Error("{RichPostModel} postModel is required");this.collection=new t.Collection,i.CollectionView.apply(this,arguments),this._reloadFromPostModel()},attachmentViews:{},defaultChildView:null,childView:function(e){var t=this.attachmentViews[e.attachmentType];return t?!t.__super__&&_.isFunction(t)?t(e):t:this.defaultChildView},childViewOptions:function(){return _.clone(this.options)},_reloadFromPostModel:function(){this.collection.reset(this.options.postModel.toContentModels())}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2461),s=n(871),a=n(2462),r=n(875),l=n(152),c=i.View.extend({tagetUserNameName:"section",className:"lyWrap",attributes:{"data-viewname":"DAttachmentHistoryView"},template:t.template(o),ui:{btnConfirm:"._btnConfirm"},events:{"click @ui.btnConfirm":"destroy"},regions:{historyListRegion:"._historyListRegion"},initialize:function(e){this.bandNo=e.bandNo,this.attachmentType=e.attachmentType},onRender:function(){this.showChildView("historyListRegion",new i.CollectionView({tagName:"ul",className:"listLine rScroll",childView:a,childViewOptions:t.bind((function(e,t){return{attachmentType:this.attachmentType,bandNo:this.bandNo,isLast:this.collection.length-1===t}}),this),collection:this.collection}))}});return c.buildForPollSubjectHistroyV1=function(e,t,n){var i=new s([]);return i.fetchPollSubejctHistoryV1(e,t,n),new c({collection:i,bandNo:e,attachmentType:l.POST_ATTACHMENT_TYPE.POLL})},c.buildForPollSubjectHistroyV2=function(e,t,n,i){var o=new s([]);return o.fetchPollSubejctHistoryV2(e,t,n,i),new c({collection:o,bandNo:e,attachmentType:l.POST_ATTACHMENT_TYPE.POLL_V2})},c.buildForTodoSubjectHistroyV1=function(e,t,n){var i=new s([]);return i.fetchTodoSubejctHistoryV1(e,t,n),new c({collection:i,bandNo:e,attachmentType:l.POST_ATTACHMENT_TYPE.TODO})},c.buildForTodoSubjectHistroyV2=function(e,t,n,i){var o=new s([]);return o.fetchTodoSubejctHistoryV2(e,t,n,i),new c({collection:o,bandNo:e,attachmentType:l.POST_ATTACHMENT_TYPE.TODO_V2})},c.buildForRsvpHistory=function(e,n,i,o){var s=new r({bandNo:e,scheduleId:n});return s.fetchRsvpReplyHistory(i,o).then(t.bind((function(){return new c({collection:s,bandNo:e,attachmentType:l.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP})}),this))},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(523);t.makeRemainingTimeText=function(e){var t=e.startAt,n=e.endedAt,o=e.timeZoneId,s=e.closedText,a=i.getRemainingTime(t,o);return a&&!a.close?IM("attendance_check.label.remaining_time_format_"+a.format,{value:a.value}):function(e,t,n){var o=i.getRemainingTime(e,n);if(o)return o.close?t:IM("todo.label.remaining_time_format_"+o.format,{value:o.value})}(n,s,o)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(523);return{getRsvpRemainingTimeMsg:function(e){if(e&&!e.isEmpty()){var n=e.get("endedAt");if(null==n)return null;var i=t.getRemainingTime(n);return i.close?IM("schedule.rsvp.close_attendance_due_date"):IM("rsvp.label.remaining_time_format_"+i.format,{value:i.value})}return null},getRsvpAttendeeLimitMsg:function(e){return e&&e.get("attendeeLimit")?IM("schedule.rsvp.attendee_limit",{attendeeLimitCount:e.get("attendeeLimit")}):null}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(43),o=n(651),s=n(800),a=n(2034),r=n(486),l=n(26);return{checkRecurrenceThenDeleteSchedule:function(e,n){if(t.isEmpty(e.getRecurrence()))this._deleteScheduleAndNotify(e,o.EDIT_TYPE.ALL,n);else{var a=i(e.getStartAt()),r=i(e.getRecurrence().getSince()),l=[{label:IM("schedule.detail.button.deleteRepeatType.ONE_ONLY"),value:o.EDIT_TYPE.ONE_ONLY},{label:IM("schedule.detail.button.deleteRepeatType.FUTURE"),value:o.EDIT_TYPE.FUTURE},{label:IM("schedule.detail.button.deleteRepeatType.ALL"),value:o.EDIT_TYPE.ALL}];(a.isBefore(r)||a.isSame(r))&&l.splice(1,1);var c=s.openAsLayer({title:IM("schedule.detail.button.delete"),confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:l,withoutHiding:!0});n.listenTo(c,"modal:confirm",t.bind((function(t){this._deleteScheduleAndNotify(e,t,n)}),this))}},_deleteScheduleAndNotify:function(e,t,n){var i=a.buildDScheduleCheckOptionConfirmView({title:IM("web.scheduledetail.menu.message.confirmdelete"),checkMessage:IM("schedule.delete.notify.checkbox.label")});r.openWithoutHiding(i),n.listenTo(i,"schedule:confirm",(function(n){e.deleteSchedule(t,n).then((function(){l.getDGlobalChannel().trigger(l.EVENT.SCHEDULE_DELETED,{bandNo:e.getBandNo(),scheduleId:e.getScheduleId()})}))}))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(610),a=n(43),r=n(26),l=n(154),c=n(510),d=n(590),u=n(651),h=n(800),p=n(1248),m=n(486),_=n(2034),g=o.Object.extend({initialize:function(e){this.scheduleEditModel=e.scheduleEditModel,this.bandData=e.bandData,this.recurringEditType=null},openScheduleEditLayerForModification:function(e){if(d.isContentCreationPunished())return t.Deferred().resolve(null);if(!this.scheduleEditModel.isLocalMeetup()||this.bandData.canSustainLocalMeetupOnModify())return this._checkRecurrenceThenOpenModificationView();var n=c.openLayer({bodyTitle:IM("schedule.modification_will_be_local_meetup_to_normal_schedule"),withoutHiding:!0}),o=t.Deferred();return this.listenToOnce(n,c.EVENTS.CONFIRM,i.bind((function(){l.wrapActivePromise(this._checkRecurrenceThenOpenModificationView(),e).then((function(e){o.resolve(e)}))}),this)),o.promise()},_checkRecurrenceThenOpenModificationView:function(){if(!this.scheduleEditModel.isRecurrenceExist())return this.recurringEditType=u.EDIT_TYPE.ALL,t.Deferred().resolve(this._openModificationView());var e=this.scheduleEditModel.getStartAtMoment(),n=a(this.scheduleEditModel.getRecurrence().getSince()),o=[{label:IM("schedule.detail.button.modifyRepeatType.ONE_ONLY"),value:u.EDIT_TYPE.ONE_ONLY},{label:IM("schedule.detail.button.modifyRepeatType.FUTURE"),value:u.EDIT_TYPE.FUTURE},{label:IM("schedule.detail.button.modifyRepeatType.ALL"),value:u.EDIT_TYPE.ALL}];(e.isBefore(n)||e.isSame(n))&&o.splice(1,1);var s=h.openAsLayer({title:IM("schedule.detail.button.modify"),description:IM("schedule.recurrent_schedule_edit_description"),confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:o,withoutHiding:!0}),r=t.Deferred();return this.listenTo(s,"modal:confirm",i.bind((function(e){this.recurringEditType=e,e==u.EDIT_TYPE.ALL&&this.scheduleEditModel.setStartAtMoment(a(this.scheduleEditModel.getRecurrence().getSince())),r.resolve(this._openModificationView())}),this)),r.promise()},_openModificationView:function(){u.EDIT_TYPE.ONE_ONLY==this.recurringEditType&&this.scheduleEditModel.setRecurrence(null),this.scheduleEditModel.isLocalMeetup()&&!this.bandData.canSustainLocalMeetupOnModify()&&this.scheduleEditModel.setIsLocalMeetup(!1);var e=this.scheduleEditModel.clone(),t=p.openScheduleEditLayer({bandData:this.bandData,scheduleEditModel:this.scheduleEditModel,shouldHideSecretSelect:this.scheduleEditModel.isLocalMeetup(),forModification:!0,postAttachable:!1});return this.listenTo(t,p.EVENT.SCHEDULE_EDIT_COMPLETE,(function(n){this._handleSubmit({editLayer:t,scheduleEditModel:n.scheduleEditModel,originalModel:e,bandNo:n.bandNo})})),t},_handleSubmit:function(e){var t=e.scheduleEditModel,n=e.editLayer;if(this._shouldNotifyModification(t,e.originalModel)){var i=_.buildDScheduleCheckOptionConfirmView({title:IM("schedule.modify.confirm.title"),checkMessage:IM("schedule.modify.confirm.checkbox.label")});m.openWithoutHiding(i),this.listenTo(i,"schedule:confirm",(function(t){this._modifySchedule({originalModel:e.originalModel,bandNo:e.bandNo,editLayer:n,notifyToMembers:t,scheduleEditModel:e.scheduleEditModel})})),this.listenTo(i,"schedule:confirm:cancel",(function(){n.stopSubmitPending()}))}else this._modifySchedule({originalModel:e.originalModel,bandNo:e.bandNo,editLayer:n,scheduleEditModel:e.scheduleEditModel})},_modifySchedule:function(e){var t=e.originalModel.getScheduleId(),n=e.scheduleEditModel.toScheduleModel(e.bandNo),o=e.editLayer;n.updateSchedule(e.notifyToMembers,this.recurringEditType).then(i.bind((function(){this._notifyUpdateBeforeDestroy(e.bandNo,n,t),o.destroy(),this.destroy()}),this)).fail((function(){o.stopSubmitPending()}))},_notifyUpdateBeforeDestroy:function(e,t,n){r.getDGlobalChannel().trigger(r.EVENT.SCHEDULE_UPDATED,{bandNo:e,exScheduleId:n,scheduleId:t.getScheduleId()})},_shouldNotifyModification:function(e,t){if(e.isAllDay()!=t.isAllDay())return!0;if(e.isLunar()!=t.isLunar())return!0;if(e.isLunar()){if(!this._isSameMoment(t.getLunarStartAtMoment(),e.getLunarStartAtMoment()))return!0;if(!this._isSameMoment(t.getLunarEndAtMoment(),e.getLunarEndAtMoment()))return!0}else{if(!this._isSameMoment(t.getStartAtMoment(),e.getStartAtMoment()))return!0;if(!this._isSameMoment(t.getEndAtMoment(),e.getEndAtMoment()))return!0}return!this._isSameRsvpWithBefore(e,t)||e.getName()!=t.getName()},_isSameMoment:function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.isSame(t)},_isSameRsvpWithBefore:function(e,t){return null==e.getRsvp()&&null==t.getRsvp()||null!=e.getRsvp()&&null!=t.getRsvp()&&s.isSameRsvpInput(e.getRsvp(),t.getRsvp(),!1)}});return g.buildDScheduleModificationViewOpener=function(e){return new g(e)},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(16),a=n(2491),r=n(541),l=n(486),c=n(165),d=n(700),u=n(180),h=n(9),p=n(570),m=n(526),_=n(835),g=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DBandCalendarUrlView"},template:t.template(a),templateContext:function(){var e=this.isDetailView?IM("schedule.detail.save_schedule.title"):IM("bandsetting.home.calendar_url"),t=this.isDetailView?IM("schedule.detail.save_schedule.desc"):"",n=null,o=null,s=null,a=null,r=null;if(this.isDetailView){var l=this._makeSaveScheduleUrl();n=l.google,o=l.outlook,s=l.yahoo,r="#"}else{var c=p.makeExportCalndarUrl({title:this._bandCore.name,iCalUrl:this.icalUrl});n=c.google,o=c.outlook,s=c.yahoo,a=c.naver,r=this.icalUrl}return{msg_title:e,msg_desc:t,msg_icalUrl:r,msg_isAlreadyCreated:this.isAlreadyCreated,googleCalendarUrl:n,outlookCalendarUrl:o,yahooCalendarUrl:s,naverCalendarUrl:a,isClipboardSupported:u.isSupported(),countryCode:h.getCountryCode(),languageCode:h.getLang(),isDetailView:this.isDetailView,osName:i.ua.platform.name.split(/\s/g)[0],calendarId:this.calendarInfo?this.calendarInfo.get("calendarId"):null,naverTxt:"ko"==h.getLang()?"네이버":"NAVER"}},ui:{btnCopyUrlText:"._btnCopyUrlText",btnDownloadICal:"._btnDownloadICal",btnWebcal:"._btnWebcal",btnNaver:"._btnNaver"},events:{"click ._btnClose":"destroy","click @ui.btnDownloadICal":"_onClickBtnDownloadICal","click ._btnDeleteUrl":function(){confirm(IM("bandsetting.calendar_url.delete.confirm"))&&r.deleteIcalUrl(this._bandCore.bandNo,this.calendarInfo.get("isDefault"),this.calendarInfo.get("calendarId")).then(t.bind(this.destroy,this))},"click @ui.btnWebcal":function(){if(this.isDetailView)return this._onClickBtnDownloadICal(),!1},"click @ui.btnNaver":function(e){return window.open(i(e.currentTarget).attr("href"),"calendarImport","width=480,height=330,scrollbars=no"),!1}},initialize:function(e){this._bandCore=e.bandCore,this.icalUrl=e.icalUrl||null,this.isAlreadyCreated=e.isAlreadyCreated||null,this.isDetailView=e.isDetailView,this.model=e.detailViewModel,this.calendarInfo=e.calendarInfo,this.makeIcsFile=d()},onAttach:function(){u.isSupported()&&this._initCopyClipboard()},onBeforeDetach:function(){null!==this.clipboard&&this.clipboard.destroy()},_initCopyClipboard:function(){this.clipboard=new u(this.ui.btnCopyUrlText.selector),this.clipboard.on("success",(function(e){alert(IM("calendar.export.clipboard_copy.success"))})),this.clipboard.on("error",(function(e){alert(IM("calendar.export.clipboard_copy.fail"))}))},_makeCalendarOutputData:function(e){var t=e.get("name"),n=[],i=!!e.get("location")&&e.get("location").get("address")||"",o=e.get("scheduleTimeZoneId")||c.getCurrentTimezone().id,a=e.get("recurrence")||"",r=e.get("startAt"),l=e.get("endAt"),d=e.get("isAllDay");if(e.get("scheduleType")==m.NORMAL||e.get("scheduleType")==m.EXTERNAL){e.get("calendar")&&e.get("description")&&(n.push(e.get("description")),n.push(" - ")),n.push(this._bandCore.name+": ");var u=e.getCalendar();u.isInternalCalendar()&&e.get("owner")?(n.push(u.get("name")),n.push(", "),n.push(e.get("owner").get("name")),n.push(" "+IM("ui.label.registration"))):u.isExternalCalendar()&&(n.push(u.get("name")),n.push(", "),n.push(u.get("serviceProvider")))}return e.get("scheduleType")==m.BIRTHDAY&&(a=new Backbone.Model({byDay:null,byMonthDay:null,freq:"YEARLY",interval:null,since:r,until:s(r).add("years",10).format("YYYY-MM-DD[T]HH:mm:ss[Z]")})),{scheduleId:e.getScheduleId(),subject:t,description:n.join(""),location:i,timezone:o,recurrence:a,startAt:r,endAt:l,isAllDay:d}},_onClickBtnDownloadICal:function(){var e=this.model.get("name")+s(this.model.get("startAt")).format("YYYY-MM-DD"),t=this.model,n=this._makeCalendarOutputData(t),i=this._makeIcsFileEventOptions(n);this.makeIcsFile.addEvent(i),this.makeIcsFile.download(e,".ics")},_makeSaveScheduleUrl:function(){return{google:_.makeAddEventToGoogleCalendarUrl(this.model,this._bandCore),yahoo:_.makeAddEventUrlForYahoo(this.model,this._bandCore),outlook:_.makeAddEventUrlForOutlookLive(this.model,this._bandCore)}},_makeIcsFileEventOptions:function(e){var t=e.subject||"",n=e.description||"",i=e.location||"",o=e.startAt||"",a=e.endAt||o,r=e.scheduleId||null,l=e.isAllDay,c=e.timezone,d=e.recurrence;return{subject:t,description:n,location:i,timestamp:s().format("YYYYMMDD[T]HHmmss[Z]"),begin:s(o).tz(c).format("YYYYMMDD[T]HHmmss"),end:s(a).tz(c).format("YYYYMMDD[T]HHmmss"),uid:r.replace(/\//g,"-"),isAllDAy:l,timezone:c,recurrence:d}}});return g.openAsLayer=function(e){var t=e.bandData||null,n=e.isDetailView||!1,i=e.detailViewModel||null,o=e.calendarInfo,s=!o||o.get("isDefault"),a=o?o.get("calendarId"):null;n?l.openWithoutHiding(new g({bandCore:t.getBandCore(),isDetailView:n,detailViewModel:i,calendarInfo:o})):r.createIcalUrl(t.getBandNo(),s,a).then((function(e){l.openWithoutHiding(new g({bandCore:t.getBandCore(),icalUrl:e.ical_url,isAlreadyCreated:e.is_already_created,isDetailView:n,detailViewModel:i,calendarInfo:o}))}))},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(486),a=n(2513),r=n(511),l=n(531),c=n(490),d=o.View.extend({className:"lyWrap",attributes:{"data-viewname":"DScheduleRsvpExportItemSelectView"},template:t.template(a),templateContext:function(){var e=this._customStates.map((function(e){return{targetId:"customRsvp_"+this.cid+"_"+e.customStateId,title:e.title,customStateId:e.customStateId}}),this);return{cid:this.cid,ATTENDANCE:r.ATTENDANCE,PENDING_ATTENDANCE:r.PENDING_ATTENDANCE,ABSENCE:r.ABSENCE,MAYBE:r.MAYBE,msgDesc:this.exportType==l.RSVP.EXPORT_TYPE.PRINT?IM("schedule.rsvp.select_print_item.desc"):IM("schedule.rsvp.select_download_item.desc"),isMaybeEnabled:this._isMaybeEnabled,customStateList:e,skinColorClass:this._skinColorClass}},ui:{btnCancel:"._btnCancel",btnConfirm:"._btnConfirm",btnAllSelect:"._btnAllSelect",inputRsvpTypes:"._inputRsvpTypes",fixedRsvpInput:"._fixedRsvpInput",customRsvpInput:"._customRsvpInput"},events:{"click @ui.btnCancel":"destroy","click @ui.btnAllSelect":"_onClickAllSelect","click @ui.inputRsvpTypes":"_onClickInputRsvpTypes","click @ui.btnConfirm":"_onClickBtnConfirm"},initialize:function(e){this.exportType=e.exportType,this._isMaybeEnabled=e.isMaybeEnabled,this._customStates=e.customStates||[],this._skinColorClass=e.skinColorClass||""},_onClickAllSelect:function(e){var t=this.getUI("btnAllSelect").prop("checked");this.getUI("inputRsvpTypes").prop("checked",t),this._btnConfirmStatus(!t)},_onClickInputRsvpTypes:function(e){var n=[];t.each(this.getUI("inputRsvpTypes"),(function(e){n.push(i(e).prop("checked"))})),this.getUI("btnAllSelect").prop("checked",!t.contains(n,!1)),this._btnConfirmStatus(!t.contains(n,!0))},_btnConfirmStatus:function(e){this.getUI("btnConfirm").attr("disabled",e)},_onClickBtnConfirm:function(){var e={normalRsvpType:t.chain(this.ui.fixedRsvpInput).filter((function(e){return i(e).prop("checked")})).map((function(e){return i(e).val()})).value(),customRsvpType:t.chain(this.ui.customRsvpInput).filter((function(e){return i(e).prop("checked")})).map((function(e){return parseInt(i(e).val())})).value()};this.trigger("selected:item",c.convertObjectToUriQueryJsonString(e)),this.destroy()}});return d.openAsLayer=function(e,t,n,i){var o=new d({exportType:e,isMaybeEnabled:t,customStates:n,skinColorClass:i});return s.open(o),o},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(611),o=n(26),s=n(486),a=n(491),r=n(516),l=n(1040),c=n(833);function d(e,t,n,l,d){var u={result_data:{photos:n,total_count:n.length},openIndex:l,bandNo:e,postNo:t,goPostSupport:!1,profileViewSupport:!0,showUserInfo:!0,moreOptionList:[c.MEDIA_MORE_OPTION.SHOW_VIDEO_VIEWER_LIST,c.MEDIA_MORE_OPTION.COPY_URL,c.MEDIA_MORE_OPTION.DELETE,c.MEDIA_MORE_OPTION.REPORT],disableCommentInput:d},h=i.buildImageViewer(u);h.on(c.TRIGGERING_EVENTS.MEDIA_DELETED,(function(e){h.destroy(),o.getPostChannel().trigger(o.EVENT.POST_UPDATED,t)})),h.on(i.EVENT.FETCH_VIDEO_URL,(function(n,i,o,s){a.getCachedBandData(e).then((function(s){s.canVideoUrlByPost()?r.getVideoUrlByPost(e,t,i).then((function(e){h.setVideoUrlFromAPI(e,n)})):r.getVideoUrlByPhotoNo(e,o).then((function(e){h.setVideoUrlFromAPI(e,n)}))}))})),h.on("destroy",h.off),s.open(h)}return{openDPostMediaViewer:function(e,n){var i=e.getBandNo(),o=e.getPostNo(),s=l.generateMediaData(e);d(i,o,s,t.findIndex(s,{photo_no:n}),e.get("shouldDisableComment"))},openDPostPromotionPhotoViewer:function(e,t){var n=t.get("url"),o=t.get("width"),s=t.get("height"),a=e.getBandNo();i.openDPromotionImageViewer(a,n,o,s)},openPostListItemMediaViewer:function(e){var n=null,i=null,o=e.bandNo,s=e.postNo,a=e.photos,r=e.openIndex,c=e.richPostModel,u=e.postListItemModel;c&&(n=t.pluck(a,"photo_no"),i=t.chain(l.generateMediaData(c)).sortBy((function(e){return t.result(this,e.photo_no,1e3)}),t.object(n,t.range(0,n.length))).value(),t.isEqual(n,t.chain(i).pluck("photo_no").first(n.length).value())&&(a=i)),d(o,s,a,r,u.get("shouldDisableComment"))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(577),a=o.View.extend({tagName:"button",className:function(){return this._isFullScreen?"liveBtn -backScreen":"liveBtn -fullScreen"},initialize:function(){this._isFullScreen=!1},template:t.template('<span class="gSrOnly"><%-text %></span>'),templateContext:function(){return{text:this._isFullScreen?IM("close_full_screen"):IM("full_screen")}},onRender:function(){this.$el.attr("class",this.className())},triggers:{click:"click"},changeFullscreen:function(e){this._isFullScreen=e,this.render()}}),r=o.Behavior.extend({options:{regionName:""},initialize:function(){this._onWindowFullscreen=t.bind(this._onWindowFullscreen,this)},onRender:function(){this.view.showChildView(this.options.regionName,new a),this.listenTo(this._getControlView(),"click",this._toggleFullScreen)},_toggleFullScreen:function(){s.isEnableFullScreen()?s.isFullScreenMode()?s.closeFullScreen():s.openFullScreen(this.el):alert("not support full screen")},_onWindowFullscreen:function(){this._getControlView().changeFullscreen(s.isFullScreenMode()),this.view.trigger(r.EVENT.CHANGE_FULL_SCREEN,s.isFullScreenMode())},onAttach:function(){i(window).on(s.FULLSCREEN_EVENT_NAME,this._onWindowFullscreen)},onBeforeDetach:function(){i(window).off(s.FULLSCREEN_EVENT_NAME,this._onWindowFullscreen)},_getControlView:function(){return this.view.getChildView(this.options.regionName)}});return r.EVENT={CHANGE_FULL_SCREEN:"changeFullScreen"},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){n(194);var t,i=n(0),o=n(4),s=n(152),a=n(1110),r=n(1563),l=n(1155),c=n(1652),d=n(2593),u=n(2595),h=n(1568),p=n(2042),m=n(2055),_=n(1653),g=n(1657),f=n(1658),b=n(1263),v=n(1575),A=n(1576),E=n(1264),T=n(2606),C=n(2056),y=n(1577),M=(n(517),n(1578)),I=n(2059),S=n(2060),w=n(2062),N=n(656),D=o.View.extend({attributes:{"data-viewname":"DPostListItemView",tabindex:-1},template:i.template(T),templateContext:function(){var e=this.model.getMissionInfoForPost(),t=e?e.getPostMissionConfirmCompleteText():null;return N.hasRestriction(this.model)&&(t=void 0),{missionTitle:t}},ui:{postAuthorRegion:"._postAuthorRegion",missionInfo:"._missionInfo"},regions:{postAuthorRegion:"@ui.postAuthorRegion",content:{el:"._content",replaceElement:!0}},events:{"click @ui.missionInfo":"_showPostDetailLayer"},childViewEvents:{"author:showPostDetailLayer":"_showPostDetailLayer","childview:attachment:showPostDetailLayer":"_showPostDetailLayer","childview:textContent:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentSticker:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentPoll:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentSchedule:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentTodo:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentBillSplit:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentPhotoAlbum:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentPromotionPhotoList:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentPhotoList:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentFile:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentLocation:showPostDetailLayer":"_showPostDetailLayer","childview:sharedPostSnippet:showPostDetailLayer":"_showPostDetailLayer","childview:sharedPagePostSnippet:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentSnippet:showPostDetailLayer":"_showPostDetailLayer","childview:postAttachment:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentAddon:showPostDetailLayer":"_showPostDetailLayer","childview:attachmentAudio:showPostDetailLayer":"_showPostDetailLayer"},initialize:function(e){this.renderSharedPostMode=e.renderSharedPostMode||!1},onAttach:function(){this._showAuthorInfo();var e=new o.CollectionView({className:"postBody"});this.showChildView("content",e),i.each(this.contentViewBuilders,(function(t,n){var i=t.viewBuilder.call(this);i&&e.addChildView(i)}),this)},_showAuthorInfo:function(){var e={bPostDetail:!1,renderSharedPostMode:this.renderSharedPostMode},t=a.build(this.model,e);this.getRegion("postAuthorRegion").show(t)},contentViewBuilders:(t=[{attachmentType:"",viewBuilder:function(){var e=this.model.get("content");if(e&&""!=e&&"\n"!=e)return r.build({bandNo:this.model.getBandNo(),postNo:this.model.getPostNo(),guideBand:this.model.getBand().isGuide,textContent:e,hasAttachment:this.model.hasAttachment(),preventMentionAnchor:!this.model.getBand().supportMentionClick(),isRestricted:this.model.isRestricted()})}},{attachmentType:s.POST_ATTACHMENT_TYPE.STICKER,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.STICKER).at(0);if(e&&!(this.model.countOccupatingAttachmentType()>=1))return l.build({model:e})}},{attachmentType:s.POST_ATTACHMENT_TYPE.POLL_V2,viewBuilder:function(){var e=this.model.getPollAll().at(0);if(e){var t=this.model.countOccupatingAttachmentType()>1||this.model.get("pollAllCount")>1?s.ATTACHMENT_DISPLAY_TYPE.HEADER:s.ATTACHMENT_DISPLAY_TYPE.PREVIEW;return c.buildDPostPollListItemAttachmentView(e,this.model,t)}}},{attachmentType:s.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP),t=!e.isEmpty()&&e.at(0);if(t){if(t.hasSingleSchedule()){var n=t.getSchedules().at(0);return d.buildForPostListItem(n)}return u.buildForPostListItem(t)}}},{attachmentType:s.POST_ATTACHMENT_TYPE.ATTENDANCE_CHECK,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.ATTENDANCE_CHECK),t=e.where({seq:0})[0]||e.at(0);if(t)return C.build({model:t,postModel:this.model})}},{attachmentType:s.POST_ATTACHMENT_TYPE.SIGNUP,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.SIGNUP).at(0);if(e)return M.build({model:e,postModel:this.model})}},{attachmentType:s.POST_ATTACHMENT_TYPE.QUIZ,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.QUIZ).at(0);if(e)return S.buildDPostQuizView(e,this.model)}},{attachmentType:s.POST_ATTACHMENT_TYPE.SURVEY,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.SURVEY).at(0);if(e)return w.buildDPostSurveyView(e,this.model)}},{attachmentType:s.POST_ATTACHMENT_TYPE.BILL_SPLIT,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.BILL_SPLIT);if(e)return p.build({model:e})}},{attachmentType:s.POST_ATTACHMENT_TYPE.TODO_V2,viewBuilder:function(){var e=this.model.getTodoAll().at(0);if(e)return h.buildListItemView({model:e,postModel:this.model})}},{attachmentType:s.POST_ATTACHMENT_TYPE.AUDIO,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.AUDIO).at(0);if(e)return I.buildDPostAudioView(e)}},{attachmentType:s.POST_ATTACHMENT_TYPE.PHOTO_ALBUM,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.PHOTO_ALBUM);if(e)return m.build({model:e})}},{attachmentType:s.POST_ATTACHMENT_TYPE.PHOTO,viewBuilder:function(){if(this.model.hasVideo()||this.model.hasPhoto()||this.model.hasPromotionPhoto())return _.build({postListItemModel:this.model,renderSharedPostMode:this.renderSharedPostMode})}},{attachmentType:s.POST_ATTACHMENT_TYPE.SHARED_POST_SNIPPET,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.SHARED_POST_SNIPPET);if(e)return g.build({originalPostModel:this.model,model:e,attachmentDisplayType:this.model.countOccupatingAttachmentType()>1?s.ATTACHMENT_DISPLAY_TYPE.HEADER:s.ATTACHMENT_DISPLAY_TYPE.DETAIL})}},{attachmentType:s.POST_ATTACHMENT_TYPE.SHARED_PAGE_POST_SNIPPET,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.SHARED_PAGE_POST_SNIPPET);if(e)return f.build({originalPostModel:this.model,model:e,attachmentDisplayType:this.model.countOccupatingAttachmentType()>1?s.ATTACHMENT_DISPLAY_TYPE.HEADER:s.ATTACHMENT_DISPLAY_TYPE.DETAIL})}},{attachmentType:s.POST_ATTACHMENT_TYPE.SNIPPET,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.SNIPPET).at(0);if(e)return b.build({bandNo:this.model.get("band").bandNo,postNo:this.model.get("postNo"),model:e,attachmentDisplayType:this.model.countOccupatingAttachmentType()>1?s.ATTACHMENT_DISPLAY_TYPE.HEADER:s.ATTACHMENT_DISPLAY_TYPE.DETAIL})}},{attachmentType:s.POST_ATTACHMENT_TYPE.FILE,viewBuilder:function(){var e=this.model.getFileAll();if(e&&0!=e.length)return v.build({collection:e})}},{attachmentType:s.POST_ATTACHMENT_TYPE.LOCATION,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.LOCATION).at(0);if(e)return A.build({model:e,attachmentDisplayType:s.ATTACHMENT_DISPLAY_TYPE.HEADER})}},{attachmentType:s.POST_ATTACHMENT_TYPE.SUBPOST,viewBuilder:function(){var e=this.model.getAttachment(s.POST_ATTACHMENT_TYPE.SUBPOST);if(e)return E.build({model:e,bandNo:this.model.getBandNo(),postNo:this.model.getPostNo()})}},{attachmentType:s.POST_ATTACHMENT_TYPE.ADDON,viewBuilder:function(){var e=this.model.getAddon().at(0);if(e)return y.buildListItemView({model:e,postModel:this.model,attachmentDisplayType:this.model.countOccupatingAttachmentType()>1||this.model.get("addonCount")>1?s.ATTACHMENT_DISPLAY_TYPE.HEADER:s.ATTACHMENT_DISPLAY_TYPE.PREVIEW})}}],i.sortBy(t,(function(e){return i.indexOf(s.ATTACHMENT_ORDER,e.attachmentType)}))),_showPostDetailLayer:function(){this.trigger("postItem:clickAttachment:showPostDetailLayer")}});return D.buildRenderSharedPostMode=function(e){return new D({model:e,renderSharedPostMode:!0})},D}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2592),s=n(152),a=n(523),r=i.View.extend({options:{attachmentDisplayType:null,postModel:null},attributes:{"data-viewname":"DPostPollListItemAttachmentView",tabindex:-1},className:function(){var e="uWidget";return this.options.attachmentDisplayType===s.ATTACHMENT_DISPLAY_TYPE.PREVIEW&&(e+=" -preview"),e},template:t.template(o),templateContext:function(){var e=IM("web.postlist.poll.label.done");return this.model.get("isOpen")&&(e=this.model.get("isAnonymous")?IM("post.poll.title.anonymous_poll_in_progress"):IM("web.postlist.poll.label.in_progress")),{postPollAllCount:this.options.postModel.get("pollAllCount"),msg_pollProgressStatus:e,msg_remainingTime:this._getRemainingTime(),bListPreview:this.options.attachmentDisplayType===s.ATTACHMENT_DISPLAY_TYPE.PREVIEW}},serializeData:function(){return this.model.toJSON()},triggers:{click:"attachmentPoll:showPostDetailLayer"},_getRemainingTime:function(){var e=this.model,t=e.get("endedAt");if(e.get("isOpen")&&t>0){var n=a.getRemainingTime(t);return IM("web.postdetail.poll.remaining_time_format_"+n.format,{value:n.value})}return""}});return r.buildDPostPollListItemAttachmentView=function(e,t,n){return new r({model:e,postModel:t,attachmentDisplayType:n})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(152),s=n(154),a=n(2598),r=n(516),l=n(1574),c=n(556),d=n(1649),u=n(697),h=n(1040),p=n(487),m=n(1054),_=n(2054),g=i.View.extend({behaviors:[p],attributes:{"data-viewname":"DPostPhotoListView"},className:"uWidget -displayBlock gCursorPointer",template:t.template(a),ui:{moreMedia:"._moreMedia"},events:{click:"_showPostDetailLayer"},regions:{collage:{el:"._collage",replaceElement:!0}},childViewEvents:function(){var e={};return e[l.EVENTS.OPEN_MEDIA]=function(e){this._openTotalMediaViewer(e)},e[l.EVENTS.VIDEO_PLAYER_PLAY]=function(e,t){this.jplOccur(p.CLASSIFIER.VIDEO_PLAY_START,{band_no:this._bandNo,post_no:this._postNo,is_auto:t.isAutoPlayed,type:"uploaded",video_url:e.model.get("source"),total_duration_ms:1e3*t.duration,start_position_ms:1e3*t.currentTime})},e[l.EVENTS.VIDEO_PLAYER_PAUSE]=function(e,t){this.jplOccur(p.CLASSIFIER.VIDEO_PLAY_STOP,{band_no:this._bandNo,post_no:this._postNo,is_auto:t.isAutoPlayed,type:"uploaded",video_url:e.model.get("source"),total_duration_ms:1e3*t.duration,stop_position_ms:1e3*t.currentTime})},e},initialize:function(e){this.renderSharedPostMode=e.renderSharedPostMode,this._bandNo=e.bandNo,this._postNo=e.postNo,this._sortedMedias=e.sortedMedias,this._mediaCount=this._sortedMedias.length,this._moreMediaExist=this._mediaCount>o.PHOTO_DISPLAY_MAX_COUNT,this._collageSize=4,this._postListItemModel=e.postListItemModel},onDomRefresh:function(){var e;e=this._isPlayableLiveVideo()?_.buildDLiveVodCardPlayView({videoId:this._sortedMedias[0].video.videoId,poster:this._sortedMedias[0].photo_url,expiresAt:this._sortedMedias[0].video.expires_at,bandNo:this.options.bandNo,postNo:this.options.postNo,noplay:!!this.renderSharedPostMode,noclick:!!this.renderSharedPostMode}):l.buildDPhotoCollageView(this._getCollagePhotos(),{useMore:!this.renderSharedPostMode&&this._mediaCount>this._collageSize,noplay:!!this.renderSharedPostMode}),this.showChildView("collage",e)},_isPlayableLiveVideo:function(){return 1===this._sortedMedias.length&&this._sortedMedias[0].video&&this._sortedMedias[0].video.is_live},_getCollagePhotos:function(){return t.chain(this._sortedMedias).first(this._collageSize).map((function(e){var n=e.video;return{photoUrl:e.photo_url,expiresAt:t.result(n,"expires_at",null),video:!!n,videoPlayerModel:this._createVideoPlayerModelOf(n),width:e.width,height:e.height,isGifVideo:t.result(n,"is_gif",!1),isLiveVideo:t.result(n,"is_live",!1),savableState:e.savableState}}),this).value()},_createVideoPlayerModelOf:function(e){if(!e)return null;var t=this._bandNo,n=this._postNo,i=e.videoId,o=u.createVideoPlayerModel({videoId:e.videoId,sources:function(){return r.getVideoUrlByPost(t,n,i)},expiresAt:e.expires_at});return e.is_gif||e.is_live||o.enablePostVideoViewingProgressLogging(t,n,i),o},_showPostDetailLayer:function(){return this.trigger("attachmentPhotoList:showPostDetailLayer"),!1},_openTotalMediaViewer:function(e){return this._openIndex=e,!this._moreMediaExist||this._richPostModel?(this._openMediaViewer(),!1):(this._fetchingPhotoPromise||(this._fetchingPhotoPromise=s.wrapActivePromise(c.createAndFetchBandPostModel(this._bandNo,this._postNo),this).then(t.bind((function(e){this._richPostModel=e,this._openMediaViewer()}),this))),!1)},_openMediaViewer:function(){var e=this._sortedMedias[this._openIndex||0];e&&e.video&&e.video.is_live?m.openVodLiveViewerLayer(this._bandNo,this._postNo,e.video.videoId):d.openPostListItemMediaViewer({bandNo:this._bandNo,postNo:this._postNo,photos:this._sortedMedias,openIndex:this._openIndex,richPostModel:this._richPostModel,postListItemModel:this._postListItemModel})}});return g.build=function(e){var t=h.generateSortedMediasFromPostListItemModel(e.postListItemModel);return new g({bandNo:e.postListItemModel.getBandNo(),postNo:e.postListItemModel.getPostNo(),sortedMedias:t,renderSharedPostMode:e.renderSharedPostMode,postListItemModel:e.postListItemModel})},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(82),s=n(1051),a="videoPlayer:play",r="videoPlayer:pause",l="openMedia",c=t.constant('<span class="_player"></span>'),d=t.constant('<button type="button" class="collageImage _imageButton"><span class="_player"></span></button>'),u=i.View.extend({options:{videoPlayerModel:null,width:0,height:0,photoUrl:void 0,noplay:!1,isGifVideo:!1},tagName:"li",attributes:{"data-viewname":"DPhotoCollageFullSizeVideoItemView"},getTemplate:function(){return this.options.isGifVideo||this.options.isLiveVideo?d:c},events:{click:function(e){this.options.isGifVideo&&(e.stopPropagation(),this.trigger(l,this))}},onDomRefresh:function(){if(this.options.isGifVideo){var e=this.$el.width(),t=Math.max(Math.min(e*this.options.height/this.options.width,744),80);this.$el.addClass("collageItem"),this.showChildView("player",s.buildGifVideoPlayer({noplay:this.options.noplay,poster:o.make(this.options.photoUrl,o.TYPE.w520),model:this.options.videoPlayerModel,videoWidth:this.options.width,videoHeight:this.options.height,playerWidth:e,playerHeight:t}))}else this.showChildView("player",s.buildBlurFullfillPlayer({noplay:this.options.noplay,poster:o.make(this.options.photoUrl,o.TYPE.w520),model:this.options.videoPlayerModel,videoWidth:this.options.width,videoHeight:this.options.height,playerWidth:this.$el.width(),playerHeight:Math.max(Math.min(this.$el.width()/this.options.width*this.options.height,this.$el.width()),150)}))},regions:{player:{el:"._player",replaceElement:!0}},childViewEvents:function(){var e={};return e[s.EVENTS.VIDEO_PLAYER_OPEN_MEDIA_VIEWER]=function(){this.trigger(l,this)},e},childViewTriggers:function(){var e={};return e[s.EVENTS.VIDEO_PLAYER_PLAY]=a,e[s.EVENTS.VIDEO_PLAYER_PAUSE]=r,e}});return u.buildDPhotoCollageFullSizeVideoItemView=function(){return new u},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2599),s=n(156),a=n(82),r=n(1122),l=n(1185),c=i.View.extend({options:{video:!1,expiresAt:void 0,photoUrl:void 0,isGifVideo:!1,isLiveVideo:!1,showMore:!1,imageThumbnailType:"",playerIconClass:""},tagName:"li",attributes:{"data-viewname":"DPhotoCollageImageItemView"},_setClassName:function(){var e="";this.options.isGifVideo?e="gif":this.options.video&&(e="player "+this.options.playerIconClass),e="collageItem "+e,this.$el.removeClass(),e&&this.$el.addClass(e)},onDomRefresh:function(){this.options.video?this.ui.image.setLoading({useLoading:!1,retryCount:10}).one("setLoading:done",t.bind(this._setClassName,this)):this._setClassName()},template:t.template(o),templateContext:function(){return{imageUrl:a.make(this.options.photoUrl,this.options.imageThumbnailType),showMore:this.options.showMore,isExpiredVideo:s.isExpiredFile(this.options.expiresAt),isLiveVideo:this.options.isLiveVideo}},ui:{moreMedia:"._moreMedia",imageButton:"._imageButton",image:"._image"},triggers:{"click @ui.moreMedia":l.OPEN_MEDIA,"click @ui.imageButton":l.OPEN_MEDIA}});return c.buildDPhotoCollageImageItemView=function(e){var t=(r.useHighQualityImage()?{"2:3":a.TYPE.ff828_1242,"3:2":a.TYPE.ff1242_828,"2:1":a.TYPE.ff1242_621,"1:1":a.TYPE.s480}:{"2:3":a.TYPE.ff500_750,"3:2":a.TYPE.ff750_500,"2:1":a.TYPE.ff640_320,"1:1":a.TYPE.s480})[e.thumbnailScale],n={big:"-size80",middle:"-size60",small:"-size50"}[e.playerIconScale];return new c({video:e.video,expiresAt:e.expiresAt,photoUrl:e.photoUrl,isGifVideo:e.isGifVideo,isLiveVideo:e.isLiveVideo,showMore:e.showMore,imageThumbnailType:t,playerIconClass:n})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1185),s=n(82),a=n(156),r=n(1121),l=n(1122),c=i.View.extend({options:{photoUrl:void 0,imageThumbnailType:null,imageClass:""},tagName:"li",attributes:{"data-viewname":"DPhotoCollageDynamicSizeItemView"},className:function(){var e="";return this.options.video?e="player -size80":a.isGif(this.options.photoUrl)&&(e="gif"),"collageItem "+e},template:t.template('<button class="collageImage _imageButton"><img src="<%- imageUrl %>"<% if (imageClass) { %> class="<%=imageClass%>"<% } %> alt=""></button>'),templateContext:function(){return{imageUrl:s.make(this.options.photoUrl,this.options.imageThumbnailType),imageClass:this.options.imageClass}},ui:{imageButton:"._imageButton"},triggers:{"click @ui.imageButton":o.OPEN_MEDIA}});return c.buildPostCardDynamicItemView=function(e){var t,n=r.create(["webtoon_crop",2/3,"static",6.2,"panorama_crop"]).identify(e.width/e.height),i="";return"panorama_crop"===n&&(i="gCenterItem"),t=l.useHighQualityImage()?"webtoon_crop"===n?s.TYPE.ff828_1242:s.TYPE.e1280_std:"webtoon_crop"===n?s.TYPE.ff500_750:s.TYPE.w520,new c({photoUrl:e.photoUrl,imageClass:i,imageThumbnailType:t,video:e.video})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(153),s=n(2600),a=n(152),r=n(82),l=n(633),c=n(517),d=n(487),u=n(1041),h=i.View.extend({attributes:{"data-viewname":"DPostSharedPostSnippetView"},className:"uWidget",template:t.template(s),ui:{dimArea:"._dimArea",sharedPostSnippet:"._sharedPostSnippet"},events:{"click @ui.sharedPostSnippet":function(e){if(e.preventDefault(),this.model.isSourcePostUnavailable())return this.trigger("sharedPostSnippet:showPostDetailLayer"),!1;if(this._moveSharedPostPage(),this._originalPostModel){var t=this.model.get("bandNo");this.jplClick(d.CLASSIFIER.SHARED_POST_AREA,{band_no:t,post_no:this.model.get("postNo"),container_band_no:this._originalPostModel.getBandCore().bandNo,container_post_no:this._originalPostModel.getPostNo()},t)}}},behaviors:[d,u.withUI("dimArea","sharedPostSnippet:showPostDetailLayer",{modelFunction:function(){return this._sharedPost}})],initialize:function(e){this._originalPostModel=e.originalPostModel,this._sharedPost=t.isEmpty(e.model.getSourcePost())?null:new c(e.model.getSourcePost(),{parse:!0}),this._attachmentDisplayType=e.attachmentDisplayType},serializeData:function(){var e=this.model.get("image"),t=l.getSnippetThumbnailTypeOfImage({url:e,width:this.model.get("imageWidth"),height:this.model.get("imageHeight")});t!==l.TYPE_NO_IMAGE&&this._attachmentDisplayType===a.ATTACHMENT_DISPLAY_TYPE.HEADER&&(t=l.TYPE_SQUARE);var n=r.makePostSnippetThumbnailUrl(t,e);return{isSourcePostUnavailable:this.model.isSourcePostUnavailable(),thumbnailType:t,thumbnailUrl:n,isPlayButtonVisible:this._isPlayButtonVisible(),bandName:this.model.get("bandName"),snippetContents:this.model.get("body"),url:this._makeLandingUrl(),titleLineClass:this._getTitleLineClass(t)}},onRender:function(){u.renderDimOfView(this)},_isPlayButtonVisible:function(){var e=this.model.get("image"),t=e&&this._sharedPost?this._sharedPost.getAttachment(a.POST_ATTACHMENT_TYPE.VIDEO).findWhere({logoImage:e}):null;return t?!t.isGif():this.model.get("isPlayButtonVisible")},_getTitleLineClass:function(e){switch(e){case l.TYPE_HEIGHT_IS_LONGER:return"-multi5line";case l.TYPE_WIDTH_IS_LONGER:return"-multiline";default:return"-multi3line"}},_moveSharedPostPage:function(){return window.open(this._makeLandingUrl(),"_blank"),!1},_makeLandingUrl:function(){return o.GROUP_BAND_POST_DETAIL.makeUrl({band_no:this.model.get("bandNo"),post_no:this.model.get("postNo")})}});return h.build=function(e){return new h(e)},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(162),s=n(2601),a=n(152),r=n(82),l=n(633),c=n(517),d=n(487),u=i.View.extend({attributes:{"data-viewname":"DSharedPagePostSnippetView"},className:"uWidget",template:t.template(s),ui:{sharedPagePostSnippet:"._sharedPagePostSnippet"},events:{"click @ui.sharedPagePostSnippet":function(e){if(e.preventDefault(),this.model.isSourcePostUnavailable())return this.trigger("sharedPagePostSnippet:showPostDetailLayer"),!1;if(this._moveSharedPagePostWebPage(),this._originalPostModel){var t=this.model.get("bandNo");this.jplClick(d.CLASSIFIER.SHARED_POST_AREA,{band_no:t,post_no:this.model.get("postNo"),container_band_no:this._originalPostModel.getBandCore().bandNo,container_post_no:this._originalPostModel.getPostNo()},t)}}},behaviors:[d],initialize:function(e){this._originalPostModel=e.originalPostModel,this._sharedPost=t.isEmpty(e.model.getSourcePost())?null:new c(e.model.getSourcePost(),{parse:!0}),this._attachmentDisplayType=e.attachmentDisplayType},serializeData:function(){var e=this.model.get("image"),t=l.getSnippetThumbnailTypeOfImage({url:e,width:this.model.get("imageWidth"),height:this.model.get("imageHeight")});t!==l.TYPE_NO_IMAGE&&this._attachmentDisplayType===a.ATTACHMENT_DISPLAY_TYPE.HEADER&&(t=l.TYPE_SQUARE);var n=r.makePostSnippetThumbnailUrl(t,e);return{isSourcePostUnavailable:this.model.isSourcePostUnavailable(),thumbnailType:t,thumbnailUrl:n,isPlayButtonVisible:this._isPlayButtonVisible(),bandName:this.model.get("bandName"),snippetContents:this.model.get("body"),url:this._makeLandingUrl(),titleLineClass:this._getTitleLineClass(t)}},_isPlayButtonVisible:function(){var e=this.model.get("image"),t=e&&this._sharedPost?this._sharedPost.getAttachment(a.POST_ATTACHMENT_TYPE.VIDEO).findWhere({logoImage:e}):null;return t?!t.isGif():this.model.get("isPlayButtonVisible")},_getTitleLineClass:function(e){switch(e){case l.TYPE_HEIGHT_IS_LONGER:return"-multi5line";case l.TYPE_WIDTH_IS_LONGER:return"-multiline";default:return"-multi3line"}},_moveSharedPagePostWebPage:function(){return window.open(this._makeLandingUrl(),"_blank"),!1},_makeLandingUrl:function(){return o.PAGE_BAND_POST_DETAIL.makeUrl({band_no:this.model.get("bandNo"),post_no:this.model.get("postNo")})}});return u.build=function(e){return new u(e)},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(2),n(0),n(4),n(57),n(1257),n(26)],void 0===(o=function(e,t,n,i,o,s){var a=n.Object.extend({initialize:function(e){this._$videoTag=e.$videoTag,this._posterUrl=e.posterUrl,this._videoUrl=e.videoUrl,this._encodingOnInit=1==e.encodingOnInit,this._hideBigPlayOnInit=1==e.hideBigPlayOnInit,this._width=e.width,this._height=e.height,this._hideOnInit=e.hideOnInit,this._showPosterWhenEnded=1==e.showPosterWhenEnded,this._hideVideoControlsOnLoad=1==e.hideVideoControlsOnLoad,this._hideControlsBeforePlay=1==e.hideControlsBeforePlay,this._doNotShowErrorView=1==e.doNotShowErrorView,this._useYoutubeControls=1==e.useYoutubeControls,this._hideControlsBeforePlay&&(this._hideVideoControlsOnLoad=!0)},onDestroy:function(){this._player&&(this._player.pause(),this._player.remove(),this._player.container.off(),this._player.layers.find(".mejs-overlay-button, .mejs-overlay-play").off(),this._player=null),this._media&&(this._media.off(),this._media=null),this._$videoTag=null},initVideoPlayer:function(){var n=e.Deferred();if(!this._$videoTag)return n.resolve(null,null,null);this._setWidthHeightSize(),i.isWindows8Or8_1IE()||this._$videoTag.removeAttr("src"),this._$videoTag.attr("poster",this._posterUrl),this._$videoTag.find("source").attr("src",this._videoUrl);var o={success:t.bind((function(i,o,s){this._media=e(i),this._player=s,this._media.on("play",t.bind((function(e){this.trigger("videoPlayer:play",e)}),this)),this._media.on("pause",t.bind((function(e){this.trigger("videoPlayer:pause",e)}),this)),this._media.on("ended",t.bind((function(e){this.trigger("videoPlayer:ended",e)}),this)),this._player.container.on("enterFullScreen",t.bind((function(){this.trigger("videoPlayer:enterFullScreen")}),this)),this._player.container.on("exitFullScreen",t.bind((function(){this.trigger("videoPlayer:exitFullScreen")}),this)),this._player.container.on("clickContainer",t.bind((function(){this.trigger("videoPlayer:clickContainer")}),this)),e(this._player.container).find("._btnVideoPlay").focus(),n.resolve()}),this),youtubeBlocked:t.bind((function(){this._player.layers.hide()}),this),clickToPlayPause:!0,pluginPath:"/script/_libs/mediaelement/",fullscreenText:IM("full_screen"),fullscreenCancelText:IM("close_full_screen"),playText:IM("web.audioplayer.player.btn.play"),pauseText:IM("pause"),muteText:IM("mute"),unmuteText:IM("unmute"),hideBigPlay:this._hideBigPlayOnInit,hideOnInit:this._hideOnInit,showPosterWhenEnded:this._showPosterWhenEnded,hideVideoControlsOnLoad:this._hideVideoControlsOnLoad,hideControlsBeforePlay:this._hideControlsBeforePlay,doNotShowErrorView:this._doNotShowErrorView,useYoutubeControls:this._useYoutubeControls};return o=this._adjustFeatureOptions(o),this._$videoTag.mediaelementplayer(o),n.then(t.bind((function(){return this.listenTo(s.getDGlobalChannel(),s.EVENT.PAUSE_VIDEO,this.pause),this}),this))},playOrPause:function(){this._media[0].paused?this._media[0].play():this._media[0].pause()},pause:function(){this._media&&!this._media[0].paused&&this._media[0].pause()},isFullScreen:function(){return this._player&&this._player.isFullScreen},showContainerAndLayers:function(){this._player.container.show(),this._player.layers.show()},_adjustFeatureOptions:function(e){return this._encodingOnInit?t.extend(e,{features:[]}):e},_setWidthHeightSize:function(){this._width&&this._$videoTag.width(this._width),this._height&&this._$videoTag.height(this._height)}});return a.buildDVideoPlayer=function(e){return new a(e||{})},a}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(1661),s=n(805);return i.Collection.extend({model:o,initialize:function(e,t){this.bandNo=t.bandNo,this.postNo=t.postNo},fetchShareCount:function(){return s.getSharedPostCount(this.bandNo,this.postNo).then(t.bind((function(e){this.reset(e,{parse:!0})}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(504),o=n(490);return t.Model.extend({parse:function(e,t){return{sharedCount:e.shared_count,user:new i(e.user,{parse:!0})}},toJSON:function(){return o.toRecursiveJSON(this)}})}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;void 0===(i=function(e){var t=n(167),i=n(166),o=n(1286),s=n(1287),a={LIGHT:"screenModeLight",DARK:"screenModeDark",AUTO:"screenModeAuto"},r={getScreenMode:function(){return o.isBandLabOptionEnabled(s.OPTION_KEYS.DARK_MODE)&&t.getCurrentUserEnvStorage().get(i.ScreenMode)||a.LIGHT},setScreenMode:function(e){t.getCurrentUserEnvStorage().set([i.ScreenMode],e),this.screenModeAddClass(e)},screenModeAddClass:function(e){var t=[a.LIGHT,a.DARK,a.AUTO];$("html").removeClass(t.join(" ")).addClass(e)}};return r.SCREEN_MODE=a,r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return function(e,t){$(e.wrapper.$).find(".cke_widget_drag_handler_container").width(t)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2165);return i.View.extend({attributes:{"data-viewname":"PollWidgetView"},template:t.template(o),ui:{btnModify:"._btnModify",btnDelete:"._btnDelete"},triggers:{"click @ui.btnModify":"modify","click @ui.btnDelete":"remove"},serializeData:function(){return{isOpen:!!this.model.get("isOpen"),isMultipleSelect:!!this.model.get("isMultipleSelect"),pollCount:this.model.get("count")||"0",title:this.model.get("title")||"투표제목을 입력해주세요"}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2180);return i.View.extend({attributes:{"data-viewname":"TodoWidgetView"},template:t.template(o),ui:{btnDelete:"._btnDelete",btnModify:"._btnModify"},triggers:{"click @ui.btnDelete":"remove","click @ui.btnModify":"modify"},serializeData:function(){var e=this.model.get("numberOfDone")||"0",t=this.model.get("numberOfTasks")||this.model.get("tasks").length||"0";return{doneCount:e,taskCount:t,isAllDone:e===t,title:this.model.get("title")}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(4),a=n(847),r=n(2194),l=n(2195),c=n(2196),d=n(486),u=n(1618),h=n(578);n(208);var p=n(906),m=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorBillSplitAttachView"},template:i.template(r),templateContext:function(){return{msg_currencyList:h.getSelectItemList()}},ui:{currencyList:"._currencyList",inputTotalPrice:"._inputTotalPrice",btnSelectMember:"._btnSelectMember",billMembersWrap:"._billMembersWrap",memberPrice:"._memberPrice",btnClose:"._btnClose",btnComplete:"._btnComplete"},events:{"click @ui.btnSelectMember":"_openMemberSelectView","change @ui.currencyList":"_changeCurrency","keyup @ui.inputTotalPrice":"_checkTotalPriceChanged","paste @ui.inputTotalPrice":"_checkTotalPriceChanged","focus @ui.memberPrice":"_initAutoNumbericForMemberPrice","keyup @ui.memberPrice":"_modifyMemberPrice","paste @ui.memberPrice":"_modifyMemberPrice","click @ui.btnClose":"_cancel","click @ui.btnComplete":"_complete"},initialize:function(e){this._body=t("body"),this.bandNo=e.bandNo},layerOnEscKeyDown:function(){this._cancel()},onAttach:function(){this.ui.inputTotalPrice.autoNumeric("init",{mRound:"D",lZero:"deny"}),this._updateAutoNumericSetting(this.model.get("currency"),this.model.get("totalPrice")),this._renderMemberList(this.model.get("members")),this.ui.currencyList.val(this.model.get("currency")),this._upldateValidStatus(),this.ui.inputTotalPrice.focus()},onBeforeDetach:function(){this.ui.inputTotalPrice.autoNumeric("destroy")},_cancel:function(){this.trigger(p.EVENT.CANCEL),this.destroy()},_complete:function(){this._syncModelData(),this.model.isValid()&&(this.trigger(p.EVENT.ATTACH,this.model),this.destroy())},_syncModelData:function(){var e=this.$el.find("._memberPrice[data-modified!=true]"),n=this._getAvailableTotalPrice(),i=e.length,o=h.getDecimal(this.ui.currencyList.val()),s=h.getSplitPriceArray(n,i,o);e.each((function(e,n){t(n).val(s[e])}));var a=u.extractModelData("postBillSplit",this);a.memberCount=a.members.length,a.currencyLabel=h.getCurrencyLabel(a.currency),this.model.set(a)},_upldateValidStatus:function(){this._syncModelData(),this.ui.btnComplete.toggleClass("-disabled",!this.model.isValid())},_initAutoNumbericForMemberPrice:function(e){var n=t(e.currentTarget);n.data("index");if(!n.data("modified")&&this.$el.find("._memberPrice[data-modified!=true]").length<=1)return n.blur(),alert(IM("web.postwrite.form_billsplit.alert.last_member_modify")),!1;var i=h.getDecimal(this.model.get("currency")),o=this._getAvailableTotalPrice();n.autoNumeric("init",{mRound:"D",wEmpty:"zero",lZero:"deny",mDec:i,vMax:o})},_modifyMemberPrice:function(e){var n=t(e.currentTarget),i=n.data("index"),o=this.model.get("members").at(i);n.val()!==o.get("price")&&(n.attr("data-modified",!0),this._upldateValidStatus())},_changeCurrency:function(){var e=this.ui.currencyList.val(),t=parseFloat(this.ui.inputTotalPrice.autoNumeric("get"));this._updateAutoNumericSetting(e,t),this.$el.find("[data-uiselector=memberCurrencyLabel]").html(h.getCurrencyLabel(e)),this.$el.find("._memberPrice").attr("data-modified",!1),this._upldateValidStatus()},_checkTotalPriceChanged:function(){var e=parseFloat(this.ui.inputTotalPrice.autoNumeric("get"));this.model.get("totalPrice")!==e&&(this.$el.find("._memberPrice").attr("data-modified",!1),this._upldateValidStatus())},_openMemberSelectView:function(){var e=[];this.model.get("members").each((function(t){e.push(t.get("userNo"))}));var t=c.buildDEditorMemberSelectionView(this.bandNo,e);this.listenTo(t,"select:member:done",(function(e){var t=new o.Collection;i.each(e,(function(e){var n=a.createMemberModelFrom(e);t.add(n)})),this.ui.btnSelectMember.addClass("-on"),this.ui.btnSelectMember.text(IM("web.postwrite.form_billsplit.label.selected_member_count",{count:t.length})),this._renderMemberList(t),this._upldateValidStatus()})),d.open(t)},_renderMemberList:function(e){if(this.ui.billMembersWrap.empty(),e&&e.length>0){var t=i.template(l)({members:e.toJSON()});this.ui.billMembersWrap.append(t)}},_getAvailableTotalPrice:function(){var e=parseFloat(this.ui.inputTotalPrice.autoNumeric("get")),n=this.$el.find("._memberPrice[data-modified=true]");return n&&n.length>0&&n.each((function(n,i){e-=t(i).val().replace(/,/gi,"")})),e||(e=0),e},_updateAutoNumericSetting:function(e,t){var n=h.getDecimal(e),i=h.getPriceLimit(e);if(t)if("number"==typeof t){for(;t>i;)t=Math.floor(t/10);this.ui.inputTotalPrice.autoNumeric("set",t)}else this.ui.inputTotalPrice.val(t);this.ui.inputTotalPrice.autoNumeric("update",{mDec:n,vMax:i})}});return m.openLayer=function(e,t){var n=new m({bandNo:e,model:t});return d.openWithoutHiding(n),n},m}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(43),a=n(800),r=n(1248),l=n(2254),c=n(2005),d=n(152),u=n(1258),h=(n(549),n(563)),p=n(935),m=n(906),_=n(2007),g={CREATE:{value:"create",label:IM("post.schedule_group.create_schedule")},SELECT:{value:"select",label:IM("post.schedule_group.select_existing_schedule")},TITLE:{value:"title",label:IM("post.schedule_group.edit_title")},RESELECT:{value:"reselect",label:IM("post.schedule_group.select_schedule")}},f=o.Object.extend({initialize:function(e){this._bandData=e.bandData,this._editing=!!e.editing,this._scheduleGroup=e.scheduleGroup||h.createScheduleGroup(),this._selection=c.buildEditorScheduleSelectCollection({maxCount:d.GROUP_SCHEDULE_MAX_COUNT,schedules:this._scheduleGroup.getSchedules().toArray()}),this._editing?this._startEditing():this._startCreating()},_startCreating:function(){this._selectCreatingOption()},_startEditing:function(){var e=this._scheduleGroup.getFirstScheduleModel(),t=this._scheduleGroup.getScheduleCount();e.get("scheduleId")?1===t?this._selectSchedules():this._selectEditingOption():1===t?this._editSchedule(u.createScheduleEditModelBy(e.clone())):this._editTitle()},_selectCreatingOption:function(){var e=_.openScheduleCreationTypeSelectView(this._bandData.canRegisterLocalMeetup(),!0);this.listenTo(e,_.EVENT.SCHEDULE_CREATION,(function(e){switch(e){case _.CREATION_TYPE.NORMAL_SCHEDULE:this._editSchedule(u.createScheduleEditModel(s()));break;case _.CREATION_TYPE.LOCAL_MEETUP_SCHEDULE:this._editSchedule(u.createLocalMeetupModel(s()));break;case _.CREATION_TYPE.EXISTING_SCHEDULE:this._selectSchedules()}})),this.listenTo(e,_.EVENT.SCHEDULE_CREATION_CANCELED,(function(){this._cancel()}))},_selectEditingOption:function(){var e=a.openAsLayer({title:IM("post.schedule_group.select_edit_item"),radioItems:[g.TITLE,g.RESELECT],initialCheckedValue:g.TITLE.value,confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),withoutHiding:!0});this.listenTo(e,{"modal:cancel":this._cancel,"modal:confirm":function(e){switch(e){case g.TITLE.value:this._editTitle();break;case g.RESELECT.value:this._selectSchedules()}}})},_editSchedule:function(e){var t=r.openScheduleEditLayer({scheduleEditModel:e,shouldHideSecretSelect:e.isLocalMeetup(),bandData:this._bandData,postAttachable:!1,submitText:IM("web.btn.attach")}),n={};n[r.EVENT.SCHEDULE_EDIT_COMPLETE]=function(e){this._submitSchedule({editLayer:t,scheduleEditModel:e.scheduleEditModel,ScheduleModel:e.ScheduleModel})},n[r.EVENT.SCHEDULE_EDIT_CANCEL]=this._cancel,this.listenTo(t,n)},_submitSchedule:function(e){var n=e.scheduleEditModel.toScheduleModel(this._bandData.getBandCore().bandNo),i=e.editLayer;n.checkScheduleCreation().then(t.bind((function(){this._attachSingleSchedule(n),i.destroy()}),this),t.bind((function(e){e.result_data&&e.result_data.message&&alert(e.result_data.message)}),this)).always(t.bind((function(){i.stopSubmitPending()})))},_selectSchedules:function(){var e=l.openEditorScheduleSelectLayer({bandData:this._bandData,selection:this._selection,withoutHiding:!0,doNotClose:!0});this.listenTo(e,{cancel:function(){e.destroy(),this._cancel()},confirm:function(){var t=this._scheduleGroup.get("title"),n=this._selection.size()>1;n&&i.isBlank(t)?this._editTitle(e):(e.destroy(),n?this._attachMultipleSchedules():this._attachSingleSchedule(this._selection.first()))}})},_editTitle:function(e){var t=p.openDPromptModalView({title:IM("post.schedule_group.input_schedule_title"),maxlength:d.SCHEDULE_GROUP_TITLE_MAX_LENGTH,multiline:!0,placeholder:IM("post.schedule_group.schedule_title_placeholder"),defaultText:this._scheduleGroup.get("title")||"",withoutHiding:!0});this.listenTo(t,{"modal:cancel":function(){e||this._cancel()},"modal:confirm":function(t){e&&e.destroy(),this._attachMultipleSchedules(t)}})},_attachSingleSchedule:function(e){this._scheduleGroup.set("title",null),this._scheduleGroup.getSchedules().reset(e),this._attach()},_attachMultipleSchedules:function(e){e&&(e=i.trim(e).replace(/\r?\n/g,""),this._scheduleGroup.set("title",e)),this._scheduleGroup.getSchedules().reset(this._selection.getSelectedEditorSchedules()),this._attach()},_attach:function(){this.trigger(m.EVENT.ATTACH,this._scheduleGroup),this.destroy()},_cancel:function(){this.trigger(m.EVENT.CANCEL),this.destroy()}});return f.startCreatingScheduleGroup=function(e){return new f(e)},f.startEditingScheduleGroup=function(e){return new f(t.extend({editing:!0},e))},f}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(21);return{searchSpots:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1/search_spots",data:e})},getLocation:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v1.0.0/get_location",data:e}).then((function(e){return e.address}))},getLocationShaeringMembers:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us/v2.0.0/get_location_sharing_members",data:e}).then((function(e){return e}))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(0),n(16),n(4),n(2247),n(9),n(1314),n(593)],void 0===(o=function(e,t,n,i,o,s,a){var r=n.View.extend({_isAllDay:!1,_selectedAlarm:null,_selectableDurationTypes:[],_selectableAmounts:[],tagName:"div",className:"option flexList -on -tbSpaceNone gMat5 gMab16",attributes:{"data-viewname":"DScheduleAlarmView"},template:e.template(i),ui:{alarmAmountSelect:"._alarmAmountSelect",alarmDurationTypeSelect:"._alarmDurationTypeSelect",alarmTimeRegion:"._alarmTimeRegion"},regions:{alarmTimeRegion:{el:"@ui.alarmTimeRegion",replaceElement:!1}},events:{"change @ui.alarmDurationTypeSelect":function(n){var i=this.ui.alarmDurationTypeSelect.val();this.ui.alarmDurationTypeSelect.attr("data-value",i);var o=this._selectedAlarm;this._selectedAlarm={duration_type:i,amount:null,alarm_time:null},this._selectableAmounts=a.getDurationAmounts(i,this._isAllDay),e.contains(this._selectableAmounts,o.amount)&&(this._selectedAlarm.amount=o.amount),this._isAllDay&&(this._selectedAlarm.alarm_time=o.alarm_time||t().add(1,"hours").startOf("hour").format("HH:mm")),this.trigger(r.EVENT.CUSTOM_ALARM_CHANGED,this._selectedAlarm),this.render()},"change @ui.alarmAmountSelect":function(e){this._selectedAlarm.amount=null;var t=this.ui.alarmAmountSelect.val();t&&(this.ui.alarmAmountSelect.attr("data-value",t),this._selectedAlarm.amount=parseInt(this.ui.alarmAmountSelect.val())),this.trigger(r.EVENT.CUSTOM_ALARM_CHANGED,this._selectedAlarm)}},initialize:function(e){this._isAllDay=e.isAllDay,this._selectableDurationTypes=a.getDurationTypes(this._isAllDay),this._selectedAlarm={duration_type:this._selectableDurationTypes[0].value,amount:null,alarm_time:null},e.alarm&&(this._selectedAlarm=e.alarm),this._selectableAmounts=a.getDurationAmounts(this._selectedAlarm.duration_type,this._isAllDay)},serializeData:function(){return{isAllDay:this._isAllDay,selectableDurationTypes:this._selectableDurationTypes,selectableAmounts:this._selectableAmounts,selectedAlarm:this._selectedAlarm}},onBeforeDetach:function(){this._detachAlarmTimeInputView()},onRender:function(){this._attachAlarmTimeInputView()},_attachAlarmTimeInputView:function(){if(this._isAllDay){var e=this.getRegion("alarmTimeRegion");if(!e||!e.hasView()){var n=this._selectedAlarm.alarm_time,i=s.buildTimeInputView({inputTime:n,minutesInterval:30,readOnlyInput:!1,pickerDirection:s.PICKER_DIRECTION.DOWN});this.listenTo(i,s.EVENT.TIME_CHANGED,(function(e){var n=t(e.time,e.format);this._selectedAlarm.alarm_time=n.format("HH:mm"),this.trigger(r.EVENT.CUSTOM_ALARM_CHANGED,this._selectedAlarm)})),e.show(i)}}},_detachAlarmTimeInputView:function(){var e=this.getRegion("alarmTimeRegion");e&&e.hasView()&&e.empty()}});return r.EVENT={CUSTOM_ALARM_CHANGED:"scheduleCustomAlarmView:changed"},r}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(6),s=n(549),a=n(503),r=n(570),l=n(506),c=n(16),d=o.Collection.extend({model:s,modelId:function(e){return e.scheduleId||e.schedule_id},initialize:function(e,t){this._bandNo=t.bandNo,this._maxCount=t.maxCount||0},canAddEditorSchedule:function(){return this.length<this._maxCount},getEditorScheduleMaxCount:function(){return this._maxCount},getSelectedEditorSchedules:function(){var e=this.toArray();return this._sortSchedules(e)},fetchMonthFirstPageSchedules:function(e){var t={bandNo:this._bandNo,startAt:e.clone(),futureEndAt:e.clone().endOf("month")};return this._month=e.clone(),this.reset(),this._fetchSchedules(t)},fetchMonthNextPageSchedules:function(){!this._loading&&this._params&&this._fetchSchedules(this._params)},_fetchSchedules:function(e){return this._loading=!0,this._params=e,a.getSchedules(e).then(t.bind((function(t){if(e!=this._params)return i.Deferred().reject().promise();this._params=this._parseNextPageParams(t),this.add(this._parseSchedules(t))}),this)).always(t.bind((function(){e==this._params&&(this._loading=!1)}),this))},_parseSchedules:function(e){var n=t.filter(e.items,(function(e){return!this.has(e.schedule_id)&&!this._month.isAfter(e.start_at)}),this),i=t.map(n,s.createScheduleModelByJSON);return this._sortSchedules(i)},_parseNextPageParams:function(e){var t=l.get(e,"paging.next_params");return t?{bandNo:this._bandNo,startAt:c(t.start_at,"YYYYMMDD"),futureEndAt:c(t.future_end_at,"YYYYMMDD")}:null},_sortSchedules:function(e){return t.sortBy(e,(function(e){var t=e.get("startAt");return[t,r.getScheduleSort({endAt:e.get("endAt"),startAt:t,isAllDay:e.get("isAllDay"),scheduleType:e.get("scheduleType"),scheduleDayStartAt:c(t).startOf("day")}),e.get("name")].join("_")}))}});return d.buildEditorScheduleSelectCollection=function(e){return new d(e.schedules,e)},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(531)],void 0===(o=function(e){return{convertPhotosForImageViewer:function(t,n){return{photos:_.map(t,(function(e){return{photo_url:e.url,width:e.width,height:e.height,author:n}})),total_count:t.length,contentType:e.REPORT.TYPE.PHOTO,bandNo:t.bandNo,scheduleId:t.scheduleId}}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(486),a=n(2261),r=o.View.extend({tagName:"section",className:"lyWrap -liteBg",attributes:{"data-viewname":"DScheduleCreationTypeSelectView"},template:t.template(a),templateContext:function(){return{canSelectLocalMeetup:this._canSelectLocalMeetup,canSelectExistSchedule:this._canSelectExistSchedule,normalSchedule:r.CREATION_TYPE.NORMAL_SCHEDULE,localMeetup:r.CREATION_TYPE.LOCAL_MEETUP_SCHEDULE,existingSchedule:r.CREATION_TYPE.EXISTING_SCHEDULE}},ui:{scheduleCreationInput:"._scheduleCreationInput",creationConfirmBtn:"._creationConfirmBtn",creationCancelBtn:"._creationCancelBtn"},events:{"click @ui.scheduleCreationInput":"_checkScheduleCreationInput","click @ui.creationCancelBtn":function(){this.trigger(r.EVENT.SCHEDULE_CREATION_CANCELED),this.destroy()},"click @ui.creationConfirmBtn":function(){var e=this.ui.scheduleCreationInput.filter((function(e,t){return i(t).prop("checked")}));this.trigger(r.EVENT.SCHEDULE_CREATION,i(e).val()),this.destroy()}},initialize:function(e){this._canSelectLocalMeetup=e.canSelectLocalMeetup,this._canSelectExistSchedule=e.canSelectExistSchedule},_checkScheduleCreationInput:function(e){var t=i(e.currentTarget);if(!t.prop("checked"))return!1;this._toggleScheduleCreationInput(t)},_toggleScheduleCreationInput:function(e){this.ui.scheduleCreationInput.prop("checked",!1),e.prop("checked",!0)}});return r.openScheduleCreationTypeSelectView=function(e,t){var n=new r({canSelectLocalMeetup:1==e,canSelectExistSchedule:1==t});return s.openWithoutHiding(n),n},r.EVENT={SCHEDULE_CREATION:"SCHEDULE_CREATION",SCHEDULE_CREATION_CANCELED:"SCHEDULE_CREATION_CANCELED"},r.CREATION_TYPE={NORMAL_SCHEDULE:"NORMAL_SCHEDULE",LOCAL_MEETUP_SCHEDULE:"LOCAL_MEETUP_SCHEDULE",EXISTING_SCHEDULE:"EXISTING_SCHEDULE"},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=(n(10),n(4)),s=n(16),a=n(167),r=n(166),l=n(152),c=n(13),d=n(491),u=n(501),h=n(667),p=n(2265),m=n(486),_=n(2266),g=n(2268),f=n(2272),b=n(2275),v=n(1115),A=n(1146),E=n(165),T=n(532),C=n(1004),y=n(2009),M=n(1629),I=n(906),S="startAt",w="endedAt",N=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorAttendanceCheckAttachView"},template:i.template(p),ui:{btnClose:"._btnClose",titleWrap:"._titleWrap",attendanceCheckTitle:"#attendanceCheckTitle",btnImportPrevAttendanceCheck:"._btnImportPrevAttendanceCheck",popoverHelpImportAttendanceCheck:"._popoverHelpImportAttendanceCheck",btnCloseImportAttendanceCheckHelpPopover:"._btnCloseImportAttendanceCheckHelpPopover",btnAddAttendees:"._btnAddAttendees",attendeesAddMenu:"._attendeesAddMenu",btnAddBandMemberAttendees:"._btnAddBandMemberAttendees",btnAddChildMemberAttendees:"._btnAddChildMemberAttendees",btnAddAttendeesFromRsvpMembers:"._btnAddAttendeesFromRsvpMembers",selectSupportedStates:"#selectSupportedStates",btnSelectManagers:"._btnSelectManagers",btnAddManagersHelp:"._btnAddManagersHelp",popoverAddMenagersHelp:"._popoverAddMenagersHelp",btnCloseAddManagersHelpPopover:"._btnCloseAddManagersHelpPopover",checkableByMemberInput:"#checkableByMemberInput",endedAtInputRegionWrap:"._endedAtInputRegionWrap",endedAtInputRegion:"._endedAtInputRegion",startAtInputRegionWrap:"._startAtInputRegionWrap",startAtInputRegion:"._startAtInputRegion",timeZoneRegionWrap:"._timeZoneRegionWrap",timeZoneRegion:"._timeZoneRegion",attendanceVisibleToViewer:"#attendanceVisibleToViewer",attendanceVisibleQualificationDesc:"._attendanceVisibleQualificationDesc",btnComplete:"._btnComplete"},events:{"click @ui.btnClose":"_cancel","focus @ui.attendanceCheckTitle":function(e){this.ui.titleWrap.addClass("-focus")},"blur @ui.attendanceCheckTitle":function(){this._setAttendanceCheckTitle(!0)},"input @ui.attendanceCheckTitle":function(){this._setAttendanceCheckTitle(!1)},"click @ui.btnImportPrevAttendanceCheck":"_openAttendanceCheckImportView","click @ui.btnCloseImportAttendanceCheckHelpPopover":"_closeImportAttendanceCheckHelpPopover","click @ui.btnAddAttendees":function(e){this.model.get("attendees").length>0?this._openAttendeeListView(e):this.ui.attendeesAddMenu.toggle()},"click @ui.btnAddBandMemberAttendees":function(e){this.ui.attendeesAddMenu.hide(),this._openBandMemberAttendeeSelectionView()},"click @ui.btnAddChildMemberAttendees":function(e){this.ui.attendeesAddMenu.hide(),this._openChildMemberAttendeeSelectionView()},"click @ui.btnAddAttendeesFromRsvpMembers":function(e){this.ui.attendeesAddMenu.hide(),this._openRsvpAttendeeImportView(e)},"change @ui.selectSupportedStates":function(e){var t=this.getUI("selectSupportedStates").find("option:selected").val().split(",");if(this.model.hasCheckedMember())return alert(IM("attendance_check.editor.change_supported_states.alert.exist_already_checked_member")),void this.getUI("selectSupportedStates").val(this.model.get("supportedStates").join(","));this.model.set("supportedStates",t)},"click @ui.btnSelectManagers":function(e){this._openManagerListView(e)},"click @ui.btnAddManagersHelp":function(e){this.ui.popoverAddMenagersHelp.toggle()},"click @ui.btnCloseAddManagersHelpPopover":function(e){this.ui.popoverAddMenagersHelp.hide()},"change @ui.checkableByMemberInput":function(e){var n=t(e.currentTarget).prop("checked");this.model.set("isCheckableOnlyByManagers",!n),this._toggleTimeInputRegion(e)},"click @ui.btnComplete":"_complete",click:function(e){this.isAttached()&&(t(e.target).hasClass("_btnAddAttendees")||this.ui.attendeesAddMenu&&this.ui.attendeesAddMenu.hide())},"change @ui.attendanceVisibleToViewer":function(e){var n=t(e.currentTarget).prop("checked"),i=T.ATTENDANCE_VISIBLE_QUALIFICATION.ALL;n||(i=T.ATTENDANCE_VISIBLE_QUALIFICATION.ONLY_MANAGER),this.model.setAttendanceVisibleQualification(i),this._attendanceVisibleQualificationDesc()}},regions:{endedAtInputRegion:{el:"@ui.endedAtInputRegion",replaceElement:!0},startAtInputRegion:{el:"@ui.startAtInputRegion",replaceElement:!0},timeZoneRegion:{el:"@ui.timeZoneRegion",replaceElement:!0}},modelEvents:{change:function(){this.getUI("btnComplete").prop("disabled",!this.model.isValid(this))},"change:attendeeCount":function(e,t){var n=IM("web.postwrite.form_attendance_check.add_attendees.btn.add");t>0&&(n=IM("web.postwrite.form_attendance_check.add_attendees.attendee_count",{count:t})),this.ui.btnAddAttendees.text(n)},"change:managerCount":function(e,t){var n=IM("web.postwrite.form_attendance_check.add_managers.btn.add.default");t>1&&(n=IM("web.postwrite.form_attendance_check.add_managers.manager_count",{count:t})),this.ui.btnSelectManagers.text(n)}},initialize:function(e){this.bandNo=e.bandNo,this.model.get("attendees").on("update",i.bind((function(e){this.model.set("attendeeCount",this.model.get("attendees").length)}),this)),this.model.get("managers").on("update",i.bind((function(e){this.model.set("managerCount",this.model.get("managers").length)}),this)),this._setDateTimeChangeStatus(S,!1),this._setDateTimeChangeStatus(w,!1),this._originSupportedStates=this.model.get("supportedStates")},templateContext:function(){return{attendanceCheckImportHelpClosed:a.getCurrentUserEnvStorage().get([r.AttendanceCheckImportHelpClosed])||!1,isAttachable:this.model.isValid(this),attendanceTitleMaxLength:l.ATTENDANCE_TITLE_MAX_LENGTH,isAttendanceVisibleToViewer:this._isAttendanceVisibleToViewer()}},onRender:function(){this._toggleTimeInputRegion()},onAttach:function(){this.getUI("attendanceCheckTitle").focus(),this._attendanceVisibleQualificationDesc(),d.getCachedBandData(this.bandNo).then(i.bind((function(e){this.bandData=e,this._toggleTimeInputRegion()}),this))},_setAttendanceCheckTitle:function(e){var t=this.model.getTitle(),n=this.getUI("attendanceCheckTitle").val().trim();(""===t&&""!==n||""!==t&&""===n||e)&&this.model.set("title",n),e&&this.getUI("titleWrap").removeClass("-focus")},layerOnEscKeyDown:function(){this._cancel()},_cancel:function(){this.trigger(I.EVENT.CANCEL),this.destroy()},_complete:function(){this.model.isValid(this)&&(this.trigger(I.EVENT.ATTACH,this.model),this.destroy())},_closeImportAttendanceCheckHelpPopover:function(e){this.ui.popoverHelpImportAttendanceCheck.hide(),a.getCurrentUserEnvStorage().set([r.AttendanceCheckImportHelpClosed],!0)},_openAttendanceCheckImportView:function(){"none"!==this.ui.popoverHelpImportAttendanceCheck.css("display")&&this._closeImportAttendanceCheckHelpPopover(),_.openAsLayer(this.bandNo).on("attendanceCheck:selected",i.bind((function(e){this.model.hasChanged()&&!confirm(IM("web.postwrite.form_attendance_check.prev_attendance_check_import_confirm"))||(this.model.setJSONForUpdate(this.bandData,e),this.render())}),this))},_openAttendeeListView:function(){var e=f.openAsLayer(this.bandNo,this.model);this.listenTo(e,"openBandMemberAttendeeSelectionView",this._openBandMemberAttendeeSelectionView),this.listenTo(e,"openChildMemberAttendeeSelectionView",this._openChildMemberAttendeeSelectionView),this.listenTo(e,"openRsvpAttendeeImportView",this._openRsvpAttendeeImportView)},_openBandMemberAttendeeSelectionView:function(){var e=h.CONSTANTS.MAX_ATTENDEE_COUNT-this.model.get("attendeeCount");if(e<=0)alert(IM("web.postwrite.form_attendance_check.user_selection_exceeded_alert",{count:h.CONSTANTS.MAX_ATTENDEE_COUNT}));else{var t=this.model.get("attendees").chain().filter((function(e){return!e.get("attendee").get("childMembershipId")})).map((function(e){return e.get("attendee").get("userNo")})).value(),n=new y(null,{bandData:this.bandData,excludedUserNos:t}),o=C.openAsLayer(this.bandData,n,e,!0);this.listenToOnce(o,C.EVENT.MEMBER_SELECTED,(function(e){if(!e.isEmpty()){var t=e.map(i.bind((function(e){var t={};return t.attendee=e.toJSON(),t}),this));this.model.get("attendees").add(t,{parse:!0})}})),this.listenTo(o,C.EVENT.SELECTION_COUNT_EXCEEDED,(function(){alert(IM("web.postwrite.form_attendance_check.user_selection_exceeded_alert",{count:h.CONSTANTS.MAX_ATTENDEE_COUNT}))}))}},_openChildMemberAttendeeSelectionView:function(){var e=h.CONSTANTS.MAX_ATTENDEE_COUNT-this.model.get("attendeeCount");if(e<=0)alert(IM("web.postwrite.form_attendance_check.user_selection_exceeded_alert",{count:h.CONSTANTS.MAX_ATTENDEE_COUNT}));else{var t=this.model.get("attendees"),n=M.buildChildMemberListView({bandNo:this.bandNo,unselectableChildMembers:t.getChildMemberAttendeeChildMembershipIds()});m.open(n),this.listenTo(n,"confirm:addChildMembers",(function(t){if(t&&0!=t.length)if(t.length>e)alert(IM("web.postwrite.form_attendance_check.user_selection_exceeded_alert",{count:h.CONSTANTS.MAX_ATTENDEE_COUNT}));else{var n=i.map(t,i.bind((function(e){var t={},n=c.getUserData().getUserNo();e.userNo||(e.userNo=n),t.attendee=e;var i=this.bandData.getMembershipMemberProfile(),o=new u({bandNo:this.bandData.getBandCore().bandNo,userNo:n,name:i.name,profileImageUrl:i.profileImageUrl,memberType:i.memberType},{parse:!0});return t.attendeeOwner=o.toJSON(),t}),this));this.model.get("attendees").add(n,{parse:!0}),m.closeTop()}}))}},_openRsvpAttendeeImportView:function(e){h.CONSTANTS.MAX_ATTENDEE_COUNT-this.model.get("attendeeCount")<=0?alert(IM("web.postwrite.form_attendance_check.user_selection_exceeded_alert",{count:h.CONSTANTS.MAX_ATTENDEE_COUNT})):g.openAsLayer(this.bandNo).once(g.EVENT.RSVP_ATTENDEES_SELECTED,i.bind((function(e){var t=this.model.get("attendees").map((function(e){return e.id})),n=e.map(i.bind((function(e){var t={attendee:e.get("member").toJSON()};return null!=e.get("actor")&&(t.attendeeOwner=e.get("actor").toJSON()),t}),this)),o=i.filter(n,(function(e){var n=e.attendee.userNo,i=e.attendee.childMembershipId,o=n+(i?"_"+i:"");return t.indexOf(o)<0}));this.model.get("attendeeCount")+o.length>h.CONSTANTS.MAX_ATTENDEE_COUNT?alert(IM("web.postwrite.form_attendance_check.user_selection_exceeded_alert",{count:h.CONSTANTS.MAX_ATTENDEE_COUNT})):o.length>0&&this.model.get("attendees").add(o,{parse:!0})}),this))},_openManagerListView:function(e){b.openAsLayer(this.bandData,this.model)},_isCheckableByMemberInput:function(){return this.getUI("checkableByMemberInput").prop("checked")},_getTimeZoneId:function(){return this.model.getTimeZoneId()||E.getCurrentTimezoneId()},_toggleTimeZoneSelectView:function(){var e=this.getRegion("timeZoneRegion");if(!this._isCheckableByMemberInput()||!this.model.getStartAt()&&!this.model.getEndedAt())return this.model.set("timeZoneId",null),this.getUI("timeZoneRegionWrap").hide(),void e.empty();if(!e.hasView()){var t=this._getTimeZoneId(),n=new A({timezoneId:t});this.model.set("timeZoneId",t),this.listenTo(n,A.EVENT.TIMEZONE_CHANGED,i.bind((function(e){this._changeTimeValueByTimeZoneId(e)}),this)),e.show(n),this.getUI("timeZoneRegionWrap").css("display","")}},_changeTimeValueByTimeZoneId:function(e){if(this.model.set("timeZoneId",e),this.model.getStartAt()){var t=s.tz(this.model.getStartAt(),e),n=t.format("YYYY-MM-DD"),i=t.format("HH:mm");this._getStartAtDateTimeInputView().setDateTime(n,i)}if(this.model.getEndedAt()){var o=s.tz(this.model.getEndedAt(),e),a=o.format("YYYY-MM-DD"),r=o.format("HH:mm");this._getEndedAtDateTimeInputView().setDateTime(a,r)}else this.model.getStartAt()&&this._updateEndedAtDateTimePicker(S,this.model.getStartAt())},_toggleTimeInputRegion:function(){this._toggleStartAtInputRegion(),this._toggleEndedAtInputRegion(),this._toggleTimeZoneSelectView()},_getDateTimeInputInitValue:function(e){var t=this.model.get(e);return null!=t?s.tz(t,this._getTimeZoneId()):null},_getStartAtMinDate:function(){return s().tz(this._getTimeZoneId())},_getEndedAtMinDate:function(){var e=this.model.getStartAt();return(e?s(e):s()).tz(this._getTimeZoneId())},_getStartAtMaxDate:function(){return this._getStartAtMinDate().add(90,"days")},_getEndedAtMaxDate:function(){return this._getEndedAtMinDate().add(90,"days")},_getInputValueDateTime:function(e){return(e.date+" "+e.time).trim()?s.tz(e.date+"T"+e.time,e.dateFormat+"T"+e.timeFormat,this._getTimeZoneId()):null},_isValidStartAtInputValue:function(e,t){var n=this._getInputValueDateTime(e);return null===n||(n.isBefore(this._getStartAtMinDate())?(t||alert(IM("postwrite.attach.poll.alert_invalid_ended_at")),!1):!n.isAfter(this._getStartAtMaxDate())||(t||alert(IM("attendance_check.set_start_at.alert_maximum",{maximum:90})),!1))},_isValidEndedAtInputValue:function(e,t){var n=this._getInputValueDateTime(e);return null===n||(n.isBefore(this._getEndedAtMinDate())||n.isSame(this._getEndedAtMinDate())?(t||alert(IM("postwrite.attach.poll.alert_invalid_ended_at")),!1):!n.isAfter(this._getEndedAtMaxDate())||(t||(this.model.getStartAt()?alert(IM("attendance_check.set_ended_at.alert_maximum",{maximum:90})):alert(IM("todo.set_ended_at.alert_maximum",{maximum:90}))),!1))},_toggleStartAtInputRegion:function(){var e=this.getRegion("startAtInputRegion");if(!this._isCheckableByMemberInput())return this.model.set(S,null),this.getUI("startAtInputRegionWrap").hide(),void e.empty();if(!e.hasView()){this.getUI("startAtInputRegionWrap").css("display","");var t=this._getDateTimeInputInitValue(S),n=s.tz(s(),this._getTimeZoneId()),o=n.add(30-n.minute()%30,"m");this._startAtDateTimeInputView=v.buildSolarDateInputView({timezoneId:this._getTimeZoneId(),dateTime:t,pickerDateTime:o,timeMinutesInterval:5,datePlaceholder:IM("ui.datepicker.placeholder.optional"),timePlaceholder:IM("ui.timepicker.placeholder.optional"),datepickerDirection:v.DATEPICKER_DIRECTION.UP,timepickerDirection:v.TIMEPICKER_DIRECTION.UP,useDatePicker:!0,disableTime:!1,canTextEdit:!1,useDelete:!0,dateValidator:{isValid:i.bind(this._isValidStartAtInputValue,this),getMinDate:i.bind(this._getStartAtMinDate,this),getMaxDate:i.bind(this._getStartAtMaxDate,this)}}),e.show(this._startAtDateTimeInputView),this.listenTo(this._startAtDateTimeInputView,v.EVENT.DATE_TIME_CHANGED,i.bind((function(e){this._setDateTimeAndViewUpdate(e,S)}),this))}},_getStartAtDateTimeInputView:function(){return this._startAtDateTimeInputView},_getEndedAtDateTimeInputView:function(){return this._endedAtDateTimeInputView},_setDateTimeAndViewUpdate:function(e,t){var n=this._getInputValueDateTime(e);if(n){var i=n.valueOf();this._setDateTimeChangeStatus(t,!0),this.model.set(t,i),this._updateEndedAtDateTimePicker(t,i),this._toggleTimeZoneSelectView()}else this.model.set(t,null)},_updateEndedAtDateTimePicker:function(e,t){if(e!==w){var n=this._getEndedAtDateTimeInputView(),i=n.getDateTime();if(!i.date||!i.time){var o=s.tz(s(t),this._getTimeZoneId());o.add(30,"m");var a=o.format("YYYY-MM-DD"),r=o.format("HH:mm");n.setPickerDateAndTime(a,r)}}},_toggleEndedAtInputRegion:function(e){var t=this.getRegion("endedAtInputRegion");if(!this._isCheckableByMemberInput())return this.model.set(w,null),this.ui.endedAtInputRegionWrap.hide(),void t.empty();if(!t.hasView()){this.ui.endedAtInputRegionWrap.css("display","");var n=this._getDateTimeInputInitValue(w),o=s.tz(s(),this._getTimeZoneId()),a=o.add(30-o.minute()%30,"m");this._endedAtDateTimeInputView=v.buildSolarDateInputView({timezoneId:this._getTimeZoneId(),dateTime:n,pickerDateTime:a,timeMinutesInterval:5,datePlaceholder:IM("ui.datepicker.placeholder.optional"),timePlaceholder:IM("ui.timepicker.placeholder.optional"),datepickerDirection:v.DATEPICKER_DIRECTION.UP,timepickerDirection:v.TIMEPICKER_DIRECTION.UP,useDatePicker:!0,disableTime:!1,canTextEdit:!1,useDelete:!0,dateValidator:{isValid:i.bind(this._isValidEndedAtInputValue,this),getMinDate:i.bind(this._getEndedAtMinDate,this),getMaxDate:i.bind(this._getEndedAtMaxDate,this)}}),t.show(this._endedAtDateTimeInputView),this.listenTo(this._endedAtDateTimeInputView,v.EVENT.DATE_TIME_CHANGED,i.bind((function(e){this._setDateTimeAndViewUpdate(e,w)}),this))}},startDateTimeValidation:function(){return this._hasChangedDateTime(S)&&this._getStartAtDateTimeInputView()&&!this._isValidStartAtInputValue(this._getStartAtDateTimeInputView().getDateTime(),!0)},endDateTimeValidation:function(){return(this._hasChangedDateTime(S)||this._hasChangedDateTime(w))&&this._getEndedAtDateTimeInputView()&&!this._isValidEndedAtInputValue(this._getEndedAtDateTimeInputView().getDateTime(),!0)},_hasChangedDateTime:function(e){return this[e+"Status"]},_setDateTimeChangeStatus:function(e,t){this[e+"Status"]!==t&&(this[e+"Status"]=t)},_isAttendanceVisibleToViewer:function(){return this.model.getAttendanceVisibleQualification()===T.ATTENDANCE_VISIBLE_QUALIFICATION.ALL},_attendanceVisibleQualificationDesc:function(){var e=this._isAttendanceVisibleToViewer(),t=IM("post.write.attendance_check.result_view_permission.desc1");e&&(t=IM("post.write.attendance_check.result_view_permission.desc2")),this.getUI("attendanceVisibleQualificationDesc").text(t)}});return N.openLayer=function(e,t){var n=new N({bandNo:e,model:t});return m.openWithoutHiding(n),n},N}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(780),s=n(493),a=n(160);return i.Collection.extend({model:o,initialize:function(e,t){this._bandData=t.bandData,this._bandNo=this._bandData.getBandCore().bandNo,this._excludedUserNos=t.excludedUserNos||[],this._hasMemberGroup=!1},search:function(e,t){return e?this._resetAsSearchedMembers(e,t):this._resetAsAllMembers(t)},isExcludedUserNo:function(e){return t.contains(this._excludedUserNos,e)},hasMemberGroup:function(){return this._hasMemberGroup},_resetAsAllMembers:function(e){return s.getBandMembersOfBandWithFilter(this._bandNo,"attendance_check").then(t.bind((function(t){var n=this._makeModels(t.members,e);this._hasMemberGroup=1==t.has_member_group;var i=this._bandData.getMemberCount();if((!this._excludedUserNos||0==this._excludedUserNos.length)&&i<=1e3){var s=this._bandData.getCoverUrl();n.splice(0,0,o.createVirtualMemberForAllMemberSelection(s,i))}this.reset(n)}),this))},_resetAsSearchedMembers:function(e,n){return s.searchMember(e,this._bandNo,a.ATTENDANCE_CHECK).then(t.bind((function(e){var t=this._makeModels(e.members,n);this.reset(t)}),this))},_makeModels:function(e,n){return t.chain(e).filter(t.bind((function(e){return this._excludedUserNos.indexOf(e.user_no)<0}),this)).map(t.bind((function(e){var t=new o(e,{parse:!0});return n.indexOf(t.get("userNo"))>=0?t.setSelected(!0):t.setSelected(!1),t}),this)).value()}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2285),s=n(486),a=n(563),r=n(26),l=n(1012),c=n(154),d=n(884),u=n(906),h=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorAddonAttachView"},template:t.template(o),ui:{addonLoadingRegion:"._addonLoadingRegion",addonEditorIframe:"._addonEditorIframe"},regions:{addonLoadingRegion:"@ui.addonLoadingRegion"},initialize:function(e){this._allowedAddonModel=e.allowedAddon,this._modificationMode=1==e.modificationMode,this._modificationMode?(this._bandNo=e.bandNo,this._postNo=e.postNo,this._postAddonId=e.postAddonId,this._oneTimeToken=e.oneTimeToken,this._dataFetched=!t.isEmpty(this._oneTimeToken)):this._dataFetched=!0},serializeData:function(){var e={dataFetched:this._dataFetched,addonName:this._allowedAddonModel.getLocaleName()};if(!this._dataFetched)return e;var n="";return n=this._modificationMode?this._allowedAddonModel.makeModifyUri(this._oneTimeToken):this._allowedAddonModel.makeCreateUri(),t.extend(e,{addonUri:n})},onDomRefresh:function(){this.showChildView("addonLoadingRegion",l.view({loadingSize:l.Size.MEDIUM,middleClass:l.MiddleClass.AREA_VERTICAL_MIDDLE,className:"-h360"}))},onAttach:function(){this._modificationMode&&!this._oneTimeToken&&c.wrapActivePromise(d.getAddonToken(this._bandNo,this._postNo,this._postAddonId,"MODIFY"),this).then(t.bind((function(e){this._oneTimeToken=e.token_info.oneTimeToken,this._dataFetched=!0,this.render()}),this),t.bind((function(){this.destroy()}),this)),this._bindAddonEvent(),this._bindRouteEvent()},_bindAddonEvent:function(){this.listenTo(r.getAddonChannel(),r.ADDON_EVENT.ADDON_SUBMIT,(function(e,n){if(!t.isEmpty(n)){var i={summary:t.extend({},n,{addonType:this._allowedAddonModel.getAddonType()})};null!=this._postAddonId&&(i.postAddonId=this._postAddonId);var o=a.createAddonByJSON(i);this.trigger(h.EVENT.ADDON_SUBMIT,o),this.destroy()}})),this.listenTo(r.getAddonChannel(),r.ADDON_EVENT.ADDON_CONTENT_EXIST,(function(e){this._addonContentExist=e})),this.listenTo(r.getAddonChannel(),r.ADDON_EVENT.ADDON_WRITING_CLOSED,(function(){this.isDestroyed()||this._addonContentExist&&!confirm(IM("web.postwrite.confirm.write_cancel"))||this.destroy()})),this.listenToOnce(r.getAddonChannel(),r.ADDON_EVENT.ADDON_RENDER_FINISHED,(function(){this.getRegion("addonLoadingRegion").empty(),this.ui.addonEditorIframe.css("height","100%")}))},_bindRouteEvent:function(){this.listenTo(r.getDGlobalChannel(),r.EVENT.BEFORE_ROUTE,r.EVENT.BEFORE_ROUTE,(function(e){this._addonContentExist&&!confirm(IM("web.postwrite.confirm.write_cancel"))&&(e.preventRoute=!0)}))}});return h.openAddonAttachLayer=function(e,t,n,i,o,a){var r=new h({allowedAddon:e,modificationMode:t,bandNo:n,postNo:i,postAddonId:o,oneTimeToken:a});return s.openWithoutHiding(r),r},h.EVENT={ADDON_SUBMIT:u.EVENT.ATTACH},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1150),s=n(26),a=n(563);return i.Behavior.extend({ui:{btnChangeAlbum:"._btnChangeAlbum"},events:{"click @ui.btnChangeAlbum":function(){var e=this._richPostModel.get("album");this._editor.focusManager.lock();var n=o.openAlbumSelectView({bandNo:this._richPostModel.get("band").get("bandNo"),saveButtonText:IM("web.modal.btn.confirm"),transparentMode:!0,initAlbumNo:e?e.get("albumNo"):null});this.listenTo(n,"select:album",t.bind((function(e,t){this._richPostModel.set("album",a.createAlbum({album_no:t})),this._editor.focusManager.unlock(),n.destroy(),s.getPostChannel().trigger(s.EVENT.POST_ALBUM_CHANGED)}),this))}},initialize:function(e){this._richPostModel=e.postModel,this._editor=e.editor,this.listenTo(s.getPostChannel(),s.EVENT.POST_ALBUM_CHANGED,t.bind((function(){this.getUI("btnChangeAlbum").text(IM("change_album"))}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(2),o=n(0),s=n(4),a=n(2315),r=n(1559),l=n(1631),c=n(155),d=n(1052),u=n(486),h=n(154),p=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DBandFolderItemView"},template:o.template(a),ui:{newFolderBtn:"._newFolderBtn",folderList:"._folderList",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},regions:{folderList:{el:"@ui.folderList",replaceElement:!0}},events:{"click @ui.newFolderBtn":"_createFolder","click @ui.cancelBtn":"_cancel","click @ui.confirmBtn":"_confirm"},childViewEvents:{"folder:checked":function(e){this._selectFolder(e.folder,e.checked)}},initialize:function(e){this._bandData=e.bandData,this._folders=e.folders,this._folder=e.folder,this._folderId=e.folderId||null,this._folder&&(this._folderId=this._folder.getFolderId()),this._bandNo=this._bandData.getBandCore().bandNo},serializeData:function(){return{newFolderBtn:this._bandData.isCreateAlbumPermitted()}},onRender:function(){this._toggleConfirmBtn(),this._renderFolderList()},_renderFolderList:function(){this._folders.sortByNameAsc(),this._folderListView=l.buildFolderListView({collection:this._folders,bandData:this._bandData,checkable:!0,folderId:this._folderId}),this.showChildView("folderList",this._folderListView)},_createFolder:function(){var e=d.openFolderCreationModel(this._bandNo);h.wrapActivePromise(e,this).then(o.bind((function(e){this.listenToOnce(this._folderListView,"add:child",(function(e,t){var n=t.el;o.isFunction(n.scrollIntoView)&&n.scrollIntoView({block:"nearest",behavior:"smooth"})})),this._folders.add(e),this._selectFolder(e,!0)}),this))},_selectFolder:function(e,t){this._folder=t?e:null,this._folderId=t?e.getFolderId():null,this._toggleConfirmBtn(),t&&this._folders.each((function(e){e.trigger("folder:checked",e.getFolderId()===this._folderId)}),this)},_toggleConfirmBtn:function(){var e=!this._folderId;this.ui.confirmBtn.prop("disabled",e)},_cancel:function(){this.trigger("cancel"),this.destroy()},_confirm:function(){this._folderId&&(this.trigger("confirm",{folder:this._folder,folderId:this._folderId}),this.destroy())}});p.openFolderSelectLayer=function(e){var t=e.bandNo,n=c.get(t),s=r.build(),a=n.loadBandData(),l=s.fetchFolders(t),d=new p(o.extend({},e,{bandData:n,folders:s})),h=i.when(a,l);return u.openPromiseView(h,!0,{width:360,height:396,view:d}),d},e.exports=p},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=n(4),a=n(2329),r=n(2330),l=n(2334),c=n(152),d=n(1115),u=n(1116),h=n(2336),p=n(43),m=n(486),_=n(165),g=n(167),f=n(166),b=n(906),v={ATTACH:b.EVENT.ATTACH,CANCEL:b.EVENT.CANCEL},A="YYYY-MM-DD",E=3,T=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorSignupAttachView"},template:i.template(a),templateContext:function(){var e=this._richPostModel.getBandCore();return{cid:this.cid,titleMaxLength:c.SIGNUP_TITLE_MAX_LENGTH,msg_showAddMemberOption:e&&e.supportPostSignupChildMember(),childMemberLimitCount:1e3}},ui:{typeGuide:"._typeGuide",scrollArea:"._scrollArea",titleWrap:"._titleWrap",titleInput:"._titleInput",importBtn:"._importBtn",startDateLabel:"._startDateLabel",startDateRegion:"._startDateRegion",timeZoneWrap:"._timeZoneWrap",timeZoneLabel:"._timeZoneLabel",timeZoneRegion:"._timeZoneRegion",taskListRegion:"._taskListRegion",addTaskBtn:"._addTaskBtn",childMemberCheckbox:"._childMemberCheckbox",childMemberLimitWrap:"._childMemberLimitWrap",childMemberLimitInput:"._childMemberLimitInput",endedAtCheckbox:"._endedAtCheckbox",endedAtRegion:"._endedAtRegion",attachBtn:"._attachBtn",closeBtn:"._closeBtn",signupGuideBtn:"._signupGuideBtn"},events:{"input @ui.titleInput":"_toggleAttachBtn","click @ui.importBtn":"_openImportLayer","click @ui.addTaskBtn":"_addTask","change @ui.childMemberCheckbox":"_toggleChildMemberLimitWrap","change @ui.endedAtCheckbox":"_toggleEndedAt","click @ui.attachBtn":"_attach","click @ui.closeBtn":"_cancel","focus @ui.titleInput":function(){this.ui.titleWrap.addClass("-focus")},"blur @ui.titleInput":function(){this.ui.titleWrap.removeClass("-focus")},"blur @ui.childMemberLimitInput":function(){var e=o.trim(this.ui.childMemberLimitInput.val()),t=parseInt(e);t?t<1?t=1:t>1e3&&(t=1e3):t="",this.ui.childMemberLimitInput.val(t)},"click @ui.signupGuideBtn":function(e){var n=this.$("#"+t(e.currentTarget).attr("aria-controls")),i="none"!=n.css("display");n.is(this.ui.typeGuide)?this._toggleTypeGuide(!1):n.css("display",i?"none":"block").attr("aria-hidden",i?"false":"true")}},regions:{startDateRegion:{el:"@ui.startDateRegion",replaceElement:!1},timeZoneRegion:{el:"@ui.timeZoneRegion",replaceElement:!1},endedAtRegion:{el:"@ui.endedAtRegion",replaceElement:!1},taskListRegion:{el:"@ui.taskListRegion",replaceElement:!0}},childViewEvents:function(){var e={};return e[u.EVENT.DATE_CHANGED]=function(e){var t=this._startAt,n=e.value||null,i=!!(!!t^!!n);!i||n||!this.model.hasSignupTaskContainingTimeAttributes()||confirm(IM("signup.editor.start_date_delete_confirm"))?(i&&(this._timeZoneId=n?_.getCurrentTimezoneId():null,this._toggleTimeZone()),this._startAt=n?p.tz(n,A,this._timeZoneId).valueOf():null,this._setSignupTaskListOptions()):this.getChildView("startDateRegion").setValue(p.tz(t,this._timeZoneId).format(A))},e[h.EVENT.TIMEZONE_CHANGED]=function(e){var t=p.tz(this._startAt,this._timeZoneId).format(A);this._startAt=p.tz(t,A,e).valueOf(),this._timeZoneId=e,this._endedAt&&(this._endedAt=this._getEndedAtDefaultValue(),this._toggleEndedAt()),this._setSignupTaskListOptions()},e[r.EVENT.EDIT_COMPLETE]="_toggleAttachBtn",e[d.EVENT.DATE_TIME_CHANGED]=function(e){this._endedAt=this._parseDateTimeInputValue(e).valueOf()},e},initialize:function(e){this._richPostModel=e.richPostModel},onRender:function(){var e=E-this.model.getSignupTaskCount();e>0&&this.model.addSignupTasks(e),this._startAt=this.model.get("startAt"),this._timeZoneId=this.model.get("timeZoneId"),this._endedAt=this.model.get("endedAt"),this.ui.titleInput.val(this.model.get("title")),this.ui.childMemberLimitInput.val(this.model.get("childMemberLimit")||""),this.ui.childMemberCheckbox.prop("checked",!!this.model.get("isChildMemberAddible")),this.ui.endedAtCheckbox.prop("checked",!!this.model.get("endedAt")),this._toggleTypeGuide(!0),this._renderStartDate(),this._toggleTimeZone(),this._renderTaskList(),this._toggleAddTaskBtn(),this._toggleChildMemberLimitWrap(),this._toggleEndedAt(),this._toggleAttachBtn()},onAttach:function(){this.ui.titleInput.focus()},_toggleTypeGuide:function(e){var t=g.getCurrentUserEnvStorage(),n=[f.SignupHelpClosed];t.get(n)||(e?this.ui.typeGuide.css("display","block").attr("aria-hidden","false"):(this.ui.typeGuide.css("display","none").attr("aria-hidden","true"),t.set(n,!0)))},_attach:function(){var e={title:o.trim(this.ui.titleInput.val()),startAt:this._startAt,timeZoneId:this._timeZoneId,endedAt:this._endedAt,isChildMemberAddible:this.ui.childMemberCheckbox.prop("checked"),childMemberLimit:parseInt(this.ui.childMemberLimitInput.val())||null};this.model.setSignupToEditedAttributes(e),this.trigger(v.ATTACH,this.model),this._closeSelf()},_cancel:function(){this.trigger(v.CANCEL),this._closeSelf()},_closeSelf:function(){m.closeTop()},_toggleAttachBtn:function(){var e=!this._isAttachable();this.ui.attachBtn.prop("disabled",e).toggleClass("-disabled",e)},_isAttachable:function(){return""!=o.trim(this.ui.titleInput.val())&&this.model.getSignupActualTaskCount()>0},_openImportLayer:function(){l.openAsLayer(this._richPostModel).then(i.bind((function(e){this.listenTo(e,l.EVENT.SELECTED,(function(e){var t=e.startAt,n=e.timeZoneId,o=e.endedAt,s=n?p().tz(n).startOf("day"):p().startOf("day");this._isAttachable()&&!confirm(IM("web.postwrite.form_attendance_check.prev_attendance_check_import_confirm"))||(t&&t<=s.valueOf()&&(e.startAt=s.add(1,"days").valueOf(),i.each(e.tasks,(function(e){var t=e.startAt,n=e.endAt,i=t?p.tz(t,this.timeZoneId):null,o=n?p.tz(n,this.timeZoneId):null;i&&(e.startAt=p.tz(this.startDate,this.timeZoneId).set({hour:i.hour(),minute:i.minute()}).valueOf()),o&&(e.endAt=p.tz(this.startDate,this.timeZoneId).set({hour:o.hour(),minute:o.minute()}).valueOf())}),{startDate:e.startAt,timeZoneId:n})),o&&o<=p().valueOf()&&(e.endedAt=this._getEndedAtDefaultValue()),this.model.setSignupToPreviousAttributes(e),this.render(),m.closeTop())}))}),this))},_addTask:function(){this.model.getSignupTaskCount()<c.SIGNUP_TASK_MAX_ADD_COUNT&&(this.model.addSignupTasks(),this._scrollToBottom()),this._toggleAddTaskBtn()},_toggleAddTaskBtn:function(){this.ui.addTaskBtn.toggle(this.model.getSignupTaskCount()<c.SIGNUP_TASK_MAX_ADD_COUNT)},_scrollToBottom:function(){this.ui.scrollArea.stop().animate({scrollTop:this.ui.scrollArea.prop("scrollHeight")-this.ui.scrollArea.height()})},_toggleChildMemberLimitWrap:function(){var e=this.ui.childMemberCheckbox.prop("checked");this.ui.childMemberLimitWrap.toggleClass("-disabled",!e),e?this._scrollToBottom():this.ui.childMemberLimitInput.val("")},_renderStartDate:function(){var e=this._startAt?p.tz(this._startAt,this._timeZoneId).format(A):null,t=u.buildDDateInputView({date:e,placeholder:IM("ui.label.none"),useDateDelete:!0,canTextEdit:!1,format:A});this.showChildView("startDateRegion",t),this.ui.startDateLabel.attr("for",t.getElementId())},_toggleTimeZone:function(){var e=this.getRegion("timeZoneRegion");!!this._timeZoneId?e.hasView()||(e.show(h.build({timezoneId:this._timeZoneId})),this.ui.timeZoneLabel.attr("for",e.currentView.getElementId()),this.ui.timeZoneWrap.removeClass("-disabled")):(this.ui.timeZoneWrap.addClass("-disabled"),this.ui.timeZoneLabel.removeAttr("for"),e.empty())},_setSignupTaskListOptions:function(){this.getChildView("taskListRegion").setSignupTaskListOptions({startDate:this._startAt,timeZoneId:this._timeZoneId})},_renderTaskList:function(){this.showChildView("taskListRegion",r.build({collection:this.model.getSignupTasks(),startDate:this._startAt,timeZoneId:this._timeZoneId}))},_toggleEndedAt:function(){var e=this.getRegion("endedAtRegion"),t=this.ui.endedAtCheckbox.prop("checked");this.ui.endedAtRegion.toggleClass("-disabled",!t),t?(this._endedAt||(this._endedAt=this._getEndedAtDefaultValue()),e.show(d.buildSolarDateInputView({dateTime:this._timeZoneId?p.tz(this._endedAt,this._timeZoneId):p(this._endedAt),canTextEdit:!1,timeMinutesInterval:30,datepickerDirection:d.DATEPICKER_DIRECTION.UP,timepickerDirection:d.TIMEPICKER_DIRECTION.UP,dateValidator:{isValid:i.bind(this._isEndedAtInputValueValid,this),getMinDate:i.bind(this._getEndedAtMinDate,this),getMaxDate:i.bind(this._getEndedAtMaxDate,this)}}))):(e.empty(),this._endedAt=null)},_getEndedAtDefaultValue:function(){return p().add(25,"hours").startOf("minute").valueOf()},_getEndedAtMinDate:function(){var e=p();return this._timeZoneId&&e.tz(this._timeZoneId),e},_getEndedAtMaxDate:function(){var e=p();return this._timeZoneId&&e.tz(this._timeZoneId),e.add(90,"days")},_isEndedAtInputValueValid:function(e){return(e=this._parseDateTimeInputValue(e)).isBefore(this._getEndedAtMinDate())?(alert(IM("postwrite.attach.poll.alert_invalid_ended_at")),!1):!e.isAfter(this._getEndedAtMaxDate())||(alert(IM("todo.set_ended_at.alert_maximum",{maximum:90})),!1)},_parseDateTimeInputValue:function(e){var t=[e.date,e.time].join(" "),n=[e.dateFormat,e.timeFormat].join(" ");return this._timeZoneId?p.tz(t,n,this._timeZoneId):p(t,n)}});return T.EVENT=v,T.openAsLayer=function(e,t){var n=new T({model:e,richPostModel:t});return m.openWithoutHiding(n),n},T}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(4),o=n(43),s=n(2344),a=n(486),r=n(501),l=n(906),c=n(530),d=n(2345),u=n(2347),h=n(2022),p=n(2023),m=i.View.extend({behaviors:function(){var e=this.options.model,t={regionName:"startAtRegion",min:function(e){return Date.now()},max:function(e){return o(Date.now()).add(c.MAX_START_DAY_FROM_NOW_BY_DAY,"day").valueOf()},useDelete:!0,datePlaceholder:IM("quiz.editor.form.start_at.start_immediately"),timePlaceholder:IM("quiz.editor.form.start_at.start_immediately")};(e.isTakenMemberExist()||e.isQuizStateEnded())&&(t=_.extend({},t,{min:function(e){return e.startAt},max:function(e){return e.startAt},onInvalid:function(){alert(IM("postwrite.attach.poll.alert_voted_member_exist"))},useDelete:!1}));var n={regionName:"endAtRegion",min:function(e){return Date.now()},max:function(e){return o(e.startAt).add(c.MAX_PERIOD_RANGE_BY_DAY,"day").valueOf()}};return e.isQuizStateEnded()&&(n=_.extend({},n,{min:function(e){return e.endAt},max:function(e){return e.endAt}})),[{behaviorClass:h,startAt:t,endAt:n,timeZoneId:{regionName:"timezoneSelectRegion"}},{behaviorClass:p,closeAction:function(){this.trigger(l.EVENT.CANCEL,this.model),this.destroy()},closeWithConfirmMethodName:"closeWithConfirm",serializer:function(){var e=this.model.toJSONForSave();return e.start_at=this.model.get("startAt"),e}}]},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorQuizAttachView"},template:_.template(s),templateContext:function(){return{vid:this.cid}},ui:{title:"._title",checkRandomOrderTest:"._checkRandomOrderTest",checkIsAnswerEssential:"._checkIsAnswerEssential",btnEditQuestions:"._btnEditQuestions",questionCount:"._questionCount",btnSelectTakers:"._btnSelectTakers",btnSelectManagers:"._btnSelectManagers",btnToggleManagerGuide:"._btnToggleManagerGuide",btnCloseManagerGuide:"._btnCloseManagerGuide",wrapManagerGuide:"._wrapManagerGuide",btnComplete:"._btnComplete",btnClose:"._btnClose"},events:{"input @ui.title":function(e){this.model.set("title",e.target.value)},"change @ui.checkRandomOrderTest":function(e){this.model.isTakenMemberExist()?(alert(IM("postwrite.attach.poll.alert_voted_member_exist")),this._renderCheckRandomOrderTest()):this.model.set("isRandomOrderTest",this.$(e.target).is(":checked"))},"change @ui.checkIsAnswerEssential":function(e){this.model.isTakenMemberExist()?(alert(IM("postwrite.attach.poll.alert_voted_member_exist")),this._renderCheckIsAnswerEssential()):this.model.set("isAnswerEssential",this.$(e.target).is(":checked"))},"click @ui.btnEditQuestions":function(){var e=u.openLayer({quiz:this.model,bandData:this.options.bandData});this.listenTo(e,"confirm",(function(){this._renderUIs()}))},"click @ui.btnSelectTakers":function(){this._openEditTakerList()},"click @ui.btnToggleManagerGuide":function(){this.getUI("wrapManagerGuide").toggle()},"click @ui.btnCloseManagerGuide":function(){this.getUI("wrapManagerGuide").hide()},"click @ui.btnSelectManagers":function(){this._openEditManagerList()},"click @ui.btnComplete":"_onComplete","click @ui.btnClose":"closeWithConfirm"},regions:{startAtRegion:"._startAtRegion",endAtRegion:"._endAtRegion",timezoneSelectRegion:"._timezoneSelectRegion"},modelEvents:{"change:title":"_renderButtons",changeTakers:"_renderUIs",changeManagers:"_renderUIs"},onRender:function(){this._renderUIs()},layerOnEscKeyDown:function(){this.closeWithConfirm()},_renderUIs:function(){this._renderQuestionCount(),this._renderCheckRandomOrderTest(),this._renderCheckIsAnswerEssential(),this._renderTakerNumbers(),this._renderManagerNumbers(),this._renderButtons()},_openEditTakerList:function(){if(this.model.isTakenMemberExist())alert(IM("postwrite.attach.poll.alert_voted_member_exist"));else{var e=_.bind((function(){return new Backbone.Collection(this.model.get("takers").map((function(e){return e.get("taker")})))}),this),t=d.openLayer({collection:e(),bandData:this.options.bandData,useRemoveAll:!0});this.listenTo(t,d.EVENT.ADD_ENTRIES,(function(n){var i=_.partition(n,_.bind((function(e){return this.model.get("managers").findWhere({userNo:e.get("userNo")})}),this));i[0].length>0&&alert(IM("quiz.editor.form.alert.cannot_add_manager_to_taker")),this.model.addTakers(i[1]),t.renderCollection(e())})),this.listenTo(t,d.EVENT.REMOVE_ENTRY,(function(n){this.model.removeTaker(n),t.renderCollection(e())})),this.listenTo(t,d.EVENT.REMOVE_ALL_ENTRIES,(function(){this.model.removeAllTakers(),t.renderCollection(e())}))}},_openEditManagerList:function(){if(this.model.isQuizStateOpened())alert(IM("postwrite.attach.poll.alert_voted_member_exist"));else{var e=_.bind((function(){var e=this.options.bandData.getMembershipMemberProfile(),t=new r(e,{parse:!0});return new Backbone.Collection([t].concat(this.model.get("managers").map(_.identity)))}),this),t=d.openLayer({title:IM("quiz.editor.form.manager.title"),collection:e(),bandData:this.options.bandData,useRemoveAll:!1});this.listenTo(t,d.EVENT.ADD_ENTRIES,(function(n){var i=_.partition(n,_.bind((function(e){return this.model.get("takers").find((function(t){return t.get("taker").get("userNo")===e.get("userNo")}))}),this));i[0].length>0&&alert(IM("quiz.editor.form.alert.cannot_add_taker_to_manager")),this.model.addManagers(i[1]),t.renderCollection(e())})),this.listenTo(t,d.EVENT.REMOVE_ENTRY,(function(n){this.model.removeManager(n),t.renderCollection(e())}))}},_renderQuestionCount:function(){var e=this.model.get("questions").length>0?IM("quiz.editor.form.question_count.label",{count:this.model.get("questions").length}):"";this.getUI("questionCount").html(e)},_renderCheckRandomOrderTest:function(){this.getUI("checkRandomOrderTest").prop("checked",this.model.get("isRandomOrderTest"))},_renderCheckIsAnswerEssential:function(){this.getUI("checkIsAnswerEssential").prop("checked",this.model.get("isAnswerEssential"))},_renderTakerNumbers:function(){var e=this.model.get("takers").length,t=e>0?IM("ui.label.selected_member_count",{count:e}):IM("ui.label.add");this.getUI("btnSelectTakers").html(t)},_renderManagerNumbers:function(){var e=this.model.get("managers").length,t=e>0?IM("ui.label.selected_member_count",{count:e+1}):IM("postwrite.attach.label.only_author");this.getUI("btnSelectManagers").html(t)},_renderButtons:function(){this.getUI("btnComplete").prop("disabled",!this.model.isValid())},_onComplete:function(){var e=this.model.get("startAt")||Date.now();e>this.model.get("endAt")?alert(IM("quiz.editor.form.confirm.start_must_before_end")):o(e).add(c.MAX_PERIOD_RANGE_BY_DAY,"day").valueOf()<this.model.get("endAt")?alert(IM("quiz.editor.form.confirm.end_must_within_range")):this.model.isTakersEmpty()&&!confirm(IM("quiz.editor.form.confirm.save_without_takers"))||(this.trigger(l.EVENT.ATTACH,this.model),this.destroy())}});m.openLayer=function(e,t){var n=new m({model:e,bandData:t});return a.openWithoutHiding(n),n},e.exports=m},function(e,t,n){var i=n(0),o=n(6),s=n(780),a=n(493),r=o.Collection.extend({model:s,initialize:function(e,t){this._bandData=t.bandData,this._excludedUserNos=t.excludedUserNos||[],this._hasMemberGroup=!1,this._memberOfBandFilterType=t.memberOfBandFilterType},isExcludedUserNo:function(e){return i.contains(this._excludedUserNos,e)},hasMemberGroup:function(){return this._hasMemberGroup},fetchAllMembers:function(){return a.getBandMembersOfBandWithFilter(this._bandData.getBandCore().bandNo,this._memberOfBandFilterType).then(i.bind((function(e){var t=this._makeModels(e.members);if(this._hasMemberGroup=!0===e.has_member_group,t.length>1){var n=this._bandData.getCoverUrl();t.splice(0,0,s.createVirtualMemberForAllMemberSelection(n,t.length))}this.reset(t)}),this))},_makeModels:function(e){return i.chain(e).filter(i.bind((function(e){return this._excludedUserNos.indexOf(e.user_no)<0}),this)).map(i.bind((function(e){return new s(e,{parse:!0})}),this)).value()}});r.createSimpleMemberLocalSearchCollection=function(e){return new r(null,{bandData:e.bandData,excludedUserNos:e.excludedUserNos,memberOfBandFilterType:e.memberOfBandFilterType})},e.exports=r},function(e,t,n){var i=n(0),o=n(10),s=n(4),a=n(2353),r=n(156),l=s.View.extend({EVENT:{DELETE:"DELETE"},tagName:"div",className:"attachmentFile",attributes:{"data-viewname":"DQuizQuestionFileEditView"},template:i.template(a),ui:{deleteBtn:"._deleteBtn"},events:{"click @ui.deleteBtn":function(){this.trigger(this.EVENT.DELETE)}},initialize:function(e){this._file=e.file,this._audio=e.audio,this._deletable=e.deletable},serializeData:function(){return{isAudio:!!this._audio,fileName:this._getFileName(),fileSize:this._getFileSize(),deleteBtn:this._deletable}},_getFileName:function(){return this._file?this._file.fileName:IM("ui.label.audio_file")},_getFileSize:function(){if(this._file)return r.toStringFileSize(this._file.fileSize);var e=this._audio.audioDuration;return o.lpad(Math.floor(e/60),2,"0")+":"+o.lpad(e%60,2,"0")}});l.build=function(e){return new l(e)},e.exports=l},function(e,t,n){var i=n(0),o=n(10),s=n(4),a=n(2358),r=n(1632),l=n(2016),c=n(2018),d=n(530),u="CHOICE",h="ESSAY",p=s.View.extend({EVENT:{UPDATE:"UPDATE"},tagName:"div",className:"questionInputBox",attributes:{"data-viewname":"DQuizQuestionTitleEditView"},template:i.template(a),ui:{title:"._title",attachment:"._attachment"},regions:{attachment:{el:"@ui.attachment",replaceElement:!0}},events:{"input @ui.title":"_updateTitle","click @ui.title":"_checkEditable"},initialize:function(e){this._style=e.style,this._editContext=e.editContext,this._title=e.title,this._attachment={image:e.image,video:e.video,file:e.file,audio:e.audio}},serializeData:function(){return{maxlength:d.QUESTION_TITLE_MAX_LENGTH,title:this._title}},onRender:function(){this._setHeight(),this._setEditable(),this._renderAttachmentView()},onAttach:function(){this.ui.title.focus()},_setHeight:function(){var e=this._style===u?"56px":"115px";this.ui.title.css("height",e)},_setEditable:function(){var e=this._editContext.isTakenMemberExist();this.ui.title.prop("readonly",e)},_renderAttachmentView:function(){this.showChildView("attachment",this._buildAttachmentView())},_checkEditable:function(e){this._editContext.alertTakenMemberExist()&&e.preventDefault()},_updateTitle:function(){this._title=o.trim(this.ui.title.val()).substring(0,d.QUESTION_TITLE_MAX_LENGTH),this._triggerUpdateEvent()},_updateAttachment:function(e){this._editContext.alertTakenMemberExist()||(this._attachment=i.defaults(e,{image:null,video:null,file:null,audio:null}),this._renderAttachmentView(),this._triggerUpdateEvent())},_deleteAttachment:function(){this._updateAttachment(null)},_triggerUpdateEvent:function(){var e=i.extend({title:this._title},this._attachment);this.trigger(this.EVENT.UPDATE,e)},_buildAttachmentView:function(){return this._attachment.image||this._attachment.video?this._buildImageEditView():this._attachment.file||this._attachment.audio?this._buildFileEditView():this._buildButtonGroupView()},_buildImageEditView:function(){var e=r.build({image:this._attachment.image,video:this._attachment.video,deletable:!0});return this.listenTo(e,e.EVENT.DELETE,this._deleteAttachment),e},_buildFileEditView:function(){var e=l.build({file:this._attachment.file,audio:this._attachment.audio,deletable:!0});return this.listenTo(e,e.EVENT.DELETE,this._deleteAttachment),e},_buildButtonGroupView:function(){var e=c.build({uploadVideo:!0,uploadFile:!0,editContext:this._editContext});return this.listenTo(e,e.EVENT.UPLOAD,this._updateAttachment),e}});p.buildChoiceStyle=function(e){return new p(i.extend({},e,{style:u}))},p.buildEssayStyle=function(e){return new p(i.extend({},e,{style:h}))},e.exports=p},function(e,t,n){var i=n(0),o=n(4),s=n(2359),a=n(1402),r=n(600),l=n(507),c=n(537),d=n(177),u=n(26),h=!!(window.File&&window.URL&&window.URL.createObjectURL&&window.URL.revokeObjectURL),p=d.VIDEO.MAX_RUNNING_SECS.SEC_1800,m=d.AUDIO.MAX_RUNNING_SECS.SEC_1800,_=d.AUDIO.TARGET_PROFILE.AUDIO_16_8,g=o.View.extend({EVENT:{UPLOAD:"UPLOAD",DELETE:"DELETE"},tagName:"div",className:"btnUploadWrap",attributes:{"data-viewname":"DQuizQuestionEditButtonGroupView"},template:i.template(s),ui:{imageInput:"._imageInput",fileMenuBtn:"._fileMenuBtn",fileMenuBox:"._fileMenuBox",fileInput:"._fileInput",audioInput:"._audioInput",deleteBtn:"._deleteBtn"},events:{"click @ui.imageInput":"_checkEditable","click @ui.fileMenuBtn":"_toggleFileMenu","click @ui.deleteBtn":function(){this.trigger(this.EVENT.DELETE)}},initialize:function(e){this._uploadImage=e.uploadImage||!1,this._uploadVideo=e.uploadVideo||!1,this._uploadFile=e.uploadFile||!1,this._handleClassName=e.handleClassName||null,this._deleteBtn=e.deleteBtn||!1,this._editContext=e.editContext,this._audioDuration=null},serializeData:function(){return{uploadImage:this._uploadImage||this._uploadVideo,uploadFile:this._uploadFile,handleClassName:this._handleClassName,deleteBtn:this._deleteBtn}},onBeforeRender:function(){this._destroyUploader()},onRender:function(){this._createUploader()},onAttach:function(){this.listenTo(u.getDGlobalChannel(),u.EVENT.HTML_CLICK,this._hideAllMenu)},onBeforeDetach:function(){this.stopListening(u.getDGlobalChannel()),this._destroyUploader()},_checkEditable:function(e){this._editContext.alertTakenMemberExist()&&e.preventDefault()},_toggleFileMenu:function(){this._editContext.alertTakenMemberExist()||"none"===this.ui.fileMenuBox.css("display")&&i.defer(i.bind((function(){this.ui.fileMenuBox.css("display","")}),this))},_hideAllMenu:function(){this.ui.fileMenuBox.css("display","none")},_triggerUploadEvent:function(e){this.trigger(this.EVENT.UPLOAD,e)},_createUploader:function(){this._editContext.isTakenMemberExist()||(this._uploadVideo?this._createPhotoOrVideoUploader():this._uploadImage&&this._createPhotoUploader(),this._uploadFile&&(this._createFileUploader(),this._createAudioUploader()))},_destroyUploader:function(){this._destroyPhotoUploader(),this._destroyFileUploader(),this._destroyAudioUploader()},_createPhotoUploader:function(){this._destroyPhotoUploader(),this._photoUploader=a.createUploader({element:this.ui.imageInput,skinColor:this._editContext.getSkinColorClass()}),this.listenTo(this._photoUploader,"complete",(function(e){var t=e[0];t&&this._triggerUploadEvent({image:t})}))},_createPhotoOrVideoUploader:function(){this._destroyPhotoUploader(),this._photoUploader=r.createPhotoOrVideoUploader(this.ui.imageInput,{multiple:!1,autoUpload:!0,skinColor:this._editContext.getSkinColorClass(),fileInputTitle:IM("albumdetail.media.btn.select"),data:{maxRunningSecs:p}}),this.listenTo(this._photoUploader,l.BEFORE_VALIDATE,(function(){this._photoUploader.setValidators([function(e){return c.isVideoType(e[0])?c.VIDEO_VALIDATOR(e,0,1,IM("upload_video.over_limit",{count:1})):c.PHOTO_VALIDATOR(e,0,1)}])})),this.listenTo(this._photoUploader,l.UPLOAD_COMPLETE,(function(e){var t=e.resultList[0];if(t)if(t.isVideo||t.isGifVideo){var n={sosId:t.id,url:t.url,width:t.width,height:t.height,isGif:t.isGifVideo,expiredAt:0};this._triggerUploadEvent({video:n})}else{var i={url:t.url,width:t.width,height:t.height};this._triggerUploadEvent({image:i})}}))},_createFileUploader:function(){this._destroyFileUploader(),this._fileUploader=r.createFileUploader(this.ui.fileInput,{multiple:!1,skinColor:this._editContext.getSkinColorClass(),fileInputTitle:IM("web.postwrite.attach.d_title.file"),validators:[i.partial(c.FILE_VALIDATOR,i,0,1,52428800)]}),this.listenTo(this._fileUploader,l.UPLOAD_COMPLETE,(function(e){var t=e.resultList[0];if(t){var n={sosId:t.id,fileName:t.name,fileSize:t.file_size};this._triggerUploadEvent({file:n})}}))},_createAudioUploader:function(){this._destroyAudioUploader(),this._audioUploader=r.createAudioUploader(this.ui.audioInput,{multiple:!1,skinColor:this._editContext.getSkinColorClass(),fileInputTitle:IM("web.postwrite.attach.d_title.file"),validators:[i.partial(c.AUDIO_VALIDATOR,i,0,1,10485760)],data:{maxRunningSecs:m,targetProfile:_}}),this.listenTo(this._audioUploader,l.SELECT_FILES,(function(e){var t=e.files[0];if(e.event.preventDefault(),!h)return this._createAudioUploader(),void alert(IM("web.upload.validation.alert.file_format"));var n=window.URL.createObjectURL(t),o=document.createElement("audio"),s=$(o);s.one({loadedmetadata:i.bind((function(){if(this._audioDuration=Math.floor(o.duration||0),s.remove(),window.URL.revokeObjectURL(n),this._audioDuration<=0||this._audioDuration>1800)return this._createAudioUploader(),void alert(IM("web.upload.validation.alert.file_format"));this._audioUploader.resume(e)}),this),error:i.bind((function(){s.remove(),window.URL.revokeObjectURL(n),this._createAudioUploader(),alert(IM("web.upload.validation.alert.file_format"))}),this)}),o.src=n})),this.listenTo(this._audioUploader,l.UPLOAD_COMPLETE,(function(e){var t=e.resultList[0];if(t){var n={sosId:t.audio.sos_id,audioDuration:this._audioDuration};this._triggerUploadEvent({audio:n})}}))},_destroyPhotoUploader:function(){this._photoUploader&&(this._photoUploader.destroy(),this._photoUploader=null)},_destroyFileUploader:function(){this._fileUploader&&(this._fileUploader.destroy(),this._fileUploader=null)},_destroyAudioUploader:function(){this._audioUploader&&(this._audioUploader.destroy(),this._audioUploader=null)}});g.build=function(e){return new g(e)},e.exports=g},function(e,t,n){var i=n(0),o=n(4),s=n(2360),a=o.View.extend({EVENT:{UPDATE:"UPDATE"},tagName:"div",className:"createSetting",attributes:{"data-viewname":"DQuizQuestionPointEditView"},template:i.template(s),ui:{total:"._total",point:"._point"},events:{"input @ui.point":"_updatePoint","click @ui.point":"_checkEditable"},initialize:function(e){this._point=e.point,this._total=e.total,this._editContext=e.editContext},serializeData:function(){return{total:this._getTotalText(),point:this._point}},onRender:function(){this._setEditable()},_setEditable:function(){var e=this._editContext.isTakenMemberExist();this.ui.point.prop("readonly",e)},_getTotalText:function(){var e=this._total+this._point;return IM("question.edit.input.total_point",{point:e||"0"})},_checkEditable:function(e){this._editContext.alertTakenMemberExist()&&e.preventDefault()},_updatePoint:function(){var e=parseInt(this.ui.point.val());(!i.isFinite(e)||e<0)&&(e=0),this._point=e,this.ui.total.html(this._getTotalText()),this.trigger(this.EVENT.UPDATE,this._point)}});a.build=function(e){return new a(e)},e.exports=a},function(e,t,n){var i=n(2),o=n(0),s=n(555);function a(e){this._element=i(e.element),this._maxlength=e.maxlength,this._newline=!0===e.newline,this._onInput=e.onInput||o.noop(),this._element.on({input:o.bind(this._handleInputEvent,this),keydown:o.bind(this._handleKeydownEvent,this),paste:o.bind(this._handlePasteEvent,this),cut:o.bind(this._handleCutEvent,this)})}n(56),a.prototype._handleInputEvent=function(){var e,t=this._element.text()||"";t.length>this._maxlength&&(e=this._getEditorCaretPosition(),t=t.substring(0,this._maxlength),this._element.text(t),this._setEditorCaratPosition(e)),this._onInput(t)},a.prototype._handleKeydownEvent=function(e){e.keyCode!==s.ENTER||this._newline||e.preventDefault(),this._triggerInputEvent(!0)},a.prototype._handlePasteEvent=function(e){var t,n=e.originalEvent;e.preventDefault(),n.clipboardData&&n.clipboardData.getData?(t=n.clipboardData.getData("text/plain"),t=this._convertPastedText(t),document.execCommand("insertText",!1,t)):window.clipboardData&&window.clipboardData.getData&&(t=window.clipboardData.getData("Text"),t=this._convertPastedText(t),this._insertTextToInputAtCursor(t)),this._triggerInputEvent(!1)},a.prototype._handleCutEvent=function(){this._triggerInputEvent(!0)},a.prototype._triggerInputEvent=function(e){i.browser.msie&&(e?o.defer(o.bind((function(){this._element.trigger("input")}),this)):this._element.trigger("input"))},a.prototype._insertTextToInputAtCursor=function(e){var t=window.getSelection().getRangeAt(0);t.deleteContents(),t.insertNode(document.createTextNode(e))},a.prototype._convertPastedText=function(e){return e||(e=""),this._newline||(e=e.trim().replace(/\r?\n/g,"")),e.substring(0,this._maxlength)},a.prototype._getEditorCaretPosition=function(){var e=window.getSelection().getRangeAt(0),t=e.cloneRange();return t.selectNodeContents(this._element.get(0)),t.setEnd(e.endContainer,e.endOffset),t.toString().length},a.prototype._setEditorCaratPosition=function(e){e>this._maxlength&&(e=this._maxlength),window.getSelection().collapse(this._element.get(0).firstChild,e)},a.setMaxLength=function(e){new a(e)},e.exports=a},function(e,t,n){var i=n(2),o=n(0),s=n(555);function a(e){this._itemEl=i(e.itemEl),this._selector=e.selector,this._nextKey=e.nextKey||-1,this._nextKeyOptions=e.nextKeyOptions||{},this._onLast=e.onLast||o.noop,this._prevKey=e.prevKey||-1,this._prevKeyOptions=e.prevKeyOptions||{},this._onFirst=e.onFirst||o.noop,this._isKeyPressed=!1,this._itemEl.on({keydown:o.bind(this._handleKeydownEvent,this),keyup:o.bind(this._handleKeyupEvent,this)},this._selector)}a.prototype._handleKeydownEvent=function(e){this._isKeyPressed=this._isNextKeyEvent(e)||this._isPrevKeyEvent(e)},a.prototype._handleKeyupEvent=function(e){this._isKeyPressed&&(this._isKeyPressed=!1,this._isNextKeyEvent(e)?this._moveToNextItem():this._isPrevKeyEvent(e)&&this._moveToPrevItem())},a.prototype._isNextKeyEvent=function(e){return this._matches(e,this._nextKey,this._nextKeyOptions)},a.prototype._isPrevKeyEvent=function(e){return this._matches(e,this._prevKey,this._prevKeyOptions)},a.prototype._matches=function(e,t,n){if(t!==e.keyCode)return!1;var i=n.ctrlKey,s=n.altKey,a=n.shiftKey,r=n.metaKey;return(!o.isBoolean(i)||i===e.ctrlKey)&&((!o.isBoolean(s)||s===e.altKey)&&((!o.isBoolean(a)||a===e.shiftKey)&&(!o.isBoolean(r)||r===e.metaKey)))},a.prototype._moveToNextItem=function(){0===this._itemEl.next().length&&this._onLast(),setTimeout(o.bind((function(){this._itemEl.next().find(this._selector).focus()}),this))},a.prototype._moveToPrevItem=function(){0===this._itemEl.prev().length&&this._onFirst(),setTimeout(o.bind((function(){this._itemEl.prev().find(this._selector).focus()}),this))},a.create=function(e){new a(e)},a.createSimpleNextMover=function(e){new a(o.extend({},e,{nextKey:s.ENTER}))},e.exports=a},function(e,t,n){var i=n(4),o=n(43),s=n(1115),a=n(1146),r=n(165),l=n(523),c=i.Behavior.extend({options:{modelToValue:function(e){return{startAt:e.get("startAt"),endAt:e.get("endAt"),timeZoneId:e.get("timeZoneId")}},valueToModel:function(e){return e},startAt:{regionName:"",min:void 0,max:void 0,onSelect:function(e,t){return{startAt:t}},onInvalid:function(e){},useDelete:!1,datePlaceholder:IM("ui.datepicker.placeholder.optional"),timePlaceholder:IM("ui.timepicker.placeholder.optional")},endAt:{regionName:"endAtRegion",min:void 0,max:void 0,onSelect:function(e,t){return{endAt:t}},onInvalid:function(e){},useDelete:!1,datePlaceholder:IM("ui.datepicker.placeholder.optional"),timePlaceholder:IM("ui.timepicker.placeholder.optional")},timeZoneId:{regionName:void 0}},initialize:function(){this._startAtOption=_.extend({},c.prototype.options.startAt,this.options.startAt),this._endAtOption=_.extend({},c.prototype.options.endAt,this.options.endAt)},onRender:function(){this.renderUIs()},renderUIs:function(){this._renderDateTimeInput(this._startAtOption,this._getValue().startAt),this._renderDateTimeInput(this._endAtOption,this._getValue().endAt),this._renderTimezoneSelect()},_getValue:function(){return _.extend({timeZoneId:r.getCurrentTimezoneId()},this.options.modelToValue(this.view.model))},_setValue:function(e){this.view.model.set(this.options.valueToModel(_.extend(this._getValue(),e))),this.renderUIs()},_renderTimezoneSelect:function(){var e=this._getValue().timeZoneId,t=new a({timezoneId:e});this.view.showChildView(this.options.timeZoneId.regionName,t),this.listenTo(this.view.getChildView(this.options.timeZoneId.regionName),a.EVENT.TIMEZONE_CHANGED,(function(e){this._setValue({timeZoneId:e})}))},_createPeriodDateValidator:function(e){var t=_.bind((function(){return this._getValue().timeZoneId}),this),n=_.bind((function(){var t=this._getValue();return o.tz(e.min(t),t.timeZoneId)}),this),i=_.bind((function(){var t=this._getValue();return o.tz(e.max(t),t.timeZoneId)}),this);return{isValid:function(o){var s=l.createMoment(o,t());return!s||(!s.isBefore(n())&&!s.isAfter(i())||(_.isFunction(e.onInvalid)&&e.onInvalid(o),!1))},getMinDate:n,getMaxDate:i}},_renderDateTimeInput:function(e,t){var n=s.buildSolarDateInputView({dateTime:t,timezoneId:this._getValue().timeZoneId,timeMinutesInterval:5,datePlaceholder:e.datePlaceholder,timePlaceholder:e.timePlaceholder,datepickerDirection:s.DATEPICKER_DIRECTION.UP,timepickerDirection:s.TIMEPICKER_DIRECTION.UP,useDatePicker:!0,disableTime:!1,canTextEdit:!1,useDelete:e.useDelete,dateValidator:this._createPeriodDateValidator(e)});this.view.showChildView(e.regionName,n),this.listenTo(n,s.EVENT.DATE_TIME_CHANGED,(function(t){var n=void 0;t.date&&t.time&&(n=l.createMoment(t,this._getValue().timeZoneId).valueOf());var i=e.onSelect(this._getValue(),n);this._setValue(i)}))}});e.exports=c},function(e,t,n){var i=n(0),o=n(4).Behavior.extend({options:{closeAction:function(){this.destroy()},closeWithConfirmMethodName:"closeWithConfirm",serializer:function(){return this.model?this.model.toJSONForSave():{}}},initialize:function(){this.view[this.options.closeWithConfirmMethodName]=i.bind(this._closeWithConfirm,this)},onAttach:function(){this._originalData=this.options.serializer.call(this.view)},_closeWithConfirm:function(){var e=this.options.serializer.call(this.view);(i.isEqual(this._originalData,e)||confirm(IM("confirm.close_without_save")))&&this.options.closeAction.call(this.view)}});e.exports=o},function(e,t,n){var i=n(4),o=n(43),s=n(486),a=n(2373),r=n(501),l=n(906),c=n(2022),d=n(2374),u=n(800),h=n(2388),p=n(2390),m=n(166),g=n(2392),f=n(160),b=n(584),v=n(2023),A=n(622);n(194);var E=i.View.extend({behaviors:function(){var e=this.options.model,t={regionName:"startAtRegion",min:function(e){return Date.now()},max:function(e){return o(Date.now()).add(A.MAX_START_DAY_FROM_NOW_BY_DAY,"day").valueOf()},useDelete:!0,datePlaceholder:IM("survey.editor.form.start_at.start_immediately"),timePlaceholder:IM("survey.editor.form.start_at.start_immediately")};(e.isRespondedMemberExist()||e.isEnded())&&(t=_.extend({},t,{min:function(e){return e.startAt},max:function(e){return e.startAt},onInvalid:function(){alert(IM("postwrite.attach.poll.alert_voted_member_exist"))},useDelete:!1}));var n={regionName:"endAtRegion",min:function(e){return Date.now()},max:function(e){return o(e.startAt||Date.now()).add(A.MAX_PERIOD_RANGE_BY_DAY,"day").valueOf()}};return e.isEnded()&&(n=_.extend({},n,{min:function(e){return e.endAt},max:function(e){return e.endAt}})),[{behaviorClass:c,startAt:t,endAt:n,timeZoneId:{regionName:"timezoneSelectRegion"}},{behaviorClass:v,closeAction:function(){this.trigger(l.EVENT.CANCEL,this.model),this.destroy()},closeWithConfirmMethodName:"closeWithConfirm",serializer:function(){var e=this.model.toJSONForSave();return e.start_at=this.model.get("startAt"),e}}]},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorSurveyAttachView"},template:_.template(a),templateContext:function(){return{vid:this.cid,showSurveyeeQualified:this.options.bandData.getBandCore().supportPostSurveyeeQualified()}},ui:{title:"._title",description:"._description",btnImportPrevSurvey:"._btnImportPrevSurvey",wrapImportHelp:"._wrapImportHelp",btnCloseImportHelp:"._btnCloseImportHelp",btnEditQuestions:"._btnEditQuestions",questionCount:"._questionCount",btnSelectSurveyees:"._btnSelectSurveyees",btnSelectManagers:"._btnSelectManagers",btnToggleManagerGuide:"._btnToggleManagerGuide",btnCloseManagerGuide:"._btnCloseManagerGuide",wrapManagerGuide:"._wrapManagerGuide",btnComplete:"._btnComplete",btnClose:"._btnClose"},events:{"input @ui.title":function(e){this.model.set("title",e.target.value)},"input @ui.description":function(e){this.model.set("description",e.target.value)},"click @ui.btnImportPrevSurvey":"_openImportPrevSurveyLayer","click @ui.btnEditQuestions":function(){var e=d.openLayer({survey:this.model});this.listenTo(e,"confirm",this._renderUIs)},"click @ui.btnSelectSurveyees":"_openEditSurveyeeList","click @ui.btnSelectManagers":"_openEditManagerList","click @ui.btnComplete":"_onComplete","click @ui.btnClose":"closeWithConfirm","click @ui.btnToggleManagerGuide":function(){this.getUI("wrapManagerGuide").toggle()},"click @ui.btnCloseManagerGuide":function(){this.getUI("wrapManagerGuide").hide()}},regions:{importHelpGuideRegion:"._importHelpGuideRegion",startAtRegion:"._startAtRegion",endAtRegion:"._endAtRegion",timezoneSelectRegion:"._timezoneSelectRegion"},modelEvents:{"change:title":"_renderButtons","change:isSurveyeeQualified":"_renderUIs",changeSurveyees:"_renderUIs",changeManagers:"_renderUIs"},onBeforeRender:function(){"string"!=typeof this.ui.description&&this.getUI("description").destroyElastic()},onBeforeDetach:function(){this.getUI("description").destroyElastic()},onRender:function(){this._renderUIs(),this.getUI("description").elastic(),this.showChildView("importHelpGuideRegion",g.buildDHelpGuideView([m.SurveyImportHelpClosed],IM("survey.editor.form.previous_content.description")))},layerOnEscKeyDown:function(){this.closeWithConfirm()},_renderUIs:function(){this._renderQuestionCount(),this._renderSurveyeeNumbers(),this._renderManagerNumbers(),this._renderButtons()},_openImportPrevSurveyLayer:function(){var e=this.options.bandData.getBandNo(),t=p.openAsLayer((function(){return b.getMySurveys(e).then((function(e){return e.items}))}),A.MAX_PREVIOUS_CONTENT_COUNT);this.listenTo(t,"importData:selected",(function(t){this.model.importAPIJson(t,e).then(_.bind(this.render,this))}))},_openEditSurveyeeList:function(){if(this.model.isRespondedMemberExist())alert(IM("postwrite.attach.poll.alert_voted_member_exist"));else{var e=u.openAsLayer({title:IM("survey.editor.form.surveyee.title"),confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:[{label:IM("survey.editor.form.surveyee.select_all"),value:"all"},{label:IM("survey.editor.form.surveyee.select_member"),value:"select"}],initialCheckedValue:this.model.get("isSurveyeeQualified")?"select":"all"});this.listenTo(e,"modal:confirm",(function(e){"all"===e?this.model.set("isSurveyeeQualified",!1):(this.model.set("isSurveyeeQualified",!0),this._openEditSurveyeeMemberEntryLayer())}))}},_openEditSurveyeeMemberEntryLayer:function(){var e=_.bind((function(){return new Backbone.Collection(this.model.get("surveyees").map((function(e){return e.get("surveyee")})))}),this),t=h.openLayer({bandData:this.options.bandData,collection:e(),useRemoveAll:!0,memberOfBandFilterType:f.SURVEY});this.listenTo(t,h.EVENT.ADD_ENTRIES,(function(n){this.model.setSurveyees(n),t.renderCollection(e())})),this.listenTo(t,h.EVENT.REMOVE_ENTRY,(function(n){this.model.removeSurveyee(n),t.renderCollection(e())})),this.listenTo(t,h.EVENT.REMOVE_ALL_ENTRIES,(function(){this.model.removeAllSurveyees(),t.renderCollection(e())}))},_openEditManagerList:function(){var e=_.bind((function(){var e=this.options.bandData.getMembershipMemberProfile(),t=new r(e,{parse:!0});return new Backbone.Collection([t].concat(this.model.get("managers").map(_.identity)))}),this),t=h.openLayer({title:IM("survey.editor.form.manager.title"),bandData:this.options.bandData,collection:e(),useRemoveAll:!1,memberOfBandFilterType:this.options.bandData.getBandCore().getSurveyManagerMemberFilter()});this.listenTo(t,h.EVENT.ADD_ENTRIES,(function(n){this.model.addManagers(n),t.renderCollection(e())})),this.listenTo(t,h.EVENT.REMOVE_ENTRY,(function(n){this.model.removeManager(n),t.renderCollection(e())}))},_renderQuestionCount:function(){var e=this.model.get("questions").length>0?IM("survey.editor.form.question_count.label",{count:this.model.get("questions").length}):"";this.getUI("questionCount").html(e)},_renderSurveyeeNumbers:function(){var e;if(this.model.get("isSurveyeeQualified")){var t=this.model.get("surveyees").length;e=t>0?IM("ui.label.selected_member_count",{count:t}):IM("ui.label.add")}else e=IM("survey.editor.form.surveyee.label.all_selected");this.getUI("btnSelectSurveyees").html(e)},_renderManagerNumbers:function(){var e=this.model.get("managers").length,t=e>0?IM("ui.label.selected_member_count",{count:e+1}):IM("postwrite.attach.label.only_author");this.getUI("btnSelectManagers").html(t)},_renderButtons:function(){this.getUI("btnComplete").prop("disabled",!this.model.isValid())},_onComplete:function(){var e=this.model.get("startAt")||Date.now();e>this.model.get("endAt")?alert(IM("survey.editor.form.invalid.start_must_before_end")):o(e).add(A.MAX_PERIOD_RANGE_BY_DAY,"day").valueOf()<this.model.get("endAt")?alert(IM("survey.editor.form.invalid.end_must_within_range")):this.model.hasNoTargetSurveyees()&&!confirm(IM("survey.editor.form.invalid.save_with_no_target_surveyees"))||(this.trigger(l.EVENT.ATTACH,this.model),this.destroy())}});E.openLayer=function(e,t){var n=new E({model:e,bandData:t});return s.openWithoutHiding(n),n},e.exports=E},function(e,t,n){var i=n(0),o=n(4),s=n(2413),a=n(600),r=n(507),l=n(177),c=n(537),d={PHOTO:"PHOTO",VIDEO:"VIDEO",PHOTO_OR_VIDEO:"PHOTO_OR_VIDEO"},u=!!(window.File&&window.URL&&window.URL.createObjectURL&&window.URL.revokeObjectURL),h=[d.VIDEO],p=l.VIDEO.TARGET_PROFILE.M_1280,m=o.Object.extend({EVENT:{ADD:"ADD",UPDATE:"UPDATE",UPLOAD:"UPLOAD"},initialize:function(e){this._inputElement=e.inputElement,this._inputTitle=e.inputTitle,this._inputClick=e.inputClick||i.noop,this._bandNo=e.bandNo,this._skinColor=e.skinColor,this._readPhotographedAt=e.readPhotographedAt,this._countInfo=e.countInfo,this._defaultUploadType=e.uploadType||d.PHOTO_OR_VIDEO,this._useAutoUploadType=!1!==e.useAutoUploadType,this._useLocalFilePreview=!1!==e.useLocalFilePreview,this._collection=s.build(),this._collection.addUploadResultList(e.uploadResultList),this._collection.addLocalFileList(e.localFileList),this._isUploading=!1,this._updateItemCount(),this._createUploader()},onBeforeDestroy:function(){this._destroyUploader()},isVideoUploadMode:function(){return this._getUploadType()===d.VIDEO},canAddItem:function(){return this.isVideoUploadMode()?this.getVideoCount()<this.getMaxVideoCount():this.getPhotoCount()<this.getMaxPhotoCount()||this.getGifCount()<this.getMaxGifCount()},canSetVideoQuality:function(){return this._isLocalFilePreviewMode()&&this.isVideoUploadMode()},getCollection:function(){return this._collection},hasItem:function(){return!this._collection.isEmpty()},removeItem:function(e){this._collection.remove(e),this._updateItem()},resetItem:function(){this._collection.reset(),this._updateItem()},getPhotoCount:function(){return this._itemCount.photoCount},getMaxPhotoCount:function(){return this._itemCount.maxPhotoCount},getGifCount:function(){return this._itemCount.gifCount},getMaxGifCount:function(){return this._itemCount.maxGifCount},getVideoCount:function(){return this._itemCount.videoCount},getMaxVideoCount:function(){return this._itemCount.maxVideoCount},uploadItem:function(e){if(!this._isUploading){var t=this._collection.getLocalFileList();if(i.isEmpty(t))this._triggerUpload();else{this._isUploading=!0;var n=e.uploadHighQualityVideo;i.each(t,(function(e){if(e.isVideo){var t=e.uploadParams={};t.thumbnailMsec=e.thumbnailMsec,n&&(e.videoWidth>=769||e.videoHeight>=769)&&(t.targetProfile=p)}}),this),this._uploader.uploadFiles(t)}}},_getUploadType:function(){var e=this._collection.at(0);return e?e.isVideo()?d.VIDEO:d.PHOTO:this._defaultUploadType},_isLocalFilePreviewMode:function(e){if(!this._useLocalFilePreview)return!1;if(!u)return!1;if(i.contains(h,this._getUploadType()))return!0;var t=e?e[0]:null;if(!t)return!1;var n=/^video/.test(t.type)?d.VIDEO:d.PHOTO;return i.contains(h,n)},_addItem:function(e,t){this._collection.addUploadResultList(e),this._collection.addLocalFileList(t),this._updateItem(),this.trigger(this.EVENT.ADD,{uploadResultList:e,localFileList:t})},_updateItem:function(){this._updateItemCount(),this._resetUploader(),this.trigger(this.EVENT.UPDATE)},_triggerUpload:function(){this.trigger(this.EVENT.UPLOAD,{uploadResultList:this._collection.getUploadResultList()})},_resetUploader:function(){this._useAutoUploadType&&this._uploaderType!==this._getUploadType()&&(this._destroyUploader(),this._createUploader())},_destroyUploader:function(){this._uploader&&(this._uploader.destroy(),this._uploader=null)},_createUploader:function(){this._uploaderType=this._getUploadType(),this._uploader=this._createUploaderByUploadType(this._uploaderType),this.listenTo(this._uploader,r.INPUT_CLICK,this._inputClick),this.listenTo(this._uploader,r.SELECT_FILES,(function(e){var t=e.files;this._isLocalFilePreviewMode(t)&&(e.event.preventDefault(),this._uploader.resetUploader(),this._addItem(null,t))})),this.listenTo(this._uploader,r.FILE_PREPARE,(function(e){var t=e.filePrepareInfo,n=t.file;i.extend(t.options.data,n.uploadParams)})),this.listenTo(this._uploader,r.UPLOAD_COMPLETE,(function(e){var t=e.resultList;if(this._isLocalFilePreviewMode())return this._collection.putUploadResultList(t),void(e.cancelled||this._triggerUpload());this._addItem(t,null)})),this.listenTo(this._uploader,r.RESET,(function(){this._isUploading=!1}))},_createUploaderByUploadType:function(e){var t={multiple:!0,autoUpload:!0,duplicate:!0,skinColor:this._skinColor,fileInputTitle:this._inputTitle,readPhotographedAt:this._readPhotographedAt,validators:[this._getValidatorByUploadType(e)],data:{band_no:this._bandNo}};switch(e){case d.PHOTO:return a.createPhotoUploader(this._inputElement,t);case d.VIDEO:return a.createVideoUploader(this._inputElement,t);case d.PHOTO_OR_VIDEO:return a.createPhotoOrVideoUploader(this._inputElement,t)}},_getValidatorByUploadType:function(e){return i.bind((function(t){if(this._isUploading)return!0;switch(this._updateItemCount(),e){case d.PHOTO:return c.PHOTO_AND_GIF_VALIDATOR(t,this._itemCount);case d.VIDEO:var n=this._itemCount.videoCount,i=this._itemCount.maxVideoCount,o=this._itemCount.videoExcessMessage;return c.VIDEO_VALIDATOR(t,n,i,o);case d.PHOTO_OR_VIDEO:return c.PHOTO_OR_VIDEO_VALIDATOR(t,this._itemCount);default:return!1}}),this)},_updateItemCount:function(){var e=this._createItemCount(),t=this._collection.countBy((function(e){return e.isVideo()?"video":e.isGif()?"gif":"photo"}));e.photoCount+=t.photo||0,e.gifCount+=t.gif||0,e.videoCount+=t.video||0,this._itemCount=e},_createItemCount:function(){var e=i.isFunction(this._countInfo)?this._countInfo():this._countInfo,t={photoCount:0,maxPhotoCount:l.PHOTO.COUNT_LIMIT,photoExcessMessage:null,gifCount:0,maxGifCount:l.PHOTO.GIF_COUNT_LIMIT,gifExcessMessage:IM("upload.gif.up_to_n",{n:l.PHOTO.GIF_COUNT_LIMIT}),videoCount:0,maxVideoCount:l.VIDEO.PC_COUNT_LIMIT,videoExcessMessage:null};return i.extend(t,e)}});m.UPLOAD_TYPE=d,m.create=function(e){return new m(e)},e.exports=m},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2429),a=n(2430),r=n(82),l=n(22),c={SINGLE_SELECT:"SINGLE_SELECT",MULTIPLE_SELECT:"MULTIPLE_SELECT"},d=o.CollectionView.extend({tagName:"ul",className:"listLine",attributes:{"data-viewname":"DBandSelectCollectionView.SelectItemListView"},initialize:function(e){this._selectionType=e.selectionType,this._limitSelect=e.limitSelect},childView:function(e){return this._selectionType==c.SINGLE_SELECT?d.SingleSelectItemView:this._selectionType==c.MULTIPLE_SELECT?d.MultipleSelectItemView:void 0},childViewTriggers:{"singleBand:selected":"singleBand:selected","multipleBand:selected":"multipleBand:selected","multipleBand:deselected":"multipleBand:deselected"},childViewOptions:function(){return{limitSelect:this._limitSelect}}});return d.SingleSelectItemView=o.View.extend({tagName:"li",className:"tLine",attributes:{"data-viewname":"DBandSelectCollectionView.SingleSelectItemView"},template:t.template(s),templateContext:function(){var e;return{coverThumbUrl:!!(e=this.model.get("type")==l.BAND_TYPE.PAGE?this.model.get("profileImage"):this.model.get("cover"))&&r.make(e,r.TYPE.s75)||null}},ui:{btnBandSelect:"._btnBandSelect",imgCover:"._imgCover"},events:{"click @ui.btnBandSelect":function(e){return this.trigger("singleBand:selected",this.model),!1}},onDomRefresh:function(){this.getUI("imgCover").on("error",t.bind((function(e){i(e.currentTarget).remove()}),this))}}),d.MultipleSelectItemView=o.View.extend({tagName:"li",className:"tLine",attributes:{"data-viewname":"DBandSelectCollectionView.MultipleSelectItemView"},template:t.template(a),templateContext:function(){var e;return e=this.model.get("type")==l.BAND_TYPE.PAGE?this.model.get("profileImage"):this.model.get("cover"),{coverThumbUrl:r.make(e,r.TYPE.s75)}},ui:{checkboxBandSelect:"._checkboxBandSelect",imgCover:"._imgCover"},events:{"click @ui.checkboxBandSelect":function(e){this.model.set("selected",i(e.currentTarget).prop("checked"))}},modelEvents:{"change:selected":function(){if(this._getSelectedBandList().length>this._limitSelect)return alert(IM("alert.select.max_count")),this.model.set("selected",!1),void this.$el.find(this.getUI("checkboxBandSelect")).prop("checked",!1);this.model.get("selected")?this.trigger("multipleBand:selected",this.model):this.trigger("multipleBand:deselected",this.model)}},initialize:function(e){this._limitSelect=e.limitSelect,this.model.get("selected")||this.model.set("selected",!1)},onDomRefresh:function(){this.getUI("imgCover").on("error",t.bind((function(e){i(e.currentTarget).remove()}),this))},_getSelectedBandList:function(){return this.model.collection.where({selected:!0})}}),d.SELECTION_TYPE=c,d.build=function(e){return new d({collection:e.collection,selectionType:e.selectionType,limitSelect:e.limitSelect})},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i={lottie:void 0,loadLottie:function(){return n.e(172).then(n.t.bind(null,3103,7)).then((function(e){i.lottie=e.default}))}};e.exports=i},function(e,t,n){var i;void 0===(i=function(e){var t=n(21),i={ADD_BOOKMARK:"/v1.0.0/add_bookmark",DELETE_BOOKMARK:"/v1.0.0/delete_bookmark",GET_BOOKMARKS:"/v2.0.0/get_bookmarks"},o={setBookmarked:function(e,n){var o={band_no:e,post_no:n};return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+i.ADD_BOOKMARK,data:o,method:"POST"})},deleteBookmarked:function(e,n){var o={band_no:e,post_no:n};return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+i.DELETE_BOOKMARK,data:o,method:"POST"})},getBookmarks:function(e){return t.getLoginV1Client().sendAndThenProcess({url:"https://api.band.us"+i.GET_BOOKMARKS,data:e})}};return o.PATHS=i,o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(10),n(4)),o=n(16),s=n(2446),a=n(2030),r=n(162),l=n(1116),c=n(53),d=n(1154),u=n(562),h=n(495),p=n(487),m=n(9),_=n(1562),g="-active",f="active",b="fromDate",v="toDate",A={RENDERED:"RENDERED"},E=i.View.extend({attributes:{"data-viewname":"DPageBandStatsDetailView"},className:function(){return this._isPrintPage()||this._isBandPagePost()?"":"gBoxShadow"},template:t.template(s),templateContext:function(){var e=this._getCurrentRouteInfo().routeInfo;return{isBandPagePost:this._isBandPagePost(),tabLinkFollowersUrl:this._makeLinkUrl(r.PAGE_BAND_SETTING_STATS_FOLLOWERS),tabLinkParticipationUrl:this._makeLinkUrl(r.PAGE_BAND_SETTING_STATS_PARTICIPATION),tabLinkReactionUrl:this._makeLinkUrl(r.PAGE_BAND_SETTING_STATS_REACTION),tabLinkFollowersClass:e===r.PAGE_BAND_SETTING_STATS_FOLLOWERS?f:"",tabLinkParticipationClass:e===r.PAGE_BAND_SETTING_STATS_PARTICIPATION||e===r.PAGE_BAND_HOME||e===r.PAGE_BAND_POST||e===r.PAGE_BAND_POST_DETAIL?f:"",tabLinkReactionClass:e===r.PAGE_BAND_SETTING_STATS_REACTION?f:""}},behaviors:function(){return[{behaviorClass:_,bandNo:this.options.bandNo},{behaviorClass:h,sceneId:h.SCENE.PAGE_STATISTICS},p]},ui:{contentBodyView:"._contentBodyView",fromDate:"._fromDate",toDate:"._toDate",btnLookup:"._btnLookup",btnYesterday:"._btnYesterday",btnLast7days:"._btnLast7days",btnLast4Weeks:"._btnLast4Weeks",btnTabParticipation:"._btnTabParticipation",btnTabReaction:"._btnTabReaction",btnTab:"._btnTab",btnExcelDownload:"._btnExcelDownload",btnPrint:"._btnPrint",btnMore:"._btnMore",pageBandStatisticsMoreMenu:"._pageBandStatisticsMoreMenu",pageBandStatisticsPeriodArea:"._pageBandStatisticsPeriodArea"},regions:{contentBodyView:{el:"@ui.contentBodyView",replaceElement:!0},fromDate:{el:"@ui.fromDate",replaceElement:!0},toDate:{el:"@ui.toDate",replaceElement:!0}},events:{click:function(){this._toggleMoreMenu(!0)},"click @ui.btnLookup":function(){this._statsLookup()},"click @ui.btnYesterday":function(){this._fromDate=this._getYesterday(),this._toDate=this._getYesterday(),this._statsLookup()},"click @ui.btnLast7days":function(){this._fromDate=this._getLast7days(),this._toDate=this._getYesterday(),this._statsLookup()},"click @ui.btnLast4Weeks":function(){this._fromDate=this._getLast4Weeks(),this._toDate=this._getYesterday(),this._statsLookup()},"click @ui.btnTabParticipation":function(){this._onClickBtnTab(this.getUI("btnTabParticipation"),d.TAB_INFO.PARTICIPATION)},"click @ui.btnTabReaction":function(){this._onClickBtnTab(this.getUI("btnTabReaction"),d.TAB_INFO.REACTION)},"click @ui.btnExcelDownload":function(){this._isBodyRegionEnabled()&&this._getContentBodyView().creteExcelFile()},"click @ui.btnPrint":function(){var e=null;switch(this._getCurrentRouteInfo().routeInfo){case r.PAGE_BAND_SETTING_STATS_SUMMARY:e=r.PAGE_BAND_SETTING_STATS_PRINT;break;case r.PAGE_BAND_SETTING_STATS_FOLLOWERS:case r.PAGE_BAND_SETTING_STATS_PARTICIPATION:case r.PAGE_BAND_SETTING_STATS_REACTION:e=r.PAGE_BAND_SETTING_STATS_PRINT;break;case r.PAGE_BAND_POST_DETAIL:case r.PAGE_BAND_HOME:case r.PAGE_BAND_POST:e=r.PAGE_BAND_POST_STATS_PRINT}var t=this._makeLinkUrl(e);window.open(t)},"click @ui.btnMore":function(){return this._toggleMoreMenu(),!1}},initialize:function(e){this._loading=!1,this._bandNo=e.bandNo,this._postNo=e.postNo,this._currentRouteInfoParams=this._getCurrentRouteInfo().params,this._fromDate=this._currentRouteInfoParams.from||d.DEFAULT_LOOKUP_DATE.FROM(),this._toDate=this._currentRouteInfoParams.to||d.DEFAULT_LOOKUP_DATE.TO(),this._contentBodyViewRegion=this.getRegion("contentBodyView")},viewStart:function(){this._renderDatePick(),this._renderBodyView(),this._activationLookupButtonClassSetting(),this.trigger(A.RENDERED)},sendJplSceneEnterLog:function(){this.jplSceneEnter(p.CLASSIFIER.PAGE_STATISTICS)},_getCurrentRouteInfo:function(){return c.getCurrentRouteInfo()},_isPrintPage:function(){switch(this._getCurrentRouteInfo().routeInfo){case r.PAGE_BAND_POST_STATS_PRINT:case r.PAGE_BAND_SETTING_STATS_PRINT:return!0;default:return!1}},_isBandPagePost:function(){switch(this._getCurrentRouteInfo().routeInfo){case r.PAGE_BAND_HOME:case r.PAGE_BAND_POST:case r.PAGE_BAND_POST_DETAIL:return!0;default:return!1}},_toggleMoreMenu:function(e){if(!this.isDestroyed()){var t=this.getUI("pageBandStatisticsMoreMenu");this.trigger(d.EVENT.CONTENT_BODY_CLICK),e?t.hide():t.toggle(!t.is(":visible"))}},_makeLinkUrl:function(e){var t={};return this._fromDate&&this._toDate&&(t={from:this._fromDate,to:this._toDate}),e.makeUrl({band_no:this._bandNo,post_no:this._postNo},t)},_onClickBtnTab:function(e,t){e.hasClass(f)||(this.getUI("btnTab").removeClass(f),e.addClass(f),this._isBandPagePost()&&this._isBodyRegionEnabled()&&this._getContentBodyView().changeTab(t))},_getYesterday:function(){return o().subtract(1,"days").format(d.DATE_FORMAT.YYYYMMDD)},_getLast7days:function(){return o(this._getYesterday()).subtract(6,"days").format(d.DATE_FORMAT.YYYYMMDD)},_getLast4Weeks:function(){return o(this._getYesterday()).subtract(4,"weeks").format(d.DATE_FORMAT.YYYYMMDD)},_renderDatePick:function(){var e=l.buildDDateInputView({date:this._fromDate,placeholder:IM("ui.label.date_pick"),useDateDelete:!0,canTextEdit:!1,format:d.DATE_FORMAT.YYYYMMDD,viewFormatLocalize:d.DATE_FORMAT.SHORT_NOWEEKDAY,pickerWidth:113}),n=l.buildDDateInputView({date:this._toDate,placeholder:IM("ui.label.date_pick"),useDateDelete:!0,canTextEdit:!1,format:d.DATE_FORMAT.YYYYMMDD,viewFormatLocalize:d.DATE_FORMAT.SHORT_NOWEEKDAY,pickerWidth:113});this.showChildView(b,e),this.showChildView(v,n),this.listenTo(e,l.EVENT.DATE_CHANGED,t.bind((function(e){this._fromDate=e.value,this._validateSelectedDate(b)&&this._setBtnLookupState()}),this)),this.listenTo(n,l.EVENT.DATE_CHANGED,t.bind((function(e){this._toDate=e.value,this._validateSelectedDate(v)&&this._setBtnLookupState()}),this))},_activationLookupButtonClassSetting:function(){this._toDate===this._getYesterday()&&(t.each(["btnYesterday","btnLast7days","btnLast4Weeks"],t.bind((function(e){this.getUI(e).removeClass(g)}),this)),this._fromDate===this._getYesterday()?this.getUI("btnYesterday").addClass(g):this._fromDate===this._getLast7days()?this.getUI("btnLast7days").addClass(g):this._fromDate===this._getLast4Weeks()&&this.getUI("btnLast4Weeks").addClass(g))},_setBtnLookupState:function(e){var t=null;t=!e&&(this._toDate&&this._fromDate&&(this._toDate!==this._currentRouteInfoParams.to||this._fromDate!==this._currentRouteInfoParams.from)),this.getUI("btnLookup").attr("disabled",!t)},_showAlert:function(e){return u.openLayer({headerTitle:IM("page_band.stats.lookup.error.title"),bodyDesc:e})},_validateSelectedDate:function(e){var t=o(this._fromDate),n=o(this._toDate),i=t.isValid(),s=n.isValid(),a=this._getYesterday(),r=o(a),l=o(a).subtract(2,"years"),c=null;if(r.diff(t,"days")<0||r.diff(n,"days")<0)return c=this._showAlert(IM("page_band.stats.lookup.error1")),this.listenTo(c,u.EVENTS.CONFIRM,(function(){this._setDateValue(e,this._getYesterday())})),!1;if(!i||!s)return!1;var h=t.diff(l,"days")>=0,p=n.diff(l,"days")>=0;return h||p?n.diff(t,"days")>=0?!!(n.diff(t,"days")<=60)||(c=this._showAlert(IM("page_band.stats.lookup.error5")),this.listenTo(c,u.EVENTS.CONFIRM,(function(){var e=n.subtract(60,"days");e.diff(l,"days")<=0&&(e=l),this._setDateValue(b,e.format(d.DATE_FORMAT.YYYYMMDD)),this._setBtnLookupState()})),!1):(c=e===b?this._showAlert(IM("page_band.stats.lookup.error3")):this._showAlert(IM("page_band.stats.lookup.error4")),this.listenTo(c,u.EVENTS.CONFIRM,(function(){var i=e===b?n:t;this._setDateValue(e,i.format(d.DATE_FORMAT.YYYYMMDD)),this._setBtnLookupState()})),!1):(c=this._showAlert(IM("page_band.stats.lookup.error2")),this.listenTo(c,u.EVENTS.CONFIRM,(function(){this._setDateValue(e,"")})),!1)},_renderBodyView:function(){var e=a.build(this._bandNo,this._postNo,this._fromDate,this._toDate);this._contentBodyViewRegion.show(e),this.listenTo(e,d.EVENT.RENDERED,(function(e){this._toggleShadowEffect(!1)})),this.listenTo(e,d.EVENT.DATA_AREA_SCROLL,(function(e){this._toggleShadowEffect(e)}))},_toggleShadowEffect:function(e){this.getUI("pageBandStatisticsPeriodArea").toggleClass("-scrollY",e)},_getContentBodyView:function(){return this._contentBodyViewRegion.currentView},_statsLookup:function(){if(this._fromDate&&this._toDate&&this._validateSelectedDate())return this._isBandPagePost()&&this._isBodyRegionEnabled()?(this._getContentBodyView().changeLookupDate(this._fromDate,this._toDate),this._setDateValueFromDate(this._fromDate),this._setDateValueToDate(this._toDate),this._activationLookupButtonClassSetting(),void this._setBtnLookupState(!0)):void this._getCurrentRouteInfo().routeInfo.goDForced({band_no:this._bandNo},{from:this._fromDate,to:this._toDate})},_isBodyRegionEnabled:function(){return this.hasRegion("contentBodyView")&&!this._contentBodyViewRegion.isDestroyed()},_setDateValue:function(e,t){e===b?this._fromDate=t:this._toDate=t;var n=m.format.date(o(t),d.DATE_FORMAT.SHORT_NOWEEKDAY);this.getChildView(e).setValue(n)},_setDateValueToDate:function(e){this._setDateValue(v,e)},_setDateValueFromDate:function(e){this._setDateValue(b,e)},getPeriodDates:function(){if(this._isBodyRegionEnabled())return this._getContentBodyView().getPeriodDates()},creteExcelFile:function(){if(this._isBodyRegionEnabled())return this._getContentBodyView().creteExcelFile()}});return E.build=function(e,t){return new E({bandNo:e,postNo:t||null})},E.EVENT=A,E}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(16),a=n(2447),r=n(1638),l=n(53),c=n(162),d=n(499),u=n(498),h=n(1154),p=n(606),m=n(9),_=n(1036);n(591);var g=o.View.extend({attributes:{"data-viewname":"DPageBandStatsDetailBodyView"},ui:{pageBandStatisticsDataArea:"._pageBandStatisticsDataArea"},getTemplate:function(){return this._loading?t.template(a):t.template(u)},templateContext:function(){return this._loading?{TAB_INFO:h.TAB_INFO,_s:i,stats:this._stats,isEmptyData:t.isEmpty(this._stats),isPrintPage:this._isPrintPage(),isPostPrintPage:this._isPostPrintPage(),currentTab:this._currentTab,dateFormat:t.bind((function(e){return this._getLocalizeDate(e,h.DATE_FORMAT.SHORT_NOWEEKDAY)}),this)}:{_loading_size:d.Size.MEDIUM}},initialize:function(e){this._loading=!1,this._bandNo=e.bandNo,this._postNo=e.postNo,this._from=e.from||h.DEFAULT_LOOKUP_DATE.FROM(),this._to=e.to||h.DEFAULT_LOOKUP_DATE.TO(),this._stats=null,this._currentRouteInfo=l.getCurrentRouteInfo().routeInfo,this._checkCurrentTabInfo()},onAttach:function(){this._getStatsData()},onDomRefresh:function(){this._loading&&(this.trigger(h.EVENT.RENDERED),this._onScrollDataTableArea())},onBeforeDetach:function(){this.getUI("pageBandStatisticsDataArea").off("scroll")},_getLocalizeDate:function(e,t){return m.format.date(e,t)},_onScrollDataTableArea:function(){if(this._isPostPrintPage()&&!this._postNo)return!1;this.getUI("pageBandStatisticsDataArea").off("scroll").on("scroll",t.bind((function(e){var t=$(e.currentTarget).scrollTop();this.trigger(h.EVENT.DATA_AREA_SCROLL,!!t)}),this))},_getStatsData:function(){(this._postNo?this._getPagePostStatsDaily():this._getPageStatsDaily()).then(t.bind((function(e){this._loading=!0,this._stats=e.stats&&e.stats||{},this.render()}),this))},_getPagePostStatsDaily:function(){return r.getPagePostStatsDaily(this._bandNo,this._postNo,this._from,this._to)},_getPageStatsDaily:function(){return r.getPageStatsDaily(this._bandNo,this._from,this._to)},_checkCurrentTabInfo:function(){switch(this._currentRouteInfo){case c.PAGE_BAND_SETTING_STATS_FOLLOWERS:this._currentTab=h.TAB_INFO.FOLLOWERS;break;case c.PAGE_BAND_SETTING_STATS_PARTICIPATION:case c.PAGE_BAND_HOME:case c.PAGE_BAND_POST:case c.PAGE_BAND_POST_DETAIL:this._currentTab=h.TAB_INFO.PARTICIPATION;break;case c.PAGE_BAND_SETTING_STATS_REACTION:this._currentTab=h.TAB_INFO.REACTION}},changeTab:function(e){this._currentTab=e,this.render()},changeLookupDate:function(e,t){this._from=e,this._to=t,this._getStatsData()},getPeriod:function(){return[this._getLocalizeDate(s(this._from),h.DATE_FORMAT.SHORT_NOWEEKDAY),this._getLocalizeDate(s(this._to),h.DATE_FORMAT.SHORT_NOWEEKDAY)].join(" ~ ")},getPeriodDates:function(){return{from:this._from,to:this._to}},creteExcelFile:function(){var e,n,i=null,o=_.utils.book_new(),s=null,a=null,r=[this._stats[this._stats.length-1].work_date.replace(/-/g,""),this._stats[0].work_date.replace(/-/g,"")].join("_");this._postNo?(i=IM("page_band.post.stats.title"),a=this._pageBandPostStatsData()):(i=IM("page_band.stats.title"),a=this._pageBandStatsData()),e=[i,"_",r,".xlsx"].join(""),(s=_.utils.json_to_sheet(a.sheetData,{header:a.header,skipHeader:!0,raw:!0}))["!cols"]=a.colsWidth,t.each(s,(function(e,t){"n"===e.t&&(s[t].z="#,###0")})),_.utils.book_append_sheet(o,s,i),n=_.write(o,{bookType:"xlsx",bookSST:!0,type:"binary"}),p.saveAs(new Blob([this._s2ab(n)],{type:"application/octet-stream"}),e)},_pageBandStatsData:function(){var e=[],n=[];return e.push({A:"",B:IM("page_band.title.new_followers"),C:IM("page_band.stats.title.unsubscribe"),D:IM("page_band.stats.title.total_followers"),E:IM("page_band.stats.title.exposure_count"),F:IM("page_band.stats.title.click_count"),G:IM("page_band.stats.title.reaction_count"),H:IM("page_band.stats.title.comment_count"),I:IM("page_band.stats.title.emotion_count"),J:IM("page_band.stats.title.share_count")}),t.each(this._stats,t.bind((function(t){var i=this._getLocalizeDate(t.work_date,h.DATE_FORMAT.SHORT_NOWEEKDAY);e.push({A:i,B:t.joiner_count,C:t.withdrawer_count,D:t.member_count,E:t.exposure_count,F:t.read_count,G:t.reaction_count,H:t.comment_count,I:t.emotion_count,J:t.share_count}),n=[{wch:this._setColsWidthSize(n[0],"wch",i)}]}),this)),{sheetData:e,colsWidth:n,header:["A","B","C","D","E","F","G","H","I","J"]}},_pageBandPostStatsData:function(){var e=[],n=[];return e.push({A:"",B:IM("page_band.stats.title.exposure_count"),C:IM("page_band.stats.title.click_count"),D:IM("page_band.stats.title.reaction_count"),E:IM("page_band.stats.title.comment_count"),F:IM("page_band.stats.title.emotion_count"),G:IM("page_band.stats.title.share_count")}),t.each(this._stats,t.bind((function(t){var i=this._getLocalizeDate(t.work_date,h.DATE_FORMAT.SHORT_NOWEEKDAY);e.push({A:i,B:t.exposure_count,C:t.read_count,D:t.reaction_count,E:t.comment_count,F:t.emotion_count,G:t.share_count}),n=[{wch:this._setColsWidthSize(n[0],"wch",i)}]}),this)),{sheetData:e,colsWidth:n,header:["A","B","C","D","E","F","G"]}},_s2ab:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i!=e.length;++i)n[i]=255&e.charCodeAt(i);return t},_setColsWidthSize:function(e,t,n){return!e||n.length>e[t]?n.length+5:e[t]},_isPrintPage:function(){switch(this._currentRouteInfo){case c.PAGE_BAND_SETTING_STATS_PRINT:case c.PAGE_BAND_POST_STATS_PRINT:return!0;default:return!1}},_isPostPrintPage:function(){return this._currentRouteInfo===c.PAGE_BAND_POST_STATS_PRINT}});return g.build=function(e,t,n,i){return new g({bandNo:e,postNo:t,from:n,to:i})},g}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(4),s=n(160),a=n(2448),r=n(2449),l=n(2450),c=n(486),d=n(2451),u=n(499),h=n(589),p=n(1639),m=n(153),_=n(491),g=n(520),f=n(487),b=n(159),v=n(511),A=n(503),E={SEND_LOG:"sendingEmailLog",ITEM_VIEW_DOM_REFRESHED:"itemViewDomRefreshed",TOGGLE_SELECTED:"toggleSelected",TOGGLE_SELECTED_ERROR:"toggleSelectedError",SHOW_EMPTY_VIEW:"showEmptyView",SEARCHED_VIRTUAL_MEMBERS:"searchedVirtualMembers"},T="virtual_member",C="band_member",y={TYPE:"All",LABEL:IM("bandsetting.member_permission.anyone")},M={ALL:y,UNREAD:{TYPE:"Unread",LABEL:IM("post.read_user_list.tab.title.unread_user")}},I=(r=o.View.extend({attributes:function(){return{"data-viewname":"DMemberSelectItemViewTemplate","data-name":this.model.getName()}},tagName:"li",className:"tLine",template:u.template(r),templateContext:function(){return{getIconClass:this._getIconClass,isVirtualMemberData:this._isVirtualMemberData()}},behaviors:[b],ui:{btnProfileImage:"._btnProfileImage",chkMember:"._chkMember"},events:{"change @ui.chkMember":"_toggleSelected","click @ui.btnProfileImage":"_onClickProfile"},modelEvents:{change:function(){this.render(),this.spawn(E.ITEM_VIEW_DOM_REFRESHED)}},_onClickProfile:function(e){e.preventDefault(),h.openProfileView(this.model.collection.getBandNo(),this.model.getUserNo())},_getIconClass:function(){var e=[];return this.receiveEmailNotification&&e.push("-imgEmail"),e.join(" ")},_isVirtualMemberData:function(){return this.model.collection.getDataName()===T},_toggleSelected:function(e){if(this.model.collection.selectedMembers.length>=100&&this.getUI("chkMember").prop("checked"))return this.checkState(!1),void this.spawn(E.TOGGLE_SELECTED_ERROR);this.spawn(E.TOGGLE_SELECTED,{userNo:this.model.getUserNo(),isChecked:this.getUI("chkMember").is(":checked")})},checkState:function(e){this.getUI("chkMember").prop("checked",e)},checkOrUncheck:function(e){this.checkState(e),this._toggleSelected()},isVisible:function(){return this.$el.is(":visible")}}),o.CollectionView.extend({attributes:{"data-viewname":"DMemberSelectCollectionView"},tagName:"ul",className:"listLine",behaviors:[b],childView:r,collectionEvents:{loading:function(){this.$el.addClass("loadingCenter"),this.$el.show()},loaded:function(){this.$el.removeClass("loadingCenter"),this.collection.isEmpty()&&(this.$el.hide(),this.spawn(E.SHOW_EMPTY_VIEW))}},selectAllMembers:function(e){this.children.each((function(t){t.isVisible()&&t.checkOrUncheck(e)}))},checkState:function(){this.children.each(i.bind((function(e){this.collection.selectedMembers.find({userNo:e.model.get("userNo")})&&e.checkState(!0)}),this))},searchVirtualMember:function(e){clearTimeout(this.timeoutId),this.timeoutId=setTimeout(i.bind((function(){if(!this.isDestroyed()){var t=$("<div/>").text(e).html().replace(/\"/g,"&quot;"),n=this.$el.find("li").removeClass("-bTN"),i=n.filter('[data-name*="'+t+'"]');e?(n.hide(),i.length>0?(i.show(),this._searchedMembersItem=i,this._searchedMembersCount=i.length,$(this._searchedMembersItem[0]).toggleClass("-bTN",$(this._searchedMembersItem[0]).index()>0)):(this._searchedMembersItem=null,this._searchedMembersCount=null)):n.show(),this.spawn(E.SEARCHED_VIRTUAL_MEMBERS)}}),this),300)},getSearchedMembersCount:function(){var e=this._searchedMembersCount;return e||0},getSearchedSelectedMembersCount:function(){var e=this._searchedMembersItem;return e?e.find("input:checked").length:0}})),S=o.View.extend({attributes:{"data-viewname":"DMemberSelectForSendingEmailView"},tagName:"section",className:"lyWrap",template:i.template(a),templateContext:function(){return{btnConfirmValue:this._btnConfirmValue,desc:this._isVirtualMemberTab()?IM("send_an_alert.layer.desc.virtual_member"):IM("send_an_alert.layer.desc.band_member"),isVirtualMemberTab:this._isVirtualMemberTab(),membersPageUrl:m.GROUP_BAND_MEMBER.makeUrl({band_no:this._bandNo}),checkMemberSortEnabled:this._checkMemberSortEnabled(),bandMembersSort:this._memberSortOption,selectedSortBandMemberInfo:this._selectedSortOption,isNotifyMemberPermitted:this._bandData.isNotifyMemberPermitted()}},behaviors:[b],ui:{memberListContainer:"._memberListContainer",txtQuery:"._txtQuery",btnSearch:"._btnSearch",btnClose:"._btnClose",btnConfirm:"._confirm",memberListContainerWrapper:"._memberListContainerWrapper",btnHasMoreMember:"._btnHasMoreMember",btnMemberDelete:"._btnMemberDelete",selectedMembersWrap:"._selectedMembersWrap",selectedMembers:"._selectedMembers",mainContainer:"._mainContainer",btnAddSubscriber:"._btnAddSubscriber",btnVirtualMemberManage:"._btnVirtualMemberManage",btnVirtualMemberManageWrap:"._btnVirtualMemberManageWrap",selectAllTotalCount:"._selectAllTotalCount",btnSelectAll:"._btnSelectAll",selectAllWrap:"._selectAllWrap",tabs:"._tabs",selectedVirtualMemberCount:"._selectedVirtualMemberCount",selectedBandMemberCount:"._selectedBandMemberCount",btnVirtualMemberTab:"._btnVirtualMemberTab",btnBandMemberTab:"._btnBandMemberTab",tabDesc:"._tabDesc",sortBandMemberSortItem:"._sortBandMemberSortItem",sortBandMemberListWrap:"._sortBandMemberListWrap",noResult:"._noResult",helpGuideRegisterVirtualMember:"._helpGuideRegisterVirtualMember",btnRegisterVirtualMember:"._btnRegisterVirtualMember",sortBandMemberSortList:"._sortBandMemberSortList",selectedSortBtn:"._selectedSortBtn",selectedBtnTitle:"._selectedBtnTitle"},regions:{memberListContainer:{el:"@ui.memberListContainer",replaceElement:!0}},events:{"keyup @ui.txtQuery":"_setActiveOnInput","click @ui.btnSearch":"_search","click @ui.btnClose":"destroy","click @ui.btnHasMoreMember":"_setFocusToSearch","click @ui.btnMemberDelete":"_memberUncheck","click @ui.btnAddSubscriber":"_addVirtualMember","click @ui.btnSelectAll":"_onClickBtnSelectAll","click @ui.btnVirtualMemberTab":"_onClickBtnVirtualMemberTab","click @ui.btnBandMemberTab":"_onClickBtnBandMemberTab","click @ui.sortBandMemberSortItem":"_onChangeBandMemberList","click @ui.btnConfirm":"_onClickBtnConfirm","click @ui.btnVirtualMemberManage":"_goMemberTab","click @ui.btnRegisterVirtualMember":"_showVirtualMemberTab","click @ui.sortBandMemberListWrap":function(){this._tabName!==T&&this._checkMemberSortEnabled()&&(this.ui.sortBandMemberListWrap.hasClass("-dropDownOn")?this.ui.sortBandMemberListWrap.removeClass("-dropDownOn"):this.ui.sortBandMemberListWrap.addClass("-dropDownOn"))}},onMessages:(t={},t[E.ITEM_VIEW_DOM_REFRESHED]=function(){this._refreshSelectAllWrap()},t[E.TOGGLE_SELECTED]=function(e){this._toggleSelected(e)},t[E.TOGGLE_SELECTED_ERROR]=function(){this._memberSelectErrorMessage()},t[E.SHOW_EMPTY_VIEW]=function(){this._refreshEmptyView()},t[E.SEARCHED_VIRTUAL_MEMBERS]=function(){this._refreshSelectAllWrap(),this._refreshEmptyView()},t),collectionEvents:{reset:function(){this._refreshDescriptionArea(),this._refreshSelectAllWrap(),this._noResultAreaSetting(!1),this._toggleMemberListBottomButtonArea()},loading:function(){this.getUI("btnAddSubscriber").hide()},loaded:function(){this._isVirtualMemberTab()&&this.getUI("btnAddSubscriber").show()}},initialize:function(e){this._bandNo=e.bandNo,this._postNo=e.postNo,this._schedule=e.schedule,this._bandData=e.bandData,this._isSearchResult=!1,this._memberSortOption=this._makeMemberSortOption(),this._checkMemberSortEnabled()&&(this._selectedSortOption=this._memberSortOption[0]),this._btnConfirmValue=IM("ui.label.confirm"),this.tabsCount={virtualMember:0,bandMember:0},this.savedSelectedMemberCollection={},this.savedSelectedMemberCollection[T]=this.collection.selectedMembers.clone(),this.savedSelectedMemberCollection[C]=this.collection.selectedMembers.clone(),this._tabName=C,u.forCollectionView(this).addTrigger(this.collection,"fetchVirtualMemberCollectionWithEmail"),this._isPost()?u.addTrigger(this.collection,"fetchBandMemberWithFilterDataCollectionForPost").addTrigger(this.collection,"searchBandMemberWithFilterDataCollection"):u.addTrigger(this.collection,"fetchBandMemberWithFilterDataCollectionForSchedule").addTrigger(this.collection,"searchScheduleRsvpStatesOfMembersWithFilterDataCollection"),this._fetchMemberCollection(),this.listenTo(this.collection.selectedMembers,"update",(function(){this._updateView()}))},onAttach:function(){this._refreshDescriptionArea(),this.showChildView("memberListContainer",new I({collection:this.collection}))},_makeMemberSortOption:function(){if(this._checkMemberSortEnabled()){if(this._isPost())return[M.ALL,M.UNREAD];var e=this._schedule.scheduleRsvpModel&&this._schedule.scheduleRsvpModel.getRsvpStatusListForNotifySort(),t=[];return i.each(e,(function(e){var n={TYPE:e.itemName,LABEL:e.text};e.itemName==v.CUSTOM&&(n.customStateId=e.customStateId),t.push(n)})),t.unshift(y),t}},_goMemberTab:function(e){this._schedule},_isPost:function(){return!!this._postNo},_refreshEmptyView:function(){this._noResultAreaSetting(!1);var e=this._isVirtualMemberTab()&&this._isSearchResult&&this._getMemberListChildView().getSearchedMembersCount()>0,t=this._isVirtualMemberTab()&&!this._isSearchResult,n=!this._isVirtualMemberTab()&&this.collection.length>0;if(e||t||n)this._isVirtualMemberTab()&&this.getUI("btnAddSubscriber").show();else{var o=IM("member_list.label.nobody_available");this._isSearchResult&&(o=IM("ui.message.no_search_result"),this._isVirtualMemberTab()&&this.getUI("btnAddSubscriber").hide());var s=i.template('<span class="pText -largeFont -lightGray3">'+o+"</span>");this._noResultAreaSetting(!0,s)}},_noResultAreaSetting:function(e,t){var n=this.getUI("noResult");if(n.empty(),!e)return n.hide(),void this.getUI("memberListContainerWrapper").removeClass("-noResult");""!==t&&n.append(t),n.show(),this.getUI("memberListContainerWrapper").addClass("-noResult")},_toggleSelected:function(e){this._isSelectable()&&this.collection.setSelectedMember(e.userNo,e.isChecked)},_searchVirtualMember:function(e){this._getMemberListChildView().searchVirtualMember(e)},_getMemberListChildView:function(){return this.getChildView("memberListContainer")},_isSelectable:function(){return this.collection.length<100},_updateView:function(e){this._refreshTabCount(),this._refreshBtnConfirmState(),this._renderSelectedMembers(),this._refreshSelectAllWrap(),e&&this._memberListCheckState()},_onChangeBandMemberList:function(e){this._changeSelectedInfo(e.currentTarget),this._isSearchResult?this._search():(this._noResultAreaSetting(!1),this._fetchMemberCollection())},_changeSelectedInfo:function(e){var t=$(e).data("type");this._selectedSortOption=this._memberSortOption.find((function(n){return t==v.CUSTOM&&n.customStateId==$(e).data("customStateId")||t!=v.CUSTOM&&t==n.TYPE?n:void 0})),this.ui.selectedSortBtn.attr("title",i.unescape(this._selectedSortOption.LABEL)),this.ui.selectedBtnTitle.text(i.unescape(this._selectedSortOption.LABEL))},_onClickBtnVirtualMemberTab:function(){this._tabName!==T&&this._refreshView(T)},_onClickBtnBandMemberTab:function(){this._tabName!==C&&this._refreshView(C)},_refreshView:function(e){var t="btnBandMemberTab";e===T&&(t="btnVirtualMemberTab"),this._saveSelectedMemberCollection(),this._tabName=e,this.getUI("tabs").removeClass("-on"),this.getUI(t).parent().addClass("-on"),this._refreshDescriptionArea(),this._toggleMemberListBottomButtonArea(),this._resetSearchResult(!0),this._refreshEmptyView(!1),this._fetchMemberCollection().then(i.bind((function(){this.collection.selectedMembers.reset(),i.each(this._getSelectedMemberCollectionForCurrentTab().models,i.bind((function(e){this.collection.setSelectedMember(e.get("userNo"),!0)}),this)),this._updateView(!0)}),this)),e===T?this.getUI("helpGuideRegisterVirtualMember").hide():e===C&&this.getUI("helpGuideRegisterVirtualMember").show()},_refreshDescriptionArea:function(){var e=null;this._isVirtualMemberTab()?(e=IM("send_an_alert.layer.desc.virtual_member"),this.getUI("btnVirtualMemberManageWrap").toggle(this.collection.length>0),this.getUI("sortBandMemberListWrap").hide()):(e=this._isPost()?IM("send_an_alert.layer.desc.band_member"):IM("send_an_alert.layer.desc.band_member.schedule"),this.getUI("btnVirtualMemberManageWrap").hide(),this._checkMemberSortEnabled()?this.getUI("sortBandMemberListWrap").show():this.getUI("sortBandMemberListWrap").hide()),this.getUI("tabDesc").html(e)},_checkMemberSortEnabled:function(){return!!this._isPost()||!!this._schedule.rsvp},_toggleMemberListBottomButtonArea:function(){var e=!this._isVirtualMemberTab()&&this.collection.hasMoreMember(),t=this._canBeAddedVirtualMember(),n="-tLine gPat10",i="gPat10";this.getUI("memberListContainerWrapper").addClass("-tLine"),this.getUI("btnAddSubscriber").attr("disabled",!t).toggle(t),this.getUI("btnHasMoreMember").attr("disabled",!e).toggle(e),t&&(0===this.collection.length?(this.getUI("btnAddSubscriber").removeClass(n).addClass(i),this.getUI("memberListContainerWrapper").removeClass("-tLine"),this.getUI("btnAddSubscriber").addClass(i)):this.getUI("btnAddSubscriber").removeClass(i).addClass(n))},_memberListCheckState:function(){this._getMemberListChildView().checkState()},_saveSelectedMemberCollection:function(){this._isVirtualMemberTab()?this.savedSelectedMemberCollection[T]=this.collection.selectedMembers.clone():this.savedSelectedMemberCollection[C]=this.collection.selectedMembers.clone()},_getSelectedMemberCollectionForCurrentTab:function(){return this._isVirtualMemberTab()?this._getSelectedMemberCollection(T):this._getSelectedMemberCollection(C)},_getSelectedMemberCollection:function(e){return e&&this.savedSelectedMemberCollection[e]?this.savedSelectedMemberCollection[e]:this.savedSelectedMemberCollection},_onClickBtnSelectAll:function(){if(!this._isSelectable())return this._memberSelectErrorMessage(),!1;this._getMemberListChildView().selectAllMembers(this.getUI("btnSelectAll").is(":checked"))},_memberSelectErrorMessage:function(){alert(IM("send_an_alert.layer.select_all_error",{maximum:100}))},_refreshSelectAllWrap:function(){if(this._isVirtualMemberTab()&&this._isSearchResult)this._refreshSearchedAllSelectWrap();else{var e=this.collection.length;0!==e?(this.getUI("selectAllWrap").show(),this.getUI("selectAllTotalCount").text(e),this.getUI("btnSelectAll").prop("checked",e===this.collection.where({selected:!0}).length)):this.getUI("selectAllWrap").hide()}},_refreshSearchedAllSelectWrap:function(){var e=this._getMemberListChildView(),t=e.getSearchedMembersCount(),n=e.getSearchedSelectedMembersCount();t?(this.getUI("selectAllWrap").show(),this.getUI("selectAllTotalCount").text(t),this.getUI("btnSelectAll").prop("checked",t===n)):this.getUI("selectAllWrap").hide()},_refreshTabCount:function(){var e=null,t=this.collection.selectedMembers;e=this._isVirtualMemberTab()?this.getUI("selectedVirtualMemberCount"):this.getUI("selectedBandMemberCount"),t&&0!==t.length?e.text(t.length):e.text("")},_canBeAddedVirtualMember:function(){return!(!this._isVirtualMemberTab()||!this._bandData.isManageVirtualMemberPermitted())},_isVirtualMemberTab:function(){return this._tabName===T},_fetchMemberCollection:function(){return this.collection.reset(),this._isVirtualMemberTab()?this._fetchVirtualMemberCollection():this._fetchBandMemberCollection()},_fetchBandMemberCollection:function(){return this.collection.setDataName(C),this._isPost()?this.collection.fetchBandMemberWithFilterDataCollectionForPost(this._makeNotifyParam()):this.collection.fetchBandMemberWithFilterDataCollectionForSchedule(this._schedule.id,this._makeNotifyParam())},_fetchVirtualMemberCollection:function(){return this.collection.setDataName(T),this.collection.fetchVirtualMemberCollectionWithEmail(this._bandNo)},_memberUncheck:function(e){var t=$(e.currentTarget).attr("data-user");this.collection.setSelectedMember(t,!1),this._memberListCheckState()},_setFocusToSearch:function(){return this.getUI("txtQuery").focus(),!1},_setActiveOnInput:function(){this.getUI("txtQuery").val().length>0?(this.getUI("btnSearch").removeClass("-disabled"),this.getUI("btnSearch").addClass("-active")):(this.getUI("btnSearch").addClass("-disabled"),this.getUI("btnSearch").removeClass("-active"),this._resetSearchResult())},_resetSearchResult:function(e){this._isSearchResult=!1,this.getUI("txtQuery").val(""),this._noResultAreaSetting(!1),this._isVirtualMemberTab()&&!e?this._searchVirtualMember(""):e||this._fetchMemberCollection(),this.getUI("btnSearch").addClass("-disabled"),this.getUI("btnSearch").removeClass("-active")},_search:function(){var e=this.getUI("txtQuery").val();return!!e&&(this._isSearchResult=!0,this._isVirtualMemberTab()?(this._searchVirtualMember(e),!1):(this.collection.reset(),this._isPost()?this.collection.searchBandMemberWithFilterDataCollection(e,this._makeNotifyParam()):this.collection.searchScheduleRsvpStatesOfMembersWithFilterDataCollection(e,this._schedule.id,this._makeNotifyParam()),!1))},_makeNotifyParam:function(){if(this._checkMemberSortEnabled()&&this._selectedSortOption.TYPE!=y.TYPE){if(this._isPost())return this._postNo;var e={rsvpState:this._selectedSortOption.TYPE};return this._selectedSortOption.TYPE==v.CUSTOM&&(e.customStateId=this._selectedSortOption.customStateId),e}},_getSelectedMembers:function(){return this.collection.selectedMembers.where({selected:!0})},_refreshBtnConfirmState:function(){var e,t=this._getSelectedMembers();this._isVirtualMemberTab()?this.tabsCount.virtualMember=t.length:this.tabsCount.bandMember=t.length,0===(e=this.tabsCount.virtualMember+this.tabsCount.bandMember)?(this.getUI("btnConfirm").addClass("-disabled").attr("disabled",!0),this.getUI("btnConfirm").text(this._btnConfirmValue)):(this.getUI("btnConfirm").text(this._btnConfirmValue+"("+e+")"),this.getUI("btnConfirm").removeClass("-disabled").attr("disabled",!1))},_renderSelectedMembers:function(){var e=this._getSelectedMembers(),t=[],n=i.template(l);e.length>0&&i.each(e,(function(e){t.push(n({name:e.getName(),profileThumbnail:e.getProfileThumbnail(),userNo:e.getUserNo()}))})),t.length?(this.getUI("selectedMembersWrap").show(),this.getUI("selectedMembers").empty().append(t.join("")).show()):this.getUI("selectedMembersWrap").hide()},_addVirtualMember:function(){if(this._canBeAddedVirtualMember()){var e=p.buildAsLayer(this._bandNo);this.listenTo(e,"add:VirtualMember",i.bind((function(){this._fetchVirtualMemberCollection()}),this))}},_onClickBtnConfirm:function(){this._saveSelectedMemberCollection();var e=this._getSelectedMemberCollection(),t=null,n={band_no:this._bandNo,user_nos:e[C].pluck("userNo").join(","),virtual_member_ids:e[T].pluck("userNo").join(",")},o={band_no:this._bandNo};this._isPost()?(n.post_no=this._postNo,o.post_no=this._postNo,t=g.sendPostEmailToMembers(n)):(n.schedule_id=this._schedule.id,o.schedule_id=this._schedule.id,t=A.sendScheduleEmailToMembers(n)),t.then(i.bind((function(){this._isPost()||this.trigger(E.SEND_LOG,{classifier:f.CLASSIFIER.SEND_SCHEDULE_ALERT,extraData:o}),alert(IM("post.send.email.success")),this.destroy()}),this))},_showVirtualMemberTab:function(){this._onClickBtnVirtualMemberTab()}});return S.EVENT=E,S.openLayer=function(e){var t=s.NOTIFY_POST;e.schedule&&(t=s.NOTIFY_SCHEDULE);var n={collection:d.buildMemberFilterDataCollection(e.bandNo,t,1e3),bandNo:e.bandNo,postNo:e.postNo||null,schedule:e.schedule||null};return _.getCachedBandData(e.bandNo).then(i.bind((function(e){n.bandData=e;var t=new S(n);return c.openWithoutHiding(t),t}),this))},S}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(2),s=n(505),a=n(1128),r=n(509),l=n(9),c=n(1098),d=n(506),u=n(156),h=n(1127),p=n(800),m=n(16),_={COMMENT:{label:IM("comment.download.menu.comment"),value:"excel_only"},COMMENT_AND_ATTACHMENT:{label:IM("comment.download.menu.comment_and_attachment"),value:"excel_and_zip"}},g={downloadCommentList:function(e,t,n){var i=p.openAsLayer({title:IM("ui.label.select_item"),description:IM("comment.download.menu.desc"),confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:[_.COMMENT,_.COMMENT_AND_ATTACHMENT]});i.on(i.EVENT.RADIO_CLICK,(function(e){e.target.value!==_.COMMENT_AND_ATTACHMENT.value||h.supports()||(e.preventDefault(),h.openUnsupportedLayer())})),i.on(i.EVENT.CONFIRM,(function(i){this._downloadCommentList(e,t,n,i===_.COMMENT_AND_ATTACHMENT.value)}),this)},_downloadCommentList:function(e,t,n,o){var s=a.openProgressModal({title:IM("post.menu.download_comments"),desc:IM("ui.label.downloading"),bandCore:e,withoutHiding:!0}),l=e.bandNo,d={band_no:l,content_key:r.buildPostKey(t).toApiParams(!0),purpose:"download"};this._fetchComments(d,s,null,null,0).then(i.bind((function(a){var r=a.comments;this._fetchTotalReplies(l,t,r,a.total,a.fetchedCount,s).then(i.bind((function(t){var i=e.name,a=m(n).format("YYYYMMDD"),r=h.entries();if(o){var d=IM("comment.download.file.attachment_folder_name",{name:i,date:a});this._addAttachmentEntry(r,t,l,[d])}var u=this._createExcelBlob(t),p=IM("comment.download.file.excel_name",{name:i,date:a})+".xlsx";if(!s.isDestroyed())if(s.destroy(),r.size()>0){r.addBlob(l,p,u);var _=IM("comment.download.file.zip_name",{name:i,date:a});h.download({zipName:_,zipEntries:r,bandCore:e})}else c.downloadExcelBlob(u,p)}),this))}),this))},_fetchComments:function(e,t,n,a,r){return n||(n=[]),s.getCommentList(e).then(i.bind((function(e){var s=d.get(e,"items"),l=d.get(e,"paging.previous_params");if(t.isDestroyed())return o.Deferred().reject().promise();var c=r||0;return s&&s.length>0&&(Array.prototype.unshift.apply(n,s),c=r+s.length),a||(a=d.get(e,"total")),t.setProgress(Math.round(c/a*100)),i.isEmpty(l)?{comments:n,total:a,fetchedCount:c}:this._fetchComments(l,t,n,a,c)}),this))},_fetchTotalReplies:function(e,t,n,s,a,r){if(i.isEmpty(n))return o.Deferred().resolve(n);var l=[];return this._fetchRecursiveReplies({bandNo:e,postNo:t,comments:n,total:s,fetchedCount:a,progress:r,commentReplyDataArray:l,nextCommentIndex:0}).then(i.bind((function(){return i.each(l,(function(e){var t=i.findIndex(n,(function(t){return null==t.origin_comment_id&&t.comment_id==e.commentId}));if(!(t<0||i.isEmpty(e.replyComments))){var o=n.slice(0,t+1).concat(e.replyComments);n=o.concat(n.slice(t+1))}})),n}),this))},_fetchRecursiveReplies:function(e){var t=e.bandNo,n=e.postNo,s=e.comments,a=e.total,l=e.fetchedCount,c=e.progress,d=e.commentReplyDataArray,u=e.nextCommentIndex,h=s[u];if(null==h)return o.Deferred().resolve(d);if(null==h.comment_count||0==h.comment_count)return this._fetchRecursiveReplies(i.extend({},e,{nextCommentIndex:u+1,fetchedCount:l}));var p={band_no:t,content_key:r.buildPostCommentKey(n,h.comment_id).toApiParams(!0),purpose:"download"};return this._fetchComments(p,c,[],a,l).then(i.bind((function(t){return d.push({replyComments:t.comments,commentId:h.comment_id}),this._fetchRecursiveReplies(i.extend({},e,{nextCommentIndex:u+1,fetchedCount:t.fetchedCount}))}),this))},_getCommentBody:function(e){var t=e.author,n=e.body,o=null;return e.is_restricted?o=n:t&&t.is_muted?o=IM("comment.muted_author_comment.guide_message"):n&&(o=i.unescape(n.replace(/<(band:.+?)?(?:\s+[^>]*?)+?>(.*?)<\/\1>/gi,"$2"))),null!=e.origin_comment_id&&(o="ㄴ"+(null==o?"":o)),o},_getCommentAttachType:function(e){return e.sticker?IM("sticker"):e.photos?IM("photo"):e.file?e.file.title:e.dropbox_file?e.dropbox_file.name:e.external_file?e.external_file.name:e.audio_duration>0?IM("voice_message"):e.video?IM("video"):""},_createExcelBlob:function(e){var t=i.map(e,(function(e,t){return{A:t+1,B:(e.author||{}).name,C:this._getCommentBody(e)||"",D:this._getCommentAttachType(e),E:l.format.date(e.created_at,"short_date_time")}}),this),n={A:IM("post.comment.excel.header_no"),B:IM("post.comment.excel.header_name"),C:IM("post.comment.excel.header_body"),D:IM("post.comment.excel.header_attach"),E:IM("post.comment.excel.header_created_at")};t.unshift(n);var o=[{data:t,opts:{header:["A","B","C","D","E"],skipHeader:!0}}];return c.createExcelBlob(o)},_addAttachmentEntry:function(e,t,n,i){for(var o=0,s=t.length;o<s;o++){var a=t[o],r=a.author;a.is_restricted||r&&r.is_muted||(a.photos&&this._addPhotoEntry(e,n,a,o,i),a.video&&this._addVideoEntry(e,n,a,o,i),a.audio_duration>0&&this._addAudioEntry(e,n,a,o,i),a.file&&this._addFileEntry(e,n,a,o,i))}},_addPhotoEntry:function(e,t,n,i,o){var s=this._createEntryName(n,i),a=n.photos;if(1!==a.length)for(var r=0,l=a.length;r<l;r++)e.addPhoto(t,s+"_"+(r+1),a[r].url,o);else e.addPhoto(t,s,a[0].url,o)},_addVideoEntry:function(e,t,n,i,o){var s=n.video;if(!s.is_restricted&&!u.isExpiredFile(s.expires_at)){var a=this._createEntryName(n,i),r=this._createEntryContentKey(n);e.addVideo(t,a,r,o)}},_addAudioEntry:function(e,t,n,i,o){var s=this._createEntryName(n,i),a=this._createEntryContentKey(n);e.addAudio(t,s,a,o)},_addFileEntry:function(e,t,n,i,o){var s=n.file;if(!s.is_restricted&&!u.isExpiredFile(s.expires_at)){var a=this._createEntryName(n,i)+"_"+s.title,r=this._createEntryContentKey(n);e.addFile(t,a,r,o)}},_createEntryName:function(e,t){var n=t+1,i=(e.author||{}).name||"";return IM("comment.download.file.attachment_name",{no:n})+"_"+i},_createEntryContentKey:function(e){return"post_comment_comment"===e.content_type?r.buildPostCommentReplyKey(e.post_no,e.origin_comment_id,e.comment_id):r.buildPostCommentKey(e.post_no,e.comment_id)}};e.exports=g},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(26),a=n(155),r=n(590),l=n(1645),c=n(1258),d=n(549),u=n(651),h=n(1248),p=n(1646),m=n(1097),_=n(22),g=n(1039),f=n(1647),b=n(1254),v=n(531),A=n(2035),E=n(510),T=n(889),C=n(2031),y=n(13),M=n(154),I=n(17),S=n(153),w=n(1023),N={MODIFY:{id:"MODIFY",title:IM("schedule.detail.more.button.modify")},DELETE:{id:"DELETE",title:IM("schedule.detail.more.button.delete")},WRITE_POST:{id:"WRITE_POST",title:IM("schedule.detail.button.post")},COPY:{id:"COPY",title:IM("schedule.detail.button.copy_schedule")},COPY_URL:{id:"COPY_URL",title:IM("ui.label.copy_url")},EXPORT:{id:"EXPORT",title:IM("schedule.detail.button.save")},REPORT:{id:"REPORT",title:IM("ui.label.report")},SET_ALARM:{id:"SET_ALARM",title:IM("schedule.detail.button.set_schedule_alarm")},HIDE_BAND_FROM_FEED:{id:"HIDE_BAND_FROM_FEED",title:IM("post.menu.hide_from_feed.for_group_band")},SEND_AN_ALERT:{id:"SEND_AN_ALERT",title:IM("post.menu.send_an_alert")}},D={SCHEDULE_INFO_UPDATED:"SCHEDULE_INFO_UPDATED"},L={OPTION_LIST_OPEN:"OPTION_LIST_OPEN",OPTION_LIST_CLOSE:"OPTION_LIST_CLOSE",DO_ACTION:"DO_ACTION",RESET_SCHEDULE_INFO:"RESET_SCHEDULE_INFO"},O=o.Behavior.extend({initialize:function(e){this._moreOptionListRegionName=e.moreOptionListRegionName,this._moreOptionList=e.moreOptionList,this._resetScheduleInfo(e.scheduleModel),this.listenTo(this.view,L.OPTION_LIST_OPEN,this._openOptionList),this.listenTo(this.view,L.OPTION_LIST_CLOSE,this._closeOptionList),this.listenTo(this.view,L.DO_ACTION,(function(e){this._bandData.loadBandData().then(t.bind((function(){this._isPermittedOption(this._bandData,this._scheduleModel,e)?this._handleMoreOption(e):alert(IM("permission_deny"))}),this))})),this.listenTo(this.view,L.RESET_SCHEDULE_INFO,this._resetScheduleInfo)},_resetScheduleInfo:function(e){this._filteredMoreOptionList=[],this._scheduleModel=e,this._bandNo=e.getBandNo(),this._scheduleId=e.getScheduleId(),this._bandData=a.get(this._bandNo),this._filterMoreOptionList().then(t.bind((function(){this.view.trigger(D.SCHEDULE_INFO_UPDATED,this._filteredMoreOptionList)}),this))},_openOptionList:function(){var e=this.view.getRegion(this._moreOptionListRegionName);if(!e.hasView()){var t=T.build(this._filteredMoreOptionList);this.listenTo(t,T.EVENTS.MENU_SELECTED,this._handleMoreOption),e.show(t)}},_closeOptionList:function(){var e=this.view.getRegion(this._moreOptionListRegionName);e.hasView()&&e.empty()},_filterMoreOptionList:function(){var e=i.Deferred();return this._bandData&&!t.isEmpty(this._filteredMoreOptionList)?e.resolve():(this._bandData.loadBandData().then(t.bind((function(){this._filteredMoreOptionList=t.filter(this._moreOptionList,t.bind((function(e){return this._isPermittedOption(this._bandData,this._scheduleModel,e.id)}),this)),e.resolve()}),this)),e.promise())},_isPermittedOption:function(e,t,n){switch(n){case N.MODIFY.id:return!!t.isNormalScheduleType()&&(t.isMySchedule()||e.isModifySchedulePermitted());case N.DELETE.id:return!!t.isNormalScheduleType()&&(t.isMySchedule()||e.isDeleteSchedule());case N.WRITE_POST.id:return e.isPostingPermitted();case N.COPY.id:return y.isLogedIn()&&t.isNormalScheduleType();case N.COPY_URL.id:return!!this._scheduleModel.getScheduleId();case N.EXPORT.id:return!0;case N.REPORT.id:return y.isLogedIn()&&!t.isMySchedule()&&t.isNormalScheduleType();case N.SET_ALARM.id:return t.isExternalScheduleType()&&e.isConfigureSchedulePermitted();case N.HIDE_BAND_FROM_FEED.id:return!0;case N.SEND_AN_ALERT.id:return e.isNotifyVirtualMemberPermitted()||e.isNotifyMemberPermitted();default:return!1}},_handleMoreOption:function(e){switch(e){case N.MODIFY.id:this._handleModify();break;case N.DELETE.id:this._handleDelete();break;case N.WRITE_POST.id:this._handleWritePost();break;case N.COPY.id:this._handleCopy();break;case N.COPY_URL.id:this._handleCopyUrl();break;case N.EXPORT.id:this._handleExport();break;case N.REPORT.id:this._handleReport();break;case N.SET_ALARM.id:this._handleSetAlarm();break;case N.HIDE_BAND_FROM_FEED.id:this._handleHideBandFromFeed();break;case N.SEND_AN_ALERT.id:this._handleSendAnAlert()}},_handleModify:function(){p.buildDScheduleModificationViewOpener({scheduleEditModel:c.createScheduleEditModelBy(this._scheduleModel.clone(),!1),bandData:this._bandData}).openScheduleEditLayerForModification(this)},_handleDelete:function(){l.checkRecurrenceThenDeleteSchedule(this._scheduleModel,this)},_handleWritePost:function(){r.isContentCreationPunished()||s.getPostChannel().trigger(s.EVENT.NEW_POST_WITH_SCHEDULE,this._bandData,this._scheduleModel.clone())},_handleCopy:function(){if(!r.isContentCreationPunished())if(this._scheduleModel.isLocalMeetup()){var e=E.openLayer({bodyTitle:IM("schedule.copy_will_be_local_meetup_to_normal_schedule"),withoutHiding:!0});this.listenToOnce(e,E.EVENTS.CONFIRM,(function(){this._openScheduleCopyView()}))}else this._openScheduleCopyView()},_openScheduleCopyView:function(){var e=m.openLayer({title:IM("web.inviteband.btn.choice_band"),selectionType:m.SELECTION_TYPE.MULTIPLE_SELECT,excludedBandNos:[this._scheduleModel.getBandNo()],bandTypes:[_.BAND_TYPE.GROUP],groupBandFilters:[g.BAND_FILTER.REGISTER_SCHEDULE],pageBandFilters:[],withoutHiding:!0});this.listenTo(e,"multipleBand:selected",t.bind((function(e){var n=this._bandNo,o=this._scheduleId,s=e[0].bandNo,r=t.every(e,(function(e){return 1==e.currentUserPostingPermitted})),l=a.get(s),p=d.createExistingScheduleModel(n,o,v.API_CONSTANT.SCHEDULE_COPY);M.wrapActivePromise(i.when(l.loadBandData(),p.fetchSchedule()),this.view).then(t.bind((function(){var t=c.createScheduleEditModelBy(p,!0);t.setScheduleId(null),t.setCalendar(null),t.setIsLocalMeetup(!1),t.setIsSecret(!1),t.createSecretSharers(null);var i=this._createEditDescription(e),s=h.openScheduleEditLayer({scheduleEditModel:t,bandData:l,recurringEditType:u.EDIT_TYPE.ALL,canPostAnnounceForCopy:r,isEditForCopy:!0,shouldHideSecretSelect:e.length>1,editDescription:i,sourceBandNo:n,postAttachable:!0});this.listenTo(s,h.EVENT.SCHEDULE_EDIT_COMPLETE,(function(t){this._handleCopySubmit({sourceBandNo:n,sourceScheduleId:o,copyTargetBands:e,editLayer:s,announceable:t.announceable,scheduleEditModel:t.scheduleEditModel})}))}),this))}),this))},_createEditDescription:function(e){var n=t.escape(e[0].name);return 1===e.length?n:IM("web.sharedpostwrite.label.band_names",{name:n,count:e.length-1})},_handleCopySubmit:function(e){var n=e.sourceBandNo,i=e.sourceScheduleId,o=e.copyTargetBands,s=e.announceable,a=e.editLayer,r=t.chain(o).rest().pluck("bandNo").value();e.scheduleEditModel.toScheduleModel(this._bandNo).copyEditedSchedule(s,n,i,o[0].bandNo,r).then(t.bind((function(){alert(IM("schedule.msg.copy_schedule_complete")),a.destroy()}),this)).always(t.bind((function(){a.stopSubmitPending()})))},_createSubmitHandlerForScheduleCopy:function(e){var n=e.sourceBandNo,i=e.sourceScheduleId,o=e.copyTargetBands;return function(e){var s=e.announceable,a=t.chain(o).rest().pluck("bandNo").value();e.scheduleEditModel.toScheduleModel(this._bandNo).copyEditedSchedule(s,n,i,o[0].bandNo,a).then(t.bind((function(){alert(IM("schedule.msg.copy_schedule_complete"))}),this))}},_handleCopyUrl:function(){var e=this._bandData.getBandCore(),t=S.GROUP_BAND_SCHEDULE.makeUrl({band_no:e.bandNo,schedule_id:this._scheduleModel.getScheduleId()});w.openUrlCopyLayerView(I.appendCurrentDomainOnPathUrl(t))},_handleExport:function(){f.openAsLayer({bandData:this._bandData,isDetailView:!0,detailViewModel:this._scheduleModel,calendarInfo:this._scheduleModel.get("calendar")})},_handleReport:function(){b.build({contentType:v.REPORT.TYPE.SCHEDULE,bandNo:this._scheduleModel.getBandNo(),owner:this._scheduleModel.getOwner(),recurrence:this._scheduleModel.get("recurrence"),scheduleId:this._scheduleModel.get("scheduleId")})},_handleSetAlarm:function(){A.openAsLayer({bandNo:this._scheduleModel.getBandNo(),scheduleId:this._scheduleModel.get("scheduleId"),isAllDay:this._scheduleModel.get("isAllDay"),alarms:this._scheduleModel.get("alarms"),personalAlarms:this._scheduleModel.get("personalAlarms")})},_handleHideBandFromFeed:function(){var e=this._scheduleModel.getBandCore();E.openLayer({headerTitle:IM("feed.hide_from_my_feed.confirm.title",{bandName:e.name}),bodyDesc:IM("feed.hide.confirm.desc"),withoutHiding:!0}).once(E.EVENTS.CONFIRM,t.bind((function(){s.getFeedChannel().trigger(s.EVENT.HIDE_BAND_FROM_FEED,e.bandNo)}),this))},_handleSendAnAlert:function(){var e=this,t={bandNo:this._scheduleModel.getBandNo(),schedule:{id:this._scheduleModel.get("scheduleId"),rsvp:!!this._scheduleModel.get("rsvp"),scheduleRsvpModel:this._scheduleModel.get("rsvp")}};C.openLayer(t).then((function(t){e.listenTo(t,C.EVENT.SEND_LOG,(function(t){e.view.jplClick(t.classifier,t.extraData)}))}))}});return O.SCHEDULE_MORE_OPTION=N,O.TRIGGERING_EVENTS=D,O.LISTENING_EVENTS=L,O}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(4),s=n(2490),a=o.View.extend({template:i.template(s),templateContext:function(){return{title:this._title,checkMessage:this._checkMessage}},ui:{btnCancel:"._btnCancel",btnConfirm:"._btnConfirm",checkInput:"._checkInput"},events:{"click @ui.btnCancel":function(){this.trigger("schedule:confirm:cancel"),this.destroy()},"click @ui.btnConfirm":function(){var e=this.ui.checkInput.is(":checked");this.trigger("schedule:confirm",e),this.destroy()}},initialize:function(e){this._title=e.title,this._checkMessage=e.checkMessage}});a.buildDScheduleCheckOptionConfirmView=function(e){return new a(e)},e.exports=a},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(2),s=n(486),a=n(593),r=n(724),l=n(154),c=n(26),d=n(2492),u=n(2494),h=t.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DScheduleEditAlarmLayerView"},template:i.template(u),ui:{alarmSelectRegion:"._alarmSelectRegion",btnCancel:"._btnCancel",btnConfirm:"._btnConfirm"},regions:{alarmSelectRegion:{el:"@ui.alarmSelectRegion",replaceElement:!0}},events:{"click @ui.btnCancel":"destroy","click @ui.btnConfirm":"_setScheduleAlarm"},initialize:function(e){this.model=e.model,this.bandNo=e.bandNo,this.scheduleId=e.scheduleId,this.isAllDay=e.isAllDay,this.alarms=e.alarms,this.personalAlarms=e.personalAlarms,this.isPersonalAlarm=e.isPersonalAlarm,this.updateTargetAlarm=e.updateTargetAlarm,this.dScheduleAlarmOptionListView=d.build({model:this.model,isAllDay:this.isAllDay,alarms:this.alarms,personalAlarms:this.personalAlarms,updateTargetAlarm:this.updateTargetAlarm}),this.listenTo(this.dScheduleAlarmOptionListView,"alarmOption:selectAlarm",(function(){this._adaptButtonStyle()})),this.listenTo(this.dScheduleAlarmOptionListView,"scheduleCustomAlarmView:changed",(function(){this._adaptButtonStyle()}))},serializeData:function(){return{isPersonalAlarm:this.isPersonalAlarm,layerWidth:this.isAllDay?"-w425":"-w340"}},onRender:function(){this.showChildView("alarmSelectRegion",this.dScheduleAlarmOptionListView),this.updateTargetAlarm&&this.getUI("btnConfirm").prop("disabled",!0)},_adaptButtonStyle:function(){this.getUI("btnConfirm").prop("disabled",!1)},_setScheduleAlarm:function(){var e;e=this.isPersonalAlarm?this._setSchedulePersonalAlarm():this._setExternalScheduleAlarm(),l.wrapActivePromise(e,this).then(i.bind((function(){c.getDGlobalChannel().trigger(c.EVENT.SCHEDULE_UPDATED,{bandNo:this.bandNo,exScheduleId:this.scheduleId,scheduleId:this.scheduleId}),this.destroy()}),this))},_setSchedulePersonalAlarm:function(){var e=[];return a.isExistingAlarm(i.union(this.alarms.models,this.personalAlarms.models),this.model)?(alert(IM("schedule.alarm.set_personal_alarm.notice.existing_alarm")),o.Deferred().reject()):(this.updateTargetAlarm&&this.updateTargetAlarm.model&&this.personalAlarms.remove(this.updateTargetAlarm.model),i.each(this.personalAlarms.models,(function(t){e.push(t.toJSONForSave())})),this.model.isValidWith(this.isAllDay)&&e.push(this.model.toJSONForSave()),this.model.setSchedulePersonalAlarm(this.bandNo,this.scheduleId,e))},_setExternalScheduleAlarm:function(){var e=[];return this.model.isValidWith(this.isAllDay)&&e.push(this.model.toJSONForSave()),this.model.setExternalScheduleAlarm(this.bandNo,this.scheduleId,e)}});return h.openAsLayer=function(e){var t={model:new r,bandNo:e.bandNo,scheduleId:e.scheduleId,isAllDay:e.isAllDay,alarms:e.alarms,personalAlarms:e.personalAlarms};e.isPersonalAlarm&&(t.isPersonalAlarm=e.isPersonalAlarm),e.updateTargetAlarm&&(t.updateTargetAlarm=e.updateTargetAlarm);var n=new h(t);return s.openWithoutHiding(n),n},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(82),s=n(611),a=(n(531),n(1121)),r=n(2495),l=n(833),c=i.View.extend({options:{index:0,thumbnailType:"1:1",lastItem:!1,moreItemCount:0,fullWidthOfParent:496},tagName:"LI",className:"collageItem",template:t.template(r),thumbnailTypeSet:{dynamic:o.TYPE.w520,"1:1":o.TYPE.s480,"2:1":o.TYPE.ff640_320,"2:3":o.TYPE.ff500_750,"3:2":o.TYPE.ff750_500},_getPhotoRenderOption:function(){return"dynamic"===this.options.thumbnailType?this.options.width/this.options.height<this.options.fullWidthOfParent/80?{thumbnailType:o.TYPE.w520,contentClass:""}:{thumbnailType:o.TYPE.w520,contentClass:"gCenterItem"}:{thumbnailType:this.thumbnailTypeSet[this.options.thumbnailType],contentClass:""}},templateContext:function(){var e=this._getPhotoRenderOption();return{photoUrl:o.make(this.options.photoUrl,e.thumbnailType),contentClass:e.contentClass,lastItem:this.options.lastItem,moreImageCount:this.options.moreItemCount}},ui:{clickarea:"._clickarea"},triggers:{"click @ui.clickarea":"click"}}),d=i.CollectionView.extend({options:{photos:[],collageType:"square",maxCollageItemCount:5},tagName:"UL",attributes:function(){return{"data-viewname":"DSchedulePhotoCollageView","data-collage":Math.min(this.options.photos.total_count,this.options.maxCollageItemCount)}},className:function(){return"uCollage "+d.CollageType[this.options.collageType].additionalClass},onDomRefresh:function(){var e=this.$el.width(),n=Math.min(this.options.photos.photos.length,this.options.maxCollageItemCount),i=d.CollageType[this.options.collageType].itemScales[n];t.each(i,(function(t,i){var o=this.options.photos.photos[i];this.addChildView(new c({fullWidthOfParent:e,photoUrl:o.photo_url,width:o.width,height:o.height,thumbnailType:t[0],index:i,lastItem:n===i+1,moreImageCount:this.options.photos.photos.length-n}),this.options.maxCollageItemCount)}),this)},childViewEvents:{click:function(e){var t=[l.MEDIA_MORE_OPTION.SAVE_TO_ALBUM];this.getOption("reportSupport")&&t.push(l.MEDIA_MORE_OPTION.REPORT),s.openDPhotoVideoImageViewer({result_data:this.getOption("photos"),bandNo:this.getOption("bandNo"),postNo:this.getOption("postNo"),openIndex:e.getOption("index"),goPostSupport:!1,profileViewSupport:!1,owner:this.getOption("owner"),moreOptionList:t,schedulePhotoReportBaseOptions:{bandNo:this.getOption("bandNo"),owner:this.getOption("owner"),recurrence:this.getOption("recurrence"),scheduleId:this.getOption("scheduleId")}})}}});d.CollageType={horizontal:{additionalClass:"-horizontal",itemScales:{1:[["dynamic","big"]],2:[["2:1","big"],["2:1","big"]],3:[["2:1","big"],["1:1","big"],["1:1","big"]],4:[["3:2","big"],["1:1","middle"],["1:1","middle"],["1:1","middle"]],5:[["1:1","big"],["1:1","big"],["1:1","big"],["1:1","big"],["1:1","big"]]}},vertical:{additionalClass:"-vertical",itemScales:{1:[["dynamic","big"]],2:[["2:3","big"],["2:3","big"]],3:[["2:3","big"],["1:1","big"],["1:1","big"]],4:[["2:3","big"],["1:1","middle"],["1:1","middle"],["1:1","middle"]],5:[["1:1","big"],["1:1","big"],["1:1","big"],["1:1","big"],["1:1","big"]]}},square:{additionalClass:"-square",itemScales:{1:[["dynamic","big"]],2:[["1:1","big"],["1:1","big"]],3:[["1:1","big"],["1:1","middle"],["1:1","middle"]],4:[["1:1","big"],["1:1","big"],["1:1","big"],["1:1","big"]],5:[["1:1","big"],["1:1","big"],["1:1","big"],["1:1","big"],["1:1","big"]]}}};var u=a.create(["vertical",[1,"square"],"horizontal"]);return d.buildDSchedulePhotoCollageView=function(e){return e.reportSupport=e.reportSupport||!1,e.collageType=function(e){if(2===Math.min(e.length,5)){var t=u.identify(e[0].width/e[0].height);return t===u.identify(e[1].width/e[1].height)?t:"square"}return u.identify(e[0].width/e[0].height)}(e.photos.photos),new d(e)},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2498),s=n(154),a=n(933),r=n(850),l=n(155),c=n(848),d=n(630),u=i.View.extend({tagName:"li",className:"fileItem",attributes:{"data-viewname":"DScheduleFileListItemView"},template:t.template(o),templateContext:function(){var e=c.generateTemplateData(this.model)||{};return{attachFileSize:e.attachFileSize,attachFileInfo:e.attachFileInfo,attachFileName:e.attachFileName,isQuotaStatus:this._isQuotaStatus()}},ui:{downloadFile:"._downloadFile",settingSave:"._settingSave"},events:{"click @ui.downloadFile":function(){return this._downloadProgress||this.options.clickDisabledPostTypeOnDetail||!this._bandData.canUseScheduleFunctions()||(this._downloadProgress=!0,r.downloadBandFile(c.generateFileDownloadData(this._bandNo,this.model)).then(t.bind((function(){this._downloadProgress=!1}),this))),!1},"click @ui.settingSave":"_fileQuotaSettingController"},initialize:function(e){this._bandNo=e.bandNo,this._bandData=l.get(this._bandNo)},_isQuotaStatus:function(){return this.model instanceof d&&a.canSetFileIntoQuota(this._bandNo,this.model.getExpiresAt(),this.model.getFileSize())},_fileQuotaSettingController:function(e){e.stopPropagation();var n=a.startSettingFileIntoQuota({bandNo:this._bandNo,fileId:this.model.getId(),withoutHiding:!0});s.wrapActivePromise(n,this).then(t.bind((function(){this.model.set("expiresAt",null),this.render()}),this))}}),h=i.CollectionView.extend({tagName:"ul",className:"fileArea",childView:u,childViewOptions:function(){return{bandNo:this._bandNo,clickDisabledPostTypeOnDetail:this.options.clickDisabledPostTypeOnDetail}},initialize:function(e){this._bandNo=e.bandNo}});return h.buildDScheduleFileListView=function(e,t,n,i,o){var s=(t||new Backbone.Collection).clone();return s.add((n||new Backbone.Collection).models),s.add((i||new Backbone.Collection).models),new h({clickDisabledPostTypeOnDetail:o,bandNo:e,collection:s})},h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(16),s=n(159),a=n(486),r=n(499),l=n(498),c=n(834),d=n(531),u=n(511),h=n(2501),p=n(2503),m=n(154),_=n(2515),g=n(1629),f=n(503),b=n(610),v=t.View.extend({attributes:{"data-viewname":"DScheduleRsvpView"},className:"scheduleRsvpArea",behaviors:[s],getTemplate:function(){return this._loading?i.template(l):i.template(_)},templateContext:function(){return this._loading?{_loading_size:r.Size.MEDIUM}:{getRsvpUserList:function(e){return i.map(e,(function(e){return e.name})).join(", ")},canShowRsvpUser:this.model.isRsvpVisibleToViewer(),statusType:u,canAddChildMember:this._canAddChildMember,isMaybeEnabled:this.model.isMaybeEnabled(),customRsvpList:this.model.getCustomRsvpStatusList(),canShowRsvpStateMember:i.bind((function(e){return this._canShowRsvpStateMemberList(e)}),this),canCheckRsvpItem:i.bind((function(e){return this._canCheckRsvpStateItem(e)}),this),needShowRsvpVisibleDescription:this.model.isRsvpVisibleQualificationOnlyManager(),isSecret:this.isSecret}},ui:{radioAttend:"._radioAttend",radioPendingAttend:"._radioPendingAttend",radioAbsent:"._radioAbsent",radioMaybe:"._radioMaybe",pendingAttendArea:"._pendingAttendArea",btnOpenAttendee:"._btnOpenAttendee",btnOpenPendingAttendee:"._btnOpenPendingAttendee",btnOpenAbsentee:"._btnOpenAbsentee",btnOpenMaybe:"._btnOpenMaybe",btnOpenNonresponse:"._btnOpenNonresponse",addChildMember:"._addChildMember",replyCustomStatus:"._replyCustomStatus",btnOpenRsvpUserList:"._btnOpenRsvpUserList"},events:function(){return this.options.clickDisabledPostTypeOnDetail||!this.options.bandData.canUseScheduleFunctions()?{}:{"click @ui.radioAttend":"_replyScheduleRsvp","click @ui.radioPendingAttend":"_replyScheduleRsvp","click @ui.radioAbsent":"_replyScheduleRsvp","click @ui.radioMaybe":"_replyScheduleRsvp","click @ui.btnOpenAttendee":"_openRsvpUserList","click @ui.btnOpenPendingAttendee":"_openRsvpUserList","click @ui.btnOpenAbsentee":"_openRsvpUserList","click @ui.btnOpenMaybe":"_openRsvpUserList","click @ui.btnOpenNonresponse":"_openRsvpUserList","click @ui.addChildMember":"_addRsvpChildMember","click @ui.replyCustomStatus":"_replyScheduleRsvp","click @ui.btnOpenRsvpUserList":"_openRsvpUserList"}},modelEvents:{change:"render"},initialize:function(e){this._loading=!0,this.model=e.model,this.scheduleId=e.scheduleId,this.bandNo=e.bandNo,this.loginUserNo=e.loginUserNo,this.isAuthor=e.isAuthor,this.isSecret=e.isSecret,this._bandData=this.options.bandData,this._clickDisabled=1==this.options.clickDisabledPostTypeOnDetail},onDomRefresh:function(){this._loading||(this._afterRsvpEndedAt=this._isAfterRsvpEndedAt(),this._showRsvpState())},onAttach:function(){this.rsvpMemberModel=c.build(),m.wrapActivePromise(this._bandData.loadBandData(this.bandNo),this).then(i.bind((function(){this._loading=!1,this._afterRsvpEndedAt=this._isAfterRsvpEndedAt(),this._changeBandMemberRsvpStatePermitted=this._bandData.canChangeBandMemberRsvpItem(this.isAuthor),this._changeMyRsvpStatePermitted=this._bandData.canChangeMyRsvpItem(this.isAuthor,this._afterRsvpEndedAt),this._addRsvpChildMemberPermitted=this._bandData.canAddRsvpChildMember(this.isAuthor,this._afterRsvpEndedAt),this._canAddChildMember=this.model.isChildMemberAddible()&&this._addRsvpChildMemberPermitted,this.render()}),this))},_refreshRsvpDataAndNotifyUpdated:function(e){this.model.refreshRsvpData(e.toJSON()),this.spawn(s.MSG.SCHEDULE_RSVP_CHANGED)},_canShowRsvpStateMemberList:function(e){if(!this.model.isRsvpVisibleToViewer())return!1;var t;switch(e){case u.ATTENDANCE:t=this._changeBandMemberRsvpStatePermitted||this.model.isAttendeeExist();break;case u.PENDING_ATTENDANCE:t=this._canShowPendingAttendeeList();break;case u.ABSENCE:t=this._changeBandMemberRsvpStatePermitted||this.model.isAbsenteeExist();break;case u.MAYBE:t=this._changeBandMemberRsvpStatePermitted||this.model.isMaybeExist();break;case u.NONRESPONSE:t=this._changeBandMemberRsvpStatePermitted||this.model.isNonresponseExist();break;case u.CUSTOM:t=this._changeBandMemberRsvpStatePermitted}return t},_canCheckRsvpStateItem:function(e){switch(e){case u.ATTENDANCE:return this._canCheckAttendance();case u.PENDING_ATTENDANCE:return this._canCheckPendingAttendance();case u.ABSENCE:case u.MAYBE:case u.CUSTOM:return!this._clickDisabled&&this._changeMyRsvpStatePermitted}},_isAfterRsvpEndedAt:function(){if(null==this.model.get("endedAt"))return!1;var e=o(),t=o(this.model.get("endedAt"));return e.isAfter(t)},_showRsvpState:function(){switch(this.model.get("viewerRsvpState")){case u.ATTENDANCE:this.getUI("radioAttend")[0].checked=!0;break;case u.PENDING_ATTENDANCE:this.getUI("radioPendingAttend")[0].checked=!0;break;case u.ABSENCE:this.getUI("radioAbsent")[0].checked=!0;break;case u.MAYBE:this.getUI("radioMaybe")[0].checked=!0;break;case u.CUSTOM:var e=i.filter(this.ui.replyCustomStatus,i.bind((function(e){if($(e).data("customStateId")==this.model.getViewerCustomStateId())return e}),this));$(e).prop("checked",!0)}this.model.isAttendanceExcess()&&this.getUI("pendingAttendArea").css("display","table")},_isSelectedStateEqualToCurrentState:function(e,t){return e==this.model.get("viewerRsvpState")&&(e==u.CUSTOM?t==this.model.getViewerCustomStateId():e==this.model.get("viewerRsvpState"))},_replyScheduleRsvp:function(e){e.preventDefault();var t=$(e.currentTarget).val(),n=$(e.currentTarget).data("customStateId");this._isSelectedStateEqualToCurrentState(t,n)?t=u.NONRESPONSE:t!=this.model.get("viewerRsvpState")&&t==u.PENDING_ATTENDANCE&&(t=u.ATTENDANCE);var o={bandNo:this.bandNo,scheduleId:this.scheduleId,rsvpState:t,userNo:this.loginUserNo,customStateId:n};this.rsvpMemberModel.setUserRsvpState(o).then(i.bind((function(e){this._refreshRsvpDataAndNotifyUpdated(e.updatedRsvpInfo)}),this),i.bind((function(e){this._refreshRsvpDataAndNotifyUpdated(e.updatedRsvpInfo)}),this))},_openRsvpUserList:function(e){if(e.preventDefault(),!this.model.isRsvpVisibleToViewer())return!1;var t=$(e.currentTarget).data("statustype"),n=$(e.currentTarget).data("customStateId");p.openDRsvpPresentStateViewAsLayer(this.model,{openWithType:t,bandNo:this.bandNo,scheduleId:this.scheduleId,isAuthor:this.isAuthor,isMaxAttendeeCount:this.model.isAttendanceExcess(),afterRsvpEndedAt:this._afterRsvpEndedAt,bandData:this._bandData,changeOthersRsvpStatePermitted:this._changeBandMemberRsvpStatePermitted,customStateId:n})},_addRsvpChildMember:function(e){if(e.preventDefault(),!this.options.bandData.canAddRsvpChildMember())return!1;this._openRsvpChildMemberManageView()},_openRsvpChildMemberManageView:function(){var e={bandNo:this.bandNo,scheduleId:this.scheduleId};this.model.getMyRsvpChildMemberList(e).then(i.bind((function(e){var t=this._changeBandMemberRsvpStatePermitted?d.RSVP.ATTENDEE_MAX_COUNT:this.model.get("childMemberLimit");if(t&&e.length>=t)alert(IM("schedule.view.rsvp.add_child_member.alert.max_child_member_limit",{maxCount:this.model.get("childMemberLimit")}));else{var n=h.buildDRsvpStatusItemSelectView(this.model.getMemberSelectableRsvpStatus());a.open(n),this.listenTo(n,"selected:rsvpState",i.bind((function(t){this.rsvpState=t.rsvpState,this.rsvpState==u.CUSTOM&&(this.customStateId=t.customStateId),this.rsvpState==u.PENDING_ATTENDANCE&&(this.rsvpState=u.ATTENDANCE),this._openChildMemberListView(e)}),this))}}),this))},_openChildMemberListView:function(e){var t=i.map(e,(function(e){return e.member.child_membership_id})),n=g.buildChildMemberListView({bandNo:this.bandNo,unselectableChildMembers:t});a.open(n),this.listenTo(n,"confirm:addChildMembers",i.bind((function(t){var o=this._changeBandMemberRsvpStatePermitted?d.RSVP.ATTENDEE_MAX_COUNT:this.model.get("childMemberLimit");if(o&&e.length+t.length>o)alert(IM("schedule.view.rsvp.add_child_member.alert.max_child_member_limit",{maxCount:o}));else{var s=i.map(t,i.bind((function(e){return{userNo:this.loginUserNo,childMembershipId:e.childMembershipId}}),this));f.setScheduleRsvpStates(this.bandNo,this.scheduleId,s,this.rsvpState,this.customStateId).then(i.bind((function(e){var t=e.result_data,i=new b(t.rsvp,{parse:!0});this._refreshRsvpDataAndNotifyUpdated(i),n.destroy()}),this))}}),this))},_canCheckAttendance:function(){return!this._clickDisabled&&!!(this.model.isViewerAttendanceState()||this._changeMyRsvpStatePermitted&&!this.model.isAttendanceExcess())},_canCheckPendingAttendance:function(){return!!this.model.isAttendanceExcess()&&(!(this._clickDisabled||!this._changeMyRsvpStatePermitted)&&!this.model.isViewerAttendanceState())},_canShowPendingAttendeeList:function(){return!!this.model.isAttendanceExcess()&&(this._changeBandMemberRsvpStatePermitted||this.model.isPendingAttendeeExist())}});return v.buildDScheduleRsvpView=function(e){return new v({model:e.model,scheduleId:e.scheduleId,bandNo:e.bandNo,loginUserNo:e.loginUserNo,isAuthor:e.isAuthor,isSecret:e.isSecret,bandData:e.bandData,clickDisabledPostTypeOnDetail:e.clickDisabledPostTypeOnDetail})},v}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(503),s=n(511),a=n(834),r=n(610),l=n(504),c=n(52),d=t.Collection.extend({model:a,setScheduleRsvpStates:function(e){var t=e.bandNo,n=e.scheduleId,a=e.userNoList,c=e.rsvpState,d=e.customStateId,u=[];return i.map(a,(function(e){u.push({userNo:e})})),o.setScheduleRsvpStates(t,n,u,c,d).then(i.bind((function(e){var t=e.result_data,n=new r(t.rsvp,{parse:!0}),o=t.affected_rsvp_states[s.PENDING_ATTENDANCE],a=[];return o&&o.length>0&&(a=i.map(o,(function(e){return new l(e,{parse:!0})}))),{updatedRsvpInfo:n,pendingAttendanceMemberList:a}}),this))}});return d.build=function(){return new d([])},d.buildWithMemberList=function(e,t,n,s){return o.getRsvpMembers(e,t,n,s).then(i.bind((function(n){return n=c.camelizeKeys(n),new d(n.members,{parse:!0,bandNo:e,scheduleId:t})}),this))},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(0),o=n(10),s=n(486),a=n(4),r=n(2522),l=n(2524),c=a.CollectionView.extend({tagName:"ul",className:"listLine rScroll -lrSpace",emptyView:a.View.extend({tagName:"p",className:"uEmpty -h400",template:i.template('<span><%- IM("ui.message.no_search_result") %></span>')}),filterMember:function(e){this.filter=function(t){return""===e?null:o.include(t.getName().toLowerCase(),e.toLowerCase())},this.reorder()},resetFilter:function(){this.filter=null,this.reorder()}}),d=a.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DScheduleSharerListLayerView"},template:i.template(l),templateContext:function(){return{memberCount:this.model.getSecretSharers().length}},ui:{memberListRegion:"._memberListRegion",backBtn:"._backBtn",searchInput:"._searchInput",searchBtn:"._searchBtn",searchForm:"._searchForm",confirmBtn:"._confirmBtn"},regions:{memberListRegion:{el:"@ui.memberListRegion",replaceElement:!0}},events:{"click @ui.backBtn":"destroy","input @ui.searchInput":function(e){this._checkEmptyAndReset(e.target.value),this._toggleSearchBtn(e.target.value)},"click @ui.searchBtn":function(){},"click @ui.confirmBtn":"destroy","submit @ui.searchForm":"_filterMember"},initialize:function(e){this.model=e.model,this.bandCore=e.bandCore},onDomRefresh:function(){this._toggleSearchBtn(this.ui.searchInput.val()),this._renderList()},_renderList:function(){this.collectionView=new c({childView:r,childViewOptions:{bandCore:this.bandCore},collection:this.model.getSecretSharers(),viewComparator:"userNo"}),this.showChildView("memberListRegion",this.collectionView)},_filterMember:function(e){if(e.preventDefault(),this.collectionView){var t=this.getUI("searchInput").val();this.collectionView.filterMember(t)}},_checkEmptyAndReset:function(e){o.isBlank(e)&&this.collectionView.resetFilter()},_toggleSearchBtn:function(e){var t=o.isBlank(e);this.ui.searchBtn.prop("disabled",t).toggleClass("-disabled",t).toggleClass("-active",!t)}});d.openAsLayer=function(e){var t=new d({model:e.model,bandCore:e.bandCore});return s.open(t),t},e.exports=d},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(2),s=n(4),a=n(52),r=n(623),l=n(1094),c=n(508),d=n(159),u=n(1005),h=n(154),p=n(505),m=n(26),_=n(1038),g=n(1013),f=n(560),b=n(1032),v=n(509),A=s.View.extend({template:i.template('<div class="_commentListRegion"></div>'),attributes:{"data-viewname":"DScheduleCommentListView"},behaviors:[d],ui:{commentListRegion:"._commentListRegion"},regions:{commentListRegion:{el:"@ui.commentListRegion",replaceElement:!0}},onMessages:(t={},t[d.MSG.COMMENT_GO_FIRST_COMMENT]=function(){this._fetchFirstCommentList()},t[d.MSG.COMMENT_PREVIOUS_MORE]=function(){this._fetchPreviousAndNextAllCommentList()},t[d.MSG.COMMENT_NEXT_MORE]=function(){this._fetchNextCommentList()},t[d.MSG.COMMENT_DELETE_COMMENT]=function(e){this._deleteComment(e)},t[d.MSG.COMMENT_SUBMIT_MODIFICATION]=function(e){this._modifyComment(e)},t[d.MSG.COMMENT_SHOW_VIDEO_CLICK]=function(e){this._checkAndShowVideo(e)},t[d.MSG.EMOTIONLIST_LAYER_OPEN]=function(e){var t=null!=e.originCommentId?b.SCHEDULE_COMMENT_COMMENT:b.SCHEDULE_COMMENT,n=v.buildByAttributes({scheduleId:this._scheduleId,originCommentId:e.originCommentId,commentId:e.commentId,contentType:t.getContentTypeKey()});_.openDEmotionListView(this._bandNo,n)},t[d.MSG.EMOTION_SELECT_LAYER_OPEN]=function(e){this._openEmotionSelectLayer(e)},t[d.MSG.VIDEO_AUTO_PLAY]=function(e){e.processAutoPlay()},t),passMessages:function(){var e={};return e[d.MSG.COMMENT_AREA_CLICKED]=d.MSG.PROPAGATION_STOP,e}(),initialize:function(e){this._bandData=e.bandData,this._bandNo=this._bandData.getBandNo(),this._scheduleId=e.scheduleId,this._isCommentingPermitted=this._bandData.canWriteComment(),this._commentCollection=this._createCommentCollection(),this._initCommentId=e.initCommentId,this._initCommentReplyId=e.initCommentReplyId,this._mentionOption=e.mentionOption},onAttach:function(){this._commentCollectionView=l.buildDCommentCollectionView({maxMessageLength:c.MAX_LENGTH,overMaxLengthAlertMessage:IM("comment.over_max_message",{count:c.MAX_LENGTH}),isCommentingPermitted:this._isCommentingPermitted,replySupport:this._bandData.canWriteReply(),canUsePaging:this._bandData.canMoveToMoreComment(),canExpressEmotion:this._bandData.canExpressEmotionOnComment(),canOpenMediaViewer:this._bandData.canOpenMediaViewerOnComment(),canDownloadFile:this._bandData.canDownloadFileOnComment(),canOpenSnippetUrl:this._bandData.canOpenSnippetUrlOnComment(),mentionOption:this._mentionOption}),this.showChildView("commentListRegion",this._commentCollectionView),this._initCommentId?h.wrapActivePromise(this.fetchAroundComment(this._initCommentId),this).then(i.bind((function(){null!=this._initCommentReplyId?this._commentCollectionView.renderReplyListAndFocus(this._initCommentId,this._initCommentReplyId):this._commentCollectionView.scrollToComment(this._initCommentId)}),this)):this._fetchLastCommentList()},fetchAroundComment:function(e){return this._commentCollection.fetchAroundCommentList(e).then(i.bind((function(e){this._commentCollectionView.setOldestCommentShow(!1),this._populateFetchedCollectionWithReset(e)}),this))},scrollToCommentWithDelay:function(e){this._commentCollectionView.scrollToCommentWithDelay(e)},scrollToComment:function(e){this._commentCollectionView.scrollToComment(e)},isModificationStatus:function(){return!(this.isDestroyed()||!this._commentCollectionView)&&this._commentCollectionView.isModificationMode()},_fetchLastCommentList:function(){return this._commentCollection.fetchLastCommentList().then(i.bind((function(e){this._commentCollectionView.setOldestCommentShow(!1),this._populateFetchedCollectionWithReset(e)}),this))},_populateFetchedCollection:function(e,t){if(!this._commentCollectionView.isDestroyed()){this._populatePagingParams(e,t);var n=this._convertCommentCollectionToViewArray(e);this._commentCollectionView.populateFetchedCollection(n,e.getTotalCount(),!1,null!=this._previousParams,null!=this._nextParams),this.spawn(d.MSG.COMMENTLIST_CHANGE_COLLECTION)}},_populatePagingParams:function(e,t){var n=e.getPagingData();t.previous&&(this._previousParams=n.previous_params,this._firstParams=n.first_params),t.next&&(this._nextParams=n.next_params,this._updateParams=n.update_param)},_populateFetchedCollectionWithReset:function(e){if(!this._commentCollectionView.isDestroyed()){this._populatePagingParams(e,{previous:!0,next:!0});var t=this._convertCommentCollectionToViewArray(e);this._commentCollectionView.populateFetchedCollection(t,e.getTotalCount(),!0,null!=this._previousParams,null!=this._nextParams),this.spawn(d.MSG.COMMENTLIST_CHANGE_COLLECTION)}},_populateFetchedCollectionAndChangeSortOrder:function(e,t,n){this.isDestroyed()||this._commentCollectionView.isDestroyed()||(this._commentCollectionView.isOldestCommentShow()!=t?(this._commentCollectionView.setOldestCommentShow(t),this._populateFetchedCollectionWithReset(e)):this._populateFetchedCollection(e,n))},_convertCommentCollectionToViewArray:function(e){var t=e.getContentKeyButCommentId();return e.map(i.bind((function(e){return u.buildByDetailDComment(e,this._bandData,t,!1,null,!1,!0)}),this))},_deleteComment:function(e){var t=IM("web.commentdetail.comment.confirm.delete_comment");if(e.isReplyExist&&(t=IM("comment.delete_parent_confirm")),confirm(t)){var n=e.contentKey,o=n.getCommentId();h.wrapActivePromise(p.deleteComment(this._bandNo,n.toApiParams(!0)),this).then(i.bind((function(){this._commentCollectionView.deleteCommentOnView(o,null!=this._previousParams,null!=this._nextParams),this.spawn(d.MSG.COMMENTLIST_CHANGE_COLLECTION),m.getCommentChannel().trigger(m.EVENT.BAND_FILE_UPDATED),m.getCommentChannel().trigger(m.EVENT.COMMENT_DELETED,n)}),this))}},_fetchFirstCommentList:function(){return this._commentCollection.fetchCommentList(this._firstParams).then(i.bind((function(e){this._populateFetchedCollectionAndChangeSortOrder(e,!0,{previous:!0,next:!0})}),this))},_fetchPreviousAndNextAllCommentList:function(){o.when(this._fetchPreviousCommentList(),this._fetchNextAllCommentList())},_fetchPreviousCommentList:function(){return this._commentCollection.fetchCommentList(this._previousParams).then(i.bind((function(e){this._populateFetchedCollection(e,{previous:!0})}),this))},_fetchNextAllCommentList:function(){return this._commentCollectionView.isEmptyCollection()?this._fetchLastCommentList():this._nextParams?void 0:this._commentCollection.fetchCommentList(this._updateParams).then(i.bind((function(e){return this._populateFetchedCollection(e,{next:!0})}),this))},_fetchNextCommentList:function(){return this._commentCollection.fetchCommentList(this._nextParams).then(i.bind((function(e){return this._populateFetchedCollection(e,{next:!0})}),this))},_modifyComment:function(e){f.modifyComment(this._bandNo,e,this).then(i.bind((function(t){var n={};n.comments=a.camelizeKeys(t.comment),n.totalCount=e.totalCount,m.getCommentChannel().trigger(m.EVENT.BAND_FILE_UPDATED);var i=this._createCommentCollection();this._populateFetchedCollection(i.populateDetailCommentData(n),{}),this.spawn(d.MSG.COMMENTLIST_SHOW_INPUT)}),this),(function(){e.modificationView.releaseModificationProgress()}))},_checkAndShowVideo:function(e){e.gifVideo&&e.view.showVideo()},_openEmotionSelectLayer:function(e){var t=null!=e.originCommentId?b.SCHEDULE_COMMENT_COMMENT:b.SCHEDULE_COMMENT;e.view.showEmotionSelectView(g.buildDEmotionSelectViewByContentKey({bandNo:this._bandNo,contentKey:v.buildByAttributes({contentType:t.getContentTypeKey(),scheduleId:this._scheduleId,originCommentId:e.originCommentId,commentId:e.commentId}),emotionTypeByViewer:e.emotionTypeByViewer}))},_createCommentCollection:function(){return r.buildDetailCommentCollection({bandNo:this._bandNo,ownerContentKey:v.buildScheduleKey(this._scheduleId),contentKeyButCommentId:v.buildScheduleCommentKey(this._scheduleId,null)})}});return A.buildDScheduleCommentListView=function(e){return new A(e)},A}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2529),s=n(152),a=n(82),r=n(589),l=n(163),c=i.View.extend({options:{bandData:null,attachmentDisplayType:null,bPostDetail:!1},attributes:function(){var e={"data-viewname":"DPostBillSplitView"};return this.options.attachmentDisplayType===s.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},className:"uWidget",template:t.template(o),templateContext:function(){return{makeProfileInnerClass:function(e){return a.makeProfileInnerClass(e)}}},ui:{attachmentBillSplit:"._attachmentBillSplit",attachmentBillSplitDetail:"._attachmentBillSplitDetail",billCheck:"._billCheck",btnProfile:"._btnProfile"},events:function(){return{"click @ui.attachmentBillSplit":"_showPostDetailLayer","click @ui.billCheck":"_checkBill","click @ui.btnProfile":"_showMemberProfile"}},initialize:function(e){this.billSplitModel=e.model,this.postModel=e.postModel,this.bPostDetail=e.bPostDetail,this.attachmentDisplayType=e.attachmentDisplayType,this._isClickable=this.options.bPostDetail&&this.options.bandData.canCheckBillSplitItem()&&!this.options.clickDisabledPostTypeOnDetail},serializeData:function(){var e={showDetail:this.attachmentDisplayType===s.ATTACHMENT_DISPLAY_TYPE.DETAIL,cid:this.billSplitModel.cid,paidMemberCount:this.billSplitModel.get("paidMemberCount")||"0",currencyLabel:this.billSplitModel.get("currencyLabel"),totalPrice:this.billSplitModel.get("totalPrice"),memberCount:this.billSplitModel.get("memberCount")||"0"};if(this.attachmentDisplayType===s.ATTACHMENT_DISPLAY_TYPE.DETAIL){var n={members:this.billSplitModel.get("members").toJSON(),currencyLabel:this.billSplitModel.get("currencyLabel"),isAuthor:this.billSplitModel.get("isAuthor"),isCheckboxClickable:this._isClickable};return t.extend(e,n)}return e},_showMemberProfile:function(e){var t=this.model.get("members").find({userNo:$(e.currentTarget).data("user-no")}),n=new l({memberType:t.get("memberType"),name:t.get("name"),profileImageUrl:t.get("profileImageUrl")});r.openMemberProfileLayer(n,t.get("userNo"),this.model.get("bandNo"))},_checkBill:function(e){if(!this.options.bandData.canCheckBillSplitItem()||this.options.clickDisabledPostTypeOnDetail)return!1;var n=$(e.currentTarget).data("index"),i=this.billSplitModel.get("members").at(n);return i&&!i.get("isPaid")&&(this.billSplitModel.get("isAuthor")||i.get("isCurrentUser"))&&confirm(IM("web.postdetail.billsplit.confirm.bill_check"))&&this.billSplitModel.setMemberPaid(n).then(t.bind((function(){this.postModel.fetchPostDetail()}),this)),!1},_showPostDetailLayer:function(){return this.bPostDetail||this.trigger("attachmentBillSplit:showPostDetailLayer"),!1}});return c.build=function(e){return new c({model:e.model,attachmentDisplayType:s.ATTACHMENT_DISPLAY_TYPE.HEADER})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){return{INTERNAL_ERROR:"INTERNAL_ERROR",NOT_DEFINED_COMMAND:"NOT_DEFINED_COMMAND",INVALID_PARAMETER:"INVALID_PARAMETER",AUTHENTICATION_FAIL:"AUTHENTICATION_FAIL",CLOSED_LIVE_FAIL:"CLOSED_LIVE_FAIL",EXCEEDED_ALLOWED_LIMIT:"EXCEEDED_ALLOWED_LIMIT",UNKNOWN_ERROR:"UNKNOWN_ERROR"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(877),s=n(541),a=n(167),r=n(166),l=n(506),c=n(556),d=n(152),u=n(52);return{createLivePost:function(e,t,n){var o=e.getBandCore();return this._uploadLive(o.bandNo,t).then(i.bind((function(i){var o=u.camelizeKeys(i);return o.liveId=t,o.liveDescription=n||"",this._createPost(e,o)}),this))},_createPost:function(e,n){var i=e.getBandCore();return c.saveLiveVideoPost(i,n).then((function(e){return e}),(function(e){if(e.result_code===d.ERROR_CODE_FOR_NEED_APPROVE_POST)return alert(IM("editor.need.approve.alert")),t.Deferred().resolve().promise()}))},_uploadLive:function(e,t){return this._notifyQuotaGuide(e).then((function(){return o.uploadLive(e,t)}))},_notifyQuotaGuide:function(e){var n=[r.PostWriteWithLive];return a.getCurrentUserEnvStorage().get(n)?t.Deferred().resolve().promise():s.getQuotaInfo(e,!0).then((function(e){"small_only"===l.get(e,"band_quota.file_quota_policy")&&(a.getCurrentUserEnvStorage().set(n,!0),alert(IM("post.write.with.live.message")))}),(function(){return t.Deferred().resolve().promise()}))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=(n(10),n(6)),s=n(4),a=n(2545),r=n(2546),l=n(529),c=n(486),d=n(877),u=n(158),h=n(562),p=n(506),m=n(152).VIEW_POST_READERS_MAX_MEMBER_COUNT,_=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DLiveOnAirMemberListView"},template:i.template(a),ui:{memberList:"._memberList",descMaxWatcherCountOver:"._descMaxWatcherCountOver",closeBtn:"._closeBtn"},regions:{memberList:{el:"@ui.memberList",replaceElement:!0}},events:{"click @ui.closeBtn":"_closeView",click:function(e){e.target===this.el&&this._closeView()}},initialize:function(e){this._viewerCount=e.viewerCount,this._members=e.members,this._viewVideoWatcherRoles=e.viewVideoWatcherRoles},serializeData:function(){return{title:this._getTitle(),desc:this._getDesc()}},onRender:function(){this._renderMemberList(),this._showWatcherListFooterDesc()},_getTitle:function(){var e=this._viewerCount||0;return IM("live.on_air_viewer_total_count",{count:e>=m?m-1+"+":e})},_getDesc:function(){var e=i.size(this._members),t=IM("live.on_air_band_member_count",{count:e>=m?m-1+"+":e}),n=this._getWatcherRoleDesc();return n&&(t=t+"\n"+n),u.nl2br(t)},_getWatcherRoleDesc:function(){return i.includes(this._viewVideoWatcherRoles,"member")?IM("live.watcher.tab_desc.permission_desc.leader_coleader_member"):i.includes(this._viewVideoWatcherRoles,"coleader")?IM("live.watcher.tab_desc.permission_desc.leader_coleader"):i.includes(this._viewVideoWatcherRoles,"leader")?IM("live.watcher.tab_desc.permission_desc.leader"):null},_renderMemberList:function(){var e=i.chunk(this._members,10),t=new o.Collection(e.shift(),{model:l,parse:!0}),n=new s.CollectionView({tagName:"ul",className:"listLine rScroll",attributes:{style:"max-height:360px;"},collection:t,childView:r,childViewOptions:{liveModel:this.model}});this.listenTo(n,"attach",(function(){this._addPages(t,e)})),this.showChildView("memberList",n)},_showWatcherListFooterDesc:function(){var e="";(this._viewerCount||0)>=m&&(e=IM("member_list.max_count_info",{maxMemberCount:m})),i.isEmpty(e)?this.getUI("descMaxWatcherCountOver").hide():(this.getUI("descMaxWatcherCountOver").text(e),this.getUI("descMaxWatcherCountOver").show())},_closeView:function(){this.destroy()},_addPages:function(e,t){t.length>0&&setTimeout(i.bind((function(){e.add(t.shift(),{parse:!0}),this._addPages(e,t)}),this),30)}});function g(e){h.openLayer({bodyTitle:u.nl2br(e),withoutHiding:!0})}function f(e){var n=function(e){return d.getLiveViewingMembers(e.getLiveBandNo(),e.getLiveId()).then((function(e){return e.viewer_count?e:(g(IM("live.on_air_no_viewers")),t.Deferred().reject().promise())}),(function(e){var t=p.get(e,"result_data.message",IM("ui.alert.temporary_error"));g(i.escape(t))}))}(e).then((function(t){return new _({model:e,viewerCount:t.viewer_count,members:t.members,viewVideoWatcherRoles:t.view_video_watcher_roles})}));c.openPromiseView(n,!0,{width:360,height:96})}return _.openOnAirMemberListLayer=function(e){e.getLiveViewerCount()?f(e):g(IM("live.on_air_no_viewers"))},_}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2);var o=function(e){if(this._isWorking=!1,t.each(e,(function(e,n){!function(e){if(!t.isFunction(e))throw console.error("INVALID_STATE",e),new Error("INVALID_STATE")}(e),e.COMMAND_ID=n})),!e.INIT)throw new Error("INIT STATE REQUIRED");this._currentState={to:e.INIT}};return o.prototype.startProcess=function(e){if(!this._isWorking){this._isWorking=!0;var n=this,o=function(){(function(e){return e&&t.isFunction(e.then)?e:i.Deferred().resolve(e).promise()})(n._currentState.to.call(e,n._currentState.value)).then((function(t){t?(n._currentState=t,n._state=t.to,n._nextParam=t.value,o.call(e)):n._isWorking=!1}))};o.call(e)}},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2567);return i.Behavior.extend({options:{regionName:""},onRender:function(){var e=this.getUI("video")[0].volume,n=this.getUI("video")[0].muted;this.view.showChildView(this.options.regionName,new o({volume:e,muted:n})),this.listenTo(this._getView(),"changeVolumeUI",(function(e,t){this.getUI("video")[0].volume=e,this.getUI("video")[0].muted=t})),this.getUI("video").on("loadedmetadata",t.bind(this._updateVolume,this)),this.getUI("video").on("volumechange",t.bind((function(){this._updateVolume()}),this))},_updateVolume:function(){this._getView().setVolume(this.getUI("video")[0].volume,this.getUI("video")[0].muted)},_getView:function(){return this.view.getChildView(this.options.regionName)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(2569),o=n(1571),s=n(1650);return t.Behavior.extend({options:{regionName:""},initialize:function(){this.listenTo(this.view,s.EVENT.CHANGE_FULL_SCREEN,(function(e){var t=this._getControlView();t&&t.$el.toggle(!e)}))},onRender:function(){this.view.showChildView(this.options.regionName,new i),this.listenTo(this._getControlView(),"changeChatToggle",(function(e){this.view.trigger(o.TOGGLE_CHAT,e)}))},_getControlView:function(){return this.view.getChildView(this.options.regionName)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2573),s=i.View.extend({attributes:{"data-viewname":"DLiveSettingMenuView"},className:"settingBox",initialize:function(e){this._currentResolution=e.currentResolution,this._supportedQualities=[]},template:t.template(o),templateContext:function(){return{currentResolution:this._currentResolution,supportedQualities:this._supportedQualities}},ui:{btnResolution:"._btnResolution"},events:{mouseenter:t.throttle((function(){this.trigger("loadQualityInfo")}),500),"click @ui.btnResolution":function(e){this._changeResolution(this.$(e.target).val())}},_changeResolution:function(e){this._currentResolution=e,this.trigger("changeQuality",this._currentResolution),this.render()},setQualityInfo:function(e){var n=!1;t.isEqual(this._supportedQualities,e.supports)||(this._supportedQualities=e.supports,n=!0),this._currentResolution!==e.current&&(this._currentResolution=e.current,n=!0),n&&this.render()}});return s.buildDLiveSettingMenuView=function(e){return new s({currentResolution:e})},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=i.View.extend({tagName:"SPAN",className:"liveLoading",template:t.template('<span class="gSrOnly"><%-IM("ui.label.loading")%></span>')}),s=i.Behavior.extend({options:{regionName:""},onRender:function(){var e=new o;this.view.showChildView(this.options.regionName,e),this.getUI("video").on("seeking waiting loadeddata",(function(){e.$el.show()})),this.getUI("video").on("play playing seeked pause canplay error",(function(){e.$el.hide()}))}});return s.buildDVideoLoadingControlBehavior=function(){return new s},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(2578),o=n(1407),s=n(1184);return t.Behavior.extend({options:{bigPlayRegion:"",playbackRegion:"",playController:""},onRender:function(){this.view.showChildView("btnPlayback",new i),this.view.showChildView("bigPlay",new o),this.listenTo(this.getPlayController(),s.CHANGE_PLAYING,(function(){this.view.getChildView("btnPlayback").setPlaying(this.getPlayController().isPlaying()),this.view.getChildView("bigPlay").toggleBtnDisplay(!this.getPlayController().isPlaying())})),this.listenTo(this.view.getChildView("btnPlayback"),"clickPlayback",this._playPause),this.listenTo(this.view.getChildView("bigPlay"),"clickPlayback",this._playPause)},_playPause:function(){this.getPlayController().isPlaying()?this.getPlayController().pause():this.getPlayController().play()},getPlayController:function(){return this.view[this.options.playController]}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(1156),o=n(26),s=n(1184);return t.Behavior.extend({options:{playController:"playController",playerUIContainer:"playerUIContainer"},onAttach:function(){this.listenTo(this._getPlayController(),s.READY_PLAYING,this._updateVideoSize),this.listenTo(o.getDGlobalChannel(),o.EVENT.WINDOW_RESIZE,this._updateVideoSize),this.listenTo(this.view.model,i.EVENT.LIVE_CHAT_SECTION_SIZE_CHANGED,this._updateVideoSize)},_updateVideoSize:function(){var e=this._getPlayController().getVideoResolution();if(e){var t=e.width*this.$el.height()/e.height,n=Math.min(t,this.$el.width()),i=this.$el.height();n!==t&&(i=e.height*this.$el.width()/e.width),this.getUI("video").width(n).height(i),this.getUI(this.options.playerUIContainer).width(n).height(i)}},_getPlayController:function(){return this.view[this.options.playController]}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(1184),a=n(2046),r=n(17);function l(e){return e&&t.isFunction(e.then)?e:i.Deferred().resolve(e).promise()}var c={INIT:function(){if(this._isPlaying)return this._isDestroyed&&(this._video.pause(),this._isDestroyed=!1),{to:c.LOAD_SOURCE,value:0}},LOAD_SOURCE:function(e){return this._isDestroyed?{to:c.INIT}:this._isPlaying?e<this._maxSourceRetryCount?l(this._source.call()).then(t.bind((function(e){return this._isAutoPlaying&&(e=r.appendParamsToURL(e,{auto_play:"true"})),this._video.src=e,i(this._video).one("loadedmetadata",t.bind((function(){this.trigger(s.READY_PLAYING)}),this)),{to:c.PREPARE,value:e}}),this),(function(){return l({to:c.LOAD_SOURCE_RETRY,value:e})})):(this._isDestroyed=!0,this._changePlaying(!1),{to:c.INIT}):void 0},LOAD_SOURCE_RETRY:function(e){if(this._isDestroyed)return{to:c.INIT};if(!this._isPlaying)return{to:c.LOAD_SOURCE,value:e};var t=i.Deferred();return setTimeout((function(){t.resolve({to:c.LOAD_SOURCE,value:e+1})}),this._retryInterval),t.promise()},PREPARE:function(){if(this._isDestroyed)return{to:c.INIT};if(this._isPlaying){var e=this._video.play();return e?e.then((function(){return{to:c.PLAYING}}),t.bind((function(){return this._video.muted?(this._video.paused?i(this._video).trigger("pause"):this._video.pause(),this._changePlaying(!1),l({to:c.PAUSED})):l({to:c.PREPARE_RETRY_WITH_MUTE})}),this)):{to:c.PLAYING}}this._video.paused||this._video.pause()},PREPARE_RETRY_WITH_MUTE:function(){return this._isDestroyed?{to:c.INIT}:this._isPlaying?(this._video.muted=!0,{to:c.PREPARE_PLAY}):{to:c.PREPARE_PLAY}},PLAYING:function(){return this._isDestroyed?{to:c.INIT}:this._isPlaying?void 0:(this._video.paused||this._video.pause(),{to:c.PAUSED})},PAUSED:function(){return this._isDestroyed?{to:c.INIT}:this._isPlaying?{to:c.PREPARE}:void 0}},d=o.Object.extend({initialize:function(e){this._retryInterval=2e3,this._maxSourceRetryCount=5,this._isPlaying=!1,this._video=e.video,this._onVideoEnded=t.bind((function(){try{this._video.currentTime=0}catch(e){}this._changePlaying(!1),this._process()}),this),i(this._video).on("ended",this._onVideoEnded),this._setSource(e.source),this._commander=new a(c)},_setSource:function(e){t.isFunction(e)?this._source=e:e&&t.isFunction(e.then)?this._source=t.constant(e):this._source=t.constant(i.Deferred().resolve(e).promise())},play:function(e){this._isPlaying||(this._isAutoPlaying=e,this._changePlaying(!0),this._process())},pause:function(){this._isPlaying&&(this._changePlaying(!1),this._process())},_process:function(){this._commander.startProcess(this)},_changePlaying:function(e){var t=this._isPlaying!==e;this._isPlaying=e,t&&this.trigger(s.CHANGE_PLAYING,this._isPlaying)},isPlaying:function(){return this._isPlaying},destroy:function(){this._video.pause(),i(this._video).off("ended",this._onVideoEnded),this._isDestroyed=!0,this._isPlaying=!1},changeSource:function(e){this._video.pause(),this._setSource(e),this._isDestroyed=!0,this._process()},getVideoResolution:function(){if(this._video.videoWidth||this._video.videoHeight)return{width:this._video.videoWidth,height:this._video.videoHeight}}});return d.EVENT=s,d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2587),a=n(516),r=n(1573),l=n(2053),c=n(1123),d=n(156),u=n(13),h=n(82),p=n(1407),m=n(669),_=o.View.extend({attributes:{"data-viewname":"DLiveVodCardPlayView"},options:{videoId:void 0,poster:"",expiresAt:void 0,bandNo:0,postNo:0,noplay:!1,noclick:!1,autoPlay:!0,videoWidth:0,videoHeight:0},behaviors:function(){var e=[];return d.isExpiredFile(this.options.expiresAt)||(e.push({behaviorClass:r,regionName:"mutedUI",noclick:this.options.noclick}),e.push({behaviorClass:m,videoSelector:"video",bandNo:this.options.bandNo,videoId:this.options.videoId,postNo:this.options.postNo})),e},className:"videoSection gPat15",template:t.template(s),templateContext:function(){return{thumbnail:h.make(this.options.poster,h.TYPE.w500),expiresMessage:d.makeRemainExpiresForStorageQuotaMessage(this.options.expiresAt),isExpiredVideo:d.isExpiredFile(this.options.expiresAt)}},ui:{imageButton:"._imageButton",video:"video",bigPlay:"._bigPlay",mutedUI:"._mutedUI"},events:{click:function(){return this.trigger("openMedia"),!1}},regions:{bigPlay:{el:"@ui.bigPlay",replaceElement:!0},mutedUI:{el:"@ui.mutedUI",replaceElement:!0}},onRender:function(){this.showChildView("bigPlay",new p),this._canPlay()&&(this.playController=new l({video:this.getUI("video")[0],source:t.bind((function(){return d.isExpiredFile(this.options.expiresAt)?i.Deferred().reject().promise():a.getVideoUrlByPost(this.options.bandNo,this.options.postNo,this.options.videoId).then((function(e){return e&&e.download&&e.download["480p"]?e.download["480p"]:i.Deferred().reject().promise()}))}),this)}),this.listenTo(this.playController,l.EVENT.CHANGE_PLAYING,(function(){this.getChildView("bigPlay").toggleBtnDisplay(!(d.isExpiredFile(this.options.expiresAt)||this.playController.isPlaying()))}))),this.getChildView("bigPlay").toggleBtnDisplay(!d.isExpiredFile(this.options.expiresAt))},onAttach:function(){this._canPlay()&&c.register(this,{autoplay:this.getOption("autoPlay"),playingType:"video"})},onBeforeDetach:function(){this._canPlay()&&(c.unregister(this),this.playController&&this.playController.destroy())},_canPlay:function(){return!this.getOption("noplay")&&this.getOption("autoPlay")&&!d.isExpiredFile(this.options.expiresAt)},isPlayReserved:function(){if(this._canPlay())return this.playController.isPlaying()},play:function(e){this._canPlay()&&this.playController.play(e)},pause:function(){this._canPlay()&&this.playController.pause()}});return _.buildDLiveVodCardPlayView=function(e){return new _(t.extend({autoPlay:u.getUserConfig().isVideoAutoPlay()},e))},_}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2597),s=n(153),a=i.View.extend({options:{bandData:null,bPostDetail:!1},attributes:{"data-viewname":"DPostPhotoAlbumView"},className:function(){var e="uWidget";return this.options.bPostDetail&&!this.options.bandData.canGoToPhotoAlbum()&&(e+=" gCursorDefault"),e},template:t.template(o),events:{click:function(){this.bPostDetail?this._goPhotoAlbumDetail():this.trigger("attachmentPhotoAlbum:showPostDetailLayer")}},templateContext:function(){return{bPostDetail:this.bPostDetail}},initialize:function(e){this.photoAlbumModel=e.model,this.postModel=e.postModel,this.bPostDetail=e.bPostDetail},_goPhotoAlbumDetail:function(){if(this.bPostDetail&&!this.photoAlbumModel.get("isDeleted")){var e=this.postModel.getBandNo(),t=this.photoAlbumModel.get("albumNo");return s.GROUP_BAND_ALBUM_DETAIL.goDForced({band_no:e,album_no:t}),!1}}});return a.build=function(e){return new a({model:e.model})},a}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(4),s=n(2607),a=n(2608),r=n(2611),l=n(2613),c=n(2617),d=(n(667),n(26)),u=n(513),h=n(159),p=n(532),m=n(1564),_=n(553),g=n(1643),f=(p.ATTENDANCE_CHECK_STATE,o.CollectionView.extend({tagName:"ul",className:"checkList",childView:a,childViewOptions:function(){return this.options},filter:function(e,t,n){return t<p.MAXIMUM_PREVIEW_ATTENDEE_LIST},initialize:function(e){}})),b=o.View.extend({tagName:"div",className:"uWidget",attributes:{"data-viewname":"DPostAttendanceCheckView"},template:i.template(s),templateContext:function(){var e=this.model.get("attendees");return{bPostDetail:this._bPostDetail,remainingTime:g.makeRemainingTimeText({startAt:this.model.get("startAt"),endedAt:this.model.get("endedAt"),timeZoneId:this.model.get("timeZoneId"),closedText:IM("post.attendance_check.expired")}),managerOnly:this._bPostDetail&&this.model.get("isCheckableOnlyByManagers"),menuAvailable:this._bPostDetail&&this._bandData.canAccessSavePostAttendanceCheckDetail()&&this.model.isAttendanceVisibleToViewer(),canMoreMemberView:this._bPostDetail&&this._bandData.canAccessSavePostAttendanceCheckDetail(),moreCount:!this._bPostDetail&&this._postModel.getAttendanceCheckCount()>1&&this._postModel.getAttendanceCheckCount()-1,showAttendanceStatusDesc:this._bPostDetail&&!this._isAttendanceVisibleQualificationByToAll(),isAttendanceVisibleToViewer:this._bPostDetail&&this.model.isAttendanceVisibleToViewer(),getAttendeeCount:function(t){return e.getAttendeeCount(t)},supportedStates:this._bPostDetail&&this.model.getSupportedStatesExceptUnchecked()}},ui:{doneCount:"._doneCount",managersBtn:"._managersBtn",menuToggleBtn:"._menuToggleBtn",menuLayer:"._menuLayer",excelLink:"._excelLink",printLink:"._printLink",attendeesRegion:"._attendeesRegion",allAttendeesBtn:"._allAttendeesBtn"},events:function(){return this.options.bPostDetail&&this.options.clickDisabledPostTypeOnDetail?{}:{"click @ui.managersBtn":function(){r.openAsLayer({model:this.model})},"click @ui.menuToggleBtn":function(){this.ui.menuLayer.is(":visible")||i.defer(i.bind((function(){this.ui.menuLayer.show()}),this))},"click @ui.excelLink":"_onClickExcelLink","click @ui.printLink":"_onClickPrintLink","click @ui.allAttendeesBtn":"_onClickAllAttendeesBtn",click:function(){this._bPostDetail||this.trigger("postAttachment:showPostDetailLayer")}}},behaviors:[h,m],onMessages:(t={},t[h.MSG.ATTENDANCE_CHECK_CLICK]=function(e){this._renderDoneCount(e.isChecked),d.getPostChannel().trigger(d.EVENT.POST_UPDATED,this.model.get("postNo"))},t),initialize:function(e){this._postModel=e.postModel,this._bandNo=this._postModel.get("band").bandNo,this._isAuthor=this._postModel.get("isAuthor"),this._bandData=e.bandData,this._bPostDetail=!!e.bPostDetail,this._bPostDetail&&(this.listenTo(d.getDGlobalChannel(),d.EVENT.HTML_CLICK,this._closeLayers),this.addRegions({attendeesRegion:{el:"@ui.attendeesRegion",replaceElement:!0}}))},onRender:function(){this._renderDoneCount(),this._bPostDetail?(this.$el.attr("data-widget","expanded"),this.$el.removeAttr("tabindex"),this._showAttendeesRegion()):(this.$el.removeAttr("data-widget"),this.$el.attr("tabindex","-1"))},_isAttendanceVisibleQualificationByToAll:function(){return this.model.getAttendanceVisibleQualification()===p.ATTENDANCE_VISIBLE_QUALIFICATION.ALL},_renderDoneCount:function(e){if(this.model.isAttendanceVisibleToViewer()){var t=!0===e?1:!1===e?-1:0;i.isNumber(this._done)||(this._done=this.model.get("checkedAttendeeCount")),this._done+=t,this.ui.doneCount.html(IM("post.attendance_check.count",{done:this._done.toString(),all:this.model.get("attendeeCount").toString()}))}},_showAttendeesRegion:function(){this.showChildView("attendeesRegion",new f({collection:this.model.get("attendees"),bandNo:this._bandNo,postNo:this.model.get("postNo"),attendanceCheckId:this.model.get("attendanceCheckId"),isManager:this._isManager(),isCheckableByAttendee:this.model.isCheckableByAttendee(),clickDisabledPostTypeOnDetail:this.options.clickDisabledPostTypeOnDetail,startAt:this.model.get("startAt"),timeZoneId:this.model.get("timeZoneId"),isAttendanceVisibleToViewer:this.model.isAttendanceVisibleToViewer(),supportedStates:this.model.getSupportedStates(),isOnlyCheckedStateSupported:this.model.isOnlyCheckedStateSupported()}))},_isManager:function(){return this._isAuthor||this.model.isAttendanceCheckManager()},_onClickAllAttendeesBtn:function(){var e={bandNo:this._bandNo,postNo:this.model.get("postNo"),attendanceCheckId:this.model.get("attendanceCheckId"),isAuthor:this._isAuthor};l.openAsLayer(e).then(i.bind((function(e){this.listenTo(e,l.EVENTS.STATE_CHANGE,(function(e){var t=this.model.get("attendees").find((function(e){var t=e.get("attendee");return t.get("userNo")==this.userNo&&t.get("childMembershipId")==this.childMembershipId}),e);t&&(t.set({isChecked:e.isChecked,checkedAt:e.checkedAt}),this._renderDoneCount(e.isChecked))}))}),this))},_closeLayers:function(){try{this.ui.menuLayer.hide()}catch(e){}},_onClickPrintLink:function(e){var t=c.openAsLayer(this.model.getSupportedStates(),IM("schedule.rsvp.select_print_item.desc"));e.preventDefault(),this.listenTo(t,c.EVENT.SELECTED,(function(e){var t=_.attachmentPrint(this._bandData.getBandCore(),"attendance-check",[{post_no:this.model.get("postNo"),attachment_id:this.model.get("attendanceCheckId")}],{states:e.join(",")}).url;u.openWindowXSSSafely(t,"_blank")}))},_onClickExcelLink:function(e){var t=c.openAsLayer(this.model.getSupportedStates(),IM("post.attendance_check.select_to_save"));e.preventDefault(),this.listenTo(t,c.EVENT.SELECTED,(function(e){this.startDownload(m.KEY.ATTENDANCE_CHECK,[{band_no:this._bandNo,post_no:this.model.get("postNo"),attachment_id:this.model.get("attendanceCheckId")}],{bandCore:this.options.bandData.getBandCore(),states:e})}))}});return b.build=function(e){return new b(e)},b}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2610),s=n(486),a=n(532).ATTENDANCE_CHECK_STATE,r={CONFIRM:"CONFIRM",CANCEL:"CANCEL"},l=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viwename":"DAttendanceCheckStateSelectView"},template:t.template(o),templateContext:function(){return{ATTENDANCE_CHECK_STATE:a,selectableStates:this._selectableStates,selectedState:this._selectedState,stateReason:this._stateReason}},ui:{radioState:"input[name=state]",btnCancel:"._btnCancel",btnConfirm:"._btnConfirm"},events:{"click @ui.radioState":function(e){$("._reasonWrap").hide(),$(e.currentTarget).parents("li:first").find("._reasonWrap").show(),this.getUI("btnConfirm").prop("disabled",!1)},"click @ui.btnCancel":"_cancel","click @ui.btnConfirm":"_confirm"},initialize:function(e){this._selectableStates=e.selectableStates||[a.CHECKED],this._selectableStates=t.filter(this._selectableStates,(function(e){return e!=a.UNCHECKED})),this._selectedState=this.options.selectedState,this._stateReason=this.options.stateReason},onAttach:function(){this.getUI("btnConfirm").prop("disabled",!this._selectedState)},layerOnEscKeyDown:function(){this._cancel()},_confirm:function(){var e={},t=this.$el.find("input[name=state]:checked");e.selectedState=t.val();var n=t.parents("li:first").find("._reason");0!=n.length&&(e.reason=n.val().trim()),this.trigger(r.CONFIRM,e),this.destroy()},_cancel:function(){this.trigger(r.CANCEL),this.destroy()}});return l.EVENT=r,l.openAsLayer=function(e,t,n){var i=new l({selectableStates:e,selectedState:t,stateReason:n});return s.openWithoutHiding(i),i},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<a class="snippet" data-thumbnail="type0">\n    <span class="snippetInfo">\n        <span class="snippetTxt"><%-IM("web.post.subpost.alert.not_supported_in_web") %></span>\n    </span>\n</a>'},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(4),o=n(152),s=n(2627),a=n(1119),r=n(159),l=n(154),c=n(891),d=i.View.extend({options:{bandData:null,attachmentDisplayType:null,bPostDetail:!1,clickDisabledPostTypeOnDetail:!1},className:"uWidget",behaviors:[r],attributes:function(){var e={"data-viewname":"DPostAudioView"};return this.options.attachmentDisplayType==o.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},template:_.template(s),ui:{audioPlayerWrapper:"._audioPlayerWrapper"},regions:{audioPlayerWrapper:{el:"@ui.audioPlayerWrapper"}},onMessages:(t={},t[r.MSG.AUDIOPLAYER_FILE_URL_REQUIRED]=function(e){var t=e.playerView;l.wrapActivePromise(c.getAudioUrlByPost(this.model.getBandNo(),this.model.getPostNo(),this.model.getAudioId()),t).then((function(e){t.loadAudioFile(e.audio_url)}))},t),events:{click:function(){this.bPostDetail||this.trigger("attachmentAudio:showPostDetailLayer")}},initialize:function(e){this.bPostDetail=e.bPostDetail},onAttach:function(){var e=!!this.options.clickDisabledPostTypeOnDetail,t=a.buildDAudioPlayerView(this.model.getAudioDuration(),e);this.showChildView("audioPlayerWrapper",t),t.ui.controlBtn.attr("disabled",e)}});return d.buildDPostAudioView=function(e){return new d({model:e})},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(4),o=n(2628),s=n(658),a=(n(689),n(2629)),r=n(530),l=n(152),c=n(153),d=n(26),u=i.View.extend({options:{bandData:null},className:"uWidget",attributes:function(){var e={"data-viewname":"DPostQuizView"};return this._isRichView()&&(e["data-widget"]="expanded"),e},_isRichView:function(){return this.model instanceof s},template:_.template(o),templateContext:function(){return{takerCountText:r.getTakerCountText(this.model.get("takenMemberCount"),this.model.get("takers").length),showDetail:this._isRichView(),remainingTime:r.getRemainingTimeMessage(this.model.get("startAt"),this.model.get("endAt"),this.model.get("timeZoneId")),moreCount:!this._isRichView()&&this._getMoreQuizCountInPost(),isNotQuizRelated:!this.model.isTakerViewer()&&!this.model.isManagerViewer(),showManagerActions:this.model.isManagerViewer(),openTakerDetailButtonLabel:r.getOpenTakerDetailBtnLabel(this.model.get("viewerState")),showOpenTakerDetailView:this.model.canAccessDetailAsTaker(),showEndQuiz:this.model.canEndQuiz()}},ui:{btnOpenTakerList:"._btnOpenTakerList",btnOpenManagerQuizView:"._btnOpenManagerQuizView",btnEndQuiz:"._btnEndQuiz",btnOpenTakerDetail:"._btnOpenTakerDetail"},events:{"click @ui.btnOpenTakerList":function(){a.openLayer({bandData:this.options.bandData,quizModel:this.model})},"click @ui.btnOpenManagerQuizView":"_openTakerDetailWindow","click @ui.btnOpenTakerDetail":function(){this.model.isBeforeStart()?alert(IM("post.quiz.take_quiz.alert.not_available_time")):this._openTakerDetailWindow()},"click @ui.btnEndQuiz":function(){confirm(IM("post.quiz.end_quiz.confirm"))&&this.model.endQuiz().then(_.bind((function(){_.delay(_.bind((function(){alert(IM("post.quiz.takers.open_quiz_grade.success.alert")),d.getPostChannel().trigger(d.EVENT.POST_UPDATED,this.model.get("postNo"))}),this),1e3)}),this))}},triggers:{click:"attachment:showPostDetailLayer"},_getMoreQuizCountInPost:function(){if(this.options.postListItemModel)return this.options.postListItemModel.getAttachment(l.POST_ATTACHMENT_TYPE.QUIZ).length-1},_openTakerDetailWindow:function(){window.open(c.GROUP_BAND_QUIZ_TAKER_DETAIL.makeUrl({band_no:this.options.bandData.getBandCore().bandNo,post_no:this.model.get("postNo"),quiz_id:this.model.get("quizId")}))}});u.buildDPostQuizView=function(e,t){return new u({model:e,postListItemModel:t})},e.exports=u},function(e,t,n){var i=n(0),o=n(4),s=n(553),a=n(2638),r=n(2639),l=n(513),c=n(2640),d=n(583),u=n(938),h=n(562),p=n(82),m=o.View.extend({attributes:{"data-viewname":"DPostQuizStatsView"},getTemplate:function(){return this.model.getDataFetched()?i.template(a):i.template('<div class="_loadingRegion"></div>')},templateContext:function(){if(this.model.getDataFetched()){var e=this.model;return{quizTitle:e.get("quiz").get("title"),quizPeriod:e.getQuizPeriod(" ~ ","YYYY. MM. DD"),quizQuestions:e.get("quiz").getQuestions().toJSON(),makeThumb:function(e){return p.make(e,p.TYPE.s150)},printNumValue:function(e){return e===parseInt(e)?e:e.toFixed(1)}}}},ui:{btnQuizExcelDownload:"._btnQuizExcelDownload",graph:"._graph"},regions:{loadingRegion:{el:"._loadingRegion",replaceElement:!0}},events:{"click @ui.btnQuizExcelDownload":function(){r.excelDownload({bandData:this._bandData,quizModel:this.model})}},initialize:function(e){this._bandData=e.bandData,this._bandNo=e.bandNo,this._postNo=e.postNo,this._quizId=e.quizId,this._setBrowserTitle()},onRender:function(){this.model.getDataFetched()?this._drawGraph():this.showChildView("loadingRegion",d.buildAsMediumScreenMiddle())},onAttach:function(){this._getQuizStatsAndRender()},_drawGraph:function(){for(var e,t=this.model.get("takerPoints"),n=this.model.get("pointTotal"),o={},s=n>9?10:n,a=0,r=1;r<s+1;r++)e=Math.floor(n/s*r),o[a+"_"+e]=[],a=e;i.each(o,(function(e,n,s){var a=n.split("_");i.each(t,(function(e,t){(0==a[0]&&0==e||a[0]<e&&a[1]>=e)&&o[n].push(e)}))}));for(var l=i.map(o,(function(e){return e.length})),c=i.map(o,(function(e,t){var n=t.split("_");return n[n.length-1]})),d=i.max(l),h=[],p=0;p<=5;p++)h.push(Math.ceil(d/5)*p);l.unshift("data1"),u.bb.generate({bindto:this.getUI("graph").selector,size:{width:736,height:295},legend:{show:!1},grid:{x:{show:!1},y:{show:!0}},tooltip:{show:!1},padding:{right:20},axis:{x:{tick:{centered:!1,width:50,count:s,text:{position:{y:14}}},type:"category",categories:c},y:{max:i.last(h),tick:{count:5,values:h},padding:{top:20,bottom:0}}},data:{type:"bar",labels:!0,columns:[l],colors:{data1:"#0dcb67"}},bar:{width:9,radius:2},interaction:{enabled:!1},onrendered:function(){var e=this.main.selectAll(".bb-ygrids .bb-ygrid");e.style("stroke-dasharray",0),e.style("stroke","#f3f3f3");var t=this.main.selectAll(".bb-axis-y"),n=t.selectAll(".tick");t.select(".domain").style("display","none"),n.select("tspan").style("fill","#333"),n.select("tspan").style("font-size","12px"),n.select("line").style("display","none");var o=this.main.selectAll(".bb-axis-x"),s=o.selectAll(".tick"),a=s.select("line").attr("x1");o.select(".domain").attr("stroke","#d9d9d9"),o.select(".domain").attr("d","M0,0V0H694V0"),s.select("tspan").attr("x",a),s.select("tspan").attr("fill","#333"),s.select("tspan").attr("font-size","13px"),s.select("line").attr("y2",9),s.select("line").attr("transform","translate(0, -4)"),s.select("line").attr("stroke","#d9d9d9");var r=this.main.selectAll(".bb-texts .bb-text");r.style("font-size","14px"),r.style("font-weight","bold"),i.each(r._groups[0],(function(e,t){0==e.textContent&&(e.textContent="")})),this.main.selectAll(".bb-chart-bar .bb-shape").style("opacity","0.9")}})},_getQuizStatsAndRender:function(){this.model.getPostQuizStats().then(i.bind((function(){this.model.get("quiz").isQuizStateOpened()?this.render():this._showAlertAndMove()}),this),i.bind((function(){this._goGroupBandHome()}),this))},_showAlertAndMove:function(){h.openLayer({bodyTitle:IM("post.quiz.view_stats_error_msg"),withoutHiding:!0}).once(h.EVENTS.CONFIRM,i.bind((function(){this._goGroupBandHome()}),this))},_goGroupBandHome:function(){s.home(this._bandData.getBandCore()).go()},_setBrowserTitle:function(){document.title=this._bandData.getBandName()}});m.buildDPostQuizStatsView=function(e,t,n,i){var o=t.band_no,s=t.post_no,a=t.quiz_id;return new m({bandNo:o,postNo:s,quizId:a,bandData:i,model:new c(void 0,{bandNo:o,postNo:s,quizId:a})})},m.openWindowQuizStats=function(e,t,n){var i=s.quizStats(e,t,n).url;l.openWindowXSSSafely(i,"_blank")},e.exports=m},function(e,t,n){var i=n(0),o=n(2),s=n(4),a=n(2641),r=n(152),l=n(622),c=n(26),d=n(2642),u=n(553),h=s.View.extend({options:{bandData:null},className:"uWidget",attributes:function(){var e={"data-viewname":"DPostSurveyView"};return this._isRichView()&&(e["data-widget"]="expanded"),e},_isRichView:function(){return this.options.attachmentDisplayType===r.ATTACHMENT_DISPLAY_TYPE.DETAIL},template:i.template(a),templateContext:function(){return{surveyeeCountText:l.getSurveyeeCountText(this.model.get("respondedMemberCount"),this.model.get("isSurveyeeQualified")&&this.model.get("surveyees").length),showDetail:this._isRichView(),remainingTime:l.getRemainingTimeMessage(this.model.get("startAt"),this.model.get("endAt"),this.model.get("timeZoneId")),moreCount:!this._isRichView()&&this._getMoreSurveyCountInPost(),showNotSurveyRelated:this._isShowNotSurveyRelated(),showManagerActions:this.model.canAccessSurveyeeList(),openSurveyeeDetailButtonLabel:this._isRichView()&&this._getOpenSurveyeeDetailButtonLabel(),showOpenSurveyeeDetailView:this._isRichView()&&this.model.canAccessDetailAsSurveyee(this.options.bandData),showSurveyeeDetailAtBottom:this._isRichView()&&!this.model.canAccessSurveyeeList()&&this.model.canAccessDetailAsSurveyee(this.options.bandData),showEndSurvey:this.model.canEndSurvey()}},ui:{btnOpenSurveyeeList:"._btnOpenSurveyeeList",btnEndSurvey:"._btnEndSurvey",btnOpenSurveyeeDetail:"._btnOpenSurveyeeDetail"},events:{"click @ui.btnOpenSurveyeeList":function(){d.openLayer({bandData:this.options.bandData,surveyModel:this.model})},"click @ui.btnOpenSurveyeeDetail":function(){if(!this.model.isBeforeStart()||this.model.canAccessSurveyeeList()){var e=this.options.bandData.getBandCore(),t=this.model.get("postNo"),n=this.model.get("surveyId");window.open(u.surveySurveyeeDetail(e,t,n).url)}else alert(IM("post.survey.respond_survey.alert.not_available_time"))},"click @ui.btnEndSurvey":function(){confirm(IM("post.survey.end_survey.confirm"))&&this.model.endSurvey().then(i.bind((function(){return o.Deferred((function(e){i.delay((function(){alert(IM("action_completed_successfully")),e.resolve()}),1e3)})).promise()}),this)).always(i.bind((function(){c.getPostChannel().trigger(c.EVENT.POST_UPDATED,this.model.get("postNo"))}),this))}},triggers:{click:"attachment:showPostDetailLayer"},_isShowNotSurveyRelated:function(){return!!this.options.bandData&&(!this.model.isTargetSurveyee(this.options.bandData)&&!this.model.canAccessSurveyeeList())},_getMoreSurveyCountInPost:function(){if(this.options.postListItemModel)return this.options.postListItemModel.getAttachment(r.POST_ATTACHMENT_TYPE.SURVEY).length-1},_getOpenSurveyeeDetailButtonLabel:function(){var e=IM("post.survey.open_survey.btn"),t=this.model.isViewerResponded()?IM("post.survey.show_my_answer.btn"):IM("post.survey.respond_survey.btn");if(this.options.bandData)return this.model.canAccessSurveyeeList()?this.model.isTargetSurveyee(this.options.bandData)&&!this.model.isBeforeStart()&&this.model.canAccessDetailAsSurveyee(this.options.bandData)?t:e:t}});h.buildDPostSurveyView=function(e,t){return new h({model:e,postListItemModel:t})},e.exports=h},function(e,t,n){var i=n(0),o=n(4),s=n(553),a=n(2648),r=n(2649),l=n(513),c=n(583),d=n(562),u=n(602),h=n(1558),p=n(2650),m=n(2658),_=o.View.extend({attributes:{"data-viewname":"DSurveyStatsView"},getTemplate:function(){return this._dataFetched?i.template(a):i.template('<div class="_loadingRegion"></div>')},templateContext:function(){if(this._dataFetched)return{surveyPeriod:r.getSurveyPeriod(" ~ ","YYYY. MM. DD",this.model)}},ui:{btnSurveyExcelDownload:"._btnSurveyExcelDownload",btnQuestionImage:"._btnQuestionImage",contentRegion:"._contentRegion",loadingRegion:"._loadingRegion",questionsContentBottom:"._questionsContentBottom",btnDownloadingCancel:"._btnDownloadingCancel",statsDataLoadingProgressRegion:"._statsDataLoadingProgressRegion"},regions:{loadingRegion:{el:"@ui.loadingRegion",replaceElement:!0},contentRegion:{el:"@ui.contentRegion",replaceElement:!0},statsDataLoadingProgressRegion:{el:"@ui.statsDataLoadingProgressRegion",replaceElement:!0}},events:{"click @ui.btnSurveyExcelDownload":function(){this._downloadExcelStart()},"intersect @ui.questionsContentBottom":function(e,t){if(t.isIntersecting)return this._isVisibleContentBottom=!0,void(this._isSurveyListRendering||this._addNextSurveyList());this._isVisibleContentBottom=!1}},behaviors:[{behaviorClass:h,observations:[{elements:"._questionsContentBottom",root:"body",rootMargin:0,threshold:0}]}],initialize:function(e){this._dataFetched=!1,this._isExcelDownloading=!1,this._isSurveyListRendering=!1,this._isVisibleContentBottom=!1,this._bandData=e.bandData,this._bandNo=e.bandNo,this._postNo=e.postNo,this._surveyId=e.surveyId,this._setBrowserTitle()},onRender:function(){this._dataFetched?this._renderSurveyList():this.showChildView("loadingRegion",c.buildAsMediumScreenMiddle())},onAttach:function(){this._initSurvey()},_downloadExcelStart:function(e){if(this._isExcelDownloading=!e,this.getUI("btnSurveyExcelDownload").attr("disabled",!e),e)this._showStatsDataLoadingProgressView(!1);else{var t=this._getStatsDownloadPercent();"100%"!==t?(this._showStatsDataLoadingProgressView(!0,t),this._addNextSurveyList()):this._downloadExcelFile()}},_showStatsDataLoadingProgressView:function(e,t){e?(this._statsDataLoadingProgressView=m.openLayerView(t,r.makeFileName(this._bandData,this.model)+".xlsx"),this.showChildView("statsDataLoadingProgressRegion",this._statsDataLoadingProgressView),this.listenTo(this._statsDataLoadingProgressView,m.EVENT.STATS_LOADING_CANCEL,i.bind((function(){this._downloadExcelStart(!0)}),this))):this.getRegion("statsDataLoadingProgressRegion").empty()},_getStatsDownloadPercent:function(){var e=this.model.getQuestions().size(),t=this._questionCollection.size();return Math.floor(t/e*100)+"%"},_renderSurveyList:function(){this._questionCollection=new Backbone.Collection(this.model.getQuestions().first()),this._dSurveyStatsQuestionListView=p.buildDSurveyStatsQuestionListView(this.model,this._questionCollection),this.listenTo(this._dSurveyStatsQuestionListView,p.EVENT.RENDERED,i.bind((function(){if(this._isExcelDownloading)return this._statsDataLoadingProgressView.updateView(this._getStatsDownloadPercent()),this.model.getQuestions().size()===this._questionCollection.size()?void this._downloadExcelFile():void this._addNextSurveyList();this._isVisibleContentBottom?this._addNextSurveyList():this._isSurveyListRendering=!1}),this)),this.showChildView("contentRegion",this._dSurveyStatsQuestionListView)},_addNextSurveyList:function(){var e=this._questionCollection.size(),t=this.model.getQuestions();t.size()!==e&&(this._isSurveyListRendering=!0,this._questionCollection.add(t.at(e)))},_fetchSurvey:function(){return this.model.fetchSurveyModel().then(i.bind((function(){this._dataFetched=!0}),this))},_initSurvey:function(){this._fetchSurvey().then(i.bind((function(){this.model.isManagerViewer()&&this.model.isRespondedMemberExist()?this.render():this._showAlertAndMove()}),this),i.bind((function(){this._goGroupBandHome()}),this)),this.render()},_showAlertAndMove:function(){d.openLayer({bodyTitle:IM("permission_deny"),withoutHiding:!0}).once(d.EVENTS.CONFIRM,i.bind((function(){this._goGroupBandHome()}),this))},_goGroupBandHome:function(){s.home(this._bandData.getBandCore()).go()},_setBrowserTitle:function(){document.title=this._bandData.getBandName()},_downloadExcelFile:function(){r.excelDownload({bandData:this._bandData,surveyModel:this.model}),this._downloadExcelStart(!0)}});_.buildDSurveyStatsView=function(e,t,n,i){var o=t.band_no,s=t.post_no,a=t.survey_id;return new _({bandNo:o,postNo:s,surveyId:a,bandData:i,model:u.createSurveyModel(o,s,a)})},_.openWindowSurveyStats=function(e,t,n){var i=s.surveyStats(e,t,n).url;l.openWindowXSSSafely(i,"_blank")},e.exports=_},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i,o;i=[n(2),n(0),n(84),n(57)],void 0===(o=function(e,t,n,i){return{bindAnchorTagClick:function(){e(document).on("click","a[href]",t.bind((function(e){i.isBandDesktopApp()?this._movePageByEventForDesktopApp(e):this._movePageByEventForWeb(e)}),this))},_movePageByEventForWeb:function(t){if(!t.isDefaultPrevented()){var i=e(t.currentTarget),o=i.attr("href")?i.attr("href"):"";"#"!=o?this._isNotMovableLink(o)||i.attr("target")&&"_self"!=i.attr("target")||i.is("[download]")||t.ctrlKey||t.altKey||t.shiftKey||t.metaKey||(t.preventDefault(),n.go(i.attr("href"))):t.preventDefault()}},_movePageByEventForDesktopApp:function(t){if(!t.isDefaultPrevented()){var n=e(t.currentTarget),i=n.attr("href")?n.attr("href"):"";"#"!=i?this._isNotMovableLink(i)||(t.preventDefault(),window.open(i)):t.preventDefault()}},_isNotMovableLink:function(e){return""==e||0==e.indexOf("javascript:")||0==e.indexOf("mailto:")||0==e.indexOf("tel:")}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(157),a=n(153),r=(n(162),n(53)),l=n(555),c=n(786),d=n(26),u=n(2676),h=n(155),p=n(553),m=n(486),_=n(1061);return new(o.Object.extend({initialize:function(e){this._prevKeyCode=null,$("html").on("keydown",t.bind(this._handleKeyDown,this))},_handleKeyDown:function(e){var n,o=$(e.target);if(!(o.is(":input")||o.is("textarea")||i.toBoolean(o.attr("contenteditable")))&&($('[data-viewname="DWebMainLayoutView"]').length&&!e.ctrlKey&&!e.metaKey))return this._prevKeyCode||e.keyCode!==l.KEY_G?this._prevKeyCode===l.KEY_G?(this._prevKeyCode=null,n&&clearTimeout(n),void this._navigate(e.keyCode)):void this._doAction(e):(this._prevKeyCode=e.keyCode,void(n=setTimeout(t.bind((function(){this._prevKeyCode=null}),this),1e3)))},_navigate:function(e){var t=r.getCurrentRouteInfo();switch(e){case l.KEY_G:return void s.GLOBAL_HOME.goDForced();case l.KEY_1:case l.KEY_2:case l.KEY_3:case l.KEY_4:case l.KEY_5:case l.KEY_6:case l.KEY_7:case l.KEY_8:case l.KEY_9:var n=e-l.KEY_0;return t.routeInfo===s.GLOBAL_HOME?void d.getShortcutChannel().trigger(d.SHORTCUT_EVENT.GO_TO_BAND,n-1):i.startsWith(location.pathname,"/band/")||i.startsWith(location.pathname,"/page/")?void d.getShortcutChannel().trigger(d.SHORTCUT_EVENT.GO_TO_BAND_LNB_MENU,n-1):void 0;case l.KEY_B:return void s.GLOBAL_MY_BOOKMARK.goDForced();case l.KEY_H:return void(t.pathVariables.band_no&&p.home(h.get(t.pathVariables.band_no).getBandCore()).go());case l.KEY_F:return void s.GLOBAL_FEED.goDForced();case l.KEY_N:return void d.getShortcutChannel().trigger(d.SHORTCUT_EVENT.SHOW_NEWS_LAYER);case l.KEY_C:return void d.getShortcutChannel().trigger(d.SHORTCUT_EVENT.SHOW_CHAT_CHANNELS_LAYER)}},_doAction:function(e){var n=m.getActiveLayerView(),i=r.getCurrentRouteInfo();if(e.keyCode===l.QUESTION_MARK&&e.shiftKey)u.openLayer();else if(e.keyCode===l.KEY_B){if(n&&n instanceof c)return void n.trigger(_.POST_MORE_ACTIONS.BOOKMARK_ADD_POST);if(t.contains([a.GROUP_BAND_POST_DETAIL,a.GROUP_BAND_POST_DETAIL_COMMENT,a.GROUP_BAND_POST_DETAIL_COMMENT_REPLY],i.routeInfo))return void d.getShortcutChannel().trigger(d.SHORTCUT_EVENT.BOOKMARK_POST,{bandNo:parseInt(i.pathVariables.band_no),postNo:parseInt(i.pathVariables.post_no)})}}}))}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(504),o=n(520);return t.Model.extend({defaults:{isNotice:!1,readCount:0,readUsers:[],unreadUsers:[],viewPostReaderLevel:""},parse:function(e){var n={};return n.isNotice=e.is_notice,n.readCount=e.read_count,n.viewPostReaderLevel=e.view_post_reader_level,n.readUsers=new t.Collection(e.read,{model:i,parse:!0,comparator:"name"}),n.unreadUsers=new t.Collection(e.unread,{model:i,parse:!0,comparator:"name"}),n},fetchPostReaders:function(e,t){return o.getPostReaders(e,t).then(_.bind((function(e){return this.set(this.parse(e)),this}),this))},fetchBandNoticeReaders:function(e,t){return o.fetchBandNoticeReaders(e,t).then(_.bind((function(e){return this.set(this.parse(e)),this}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="_authorProfile"></span>\n\n<div class="postWriterInfoWrap">\n    <span class="ellipsis">\n        <strong class="text">\n\n            <% if (isCertifiedPage) { %>\n            <span class="uOfficialBand -sizeS"><%= IM(\'ui.label.official_page_band\') %></span>\n            <% } %>\n\n            <%- authorName %>\n\n        </strong>\n        <span title="<%- authorDesc %>" class="memo"><%- authorDesc %></span>\n    </span>\n    <div class="postListInfoWrap">\n        <% if (!bPostDetail && noticeMarkMessage) { %><span class="notice"><%= noticeMarkMessage %></span><% } %>\n\n        <% // SEO를 위해 anchor 태그 삽입.. preventDefault를 해야하나, 이미 현재 view자체에서 triggers로 막고 있는 것으로 확인 %>\n        <a href="<%- webUrl %>" class="time" <% if ( bPostDetail ) { %>style="cursor: auto;"<% } %>><time><%- createdDate %></time></a>\n\n        <% if (bPostDetail && isViewPostReaderCount) { %><span class="readCount"><%- IM("web.postdetail.label.read_count", {count: postReadCount || "0"}) %></span><% } %>\n\n        <% if (authorRealName) { // viewer가 페이지 운영자/부운영자인 경우만 내려오는 항목 %>\n            <span title="<%- authorRealName %>" class="writer"><%- authorRealName %></span>\n        <% } %>\n\n        <% if (punishedAt) { // 클린필터 적용 %>\n        <button type="button" class="blockInfoButton _btnPunishedInfo"><%-IM("post.clean_filter.hidden_info.btn")%></button>\n        <% } %>\n    </div>\n\n</div>'},function(e,t){e.exports='<div class="postFunction _postFunctionWrap">\n\n    <button type="button" class="postSet _btnPostMore" aria-haspopup="true" aria-expanded="false" aria-controls="postLyMenu_<%= cid %>"><%- IM("web.postdetail.btn.post_more") %></button>\n    <div id="postLyMenu_<%= cid %>" class="lyMenu _postMoreMenu" style="min-width:145px;display:none;">\n        <ul class="_postMoreMenuUl"></ul>\n    </div>\n    <label for="check_<%- cid %>" class="uCheck -checkbox">\n        <input type="checkbox" id="check_<%- cid %>" class="checkInput _checkInput">\n        <span class="checkLabel">\n            <span class="shape sf_afterBg"></span>\n        </span>\n    </label>\n    <div class="_postShareOptionListViewRegion"></div>\n    <% if (translatable) { %>\n    <div class="translationBox _translationSettingRegion"></div>\n    <% } %>\n</div>'},function(e,t){e.exports='<div class="shareMenu">\n    <% if (isLogedIn && joinedBands && joinedBands.length > 0) { %>\n    <div class="bands">\n        <div class="titleArea">\n            <span class="title"><%- IM(\'web.bandselection.title\') %></span>\n            <button class="shareMore _btnShareMoreBands"><%- IM(\'ui.label.more.long\') %></button>\n        </div>\n        <ul>\n            <% _.each(joinedBands, function(band) { %>\n            <li>\n                <a href="#" class="_btnShareBand" data-band-no="<%- band.band_no %>" data-band-name="<%- band.name %>" data-band-cover="<%- band.cover %>">\n                    <div class="coverImg">\n                        <img src="<%- coverThumb(band.cover) %>" alt="<%-band.name%>">\n                    </div>\n                    <span class="name"><%- band.name %></span>\n                </a>\n            </li>\n            <% }); %>\n        </ul>\n    </div>\n    <% } %>\n    <ul class="etc">\n        <% if (canShareToExternalSNS) { %>\n        <li class="facebook">\n            <a href="#" class="_btnShareFacebook">\n                <span class="icon"></span> <span class="name"><%- IM("sns.label.facebook") %></span>\n            </a>\n        </li>\n        <li class="twitter">\n            <a href="#" class="_btnShareTwitter">\n                <span class="icon"></span> <span class="name"><%- IM("sns.label.twitter") %></span>\n            </a>\n        </li>\n            <% if (hasKoreaCountryCode) { %>\n        <li class="naverCafe">\n            <a href="#" class="_btnShareCafe">\n                <span class="icon"></span> <span class="name"><%- IM("sns.label.naver_cafe") %></span>\n            </a>\n        </li>\n            <% } %>\n        <% } %>\n        <li class="urlCopy">\n            <a href="#" class="_btnDetailUrl">\n                <span class="icon"></span> <span class="name"><%- IM("sns.label.link") %></span>\n            </a>\n        </li>\n    </ul>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2155),s=n(2156),a=n(491),r=n(556),l=n(26),c=n(486),d=n(718),u=n(152),h=n(540),p=n(563),m=n(495),_=n(487),g=n(162),f=n(153),b=n(155),v=n(84);n(936);var A=i.View.extend({attributes:{"data-viewname":"DPostEditorLayerView"},ui:{lyWrap:"._lyWrap",lyContent:"._lyContent",btnCancel:"._btnCancel",btnBack:"._btnBack"},template:t.template(o),templateContext:function(){return{msg_title:this._getEditorTitle(),msg_showBackButton:this.editMode==d.EDIT_MODE.COPY||this.editMode==d.EDIT_MODE.SHARE,editorDescription:this._getEditorDescription()}},regions:{editorRegion:"._editorRegion"},behaviors:function(){return[{behaviorClass:m,sceneId:this.getOption("editMode")===d.EDIT_MODE.MODIFY?m.SCENE.POST_MODIFY:m.SCENE.POST_WRITE_MAIN},_]},events:{"click @ui.btnCancel":"_cancelPost","click @ui.btnBack":"destroy","mousedown @ui.lyWrap":"_cancelPost","mousedown @ui.lyContent":function(e){e.stopPropagation(),l.getDGlobalChannel().trigger(l.EVENT.HTML_CLICK,e)}},childViewEvents:{"cancel:write:post":"_cancelPost"},initialize:function(e){var n=e.bandList;this._body=$("body"),this.postModel=e.postModel,this.bandNo=e.bandNo,this.postNo=e.postNo,this.editMode=e.editMode,this.bandList=t.isEmpty(n)?null:n,this._attachment=e.attachment,this.liveVideo=e.liveVideo,this.bandList&&(this.bandNoList=t.map(this.bandList,(function(e){return e.bandNo})))},onBeforeDetach:function(){this.$el.draggable("destroy")},onAttach:function(){this.$el.draggable({stop:function(e,t){e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()}}),a.getCachedBandData(this.bandNo).then(t.bind((function(e){switch(this.$el.addClass(e.getBandCore().getSkinColorClass()),this.editMode){case d.EDIT_MODE.NEW:var n=[];t.isEmpty(this.bandNoList)||(n=t.without(this.bandNoList,this.bandNo));var i=this.editorView=s.buildForNewPost(this.bandNo,this.postModel,e,this._attachment,this.liveVideo,n);this.getRegion("editorRegion").show(i),this.listenTo(i,"save:post",(function(e){this.destroy(),this.trigger("postEditor:postAdded",{bandNo:this.bandNo,missionId:e&&e.isMissionCertifiedPost()?e.getMissionInfoForPost().getMissionId():null})})),this.listenTo(i,"save:reserved:post",(function(){this.destroy(),this.trigger("postEditor:reservedPostAdded",{bandNo:this.bandNo})})),this.listenTo(i,"save:approvable:post",(function(){this.destroy(),this.trigger("postEditor:approvablePostAdded",{bandNo:this.bandNo})}));break;case d.EDIT_MODE.MODIFY:i=this.editorView=s.buildForModifyPost(this.bandNo,this.postModel,e);this.getRegion("editorRegion").show(i),this.listenTo(i,"save:post",t.bind((function(e){this.destroy(),this.trigger("postEditor:postUpdated",{bandNo:this.bandNo,postNo:e.getPostNo()})}),this)),this.listenTo(i,"save:reserved:post",t.bind((function(e){this.destroy(),this.trigger("postEditor:reservedPostUpdated",{bandNo:this.bandNo,reservedPostId:e.getReservedPostId()})}),this)),this.listenTo(i,"save:approvable:post",t.bind((function(e){this.destroy(),this.trigger("postEditor:approvablePostUpdated",{bandNo:this.bandNo,approvablePostId:e.getApprovablePostId()})}),this));break;case d.EDIT_MODE.COPY:s.asyncBuildForCopyPost(this.bandNo,this.postModel,this.bandNoList).then(t.bind((function(e){this.editorView=e,this.getRegion("editorRegion").show(e),this.listenTo(e,"save:post",t.bind((function(e){this.destroy(),this.trigger("postEditor:postCopied",{bandCore:e.getBandCore()})}),this)),this.listenTo(e,"save:approvable:post",t.bind((function(e,t){this.destroy(),this._moveToMyApprovablePostView(e,t)}),this))}),this));break;case d.EDIT_MODE.SHARE:s.asyncBuildForSharePost(this.bandNo,this.postNo,this.bandNoList).then(t.bind((function(e){this.editorView=e,this.getRegion("editorRegion").show(e),this.listenTo(e,"save:post",t.bind((function(e){this.destroy(),this.trigger("postEditor:postShared",{bandNo:e.getBandNo()})}),this)),this.listenTo(e,"save:approvable:post",t.bind((function(e,t){this.destroy(),this._moveToMyApprovablePostView(e,t)}),this))}),this))}this.ui.lyContent.css("margin-top",77),this._sendSceneEnterJackpotLog()}),this))},_moveToMyApprovablePostView:function(e,t){t||f.GROUP_BAND_MY_APPROVABLE_POST.goDForced({band_no:e.getBandNo()})},_sendSceneEnterJackpotLog:function(){this.editMode===d.EDIT_MODE.MODIFY?this.jplSceneEnter(_.CLASSIFIER.POST_MODIFY):this.jplSceneEnter(_.CLASSIFIER.POST_WRITE_MAIN)},layerOnEscKeyDown:function(){this._cancelPost()},_cancelPost:function(){return this.editorView.onWriting()&&!confirm(IM("web.postwrite.confirm.write_cancel"))||this.destroy(),!1},_getEditorTitle:function(){if(this.options.title)return this.options.title;if(this.postModel&&this.postModel.isMissionCertifiedPost())return this.editMode==d.EDIT_MODE.NEW?IM("create.confirm_post.editor.title"):IM("modify.confirm_post.editor.title");var e=IM("web.postwrite.title.new_post");switch(this.editMode){case d.EDIT_MODE.NEW:e=IM("web.postwrite.title.new_post");break;case d.EDIT_MODE.MODIFY:e=this.postModel.isReservedPost()||this.postModel.isApprovablePost()?IM("web.postwrite.title.new_post"):IM("web.postwrite.title.modify_post");break;case d.EDIT_MODE.COPY:e=IM("web.copypost.title");break;case d.EDIT_MODE.SHARE:e=IM("web.sharepost.title")}return e},_getEditorDescription:function(){if(this.postModel&&this.postModel.isMissionCertifiedPost())return this.postModel.getMissionInfoForPost().getMissionTitle();if(this.bandList){var e=this.bandList[0].name;return 1===this.bandList.length?e:IM("web.sharedpostwrite.label.band_names",{name:e,count:this.bandList.length-1})}return null}});return A.openNewLayerWithLiveVideo=function(e,t){var n=r.newPostModelWithBandCore(e),i=p.createVideo({id:t.id,logoImage:t.url,width:t.width,height:t.height,title:"",isLive:!0,liveId:t.liveId,liveDescription:t.liveDescription});n.addAttachment(u.POST_ATTACHMENT_TYPE.VIDEO,i.cid,i),n.set("content",i.get("liveDescription")+'<band:attachment type="video" id="'+i.cid+'" />');var o=new A({bandNo:e.bandNo,postModel:n,editMode:d.EDIT_MODE.NEW,liveVideo:t});return c.open(o),o},A.openNewLayerWithSchedule=function(e,t){var n=r.newPostModelWithBandCore(e),i=p.createScheduleGroupByScheduleModel(t),o=i.cid;n.addAttachment(u.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP,o,i),n.set("content",'<band:attachment type="schedule_group" id="'+o+'" />');var s=new A({bandNo:e.bandNo,postModel:n,editMode:d.EDIT_MODE.NEW});return c.open(s),s},A.openNewLayer=function(e,t){var n,i=t.showBandNameLabel,o=t.attachment,s=r.newPostModelWithBandCore(e.getBandCore());i&&(n=[{name:e.getBandName(),bandNo:e.getBandNo()}]);var a=new A({bandNo:e.getBandNo(),postModel:s,bandList:n,editMode:d.EDIT_MODE.NEW,attachment:o});return c.open(a),a},A.openNewLayerWithMission=function(e){var t=e.bandData,n=e.bandMissionModel,i=r.newPostModelWithBandCoreAndMissionInfo(t.getBandCore(),n,e.bandMissionConfirmSummaryModel),o=new A({bandNo:t.getBandNo(),postModel:i,editMode:d.EDIT_MODE.NEW});return c.open(o),o},A.openNewLayerWithShareMissionConfirmRanking=function(e){var n=e.bandData,i=e.photoInfo,o=e.snippetUrl,s=e.snippetDesc;if(!n)throw new Error("BandData required");if(!i)throw new Error("PhotoInfo required");var a=n.getBandCore(),l=r.newPostModelWithBandCore(a),m=new A({bandNo:a.bandNo,postModel:l,editMode:d.EDIT_MODE.NEW}),_=u.POST_ATTACHMENT_TYPE.PHOTO,g=p.createPhotoByJSON({photoUrl:i.url,width:i.width,height:i.height,photographedAt:i.photographedAt}),f=g.cid,b='\n<band:attachment type="'+_+'" id="'+f+'" />';return s&&(b+=s),l.addAttachment(_,f,g),o?(h.getSnippet(o).done(t.bind((function(e){var t=u.POST_ATTACHMENT_TYPE.SNIPPET,n=p.createSnippet(e),i=n.cid;b+='<band:attachment type="'+t+'" id="'+i+'" />',l.addAttachment(t,i,n)}),this)).always(t.bind((function(){l.set("content",b),c.open(m)}),this)),m):(l.set("content",b),void c.open(m))},A.openModifyLayer=function(e,t,n){var i={bandNo:e,postNo:t,postModel:n,editMode:d.EDIT_MODE.MODIFY};n.isMissionCertifiedPost()&&(i.mission=n.getMissionInfoForPost());var o=new A(i);return c.open(o),o},A.openCopyLayer=function(e,t,n){var i=new A({bandNo:e,postNo:t.getPostNo(),postModel:t,bandList:n,editMode:d.EDIT_MODE.COPY});return c.open(i),i},A.openShareLayer=function(e,t,n){var i=new A({bandNo:e,postNo:t,bandList:n,editMode:d.EDIT_MODE.SHARE});return c.open(i),i},A.openUrlShareLayer=function(e,n,i,o){var s,a=(s=e,t.find([f.GROUP_BAND_POST_DETAIL,g.PAGE_BAND_POST_DETAIL],(function(e){return e.isMatched(s)})));if(!!a){var l=v.extractPageRouteData(a,e).pathVariables||{},m=A.openShareLayer(l.band_no,l.post_no,i);return $.Deferred().resolve(m)}var _=b.get(i[0].bandNo);return _.loadBandData().then(t.bind((function(){var s=_.getBandCore(),a=r.newPostModelWithBandCore(s),l=n+"\n"+e,m=new A({title:IM("web.sharepost.title"),bandNo:s.bandNo,postModel:a,bandList:i,editMode:d.EDIT_MODE.NEW});return h.getSnippet(e).done(t.bind((function(e){var t=u.POST_ATTACHMENT_TYPE.SNIPPET,n=p.createSnippet(e),i=n.cid;l+='<band:attachment type="'+t+'" id="'+i+'" />',a.addAttachment(t,i,n)}),this)).always(t.bind((function(){a.set("content",l),o?c.openWithoutHiding(m):c.open(m)}),this)),m}),this))},A}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<section class="lyWrap _lyWrap">\n    <div class="lyPostShareWrite _lyContent">\n        <header class="header">\n            <h1 class="title"><%-msg_title%></h1>\n            <% if (editorDescription) { %>\n            <p class="desc"><%-editorDescription%></p>\n            <% } %>\n        </header>\n        <div class="main _editorRegion"></div>\n        <footer class="footer">\n            <% if (msg_showBackButton) { %>\n            <button type="button" class="btnPrevLayer _btnBack"><span class="uButton -iconLyBack"><%-IM(\'web.ui.button.label.before\')%></span></button>\n            <% } %>\n\n            <button type="button" class="btnLyClose uButton -iconClose _btnCancel"><span class="gSrOnly"><%-IM(\'web.common.layer.option_modal_view.cancel\')%></span></button>\n        </footer>\n    </div>\n</section>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(52),s=n(4),a=n(153),r=n(162),l=n(2157),c=n(556),d=n(563),u=n(491),h=n(2158),p=n(2399),m=n(2401),_=n(684),g=n(26),f=n(718),b=n(568),v=n(177),A=n(156),E=n(721),T=n(152),C=n(851),y=n(1561),M=n(495),I=n(487),S=n(1251),w=n(1260),N=n(201),D=n(800),L=n(1286),O=n(1287),P=n(1634),x=n(1635),R=n(1636),k=n(1261),B=n(725),V=(n(906),n(562)),U=n(488),F=n(1053),H=n(600),z=n(507),W=n(537),G=s.View.extend({className:"cPostWrite",attributes:{"data-viewname":"DPostEditorView"},template:i.template(l),templateContext:function(){var e=new R(this.bandData),t=this.editMode===f.EDIT_MODE.NEW&&L.isBandLabOptionEnabled(O.OPTION_KEYS.POST_TEMPLATE);return{msg_isSettingEnabled:this._isPostSettingEnabled(),msg_isReservedPost:this._isReservedPost,msg_cid:this.cid,markdownLocaleName:i.bind((function(){if(!this._dataFetched)return"";var e=this._allowedAddonCollection.findAllowedAddonModelByType(y.MARKDOWN);return e?e.getLocaleName():""}),this),msg_settingInfoTxt:this._getSettingInfoTxt(),msg_settingReservationTime:this._getSettingReservationTime(),showTemplateFunctionBtn:t,toolbars:e.getMainToolbar(),mores:e.getMore(),showMore:e.needShowMore(),canShowTagSelectButton:this._isUsePostPinnedHashtag()}},ui:{richEditor:"."+f.RICH_EDITOR_CLASS,postWriteForm:"._postWriteForm",bottomToolbar:"._bottomToolbar",btnAttachSticker:"._btnAttachSticker",btnAttachPhoto:"._btnAttachPhoto",btnAttachVideo:"._btnAttachVideo",btnAttachFile:"._btnAttachFile",btnAttachLocation:"._btnAttachLocation",btnAttachPoll:"._btnAttachPoll",btnAttachTodo:"._btnAttachTodo",btnAttachQuiz:"._btnAttachQuiz",btnAttachSurvey:"._btnAttachSurvey",signupBtn:"._signupBtn",btnAttachSchedule:"._btnAttachSchedule",btnAttachBillSplit:"._btnAttachBillSplit",btnAttachAttendanceCheck:"._btnAttachAttendanceCheck",btnWriteSetting:"._btnWriteSetting",btnLoadTemplate:"._btnLoadTemplate",btnSaveAsTemplate:"._btnSaveAsTemplate",btnSubmitPost:"._btnSubmitPost",btnCancelPost:"._btnCancelPost",postWriteToolbar:"._postWriteToolbar",btnMarkdown:"._btnMarkdown",settingInfoTxt:"._settingInfoTxt",settingReservationTime:"._settingReservationTime",attachWidgetBtn:"._attachWidgetBtn",btnCreateLive:"._btnCreateLive",btnMoreAttach:"._btnMoreAttach",wrapMoreAttach:"._wrapMoreAttach",btnSelectTag:"._btnSelectTag"},events:{"click @ui.btnAttachSticker":"_showAttachSticker","click @ui.btnAttachPoll":"_showAttachPoll","click @ui.btnAttachLocation":"_showAttachLocation","click @ui.btnAttachTodo":"_showAttachTodo","click @ui.signupBtn":"_showAttachSignup","click @ui.btnAttachSchedule":"_showAttachSchedule","click @ui.btnAttachBillSplit":"_showAttachBillSplit","click @ui.btnAttachAttendanceCheck":"_showAttachAttendanceCheck","click @ui.btnAttachQuiz":"_showAttachQuiz","click @ui.btnAttachSurvey":"_showAttachSurvey","click @ui.btnWriteSetting":"_showWriteSetting","click @ui.btnLoadTemplate":function(e){var t=L.getPostTemplates(this.model.getBandNo());if(!i.isEmpty(t)){var n=i.map(t,i.bind((function(e,t){return{label:t,value:t}}),this));i.isEmpty(n)||D.openAsLayer({title:"템플릿을 선택해 주세요.",confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:n,withoutHiding:!0}).once("modal:confirm",i.bind((function(e){var n=t[e];n&&(this.model.set(this.model.parse(n)),this.render())}),this))}},"click @ui.btnSaveAsTemplate":function(e){var t=prompt("템플릿 제목을 입력하세요.");t&&(this.model.set("content",this.editor.getContent()),L.savePostTemplate(this.model.getBandNo(),t,this.model.toJSON()))},"click @ui.btnSubmitPost":"_uploadPost","paste @ui.postWriteForm ":function(e){var t=S.getImageFile(e);t&&this._clipboardPhotoUploader.uploadFiles(t)},"click @ui.btnAttachVideo":function(){var e=this._getPhotoVideoCounts();if(e.videoCount>=e.maxVideoCount)return alert(e.videoExcessMessage),!1},"click @ui.btnMarkdown":function(){this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.ADDON),this.editor.addMarkdown()},"focus @ui.attachWidgetBtn":function(e){var n=t(e.currentTarget);n.hasClass("-active")||n.addClass("-active"),this._setZIndexBottomToolbar()},"blur @ui.attachWidgetBtn":function(e){t(e.currentTarget).removeClass("-active"),this._resetZIndexBottomToolbar()},"mouseover @ui.attachWidgetBtn":function(){this.getUI("attachWidgetBtn").removeClass("-active"),this._setZIndexBottomToolbar()},"mouseout @ui.attachWidgetBtn":"_resetZIndexBottomToolbar","click @ui.btnCreateLive":function(){if(!N.isSupported())return alert(IM("live.not_support_browser")),!1;var e=this.bandData.getBandCore().makeBandRouteUrl(a.GROUP_BAND_CREATE_LIVE,r.PAGE_BAND_CREATE_LIVE,{band_no:this.bandData.getBandNo()});return window.open(e,"_blank"),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.LIVE),!1},"click @ui.btnMoreAttach":function(){this.getUI("btnMoreAttach").focus()},"focus @ui.btnMoreAttach":function(){this.getUI("wrapMoreAttach").show()},"blur @ui.btnMoreAttach":function(e){t.contains(this.getUI("wrapMoreAttach")[0],e.relatedTarget)||setTimeout(i.bind((function(){this.getUI("wrapMoreAttach").hide()}),this))},"click @ui.wrapMoreAttach":function(){this.getUI("wrapMoreAttach").hide()},"click @ui.btnSelectTag":function(e){e.preventDefault(),e.stopPropagation(),this._openHashtagList()}},behaviors:function(){return[{behaviorClass:M,sceneId:this.getOption("editMode")===f.EDIT_MODE.MODIFY?M.SCENE.POST_MODIFY:M.SCENE.POST_WRITE_MAIN},I]},initialize:function(e){if(this.editMode=e.editMode,this.bandNoList=e.bandNoList,this.sourceBandNo=e.sourceBandNo,this.bandData=e.bandData,this._attachment=e.attachment,this._isReservedPost=this.model.isReservedPost(),this._isApprovablePost=this.model.isApprovablePost(),this._dataFetched=!1,this.liveVideo=e.liveVideo,this.editMode==f.EDIT_MODE.MODIFY){var t=this.model.getAttachment(T.POST_ATTACHMENT_TYPE.STICKER).toJSON();this._originalPostSticker=JSON.parse(JSON.stringify(t))}},onRender:function(){if(this._dataFetched){this._createUploaders();var e=f.preventMention(this.editMode,this.bandNoList);this.editor=new h({el:this.ui.richEditor[0],richPostModel:this.model,preventMention:e,editMode:this.editMode,allowedAddonCollection:this._allowedAddonCollection,bandData:this.bandData,isPostToMultipleBand:this._isPostToMultipleBand(),isUsePostPinnedHashtag:this._isUsePostPinnedHashtag()}),this.listenToOnce(this.editor,"editor:initialized",(function(){var e=this.ui.bottomToolbar.outerHeight(!0),n=this.ui.postWriteToolbar.height(),o=t(window).height()-this.$el.position().top-e-107-32-n;this.ui.postWriteForm.css({"max-height":o+"px"}),this.ui.postWriteForm.addClass("-standby"),this._toggleBtnSubmitPostClass(),t(E.BODY).css("height","auto"),setTimeout(i.bind((function(){t(E.BODY).css("height",""),this._openAttachmentPopupShortly()}),this),300),this._adjustTagSelectButtonPosition()})),this.listenTo(this.editor,h.EVENT.CHANGE,(function(e){e&&e.justAdjustPosition?this._adjustTagSelectButtonPosition():(this._toggleBtnSubmitPostClass(),this._adjustTagSelectButtonPosition(),this.getUI("attachWidgetBtn").removeClass("-active").blur())})),this._bindBeforeRoute()}else C.getCachedAllowedAddonCollection().then(i.bind((function(e){this._allowedAddonCollection=e,this._dataFetched=!0,this.render()}),this))},_setZIndexBottomToolbar:function(){this.getUI("bottomToolbar").css("z-index",400)},_resetZIndexBottomToolbar:function(){this.getUI("bottomToolbar").css("z-index","auto")},_adjustTagSelectButtonPosition:function(){if(this.bandData.isPinnedHashtagsRequiredOnPost()&&!this._isPostToMultipleBand()&&!this.isDestroyed()){var e=this.getUI("postWriteForm").height()<this.getUI("richEditor").outerHeight(),n=this.getUI("postWriteForm").position().top+this.getUI("postWriteForm").outerHeight(),o=n>this.getUI("btnSelectTag").position().top,s=!i.isUndefined(this.oldPostWriteFormPositionBottom)&&this.oldPostWriteFormPositionBottom>n;if(!e||!this.isDisableAdjustTagSelectButtonPosition||s||o){this.isDisableAdjustTagSelectButtonPosition=e;var a,r=this.editor.getElement().$,l=t(r.lastElementChild),c=this.getUI("postWriteForm").position().top+this.getUI("postWriteForm").height(),d=114;0!==l.length&&(l.is("[data-cke-hidden-sel]")&&(l=l.prev()),a=l.height(),(""!==t(this.editor.getData()).text().trim()||r.childElementCount>1)&&(d=l.position().top+a+80),d>=c&&(d=c+20),this.oldPostWriteFormPositionBottom=n,this.getUI("btnSelectTag").css("top",d))}}},_isPostSettingEnabled:function(){if(!this.bandData)return!1;if(this._isPostToMultipleBand())return!1;var e=this.bandData.getBandCore().supportSaveSettingPerContent()||this.bandData.isNoticeEditPermitted()||this.bandData.isCreateReservedPostPermitted();return(this.model.isMissionCertifiedPost()||this.editMode==f.EDIT_MODE.MODIFY&&this.model.getPostNo())&&(e=this.bandData.isNoticeEditPermitted()||this.bandData.getBandCore().supportSaveSettingPerContent()),e},_openAttachmentPopupShortly:function(){var e=void 0;switch(this._attachment){case"photo":e=this.ui.btnAttachPhoto;break;case"video":e=this.ui.btnAttachVideo;break;case"file":e=this.ui.btnAttachFile;break;case"sticker":e=this.ui.btnAttachSticker;break;case"poll":e=this.ui.btnAttachPoll;break;case"location":e=this.ui.btnAttachLocation;break;case"todo":e=this.ui.btnAttachTodo;break;case"attendance":e=this.ui.btnAttachAttendanceCheck;break;case"schedule":e=this.ui.btnAttachSchedule;break;case"signup":e=this.ui.signupBtn;break;case"billsplit":e=this.ui.btnAttachBillSplit;break;case"markdown":e=this.ui.btnMarkdown;break;case"quiz":e=this.ui.btnAttachQuiz;break;case"survey":e=this.ui.btnAttachSurvey}e&&(e.focus(),e.click())},onBeforeDetach:function(){this.editor&&this.editor.destroy(),this._destroyUploaders()},onWriting:function(){return this.editor.hasContent()},_isUsePostPinnedHashtag:function(){return this.bandData.isPinnedHashtagsRequiredOnPost()&&!this._isPostToMultipleBand()},_toggleBtnSubmitPostClass:function(){var e=this.editor.hasContent();this.getUI("btnSubmitPost").toggleClass("-confirm",e).toggleClass("-disabled",!e)},_extractContentPinnedHashtags:function(){return this._fetchBandPinnedHashtags().then(i.bind((function(){var e=i.pluck(this.bandTagsModel.get("bandTags"),"hashtag"),n=[];return t(this.editor.editor.getData()).find("."+U.ELEMENT.HASHTAG).each((function(e,i){i=F.encodeQuery(t(i).text().trim(),!0),n.push(i)})),i.intersection(e,n)}),this))},_fetchBandPinnedHashtags:function(){return this.fetchingBandTags||this.bandTagsModel?t.Deferred().resolve().promise():(this.fetchingBandTags=!0,this.bandTagsModel=new B,this.bandTagsModel.fetchBandTagsWithPinned(this.model.getBandNo()).always(i.bind((function(){this.fetchingBandTags=!1}),this)))},_bindBeforeRoute:function(){this.stopListening(g.getDGlobalChannel(),g.EVENT.BEFORE_ROUTE),this.listenTo(g.getDGlobalChannel(),g.EVENT.BEFORE_ROUTE,(function(e){this.onWriting()&&!confirm(IM("web.postwrite.confirm.write_cancel"))&&(e.preventRoute=!0)}))},_uploadPost:function(){!this._onSubmit&&this.ui.btnSubmitPost.hasClass("-confirm")&&(this._isUsePostPinnedHashtag()?this._extractContentPinnedHashtags().then(i.bind((function(e){e.length>0?this._performAllStepsForUploadPost():V.openLayer({bodyTitle:IM("post.write.add_post_hashtag.alert"),withoutHiding:!1})}),this)):this._performAllStepsForUploadPost())},_openHashtagList:function(){""===this.editor.getData()&&this.editor.insertElement(new CKEDITOR.dom.element("p")),this.editor.autoCompleteBandHashtags.openHashtagList(!0)},_performAllStepsForUploadPost:function(){if(this._onSubmit=!0,this.jplClick(I.CLASSIFIER.POST_CREATE_CONFIRM,{reserve:this._isReservedPost}),this.model.set("content",this.editor.getContent()),!this.model.isValid())return alert(this.model.validationError),this._onSubmit=!1,this.model.hasUnmatchedAttachments()&&this.model.removeUnmatchedAttachments(),!1;this._disableSubmitButton(),this.bandData.fetchBandData().then(i.bind((function(e){this._validatePermissionCheck(e)&&(this.model.hasSticker()?_.singletonBuildStickerUsingPackDataCollection().fetchStickerPackCollection().then(i.bind((function(t){var n=e.getStickerPackNos().concat(t.pluck("no")),o=i.chain(this.model.getAttachment(T.POST_ATTACHMENT_TYPE.STICKER).toJSON()).values().pluck("packNo").value();if(this.editMode===f.EDIT_MODE.MODIFY&&(o=i.difference(o,i.chain(this._originalPostSticker).values().pluck("packNo").value())),i.difference(o,n).length>=1)return alert(IM("web.postwrite.alert.not_allowed_attach")),void this._enableSubmitButton();this._uploadPostByEditMode()}),this),i.bind((function(){this._enableSubmitButton()}),this)):this._uploadPostByEditMode())}),this),i.bind((function(){this._enableSubmitButton()}),this))},_validatePermissionCheck:function(e){return!e.isPostingPermitted()||this._isReservedPost&&!e.isCreateReservedPostPermitted()?(alert(IM("permission.not_appointed_member_submit_denied")),this._enableSubmitButton(),this.trigger("cancel:write:post"),!1):!(this.model.hasScheduleGroup()&&!e.isSchedulePermitted())||(alert(IM("web.postwrite.alert.not_allowed_attach")),this._enableSubmitButton(),!1)},_createPost:function(){this.model.savePost(this.bandNoList).done(i.bind((function(){this._isReservedPost&&this.model.get("publishesAt")?this.trigger("save:reserved:post",this.model):this.trigger("save:post",this.model)}),this)).fail(i.bind((function(e){return this._enableSubmitButton(),e.result_code==T.ERROR_CODE_FOR_NEED_APPROVE_POST?(alert(IM("editor.need.approve.alert")),void this.trigger("save:approvable:post",this.model)):e.result_code==T.ERROR_CODE_FOR_NOTICE_PERMISSION?(alert(e.result_data.message),void this.trigger("save:post",this.model)):void(this._isReservedPost&&e.result_code==T.ERROR_CODE_FOR_RESERVED_POST&&confirm(IM("web.postwrite.confirm.reserved_count_over"))&&(this.model.unset("publishesAt"),this._uploadPost()))}),this))},_uploadPostByEditMode:function(){switch(this.editMode){case f.EDIT_MODE.NEW:this._createPost();break;case f.EDIT_MODE.MODIFY:if(this._isReservedPost||this._isApprovablePost)return void this._createPost();this.model.updatePost().done(i.bind((function(){this.trigger("save:post",this.model)}),this)).fail(i.bind(this._enableSubmitButton,this));break;case f.EDIT_MODE.COPY:this.model.copyPost(this.sourceBandNo,this.bandNoList).done(i.bind((function(){this.trigger("save:post",this.model)}),this)).fail(i.bind((function(e){if(e.result_code==T.ERROR_CODE_FOR_NEED_APPROVE_POST)return alert(IM("editor.need.approve.alert")),void this.trigger("save:approvable:post",this.model,this._isPostToMultipleBand());this._enableSubmitButton()}),this));break;case f.EDIT_MODE.SHARE:this.model.sharePost(this.sourceBandNo,this.bandNoList).done(i.bind((function(){this.trigger("save:post",this.model)}),this)).fail(i.bind((function(e){if(e.result_code==T.ERROR_CODE_FOR_NEED_APPROVE_POST)return alert(IM("editor.need.approve.alert")),void this.trigger("save:approvable:post",this.model,this._isPostToMultipleBand());this._enableSubmitButton()}),this))}},_disableSubmitButton:function(){this.ui.btnSubmitPost.text(IM("web.postwrite.btn.on_post")),this.ui.btnSubmitPost.attr("data-status","off"),this.ui.btnSubmitPost.removeClass("-md")},_enableSubmitButton:function(){this._onSubmit=!1,this.ui.btnSubmitPost.text(IM("web.postwrite.btn.post")),this.ui.btnSubmitPost.removeAttr("data-status"),this.ui.btnSubmitPost.addClass("-md")},_destroyUploaders:function(){this._photoUploader&&(this._photoUploader.destroy(),this._photoUploader=null),this._videoUploader&&(this._videoUploader.destroy(),this._videoUploader=null),this._fileUploader&&(this._fileUploader.destroy(),this._fileUploader=null),this._clipboardPhotoUploader&&(this._clipboardPhotoUploader.destroy(),this._clipboardPhotoUploader=null)},_sendPostAttachmentClickJackpotLog:function(e){var t=o.decamelize(e);t===o.decamelize(c.POST_ATTACHMENT_TYPE.POLL_V2)?t="poll":t===o.decamelize(c.POST_ATTACHMENT_TYPE.TODO_V2)?t="todo":t===o.decamelize(c.POST_ATTACHMENT_TYPE.LOCATION)?t="map":t===o.decamelize(c.POST_ATTACHMENT_TYPE.BILL_SPLIT)?t="chipping_in":t===o.decamelize(c.POST_ATTACHMENT_TYPE.ADDON)?t="note":t===o.decamelize(c.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP)&&(t="schedule");var n="N";"map"===t&&(n="Y"),this.jplClick(I.CLASSIFIER.ATTACHED_ITEM,{item:t,use_location_information:n})},_showWriteSetting:function(){var e=!0;(this.editMode==f.EDIT_MODE.MODIFY&&this.model.getPostNo()||this.editMode===f.EDIT_MODE.NEW&&this.liveVideo||this.model.isMissionCertifiedPost())&&(e=!1);var t=m.openLayer(this.bandData,this.model,e,this.bandData.canShowPostNoticeToConnectedBand());return this.listenToOnce(t,"destroy",i.bind((function(){this._isReservedPost=this.model.isReservedPost(),this.model.get("publishesAt")?this.getUI("btnSubmitPost").text(IM("web.postwrite.btn.reserve")):this.getUI("btnSubmitPost").text(IM("web.postwrite.btn.post")),this.getUI("settingReservationTime").text(this._getSettingReservationTime()),this.getUI("settingInfoTxt").text(this._getSettingInfoTxt())}),this)),!1},_getSettingInfoTxt:function(){return w.isNotificationTypePost(this.model)?w.isMajorNoticePost(this.model)?IM("post.list.majorNotice"):IM("post.list.notice"):""},_getSettingReservationTime:function(){return this._isReservedPost&&this.model.get("publishesAt")?P.makeDateTimeText(this.model.get("publishesAt"),"date_time",this.model.get("reservationTimeZoneId")):""},_showAttachSticker:function(){var e=p.openLayer({bandNo:this.model.getBandNo(),useBandStickerPack:this._canUseBandStickerPack()});return this.listenToOnce(e,"editor:sticker:selected",i.bind((function(e){this.editor.addStickerWidget(e)}),this)),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.STICKER),!1},_showAttachPoll:function(){return this.editor.addPollWidget(),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.POLL),!1},_showAttachLocation:function(){this.editor.addLocationWidget(),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.LOCATION)},_showAttachTodo:function(){return this.editor.addTodoWidget(),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.TODO),!1},_showAttachSignup:function(){return this.editor.addSignupWidget(),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.SIGNUP),!1},_showAttachBillSplit:function(){if(this._isPostToMultipleBand())return alert(IM("web.postwrite.alert.bill_attach")),!1;this.editor.addBillSplitWidget(),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.BILL_SPLIT)},_showAttachSchedule:function(){return this._isPostToMultipleBand()?(alert(IM("web.postwrite.alert.schedule_attach")),!1):(this.editor.addScheduleWidget(),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP),!1)},_showAttachAttendanceCheck:function(){return this._isPostToMultipleBand()?(alert(IM("web.postwrite.alert.attendance_check_attach")),!1):(this.editor.addAttendanceCheckWidget(),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.ATTENDANCE_CHECK),!1)},_showAttachQuiz:function(){return this._isPostToMultipleBand()?(alert(IM("web.postwrite.alert.quiz_attach")),!1):(this.editor.addQuizWidget(),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.QUIZ),!1)},_showAttachSurvey:function(){return this._isPostToMultipleBand()?(alert(IM("web.postwrite.alert.survey_attach")),!1):(this.editor.addSurveyWidget(),this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.SURVEY),!1)},_isAlbumSelectable:function(){return this.model.hasPhoto()||this.model.hasVideo()||this.model.set("album",null),null==this.model.get("album")},_createUploaders:function(){var e=window.webkitURL?" ":"";this._createPhotoUploader(e),this._createVideoUploader(e),this._createFileUploader(e),this._createClipboardPhotoUploader()},_createPhotoUploader:function(e){this._photoUploader&&this._photoUploader.destroy();var t=this.bandData.getBandCore(),n=i.bind((function(){this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.PHOTO)}),this);this._photoUploader=k.createPhotoUploader({inputElement:this.ui.btnAttachPhoto,inputTitle:e,inputClick:n,bandNo:t.bandNo,skinColor:t.getSkinColorClass(),readPhotographedAt:this.model.isMissionCertifiedPost(),countInfo:i.bind(this._getPhotoVideoCounts,this),useUploadView:this.editMode===f.EDIT_MODE.NEW,albumSelectable:i.bind(this._isAlbumSelectable,this),submitBtnText:IM("web.btn.attach"),openWithoutHiding:!0}),this.listenTo(this._photoUploader,this._photoUploader.EVENT.UPLOAD,(function(e){this._setAlbumToModel(e.albumNo),this._addPhotoWidgetList(e.uploadResultList)}))},_addPhotoWidgetList:function(e){i.isEmpty(e)||(this._onSubmit=!0,this.ui.richEditor.toggleClass("-loading",!0),i.reduce(e,(function(e,n){return e.then(i.bind((function(){return n.isGifVideo?(this._addVideoWidgetList([n]),t.when()):this.editor.addPhotoWidget(d.createPhotoByJSON({photoUrl:n.url,width:n.width,height:n.height,photographedAt:n.photographedAt}))}),this))}),t.Deferred().resolve(),this).then(i.bind((function(){this.ui.richEditor.toggleClass("-loading",!1),this._onSubmit=!1}),this)))},_createVideoUploader:function(e){this._videoUploader&&this._videoUploader.destroy();var t=this.bandData.getBandCore(),n=i.bind((function(){this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.VIDEO)}),this);this._videoUploader=k.createVideoUploader({inputElement:this.ui.btnAttachVideo,inputTitle:e,inputClick:n,bandNo:t.bandNo,skinColor:t.getSkinColorClass(),countInfo:i.bind(this._getPhotoVideoCounts,this),albumSelectable:i.bind(this._isAlbumSelectable,this),submitBtnText:IM("web.btn.attach"),openWithoutHiding:!0}),this.listenTo(this._videoUploader,this._videoUploader.EVENT.UPLOAD,(function(e){this._setAlbumToModel(e.albumNo),this._addVideoWidgetList(e.uploadResultList)}))},_addVideoWidgetList:function(e){i.isEmpty(e)||i.each(e,i.bind((function(e){var t=d.createVideoByJSON({id:e.id,logoImage:e.url,width:e.width,height:e.height,title:e.name,isGif:e.isGifVideo,isLive:!!e.liveId,liveId:e.liveId||"",liveDescription:e.liveDescription});this.editor.addVideoWidget(t)}),this))},_setAlbumToModel:function(e){null!=e&&e!=b.TOTAL_ALBUM_NO&&(this.model.set("album",d.createAlbum({album_no:e})),g.getPostChannel().trigger(g.EVENT.POST_ALBUM_CHANGED))},_createFileUploader:function(e){this._fileUploader&&this._fileUploader.destroy(),this._fileUploader=x.createBandFileUploader({element:this.ui.btnAttachFile,inputTitle:e,bandData:this.bandData,fileCount:i.bind((function(){return this.model.getFileCount()}),this),inputClick:i.bind((function(){this._sendPostAttachmentClickJackpotLog(c.POST_ATTACHMENT_TYPE.FILE)}),this)}),this.listenTo(this._fileUploader,this._fileUploader.EVENT.COMPLETE,(function(e){var t=e.folderId;i.each(e.files,i.bind((function(e){var n=d.createFileByJSON({id:e.id,title:e.file_name,fileSize:e.file_size,isRestricted:!1,folderId:t});this.editor.addFileWidget(n)}),this))}))},_createClipboardPhotoUploader:function(){this._clipboardPhotoUploader&&this._clipboardPhotoUploader.destroy();var e=this.bandData.getBandCore(),n={multiple:!1,showProgress:!1,readPhotographedAt:this.model.isMissionCertifiedPost(),data:{band_no:e.bandNo},validators:[i.bind((function(e){return W.PHOTO_AND_GIF_VALIDATOR(e,this._getPhotoVideoCounts())}),this)]};this._clipboardPhotoUploader=H.createPhotoUploader(t('<span><input type="file"></span>'),n),this.listenTo(this._clipboardPhotoUploader,z.UPLOAD_COMPLETE,(function(e){var t=e.resultList;i.isEmpty(t)||this._addPhotoWidgetList(t)}))},_getPhotoVideoCounts:function(){var e=this.model.getAttachment(T.POST_ATTACHMENT_TYPE.PHOTO),t=e.chain().values().filter((function(e){return A.isGif(e.get("photoUrl"))})).size().value(),n=this.model.getAttachment(T.POST_ATTACHMENT_TYPE.VIDEO).length(),i=v.PHOTO.POST_COUNT_LIMIT,o=n+t;return o>v.VIDEO.POST_COUNT_LIMIT&&(i=v.PHOTO.POST_COUNT_LIMIT+v.VIDEO.POST_COUNT_LIMIT-o),{photoCount:e.length()-t,maxPhotoCount:i,photoExcessMessage:IM("web.upload.validation.alert.photo_count",{count:v.PHOTO.POST_COUNT_LIMIT}),gifCount:o,maxGifCount:v.VIDEO.POST_COUNT_LIMIT,gifExcessMessage:IM("upload.gif_video.up_to_n",{n:v.VIDEO.POST_COUNT_LIMIT}),videoCount:o,maxVideoCount:v.VIDEO.POST_COUNT_LIMIT,videoExcessMessage:IM("upload.gif_video.up_to_n",{n:v.VIDEO.POST_COUNT_LIMIT})}},_isPostToMultipleBand:function(){return!!this.bandNoList&&!(this.bandNoList.length<=0)},_canUseBandStickerPack:function(){switch(this.editMode){case f.EDIT_MODE.NEW:case f.EDIT_MODE.MODIFY:return!this._isPostToMultipleBand()}return!1}});return G.buildForNewPost=function(e,t,n,i,o,s){if(!t)throw new Error("postModel is required");return new G({editMode:f.EDIT_MODE.NEW,model:t,bandData:n,attachment:i,liveVideo:o,bandNoList:s})},G.buildForModifyPost=function(e,t,n){return new G({bandData:n,model:t,editMode:f.EDIT_MODE.MODIFY})},G.asyncBuildForCopyPost=function(e,t,n){return u.getCachedBandData(n.shift()).then((function(e){return t.changePropsForCopy(e,n).then((function(){return e}))})).then((function(i){return new G({editMode:f.EDIT_MODE.COPY,model:t,sourceBandNo:e,bandNoList:n,bandData:i})}))},G.asyncBuildForSharePost=function(e,n,i){return t.when(c.createAndFetchBandPostModel(e,n),u.getCachedBandData(i.shift())).then((function(t,o){var s,a,r=t.get("band").getSharedPostSnippetAttachmentType();return r===T.POST_ATTACHMENT_TYPE.SHARED_POST_SNIPPET?(s=c.newPostModelWithBandCore(o.getBandCore()).fetchSharedPostSnippet(e,n),a='<band:attachment type="shared_post_snippet" /><p></p>'):(s=c.newPostModelWithBandCore(o.getBandCore()).fetchSharedPagePostSnippet(e,n),a='<band:attachment type="shared_page_post_snippet" /><p></p>'),s.then((function(s){var l=s.getAttachment(r),c=l.get("image"),d=t.getAttachment(T.POST_ATTACHMENT_TYPE.VIDEO).chain().values().find((function(e){return e.get("logoImage")==this._image}),{_image:c||null}).value();return d&&l.set({isPlayButtonVisible:!d.get("isGif")}),s.set("postNo",n),s.set("content",a),new G({editMode:f.EDIT_MODE.SHARE,model:s,sourceBandNo:e,bandNoList:i,bandData:o})}))}))},G}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<h3 class="gSrOnly"><%-IM(\'web.postwrite.title.new_post\')%></h3>\n<div id="postWriteToolbar" class="writeToolbar _postWriteToolbar"></div>\n\n<div class="postWriteForm _postWriteForm">\n    <p class="gSrOnly" id="postWriteFormPlaceholderText"><%- IM(\'web.post.write.placeholder\') %></p>\n    <div class="contentEditor _richEditor" contenteditable="true" aria-labelledby="postWriteFormPlaceholderText"></div>\n</div>\n\n<% if (canShowTagSelectButton) { %>\n<a href="#" role="button" class="hashTagAdd _btnSelectTag">\n    <svg class="svgIcon sf_color" aria-hidden="true">\n        <use href="#ico-tag-20"></use>\n    </svg>\n    <span class="text sf_color"><%= IM(\'post.write.select_hashtag\') %></span>\n</a>\n<% } %>\n\n<div class="buttonArea _bottomToolbar">\n    <ul class="toolbarList">\n        <% if (toolbars.photo) { %>\n        <li class="toolbarListItem">\n            <label class="photo _btnAttachPhoto _attachWidgetBtn" for="postPhotoInput_<%= msg_cid %>">\n                <input type="file" id="postPhotoInput_<%= msg_cid %>" multiple="multiple" aria-labelledby="photoLabel_<%= msg_cid %>">\n                <span class="tooltip" id="photoLabel_<%= msg_cid %>"><%-IM(\'web.postwrite.btn.attach.photo\')%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-photo"></use>\n                </svg>\n            </label>\n        </li>\n        <% } %>\n        <% if (toolbars.sticker) { %>\n        <li class="toolbarListItem">\n            <button class="sticker _btnAttachSticker _attachWidgetBtn" type="button">\n                <span class="tooltip"><%-IM(\'web.postwrite.btn.attach.sticker\')%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-sticker"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.video) { %>\n        <li class="toolbarListItem">\n            <label class="movie _btnAttachVideo _attachWidgetBtn" for="postVideoInput_<%= msg_cid %>">\n                <input type="file" id="postVideoInput_<%= msg_cid %>" multiple="multiple"  aria-labelledby="movieLabel_<%= msg_cid %>">\n                <span class="tooltip" id="movieLabel_<%= msg_cid %>"><%-IM(\'web.postwrite.btn.attach.video\')%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-video"></use>\n                </svg>\n            </label>\n        </li>\n        <% } %>\n\n        <% if (toolbars.live) { %>\n        <li class="toolbarListItem">\n            <button type="button" class="live _btnCreateLive _attachWidgetBtn">\n                <span class="tooltip"><%- IM("band.live") %></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-live"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.poll) { %>\n        <li class="toolbarListItem dividLine">\n            <button class="vote _btnAttachPoll _attachWidgetBtn" type="button">\n                <span class="tooltip"><%-IM(\'web.postwrite.btn.attach.poll\')%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-vote"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.file) { %>\n        <li class="toolbarListItem">\n            <label class="file _btnAttachFile _attachWidgetBtn" for="postFileInput_<%= msg_cid %>">\n                <input type="file" id="postFileInput_<%= msg_cid %>" multiple="multiple" aria-labelledby="fileLabel_<%= msg_cid %>">\n                <span class="tooltip" id="fileLabel_<%= msg_cid %>"><%-IM(\'web.postwrite.btn.attach.file\')%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-file"></use>\n                </svg>\n            </label>\n        </li>\n        <% } %>\n\n        <% if (toolbars.schedule) { %>\n        <li class="toolbarListItem">\n            <button class="calendar _btnAttachSchedule _attachWidgetBtn" type="button">\n                <span class="tooltip"><%-IM(\'web.postwrite.btn.attach.schedule\')%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-cal"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.todo) { %>\n        <li class="toolbarListItem">\n            <button class="todo _btnAttachTodo _attachWidgetBtn" type="button">\n                <span class="tooltip"><%-IM(\'web.postwrite.btn.attach.todo\')%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-todo"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n        <% if (toolbars.signup) { %>\n        <li class="toolbarListItem">\n            <button type="button" class="signup _signupBtn _attachWidgetBtn">\n                <span class="tooltip"><%- IM(\'signup.type_name\') %></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-signup"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.attendance) { %>\n        <li class="toolbarListItem">\n            <button type="button" class="attendance _btnAttachAttendanceCheck _attachWidgetBtn">\n                <span class="tooltip"><%- IM(\'web.postwrite.btn.attach.attendance_check\') %></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-attendance"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.quiz) { %>\n        <li class="toolbarListItem">\n            <button type="button" class="quiz  _btnAttachQuiz _attachWidgetBtn">\n                <span class="tooltip "><%-IM("quiz.editor.form.title")%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-quiz"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.survey) { %>\n        <li class="toolbarListItem">\n            <button type="button" class="survey _btnAttachSurvey _attachWidgetBtn">\n                <span class="tooltip "><%-IM("survey.editor.form.title")%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-survey"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.location) { %>\n        <li class="toolbarListItem">\n            <button type="button" class="map _btnAttachLocation _attachWidgetBtn">\n                <span class="tooltip "><%-IM("web.postwrite.btn.attach.location") %></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-map"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.billsplit) { %>\n        <li class="toolbarListItem">\n            <button class="n _btnAttachBillSplit _attachWidgetBtn" type="button">\n                <span class="tooltip"><%-IM(\'web.postwrite.btn.attach.billsplit\')%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-nbang"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (toolbars.markdown) { %>\n        <li class="toolbarListItem">\n            <button type="button" class="markdown _btnMarkdown _attachWidgetBtn">\n                <span class="tooltip"><%- markdownLocaleName() %></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-markdown"></use>\n                </svg>\n            </button>\n        </li>\n        <% } %>\n\n        <% if (showMore) { %>\n        <li class="toolbarListItem">\n            \x3c!--더보기--\x3e\n            <button type="button" class="btnMoreAttach _attachWidgetBtn _btnMoreAttach">\n                <span class="gSrOnly"><%-IM("ui.label.more.short")%></span>\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-more-attache-btns"></use>\n                </svg>\n            </button>\n\n            <ul class="moreAttachList _wrapMoreAttach" style="display: none;">\n                <% if (mores.location) { %>\n                <li class="moreAttachItem">\n                    <button type="button" class="map _btnAttachLocation">\n                        <svg class="svgIcon" aria-hidden="true">\n                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-map"></use>\n                        </svg>\n                        <span class="label"><%-IM("web.postwrite.btn.attach.location") %></span>\n                    </button>\n                </li>\n                <% } %>\n\n                <% if (mores.billsplit) { %>\n                <li class="moreAttachItem">\n                    <button type="button" class="n _btnAttachBillSplit">\n                        <svg class="svgIcon" aria-hidden="true">\n                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-nbang"></use>\n                        </svg>\n                        <span class="label"><%-IM(\'web.postwrite.btn.attach.billsplit\')%></span>\n                    </button>\n                </li>\n                <% } %>\n                <% if (mores.markdown) { %>\n                <li class="moreAttachItem">\n                    <button type="button" class="markdown _btnMarkdown">\n                        <svg class="svgIcon" aria-hidden="true">\n                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-p-markdown"></use>\n                        </svg>\n                        <span class="label"><%- markdownLocaleName() %></span>\n                    </button>\n                </li>\n                <% } %>\n            </ul>\n        </li>\n        <% } %>\n\n    </ul>\n\n    <div class="writeSettingBox">\n        <% if (msg_isSettingEnabled) { %>\n        <div class="settingArea">\n            <button type="button" class="btnSetting _btnWriteSetting"><%-IM(\'web.postwrite.btn.write_setting\')%></button>\n            <span class="settingInfo"><span class="infoText _settingInfoTxt"><%- msg_settingInfoTxt %></span><span class="reservationTime _settingReservationTime"><%- msg_settingReservationTime %></span></span>\n        </div>\n        <% } %>\n\n        <div class="buttonSubmit">\n            <% if (showTemplateFunctionBtn) { %>\n            <button type="submit" class="uButton -sizeM -confirm _btnLoadTemplate">템플릿 불러오기</button>\n            <button type="submit" class="uButton -sizeM -confirm _btnSaveAsTemplate">템플릿으로 저장</button>\n            <% } %>\n            <% if (msg_isReservedPost) { %>\n            <button type="submit" class="uButton -sizeM -confirm -disabled _btnSubmitPost"><%-IM(\'web.postwrite.btn.reserve\')%></button>\n            <% } else { %>\n            <button type="submit" class="uButton -sizeM -confirm -disabled _btnSubmitPost"><%-IM(\'web.postwrite.btn.post\')%></button>\n            <% } %>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(2159),a=n(2161),r=n(2164),l=n(2178),c=n(2179),d=n(2187),u=n(2188),h=n(2191),p=n(2199),m=n(2262),_=n(2281),g=n(2286),f=n(2289),b=n(2293),v=n(2298),A=n(2301),E=n(2304),T=n(2307),C=n(2310),y=n(2313),M=n(2318),I=n(2319),S=n(2320),w=n(2322),N=n(2324),D=n(2325),L=n(2326),O=n(2338),P=n(2341),x=n(2370),R=n(2394),k=n(2395),B=n(2396),V=n(2397),U=n(2398),F=n(718),H=n(563),z=n(1617),W=n(2001),G=n(1620),K=n(2008),Y=n(1177),j=n(2013),Q=n(2010),q=n(2014),J=n(2024),X=n(713),Z=n(712),$=n(658),ee=n(602),te=n(152),ne=n(1560),ie=n(1561),oe=n(13),se=n(2002),ae=n(206),re=n(906);n(936);var le={CHANGE:"change"},ce=o.Object.extend({originClipboardData:null,initialize:function(e){this._richPostModel=e.richPostModel,this._editMode=e.editMode,this._allowedAddonCollection=e.allowedAddonCollection,e.el.innerHTML=ne.convertToHtml(e.richPostModel),this._initEditor(e.el,e.richPostModel,e.preventMention,e.bandData)},addStickerWidget:function(e){this._richPostModel.getAttachment(te.POST_ATTACHMENT_TYPE.STICKER).length()>=20?alert(IM("editor.limitation.sticker_count")):this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.STICKER,params:{model:e}})},addPollWidget:function(){if(this._richPostModel.getPollCount()>=Z.CONSTANTS.MAX_ATTACH_COUNT)alert(IM("editor.limitation.attach_count",{count:Z.CONSTANTS.MAX_ATTACH_COUNT}));else{var e=H.createPollV2ByJSON({}),t=z.openLayer(e,this._richPostModel.getBandNo());this.listenTo(t,re.EVENT.ATTACH,(function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.POLL_V2,params:{model:e}})}))}},addLocationWidget:function(){Y.asyncOpenDSelectLocationLayer().then(i.bind((function(e){this.listenTo(e,"locationSelected",(function(t){e.destroy(),this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.LOCATION,params:{model:H.createLocation(t)}})}))}),this))},addTodoWidget:function(){if(this._richPostModel.getTodoCount()>=X.CONSTANTS.MAX_ATTACH_COUNT)alert(IM("editor.limitation.attach_count",{count:X.CONSTANTS.MAX_ATTACH_COUNT}));else{var e=H.createTodoV2ByJSON({}),t=G.openLayer(e,this._richPostModel.getBandNo());this.listenTo(t,re.EVENT.ATTACH,(function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.TODO_V2,params:{model:e}})}))}},addSignupWidget:function(){if(this._richPostModel.getSignupCount()>=te.SIGNUP_MAX_ATTACH_COUNT)alert(IM("editor.limitation.attach_count",{count:te.SIGNUP_MAX_ATTACH_COUNT}));else{var e=j.openAsLayer(H.createSignup(),this._richPostModel);this.listenTo(e,j.EVENT.ATTACH,(function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.SIGNUP,params:{model:e}})}))}},addBillSplitWidget:function(){if(this._richPostModel.hasBillSplit())alert(IM("editor.limitation.exist_bill_split"));else{var e=H.createBillSplitByJSON({}),t=W.openLayer(this._richPostModel.getBandNo(),e);this.listenTo(t,re.EVENT.ATTACH,(function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.BILL_SPLIT,params:{model:e}})}))}},addAttendanceCheckWidget:function(){if(this._richPostModel.checkAttendanceCheckMaxAddCount(te.ATTENDANCE_MAX_ADD_COUNT))alert(IM("editor.limitation.attendance_check",{max:te.ATTENDANCE_MAX_ADD_COUNT}));else{var e=this._bandData.getMembershipMemberProfile(),t=H.createAttendanceCheck({managers:[{bandNo:this._bandData.getBandCore().bandNo,userNo:oe.getUserData().getUserNo(),name:e.name,profileImageUrl:e.profileImageUrl,memberType:e.memberType}],managerCount:1}),n=K.openLayer(this._richPostModel.getBandNo(),t);this.listenTo(n,re.EVENT.ATTACH,(function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.ATTENDANCE_CHECK,params:{model:e}})}))}},addScheduleWidget:function(){if(this._richPostModel.getScheduleGroupCount()>=te.SCHEDULE_GROUP_MAX_COUNT)alert(IM("editor.limitation.attach_count",{count:te.SCHEDULE_GROUP_MAX_COUNT}));else{var e=se.startCreatingScheduleGroup({bandData:this._bandData});this.listenTo(e,re.EVENT.ATTACH,(function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP,params:{model:e}})}))}},addPhotoWidget:function(e){var n=new t.Deferred,i=this;return this.editor.widgets.once("instanceCreated",(function(e){var t=e.data;t.once("ready",(function(){t.view.once(re.EVENT.WIDGET_MEDIA_LOADED,(function(){i.trigger(re.EVENT.WIDGET_MEDIA_LOADED),n.resolve()}))}))})),this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.PHOTO,params:{model:e}}),n.promise()},addVideoWidget:function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.VIDEO,params:{model:e}})},addFileWidget:function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.FILE,params:{model:e}})},addMarkdown:function(){if(this._richPostModel.getAddonCount()>=te.ADDON_MAX_COUNT)alert(IM("editor.limitation.attach_count",{count:te.ADDON_MAX_COUNT}));else{var e=Q.openAddonAttachLayer(this._allowedAddonCollection.findAllowedAddonModelByType(ie.MARKDOWN),!1,this._richPostModel.getBandNo(),null,null,null);this.listenTo(e,Q.EVENT.ADDON_SUBMIT,(function(e){this.editor.execCommand("addBandWidget",{type:"addon",params:{model:e}})}))}},addQuizWidget:function(){if(this._richPostModel.getAttachment(te.POST_ATTACHMENT_TYPE.QUIZ).length()>=te.QUIZ_MAX_ADD_COUNT)alert(IM("editor.limitation.quiz",{max:te.QUIZ_MAX_ADD_COUNT}));else{var e=H.createRichQuizModelByJSON();$.setModelsDefaultTakers([e],this._bandData).then(i.bind((function(){var t=q.openLayer(e,this._bandData);this.listenTo(t,re.EVENT.ATTACH,(function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.QUIZ,params:{model:e}})}))}),this))}},addSurveyWidget:function(){if(this._richPostModel.getAttachment(te.POST_ATTACHMENT_TYPE.SURVEY).length()>=te.SURVEY_MAX_ADD_COUNT)alert(IM("editor.limitation.survey",{max:te.SURVEY_MAX_ADD_COUNT}));else{var e=H.createRichSurveyModelByJSON();ee.setModelsDefaultManagers([e],this._bandData).then(i.bind((function(){var t=J.openLayer(e,this._bandData);this.listenTo(t,re.EVENT.ATTACH,(function(e){this.editor.execCommand("addBandWidget",{type:te.POST_ATTACHMENT_TYPE.SURVEY,params:{model:e}})}))}),this))}},hasContent:function(){var e=this.editor.element;return!e.hasClass("placeholder")&&(!!e.findOne("input, band\\:attachment")||!e.findOne("."+F.PLACE_HOLDER_CLASS)&&/[^\s\u200b]/.test(e.getText()))},getContent:function(){return ne.convertToText(this.getData())},onDestroy:function(){this.isEditorDestroyed=!0,this.editor.destroy()},getData:function(){return this.editor.getData()},insertElement:function(e){this.editor.insertElement(e)},getElement:function(){return this.editor.element},_runChangedTrigger:function(e){this.trigger(le.CHANGE,e&&e.data||null)},_initEditor:function(e,n,o,H){if(!this.isEditorDestroyed){this._bandData=H;var z=this;s.config.startupFocus=!0,s.once("instanceCreated",i.bind((function(e){var H=e.editor;z.editor=H,H.on("pluginsLoaded",i.bind((function(){w(H,n),a(H,n),r(H,n),l(H,n),c(H,n),d(H,n),u(H,n),_(H,n,this._allowedAddonCollection),g(H,n),f(H,n),E(H,n,this._bandData.canSelectAlbumWhenUploadMedia()),T(H,n,this._bandData.canSelectAlbumWhenUploadMedia()&&this._editMode===F.EDIT_MODE.NEW),C(H,n,this._bandData.canSelectAlbumWhenUploadMedia()&&this._editMode===F.EDIT_MODE.NEW),y(H,n),M(H,n),I(H,n),b(H,n,z._editMode,this._bandData),v(H,n),A(H,n),S(H,n.get("band").bandNo,o),D(H),V(H),L(H,n),h(H,n),m(H,n),p(H,n),O(H,n),P(H,n,this._bandData,this.options.isPostToMultipleBand),x(H,n,this._bandData),z.autoCompleteBandHashtags=U(H,n,this.options.isUsePostPinnedHashtag),z._editMode==F.EDIT_MODE.MODIFY||n.get("content")||N(H)}),this)),H.on("instanceReady",(function(){z._editMode===F.EDIT_MODE.MODIFY&&H.widgets.on("instanceDestroyed",(function(){i.isEmpty(H.widgets.instances)&&t(H.element.$).blur().focus()}));var e=H.createRange();e.moveToPosition(new s.dom.node(i.last(e.root.$.children)),s.POSITION_BEFORE_END),H.getSelection().selectRanges([e])})),H.on("contentDom",(function(){document.execCommand("AutoUrlDetect",!1,!1),R(H),k(H),B(H),H._band={$scrollContainer:t(H.element.$).parent()},z.trigger("editor:initialized")})),H.on("key",(function(e){function n(e){var t={LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT_LEFT:s.SHIFT+37,SHIFT_UP:s.SHIFT+38,SHIFT_RIGHT:s.SHIFT+39,SHIFT_DOWN:s.SHIFT+40,REFRESH:s.CTRL+"R".charCodeAt()};return!i.contains(t,e)}var o=e.data.keyCode;if(9===o)return e.stop(),!0;if(n(o))for(var a=e.sender.getSelection().getRanges()[0].cloneContents().$.children||[],r=0;r<a.length;r++){var l=t(a[r]);if(l.hasClass("cke_widget_wrapper"))if(l.find("._disable_remove").length>0)return console.log("cannot delete widget"),!1}return s.env.ie&&n(o)&&z._runChangedTrigger(),!0})),H.on("change",(function(){i.defer((function(){H.widgets.fire("checkWidgets")})),z._runChangedTrigger()})),H.on(re.EVENT.WIDGET_ADDED_HASHTAG,(function(){z._runChangedTrigger()})),H.on(re.EVENT.WIDGET_CHANGED,(function(e){z._runChangedTrigger(e)}))}),this)),s.disableAutoInline=!0,t(e).addClass(this._bandData.getBandCore().getSkinColorClass());var W={skin:"band_skin",plugins:"dialogui,dialog,clipboard,enterkey,confighelper,undo,magicline,lineutils,widget,button,toolbar,sharedspace,basicstyles,font,colorbutton",sharedSpaces:{top:"postWriteToolbar"},toolbar:[["FontSize","Bold","Italic","Underline","Strike","TextColor"]],coreStyles_bold:{element:"b",overrides:"strong"},coreStyles_italic:{element:"i",overrides:"em"},coreStyles_underline:{element:"u"},coreStyles_strike:{element:"del",overrides:"strike"},customConfig:"",forcePasteAsPlainText:!0,forceEnterMode:!0,shiftEnterMode:!1,title:!1,allowedContent:["p b i u del ul li"].concat(ae.getEditorTagRules()).join("; "),band_dataSkin:this._bandData.getBandCore().getSkinColorClass(),placeholder:ne.makePlaceholderByBandOpenType(F.isNewOrModifyMode(this._editMode)&&this._bandData.isShowMessagePublicBandContentAccessByAnyone()),defaultLanguage:window.formatjsLang,contentsCss:[window.resBaseUrl+"/css/ckEditorPanel.css?_="+window.resVersion],fontSize_sizes:ae.getEditorFontSizes(),fontSize_defaultLabel:IM("editor.font_size.default"),fontSize_style:ae.getEditorFontSizeStyle(),colorButton_colors:ae.getEditorFontColors(),colorButton_automaticButtonColor:"222222",colorButton_foreStyle:ae.getEditorFontColorStyle()};s.inline(e,W)}}});return ce.EVENT=le,ce}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){e.exports=n(2160)},function(e,t){var n,i,o,s,a,r,l,c,d;window.CKEDITOR&&window.CKEDITOR.dom||(window.CKEDITOR||(window.CKEDITOR=function(){var e=/(^|.*[\\\/])ckeditor\.js(?:\?.*|;.*)?$/i,t={timestamp:"G4CD",version:"4.5.9",revision:"a35abfe",rnd:Math.floor(900*Math.random())+100,_:{pending:[],basePathSrcPattern:e},status:"unloaded",basePath:function(){var t=window.CKEDITOR_BASEPATH||"";if(!t)for(var n=document.getElementsByTagName("script"),i=0;i<n.length;i++){var o=n[i].src.match(e);if(o){t=o[1];break}}if(-1==t.indexOf(":/")&&"//"!=t.slice(0,2)&&(t=0===t.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+t:location.href.match(/^[^\?]*\/(?:)/)[0]+t),!t)throw'The CKEditor installation path could not be automatically detected. Please set the global variable "CKEDITOR_BASEPATH" before creating editor instances.';return t}(),getUrl:function(e){return-1==e.indexOf(":/")&&0!==e.indexOf("/")&&(e=this.basePath+e),this.timestamp&&"/"!=e.charAt(e.length-1)&&!/[&?]t=/.test(e)&&(e+=(0<=e.indexOf("?")?"&":"?")+"t="+this.timestamp),e},domReady:function(){function e(){try{document.addEventListener?(document.removeEventListener("DOMContentLoaded",e,!1),t()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",e),t())}catch(e){}}function t(){for(var e;e=n.shift();)e()}var n=[];return function(t){if(n.push(t),"complete"===document.readyState&&setTimeout(e,1),1==n.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",e),window.attachEvent("onload",e),t=!1;try{t=!window.frameElement}catch(e){}document.documentElement.doScroll&&t&&function t(){try{document.documentElement.doScroll("left")}catch(e){return void setTimeout(t,1)}e()}()}}}()},n=window.CKEDITOR_GETURL;if(n){var i=t.getUrl;t.getUrl=function(e){return n.call(t,e)||i.call(t,e)}}return t}()),CKEDITOR.event||(CKEDITOR.event=function(){},CKEDITOR.event.implementOn=function(e){var t,n=CKEDITOR.event.prototype;for(t in n)null==e[t]&&(e[t]=n[t])},CKEDITOR.event.prototype=function(){function e(e){var i=t(this);return i[e]||(i[e]=new n(e))}var t=function(e){return(e=e.getPrivate&&e.getPrivate()||e._||(e._={})).events||(e.events={})},n=function(e){this.name=e,this.listeners=[]};return n.prototype={getListenerIndex:function(e){for(var t=0,n=this.listeners;t<n.length;t++)if(n[t].fn==e)return t;return-1}},{define:function(t,n){var i=e.call(this,t);CKEDITOR.tools.extend(i,n,!0)},on:function(t,n,i,o,s){function a(e,s,a,l){return e={name:t,sender:this,editor:e,data:s,listenerData:o,stop:a,cancel:l,removeListener:r},!1!==n.call(i,e)&&e.data}function r(){c.removeListener(t,n)}var l=e.call(this,t);if(0>l.getListenerIndex(n)){l=l.listeners,i||(i=this),isNaN(s)&&(s=10);var c=this;a.fn=n,a.priority=s;for(var d=l.length-1;0<=d;d--)if(l[d].priority<=s)return l.splice(d+1,0,a),{removeListener:r};l.unshift(a)}return{removeListener:r}},once:function(){var e=Array.prototype.slice.call(arguments),t=e[1];return e[1]=function(e){return e.removeListener(),t.apply(this,arguments)},this.on.apply(this,e)},capture:function(){CKEDITOR.event.useCapture=1;var e=this.on.apply(this,arguments);return CKEDITOR.event.useCapture=0,e},fire:function(){var e=0,n=function(){e=1},i=0,o=function(){i=1};return function(s,a,r){var l=t(this)[s];s=e;var c=i;if(e=i=0,l&&(u=l.listeners).length)for(var d,u=u.slice(0),h=0;h<u.length;h++){if(l.errorProof)try{d=u[h].call(this,r,a,n,o)}catch(e){}else d=u[h].call(this,r,a,n,o);if(!1===d?i=1:void 0!==d&&(a=d),e||i)break}return a=!i&&(void 0===a||a),e=s,i=c,a}}(),fireOnce:function(e,n,i){return n=this.fire(e,n,i),delete t(this)[e],n},removeListener:function(e,n){var i=t(this)[e];if(i){var o=i.getListenerIndex(n);0<=o&&i.listeners.splice(o,1)}},removeAllListeners:function(){var e,n=t(this);for(e in n)delete n[e]},hasListeners:function(e){return(e=t(this)[e])&&0<e.listeners.length}}}()),CKEDITOR.editor||(CKEDITOR.editor=function(){CKEDITOR._.pending.push([this,arguments]),CKEDITOR.event.call(this)},CKEDITOR.editor.prototype.fire=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fire.call(this,e,t,this)},CKEDITOR.editor.prototype.fireOnce=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fireOnce.call(this,e,t,this)},CKEDITOR.event.implementOn(CKEDITOR.editor.prototype)),CKEDITOR.env||(CKEDITOR.env=function(){var e=navigator.userAgent.toLowerCase(),t=e.match(/edge[ \/](\d+.?\d*)/),n=-1<e.indexOf("trident/");(n={ie:n=!(!t&&!n),edge:!!t,webkit:!n&&-1<e.indexOf(" applewebkit/"),air:-1<e.indexOf(" adobeair/"),mac:-1<e.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode&&(!document.documentMode||10>document.documentMode),mobile:-1<e.indexOf("mobile"),iOS:/(ipad|iphone|ipod)/.test(e),isCustomDomain:function(){if(!this.ie)return!1;var e=document.domain,t=window.location.hostname;return e!=t&&e!="["+t+"]"},secure:"https:"==location.protocol}).gecko="Gecko"==navigator.product&&!n.webkit&&!n.ie,n.webkit&&(-1<e.indexOf("chrome")?n.chrome=!0:n.safari=!0);var i=0;return n.ie&&(i=t?parseFloat(t[1]):n.quirks||!document.documentMode?parseFloat(e.match(/msie (\d+)/)[1]):document.documentMode,n.ie9Compat=9==i,n.ie8Compat=8==i,n.ie7Compat=7==i,n.ie6Compat=7>i||n.quirks),n.gecko&&(t=e.match(/rv:([\d\.]+)/))&&(i=1e4*(t=t[1].split("."))[0]+100*(t[1]||0)+1*(t[2]||0)),n.air&&(i=parseFloat(e.match(/ adobeair\/(\d+)/)[1])),n.webkit&&(i=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=i,n.isCompatible=!(n.ie&&7>i||n.gecko&&4e4>i||n.webkit&&534>i),n.hidpi=2<=window.devicePixelRatio,n.needsBrFiller=n.gecko||n.webkit||n.ie&&10<i,n.needsNbspFiller=n.ie&&11>i,n.cssClass="cke_browser_"+(n.ie?"ie":n.gecko?"gecko":n.webkit?"webkit":"unknown"),n.quirks&&(n.cssClass+=" cke_browser_quirks"),n.ie&&(n.cssClass+=" cke_browser_ie"+(n.quirks?"6 cke_browser_iequirks":n.version)),n.air&&(n.cssClass+=" cke_browser_air"),n.iOS&&(n.cssClass+=" cke_browser_ios"),n.hidpi&&(n.cssClass+=" cke_hidpi"),n}()),"unloaded"==CKEDITOR.status&&(CKEDITOR.event.implementOn(CKEDITOR),CKEDITOR.loadFullCore=function(){if("basic_ready"!=CKEDITOR.status)CKEDITOR.loadFullCore._load=1;else{delete CKEDITOR.loadFullCore;var e=document.createElement("script");e.type="text/javascript",e.src=CKEDITOR.basePath+"ckeditor.js",document.getElementsByTagName("head")[0].appendChild(e)}},CKEDITOR.loadFullCoreTimeout=0,CKEDITOR.add=function(e){(this._.pending||(this._.pending=[])).push(e)},CKEDITOR.domReady((function(){var e=CKEDITOR.loadFullCore,t=CKEDITOR.loadFullCoreTimeout;e&&(CKEDITOR.status="basic_ready",e&&e._load?e():t&&setTimeout((function(){CKEDITOR.loadFullCore&&CKEDITOR.loadFullCore()}),1e3*t))})),CKEDITOR.status="basic_loaded"),CKEDITOR.VERBOSITY_WARN=1,CKEDITOR.VERBOSITY_ERROR=2,CKEDITOR.verbosity=CKEDITOR.VERBOSITY_WARN|CKEDITOR.VERBOSITY_ERROR,CKEDITOR.warn=function(e,t){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_WARN&&CKEDITOR.fire("log",{type:"warn",errorCode:e,additionalData:t})},CKEDITOR.error=function(e,t){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_ERROR&&CKEDITOR.fire("log",{type:"error",errorCode:e,additionalData:t})},CKEDITOR.on("log",(function(e){if(window.console&&window.console.log){var t=console[e.data.type]?e.data.type:"log",n=e.data.errorCode;(e=e.data.additionalData)?console[t]("[CKEDITOR] Error code: "+n+".",e):console[t]("[CKEDITOR] Error code: "+n+"."),console[t]("[CKEDITOR] For more information about this error go to http://docs.ckeditor.com/#!/guide/dev_errors-section-"+n)}}),null,null,999),CKEDITOR.dom={},n=[],i=CKEDITOR.env.gecko?"-moz-":CKEDITOR.env.webkit?"-webkit-":CKEDITOR.env.ie?"-ms-":"",o=/&/g,s=/>/g,a=/</g,r=/"/g,l=/&(lt|gt|amp|quot|nbsp|shy|#\d{1,5});/g,c={lt:"<",gt:">",amp:"&",quot:'"',nbsp:" ",shy:"­"},d=function(e,t){return"#"==t[0]?String.fromCharCode(parseInt(t.slice(1),10)):c[t]},CKEDITOR.on("reset",(function(){n=[]})),CKEDITOR.tools={arrayCompare:function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0},getIndex:function(e,t){for(var n=0;n<e.length;++n)if(t(e[n]))return n;return-1},clone:function(e){var t;if(e&&e instanceof Array){t=[];for(var n=0;n<e.length;n++)t[n]=CKEDITOR.tools.clone(e[n]);return t}if(null===e||"object"!=typeof e||e instanceof String||e instanceof Number||e instanceof Boolean||e instanceof Date||e instanceof RegExp||e.nodeType||e.window===e)return e;for(n in t=new e.constructor,e)t[n]=CKEDITOR.tools.clone(e[n]);return t},capitalize:function(e,t){return e.charAt(0).toUpperCase()+(t?e.slice(1):e.slice(1).toLowerCase())},extend:function(e){var t,n,i=arguments.length;"boolean"==typeof(t=arguments[i-1])?i--:"boolean"==typeof(t=arguments[i-2])&&(n=arguments[i-1],i-=2);for(var o=1;o<i;o++){var s,a=arguments[o];for(s in a)!0!==t&&null!=e[s]||n&&!(s in n)||(e[s]=a[s])}return e},prototypedCopy:function(e){var t=function(){};return t.prototype=e,new t},copy:function(e){var t,n={};for(t in e)n[t]=e[t];return n},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},cssVendorPrefix:function(e,t,n){return n?i+e+":"+t+";"+e+":"+t:((n={})[e]=t,n[i+e]=t,n)},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t=void 0!==e.cssFloat?"cssFloat":void 0!==e.styleFloat?"styleFloat":"float";return function(e){return"float"==e?t:e.replace(/-./g,(function(e){return e.substr(1).toUpperCase()}))}}(),buildStyleHtml:function(e){e=[].concat(e);for(var t,n=[],i=0;i<e.length;i++)(t=e[i])&&(/@import|[{}]/.test(t)?n.push("<style>"+t+"</style>"):n.push('<link type="text/css" rel=stylesheet href="'+t+'">'));return n.join("")},htmlEncode:function(e){return null==e?"":String(e).replace(o,"&amp;").replace(s,"&gt;").replace(a,"&lt;")},htmlDecode:function(e){return e.replace(l,d)},htmlEncodeAttr:function(e){return CKEDITOR.tools.htmlEncode(e).replace(r,"&quot;")},htmlDecodeAttr:function(e){return CKEDITOR.tools.htmlDecode(e)},transformPlainTextToHtml:function(e,t){var n=t==CKEDITOR.ENTER_BR,i=(i=this.htmlEncode(e.replace(/\r\n/g,"\n"))).replace(/\t/g,"&nbsp;&nbsp; &nbsp;"),o=t==CKEDITOR.ENTER_P?"p":"div";if(!n){var s=/\n{2}/g;if(s.test(i)){var a="<"+o+">",r="</"+o+">";i=a+i.replace(s,(function(){return r+a}))+r}}return i=i.replace(/\n/g,"<br>"),n||(i=i.replace(new RegExp("<br>(?=</"+o+">)"),(function(e){return CKEDITOR.tools.repeat(e,2)}))),(i=i.replace(/^ | $/g,"&nbsp;")).replace(/(>|\s) /g,(function(e,t){return t+"&nbsp;"})).replace(/ (?=<)/g,"&nbsp;")},getNextNumber:function(){var e=0;return function(){return++e}}(),getNextId:function(){return"cke_"+this.getNextNumber()},getUniqueId:function(){for(var e="e",t=0;8>t;t++)e+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e},override:function(e,t){var n=t(e);return n.prototype=e.prototype,n},setTimeout:function(e,t,n,i,o){return o||(o=window),n||(n=o),o.setTimeout((function(){i?e.apply(n,[].concat(i)):e.apply(n)}),t||0)},trim:function(){var e=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(t){return t.replace(e,"")}}(),ltrim:function(){var e=/^[ \t\n\r]+/g;return function(t){return t.replace(e,"")}}(),rtrim:function(){var e=/[ \t\n\r]+$/g;return function(t){return t.replace(e,"")}}(),indexOf:function(e,t){if("function"==typeof t){for(var n=0,i=e.length;n<i;n++)if(t(e[n]))return n}else{if(e.indexOf)return e.indexOf(t);for(n=0,i=e.length;n<i;n++)if(e[n]===t)return n}return-1},search:function(e,t){var n=CKEDITOR.tools.indexOf(e,t);return 0<=n?e[n]:null},bind:function(e,t){return function(){return e.apply(t,arguments)}},createClass:function(e){var t=e.$,n=e.base,i=e.privates||e._,o=e.proto;if(e=e.statics,!t&&(t=function(){n&&this.base.apply(this,arguments)}),i){var s=t;t=function(){var e,t=this._||(this._={});for(e in i){var n=i[e];t[e]="function"==typeof n?CKEDITOR.tools.bind(n,this):n}s.apply(this,arguments)}}return n&&(t.prototype=this.prototypedCopy(n.prototype),t.prototype.constructor=t,t.base=n,t.baseProto=n.prototype,t.prototype.base=function(){this.base=n.prototype.base,n.apply(this,arguments),this.base=arguments.callee}),o&&this.extend(t.prototype,o,!0),e&&this.extend(t,e,!0),t},addFunction:function(e,t){return n.push((function(){return e.apply(t||this,arguments)}))-1},removeFunction:function(e){n[e]=null},callFunction:function(e){var t=n[e];return t&&t.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:function(){var e,t=/^-?\d+\.?\d*px$/;return function(n){return e=CKEDITOR.tools.trim(n+"")+"px",t.test(e)?e:n||""}}(),convertToPx:function(){var e;return function(t){return e||(e=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>',CKEDITOR.document),CKEDITOR.document.getBody().append(e)),/%$/.test(t)?t:(e.setStyle("width",t),e.$.clientWidth)}}(),repeat:function(e,t){return Array(t+1).join(e)},tryThese:function(){for(var e,t=0,n=arguments.length;t<n;t++){var i=arguments[t];try{e=i();break}catch(e){}}return e},genKey:function(){return Array.prototype.slice.call(arguments).join("-")},defer:function(e){return function(){var t=arguments,n=this;window.setTimeout((function(){e.apply(n,t)}),0)}},normalizeCssText:function(e,t){var n,i=[],o=CKEDITOR.tools.parseCssText(e,!0,t);for(n in o)i.push(n+":"+o[n]);return i.sort(),i.length?i.join(";")+";":""},convertRgbToHex:function(e){return e.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,(function(e,t,n,i){for(e=[t,n,i],t=0;3>t;t++)e[t]=("0"+parseInt(e[t],10).toString(16)).slice(-2);return"#"+e.join("")}))},parseCssText:function(e,t,n){var i={};return n&&((n=new CKEDITOR.dom.element("span")).setAttribute("style",e),e=CKEDITOR.tools.convertRgbToHex(n.getAttribute("style")||"")),e&&";"!=e?(e.replace(/&quot;/g,'"').replace(/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,(function(e,n,o){t&&("font-family"==(n=n.toLowerCase())&&(o=o.toLowerCase().replace(/["']/g,"").replace(/\s*,\s*/g,",")),o=CKEDITOR.tools.trim(o)),i[n]=o})),i):i},writeCssText:function(e,t){var n,i=[];for(n in e)i.push(n+":"+e[n]);return t&&i.sort(),i.join("; ")},objectCompare:function(e,t,n){var i;if(!e&&!t)return!0;if(!e||!t)return!1;for(i in e)if(e[i]!=t[i])return!1;if(!n)for(i in t)if(e[i]!=t[i])return!1;return!0},objectKeys:function(e){var t,n=[];for(t in e)n.push(t);return n},convertArrayToObject:function(e,t){var n={};1==arguments.length&&(t=!0);for(var i=0,o=e.length;i<o;++i)n[e[i]]=t;return n},fixDomain:function(){for(var e;;)try{e=window.parent.document.domain;break}catch(t){if(!(e=e?e.replace(/.+?(?:\.|$)/,""):document.domain))break;document.domain=e}return!!e},eventsBuffer:function(e,t,n){function i(){s=(new Date).getTime(),o=!1,n?t.call(n):t()}var o,s=0;return{input:function(){if(!o){var t=(new Date).getTime()-s;t<e?o=setTimeout(i,e-t):i()}},reset:function(){o&&clearTimeout(o),o=s=0}}},enableHtml5Elements:function(e,t){for(var n,i="abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup main mark meter nav output progress section summary time video".split(" "),o=i.length;o--;)n=e.createElement(i[o]),t&&e.appendChild(n)},checkIfAnyArrayItemMatches:function(e,t){for(var n=0,i=e.length;n<i;++n)if(e[n].match(t))return!0;return!1},checkIfAnyObjectPropertyMatches:function(e,t){for(var n in e)if(n.match(t))return!0;return!1},transparentImageData:"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==",getCookie:function(e){e=e.toLowerCase();for(var t,n=document.cookie.split(";"),i=0;i<n.length;i++)if(t=n[i].split("="),decodeURIComponent(CKEDITOR.tools.trim(t[0]).toLowerCase())===e)return decodeURIComponent(1<t.length?t[1]:"");return null},setCookie:function(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/"},getCsrfToken:function(){if(!(e=CKEDITOR.tools.getCookie("ckCsrfToken"))||40!=e.length){var e=[],t="";if(window.crypto&&window.crypto.getRandomValues)e=new Uint8Array(40),window.crypto.getRandomValues(e);else for(var n=0;40>n;n++)e.push(Math.floor(256*Math.random()));for(n=0;n<e.length;n++){var i="abcdefghijklmnopqrstuvwxyz0123456789".charAt(e[n]%36);t+=.5<Math.random()?i.toUpperCase():i}e=t,CKEDITOR.tools.setCookie("ckCsrfToken",e)}return e}},CKEDITOR.dtd=function(){var e=CKEDITOR.tools.extend,t=function(e,t){for(var n=CKEDITOR.tools.clone(e),i=1;i<arguments.length;i++)for(var o in t=arguments[i])delete n[o];return n},n={},i={},o={address:1,article:1,aside:1,blockquote:1,details:1,div:1,dl:1,fieldset:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,menu:1,nav:1,ol:1,p:1,pre:1,section:1,table:1,ul:1},s={command:1,link:1,meta:1,noscript:1,script:1,style:1},a={},r={"#":1},l={center:1,dir:1,noframes:1};return e(n,{a:1,abbr:1,area:1,audio:1,b:1,bdi:1,bdo:1,br:1,button:1,canvas:1,cite:1,code:1,command:1,datalist:1,del:1,dfn:1,em:1,embed:1,i:1,iframe:1,img:1,input:1,ins:1,kbd:1,keygen:1,label:1,map:1,mark:1,meter:1,noscript:1,object:1,output:1,progress:1,q:1,ruby:1,s:1,samp:1,script:1,select:1,small:1,span:1,strong:1,sub:1,sup:1,textarea:1,time:1,u:1,var:1,video:1,wbr:1},r,{acronym:1,applet:1,basefont:1,big:1,font:1,isindex:1,strike:1,style:1,tt:1}),e(i,o,n,l),t={a:t(n,{a:1,button:1}),abbr:n,address:i,area:a,article:i,aside:i,audio:e({source:1,track:1},i),b:n,base:a,bdi:n,bdo:n,blockquote:i,body:i,br:a,button:t(n,{a:1,button:1}),canvas:n,caption:i,cite:n,code:n,col:a,colgroup:{col:1},command:a,datalist:e({option:1},n),dd:i,del:n,details:e({summary:1},i),dfn:n,div:i,dl:{dt:1,dd:1},dt:i,em:n,embed:a,fieldset:e({legend:1},i),figcaption:i,figure:e({figcaption:1},i),footer:i,form:i,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,head:e({title:1,base:1},s),header:i,hgroup:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},hr:a,html:e({head:1,body:1},i,s),i:n,iframe:r,img:a,input:a,ins:n,kbd:n,keygen:a,label:n,legend:n,li:i,link:a,main:i,map:i,mark:n,menu:e({li:1},i),meta:a,meter:t(n,{meter:1}),nav:i,noscript:e({link:1,meta:1,style:1},n),object:e({param:1},n),ol:{li:1},optgroup:{option:1},option:r,output:n,p:n,param:a,pre:n,progress:t(n,{progress:1}),q:n,rp:n,rt:n,ruby:e({rp:1,rt:1},n),s:n,samp:n,script:r,section:i,select:{optgroup:1,option:1},small:n,source:a,span:n,strong:n,style:r,sub:n,summary:e({h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},n),sup:n,table:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1},tbody:{tr:1},td:i,textarea:r,tfoot:{tr:1},th:i,thead:{tr:1},time:t(n,{time:1}),title:r,tr:{th:1,td:1},track:a,u:n,ul:{li:1},var:n,video:e({source:1,track:1},i),wbr:a,acronym:n,applet:e({param:1},i),basefont:a,big:n,center:i,dialog:a,dir:{li:1},font:n,isindex:a,noframes:i,strike:n,tt:n},e(t,{$block:e({audio:1,dd:1,dt:1,figcaption:1,li:1,video:1},o,l),$blockLimit:{article:1,aside:1,audio:1,body:1,caption:1,details:1,dir:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,header:1,hgroup:1,main:1,menu:1,nav:1,ol:1,section:1,table:1,td:1,th:1,tr:1,ul:1,video:1},$cdata:{script:1,style:1},$editable:{address:1,article:1,aside:1,blockquote:1,body:1,details:1,div:1,fieldset:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,main:1,nav:1,p:1,pre:1,section:1},$empty:{area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},$inline:n,$list:{dl:1,ol:1,ul:1},$listItem:{dd:1,dt:1,li:1},$nonBodyContent:e({body:1,head:1,html:1},t.head),$nonEditable:{applet:1,audio:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,param:1,script:1,textarea:1,video:1},$object:{applet:1,audio:1,button:1,hr:1,iframe:1,img:1,input:1,object:1,select:1,table:1,textarea:1,video:1},$removeEmpty:{abbr:1,acronym:1,b:1,bdi:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,mark:1,meter:1,output:1,q:1,ruby:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,time:1,tt:1,u:1,var:1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},$transparent:{a:1,audio:1,canvas:1,del:1,ins:1,map:1,noscript:1,object:1,video:1},$intermediate:{caption:1,colgroup:1,dd:1,dt:1,figcaption:1,legend:1,li:1,optgroup:1,option:1,rp:1,rt:1,summary:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}}),t}(),CKEDITOR.dom.event=function(e){this.$=e},CKEDITOR.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},getKeystroke:function(){var e=this.getKey();return(this.$.ctrlKey||this.$.metaKey)&&(e+=CKEDITOR.CTRL),this.$.shiftKey&&(e+=CKEDITOR.SHIFT),this.$.altKey&&(e+=CKEDITOR.ALT),e},preventDefault:function(e){var t=this.$;t.preventDefault?t.preventDefault():t.returnValue=!1,e&&this.stopPropagation()},stopPropagation:function(){var e=this.$;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},getTarget:function(){var e=this.$.target||this.$.srcElement;return e?new CKEDITOR.dom.node(e):null},getPhase:function(){return this.$.eventPhase||2},getPageOffset:function(){var e=this.getTarget().getDocument().$;return{x:this.$.pageX||this.$.clientX+(e.documentElement.scrollLeft||e.body.scrollLeft),y:this.$.pageY||this.$.clientY+(e.documentElement.scrollTop||e.body.scrollTop)}}},CKEDITOR.CTRL=1114112,CKEDITOR.SHIFT=2228224,CKEDITOR.ALT=4456448,CKEDITOR.EVENT_PHASE_CAPTURING=1,CKEDITOR.EVENT_PHASE_AT_TARGET=2,CKEDITOR.EVENT_PHASE_BUBBLING=3,CKEDITOR.dom.domObject=function(e){e&&(this.$=e)},CKEDITOR.dom.domObject.prototype=function(){var e=function(e,t){return function(n){"undefined"!=typeof CKEDITOR&&e.fire(t,new CKEDITOR.dom.event(n))}};return{getPrivate:function(){var e;return(e=this.getCustomData("_"))||this.setCustomData("_",e={}),e},on:function(t){var n=this.getCustomData("_cke_nativeListeners");return n||(n={},this.setCustomData("_cke_nativeListeners",n)),n[t]||(n=n[t]=e(this,t),this.$.addEventListener?this.$.addEventListener(t,n,!!CKEDITOR.event.useCapture):this.$.attachEvent&&this.$.attachEvent("on"+t,n)),CKEDITOR.event.prototype.on.apply(this,arguments)},removeListener:function(e){if(CKEDITOR.event.prototype.removeListener.apply(this,arguments),!this.hasListeners(e)){var t=this.getCustomData("_cke_nativeListeners"),n=t&&t[e];n&&(this.$.removeEventListener?this.$.removeEventListener(e,n,!1):this.$.detachEvent&&this.$.detachEvent("on"+e,n),delete t[e])}},removeAllListeners:function(){var e,t=this.getCustomData("_cke_nativeListeners");for(e in t){var n=t[e];this.$.detachEvent?this.$.detachEvent("on"+e,n):this.$.removeEventListener&&this.$.removeEventListener(e,n,!1),delete t[e]}CKEDITOR.event.prototype.removeAllListeners.call(this)}}}(),function(e){var t={};CKEDITOR.on("reset",(function(){t={}})),e.equals=function(e){try{return e&&e.$===this.$}catch(e){return!1}},e.setCustomData=function(e,n){var i=this.getUniqueId();return(t[i]||(t[i]={}))[e]=n,this},e.getCustomData=function(e){var n=this.$["data-cke-expando"];return(n=n&&t[n])&&e in n?n[e]:null},e.removeCustomData=function(e){var n,i,o;return(n=(n=this.$["data-cke-expando"])&&t[n])&&(i=n[e],o=e in n,delete n[e]),o?i:null},e.clearCustomData=function(){this.removeAllListeners();var e=this.$["data-cke-expando"];e&&delete t[e]},e.getUniqueId=function(){return this.$["data-cke-expando"]||(this.$["data-cke-expando"]=CKEDITOR.tools.getNextNumber())},CKEDITOR.event.implementOn(e)}(CKEDITOR.dom.domObject.prototype),CKEDITOR.dom.node=function(e){return e?new CKEDITOR.dom[e.nodeType==CKEDITOR.NODE_DOCUMENT?"document":e.nodeType==CKEDITOR.NODE_ELEMENT?"element":e.nodeType==CKEDITOR.NODE_TEXT?"text":e.nodeType==CKEDITOR.NODE_COMMENT?"comment":e.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT?"documentFragment":"domObject"](e):this},CKEDITOR.dom.node.prototype=new CKEDITOR.dom.domObject,CKEDITOR.NODE_ELEMENT=1,CKEDITOR.NODE_DOCUMENT=9,CKEDITOR.NODE_TEXT=3,CKEDITOR.NODE_COMMENT=8,CKEDITOR.NODE_DOCUMENT_FRAGMENT=11,CKEDITOR.POSITION_IDENTICAL=0,CKEDITOR.POSITION_DISCONNECTED=1,CKEDITOR.POSITION_FOLLOWING=2,CKEDITOR.POSITION_PRECEDING=4,CKEDITOR.POSITION_IS_CONTAINED=8,CKEDITOR.POSITION_CONTAINS=16,CKEDITOR.tools.extend(CKEDITOR.dom.node.prototype,{appendTo:function(e,t){return e.append(this,t),e},clone:function(e,t){var n=this.$.cloneNode(e);return function n(i){if(i["data-cke-expando"]&&(i["data-cke-expando"]=!1),(i.nodeType==CKEDITOR.NODE_ELEMENT||i.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&(t||i.nodeType!=CKEDITOR.NODE_ELEMENT||i.removeAttribute("id",!1),e)){i=i.childNodes;for(var o=0;o<i.length;o++)n(i[o])}}(n),n=new CKEDITOR.dom.node(n),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(this.type==CKEDITOR.NODE_ELEMENT||this.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&function t(n){if(n.type==CKEDITOR.NODE_ELEMENT||n.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT){if(n.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var i=n.getName();":"==i[0]&&n.renameNode(i.substring(1))}if(e)for(i=0;i<n.getChildCount();i++)t(n.getChild(i))}}(n),n},hasPrevious:function(){return!!this.$.previousSibling},hasNext:function(){return!!this.$.nextSibling},insertAfter:function(e){return e.$.parentNode.insertBefore(this.$,e.$.nextSibling),e},insertBefore:function(e){return e.$.parentNode.insertBefore(this.$,e.$),e},insertBeforeMe:function(e){return this.$.parentNode.insertBefore(e.$,this.$),e},getAddress:function(e){for(var t=[],n=this.getDocument().$.documentElement,i=this.$;i&&i!=n;){var o=i.parentNode;o&&t.unshift(this.getIndex.call({$:i},e)),i=o}return t},getDocument:function(){return new CKEDITOR.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(e){function t(e,i){var o=i?e.nextSibling:e.previousSibling;return o&&o.nodeType==CKEDITOR.NODE_TEXT?n(o)?t(o,i):o:null}function n(e){return!e.nodeValue||e.nodeValue==CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE}var i,o=this.$,s=-1;if(!this.$.parentNode||e&&o.nodeType==CKEDITOR.NODE_TEXT&&n(o)&&!t(o)&&!t(o,!0))return-1;do{e&&o!=this.$&&o.nodeType==CKEDITOR.NODE_TEXT&&(i||n(o))||(s++,i=o.nodeType==CKEDITOR.NODE_TEXT)}while(o=o.previousSibling);return s},getNextSourceNode:function(e,t,n){if(n&&!n.call){var i=n;n=function(e){return!e.equals(i)}}var o;if(!(e=!e&&this.getFirst&&this.getFirst())){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;e=this.getNext()}for(;!e&&(o=(o||this).getParent());){if(n&&!1===n(o,!0))return null;e=o.getNext()}return!e||n&&!1===n(e)?null:t&&t!=e.type?e.getNextSourceNode(!1,t,n):e},getPreviousSourceNode:function(e,t,n){if(n&&!n.call){var i=n;n=function(e){return!e.equals(i)}}var o;if(!(e=!e&&this.getLast&&this.getLast())){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;e=this.getPrevious()}for(;!e&&(o=(o||this).getParent());){if(n&&!1===n(o,!0))return null;e=o.getPrevious()}return!e||n&&!1===n(e)?null:t&&e.type!=t?e.getPreviousSourceNode(!1,t,n):e},getPrevious:function(e){var t,n=this.$;do{t=(n=n.previousSibling)&&10!=n.nodeType&&new CKEDITOR.dom.node(n)}while(t&&e&&!e(t));return t},getNext:function(e){var t,n=this.$;do{t=(n=n.nextSibling)&&new CKEDITOR.dom.node(n)}while(t&&e&&!e(t));return t},getParent:function(e){var t=this.$.parentNode;return t&&(t.nodeType==CKEDITOR.NODE_ELEMENT||e&&t.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)?new CKEDITOR.dom.node(t):null},getParents:function(e){var t=this,n=[];do{n[e?"push":"unshift"](t)}while(t=t.getParent());return n},getCommonAncestor:function(e){if(e.equals(this))return this;if(e.contains&&e.contains(this))return e;var t=this.contains?this:this.getParent();do{if(t.contains(e))return t}while(t=t.getParent());return null},getPosition:function(e){var t=this.$,n=e.$;if(t.compareDocumentPosition)return t.compareDocumentPosition(n);if(t==n)return CKEDITOR.POSITION_IDENTICAL;if(this.type==CKEDITOR.NODE_ELEMENT&&e.type==CKEDITOR.NODE_ELEMENT){if(t.contains){if(t.contains(n))return CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING;if(n.contains(t))return CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING}if("sourceIndex"in t)return 0>t.sourceIndex||0>n.sourceIndex?CKEDITOR.POSITION_DISCONNECTED:t.sourceIndex<n.sourceIndex?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}t=this.getAddress(),e=e.getAddress(),n=Math.min(t.length,e.length);for(var i=0;i<n;i++)if(t[i]!=e[i])return t[i]<e[i]?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING;return t.length<e.length?CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING},getAscendant:function(e,t){var n,i,o=this.$;for(t||(o=o.parentNode),"function"==typeof e?(i=!0,n=e):(i=!1,n=function(t){return t="string"==typeof t.nodeName?t.nodeName.toLowerCase():"","string"==typeof e?t==e:t in e});o;){if(n(i?new CKEDITOR.dom.node(o):o))return new CKEDITOR.dom.node(o);try{o=o.parentNode}catch(e){o=null}}return null},hasAscendant:function(e,t){var n=this.$;for(t||(n=n.parentNode);n;){if(n.nodeName&&n.nodeName.toLowerCase()==e)return!0;n=n.parentNode}return!1},move:function(e,t){e.append(this.remove(),t)},remove:function(e){var t=this.$,n=t.parentNode;if(n){if(e)for(;e=t.firstChild;)n.insertBefore(t.removeChild(e),t);n.removeChild(t)}return this},replace:function(e){this.insertBefore(e),e.remove()},trim:function(){this.ltrim(),this.rtrim()},ltrim:function(){for(var e;this.getFirst&&(e=this.getFirst());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.ltrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(n-t.length),this.$.removeChild(this.$.firstChild))}break}},rtrim:function(){for(var e;this.getLast&&(e=this.getLast());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.rtrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(t.length),this.$.lastChild.parentNode.removeChild(this.$.lastChild))}break}CKEDITOR.env.needsBrFiller&&(e=this.$.lastChild)&&1==e.type&&"br"==e.nodeName.toLowerCase()&&e.parentNode.removeChild(e)},isReadOnly:function(e){var t=this;if(this.type!=CKEDITOR.NODE_ELEMENT&&(t=this.getParent()),CKEDITOR.env.edge&&t&&t.is("textarea","input")&&(e=!0),!e&&t&&void 0!==t.$.isContentEditable)return!(t.$.isContentEditable||t.data("cke-editable"));for(;t;){if(t.data("cke-editable"))return!1;if(t.hasAttribute("contenteditable"))return"false"==t.getAttribute("contenteditable");t=t.getParent()}return!0}}),CKEDITOR.dom.window=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.window.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.window.prototype,{focus:function(){this.$.focus()},getViewPaneSize:function(){var e=this.$.document,t="CSS1Compat"==e.compatMode;return{width:(t?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(t?e.documentElement.clientHeight:e.body.clientHeight)||0}},getScrollPosition:function(){var e=this.$;return"pageXOffset"in e?{x:e.pageXOffset||0,y:e.pageYOffset||0}:{x:(e=e.document).documentElement.scrollLeft||e.body.scrollLeft||0,y:e.documentElement.scrollTop||e.body.scrollTop||0}},getFrame:function(){var e=this.$.frameElement;return e?new CKEDITOR.dom.element.get(e):null}}),CKEDITOR.dom.document=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.document.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.document.prototype,{type:CKEDITOR.NODE_DOCUMENT,appendStyleSheet:function(e){if(this.$.createStyleSheet)this.$.createStyleSheet(e);else{var t=new CKEDITOR.dom.element("link");t.setAttributes({rel:"stylesheet",type:"text/css",href:e}),this.getHead().append(t)}},appendStyleText:function(e){if(this.$.createStyleSheet){var t=this.$.createStyleSheet("");t.cssText=e}else{var n=new CKEDITOR.dom.element("style",this);n.append(new CKEDITOR.dom.text(e,this)),this.getHead().append(n)}return t||n.$.sheet},createElement:function(e,t){var n=new CKEDITOR.dom.element(e,this);return t&&(t.attributes&&n.setAttributes(t.attributes),t.styles&&n.setStyles(t.styles)),n},createText:function(e){return new CKEDITOR.dom.text(e,this)},focus:function(){this.getWindow().focus()},getActive:function(){var e;try{e=this.$.activeElement}catch(e){return null}return new CKEDITOR.dom.element(e)},getById:function(e){return(e=this.$.getElementById(e))?new CKEDITOR.dom.element(e):null},getByAddress:function(e,t){for(var n=this.$.documentElement,i=0;n&&i<e.length;i++){var o=e[i];if(t)for(var s=-1,a=0;a<n.childNodes.length;a++){var r=n.childNodes[a];if((!0!==t||3!=r.nodeType||!r.previousSibling||3!=r.previousSibling.nodeType)&&++s==o){n=r;break}}else n=n.childNodes[o]}return n?new CKEDITOR.dom.node(n):null},getElementsByTag:function(e,t){return CKEDITOR.env.ie&&8>=document.documentMode||!t||(e=t+":"+e),new CKEDITOR.dom.nodeList(this.$.getElementsByTagName(e))},getHead:function(){var e=this.$.getElementsByTagName("head")[0];return e?new CKEDITOR.dom.element(e):this.getDocumentElement().append(new CKEDITOR.dom.element("head"),!0)},getBody:function(){return new CKEDITOR.dom.element(this.$.body)},getDocumentElement:function(){return new CKEDITOR.dom.element(this.$.documentElement)},getWindow:function(){return new CKEDITOR.dom.window(this.$.parentWindow||this.$.defaultView)},write:function(e){this.$.open("text/html","replace"),CKEDITOR.env.ie&&(e=e.replace(/(?:^\s*<!DOCTYPE[^>]*?>)|^/i,'$&\n<script data-cke-temp="1">('+CKEDITOR.tools.fixDomain+")();<\/script>")),this.$.write(e),this.$.close()},find:function(e){return new CKEDITOR.dom.nodeList(this.$.querySelectorAll(e))},findOne:function(e){return(e=this.$.querySelector(e))?new CKEDITOR.dom.element(e):null},_getHtml5ShivFrag:function(){var e=this.getCustomData("html5ShivFrag");return e||(e=this.$.createDocumentFragment(),CKEDITOR.tools.enableHtml5Elements(e,!0),this.setCustomData("html5ShivFrag",e)),e}}),CKEDITOR.dom.nodeList=function(e){this.$=e},CKEDITOR.dom.nodeList.prototype={count:function(){return this.$.length},getItem:function(e){return 0>e||e>=this.$.length?null:(e=this.$[e])?new CKEDITOR.dom.node(e):null}},CKEDITOR.dom.element=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createElement(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.element.get=function(e){return(e="string"==typeof e?document.getElementById(e)||document.getElementsByName(e)[0]:e)&&(e.$?e:new CKEDITOR.dom.element(e))},CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node,CKEDITOR.dom.element.createFromHtml=function(e,t){var n=new CKEDITOR.dom.element("div",t);return n.setHtml(e),n.getFirst().remove()},CKEDITOR.dom.element.setMarker=function(e,t,n,i){var o=t.getCustomData("list_marker_id")||t.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id"),s=t.getCustomData("list_marker_names")||t.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");return e[o]=t,s[n]=1,t.setCustomData(n,i)},CKEDITOR.dom.element.clearAllMarkers=function(e){for(var t in e)CKEDITOR.dom.element.clearMarkers(e,e[t],1)},CKEDITOR.dom.element.clearMarkers=function(e,t,n){var i,o=t.getCustomData("list_marker_names"),s=t.getCustomData("list_marker_id");for(i in o)t.removeCustomData(i);t.removeCustomData("list_marker_names"),n&&(t.removeCustomData("list_marker_id"),delete e[s])},function(){function e(e,t){return-1<(" "+e+" ").replace(s," ").indexOf(" "+t+" ")}function t(e){var t=!0;return e.$.id||(e.$.id="cke_tmp_"+CKEDITOR.tools.getNextNumber(),t=!1),function(){t||e.removeAttribute("id")}}function n(e,t){return"#"+e.$.id+" "+t.split(/,\s*/).join(", #"+e.$.id+" ")}function i(e){for(var t=0,n=0,i=a[e].length;n<i;n++)t+=parseInt(this.getComputedStyle(a[e][n])||0,10)||0;return t}var o=void 0!==(o=document.createElement("_").classList)&&null!==String(o.add).match(/\[Native code\]/gi),s=/[\n\t\r]/g;CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:o?function(e){return this.$.classList.add(e),this}:function(t){var n=this.$.className;return n&&(e(n,t)||(n+=" "+t)),this.$.className=n||t,this},removeClass:o?function(e){var t=this.$;return t.classList.remove(e),t.className||t.removeAttribute("class"),this}:function(t){var n=this.getAttribute("class");return n&&e(n,t)&&((n=n.replace(new RegExp("(?:^|\\s+)"+t+"(?=\\s|$)"),"").replace(/^\s+/,""))?this.setAttribute("class",n):this.removeAttribute("class")),this},hasClass:function(t){return e(this.$.className,t)},append:function(e,t){return"string"==typeof e&&(e=this.getDocument().createElement(e)),t?this.$.insertBefore(e.$,this.$.firstChild):this.$.appendChild(e.$),e},appendHtml:function(e){if(this.$.childNodes.length){var t=new CKEDITOR.dom.element("div",this.getDocument());t.setHtml(e),t.moveChildren(this)}else this.setHtml(e)},appendText:function(e){null!=this.$.text&&CKEDITOR.env.ie&&9>CKEDITOR.env.version?this.$.text+=e:this.append(new CKEDITOR.dom.text(e))},appendBogus:function(e){if(e||CKEDITOR.env.needsBrFiller){for(e=this.getLast();e&&e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(e.getText());)e=e.getPrevious();e&&e.is&&e.is("br")||(e=this.getDocument().createElement("br"),CKEDITOR.env.gecko&&e.setAttribute("type","_moz"),this.append(e))}},breakParent:function(e,t){var n=new CKEDITOR.dom.range(this.getDocument());n.setStartAfter(this),n.setEndAfter(e);var i=n.extractContents(!1,t||!1);n.insertNode(this.remove()),i.insertAfterNode(this)},contains:document.compareDocumentPosition?function(e){return!!(16&this.$.compareDocumentPosition(e.$))}:function(e){var t=this.$;return e.type!=CKEDITOR.NODE_ELEMENT?t.contains(e.getParent().$):t!=e.$&&t.contains(e.$)},focus:function(){function e(){try{this.$.focus()}catch(e){}}return function(t){t?CKEDITOR.tools.setTimeout(e,100,this):e.call(this)}}(),getHtml:function(){var e=this.$.innerHTML;return CKEDITOR.env.ie?e.replace(/<\?[^>]*>/g,""):e},getOuterHtml:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var e=this.$.ownerDocument.createElement("div");return e.appendChild(this.$.cloneNode(!0)),e.innerHTML},getClientRect:function(){var e=CKEDITOR.tools.extend({},this.$.getBoundingClientRect());return!e.width&&(e.width=e.right-e.left),!e.height&&(e.height=e.bottom-e.top),e},setHtml:CKEDITOR.env.ie&&9>CKEDITOR.env.version?function(e){try{var t=this.$;if(this.getParent())return t.innerHTML=e;var n=this.getDocument()._getHtml5ShivFrag();return n.appendChild(t),t.innerHTML=e,n.removeChild(t),e}catch(n){for(this.$.innerHTML="",(t=new CKEDITOR.dom.element("body",this.getDocument())).$.innerHTML=e,t=t.getChildren();t.count();)this.append(t.getItem(0));return e}}:function(e){return this.$.innerHTML=e},setText:function(){var e=document.createElement("p");return e.innerHTML="x",e=e.textContent,function(t){this.$[e?"textContent":"innerText"]=t}}(),getAttribute:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){switch(e){case"class":e="className";break;case"http-equiv":e="httpEquiv";break;case"name":return this.$.name;case"tabindex":return 0!==(e=this.$.getAttribute(e,2))&&0===this.$.tabIndex&&(e=null),e;case"checked":return((e=this.$.attributes.getNamedItem(e)).specified?e.nodeValue:this.$.checked)?"checked":null;case"hspace":case"value":return this.$[e];case"style":return this.$.style.cssText;case"contenteditable":case"contentEditable":return this.$.attributes.getNamedItem("contentEditable").specified?this.$.getAttribute("contentEditable"):null}return this.$.getAttribute(e,2)}:function(e){return this.$.getAttribute(e,2)},getAttributes:function(e){var t,n={},i=this.$.attributes;for(e=CKEDITOR.tools.isArray(e)?e:[],t=0;t<i.length;t++)-1===CKEDITOR.tools.indexOf(e,i[t].name)&&(n[i[t].name]=i[t].value);return n},getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getComputedStyle:document.defaultView&&document.defaultView.getComputedStyle?function(e){var t=this.getWindow().$.getComputedStyle(this.$,null);return t?t.getPropertyValue(e):""}:function(e){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(e)]},getDtd:function(){var e=CKEDITOR.dtd[this.getName()];return this.getDtd=function(){return e},e},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:function(){var e=this.$.tabIndex;return 0!==e||CKEDITOR.dtd.$tabIndex[this.getName()]||0===parseInt(this.getAttribute("tabindex"),10)?e:-1},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var e=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&8>=document.documentMode){var t=this.$.scopeName;"HTML"!=t&&(e=t.toLowerCase()+":"+e)}return this.getName=function(){return e},this.getName()},getValue:function(){return this.$.value},getFirst:function(e){var t=this.$.firstChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getNext(e)),t},getLast:function(e){var t=this.$.lastChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getPrevious(e)),t},getStyle:function(e){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]},is:function(){var e=this.getName();if("object"==typeof arguments[0])return!!arguments[0][e];for(var t=0;t<arguments.length;t++)if(arguments[t]==e)return!0;return!1},isEditable:function(e){var t=this.getName();return!(this.isReadOnly()||"none"==this.getComputedStyle("display")||"hidden"==this.getComputedStyle("visibility")||CKEDITOR.dtd.$nonEditable[t]||CKEDITOR.dtd.$empty[t]||this.is("a")&&(this.data("cke-saved-name")||this.hasAttribute("name"))&&!this.getChildCount()||!1!==e&&(!(e=CKEDITOR.dtd[t]||CKEDITOR.dtd.span)||!e["#"]))},isIdentical:function(e){var t=this.clone(0,1);if(e=e.clone(0,1),t.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),e.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),t.$.isEqualNode)return t.$.style.cssText=CKEDITOR.tools.normalizeCssText(t.$.style.cssText),e.$.style.cssText=CKEDITOR.tools.normalizeCssText(e.$.style.cssText),t.$.isEqualNode(e.$);if(t=t.getOuterHtml(),e=e.getOuterHtml(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&this.is("a")){var n=this.getParent();n.type==CKEDITOR.NODE_ELEMENT&&((n=n.clone()).setHtml(t),t=n.getHtml(),n.setHtml(e),e=n.getHtml())}return t==e},isVisible:function(){var e,t,n=(this.$.offsetHeight||this.$.offsetWidth)&&"hidden"!=this.getComputedStyle("visibility");return n&&CKEDITOR.env.webkit&&!(e=this.getWindow()).equals(CKEDITOR.document.getWindow())&&(t=e.$.frameElement)&&(n=new CKEDITOR.dom.element(t).isVisible()),!!n},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()])return!1;for(var e=this.getChildren(),t=0,n=e.count();t<n;t++){var i=e.getItem(t);if((i.type!=CKEDITOR.NODE_ELEMENT||!i.data("cke-bookmark"))&&(i.type==CKEDITOR.NODE_ELEMENT&&!i.isEmptyInlineRemoveable()||i.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(i.getText())))return!1}return!0},hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(){for(var e=this.$.attributes,t=0;t<e.length;t++){var n=e[t];switch(n.nodeName){case"class":if(this.getAttribute("class"))return!0;case"data-cke-expando":continue;default:if(n.specified)return!0}}return!1}:function(){var e=this.$.attributes,t=e.length,n={"data-cke-expando":1,_moz_dirty:1};return 0<t&&(2<t||!n[e[0].nodeName]||2==t&&!n[e[1].nodeName])},hasAttribute:function(){function e(e){var t=this.$.attributes.getNamedItem(e);if("input"==this.getName())switch(e){case"class":return 0<this.$.className.length;case"checked":return!!this.$.checked;case"value":return"checkbox"==(e=this.getAttribute("type"))||"radio"==e?"on"!=this.$.value:!!this.$.value}return!!t&&t.specified}return CKEDITOR.env.ie?8>CKEDITOR.env.version?function(t){return"name"==t?!!this.$.name:e.call(this,t)}:e:function(e){return!!this.$.attributes.getNamedItem(e)}}(),hide:function(){this.setStyle("display","none")},moveChildren:function(e,t){var n,i=this.$;if(i!=(e=e.$))if(t)for(;n=i.lastChild;)e.insertBefore(i.removeChild(n),e.firstChild);else for(;n=i.firstChild;)e.appendChild(i.removeChild(n))},mergeSiblings:function(){function e(e,t,n){if(t&&t.type==CKEDITOR.NODE_ELEMENT){for(var i=[];t.data("cke-bookmark")||t.isEmptyInlineRemoveable();)if(i.push(t),!(t=n?t.getNext():t.getPrevious())||t.type!=CKEDITOR.NODE_ELEMENT)return;if(e.isIdentical(t)){for(var o=n?e.getLast():e.getFirst();i.length;)i.shift().move(e,!n);t.moveChildren(e,!n),t.remove(),o&&o.type==CKEDITOR.NODE_ELEMENT&&o.mergeSiblings()}}}return function(t){(!1===t||CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a"))&&(e(this,this.getNext(),!0),e(this,this.getPrevious()))}}(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:function(){var e=function(e,t){return this.$.setAttribute(e,t),this};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(t,n){return"class"==t?this.$.className=n:"style"==t?this.$.style.cssText=n:"tabindex"==t?this.$.tabIndex=n:"checked"==t?this.$.checked=n:"contenteditable"==t?e.call(this,"contentEditable",n):e.apply(this,arguments),this}:CKEDITOR.env.ie8Compat&&CKEDITOR.env.secure?function(t,n){if("src"==t&&n.match(/^http:\/\//))try{e.apply(this,arguments)}catch(e){}else e.apply(this,arguments);return this}:e}(),setAttributes:function(e){for(var t in e)this.setAttribute(t,e[t]);return this},setValue:function(e){return this.$.value=e,this},removeAttribute:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){"class"==e?e="className":"tabindex"==e?e="tabIndex":"contenteditable"==e&&(e="contentEditable"),this.$.removeAttribute(e)}:function(e){this.$.removeAttribute(e)},removeAttributes:function(e){if(CKEDITOR.tools.isArray(e))for(var t=0;t<e.length;t++)this.removeAttribute(e[t]);else for(t in e=e||this.getAttributes())e.hasOwnProperty(t)&&this.removeAttribute(t)},removeStyle:function(e){if((i=this.$.style).removeProperty||"border"!=e&&"margin"!=e&&"padding"!=e)i.removeProperty?i.removeProperty(e):i.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(e)),this.$.style.cssText||this.removeAttribute("style");else{var t,n=["top","left","right","bottom"];"border"==e&&(t=["color","style","width"]);for(var i=[],o=0;o<n.length;o++)if(t)for(var s=0;s<t.length;s++)i.push([e,n[o],t[s]].join("-"));else i.push([e,n[o]].join("-"));for(e=0;e<i.length;e++)this.removeStyle(i[e])}},setStyle:function(e,t){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]=t,this},setStyles:function(e){for(var t in e)this.setStyle(t,e[t]);return this},setOpacity:function(e){CKEDITOR.env.ie&&9>CKEDITOR.env.version?(e=Math.round(100*e),this.setStyle("filter",100<=e?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+e+")")):this.setStyle("opacity",e)},unselectable:function(){if(this.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","none")),CKEDITOR.env.ie){this.setAttribute("unselectable","on");for(var e=this.getElementsByTag("*"),t=0,n=e.count();t<n;t++)e.getItem(t).setAttribute("unselectable","on")}},getPositionedAncestor:function(){for(var e=this;"html"!=e.getName();){if("static"!=e.getComputedStyle("position"))return e;e=e.getParent()}return null},getDocumentPosition:function(e){var t=0,n=0,i=this.getDocument(),o=i.getBody(),s="BackCompat"==i.$.compatMode;if(document.documentElement.getBoundingClientRect){var a=this.$.getBoundingClientRect(),r=i.$.documentElement,l=r.clientTop||o.$.clientTop||0,c=r.clientLeft||o.$.clientLeft||0,d=!0;CKEDITOR.env.ie&&(d=i.getDocumentElement().contains(this),i=i.getBody().contains(this),d=s&&i||!s&&d),d&&(CKEDITOR.env.webkit||CKEDITOR.env.ie&&12<=CKEDITOR.env.version?(t=o.$.scrollLeft||r.scrollLeft,n=o.$.scrollTop||r.scrollTop):(t=(n=s?o.$:r).scrollLeft,n=n.scrollTop),t=a.left+t-c,n=a.top+n-l)}else for(l=this,c=null;l&&"body"!=l.getName()&&"html"!=l.getName();){for(t+=l.$.offsetLeft-l.$.scrollLeft,n+=l.$.offsetTop-l.$.scrollTop,l.equals(this)||(t+=l.$.clientLeft||0,n+=l.$.clientTop||0);c&&!c.equals(l);)t-=c.$.scrollLeft,n-=c.$.scrollTop,c=c.getParent();c=l,l=(a=l.$.offsetParent)?new CKEDITOR.dom.element(a):null}return e&&(a=this.getWindow(),l=e.getWindow(),!a.equals(l)&&a.$.frameElement&&(t+=(e=new CKEDITOR.dom.element(a.$.frameElement).getDocumentPosition(e)).x,n+=e.y)),document.documentElement.getBoundingClientRect||!CKEDITOR.env.gecko||s||(t+=this.$.clientLeft?1:0,n+=this.$.clientTop?1:0),{x:t,y:n}},scrollIntoView:function(e){var t=this.getParent();if(t)do{if((t.$.clientWidth&&t.$.clientWidth<t.$.scrollWidth||t.$.clientHeight&&t.$.clientHeight<t.$.scrollHeight)&&!t.is("body")&&this.scrollIntoParent(t,e,1),t.is("html")){var n=t.getWindow();try{var i=n.$.frameElement;i&&(t=new CKEDITOR.dom.element(i))}catch(e){}}}while(t=t.getParent())},scrollIntoParent:function(e,t,n){var i,o,s,a;function r(t,n){/body|html/.test(e.getName())?e.getWindow().$.scrollBy(t,n):(e.$.scrollLeft+=t,e.$.scrollTop+=n)}function l(e,t){var n={x:0,y:0};if(!e.is(d?"body":"html")){var i=e.$.getBoundingClientRect();n.x=i.left,n.y=i.top}return(i=e.getWindow()).equals(t)||(i=l(CKEDITOR.dom.element.get(i.$.frameElement),t),n.x+=i.x,n.y+=i.y),n}function c(e,t){return parseInt(e.getComputedStyle("margin-"+t)||0,10)||0}!e&&(e=this.getWindow());var d="BackCompat"==(s=e.getDocument()).$.compatMode;e instanceof CKEDITOR.dom.window&&(e=d?s.getBody():s.getDocumentElement()),o=l(this,s=e.getWindow());var u=l(e,s),h=this.$.offsetHeight;i=this.$.offsetWidth;var p=e.$.clientHeight,m=e.$.clientWidth;s=o.x-c(this,"left")-u.x||0,a=o.y-c(this,"top")-u.y||0,i=o.x+i+c(this,"right")-(u.x+m)||0,o=o.y+h+c(this,"bottom")-(u.y+p)||0,(0>a||0<o)&&r(0,!0===t?a:!1===t?o:0>a?a:o),n&&(0>s||0<i)&&r(0>s?s:i,0)},setState:function(e,t,n){switch(t=t||"cke",e){case CKEDITOR.TRISTATE_ON:this.addClass(t+"_on"),this.removeClass(t+"_off"),this.removeClass(t+"_disabled"),n&&this.setAttribute("aria-pressed",!0),n&&this.removeAttribute("aria-disabled");break;case CKEDITOR.TRISTATE_DISABLED:this.addClass(t+"_disabled"),this.removeClass(t+"_off"),this.removeClass(t+"_on"),n&&this.setAttribute("aria-disabled",!0),n&&this.removeAttribute("aria-pressed");break;default:this.addClass(t+"_off"),this.removeClass(t+"_on"),this.removeClass(t+"_disabled"),n&&this.removeAttribute("aria-pressed"),n&&this.removeAttribute("aria-disabled")}},getFrameDocument:function(){var e=this.$;try{e.contentWindow.document}catch(t){e.src=e.src}return e&&new CKEDITOR.dom.document(e.contentWindow.document)},copyAttributes:function(e,t){var n=this.$.attributes;t=t||{};for(var i=0;i<n.length;i++){var o,s=n[i],a=s.nodeName.toLowerCase();a in t||("checked"==a&&(o=this.getAttribute(a))?e.setAttribute(a,o):CKEDITOR.env.ie&&!this.hasAttribute(a)||(null===(o=this.getAttribute(a))&&(o=s.nodeValue),e.setAttribute(a,o)))}""!==this.$.style.cssText&&(e.$.style.cssText=this.$.style.cssText)},renameNode:function(e){if(this.getName()!=e){var t=this.getDocument();e=new CKEDITOR.dom.element(e,t),this.copyAttributes(e),this.moveChildren(e),this.getParent(!0)&&this.$.parentNode.replaceChild(e.$,this.$),e.$["data-cke-expando"]=this.$["data-cke-expando"],this.$=e.$,delete this.getName}},getChild:function(){function e(e,t){var n=e.childNodes;if(0<=t&&t<n.length)return n[t]}return function(t){var n=this.$;if(t.slice)for(t=t.slice();0<t.length&&n;)n=e(n,t.shift());else n=e(n,t);return n?new CKEDITOR.dom.node(n):null}}(),getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){function e(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_enable_context_menu")}this.on("contextmenu",(function(t){t.data.getTarget().getAscendant(e,!0)||t.data.preventDefault()}))},getDirection:function(e){return e?this.getComputedStyle("direction")||this.getDirection()||this.getParent()&&this.getParent().getDirection(1)||this.getDocument().$.dir||"ltr":this.getStyle("direction")||this.getAttribute("dir")},data:function(e,t){return e="data-"+e,void 0===t?this.getAttribute(e):(!1===t?this.removeAttribute(e):this.setAttribute(e,t),null)},getEditor:function(){var e,t,n=CKEDITOR.instances;for(e in n)if((t=n[e]).element.equals(this)&&t.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO)return t;return null},find:function(e){var i=t(this);return e=new CKEDITOR.dom.nodeList(this.$.querySelectorAll(n(this,e))),i(),e},findOne:function(e){var i=t(this);return e=this.$.querySelector(n(this,e)),i(),e?new CKEDITOR.dom.element(e):null},forEach:function(e,t,n){if(!(n||t&&this.type!=t))var i=e(this);if(!1!==i){n=this.getChildren();for(var o=0;o<n.count();o++)(i=n.getItem(o)).type==CKEDITOR.NODE_ELEMENT?i.forEach(e,t):t&&i.type!=t||e(i)}}});var a={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};CKEDITOR.dom.element.prototype.setSize=function(e,t,n){"number"==typeof t&&(!n||CKEDITOR.env.ie&&CKEDITOR.env.quirks||(t-=i.call(this,e)),this.setStyle(e,t+"px"))},CKEDITOR.dom.element.prototype.getSize=function(e,t){var n=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(e)],this.$["client"+CKEDITOR.tools.capitalize(e)])||0;return t&&(n-=i.call(this,e)),n}}(),CKEDITOR.dom.documentFragment=function(e){e=e||CKEDITOR.document,this.$=e.type==CKEDITOR.NODE_DOCUMENT?e.$.createDocumentFragment():e},CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(e){(e=e.$).parentNode.insertBefore(this.$,e.nextSibling)},getHtml:function(){var e=new CKEDITOR.dom.element("div");return this.clone(1,1).appendTo(e),e.getHtml().replace(/\s*data-cke-expando=".*?"/g,"")}},!0,{append:1,appendBogus:1,clone:1,getFirst:1,getHtml:1,getLast:1,getParent:1,getNext:1,getPrevious:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1}),function(){function e(e,t){var n=this.range;if(this._.end)return null;if(!this._.start){if(this._.start=1,n.collapsed)return this.end(),null;n.optimize()}var i,o=n.startContainer;i=n.endContainer;var s,a=n.startOffset,r=n.endOffset,l=this.guard,c=this.type,d=e?"getPreviousSourceNode":"getNextSourceNode";if(!e&&!this._.guardLTR){var u=i.type==CKEDITOR.NODE_ELEMENT?i:i.getParent(),h=i.type==CKEDITOR.NODE_ELEMENT?i.getChild(r):i.getNext();this._.guardLTR=function(e,t){return!(t&&u.equals(e)||h&&e.equals(h)||e.type==CKEDITOR.NODE_ELEMENT&&t&&e.equals(n.root))}}if(e&&!this._.guardRTL){var p=o.type==CKEDITOR.NODE_ELEMENT?o:o.getParent(),m=o.type==CKEDITOR.NODE_ELEMENT?a?o.getChild(a-1):null:o.getPrevious();this._.guardRTL=function(e,t){return!(t&&p.equals(e)||m&&e.equals(m)||e.type==CKEDITOR.NODE_ELEMENT&&t&&e.equals(n.root))}}var _=e?this._.guardRTL:this._.guardLTR;for(s=l?function(e,t){return!1!==_(e,t)&&l(e,t)}:_,this.current?i=this.current[d](!1,c,s):(e?i.type==CKEDITOR.NODE_ELEMENT&&(i=0<r?i.getChild(r-1):!1===s(i,!0)?null:i.getPreviousSourceNode(!0,c,s)):(i=o).type==CKEDITOR.NODE_ELEMENT&&((i=i.getChild(a))||(i=!1===s(o,!0)?null:o.getNextSourceNode(!0,c,s))),i&&!1===s(i)&&(i=null));i&&!this._.end;){if(this.current=i,this.evaluator&&!1===this.evaluator(i)){if(t&&this.evaluator)return!1}else if(!t)return i;i=i[d](!1,c,s)}return this.end(),this.current=null}function t(t){for(var n,i=null;n=e.call(this,t);)i=n;return i}CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(e){this.range=e,this._={}},proto:{end:function(){this._.end=1},next:function(){return e.call(this)},previous:function(){return e.call(this,1)},checkForward:function(){return!1!==e.call(this,0,1)},checkBackward:function(){return!1!==e.call(this,1,1)},lastForward:function(){return t.call(this)},lastBackward:function(){return t.call(this,1)},reset:function(){delete this.current,this._={}}}});var n={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},i={absolute:1,fixed:1};CKEDITOR.dom.element.prototype.isBlockBoundary=function(e){return!("none"!=this.getComputedStyle("float")||this.getComputedStyle("position")in i||!n[this.getComputedStyle("display")])||!!(this.is(CKEDITOR.dtd.$block)||e&&this.is(e))},CKEDITOR.dom.walker.blockBoundary=function(e){return function(t){return!(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary(e))}},CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})},CKEDITOR.dom.walker.bookmark=function(e,t){function n(e){return e&&e.getName&&"span"==e.getName()&&e.data("cke-bookmark")}return function(i){var o,s;return o=i&&i.type!=CKEDITOR.NODE_ELEMENT&&(s=i.getParent())&&n(s),o=e?o:o||n(i),!!(t^o)}},CKEDITOR.dom.walker.whitespaces=function(e){return function(t){var n;return t&&t.type==CKEDITOR.NODE_TEXT&&(n=!CKEDITOR.tools.trim(t.getText())||CKEDITOR.env.webkit&&t.getText()==CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE),!!(e^n)}},CKEDITOR.dom.walker.invisible=function(e){var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.env.webkit?1:0;return function(i){return t(i)?i=1:(i.type==CKEDITOR.NODE_TEXT&&(i=i.getParent()),i=i.$.offsetWidth<=n),!!(e^i)}},CKEDITOR.dom.walker.nodeType=function(e,t){return function(n){return!!(t^n.type==e)}},CKEDITOR.dom.walker.bogus=function(e){function t(e){return!s(e)&&!a(e)}return function(n){var i=CKEDITOR.env.needsBrFiller?n.is&&n.is("br"):n.getText&&o.test(n.getText());return i&&(i=n.getParent(),n=n.getNext(t),i=i.isBlockBoundary()&&(!n||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary())),!!(e^i)}},CKEDITOR.dom.walker.temp=function(e){return function(t){return t.type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent()),t=t&&t.hasAttribute("data-cke-temp"),!!(e^t)}};var o=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,s=CKEDITOR.dom.walker.whitespaces(),a=CKEDITOR.dom.walker.bookmark(),r=CKEDITOR.dom.walker.temp(),l=function(e){return a(e)||s(e)||e.type==CKEDITOR.NODE_ELEMENT&&e.is(CKEDITOR.dtd.$inline)&&!e.is(CKEDITOR.dtd.$empty)};CKEDITOR.dom.walker.ignored=function(e){return function(t){return t=s(t)||a(t)||r(t),!!(e^t)}};var c=CKEDITOR.dom.walker.ignored();CKEDITOR.dom.walker.empty=function(e){return function(t){for(var n=0,i=t.getChildCount();n<i;++n)if(!c(t.getChild(n)))return!!e;return!e}};var d=CKEDITOR.dom.walker.empty(),u=CKEDITOR.dom.walker.validEmptyBlockContainers=CKEDITOR.tools.extend(function(e){var t,n={};for(t in e)CKEDITOR.dtd[t]["#"]&&(n[t]=1);return n}(CKEDITOR.dtd.$block),{caption:1,td:1,th:1});CKEDITOR.dom.walker.editable=function(e){return function(t){return t=!c(t)&&!!(t.type==CKEDITOR.NODE_TEXT||t.type==CKEDITOR.NODE_ELEMENT&&(t.is(CKEDITOR.dtd.$inline)||t.is("hr")||"false"==t.getAttribute("contenteditable")||!CKEDITOR.env.needsBrFiller&&t.is(u)&&d(t))),!!(e^t)}},CKEDITOR.dom.element.prototype.getBogus=function(){var e=this;do{e=e.getPreviousSourceNode()}while(l(e));return!(!e||!(CKEDITOR.env.needsBrFiller?e.is&&e.is("br"):e.getText&&o.test(e.getText())))&&e}}(),CKEDITOR.dom.range=function(e){this.endOffset=this.endContainer=this.startOffset=this.startContainer=null,this.collapsed=!0;var t=e instanceof CKEDITOR.dom.document;this.document=t?e:e.getDocument(),this.root=t?e.getBody():e},function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer.equals(e.endContainer)&&e.startOffset==e.endOffset}function t(e,t,n,i,o){function s(e,t,n,i){var s=n?e.getPrevious():e.getNext();return i&&a||(l||i?t.append(e.clone(!0,o),n):(e.remove(),r&&t.append(e))),s}e.optimizeBookmark();var a=0===t,r=1==t,l=2==t;t=l||r;var c,d,u,h,p,m,_=e.startContainer,g=e.endContainer,f=e.startOffset,b=e.endOffset;if(l&&g.type==CKEDITOR.NODE_TEXT&&_.equals(g))_=e.document.createText(_.substring(f,b)),n.append(_);else{g.type==CKEDITOR.NODE_TEXT?l?m=!0:g=g.split(b):0<g.getChildCount()?b>=g.getChildCount()?(g=g.getChild(b-1),d=!0):g=g.getChild(b):h=d=!0,_.type==CKEDITOR.NODE_TEXT?l?p=!0:_.split(f):0<_.getChildCount()?0===f?(_=_.getChild(f),c=!0):_=_.getChild(f-1):u=c=!0;for(var v,A,E,T=_.getParents(),C=g.getParents(),y=function(){var e,t,n,i=Math.min(T.length,C.length);for(e=0;e<i;e++)if(t=T[e],n=C[e],!t.equals(n))return e;return e-1}(),M=T.length-1,I=C.length-1,S=n,w=-1,N=y;N<=M;N++){for(E=(A=T[N]).getNext(),N!=M||A.equals(C[N])&&M<I?t&&(v=S.append(A.clone(0,o))):c?s(A,S,!1,u):p&&S.append(e.document.createText(A.substring(f)));E;){if(E.equals(C[N])){w=N;break}E=s(E,S)}S=v}for(S=n,N=y;N<=I;N++)if(E=(n=C[N]).getPrevious(),n.equals(T[N]))t&&(S=S.getChild(0));else{if(N!=I||n.equals(T[N])&&I<M?t&&(v=S.append(n.clone(0,o))):d?s(n,S,!1,h):m&&S.append(e.document.createText(n.substring(0,b))),N>w)for(;E;)E=s(E,S,!0);S=v}l||function(){var t=y-1,n=u&&h&&!_.equals(g);t<M-1||t<I-1||n?(n?e.moveToPosition(g,CKEDITOR.POSITION_BEFORE_START):I==t+1&&d?e.moveToPosition(C[t],CKEDITOR.POSITION_BEFORE_END):e.moveToPosition(C[t+1],CKEDITOR.POSITION_BEFORE_START),i&&(t=T[t+1])&&t.type==CKEDITOR.NODE_ELEMENT&&((n=CKEDITOR.dom.element.createFromHtml('<span data-cke-bookmark="1" style="display:none">&nbsp;</span>',e.document)).insertAfter(t),t.mergeSiblings(!1),e.moveToBookmark({startNode:n}))):e.collapse(!0)}()}}function n(){var e=!1,t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!0),i=CKEDITOR.dom.walker.bogus();return function(s){return!(!n(s)&&!t(s))||(i(s)&&!e?e=!0:!(s.type==CKEDITOR.NODE_TEXT&&(s.hasAscendant("pre")||CKEDITOR.tools.trim(s.getText()).length)||s.type==CKEDITOR.NODE_ELEMENT&&!s.is(o)))}}function i(e){return function(){var t;return this[e?"getPreviousNode":"getNextNode"]((function(e){return!t&&l(e)&&(t=e),r(e)&&!(s(e)&&e.equals(t))}))}}var o={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1},s=CKEDITOR.dom.walker.bogus(),a=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,r=CKEDITOR.dom.walker.editable(),l=CKEDITOR.dom.walker.ignored(!0);CKEDITOR.dom.range.prototype={clone:function(){var e=new CKEDITOR.dom.range(this.root);return e._setStartContainer(this.startContainer),e.startOffset=this.startOffset,e._setEndContainer(this.endContainer),e.endOffset=this.endOffset,e.collapsed=this.collapsed,e},collapse:function(e){e?(this._setEndContainer(this.startContainer),this.endOffset=this.startOffset):(this._setStartContainer(this.endContainer),this.startOffset=this.endOffset),this.collapsed=!0},cloneContents:function(e){var n=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||t(this,2,n,!1,void 0===e||e),n},deleteContents:function(e){this.collapsed||t(this,0,null,e)},extractContents:function(e,n){var i=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||t(this,1,i,e,void 0===n||n),i},createBookmark:function(e){var t,n,i,o,s=this.collapsed;return(t=this.document.createElement("span")).data("cke-bookmark",1),t.setStyle("display","none"),t.setHtml("&nbsp;"),e&&(i="cke_bm_"+CKEDITOR.tools.getNextNumber(),t.setAttribute("id",i+(s?"C":"S"))),s||((n=t.clone()).setHtml("&nbsp;"),e&&n.setAttribute("id",i+"E"),(o=this.clone()).collapse(),o.insertNode(n)),(o=this.clone()).collapse(!0),o.insertNode(t),n?(this.setStartAfter(t),this.setEndBefore(n)):this.moveToPosition(t,CKEDITOR.POSITION_AFTER_END),{startNode:e?i+(s?"C":"S"):t,endNode:e?i+"E":n,serializable:e,collapsed:s}},createBookmark2:function(){function e(e){var t,i=e.container,o=e.offset,s=o;if((t=(t=i).type!=CKEDITOR.NODE_ELEMENT||0===s||s==t.getChildCount()?0:t.getChild(s-1).type==CKEDITOR.NODE_TEXT&&t.getChild(s).type==CKEDITOR.NODE_TEXT)&&(o=(i=i.getChild(o-1)).getLength()),i.type==CKEDITOR.NODE_ELEMENT&&0<o){e:{for(t=i;o--;)if(0<=(s=t.getChild(o).getIndex(!0))){o=s;break e}o=-1}o+=1}if(i.type==CKEDITOR.NODE_TEXT){for(t=i,s=0;(t=t.getPrevious())&&t.type==CKEDITOR.NODE_TEXT;)s+=t.getText().replace(CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE,"").length;t=s,i.getText()?o+=t:(s=i.getPrevious(n),t?(o=t,i=s?s.getNext():i.getParent().getFirst()):(i=i.getParent(),o=s?s.getIndex(!0)+1:0))}e.container=i,e.offset=o}function t(e,t){var n=t.getCustomData("cke-fillingChar");if(n){var i=e.container;n.equals(i)&&(e.offset-=CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE.length,0>=e.offset&&(e.offset=i.getIndex(),e.container=i.getParent()))}}var n=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_TEXT,!0);return function(n){var i=this.collapsed,o={container:this.startContainer,offset:this.startOffset},s={container:this.endContainer,offset:this.endOffset};return n&&(e(o),t(o,this.root),i||(e(s),t(s,this.root))),{start:o.container.getAddress(n),end:i?null:s.container.getAddress(n),startOffset:o.offset,endOffset:s.offset,normalized:n,collapsed:i,is2:!0}}}(),moveToBookmark:function(e){if(e.is2){var t=this.document.getByAddress(e.start,e.normalized),n=e.startOffset,i=e.end&&this.document.getByAddress(e.end,e.normalized);e=e.endOffset,this.setStart(t,n),i?this.setEnd(i,e):this.collapse(!0)}else t=(n=e.serializable)?this.document.getById(e.startNode):e.startNode,e=n?this.document.getById(e.endNode):e.endNode,this.setStartBefore(t),t.remove(),e?(this.setEndBefore(e),e.remove()):this.collapse(!0)},getBoundaryNodes:function(){var e,t=this.startContainer,n=this.endContainer,i=this.startOffset,o=this.endOffset;if(t.type==CKEDITOR.NODE_ELEMENT)if((e=t.getChildCount())>i)t=t.getChild(i);else if(1>e)t=t.getPreviousSourceNode();else{for(t=t.$;t.lastChild;)t=t.lastChild;t=(t=new CKEDITOR.dom.node(t)).getNextSourceNode()||t}if(n.type==CKEDITOR.NODE_ELEMENT)if((e=n.getChildCount())>o)n=n.getChild(o).getPreviousSourceNode(!0);else if(1>e)n=n.getPreviousSourceNode();else{for(n=n.$;n.lastChild;)n=n.lastChild;n=new CKEDITOR.dom.node(n)}return t.getPosition(n)&CKEDITOR.POSITION_FOLLOWING&&(t=n),{startNode:t,endNode:n}},getCommonAncestor:function(e,t){var n=this.startContainer,i=this.endContainer;return n=n.equals(i)?e&&n.type==CKEDITOR.NODE_ELEMENT&&this.startOffset==this.endOffset-1?n.getChild(this.startOffset):n:n.getCommonAncestor(i),t&&!n.is?n.getParent():n},optimize:function(){var e=this.startContainer,t=this.startOffset;e.type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setStartAfter(e):this.setStartBefore(e)),e=this.endContainer,t=this.endOffset,e.type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setEndAfter(e):this.setEndBefore(e))},optimizeBookmark:function(){var e=this.startContainer,t=this.endContainer;e.is&&e.is("span")&&e.data("cke-bookmark")&&this.setStartAt(e,CKEDITOR.POSITION_BEFORE_START),t&&t.is&&t.is("span")&&t.data("cke-bookmark")&&this.setEndAt(t,CKEDITOR.POSITION_AFTER_END)},trim:function(e,t){var n=this.startContainer,i=this.startOffset,o=this.collapsed;if((!e||o)&&n&&n.type==CKEDITOR.NODE_TEXT){if(i)if(i>=n.getLength())i=n.getIndex()+1,n=n.getParent();else{var s=n.split(i);i=n.getIndex()+1,n=n.getParent(),this.startContainer.equals(this.endContainer)?this.setEnd(s,this.endOffset-this.startOffset):n.equals(this.endContainer)&&(this.endOffset+=1)}else i=n.getIndex(),n=n.getParent();if(this.setStart(n,i),o)return void this.collapse(!0)}n=this.endContainer,i=this.endOffset,t||o||!n||n.type!=CKEDITOR.NODE_TEXT||(i?(i>=n.getLength()||n.split(i),i=n.getIndex()+1):i=n.getIndex(),n=n.getParent(),this.setEnd(n,i))},enlarge:function(e,t){function n(e){return e&&e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("contenteditable")?null:e}var i=new RegExp(/[^\s\ufeff]/);switch(e){case CKEDITOR.ENLARGE_INLINE:var o=1;case CKEDITOR.ENLARGE_ELEMENT:var s=function(e,t){var n,o;for((n=new CKEDITOR.dom.range(m)).setStart(e,t),n.setEndAt(m,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(n)).guard=function(e){return!(e.type==CKEDITOR.NODE_ELEMENT&&e.isBlockBoundary())};o=n.next();){if(o.type!=CKEDITOR.NODE_TEXT)return!1;if(h=o!=e?o.getText():o.substring(t),i.test(h))return!1}return!0};if(this.collapsed)break;var a,r,l,c,d,u,h,p=this.getCommonAncestor(),m=this.root,_=!1;u=this.startContainer;var g=this.startOffset;for(u.type==CKEDITOR.NODE_TEXT?(g&&(_=!!(u=!CKEDITOR.tools.trim(u.substring(0,g)).length&&u)),u&&((c=u.getPrevious())||(l=u.getParent()))):(g&&(c=u.getChild(g-1)||u.getLast()),c||(l=u)),l=n(l);l||c;){if(l&&!c){if(!d&&l.equals(p)&&(d=!0),o?l.isBlockBoundary():!m.contains(l))break;_&&"inline"==l.getComputedStyle("display")||(_=!1,d?a=l:this.setStartBefore(l)),c=l.getPrevious()}for(;c;)if(u=!1,c.type==CKEDITOR.NODE_COMMENT)c=c.getPrevious();else{if(c.type==CKEDITOR.NODE_TEXT)h=c.getText(),i.test(h)&&(c=null),u=/[\s\ufeff]$/.test(h);else if((c.$.offsetWidth>(CKEDITOR.env.webkit?1:0)||t&&c.is("br"))&&!c.data("cke-bookmark"))if(_&&CKEDITOR.dtd.$removeEmpty[c.getName()]){if(h=c.getText(),i.test(h))c=null;else{g=c.$.getElementsByTagName("*");for(var f,b=0;f=g[b++];)if(!CKEDITOR.dtd.$removeEmpty[f.nodeName.toLowerCase()]){c=null;break}}c&&(u=!!h.length)}else c=null;if(u&&(_?d?a=l:l&&this.setStartBefore(l):_=!0),c){if(u=c.getPrevious(),!l&&!u){l=c,c=null;break}c=u}else l=null}l&&(l=n(l.getParent()))}for(u=this.endContainer,g=this.endOffset,l=c=null,d=_=!1,u.type==CKEDITOR.NODE_TEXT?CKEDITOR.tools.trim(u.substring(g)).length?_=!0:(_=!u.getLength(),g==u.getLength()?(c=u.getNext())||(l=u.getParent()):s(u,g)&&(l=u.getParent())):(c=u.getChild(g))||(l=u);l||c;){if(l&&!c){if(!d&&l.equals(p)&&(d=!0),o?l.isBlockBoundary():!m.contains(l))break;_&&"inline"==l.getComputedStyle("display")||(_=!1,d?r=l:l&&this.setEndAfter(l)),c=l.getNext()}for(;c;){if(u=!1,c.type==CKEDITOR.NODE_TEXT)h=c.getText(),s(c,0)||(c=null),u=/^[\s\ufeff]/.test(h);else if(c.type==CKEDITOR.NODE_ELEMENT){if((0<c.$.offsetWidth||t&&c.is("br"))&&!c.data("cke-bookmark"))if(_&&CKEDITOR.dtd.$removeEmpty[c.getName()]){if(h=c.getText(),i.test(h))c=null;else for(g=c.$.getElementsByTagName("*"),b=0;f=g[b++];)if(!CKEDITOR.dtd.$removeEmpty[f.nodeName.toLowerCase()]){c=null;break}c&&(u=!!h.length)}else c=null}else u=1;if(u&&_&&(d?r=l:this.setEndAfter(l)),c){if(u=c.getNext(),!l&&!u){l=c,c=null;break}c=u}else l=null}l&&(l=n(l.getParent()))}a&&r&&(p=a.contains(r)?r:a,this.setStartBefore(p),this.setEndAfter(p));break;case CKEDITOR.ENLARGE_BLOCK_CONTENTS:case CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:l=new CKEDITOR.dom.range(this.root),m=this.root,l.setStartAt(m,CKEDITOR.POSITION_AFTER_START),l.setEnd(this.startContainer,this.startOffset),l=new CKEDITOR.dom.walker(l);var v,A,E=CKEDITOR.dom.walker.blockBoundary(e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?{br:1}:null),T=null,C=function(e){if(e.type==CKEDITOR.NODE_ELEMENT&&"false"==e.getAttribute("contenteditable"))if(T){if(T.equals(e))return void(T=null)}else T=e;else if(T)return;var t=E(e);return t||(v=e),t};if(o=function(e){var t=C(e);return!t&&e.is&&e.is("br")&&(A=e),t},l.guard=C,l=l.lastBackward(),v=v||m,this.setStartAt(v,!v.is("br")&&(!l&&this.checkStartOfBlock()||l&&v.contains(l))?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_AFTER_END),e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS){l=this.clone(),l=new CKEDITOR.dom.walker(l);var y=CKEDITOR.dom.walker.whitespaces(),M=CKEDITOR.dom.walker.bookmark();if(l.evaluator=function(e){return!y(e)&&!M(e)},(l=l.previous())&&l.type==CKEDITOR.NODE_ELEMENT&&l.is("br"))break}(l=this.clone()).collapse(),l.setEndAt(m,CKEDITOR.POSITION_BEFORE_END),(l=new CKEDITOR.dom.walker(l)).guard=e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?o:C,v=T=A=null,l=l.lastForward(),v=v||m,this.setEndAt(v,!l&&this.checkEndOfBlock()||l&&v.contains(l)?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_BEFORE_START),A&&this.setEndAfter(A)}},shrink:function(e,t,n){if(!this.collapsed){e=e||CKEDITOR.SHRINK_TEXT;var i=this.clone(),o=this.startContainer,s=this.endContainer,a=this.startOffset,r=this.endOffset,l=1,c=1;o&&o.type==CKEDITOR.NODE_TEXT&&(a?a>=o.getLength()?i.setStartAfter(o):(i.setStartBefore(o),l=0):i.setStartBefore(o)),s&&s.type==CKEDITOR.NODE_TEXT&&(r?r>=s.getLength()?i.setEndAfter(s):(i.setEndAfter(s),c=0):i.setEndBefore(s)),i=new CKEDITOR.dom.walker(i);var d,u=CKEDITOR.dom.walker.bookmark();return i.evaluator=function(t){return t.type==(e==CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT)},i.guard=function(t,i){return!!u(t)||!(e==CKEDITOR.SHRINK_ELEMENT&&t.type==CKEDITOR.NODE_TEXT||i&&t.equals(d)||!1===n&&t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary()||t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("contenteditable"))&&(i||t.type!=CKEDITOR.NODE_ELEMENT||(d=t),!0)},l&&(o=i[e==CKEDITOR.SHRINK_ELEMENT?"lastForward":"next"]())&&this.setStartAt(o,t?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_START),c&&(i.reset(),(i=i[e==CKEDITOR.SHRINK_ELEMENT?"lastBackward":"previous"]())&&this.setEndAt(i,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_END)),!(!l&&!c)}},insertNode:function(e){this.optimizeBookmark(),this.trim(!1,!0);var t=this.startContainer,n=t.getChild(this.startOffset);n?e.insertBefore(n):t.append(e),e.getParent()&&e.getParent().equals(this.endContainer)&&this.endOffset++,this.setStartBefore(e)},moveToPosition:function(e,t){this.setStartAt(e,t),this.collapse(!0)},moveToRange:function(e){this.setStart(e.startContainer,e.startOffset),this.setEnd(e.endContainer,e.endOffset)},selectNodeContents:function(e){this.setStart(e,0),this.setEnd(e,e.type==CKEDITOR.NODE_TEXT?e.getLength():e.getChildCount())},setStart:function(t,n){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(n=t.getIndex(),t=t.getParent()),this._setStartContainer(t),this.startOffset=n,this.endContainer||(this._setEndContainer(t),this.endOffset=n),e(this)},setEnd:function(t,n){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(n=t.getIndex()+1,t=t.getParent()),this._setEndContainer(t),this.endOffset=n,this.startContainer||(this._setStartContainer(t),this.startOffset=n),e(this)},setStartAfter:function(e){this.setStart(e.getParent(),e.getIndex()+1)},setStartBefore:function(e){this.setStart(e.getParent(),e.getIndex())},setEndAfter:function(e){this.setEnd(e.getParent(),e.getIndex()+1)},setEndBefore:function(e){this.setEnd(e.getParent(),e.getIndex())},setStartAt:function(t,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setStart(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setStart(t,t.getLength()):this.setStart(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setStartBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setStartAfter(t)}e(this)},setEndAt:function(t,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setEnd(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setEnd(t,t.getLength()):this.setEnd(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setEndBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setEndAfter(t)}e(this)},fixBlock:function(e,t){var n=this.createBookmark(),i=this.document.createElement(t);this.collapse(e),this.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),this.extractContents().appendTo(i),i.trim(),this.insertNode(i);var o=i.getBogus();return o&&o.remove(),i.appendBogus(),this.moveToBookmark(n),i},splitBlock:function(e,t){var n=new CKEDITOR.dom.elementPath(this.startContainer,this.root),i=new CKEDITOR.dom.elementPath(this.endContainer,this.root),o=n.block,s=i.block,a=null;return n.blockLimit.equals(i.blockLimit)?("br"!=e&&(o||(o=this.fixBlock(!0,e),s=new CKEDITOR.dom.elementPath(this.endContainer,this.root).block),s||(s=this.fixBlock(!1,e))),n=o&&this.checkStartOfBlock(),i=s&&this.checkEndOfBlock(),this.deleteContents(),o&&o.equals(s)&&(i?(a=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(s,CKEDITOR.POSITION_AFTER_END),s=null):n?(a=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(o,CKEDITOR.POSITION_BEFORE_START),o=null):(s=this.splitElement(o,t||!1),o.is("ul","ol")||o.appendBogus())),{previousBlock:o,nextBlock:s,wasStartOfBlock:n,wasEndOfBlock:i,elementPath:a}):null},splitElement:function(e,t){if(!this.collapsed)return null;this.setEndAt(e,CKEDITOR.POSITION_BEFORE_END);var n=this.extractContents(!1,t||!1),i=e.clone(!1,t||!1);return n.appendTo(i),i.insertAfter(e),this.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),i},removeEmptyBlocksAtEnd:function(){function e(e){return function(i){return!(t(i)||n(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.isEmptyInlineRemoveable()||e.is("table")&&i.is("caption"))}}var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!1);return function(t){for(var n,i=this.createBookmark(),o=this[t?"endPath":"startPath"](),s=o.block||o.blockLimit;s&&!s.equals(o.root)&&!s.getFirst(e(s));)n=s.getParent(),this[t?"setEndAt":"setStartAt"](s,CKEDITOR.POSITION_AFTER_END),s.remove(1),s=n;this.moveToBookmark(i)}}(),startPath:function(){return new CKEDITOR.dom.elementPath(this.startContainer,this.root)},endPath:function(){return new CKEDITOR.dom.elementPath(this.endContainer,this.root)},checkBoundaryOfElement:function(e,t){var n=t==CKEDITOR.START,i=this.clone();return i.collapse(n),i[n?"setStartAt":"setEndAt"](e,n?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),(i=new CKEDITOR.dom.walker(i)).evaluator=function(e){var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(1);return function(i){return!(!n(i)&&!t(i))||!e&&s(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.is(CKEDITOR.dtd.$removeEmpty)}}(n),i[n?"checkBackward":"checkForward"]()},checkStartOfBlock:function(){var e=this.startContainer,t=this.startOffset;return CKEDITOR.env.ie&&t&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.ltrim(e.substring(0,t)),a.test(e)&&this.trim(0,1)),this.trim(),e=new CKEDITOR.dom.elementPath(this.startContainer,this.root),(t=this.clone()).collapse(!0),t.setStartAt(e.block||e.blockLimit,CKEDITOR.POSITION_AFTER_START),(e=new CKEDITOR.dom.walker(t)).evaluator=n(),e.checkBackward()},checkEndOfBlock:function(){var e=this.endContainer,t=this.endOffset;return CKEDITOR.env.ie&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.rtrim(e.substring(t)),a.test(e)&&this.trim(1,0)),this.trim(),e=new CKEDITOR.dom.elementPath(this.endContainer,this.root),(t=this.clone()).collapse(!1),t.setEndAt(e.block||e.blockLimit,CKEDITOR.POSITION_BEFORE_END),(e=new CKEDITOR.dom.walker(t)).evaluator=n(),e.checkForward()},getPreviousNode:function(e,t,n){var i=this.clone();return i.collapse(1),i.setStartAt(n||this.root,CKEDITOR.POSITION_AFTER_START),(n=new CKEDITOR.dom.walker(i)).evaluator=e,n.guard=t,n.previous()},getNextNode:function(e,t,n){var i=this.clone();return i.collapse(),i.setEndAt(n||this.root,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(i)).evaluator=e,n.guard=t,n.next()},checkReadOnly:function(){function e(e,t){for(;e;){if(e.type==CKEDITOR.NODE_ELEMENT){if("false"==e.getAttribute("contentEditable")&&!e.data("cke-editable"))return 0;if(e.is("html")||"true"==e.getAttribute("contentEditable")&&(e.contains(t)||e.equals(t)))break}e=e.getParent()}return 1}return function(){var t=this.startContainer,n=this.endContainer;return!(e(t,n)&&e(n,t))}}(),moveToElementEditablePosition:function(e,t){if(e.type==CKEDITOR.NODE_ELEMENT&&!e.isEditable(!1))return this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),!0;for(var n=0;e;){if(e.type==CKEDITOR.NODE_TEXT){t&&this.endContainer&&this.checkEndOfBlock()&&a.test(e.getText())?this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START):this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),n=1;break}if(e.type==CKEDITOR.NODE_ELEMENT)if(e.isEditable())this.moveToPosition(e,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_START),n=1;else if(t&&e.is("br")&&this.endContainer&&this.checkEndOfBlock())this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START);else if("false"==e.getAttribute("contenteditable")&&e.is(CKEDITOR.dtd.$block))return this.setStartBefore(e),this.setEndAfter(e),!0;var i=e,o=n,s=void 0;i.type==CKEDITOR.NODE_ELEMENT&&i.isEditable(!1)&&(s=i[t?"getLast":"getFirst"](l)),o||s||(s=i[t?"getPrevious":"getNext"](l)),e=s}return!!n},moveToClosestEditablePosition:function(e,t){var n,i,o,s=0,a=[CKEDITOR.POSITION_AFTER_END,CKEDITOR.POSITION_BEFORE_START];return e?(n=new CKEDITOR.dom.range(this.root)).moveToPosition(e,a[t?0:1]):n=this.clone(),e&&!e.is(CKEDITOR.dtd.$block)?s=1:(i=n[t?"getNextEditableNode":"getPreviousEditableNode"]())&&(s=1,(o=i.type==CKEDITOR.NODE_ELEMENT)&&i.is(CKEDITOR.dtd.$block)&&"false"==i.getAttribute("contenteditable")?(n.setStartAt(i,CKEDITOR.POSITION_BEFORE_START),n.setEndAt(i,CKEDITOR.POSITION_AFTER_END)):!CKEDITOR.env.needsBrFiller&&o&&i.is(CKEDITOR.dom.walker.validEmptyBlockContainers)?(n.setEnd(i,0),n.collapse()):n.moveToPosition(i,a[t?1:0])),s&&this.moveToRange(n),!!s},moveToElementEditStart:function(e){return this.moveToElementEditablePosition(e)},moveToElementEditEnd:function(e){return this.moveToElementEditablePosition(e,!0)},getEnclosedNode:function(){if((e=this.clone()).optimize(),e.startContainer.type!=CKEDITOR.NODE_ELEMENT||e.endContainer.type!=CKEDITOR.NODE_ELEMENT)return null;var e=new CKEDITOR.dom.walker(e),t=CKEDITOR.dom.walker.bookmark(!1,!0),n=CKEDITOR.dom.walker.whitespaces(!0);e.evaluator=function(e){return n(e)&&t(e)};var i=e.next();return e.reset(),i&&i.equals(e.previous())?i:null},getTouchedStartNode:function(){var e=this.startContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.startOffset)||e},getTouchedEndNode:function(){var e=this.endContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.endOffset-1)||e},getNextEditableNode:i(),getPreviousEditableNode:i(1),scrollIntoView:function(){var e,t,n,i=new CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",this.document),o=this.clone();o.optimize(),(n=o.startContainer.type==CKEDITOR.NODE_TEXT)?(t=o.startContainer.getText(),e=o.startContainer.split(o.startOffset),i.insertAfter(o.startContainer)):o.insertNode(i),i.scrollIntoView(),n&&(o.startContainer.setText(t),e.remove()),i.remove()},_setStartContainer:function(e){this.startContainer=e},_setEndContainer:function(e){this.endContainer=e}}}(),CKEDITOR.POSITION_AFTER_START=1,CKEDITOR.POSITION_BEFORE_END=2,CKEDITOR.POSITION_BEFORE_START=3,CKEDITOR.POSITION_AFTER_END=4,CKEDITOR.ENLARGE_ELEMENT=1,CKEDITOR.ENLARGE_BLOCK_CONTENTS=2,CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS=3,CKEDITOR.ENLARGE_INLINE=4,CKEDITOR.START=1,CKEDITOR.END=2,CKEDITOR.SHRINK_ELEMENT=1,CKEDITOR.SHRINK_TEXT=2,function(){function e(e){1>arguments.length||(this.range=e,this.forceBrBreak=0,this.enlargeBr=1,this.enforceRealBlocks=0,this._||(this._={}))}function t(e,n,i,o){e:{null==o&&(o=function(e){var t=[];return e.forEach((function(e){if("true"==e.getAttribute("contenteditable"))return t.push(e),!1}),CKEDITOR.NODE_ELEMENT,!0),t}(i));for(var s;s=o.shift();)if(s.getDtd().p){o={element:s,remaining:o};break e}o=null}return o?(s=CKEDITOR.filter.instances[o.element.data("cke-filter")])&&!s.check(n)?t(e,n,i,o.remaining):((n=new CKEDITOR.dom.range(o.element)).selectNodeContents(o.element),(n=n.createIterator()).enlargeBr=e.enlargeBr,n.enforceRealBlocks=e.enforceRealBlocks,n.activeFilter=n.filter=s,e._.nestedEditable={element:o.element,container:i,remaining:o.remaining,iterator:n},1):0}function n(e,t,n){return!!t&&((e=e.clone()).collapse(!n),e.checkBoundaryOfElement(t,n?CKEDITOR.START:CKEDITOR.END))}var i=/^[\r\n\t ]+$/,o=CKEDITOR.dom.walker.bookmark(!1,!0),s=CKEDITOR.dom.walker.whitespaces(!0),a=function(e){return o(e)&&s(e)},r={dd:1,dt:1,li:1};e.prototype={getNextParagraph:function(e){var s,l,c,d,u;if(e=e||"p",this._.nestedEditable){if(s=this._.nestedEditable.iterator.getNextParagraph(e))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,s;if(this.activeFilter=this.filter,t(this,e,this._.nestedEditable.container,this._.nestedEditable.remaining))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,this._.nestedEditable.iterator.getNextParagraph(e);this._.nestedEditable=null}if(!this.range.root.getDtd()[e])return null;if(!this._.started){var h=this.range.clone();l=h.startPath();var p=h.endPath(),m=!h.collapsed&&n(h,l.block),_=!h.collapsed&&n(h,p.block,1);h.shrink(CKEDITOR.SHRINK_ELEMENT,!0),m&&h.setStartAt(l.block,CKEDITOR.POSITION_BEFORE_END),_&&h.setEndAt(p.block,CKEDITOR.POSITION_AFTER_START),l=h.endContainer.hasAscendant("pre",!0)||h.startContainer.hasAscendant("pre",!0),h.enlarge(this.forceBrBreak&&!l||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS),h.collapsed||(l=new CKEDITOR.dom.walker(h.clone()),p=CKEDITOR.dom.walker.bookmark(!0,!0),l.evaluator=p,this._.nextNode=l.next(),(l=new CKEDITOR.dom.walker(h.clone())).evaluator=p,l=l.previous(),this._.lastNode=l.getNextSourceNode(!0,null,h.root),this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()&&((p=this.range.clone()).moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END),p.checkEndOfBlock()&&(p=new CKEDITOR.dom.elementPath(p.endContainer,p.root),this._.lastNode=(p.block||p.blockLimit).getNextSourceNode(!0))),this._.lastNode&&h.root.contains(this._.lastNode)||(this._.lastNode=this._.docEndMarker=h.document.createText(""),this._.lastNode.insertAfter(l)),h=null),this._.started=1,l=h}for(p=this._.nextNode,h=this._.lastNode,this._.nextNode=null;p;){m=0,_=p.hasAscendant("pre");var g=p.type!=CKEDITOR.NODE_ELEMENT,f=0;if(g)p.type==CKEDITOR.NODE_TEXT&&i.test(p.getText())&&(g=0);else{var b=p.getName();if(CKEDITOR.dtd.$block[b]&&"false"==p.getAttribute("contenteditable")){t(this,e,s=p);break}if(p.isBlockBoundary(this.forceBrBreak&&!_&&{br:1})){if("br"==b)g=1;else if(!l&&!p.getChildCount()&&"hr"!=b){s=p,c=p.equals(h);break}l&&(l.setEndAt(p,CKEDITOR.POSITION_BEFORE_START),"br"!=b&&(this._.nextNode=p)),m=1}else{if(p.getFirst()){l||(l=this.range.clone()).setStartAt(p,CKEDITOR.POSITION_BEFORE_START),p=p.getFirst();continue}g=1}}if(g&&!l&&(l=this.range.clone()).setStartAt(p,CKEDITOR.POSITION_BEFORE_START),c=(!m||g)&&p.equals(h),l&&!m)for(;!p.getNext(a)&&!c;){if((b=p.getParent()).isBlockBoundary(this.forceBrBreak&&!_&&{br:1})){m=1,g=0,c||b.equals(h),l.setEndAt(b,CKEDITOR.POSITION_BEFORE_END);break}g=1,c=(p=b).equals(h),f=1}if(g&&l.setEndAt(p,CKEDITOR.POSITION_AFTER_END),(c=!(p=this._getNextSourceNode(p,f,h)))||m&&l)break}if(!s){if(!l)return this._.docEndMarker&&this._.docEndMarker.remove(),this._.nextNode=null;p=(s=new CKEDITOR.dom.elementPath(l.startContainer,l.root)).blockLimit,m={div:1,th:1,td:1},!(s=s.block)&&p&&!this.enforceRealBlocks&&m[p.getName()]&&l.checkStartOfBlock()&&l.checkEndOfBlock()&&!p.equals(l.root)?s=p:!s||this.enforceRealBlocks&&s.is(r)?(s=this.range.document.createElement(e),l.extractContents().appendTo(s),s.trim(),l.insertNode(s),d=u=!0):"li"!=s.getName()?l.checkStartOfBlock()&&l.checkEndOfBlock()||(s=s.clone(!1),l.extractContents().appendTo(s),s.trim(),d=!(u=l.splitBlock()).wasStartOfBlock,u=!u.wasEndOfBlock,l.insertNode(s)):c||(this._.nextNode=s.equals(h)?null:this._getNextSourceNode(l.getBoundaryNodes().endNode,1,h))}return d&&(d=s.getPrevious())&&d.type==CKEDITOR.NODE_ELEMENT&&("br"==d.getName()?d.remove():d.getLast()&&"br"==d.getLast().$.nodeName.toLowerCase()&&d.getLast().remove()),u&&(d=s.getLast())&&d.type==CKEDITOR.NODE_ELEMENT&&"br"==d.getName()&&(!CKEDITOR.env.needsBrFiller||d.getPrevious(o)||d.getNext(o))&&d.remove(),this._.nextNode||(this._.nextNode=c||s.equals(h)||!h?null:this._getNextSourceNode(s,1,h)),s},_getNextSourceNode:function(e,t,n){function i(e){return!(e.equals(n)||e.equals(s))}var s=this.range.root;for(e=e.getNextSourceNode(t,null,i);!o(e);)e=e.getNextSourceNode(t,null,i);return e}},CKEDITOR.dom.range.prototype.createIterator=function(){return new e(this)}}(),CKEDITOR.command=function(e,t){var n;this.uiItems=[],this.exec=function(n){return!(this.state==CKEDITOR.TRISTATE_DISABLED||!this.checkAllowed())&&(this.editorFocus&&e.focus(),!1===this.fire("exec")||!1!==t.exec.call(this,e,n))},this.refresh=function(e,n){return!(this.readOnly||!e.readOnly)||(this.context&&!n.isContextFor(this.context)||!this.checkAllowed(!0)?(this.disable(),!0):(this.startDisabled||this.enable(),this.modes&&!this.modes[e.mode]&&this.disable(),!1===this.fire("refresh",{editor:e,path:n})||t.refresh&&!1!==t.refresh.apply(this,arguments)))},this.checkAllowed=function(t){return t||"boolean"!=typeof n?n=e.activeFilter.checkFeature(this):n},CKEDITOR.tools.extend(this,t,{modes:{wysiwyg:1},editorFocus:1,contextSensitive:!!t.context,state:CKEDITOR.TRISTATE_DISABLED}),CKEDITOR.event.call(this)},CKEDITOR.command.prototype={enable:function(){this.state==CKEDITOR.TRISTATE_DISABLED&&this.checkAllowed()&&this.setState(this.preserveState&&void 0!==this.previousState?this.previousState:CKEDITOR.TRISTATE_OFF)},disable:function(){this.setState(CKEDITOR.TRISTATE_DISABLED)},setState:function(e){return!(this.state==e||e!=CKEDITOR.TRISTATE_DISABLED&&!this.checkAllowed()||(this.previousState=this.state,this.state=e,this.fire("state"),0))},toggleState:function(){this.state==CKEDITOR.TRISTATE_OFF?this.setState(CKEDITOR.TRISTATE_ON):this.state==CKEDITOR.TRISTATE_ON&&this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.event.implementOn(CKEDITOR.command.prototype),CKEDITOR.ENTER_P=1,CKEDITOR.ENTER_BR=2,CKEDITOR.ENTER_DIV=3,CKEDITOR.config={customConfig:"config.js",autoUpdateElement:!0,language:"",defaultLanguage:"en",contentsLangDirection:"",enterMode:CKEDITOR.ENTER_P,forceEnterMode:!1,shiftEnterMode:CKEDITOR.ENTER_BR,docType:"<!DOCTYPE html>",bodyId:"",bodyClass:"",fullPage:!1,height:200,contentsCss:CKEDITOR.getUrl("contents.css"),extraPlugins:"",removePlugins:"",protectedSource:[],tabIndex:0,width:"",baseFloatZIndex:1e4,blockedKeystrokes:[CKEDITOR.CTRL+66,CKEDITOR.CTRL+73,CKEDITOR.CTRL+85]},function(){function e(e,t,n,i,o){var s,r,l;for(s in e=[],t){r="boolean"==typeof(r=t[s])?{}:"function"==typeof r?{match:r}:M(r),"$"!=s.charAt(0)&&(r.elements=s),n&&(r.featureName=n.toLowerCase());var c=r;c.elements=a(c.elements,/\s+/)||null,c.propertiesOnly=c.propertiesOnly||!0===c.elements;var d=/\s*,\s*/,u=void 0;for(u in N){c[u]=a(c[u],d)||null;var h=c,p=D[u],m=a(c[D[u]],d),g=c[u],f=[],b=!0,v=void 0;for(v in m?b=!1:m={},g)"!"==v.charAt(0)&&(v=v.slice(1),f.push(v),m[v]=!0,b=!1);for(;v=f.pop();)g[v]=g["!"+v],delete g["!"+v];h[p]=!b&&m||null}c.match=c.match||null,i.push(r),e.push(r)}for(t=o.elements,o=o.generic,n=0,i=e.length;n<i;++n){for(d in r=!0===(s=M(e[n])).classes||!0===s.styles||!0===s.attributes,c=s,u=p=d=void 0,N)c[d]=_(c[d]);for(u in h=!0,D){for(g in m=[],g=void 0,p=c[d=D[u]])-1<g.indexOf("*")?m.push(new RegExp("^"+g.replace(/\*/g,".*")+"$")):m.push(g);(p=m).length&&(c[d]=p,h=!1)}if(c.nothingRequired=h,c.noProperties=!(c.attributes||c.classes||c.styles),!0===s.elements||null===s.elements)o[r?"unshift":"push"](s);else for(l in c=s.elements,delete s.elements,c)t[l]?t[l][r?"unshift":"push"](s):t[l]=[s]}}function t(e,t,i,o){if((!e.match||e.match(t))&&(o||function(e,t){if(e.nothingRequired)return!0;var n,i,o,s;if(o=e.requiredClasses)for(s=t.classes,n=0;n<o.length;++n)if("string"==typeof(i=o[n])){if(-1==CKEDITOR.tools.indexOf(s,i))return!1}else if(!CKEDITOR.tools.checkIfAnyArrayItemMatches(s,i))return!1;return r(t.styles,e.requiredStyles)&&r(t.attributes,e.requiredAttributes)}(e,t))&&(e.propertiesOnly||(i.valid=!0),i.allAttributes||(i.allAttributes=n(e.attributes,t.attributes,i.validAttributes)),i.allStyles||(i.allStyles=n(e.styles,t.styles,i.validStyles)),!i.allClasses)){if(e=e.classes,t=t.classes,o=i.validClasses,e)if(!0===e)e=!0;else{for(var s,a=0,l=t.length;a<l;++a)o[s=t[a]]||(o[s]=e(s));e=!1}else e=!1;i.allClasses=e}}function n(e,t,n){if(!e)return!1;if(!0===e)return!0;for(var i in t)n[i]||(n[i]=e(i));return!1}function i(e,t,n){if(!e.match||e.match(t)){if(e.noProperties)return!1;if(n.hadInvalidAttribute=o(e.attributes,t.attributes)||n.hadInvalidAttribute,n.hadInvalidStyle=o(e.styles,t.styles)||n.hadInvalidStyle,e=e.classes,t=t.classes,e){for(var i=!1,s=!0===e,a=t.length;a--;)(s||e(t[a]))&&(t.splice(a,1),i=!0);e=i}else e=!1;n.hadInvalidClass=e||n.hadInvalidClass}}function o(e,t){if(!e)return!1;var n,i=!1,o=!0===e;for(n in t)(o||e(n))&&(delete t[n],i=!0);return i}function s(e,t,n){return!(e.disabled||e.customConfig&&!n||!t||(e._.cachedChecks={},0))}function a(e,t){if(!e)return!1;if(!0===e)return e;if("string"==typeof e)return"*"==(e=I(e))||CKEDITOR.tools.convertArrayToObject(e.split(t));if(CKEDITOR.tools.isArray(e))return!!e.length&&CKEDITOR.tools.convertArrayToObject(e);var n,i={},o=0;for(n in e)i[n]=e[n],o++;return!!o&&i}function r(e,t){if(!t)return!0;for(var n,i=0;i<t.length;++i)if("string"==typeof(n=t[i])){if(!(n in e))return!1}else if(!CKEDITOR.tools.checkIfAnyObjectPropertyMatches(e,n))return!1;return!0}function l(e){if(!e)return{};e=e.split(/\s*,\s*/).sort();for(var t={};e.length;)t[e.shift()]="cke-test";return t}function c(e){var t,n,i,o,s={},a=1;for(e=I(e);t=e.match(L);)(n=t[2])?(i=d(n,"styles"),o=d(n,"attrs"),n=d(n,"classes")):i=o=n=null,s["$"+a++]={elements:t[1],classes:n,styles:i,attributes:o},e=e.slice(t[0].length);return s}function d(e,t){var n=e.match(O[t]);return n?I(n[1]):null}function u(e){var t=e.styleBackup=e.attributes.style,n=e.classBackup=e.attributes.class;e.styles||(e.styles=CKEDITOR.tools.parseCssText(t||"",1)),e.classes||(e.classes=n?n.split(/\s+/):[])}function h(e,n,o,s){var a,r=0;if(s.toHtml&&(n.name=n.name.replace(P,"$1")),s.doCallbacks&&e.elementCallbacks){e:{for(var l,c=0,d=(a=e.elementCallbacks).length;c<d;++c)if(l=a[c](n)){a=l;break e}a=void 0}if(a)return a}if(s.doTransform&&(a=e._.transformations[n.name])){for(u(n),c=0;c<a.length;++c)v(e,n,a[c]);p(n)}if(s.doFilter){e:{c=n.name,e=(d=e._).allowedRules.elements[c],a=d.allowedRules.generic,c=d.disallowedRules.elements[c],d=d.disallowedRules.generic,l=s.skipRequired;var h,_,g={valid:!1,validAttributes:{},validClasses:{},validStyles:{},allAttributes:!1,allClasses:!1,allStyles:!1,hadInvalidAttribute:!1,hadInvalidClass:!1,hadInvalidStyle:!1};if(e||a){if(u(n),c)for(h=0,_=c.length;h<_;++h)if(!1===i(c[h],n,g)){e=null;break e}if(d)for(h=0,_=d.length;h<_;++h)i(d[h],n,g);if(e)for(h=0,_=e.length;h<_;++h)t(e[h],n,g,l);if(a)for(h=0,_=a.length;h<_;++h)t(a[h],n,g,l);e=g}else e=null}if(!e||!e.valid)return o.push(n),1;_=e.validAttributes;var f=e.validStyles;a=e.validClasses,c=n.attributes;var b=n.styles;d=n.classes,l=n.classBackup;var A,E,T=n.styleBackup,C=[],y=(g=[],/^data-cke-/);if(h=!1,delete c.style,delete c.class,delete n.classBackup,delete n.styleBackup,!e.allAttributes)for(A in c)_[A]||y.test(A)&&(A==(E=A.replace(/^data-cke-saved-/,""))||_[E])||(delete c[A],h=!0);if(!e.allStyles||e.hadInvalidStyle){for(A in b)e.allStyles||f[A]?C.push(A+":"+b[A]):h=!0;C.length&&(c.style=C.sort().join("; "))}else T&&(c.style=T);if(!e.allClasses||e.hadInvalidClass){for(A=0;A<d.length;++A)(e.allClasses||a[d[A]])&&g.push(d[A]);g.length&&(c.class=g.sort().join(" ")),l&&g.length<l.split(/\s+/).length&&(h=!0)}else l&&(c.class=l);if(h&&(r=1),!s.skipFinalValidation&&!m(n))return o.push(n),1}return s.toHtml&&(n.name=n.name.replace(x,"cke:$1")),r}function p(e){var t,n=e.attributes;delete n.style,delete n.class,(t=CKEDITOR.tools.writeCssText(e.styles,!0))&&(n.style=t),e.classes.length&&(n.class=e.classes.sort().join(" "))}function m(e){switch(e.name){case"a":if(!(e.children.length||e.attributes.name||e.attributes.id))return!1;break;case"img":if(!e.attributes.src)return!1}return!0}function _(e){if(!e)return!1;if(!0===e)return!0;var t=function(e){var t,n=[];for(t in e)-1<t.indexOf("*")&&n.push(t.replace(/\*/g,".*"));return n.length?new RegExp("^(?:"+n.join("|")+")$"):null}(e);return function(n){return n in e||t&&n.match(t)}}function g(){return new CKEDITOR.htmlParser.element("br")}function f(e){return e.type==CKEDITOR.NODE_ELEMENT&&("br"==e.name||y.$block[e.name])}function b(e,t,n){var i=e.name;if(y.$empty[i]||!e.children.length)"hr"==i&&"br"==t?e.replaceWith(g()):(e.parent&&n.push({check:"it",el:e.parent}),e.remove());else if(y.$block[i]||"tr"==i)if("br"==t)e.previous&&!f(e.previous)&&(t=g()).insertBefore(e),e.next&&!f(e.next)&&(t=g()).insertAfter(e),e.replaceWithChildren();else{var o;i=e.children;e:{o=y[t];for(var s,a=0,r=i.length;a<r;++a)if((s=i[a]).type==CKEDITOR.NODE_ELEMENT&&!o[s.name]){o=!1;break e}o=!0}if(o)e.name=t,e.attributes={},n.push({check:"parent-down",el:e});else{var l,c;for(a=(o=e.parent).type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||"body"==o.name,r=i.length;0<r;)s=i[--r],a&&(s.type==CKEDITOR.NODE_TEXT||s.type==CKEDITOR.NODE_ELEMENT&&y.$inline[s.name])?(l||((l=new CKEDITOR.htmlParser.element(t)).insertAfter(e),n.push({check:"parent-down",el:l})),l.add(s,0)):(l=null,c=y[o.name]||y.span,s.insertAfter(e),o.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||s.type!=CKEDITOR.NODE_ELEMENT||c[s.name]||n.push({check:"el-up",el:s}));e.remove()}}else i in{style:1,script:1}?e.remove():(e.parent&&n.push({check:"it",el:e.parent}),e.replaceWithChildren())}function v(e,t,n){var i,o;for(i=0;i<n.length;++i)if(!((o=n[i]).check&&!e.check(o.check,!1)||o.left&&!o.left(t))){o.right(t,w);break}}function A(e,t){var n,i,o,s,a=t.getDefinition(),r=a.attributes,l=a.styles;if(e.name!=a.element)return!1;for(n in r)if("class"==n){for(a=r[n].split(/\s+/),o=e.classes.join("|");s=a.pop();)if(-1==o.indexOf(s))return!1}else if(e.attributes[n]!=r[n])return!1;for(i in l)if(e.styles[i]!=l[i])return!1;return!0}function E(e,t){var n,i;return"string"==typeof e?n=e:e instanceof CKEDITOR.style?i=e:(n=e[0],i=e[1]),[{element:n,left:i,right:function(e,n){n.transform(e,t)}}]}function T(e){return function(t){return A(t,e)}}function C(e){return function(t,n){n[e](t)}}var y=CKEDITOR.dtd,M=CKEDITOR.tools.copy,I=CKEDITOR.tools.trim,S=["","p","br","div"];CKEDITOR.FILTER_SKIP_TREE=2,CKEDITOR.filter=function(e){if(this.allowedContent=[],this.disallowedContent=[],this.elementCallbacks=null,this.disabled=!1,this.editor=null,this.id=CKEDITOR.tools.getNextNumber(),this._={allowedRules:{elements:{},generic:[]},disallowedRules:{elements:{},generic:[]},transformations:{},cachedTests:{}},CKEDITOR.filter.instances[this.id]=this,e instanceof CKEDITOR.editor){e=this.editor=e,this.customConfig=!0;var t=e.config.allowedContent;!0===t?this.disabled=!0:(t||(this.customConfig=!1),this.allow(t,"config",1),this.allow(e.config.extraAllowedContent,"extra",1),this.allow(S[e.enterMode]+" "+S[e.shiftEnterMode],"default",1),this.disallow(e.config.disallowedContent))}else this.customConfig=!1,this.allow(e,"default",1)},CKEDITOR.filter.instances={},CKEDITOR.filter.prototype={allow:function(t,n,i){if(!s(this,t,i))return!1;var o,a;if("string"==typeof t)t=c(t);else if(t instanceof CKEDITOR.style){if(t.toAllowedContentRules)return this.allow(t.toAllowedContentRules(this.editor),n,i);o=t.getDefinition(),t={},i=o.attributes,t[o.element]=o={styles:o.styles,requiredStyles:o.styles&&CKEDITOR.tools.objectKeys(o.styles)},i&&(i=M(i),o.classes=i.class?i.class.split(/\s+/):null,o.requiredClasses=o.classes,delete i.class,o.attributes=i,o.requiredAttributes=i&&CKEDITOR.tools.objectKeys(i))}else if(CKEDITOR.tools.isArray(t)){for(o=0;o<t.length;++o)a=this.allow(t[o],n,i);return a}return e(this,t,n,this.allowedContent,this._.allowedRules),!0},applyTo:function(e,t,n,i){if(this.disabled)return!1;var o,s,a,r=this,l=[],c=this.editor&&this.editor.config.protectedSource,d=!1,u={doFilter:!n,doTransform:!0,doCallbacks:!0,toHtml:t};for(e.forEach((function(e){if(e.type==CKEDITOR.NODE_ELEMENT){if("off"==e.attributes["data-cke-filter"])return!1;if(!t||"span"!=e.name||!~CKEDITOR.tools.objectKeys(e.attributes).join("|").indexOf("data-cke-"))if(1&(o=h(r,e,l,u)))d=!0;else if(2&o)return!1}else if(e.type==CKEDITOR.NODE_COMMENT&&e.value.match(/^\{cke_protected\}(?!\{C\})/)){var n;e:{var i,s,a,p=decodeURIComponent(e.value.replace(/^\{cke_protected\}/,""));if(n=[],c)for(s=0;s<c.length;++s)if((a=p.match(c[s]))&&a[0].length==p.length){n=!0;break e}1==(p=CKEDITOR.htmlParser.fragment.fromHtml(p)).children.length&&(i=p.children[0]).type==CKEDITOR.NODE_ELEMENT&&h(r,i,n,u),n=!n.length}n||l.push(e)}}),null,!0),l.length&&(d=!0),e=[],i=S[i||(this.editor?this.editor.enterMode:CKEDITOR.ENTER_P)];n=l.pop();)n.type==CKEDITOR.NODE_ELEMENT?b(n,i,e):n.remove();for(;s=e.pop();)if((n=s.el).parent)switch(a=y[n.parent.name]||y.span,s.check){case"it":y.$removeEmpty[n.name]&&!n.children.length?b(n,i,e):m(n)||b(n,i,e);break;case"el-up":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||a[n.name]||b(n,i,e);break;case"parent-down":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||a[n.name]||b(n.parent,i,e)}return d},checkFeature:function(e){return!(!this.disabled&&e)||(e.toFeature&&(e=e.toFeature(this.editor)),!e.requiredContent||this.check(e.requiredContent))},disable:function(){this.disabled=!0},disallow:function(t){return!!s(this,t,!0)&&("string"==typeof t&&(t=c(t)),e(this,t,null,this.disallowedContent,this._.disallowedRules),!0)},addContentForms:function(e){if(!this.disabled&&e){var t,n,i,o=[];for(t=0;t<e.length&&!i;++t)("string"==typeof(n=e[t])||n instanceof CKEDITOR.style)&&this.check(n)&&(i=n);if(i){for(t=0;t<e.length;++t)o.push(E(e[t],i));this.addTransformations(o)}}},addElementCallback:function(e){this.elementCallbacks||(this.elementCallbacks=[]),this.elementCallbacks.push(e)},addFeature:function(e){return!(!this.disabled&&e)||(e.toFeature&&(e=e.toFeature(this.editor)),this.allow(e.allowedContent,e.name),this.addTransformations(e.contentTransformations),this.addContentForms(e.contentForms),!e.requiredContent||!this.customConfig&&!this.disallowedContent.length||this.check(e.requiredContent))},addTransformations:function(e){var t,n;if(!this.disabled&&e){var i,o=this._.transformations;for(i=0;i<e.length;++i){t=e[i];var s=void 0,a=void 0,r=void 0,l=void 0,c=void 0,d=void 0;for(n=[],a=0;a<t.length;++a)"string"==typeof(r=t[a])?(l=(r=r.split(/\s*:\s*/))[0],c=null,d=r[1]):(l=r.check,c=r.left,d=r.right),s||(s=(s=r).element?s.element:l?l.match(/^([a-z0-9]+)/i)[0]:s.left.getDefinition().element),c instanceof CKEDITOR.style&&(c=T(c)),n.push({check:l==s?null:l,left:c,right:"string"==typeof d?C(d):d});o[t=s]||(o[t]=[]),o[t].push(n)}}},check:function(e,t,n){if(this.disabled)return!0;if(CKEDITOR.tools.isArray(e)){for(var i=e.length;i--;)if(this.check(e[i],t,n))return!0;return!1}var o,s;if("string"==typeof e){if((s=e+"<"+(!1===t?"0":"1")+(n?"1":"0")+">")in this._.cachedChecks)return this._.cachedChecks[s];o=(i=c(e).$1).styles;var a=i.classes;i.name=i.elements,i.classes=a=a?a.split(/\s*,\s*/):[],i.styles=l(o),i.attributes=l(i.attributes),i.children=[],a.length&&(i.attributes.class=a.join(" ")),o&&(i.attributes.style=CKEDITOR.tools.writeCssText(i.styles)),o=i}else o=(i=e.getDefinition()).styles,a=i.attributes||{},o&&!CKEDITOR.tools.isEmpty(o)?(o=M(o),a.style=CKEDITOR.tools.writeCssText(o,!0)):o={},o={name:i.element,attributes:a,classes:a.class?a.class.split(/\s+/):[],styles:o,children:[]};a=CKEDITOR.tools.clone(o);var r,d=[];if(!1!==t&&(r=this._.transformations[o.name])){for(i=0;i<r.length;++i)v(this,o,r[i]);p(o)}return h(this,a,d,{doFilter:!0,doTransform:!1!==t,skipRequired:!n,skipFinalValidation:!n}),t=!(0<d.length||!CKEDITOR.tools.objectCompare(o.attributes,a.attributes,!0)),"string"==typeof e&&(this._.cachedChecks[s]=t),t},getAllowedEnterMode:function(){var e=["p","div","br"],t={p:CKEDITOR.ENTER_P,div:CKEDITOR.ENTER_DIV,br:CKEDITOR.ENTER_BR};return function(n,i){var o,s=e.slice();if(this.check(S[n]))return n;for(i||(s=s.reverse());o=s.pop();)if(this.check(o))return t[o];return CKEDITOR.ENTER_BR}}(),destroy:function(){delete CKEDITOR.filter.instances[this.id],delete this._,delete this.allowedContent,delete this.disallowedContent}};var w,N={styles:1,attributes:1,classes:1},D={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},L=/^([a-z0-9\-*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,O={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,classes:/\(([^\)]+)\)/},P=/^cke:(object|embed|param)$/,x=/^(object|embed|param)$/;w=CKEDITOR.filter.transformationsTools={sizeToStyle:function(e){this.lengthToStyle(e,"width"),this.lengthToStyle(e,"height")},sizeToAttribute:function(e){this.lengthToAttribute(e,"width"),this.lengthToAttribute(e,"height")},lengthToStyle:function(e,t,n){if(!((n=n||t)in e.styles)){var i=e.attributes[t];i&&(/^\d+$/.test(i)&&(i+="px"),e.styles[n]=i)}delete e.attributes[t]},lengthToAttribute:function(e,t,n){if(!((n=n||t)in e.attributes)){var i=e.styles[t],o=i&&i.match(/^(\d+)(?:\.\d*)?px$/);o?e.attributes[n]=o[1]:"cke-test"==i&&(e.attributes[n]="cke-test")}delete e.styles[t]},alignmentToStyle:function(e){if(!("float"in e.styles)){var t=e.attributes.align;"left"!=t&&"right"!=t||(e.styles.float=t)}delete e.attributes.align},alignmentToAttribute:function(e){if(!("align"in e.attributes)){var t=e.styles.float;"left"!=t&&"right"!=t||(e.attributes.align=t)}delete e.styles.float},matchesStyle:A,transform:function(e,t){if("string"==typeof t)e.name=t;else{var n,i,o,s,a=t.getDefinition(),r=a.styles,l=a.attributes;for(n in e.name=a.element,l)if("class"==n)for(a=e.classes.join("|"),o=l[n].split(/\s+/);s=o.pop();)-1==a.indexOf(s)&&e.classes.push(s);else e.attributes[n]=l[n];for(i in r)e.styles[i]=r[i]}}}}(),CKEDITOR.focusManager=function(e){return e.focusManager?e.focusManager:(this.hasFocus=!1,this.currentActive=null,this._={editor:e},this)},CKEDITOR.focusManager._={blurDelay:200},CKEDITOR.focusManager.prototype={focus:function(e){this._.timer&&clearTimeout(this._.timer),e&&(this.currentActive=e),this.hasFocus||this._.locked||((e=CKEDITOR.currentInstance)&&e.focusManager.blur(1),this.hasFocus=!0,(e=this._.editor.container)&&e.addClass("cke_focus"),this._.editor.fire("focus"))},lock:function(){this._.locked=1},unlock:function(){delete this._.locked},blur:function(e){function t(){if(this.hasFocus){this.hasFocus=!1;var e=this._.editor.container;e&&e.removeClass("cke_focus"),this._.editor.fire("blur")}}if(!this._.locked){this._.timer&&clearTimeout(this._.timer);var n=CKEDITOR.focusManager._.blurDelay;e||!n?t.call(this):this._.timer=CKEDITOR.tools.setTimeout((function(){delete this._.timer,t.call(this)}),n,this)}},add:function(e,t){if(!(n=e.getCustomData("focusmanager"))||n!=this){n&&n.remove(e);var n="focus",i="blur";t&&(CKEDITOR.env.ie?(n="focusin",i="focusout"):CKEDITOR.event.useCapture=1);var o={blur:function(){e.equals(this.currentActive)&&this.blur()},focus:function(){this.focus(e)}};e.on(n,o.focus,this),e.on(i,o.blur,this),t&&(CKEDITOR.event.useCapture=0),e.setCustomData("focusmanager",this),e.setCustomData("focusmanager_handlers",o)}},remove:function(e){e.removeCustomData("focusmanager");var t=e.removeCustomData("focusmanager_handlers");e.removeListener("blur",t.blur),e.removeListener("focus",t.focus)}},CKEDITOR.keystrokeHandler=function(e){return e.keystrokeHandler?e.keystrokeHandler:(this.keystrokes={},this.blockedKeystrokes={},this._={editor:e},this)},function(){var e,t=function(t){var n=(t=t.data).getKeystroke(),i=this.keystrokes[n],o=this._.editor;return(e=!1===o.fire("key",{keyCode:n,domEvent:t}))||(i&&(e=!1!==o.execCommand(i,{from:"keystrokeHandler"})),e||(e=!!this.blockedKeystrokes[n])),e&&t.preventDefault(!0),!e},n=function(t){e&&(e=!1,t.data.preventDefault(!0))};CKEDITOR.keystrokeHandler.prototype={attach:function(e){e.on("keydown",t,this),CKEDITOR.env.gecko&&CKEDITOR.env.mac&&e.on("keypress",n,this)}}}(),CKEDITOR.lang={languages:{af:1,ar:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,en:1,eo:1,es:1,et:1,eu:1,fa:1,fi:1,fo:1,"fr-ca":1,fr:1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,ja:1,ka:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,ms:1,nb:1,nl:1,no:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,"sr-latn":1,sr:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,"zh-cn":1,zh:1},rtl:{ar:1,fa:1,he:1,ku:1,ug:1},load:function(e,t,n){e&&CKEDITOR.lang.languages[e]||(e=this.detect(t,e));var i=this;t=function(){i[e].dir=i.rtl[e]?"rtl":"ltr",n(e,i[e])},this[e]?t():CKEDITOR.scriptLoader.load(CKEDITOR.getUrl("lang/"+e+".js"),t,this)},detect:function(e,t){var n=this.languages,i=(o=(t=t||navigator.userLanguage||navigator.language||e).toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/))[1],o=o[2];return n[i+"-"+o]?i=i+"-"+o:n[i]||(i=null),CKEDITOR.lang.detect=i?function(){return i}:function(e){return e},i||e}},CKEDITOR.scriptLoader=function(){var e={},t={};return{load:function(n,i,o,s){var a="string"==typeof n;a&&(n=[n]),o||(o=CKEDITOR);var r=n.length,l=[],c=[],d=function(e){i&&(a?i.call(o,e):i.call(o,l,c))};if(0===r)d(!0);else{var u=function(e,t){(t?l:c).push(e),0>=--r&&(s&&CKEDITOR.document.getDocumentElement().removeStyle("cursor"),d(t))},h=function(n,i){e[n]=1;var o=t[n];delete t[n];for(var s=0;s<o.length;s++)o[s](n,i)},p=function(n){if(e[n])u(n,!0);else{var o=t[n]||(t[n]=[]);if(o.push(u),!(1<o.length)){var s=new CKEDITOR.dom.element("script");s.setAttributes({type:"text/javascript",src:n}),i&&(CKEDITOR.env.ie&&11>CKEDITOR.env.version?s.$.onreadystatechange=function(){"loaded"!=s.$.readyState&&"complete"!=s.$.readyState||(s.$.onreadystatechange=null,h(n,!0))}:(s.$.onload=function(){setTimeout((function(){h(n,!0)}),0)},s.$.onerror=function(){h(n,!1)})),s.appendTo(CKEDITOR.document.getHead())}}};s&&CKEDITOR.document.getDocumentElement().setStyle("cursor","wait");for(var m=0;m<r;m++)p(n[m])}},queue:function(){function e(){var e;(e=t[0])&&this.load(e.scriptUrl,e.callback,CKEDITOR,0)}var t=[];return function(n,i){var o=this;t.push({scriptUrl:n,callback:function(){i&&i.apply(this,arguments),t.shift(),e.call(o)}}),1==t.length&&e.call(this)}}()}}(),CKEDITOR.resourceManager=function(e,t){this.basePath=e,this.fileName=t,this.registered={},this.loaded={},this.externals={},this._={waitingList:{}}},CKEDITOR.resourceManager.prototype={add:function(e,t){if(this.registered[e])throw Error('[CKEDITOR.resourceManager.add] The resource name "'+e+'" is already registered.');var n=this.registered[e]=t||{};return n.name=e,n.path=this.getPath(e),CKEDITOR.fire(e+CKEDITOR.tools.capitalize(this.fileName)+"Ready",n),this.get(e)},get:function(e){return this.registered[e]||null},getPath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(t&&t.dir||this.basePath+e+"/")},getFilePath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(this.getPath(e)+(t?t.file:this.fileName+".js"))},addExternal:function(e,t,n){e=e.split(",");for(var i=0;i<e.length;i++){var o=e[i];n||(t=t.replace(/[^\/]+$/,(function(e){return n=e,""}))),this.externals[o]={dir:t,file:n||this.fileName+".js"}}},load:function(e,t,n){CKEDITOR.tools.isArray(e)||(e=e?[e]:[]);for(var i=this.loaded,o=this.registered,s=[],a={},r={},l=0;l<e.length;l++){var c=e[l];if(c)if(i[c]||o[c])r[c]=this.get(c);else{var d=this.getFilePath(c);s.push(d),d in a||(a[d]=[]),a[d].push(c)}}CKEDITOR.scriptLoader.load(s,(function(e,o){if(o.length)throw Error('[CKEDITOR.resourceManager.load] Resource name "'+a[o[0]].join(",")+'" was not found at "'+o[0]+'".');for(var s=0;s<e.length;s++)for(var l=a[e[s]],c=0;c<l.length;c++){var d=l[c];r[d]=this.get(d),i[d]=1}t.call(n,r)}),this)}},CKEDITOR.plugins=new CKEDITOR.resourceManager("plugins/","plugin"),CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,(function(e){var t={};return function(n,i,o){var s={},a=function(n){e.call(this,n,(function(e){CKEDITOR.tools.extend(s,e);var n,r=[];for(n in e){var l=e[n],c=l&&l.requires;if(!t[n]){if(l.icons)for(var d=l.icons.split(","),u=d.length;u--;)CKEDITOR.skin.addIcon(d[u],l.path+"icons/"+(CKEDITOR.env.hidpi&&l.hidpi?"hidpi/":"")+d[u]+".png");t[n]=1}if(c)for(c.split&&(c=c.split(",")),l=0;l<c.length;l++)s[c[l]]||r.push(c[l])}if(r.length)a.call(this,r);else{for(n in s)(l=s[n]).onLoad&&!l.onLoad._called&&(!1===l.onLoad()&&delete s[n],l.onLoad._called=1);i&&i.call(o||window,s)}}),this)};a.call(this,n)}})),CKEDITOR.plugins.setLang=function(e,t,n){var i=this.get(e);e=i.langEntries||(i.langEntries={}),(i=i.lang||(i.lang=[])).split&&(i=i.split(",")),-1==CKEDITOR.tools.indexOf(i,t)&&i.push(t),e[t]=n},CKEDITOR.ui=function(e){return e.ui?e.ui:(this.items={},this.instances={},this.editor=e,this._={handlers:{}},this)},CKEDITOR.ui.prototype={add:function(e,t,n){n.name=e.toLowerCase();var i=this.items[e]={type:t,command:n.command||null,args:Array.prototype.slice.call(arguments,2)};CKEDITOR.tools.extend(i,n)},get:function(e){return this.instances[e]},create:function(e){var t=this.items[e],n=t&&this._.handlers[t.type],i=t&&t.command&&this.editor.getCommand(t.command);return n=n&&n.create.apply(this,t.args),this.instances[e]=n,i&&i.uiItems.push(n),n&&!n.type&&(n.type=t.type),n},addHandler:function(e,t){this._.handlers[e]=t},space:function(e){return CKEDITOR.document.getById(this.spaceId(e))},spaceId:function(e){return this.editor.id+"_"+e}},CKEDITOR.event.implementOn(CKEDITOR.ui),function(){function e(e,n,o){if(CKEDITOR.event.call(this),e=e&&CKEDITOR.tools.clone(e),void 0!==n){if(!(n instanceof CKEDITOR.dom.element))throw Error("Expect element of type CKEDITOR.dom.element.");if(!o)throw Error("One of the element modes must be specified.");if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&o==CKEDITOR.ELEMENT_MODE_INLINE)throw Error("Inline element mode is not supported on IE quirks.");if(!function(e,t){return t==CKEDITOR.ELEMENT_MODE_INLINE?e.is(CKEDITOR.dtd.$editable)||e.is("textarea"):t==CKEDITOR.ELEMENT_MODE_REPLACE?!e.is(CKEDITOR.dtd.$nonBodyContent):1}(n,o))throw Error('The specified element mode is not supported on element: "'+n.getName()+'".');this.element=n,this.elementMode=o,this.name=this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO&&(n.getId()||n.getNameAtt())}else this.elementMode=CKEDITOR.ELEMENT_MODE_NONE;this._={},this.commands={},this.templates={},this.name=this.name||function(){do{var e="editor"+ ++s}while(CKEDITOR.instances[e]);return e}(),this.id=CKEDITOR.tools.getNextId(),this.status="unloaded",this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config),this.ui=new CKEDITOR.ui(this),this.focusManager=new CKEDITOR.focusManager(this),this.keystrokeHandler=new CKEDITOR.keystrokeHandler(this),this.on("readOnly",t),this.on("selectionChange",(function(e){i(this,e.data.path)})),this.on("activeFilterChange",(function(){i(this,this.elementPath(),!0)})),this.on("mode",t),this.on("instanceReady",(function(){this.config.startupFocus&&this.focus()})),CKEDITOR.fire("instanceCreated",null,this),CKEDITOR.add(this),CKEDITOR.tools.setTimeout((function(){"destroyed"!==this.status?function(e,t){e.on("customConfigLoaded",(function(){if(t){if(t.on)for(var n in t.on)e.on(n,t.on[n]);CKEDITOR.tools.extend(e.config,t,!0),delete e.config.on}n=e.config,e.readOnly=!!n.readOnly||(e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.is("textarea")?e.element.hasAttribute("disabled")||e.element.hasAttribute("readonly"):e.element.isReadOnly():e.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.element.hasAttribute("disabled")||e.element.hasAttribute("readonly"))),e.blockless=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&!(e.element.is("textarea")||CKEDITOR.dtd[e.element.getName()].p),e.tabIndex=n.tabIndex||e.element&&e.element.getAttribute("tabindex")||0,e.activeEnterMode=e.enterMode=e.blockless?CKEDITOR.ENTER_BR:n.enterMode,e.activeShiftEnterMode=e.shiftEnterMode=e.blockless?CKEDITOR.ENTER_BR:n.shiftEnterMode,n.skin&&(CKEDITOR.skinName=n.skin),e.fireOnce("configLoaded"),e.dataProcessor=new CKEDITOR.htmlDataProcessor(e),e.filter=e.activeFilter=new CKEDITOR.filter(e),function(e){CKEDITOR.skin.loadPart("editor",(function(){!function(e){CKEDITOR.lang.load(e.config.language,e.config.defaultLanguage,(function(t,n){var i=e.config.title;e.langCode=t,e.lang=CKEDITOR.tools.prototypedCopy(n),e.title="string"==typeof i||!1===i?i:[e.lang.editor,e.name].join(", "),e.config.contentsLangDirection||(e.config.contentsLangDirection=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.getDirection(1):e.lang.dir),e.fire("langLoaded"),function(e){e.getStylesSet((function(t){e.once("loaded",(function(){e.fire("stylesSet",{styles:t})}),null,null,1),function(e){var t=e.config,n=t.plugins,i=t.extraPlugins,o=t.removePlugins;if(i){var s=new RegExp("(?:^|,)(?:"+i.replace(/\s*,\s*/g,"|")+")(?=,|$)","g");n=(n=n.replace(s,""))+","+i}if(o){var a=new RegExp("(?:^|,)(?:"+o.replace(/\s*,\s*/g,"|")+")(?=,|$)","g");n=n.replace(a,"")}CKEDITOR.env.air&&(n+=",adobeair"),CKEDITOR.plugins.load(n.split(","),(function(n){var i=[],o=[],s=[];for(var r in e.plugins=n,n){var l,c=n[r],d=c.lang,u=null,h=c.requires;if(CKEDITOR.tools.isArray(h)&&(h=h.join(",")),h&&(l=h.match(a)))for(;h=l.pop();)CKEDITOR.error("editor-plugin-required",{plugin:h.replace(",",""),requiredBy:r});d&&!e.lang[r]&&(d.split&&(d=d.split(",")),u=0<=CKEDITOR.tools.indexOf(d,e.langCode)?e.langCode:(u=e.langCode.replace(/-.*/,""))!=e.langCode&&0<=CKEDITOR.tools.indexOf(d,u)?u:0<=CKEDITOR.tools.indexOf(d,"en")?"en":d[0],c.langEntries&&c.langEntries[u]?(e.lang[r]=c.langEntries[u],u=null):s.push(CKEDITOR.getUrl(c.path+"lang/"+u+".js"))),o.push(u),i.push(c)}CKEDITOR.scriptLoader.load(s,(function(){for(var n=["beforeInit","init","afterInit"],s=0;s<n.length;s++)for(var a=0;a<i.length;a++){var r=i[a];0===s&&o[a]&&r.lang&&r.langEntries&&(e.lang[r.name]=r.langEntries[o[a]]),r[n[s]]&&r[n[s]](e)}for(e.fireOnce("pluginsLoaded"),t.keystrokes&&e.setKeystroke(e.config.keystrokes),a=0;a<e.config.blockedKeystrokes.length;a++)e.keystrokeHandler.blockedKeystrokes[e.config.blockedKeystrokes[a]]=1;e.status="loaded",e.fireOnce("loaded"),CKEDITOR.fire("instanceLoaded",null,e)}))}))}(e)}))}(e)}))}(e)}))}(e)})),t&&null!=t.customConfig&&(e.config.customConfig=t.customConfig),function e(t){if(!(n=t.config.customConfig))return!1;var n=CKEDITOR.getUrl(n),i=a[n]||(a[n]={});return i.fn?(i.fn.call(t,t.config),CKEDITOR.getUrl(t.config.customConfig)!=n&&e(t)||t.fireOnce("customConfigLoaded")):CKEDITOR.scriptLoader.queue(n,(function(){i.fn=CKEDITOR.editorConfig?CKEDITOR.editorConfig:function(){},e(t)})),!0}(e)||e.fireOnce("customConfigLoaded")}(this,e):CKEDITOR.warn("editor-incorrect-destroy")}),0,this)}function t(){var e,t=this.commands;for(e in t)n(this,t[e])}function n(e,t){t[t.startDisabled||e.readOnly&&!t.readOnly?"disable":t.modes[e.mode]?"enable":"disable"]()}function i(e,t,n){if(t){var i,o,s=e.commands;for(o in s)i=s[o],(n||i.contextSensitive)&&i.refresh(e,t)}}function o(){var e=this.element;if(e&&this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO){var t=this.getData();return this.config.htmlEncodeOutput&&(t=CKEDITOR.tools.htmlEncode(t)),e.is("textarea")?e.setValue(t):e.setHtml(t),!0}return!1}e.prototype=CKEDITOR.editor.prototype,CKEDITOR.editor=e;var s=0,a={};CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{addCommand:function(e,t){t.name=e.toLowerCase();var i=new CKEDITOR.command(this,t);return this.mode&&n(this,i),this.commands[e]=i},_attachToForm:function(){function e(e){t.updateElement(),t._.required&&!n.getValue()&&!1===t.fire("required")&&e.data.preventDefault()}var t=this,n=t.element,i=new CKEDITOR.dom.element(n.$.form);n.is("textarea")&&i&&(i.on("submit",e),function(e){return!!(e&&e.call&&e.apply)}(i.$.submit)&&(i.$.submit=CKEDITOR.tools.override(i.$.submit,(function(t){return function(){e(),t.apply?t.apply(this):t()}}))),t.on("destroy",(function(){i.removeListener("submit",e)})))},destroy:function(e){this.fire("beforeDestroy"),!e&&o.call(this),this.editable(null),this.filter&&(this.filter.destroy(),delete this.filter),delete this.activeFilter,this.status="destroyed",this.fire("destroy"),this.removeAllListeners(),CKEDITOR.remove(this),CKEDITOR.fire("instanceDestroyed",null,this)},elementPath:function(e){if(!e){if(!(e=this.getSelection()))return null;e=e.getStartElement()}return e?new CKEDITOR.dom.elementPath(e,this.editable()):null},createRange:function(){var e=this.editable();return e?new CKEDITOR.dom.range(e):null},execCommand:function(e,t){var n=this.getCommand(e),i={name:e,commandData:t,command:n};return!(!n||n.state==CKEDITOR.TRISTATE_DISABLED||!1===this.fire("beforeCommandExec",i)||(i.returnValue=n.exec(i.commandData),n.async||!1===this.fire("afterCommandExec",i)))&&i.returnValue},getCommand:function(e){return this.commands[e]},getData:function(e){!e&&this.fire("beforeGetData");var t=this._.data;return"string"!=typeof t&&(t=(t=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?t.is("textarea")?t.getValue():t.getHtml():""),t={dataValue:t},!e&&this.fire("getData",t),t.dataValue},getSnapshot:function(){var e=this.fire("getSnapshot");return"string"!=typeof e&&(e=(e=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?e.is("textarea")?e.getValue():e.getHtml():""),e},loadSnapshot:function(e){this.fire("loadSnapshot",e)},setData:function(e,t,n){var i=!0,o=t;t&&"object"==typeof t&&(n=t.internal,o=t.callback,i=!t.noSnapshot),!n&&i&&this.fire("saveSnapshot"),!o&&n||this.once("dataReady",(function(e){!n&&i&&this.fire("saveSnapshot"),o&&o.call(e.editor)})),e={dataValue:e},!n&&this.fire("setData",e),this._.data=e.dataValue,!n&&this.fire("afterSetData",e)},setReadOnly:function(e){e=null==e||e,this.readOnly!=e&&(this.readOnly=e,this.keystrokeHandler.blockedKeystrokes[8]=+e,this.editable().setReadOnly(e),this.fire("readOnly"))},insertHtml:function(e,t,n){this.fire("insertHtml",{dataValue:e,mode:t,range:n})},insertText:function(e){this.fire("insertText",e)},insertElement:function(e){this.fire("insertElement",e)},getSelectedHtml:function(e){var t=this.editable(),n=(n=this.getSelection())&&n.getRanges();if(!t||!n||0===n.length)return null;for(var i,o,s,a=new CKEDITOR.dom.documentFragment,r=0;r<n.length;r++){var l=n[r],c=l.startContainer;c.getName&&"tr"==c.getName()?(i||((i=c.getAscendant("table").clone()).append(c.getAscendant("tbody").clone()),a.append(i),i=i.findOne("tbody")),o&&o.equals(c)||(o=c,s=c.clone(),i.append(s)),s.append(l.cloneContents())):a.append(l.cloneContents())}return t=i?a:t.getHtmlFromRange(n[0]),e?t.getHtml():t},extractSelectedHtml:function(e,t){var n=this.editable(),i=this.getSelection().getRanges();return n&&0!==i.length?(i=i[0],n=n.extractHtmlFromRange(i,t),t||this.getSelection().selectRanges([i]),e?n.getHtml():n):null},focus:function(){this.fire("beforeFocus")},checkDirty:function(){return"ready"==this.status&&this._.previousValue!==this.getSnapshot()},resetDirty:function(){this._.previousValue=this.getSnapshot()},updateElement:function(){return o.call(this)},setKeystroke:function(){for(var e,t,n=this.keystrokeHandler.keystrokes,i=CKEDITOR.tools.isArray(arguments[0])?arguments[0]:[[].slice.call(arguments,0)],o=i.length;o--;)e=i[o],t=0,CKEDITOR.tools.isArray(e)&&(t=e[1],e=e[0]),t?n[e]=t:delete n[e]},addFeature:function(e){return this.filter.addFeature(e)},setActiveFilter:function(e){e||(e=this.filter),this.activeFilter!==e&&(this.activeFilter=e,this.fire("activeFilterChange"),e===this.filter?this.setActiveEnterMode(null,null):this.setActiveEnterMode(e.getAllowedEnterMode(this.enterMode),e.getAllowedEnterMode(this.shiftEnterMode,!0)))},setActiveEnterMode:function(e,t){e=e?this.blockless?CKEDITOR.ENTER_BR:e:this.enterMode,t=t?this.blockless?CKEDITOR.ENTER_BR:t:this.shiftEnterMode,this.activeEnterMode==e&&this.activeShiftEnterMode==t||(this.activeEnterMode=e,this.activeShiftEnterMode=t,this.fire("activeEnterModeChange"))},showNotification:function(e){alert(e)}})}(),CKEDITOR.ELEMENT_MODE_NONE=0,CKEDITOR.ELEMENT_MODE_REPLACE=1,CKEDITOR.ELEMENT_MODE_APPENDTO=2,CKEDITOR.ELEMENT_MODE_INLINE=3,CKEDITOR.htmlParser=function(){this._={htmlPartsRegex:/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\x3e)|(?:([^\/\s>]+)((?:\s+[\w\-:.]+(?:\s*=\s*?(?:(?:"[^"]*")|(?:'[^']*')|[^\s"'\/>]+))?)*)[\S\s]*?(\/?)>))/g}},function(){var e=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,t={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};CKEDITOR.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(n){for(var i,o,s,a=0;i=this._.htmlPartsRegex.exec(n);)if((o=i.index)>a&&(a=n.substring(a,o),s?s.push(a):this.onText(a)),a=this._.htmlPartsRegex.lastIndex,!(o=i[1])||(o=o.toLowerCase(),s&&CKEDITOR.dtd.$cdata[o]&&(this.onCDATA(s.join("")),s=null),s))if(s)s.push(i[0]);else if(o=i[3]){if(o=o.toLowerCase(),!/="/.test(o)){var r,l={},c=i[4];if(i=!!i[5],c)for(;r=e.exec(c);){var d=r[1].toLowerCase();r=r[2]||r[3]||r[4]||"",l[d]=!r&&t[d]?d:CKEDITOR.tools.htmlDecodeAttr(r)}this.onTagOpen(o,l,i),!s&&CKEDITOR.dtd.$cdata[o]&&(s=[])}}else(o=i[2])&&this.onComment(o);else this.onTagClose(o);n.length>a&&this.onText(n.substring(a,n.length))}}}(),CKEDITOR.htmlParser.basicWriter=CKEDITOR.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(e){this._.output.push("<",e)},openTagClose:function(e,t){t?this._.output.push(" />"):this._.output.push(">")},attribute:function(e,t){"string"==typeof t&&(t=CKEDITOR.tools.htmlEncodeAttr(t)),this._.output.push(" ",e,'="',t,'"')},closeTag:function(e){this._.output.push("</",e,">")},text:function(e){this._.output.push(e)},comment:function(e){this._.output.push("\x3c!--",e,"--\x3e")},write:function(e){this._.output.push(e)},reset:function(){this._.output=[],this._.indent=!1},getHtml:function(e){var t=this._.output.join("");return e&&this.reset(),t}}}),CKEDITOR.htmlParser.node=function(){},CKEDITOR.htmlParser.node.prototype={remove:function(){var e=this.parent.children,t=CKEDITOR.tools.indexOf(e,this),n=this.previous,i=this.next;n&&(n.next=i),i&&(i.previous=n),e.splice(t,1),this.parent=null},replaceWith:function(e){var t=this.parent.children,n=CKEDITOR.tools.indexOf(t,this),i=e.previous=this.previous,o=e.next=this.next;i&&(i.next=e),o&&(o.previous=e),t[n]=e,e.parent=this.parent,this.parent=null},insertAfter:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e),i=e.next;t.splice(n+1,0,this),this.next=e.next,this.previous=e,e.next=this,i&&(i.previous=this),this.parent=e.parent},insertBefore:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e);t.splice(n,0,this),this.next=e,(this.previous=e.previous)&&(e.previous.next=this),e.previous=this,this.parent=e.parent},getAscendant:function(e){for(var t="function"==typeof e?e:"string"==typeof e?function(t){return t.name==e}:function(t){return t.name in e},n=this.parent;n&&n.type==CKEDITOR.NODE_ELEMENT;){if(t(n))return n;n=n.parent}return null},wrapWith:function(e){return this.replaceWith(e),e.add(this),e},getIndex:function(){return CKEDITOR.tools.indexOf(this.parent.children,this)},getFilterContext:function(e){return e||{}}},CKEDITOR.htmlParser.comment=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.comment.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_COMMENT,filter:function(e,t){var n=this.value;return(n=e.onComment(t,n,this))?"string"!=typeof n?(this.replaceWith(n),!1):(this.value=n,!0):(this.remove(),!1)},writeHtml:function(e,t){t&&this.filter(t),e.comment(this.value)}}),CKEDITOR.htmlParser.text=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.text.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(e,t){if(!(this.value=e.onText(t,this.value,this)))return this.remove(),!1},writeHtml:function(e,t){t&&this.filter(t),e.text(this.value)}}),CKEDITOR.htmlParser.cdata=function(e){this.value=e},CKEDITOR.htmlParser.cdata.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(){},writeHtml:function(e){e.write(this.value)}}),CKEDITOR.htmlParser.fragment=function(){this.children=[],this.parent=null,this._={isBlockLike:!0,hasInlineStarted:!1}},function(){function e(e){return!e.attributes["data-cke-survive"]&&("a"==e.name&&e.attributes.href||CKEDITOR.dtd.$removeEmpty[e.name])}var t=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),n={ol:1,ul:1},i=CKEDITOR.tools.extend({},{html:1},CKEDITOR.dtd.html,CKEDITOR.dtd.body,CKEDITOR.dtd.head,{style:1,script:1}),o={ul:"li",ol:"li",dl:"dd",table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td"};CKEDITOR.htmlParser.fragment.fromHtml=function(s,a,r){function l(e){var t;if(0<g.length)for(var n=0;n<g.length;n++){var i=g[n],o=i.name,s=CKEDITOR.dtd[o],a=b.name&&CKEDITOR.dtd[b.name];a&&!a[o]||e&&s&&!s[e]&&CKEDITOR.dtd[e]?o==b.name&&(u(b,b.parent,1),n--):(t||(c(),t=1),(i=i.clone()).parent=b,b=i,g.splice(n,1),n--)}}function c(){for(;f.length;)u(f.shift(),b)}function d(e){if(e._.isBlockLike&&"pre"!=e.name&&"textarea"!=e.name){var t,n=e.children.length,i=e.children[n-1];i&&i.type==CKEDITOR.NODE_TEXT&&((t=CKEDITOR.tools.rtrim(i.value))?i.value=t:e.children.length=n-1)}}function u(t,n,i){n=n||b||_;var o=b;void 0===t.previous&&(h(n,t)&&(b=n,m.onTagOpen(r,{}),t.returnPoint=n=b),d(t),e(t)&&!t.children.length||n.add(t),"pre"==t.name&&(A=!1),"textarea"==t.name&&(v=!1)),t.returnPoint?(b=t.returnPoint,delete t.returnPoint):b=i?n:o}function h(e,t){var n,i;if((e==_||"body"==e.name)&&r&&(!e.name||CKEDITOR.dtd[e.name][r]))return(n=t.attributes&&(i=t.attributes["data-cke-real-element-type"])?i:t.name)&&n in CKEDITOR.dtd.$inline&&!(n in CKEDITOR.dtd.head)&&!t.isOrphan||t.type==CKEDITOR.NODE_TEXT}function p(e,t){return(e in CKEDITOR.dtd.$listItem||e in CKEDITOR.dtd.$tableContent)&&(e==t||"dt"==e&&"dd"==t||"dd"==e&&"dt"==t)}var m=new CKEDITOR.htmlParser,_=a instanceof CKEDITOR.htmlParser.element?a:"string"==typeof a?new CKEDITOR.htmlParser.element(a):new CKEDITOR.htmlParser.fragment,g=[],f=[],b=_,v="textarea"==_.name,A="pre"==_.name;for(m.onTagOpen=function(o,s,a,r){if((s=new CKEDITOR.htmlParser.element(o,s)).isUnknown&&a&&(s.isEmpty=!0),s.isOptionalClose=r,e(s))g.push(s);else{if("pre"==o)A=!0;else{if("br"==o&&A)return void b.add(new CKEDITOR.htmlParser.text("\n"));"textarea"==o&&(v=!0)}if("br"==o)f.push(s);else{for(;r=(a=b.name)?CKEDITOR.dtd[a]||(b._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i,!(s.isUnknown||b.isUnknown||r[o]);)if(b.isOptionalClose)m.onTagClose(a);else if(o in n&&a in n)(a=(a=b.children)[a.length-1])&&"li"==a.name||u(a=new CKEDITOR.htmlParser.element("li"),b),!s.returnPoint&&(s.returnPoint=b),b=a;else if(o in CKEDITOR.dtd.$listItem&&!p(o,a))m.onTagOpen("li"==o?"ul":"dl",{},0,1);else if(a in t&&!p(o,a))!s.returnPoint&&(s.returnPoint=b),b=b.parent;else{if(a in CKEDITOR.dtd.$inline&&g.unshift(b),!b.parent){s.isOrphan=1;break}u(b,b.parent,1)}l(o),c(),s.parent=b,s.isEmpty?u(s):b=s}}},m.onTagClose=function(e){for(var t=g.length-1;0<=t;t--)if(e==g[t].name)return void g.splice(t,1);for(var n=[],i=[],o=b;o!=_&&o.name!=e;)o._.isBlockLike||i.unshift(o),n.push(o),o=o.returnPoint||o.parent;if(o!=_){for(t=0;t<n.length;t++){var s=n[t];u(s,s.parent)}b=o,o._.isBlockLike&&c(),u(o,o.parent),o==b&&(b=b.parent),g=g.concat(i)}"body"==e&&(r=!1)},m.onText=function(e){if(b._.hasInlineStarted&&!f.length||A||v||0!==(e=CKEDITOR.tools.ltrim(e)).length){var n=b.name,s=n?CKEDITOR.dtd[n]||(b._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i;v||s["#"]||!(n in t)?(c(),l(),A||v||(e=e.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," ")),e=new CKEDITOR.htmlParser.text(e),h(b,e)&&this.onTagOpen(r,{},0,1),b.add(e)):(m.onTagOpen(o[n]||""),m.onText(e))}},m.onCDATA=function(e){b.add(new CKEDITOR.htmlParser.cdata(e))},m.onComment=function(e){c(),l(),b.add(new CKEDITOR.htmlParser.comment(e))},m.parse(s),c();b!=_;)u(b,b.parent,1);return d(_),_},CKEDITOR.htmlParser.fragment.prototype={type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,add:function(e,t){isNaN(t)&&(t=this.children.length);var n=0<t?this.children[t-1]:null;if(n){if(e._.isBlockLike&&n.type==CKEDITOR.NODE_TEXT&&(n.value=CKEDITOR.tools.rtrim(n.value),0===n.value.length))return this.children.pop(),void this.add(e);n.next=e}e.previous=n,e.parent=this,this.children.splice(t,0,e),this._.hasInlineStarted||(this._.hasInlineStarted=e.type==CKEDITOR.NODE_TEXT||e.type==CKEDITOR.NODE_ELEMENT&&!e._.isBlockLike)},filter:function(e,t){t=this.getFilterContext(t),e.onRoot(t,this),this.filterChildren(e,!1,t)},filterChildren:function(e,t,n){if(this.childrenFilteredBy!=e.id)for(n=this.getFilterContext(n),t&&!this.parent&&e.onRoot(n,this),this.childrenFilteredBy=e.id,t=0;t<this.children.length;t++)!1===this.children[t].filter(e,n)&&t--},writeHtml:function(e,t){t&&this.filter(t),this.writeChildrenHtml(e)},writeChildrenHtml:function(e,t,n){var i=this.getFilterContext();for(n&&!this.parent&&t&&t.onRoot(i,this),t&&this.filterChildren(t,!1,i),t=0,i=(n=this.children).length;t<i;t++)n[t].writeHtml(e)},forEach:function(e,t,n){if(!(n||t&&this.type!=t))var i=e(this);if(!1!==i){n=this.children;for(var o=0;o<n.length;o++)(i=n[o]).type==CKEDITOR.NODE_ELEMENT?i.forEach(e,t):t&&i.type!=t||e(i)}},getFilterContext:function(e){return e||{}}}}(),function(){function e(){this.rules=[]}function t(t,n,i,o){var s,a;for(s in n)(a=t[s])||(a=t[s]=new e),a.add(n[s],i,o)}CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(t){this.id=CKEDITOR.tools.getNextNumber(),this.elementNameRules=new e,this.attributeNameRules=new e,this.elementsRules={},this.attributesRules={},this.textRules=new e,this.commentRules=new e,this.rootRules=new e,t&&this.addRules(t,10)},proto:{addRules:function(e,n){var i;"number"==typeof n?i=n:n&&"priority"in n&&(i=n.priority),"number"!=typeof i&&(i=10),"object"!=typeof n&&(n={}),e.elementNames&&this.elementNameRules.addMany(e.elementNames,i,n),e.attributeNames&&this.attributeNameRules.addMany(e.attributeNames,i,n),e.elements&&t(this.elementsRules,e.elements,i,n),e.attributes&&t(this.attributesRules,e.attributes,i,n),e.text&&this.textRules.add(e.text,i,n),e.comment&&this.commentRules.add(e.comment,i,n),e.root&&this.rootRules.add(e.root,i,n)},applyTo:function(e){e.filter(this)},onElementName:function(e,t){return this.elementNameRules.execOnName(e,t)},onAttributeName:function(e,t){return this.attributeNameRules.execOnName(e,t)},onText:function(e,t,n){return this.textRules.exec(e,t,n)},onComment:function(e,t,n){return this.commentRules.exec(e,t,n)},onRoot:function(e,t){return this.rootRules.exec(e,t)},onElement:function(e,t){for(var n,i=[this.elementsRules["^"],this.elementsRules[t.name],this.elementsRules.$],o=0;3>o;o++)if(n=i[o]){if(!1===(n=n.exec(e,t,this)))return null;if(n&&n!=t)return this.onNode(e,n);if(t.parent&&!t.name)break}return t},onNode:function(e,t){var n=t.type;return n==CKEDITOR.NODE_ELEMENT?this.onElement(e,t):n==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(e,t.value)):n==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(e,t.value)):null},onAttribute:function(e,t,n,i){return(n=this.attributesRules[n])?n.exec(e,i,t,this):i}}}),CKEDITOR.htmlParser.filterRulesGroup=e,e.prototype={add:function(e,t,n){this.rules.splice(this.findIndex(t),0,{value:e,priority:t,options:n})},addMany:function(e,t,n){for(var i=[this.findIndex(t),0],o=0,s=e.length;o<s;o++)i.push({value:e[o],priority:t,options:n});this.rules.splice.apply(this.rules,i)},findIndex:function(e){for(var t=this.rules,n=t.length-1;0<=n&&e<t[n].priority;)n--;return n+1},exec:function(e,t){var n,i,o,s,a=t instanceof CKEDITOR.htmlParser.node||t instanceof CKEDITOR.htmlParser.fragment,r=Array.prototype.slice.call(arguments,1),l=this.rules,c=l.length;for(s=0;s<c;s++)if(a&&(n=t.type,i=t.name),o=l[s],!(e.nonEditable&&!o.options.applyToAll||e.nestedEditable&&o.options.excludeNestedEditable)){if(!1===(o=o.value.apply(null,r))||a&&o&&(o.name!=i||o.type!=n))return o;null!=o&&(r[0]=t=o)}return t},execOnName:function(e,t){for(var n,i=0,o=this.rules,s=o.length;t&&i<s;i++)n=o[i],e.nonEditable&&!n.options.applyToAll||e.nestedEditable&&n.options.excludeNestedEditable||(t=t.replace(n.value[0],n.value[1]));return t}}}(),function(){function e(e,t){function r(e){return e||CKEDITOR.env.needsNbspFiller?new CKEDITOR.htmlParser.text(" "):new CKEDITOR.htmlParser.element("br",{"data-cke-bogus":1})}function l(e,t){return function(o){if(o.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var a,l,d=[],u=n(o);if(u)for(c(u,1)&&d.push(u);u;)s(u)&&(a=i(u))&&c(a)&&((l=i(a))&&!s(l)?d.push(a):(r(p).insertAfter(a),a.remove())),u=u.previous;for(u=0;u<d.length;u++)d[u].remove();(d=!e||!1!==("function"==typeof t?t(o):t))&&(d=!(!p&&!CKEDITOR.env.needsBrFiller&&o.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||!p&&!CKEDITOR.env.needsBrFiller&&(7<document.documentMode||o.name in CKEDITOR.dtd.tr||o.name in CKEDITOR.dtd.$listItem))&&(!(d=n(o))||"form"==o.name&&"input"==d.name)),d&&o.add(r(e))}}}function c(e,t){return!(p&&!CKEDITOR.env.needsBrFiller||e.type!=CKEDITOR.NODE_ELEMENT||"br"!=e.name||e.attributes["data-cke-eol"])||!!(e.type==CKEDITOR.NODE_TEXT&&(n=e.value.match(h))&&(n.index&&(new CKEDITOR.htmlParser.text(e.value.substring(0,n.index)).insertBefore(e),e.value=n[0]),!CKEDITOR.env.needsBrFiller&&p&&(!t||e.parent.name in _)||!p&&((n=e.previous)&&"br"==n.name||!n||s(n))));var n}var d,u={elements:{}},p="html"==t,_=CKEDITOR.tools.extend({},g);for(d in _)"#"in m[d]||delete _[d];for(d in _)u.elements[d]=l(p,e.config.fillEmptyBlocks);return u.root=l(p,!1),u.elements.br=function(e){return function(t){if(t.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var n=t.attributes;if("data-cke-bogus"in n||"data-cke-eol"in n)delete n["data-cke-bogus"];else{for(n=t.next;n&&o(n);)n=n.next;var l=i(t);!n&&s(t.parent)?a(t.parent,r(e)):s(n)&&l&&!s(l)&&r(e).insertBefore(n)}}}}(p),u}function t(e,t){return e!=CKEDITOR.ENTER_BR&&!1!==t&&(e==CKEDITOR.ENTER_DIV?"div":"p")}function n(e){for(e=e.children[e.children.length-1];e&&o(e);)e=e.previous;return e}function i(e){for(e=e.previous;e&&o(e);)e=e.previous;return e}function o(e){return e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(e.value)||e.type==CKEDITOR.NODE_ELEMENT&&e.attributes["data-cke-bookmark"]}function s(e){return e&&(e.type==CKEDITOR.NODE_ELEMENT&&e.name in g||e.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)}function a(e,t){var n=e.children[e.children.length-1];e.children.push(t),t.parent=e,n&&(n.next=t,t.previous=n)}function r(e){"false"!=(e=e.attributes).contenteditable&&(e["data-cke-editable"]=e.contenteditable?"true":1),e.contenteditable="false"}function l(e){switch((e=e.attributes)["data-cke-editable"]){case"true":e.contenteditable="true";break;case"1":delete e.contenteditable}}function c(e,t){return e.replace(t,(function(e,t,n){return 0===e.indexOf("<textarea")&&(e=t+d(n).replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</textarea>"),"<cke:encoded>"+encodeURIComponent(e)+"</cke:encoded>"}))}function d(e){return e.replace(/\x3c!--\{cke_protected\}\{C\}([\s\S]+?)--\x3e/g,(function(e,t){return decodeURIComponent(t)}))}function u(e,t){var n=t._.dataStore;return e.replace(/\x3c!--\{cke_protected\}([\s\S]+?)--\x3e/g,(function(e,t){return decodeURIComponent(t)})).replace(/\{cke_protected_(\d+)\}/g,(function(e,t){return n&&n[t]||""}))}CKEDITOR.htmlDataProcessor=function(n){var i,o,s=this;this.editor=n,this.dataFilter=i=new CKEDITOR.htmlParser.filter,this.htmlFilter=o=new CKEDITOR.htmlParser.filter,this.writer=new CKEDITOR.htmlParser.basicWriter,i.addRules(f),i.addRules(b,{applyToAll:!0}),i.addRules(e(n,"data"),{applyToAll:!0}),o.addRules(v),o.addRules(A,{applyToAll:!0}),o.addRules(e(n,"html"),{applyToAll:!0}),n.on("toHtml",(function(e){var i,o,s=c(s=function(e,t){var n=[],i=t.config.protectedSource,o=t._.dataStore||(t._.dataStore={id:1}),s=/<\!--\{cke_temp(comment)?\}(\d*?)--\x3e/g;i=[/<script[\s\S]*?(<\/script>|$)/gi,/<noscript[\s\S]*?<\/noscript>/gi,/<meta[\s\S]*?\/?>/gi].concat(i),e=e.replace(/\x3c!--[\s\S]*?--\x3e/g,(function(e){return"\x3c!--{cke_tempcomment}"+(n.push(e)-1)+"--\x3e"}));for(var a=0;a<i.length;a++)e=e.replace(i[a],(function(e){return e=e.replace(s,(function(e,t,i){return n[i]})),/cke_temp(comment)?/.test(e)?e:"\x3c!--{cke_temp}"+(n.push(e)-1)+"--\x3e"}));return(e=(e=e.replace(s,(function(e,t,i){return"\x3c!--"+p+(t?"{C}":"")+encodeURIComponent(n[i]).replace(/--/g,"%2D%2D")+"--\x3e"}))).replace(/<\w+(?:\s+(?:(?:[^\s=>]+\s*=\s*(?:[^'"\s>]+|'[^']*'|"[^"]*"))|[^\s=\/>]+))+\s*\/?>/g,(function(e){return e.replace(/\x3c!--\{cke_protected\}([^>]*)--\x3e/g,(function(e,t){return o[o.id]=decodeURIComponent(t),"{cke_protected_"+o.id+++"}"}))}))).replace(/<(title|iframe|textarea)([^>]*)>([\s\S]*?)<\/\1>/g,(function(e,n,i,o){return"<"+n+i+">"+u(d(o),t)+"</"+n+">"}))}(s=(e=e.data).dataValue,n),M);s=(s=(s=(s=(s=c(s=function(e){return e.replace(E,(function(e,t,n){return"<"+t+n.replace(T,(function(e,t){return C.test(t)&&-1==n.indexOf("data-cke-saved-"+t)?" data-cke-saved-"+e+" data-cke-"+CKEDITOR.rnd+"-"+e:e}))+">"}))}(s),y)).replace(S,"$1cke:$2")).replace(N,"<cke:$1$2></cke:$1>")).replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2")).replace(/([^a-z0-9<\-])(on\w{3,})(?!>)/gi,"$1data-cke-"+CKEDITOR.rnd+"-$2"),i=e.context||n.editable().getName(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&"pre"==i&&(i="div",s="<pre>"+s+"</pre>",o=1),(i=n.document.createElement(i)).setHtml("a"+s),s=(s=i.getHtml().substr(1)).replace(new RegExp("data-cke-"+CKEDITOR.rnd+"-","ig"),""),o&&(s=s.replace(/^<pre>|<\/pre>$/gi,"")),s=d(s=function(e){return e.replace(I,(function(e,t){return decodeURIComponent(t)}))}(s=s.replace(w,"$1$2"))),i=!1!==e.fixForBody&&t(e.enterMode,n.config.autoParagraph),s=CKEDITOR.htmlParser.fragment.fromHtml(s,e.context,i),i&&!(o=s).children.length&&CKEDITOR.dtd[o.name][i]&&(i=new CKEDITOR.htmlParser.element(i),o.add(i)),e.dataValue=s}),null,null,5),n.on("toHtml",(function(e){e.data.filter.applyTo(e.data.dataValue,!0,e.data.dontFilter,e.data.enterMode)&&n.fire("dataFiltered")}),null,null,6),n.on("toHtml",(function(e){e.data.dataValue.filterChildren(s.dataFilter,!0)}),null,null,10),n.on("toHtml",(function(e){var t=(e=e.data).dataValue,n=new CKEDITOR.htmlParser.basicWriter;t.writeChildrenHtml(n),t=n.getHtml(!0),e.dataValue=function(e){return e.replace(/\x3c!--(?!{cke_protected})[\s\S]+?--\x3e/g,(function(e){return"\x3c!--"+p+"{C}"+encodeURIComponent(e).replace(/--/g,"%2D%2D")+"--\x3e"}))}(t)}),null,null,15),n.on("toDataFormat",(function(e){var i=e.data.dataValue;e.data.enterMode!=CKEDITOR.ENTER_BR&&(i=i.replace(/^<br *\/?>/i,"")),e.data.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(i,e.data.context,t(e.data.enterMode,n.config.autoParagraph))}),null,null,5),n.on("toDataFormat",(function(e){e.data.dataValue.filterChildren(s.htmlFilter,!0)}),null,null,10),n.on("toDataFormat",(function(e){e.data.filter.applyTo(e.data.dataValue,!1,!0)}),null,null,11),n.on("toDataFormat",(function(e){var t=e.data.dataValue,i=s.writer;i.reset(),t.writeChildrenHtml(i),t=u(t=d(t=i.getHtml(!0)),n),e.data.dataValue=t}),null,null,15)},CKEDITOR.htmlDataProcessor.prototype={toHtml:function(e,t,n,i){var o,s,a,r,l=this.editor;return t&&"object"==typeof t?(o=t.context,n=t.fixForBody,i=t.dontFilter,s=t.filter,a=t.enterMode,r=t.protectedWhitespaces):o=t,o||null===o||(o=l.editable().getName()),l.fire("toHtml",{dataValue:e,context:o,fixForBody:n,dontFilter:i,filter:s||l.filter,enterMode:a||l.enterMode,protectedWhitespaces:r}).dataValue},toDataFormat:function(e,t){var n,i,o;return t&&(n=t.context,i=t.filter,o=t.enterMode),n||null===n||(n=this.editor.editable().getName()),this.editor.fire("toDataFormat",{dataValue:e,filter:i||this.editor.filter,context:n,enterMode:o||this.editor.enterMode}).dataValue}};var h=/(?:&nbsp;|\xa0)$/,p="{cke_protected}",m=CKEDITOR.dtd,_="caption colgroup col thead tfoot tbody".split(" "),g=CKEDITOR.tools.extend({},m.$blockLimit,m.$block),f={elements:{input:r,textarea:r}},b={attributeNames:[[/^on/,"data-cke-pa-on"],[/^data-cke-expando$/,""]]},v={elements:{embed:function(e){if((n=e.parent)&&"object"==n.name){var t=n.attributes.width,n=n.attributes.height;t&&(e.attributes.width=t),n&&(e.attributes.height=n)}},a:function(e){var t=e.attributes;if(!(e.children.length||t.name||t.id||e.attributes["data-cke-saved-name"]))return!1}}},A={elementNames:[[/^cke:/,""],[/^\?xml:namespace$/,""]],attributeNames:[[/^data-cke-(saved|pa)-/,""],[/^data-cke-.*/,""],["hidefocus",""]],elements:{$:function(e){var t=e.attributes;if(t){if(t["data-cke-temp"])return!1;for(var n=["name","href","src"],i=0;i<n.length;i++)"data-cke-saved-"+n[i]in t&&delete t[n[i]]}return e},table:function(e){e.children.slice(0).sort((function(e,t){var n,i;return e.type==CKEDITOR.NODE_ELEMENT&&t.type==e.type&&(n=CKEDITOR.tools.indexOf(_,e.name),i=CKEDITOR.tools.indexOf(_,t.name)),-1<n&&-1<i&&n!=i||(n=e.parent?e.getIndex():-1,i=t.parent?t.getIndex():-1),n>i?1:-1}))},param:function(e){return e.children=[],e.isEmpty=!0,e},span:function(e){"Apple-style-span"==e.attributes.class&&delete e.name},html:function(e){delete e.attributes.contenteditable,delete e.attributes.class},body:function(e){delete e.attributes.spellcheck,delete e.attributes.contenteditable},style:function(e){var t=e.children[0];t&&t.value&&(t.value=CKEDITOR.tools.trim(t.value)),e.attributes.type||(e.attributes.type="text/css")},title:function(e){var t=e.children[0];!t&&a(e,t=new CKEDITOR.htmlParser.text),t.value=e.attributes["data-cke-title"]||""},input:l,textarea:l},attributes:{class:function(e){return CKEDITOR.tools.ltrim(e.replace(/(?:^|\s+)cke_[^\s]*/g,""))||!1}}};CKEDITOR.env.ie&&(A.attributes.style=function(e){return e.replace(/(^|;)([^\:]+)/g,(function(e){return e.toLowerCase()}))});var E=/<(a|area|img|input|source)\b([^>]*)>/gi,T=/([\w-:]+)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi,C=/^(href|src|name)$/i,y=/(?:<style(?=[ >])[^>]*>[\s\S]*?<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,M=/(<textarea(?=[ >])[^>]*>)([\s\S]*?)(?:<\/textarea>)/gi,I=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,S=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,w=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,N=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi}(),CKEDITOR.htmlParser.element=function(e,t){this.name=e,this.attributes=t||{},this.children=[];var n=e||"",i=n.match(/^cke:(.*)/);i&&(n=i[1]),n=!!(CKEDITOR.dtd.$nonBodyContent[n]||CKEDITOR.dtd.$block[n]||CKEDITOR.dtd.$listItem[n]||CKEDITOR.dtd.$tableContent[n]||CKEDITOR.dtd.$nonEditable[n]||"br"==n),this.isEmpty=!!CKEDITOR.dtd.$empty[e],this.isUnknown=!CKEDITOR.dtd[e],this._={isBlockLike:n,hasInlineStarted:this.isEmpty||!n}},CKEDITOR.htmlParser.cssStyle=function(e){var t={};return((e instanceof CKEDITOR.htmlParser.element?e.attributes.style:e)||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,(function(e,n,i){"font-family"==n&&(i=i.replace(/["']/g,"")),t[n.toLowerCase()]=i})),{rules:t,populate:function(e){var t=this.toString();t&&(e instanceof CKEDITOR.dom.element?e.setAttribute("style",t):e instanceof CKEDITOR.htmlParser.element?e.attributes.style=t:e.style=t)},toString:function(){var e,n=[];for(e in t)t[e]&&n.push(e,":",t[e],";");return n.join("")}}},function(){var e=function(e,t){return(e=e[0])<(t=t[0])?-1:e>t?1:0},t=CKEDITOR.htmlParser.fragment.prototype;CKEDITOR.htmlParser.element.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_ELEMENT,add:t.add,clone:function(){return new CKEDITOR.htmlParser.element(this.name,this.attributes)},filter:function(e,t){var n,i,o,s,a=this;if((t=a.getFilterContext(t)).off)return!0;for(a.parent||e.onRoot(t,a);;){if(n=a.name,!(i=e.onElementName(t,n)))return this.remove(),!1;if(a.name=i,!(a=e.onElement(t,a)))return this.remove(),!1;if(a!==this)return this.replaceWith(a),!1;if(a.name==n)break;if(a.type!=CKEDITOR.NODE_ELEMENT)return this.replaceWith(a),!1;if(!a.name)return this.replaceWithChildren(),!1}for(o in n=a.attributes){for(i=n[o];;){if(!(s=e.onAttributeName(t,o))){delete n[o];break}if(s==o)break;delete n[o],o=s}s&&(!1===(i=e.onAttribute(t,a,s,i))?delete n[s]:n[s]=i)}return a.isEmpty||this.filterChildren(e,!1,t),!0},filterChildren:t.filterChildren,writeHtml:function(t,n){n&&this.filter(n);var i,o,s=this.name,a=[],r=this.attributes;for(i in t.openTag(s,r),r)a.push([i,r[i]]);for(t.sortAttributes&&a.sort(e),i=0,o=a.length;i<o;i++)r=a[i],t.attribute(r[0],r[1]);t.openTagClose(s,this.isEmpty),this.writeChildrenHtml(t),this.isEmpty||t.closeTag(s)},writeChildrenHtml:t.writeChildrenHtml,replaceWithChildren:function(){for(var e=this.children,t=e.length;t;)e[--t].insertAfter(this);this.remove()},forEach:t.forEach,getFirst:function(e){if(!e)return this.children.length?this.children[0]:null;"function"!=typeof e&&(e=function(e){return function(t){return t.type==CKEDITOR.NODE_ELEMENT&&("string"==typeof e?t.name==e:t.name in e)}}(e));for(var t=0,n=this.children.length;t<n;++t)if(e(this.children[t]))return this.children[t];return null},getHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeChildrenHtml(e),e.getHtml()},setHtml:function(e){for(var t=0,n=(e=this.children=CKEDITOR.htmlParser.fragment.fromHtml(e).children).length;t<n;++t)e[t].parent=this},getOuterHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeHtml(e),e.getHtml()},split:function(e){for(var t=this.children.splice(e,this.children.length-e),n=this.clone(),i=0;i<t.length;++i)t[i].parent=n;return n.children=t,t[0]&&(t[0].previous=null),0<e&&(this.children[e-1].next=null),this.parent.add(n,this.getIndex()+1),n},addClass:function(e){if(!this.hasClass(e)){var t=this.attributes.class||"";this.attributes.class=t+(t?" ":"")+e}},removeClass:function(e){var t=this.attributes.class;t&&((t=CKEDITOR.tools.trim(t.replace(new RegExp("(?:\\s+|^)"+e+"(?:\\s+|$)")," ")))?this.attributes.class=t:delete this.attributes.class)},hasClass:function(e){var t=this.attributes.class;return!!t&&new RegExp("(?:^|\\s)"+e+"(?=\\s|$)").test(t)},getFilterContext:function(e){var t=[];if(e||(e={off:!1,nonEditable:!1,nestedEditable:!1}),e.off||"off"!=this.attributes["data-cke-processor"]||t.push("off",!0),e.nonEditable||"false"!=this.attributes.contenteditable?e.nonEditable&&!e.nestedEditable&&"true"==this.attributes.contenteditable&&t.push("nestedEditable",!0):t.push("nonEditable",!0),t.length){e=CKEDITOR.tools.copy(e);for(var n=0;n<t.length;n+=2)e[t[n]]=t[n+1]}return e}},!0)}(),function(){var e={},t=/{([^}]+)}/g,n=/([\\'])/g,i=/\n/g,o=/\r/g;CKEDITOR.template=function(s){if(e[s])this.output=e[s];else{var a=s.replace(n,"\\$1").replace(i,"\\n").replace(o,"\\r").replace(t,(function(e,t){return"',data['"+t+"']==undefined?'{"+t+"}':data['"+t+"'],'"}));this.output=e[s]=Function("data","buffer","return buffer?buffer.push('"+a+"'):['"+a+"'].join('');")}}}(),delete CKEDITOR.loadFullCore,CKEDITOR.instances={},CKEDITOR.document=new CKEDITOR.dom.document(document),CKEDITOR.add=function(e){CKEDITOR.instances[e.name]=e,e.on("focus",(function(){CKEDITOR.currentInstance!=e&&(CKEDITOR.currentInstance=e,CKEDITOR.fire("currentInstance"))})),e.on("blur",(function(){CKEDITOR.currentInstance==e&&(CKEDITOR.currentInstance=null,CKEDITOR.fire("currentInstance"))})),CKEDITOR.fire("instance",null,e)},CKEDITOR.remove=function(e){delete CKEDITOR.instances[e.name]},function(){var e={};CKEDITOR.addTemplate=function(t,n){var i=e[t];return i||(i={name:t,source:n},CKEDITOR.fire("template",i),e[t]=new CKEDITOR.template(i.source))},CKEDITOR.getTemplate=function(t){return e[t]}}(),function(){var e=[];CKEDITOR.addCss=function(t){e.push(t)},CKEDITOR.getCss=function(){return e.join("\n")}}(),CKEDITOR.on("instanceDestroyed",(function(){CKEDITOR.tools.isEmpty(this.instances)&&CKEDITOR.fire("reset")})),CKEDITOR.TRISTATE_ON=1,CKEDITOR.TRISTATE_OFF=2,CKEDITOR.TRISTATE_DISABLED=0,CKEDITOR.inline=function(e,t){if(!CKEDITOR.env.isCompatible)return null;if((e=CKEDITOR.dom.element.get(e)).getEditor())throw'The editor instance "'+e.getEditor().name+'" is already attached to the provided element.';var n=new CKEDITOR.editor(t,e,CKEDITOR.ELEMENT_MODE_INLINE),i=e.is("textarea")?e:null;return i?(n.setData(i.getValue(),null,!0),(e=CKEDITOR.dom.element.createFromHtml('<div contenteditable="'+!!n.readOnly+'" class="cke_textarea_inline">'+i.getValue()+"</div>",CKEDITOR.document)).insertAfter(i),i.hide(),i.$.form&&n._attachToForm()):n.setData(e.getHtml(),null,!0),n.on("loaded",(function(){n.fire("uiReady"),n.editable(e),n.container=e,n.ui.contentsElement=e,n.setData(n.getData(1)),n.resetDirty(),n.fire("contentDom"),n.mode="wysiwyg",n.fire("mode"),n.status="ready",n.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,n)}),null,null,1e4),n.on("destroy",(function(){i&&(n.container.clearCustomData(),n.container.remove(),i.show()),n.element.clearCustomData(),delete n.element})),n},CKEDITOR.inlineAll=function(){var e,t,n;for(n in CKEDITOR.dtd.$editable)for(var i=CKEDITOR.document.getElementsByTag(n),o=0,s=i.count();o<s;o++)"true"==(e=i.getItem(o)).getAttribute("contenteditable")&&(t={element:e,config:{}},!1!==CKEDITOR.fire("inline",t)&&CKEDITOR.inline(e,t.config))},CKEDITOR.domReady((function(){!CKEDITOR.disableAutoInline&&CKEDITOR.inlineAll()})),CKEDITOR.replaceClass="ckeditor",function(){function e(e,n,i,o){if(!CKEDITOR.env.isCompatible)return null;if((e=CKEDITOR.dom.element.get(e)).getEditor())throw'The editor instance "'+e.getEditor().name+'" is already attached to the provided element.';var s=new CKEDITOR.editor(n,e,o);return o==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.setStyle("visibility","hidden"),s._.required=e.hasAttribute("required"),e.removeAttribute("required")),i&&s.setData(i,null,!0),s.on("loaded",(function(){!function(e){var t=e.name,n=e.element,i=e.elementMode,o=e.fire("uiSpace",{space:"top",html:""}).html,s=e.fire("uiSpace",{space:"bottom",html:""}).html,a=new CKEDITOR.template('<{outerEl} id="cke_{name}" class="{id} cke cke_reset cke_chrome cke_editor_{name} cke_{langDir} '+CKEDITOR.env.cssClass+'"  dir="{langDir}" lang="{langCode}" role="application"'+(e.title?' aria-labelledby="cke_{name}_arialbl"':"")+">"+(e.title?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':"")+'<{outerEl} class="cke_inner cke_reset" role="presentation">{topHtml}<{outerEl} id="{contentId}" class="cke_contents cke_reset" role="presentation"></{outerEl}>{bottomHtml}</{outerEl}></{outerEl}>');t=CKEDITOR.dom.element.createFromHtml(a.output({id:e.id,name:t,langDir:e.lang.dir,langCode:e.langCode,voiceLabel:e.title,topHtml:o?'<span id="'+e.ui.spaceId("top")+'" class="cke_top cke_reset_all" role="presentation" style="height:auto">'+o+"</span>":"",contentId:e.ui.spaceId("contents"),bottomHtml:s?'<span id="'+e.ui.spaceId("bottom")+'" class="cke_bottom cke_reset_all" role="presentation">'+s+"</span>":"",outerEl:CKEDITOR.env.ie?"span":"div"})),i==CKEDITOR.ELEMENT_MODE_REPLACE?(n.hide(),t.insertAfter(n)):n.append(t),e.container=t,e.ui.contentsElement=e.ui.space("contents"),o&&e.ui.space("top").unselectable(),s&&e.ui.space("bottom").unselectable(),n=e.config.width,i=e.config.height,n&&t.setStyle("width",CKEDITOR.tools.cssLength(n)),i&&e.ui.space("contents").setStyle("height",CKEDITOR.tools.cssLength(i)),t.disableContextMenu(),CKEDITOR.env.webkit&&t.on("focus",(function(){e.focus()})),e.fireOnce("uiReady")}(s),o==CKEDITOR.ELEMENT_MODE_REPLACE&&s.config.autoUpdateElement&&e.$.form&&s._attachToForm(),s.setMode(s.config.startupMode,(function(){s.resetDirty(),s.status="ready",s.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,s)}))})),s.on("destroy",t),s}function t(){var e=this.container,t=this.element;e&&(e.clearCustomData(),e.remove()),t&&(t.clearCustomData(),this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.show(),this._.required&&t.setAttribute("required","required")),delete this.element)}CKEDITOR.replace=function(t,n){return e(t,n,null,CKEDITOR.ELEMENT_MODE_REPLACE)},CKEDITOR.appendTo=function(t,n,i){return e(t,n,i,CKEDITOR.ELEMENT_MODE_APPENDTO)},CKEDITOR.replaceAll=function(){for(var e=document.getElementsByTagName("textarea"),t=0;t<e.length;t++){var n=null,i=e[t];if(i.name||i.id){if("string"==typeof arguments[0]){if(!new RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)").test(i.className))continue}else if("function"==typeof arguments[0]&&!1===arguments[0](i,n={}))continue;this.replace(i,n)}}},CKEDITOR.editor.prototype.addMode=function(e,t){(this._.modes||(this._.modes={}))[e]=t},CKEDITOR.editor.prototype.setMode=function(e,t){var n=this,i=this._.modes;if(e!=n.mode&&i&&i[e]){if(n.fire("beforeSetMode",e),n.mode){var o,s=n.checkDirty(),a=(i=n._.previousModeData,0);n.fire("beforeModeUnload"),n.editable(0),n._.previousMode=n.mode,n._.previousModeData=o=n.getData(1),"source"==n.mode&&i==o&&(n.fire("lockSnapshot",{forceUpdate:!0}),a=1),n.ui.space("contents").setHtml(""),n.mode=""}else n._.previousModeData=n.getData(1);this._.modes[e]((function(){n.mode=e,void 0!==s&&!s&&n.resetDirty(),a?n.fire("unlockSnapshot"):"wysiwyg"==e&&n.fire("saveSnapshot"),setTimeout((function(){n.fire("mode"),t&&t.call(n)}),0)}))}},CKEDITOR.editor.prototype.resize=function(e,t,n,i){var o=this.container,s=this.ui.space("contents"),a=CKEDITOR.env.webkit&&this.document&&this.document.getWindow().$.frameElement;(i=i?this.container.getFirst((function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_inner")})):o).setSize("width",e,!0),a&&(a.style.width="1%");var r=(i.$.offsetHeight||0)-(s.$.clientHeight||0);o=Math.max(t-(n?0:r),0),t=n?t+r:t,s.setStyle("height",o+"px"),a&&(a.style.width="100%"),this.fire("resize",{outerHeight:t,contentsHeight:o,outerWidth:e||i.getSize("width")})},CKEDITOR.editor.prototype.getResizable=function(e){return e?this.ui.space("contents"):this.container},CKEDITOR.domReady((function(){CKEDITOR.replaceClass&&CKEDITOR.replaceAll(CKEDITOR.replaceClass)}))}(),CKEDITOR.config.startupMode="wysiwyg",function(){function e(e){var t,i=e.editor,o=e.data.path,a=o.blockLimit,r=e.data.selection,l=r.getRanges()[0];(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller)&&(r=function(e,t){if(e.isFake)return 0;var i=t.block||t.blockLimit,o=i&&i.getLast(n);return!i||!i.isBlockBoundary()||o&&o.type==CKEDITOR.NODE_ELEMENT&&o.isBlockBoundary()||i.is("pre")||i.getBogus()?void 0:i}(r,o))&&(r.appendBogus(),t=CKEDITOR.env.ie),s(i,o.block,a)&&l.collapsed&&!l.getCommonAncestor().isReadOnly()&&((o=l.clone()).enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),(a=new CKEDITOR.dom.walker(o)).guard=function(e){return!n(e)||e.type==CKEDITOR.NODE_COMMENT||e.isReadOnly()},!a.checkForward()||o.checkStartOfBlock()&&o.checkEndOfBlock())&&(i=l.fixBlock(!0,i.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p"),CKEDITOR.env.needsBrFiller||(i=i.getFirst(n))&&i.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(i.getText()).match(/^(?:&nbsp;|\xa0)$/)&&i.remove(),t=1,e.cancel()),t&&l.select()}function t(e){var t=e.data.getTarget();t.is("input")&&("submit"!=(t=t.getAttribute("type"))&&"reset"!=t||e.data.preventDefault())}function n(e){return c(e)&&d(e)}function i(e,t){return function(n){var i=n.data.$.toElement||n.data.$.fromElement||n.data.$.relatedTarget;(i=i&&i.nodeType==CKEDITOR.NODE_ELEMENT?new CKEDITOR.dom.element(i):null)&&(t.equals(i)||t.contains(i))||e.call(this,n)}}function o(e){function t(e){return function(t,o){if(o&&t.type==CKEDITOR.NODE_ELEMENT&&t.is(s)&&(i=t),!(o||!n(t)||e&&h(t)))return!1}}var i,o=e.getRanges()[0];e=e.root;var s={table:1,ul:1,ol:1,dl:1};if(o.startPath().contains(s)){var a=o.clone();if(a.collapse(1),a.setStartAt(e,CKEDITOR.POSITION_AFTER_START),(e=new CKEDITOR.dom.walker(a)).guard=t(),e.checkBackward(),i)return(a=o.clone()).collapse(),a.setEndAt(i,CKEDITOR.POSITION_AFTER_END),(e=new CKEDITOR.dom.walker(a)).guard=t(!0),i=!1,e.checkForward(),i}return null}function s(e,t,n){return!1!==e.config.autoParagraph&&e.activeEnterMode!=CKEDITOR.ENTER_BR&&(e.editable().equals(n)&&!t||t&&"true"==t.getAttribute("contenteditable"))}function a(e){return e.activeEnterMode!=CKEDITOR.ENTER_BR&&!1!==e.config.autoParagraph&&(e.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p")}function r(e){var t=e.editor;t.getSelection().scrollIntoView(),setTimeout((function(){t.fire("saveSnapshot")}),0)}function l(e,t,n){var i=e.getCommonAncestor(t);for(t=e=n?t:e;(e=e.getParent())&&!i.equals(e)&&1==e.getChildCount();)t=e;t.remove()}var c,d,u,h,p,m,_,g,f;CKEDITOR.editable=CKEDITOR.tools.createClass({base:CKEDITOR.dom.element,$:function(e,t){this.base(t.$||t),this.editor=e,this.status="unloaded",this.hasFocus=!1,this.setup()},proto:{focus:function(){var e;if(CKEDITOR.env.webkit&&!this.hasFocus&&(e=this.editor._.previousActive||this.getDocument().getActive(),this.contains(e)))e.focus();else{try{this.$[CKEDITOR.env.ie&&this.getDocument().equals(CKEDITOR.document)?"setActive":"focus"]()}catch(e){if(!CKEDITOR.env.ie)throw e}CKEDITOR.env.safari&&!this.isInline()&&((e=CKEDITOR.document.getActive()).equals(this.getWindow().getFrame())||this.getWindow().focus())}},on:function(e,t){var n=Array.prototype.slice.call(arguments,0);return CKEDITOR.env.ie&&/^focus|blur$/.exec(e)&&(e="focus"==e?"focusin":"focusout",t=i(t,this),n[0]=e,n[1]=t),CKEDITOR.dom.element.prototype.on.apply(this,n)},attachListener:function(e){!this._.listeners&&(this._.listeners=[]);var t=Array.prototype.slice.call(arguments,1);return t=e.on.apply(e,t),this._.listeners.push(t),t},clearListeners:function(){var e=this._.listeners;try{for(;e.length;)e.pop().removeListener()}catch(e){}},restoreAttrs:function(){var e,t,n=this._.attrChanges;for(t in n)n.hasOwnProperty(t)&&(null!==(e=n[t])?this.setAttribute(t,e):this.removeAttribute(t))},attachClass:function(e){var t=this.getCustomData("classes");this.hasClass(e)||(!t&&(t=[]),t.push(e),this.setCustomData("classes",t),this.addClass(e))},changeAttr:function(e,t){var n=this.getAttribute(e);t!==n&&(!this._.attrChanges&&(this._.attrChanges={}),e in this._.attrChanges||(this._.attrChanges[e]=n),this.setAttribute(e,t))},insertText:function(e){this.editor.focus(),this.insertHtml(this.transformPlainTextToHtml(e),"text")},transformPlainTextToHtml:function(e){var t=this.editor.getSelection().getStartElement().hasAscendant("pre",!0)?CKEDITOR.ENTER_BR:this.editor.activeEnterMode;return CKEDITOR.tools.transformPlainTextToHtml(e,t)},insertHtml:function(e,t,n){var i=this.editor;i.focus(),i.fire("saveSnapshot"),n||(n=i.getSelection().getRanges()[0]),m(this,t||"html",e,n),n.select(),r(this),this.editor.fire("afterInsertHtml",{})},insertHtmlIntoRange:function(e,t,n){m(this,n||"html",e,t),this.editor.fire("afterInsertHtml",{intoRange:t})},insertElement:function(e,t){(o=this.editor).focus(),o.fire("saveSnapshot");var i=o.activeEnterMode,o=o.getSelection(),s=e.getName();s=CKEDITOR.dtd.$block[s],t||(t=o.getRanges()[0]),this.insertElementIntoRange(e,t)&&(t.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),s&&((s=e.getNext((function(e){return n(e)&&!h(e)})))&&s.type==CKEDITOR.NODE_ELEMENT&&s.is(CKEDITOR.dtd.$block)?s.getDtd()["#"]?t.moveToElementEditStart(s):t.moveToElementEditEnd(e):s||i==CKEDITOR.ENTER_BR||(s=t.fixBlock(!0,i==CKEDITOR.ENTER_DIV?"div":"p"),t.moveToElementEditStart(s)))),o.selectRanges([t]),r(this)},insertElementIntoSelection:function(e){this.insertElement(e)},insertElementIntoRange:function(e,t){var n,i,o=this.editor,s=o.config.enterMode,a=e.getName(),r=CKEDITOR.dtd.$block[a];if(t.checkReadOnly())return!1;if(t.deleteContents(1),t.startContainer.type==CKEDITOR.NODE_ELEMENT&&t.startContainer.is({tr:1,table:1,tbody:1,thead:1,tfoot:1})&&_(t),r)for(;(n=t.getCommonAncestor(0,1))&&(i=CKEDITOR.dtd[n.getName()])&&(!i||!i[a]);)n.getName()in CKEDITOR.dtd.span?t.splitElement(n):t.checkStartOfBlock()&&t.checkEndOfBlock()?(t.setStartBefore(n),t.collapse(!0),n.remove()):t.splitBlock(s==CKEDITOR.ENTER_DIV?"div":"p",o.editable());return t.insertNode(e),!0},setData:function(e,t){t||(e=this.editor.dataProcessor.toHtml(e)),this.setHtml(e),this.fixInitialSelection(),"unloaded"==this.status&&(this.status="ready"),this.editor.fire("dataReady")},getData:function(e){var t=this.getHtml();return e||(t=this.editor.dataProcessor.toDataFormat(t)),t},setReadOnly:function(e){this.setAttribute("contenteditable",!e)},detach:function(){this.removeClass("cke_editable"),this.status="detached";var e=this.editor;this._.detach(),delete e.document,delete e.window},isInline:function(){return this.getDocument().equals(CKEDITOR.document)},fixInitialSelection:function(){function e(){var e,n=t.getDocument().$,i=n.getSelection();e:if(i.anchorNode&&i.anchorNode==t.$)e=!0;else{if(CKEDITOR.env.webkit&&(e=t.getDocument().getActive())&&e.equals(t)&&!i.anchorNode){e=!0;break e}e=void 0}e&&((e=new CKEDITOR.dom.range(t)).moveToElementEditStart(t),(n=n.createRange()).setStart(e.startContainer.$,e.startOffset),n.collapse(!0),i.removeAllRanges(),i.addRange(n))}var t=this;CKEDITOR.env.ie&&(9>CKEDITOR.env.version||CKEDITOR.env.quirks)?this.hasFocus&&(this.focus(),function(){var e=t.getDocument().$,n=e.selection,i=t.getDocument().getActive();"None"==n.type&&i.equals(t)&&(n=new CKEDITOR.dom.range(t),e=e.body.createTextRange(),n.moveToElementEditStart(t),(n=n.startContainer).type!=CKEDITOR.NODE_ELEMENT&&(n=n.getParent()),e.moveToElementText(n.$),e.collapse(!0),e.select())}()):this.hasFocus?(this.focus(),e()):this.once("focus",(function(){e()}),null,null,-999)},getHtmlFromRange:function(e){return e.collapsed?new CKEDITOR.dom.documentFragment(e.document):(e={doc:this.getDocument(),range:e.clone()},g.eol.detect(e,this),g.bogus.exclude(e),g.cell.shrink(e),e.fragment=e.range.cloneContents(),g.tree.rebuild(e,this),g.eol.fix(e,this),new CKEDITOR.dom.documentFragment(e.fragment.$))},extractHtmlFromRange:function(e,t){var n=f,i={range:e,doc:e.document},o=this.getHtmlFromRange(e);if(e.collapsed)return e.optimize(),o;if(e.enlarge(CKEDITOR.ENLARGE_INLINE,1),n.table.detectPurge(i),i.bookmark=e.createBookmark(),delete i.range,(a=this.editor.createRange()).moveToPosition(i.bookmark.startNode,CKEDITOR.POSITION_BEFORE_START),i.targetBookmark=a.createBookmark(),n.list.detectMerge(i,this),n.table.detectRanges(i,this),n.block.detectMerge(i,this),i.tableContentsRanges?(n.table.deleteRanges(i),e.moveToBookmark(i.bookmark),i.range=e):(e.moveToBookmark(i.bookmark),i.range=e,e.extractContents(n.detectExtractMerge(i))),e.moveToBookmark(i.targetBookmark),e.optimize(),n.fixUneditableRangePosition(e),n.list.merge(i,this),n.table.purge(i,this),n.block.merge(i,this),t){if(n=e.startPath(),i=e.checkStartOfBlock()&&e.checkEndOfBlock()&&n.block&&!e.root.equals(n.block)){e:{var s,a=0;if(i=n.block.getElementsByTag("span"))for(;s=i.getItem(a++);)if(!d(s)){i=!0;break e}i=!1}i=!i}i&&(e.moveToPosition(n.block,CKEDITOR.POSITION_BEFORE_START),n.block.remove())}else n.autoParagraph(this.editor,e),u(e.startContainer)&&e.startContainer.appendBogus();return e.startContainer.mergeSiblings(),o},setup:function(){var e=this.editor;if(this.attachListener(e,"beforeGetData",(function(){var t=this.getData();this.is("textarea")||!1!==e.config.ignoreEmptyParagraph&&(t=t.replace(p,(function(e,t){return t}))),e.setData(t,null,1)}),this),this.attachListener(e,"getSnapshot",(function(e){e.data=this.getData(1)}),this),this.attachListener(e,"afterSetData",(function(){this.setData(e.getData(1))}),this),this.attachListener(e,"loadSnapshot",(function(e){this.setData(e.data,1)}),this),this.attachListener(e,"beforeFocus",(function(){var t=e.getSelection();(t=t&&t.getNative())&&"Control"==t.type||this.focus()}),this),this.attachListener(e,"insertHtml",(function(e){this.insertHtml(e.data.dataValue,e.data.mode,e.data.range)}),this),this.attachListener(e,"insertElement",(function(e){this.insertElement(e.data)}),this),this.attachListener(e,"insertText",(function(e){this.insertText(e.data)}),this),this.setReadOnly(e.readOnly),this.attachClass("cke_editable"),e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?this.attachClass("cke_editable_inline"):e.elementMode!=CKEDITOR.ELEMENT_MODE_REPLACE&&e.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO||this.attachClass("cke_editable_themed"),this.attachClass("cke_contents_"+e.config.contentsLangDirection),e.keystrokeHandler.blockedKeystrokes[8]=+e.readOnly,e.keystrokeHandler.attach(this),this.on("blur",(function(){this.hasFocus=!1}),null,null,-1),this.on("focus",(function(){this.hasFocus=!0}),null,null,-1),e.focusManager.add(this),this.equals(CKEDITOR.document.getActive())&&(this.hasFocus=!0,e.once("contentDom",(function(){e.focusManager.focus(this)}),this)),this.isInline()&&this.changeAttr("tabindex",e.tabIndex),!this.is("textarea")){e.document=this.getDocument(),e.window=this.getWindow();var i=e.document;this.changeAttr("spellcheck",!e.config.disableNativeSpellChecker);var s=e.config.contentsLangDirection;this.getDirection(1)!=s&&this.changeAttr("dir",s);var a=CKEDITOR.getCss();if(a){var r=(s=i.getHead()).getCustomData("stylesheet");r?a!=r.getText()&&(CKEDITOR.env.ie&&9>CKEDITOR.env.version?r.$.styleSheet.cssText=a:r.setText(a)):(a=i.appendStyleText(a),a=new CKEDITOR.dom.element(a.ownerNode||a.owningElement),s.setCustomData("stylesheet",a),a.data("cke-temp",1))}s=i.getCustomData("stylesheet_ref")||0,i.setCustomData("stylesheet_ref",s+1),this.setCustomData("cke_includeReadonly",!e.config.disableReadonlyStyling),this.attachListener(this,"click",(function(e){e=e.data;var t=new CKEDITOR.dom.elementPath(e.getTarget(),this).contains("a");t&&2!=e.$.button&&t.isReadOnly()&&e.preventDefault()}));var d={8:1,46:1};this.attachListener(e,"key",(function(t){if(e.readOnly)return!0;var n;if((h=t.data.domEvent.getKey())in d){var i,s,a,r,l=(t=e.getSelection()).getRanges()[0],u=l.startPath(),h=8==h;CKEDITOR.env.ie&&11>CKEDITOR.env.version&&(i=t.getSelectedElement())||(i=o(t))?(e.fire("saveSnapshot"),l.moveToPosition(i,CKEDITOR.POSITION_BEFORE_START),i.remove(),l.select(),e.fire("saveSnapshot"),n=1):l.collapsed&&((s=u.block)&&(r=s[h?"getPrevious":"getNext"](c))&&r.type==CKEDITOR.NODE_ELEMENT&&r.is("table")&&l[h?"checkStartOfBlock":"checkEndOfBlock"]()?(e.fire("saveSnapshot"),l[h?"checkEndOfBlock":"checkStartOfBlock"]()&&s.remove(),l["moveToElementEdit"+(h?"End":"Start")](r),l.select(),e.fire("saveSnapshot"),n=1):u.blockLimit&&u.blockLimit.is("td")&&(a=u.blockLimit.getAscendant("table"))&&l.checkBoundaryOfElement(a,h?CKEDITOR.START:CKEDITOR.END)&&(r=a[h?"getPrevious":"getNext"](c))?(e.fire("saveSnapshot"),l["moveToElementEdit"+(h?"End":"Start")](r),l.checkStartOfBlock()&&l.checkEndOfBlock()?r.remove():l.select(),e.fire("saveSnapshot"),n=1):(a=u.contains(["td","th","caption"]))&&l.checkBoundaryOfElement(a,h?CKEDITOR.START:CKEDITOR.END)&&(n=1))}return!n})),e.blockless&&CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller&&this.attachListener(this,"keyup",(function(t){t.data.getKeystroke()in d&&!this.getFirst(n)&&(this.appendBogus(),(t=e.createRange()).moveToPosition(this,CKEDITOR.POSITION_AFTER_START),t.select())})),this.attachListener(this,"dblclick",(function(t){if(e.readOnly)return!1;t={element:t.data.getTarget()},e.fire("doubleclick",t)})),CKEDITOR.env.ie&&this.attachListener(this,"click",t),CKEDITOR.env.ie&&!CKEDITOR.env.edge||this.attachListener(this,"mousedown",(function(t){var n=t.data.getTarget();n.is("img","hr","input","textarea","select")&&!n.isReadOnly()&&(e.getSelection().selectElement(n),n.is("input","textarea","select")&&t.data.preventDefault())})),CKEDITOR.env.edge&&this.attachListener(this,"mouseup",(function(t){(t=t.data.getTarget())&&t.is("img")&&e.getSelection().selectElement(t)})),CKEDITOR.env.gecko&&this.attachListener(this,"mouseup",(function(t){if(2==t.data.$.button&&!(t=t.data.getTarget()).getOuterHtml().replace(p,"")){var n=e.createRange();n.moveToElementEditStart(t),n.select(!0)}})),CKEDITOR.env.webkit&&(this.attachListener(this,"click",(function(e){e.data.getTarget().is("input","select")&&e.data.preventDefault()})),this.attachListener(this,"mouseup",(function(e){e.data.getTarget().is("input","textarea")&&e.data.preventDefault()}))),CKEDITOR.env.webkit&&this.attachListener(e,"key",(function(t){if(e.readOnly)return!0;if((t=t.data.domEvent.getKey())in d){var n=8==t,i=e.getSelection().getRanges()[0];if(t=i.startPath(),i.collapsed)e:{var o=t.block;if(o&&i[n?"checkStartOfBlock":"checkEndOfBlock"]()&&i.moveToClosestEditablePosition(o,!n)&&i.collapsed){if(i.startContainer.type==CKEDITOR.NODE_ELEMENT){var s=i.startContainer.getChild(i.startOffset-(n?1:0));if(s&&s.type==CKEDITOR.NODE_ELEMENT&&s.is("hr")){e.fire("saveSnapshot"),s.remove(),t=!0;break e}}var a;!(i=i.startPath().block)||i&&i.contains(o)?t=void 0:(e.fire("saveSnapshot"),(a=(n?i:o).getBogus())&&a.remove(),s=(a=e.getSelection()).createBookmarks(),(n?o:i).moveChildren(n?i:o,!1),t.lastElement.mergeSiblings(),l(o,i,!n),a.selectBookmarks(s),t=!0)}else t=!1}else n=i,a=t.block,i=n.endPath().block,a&&i&&!a.equals(i)?(e.fire("saveSnapshot"),(o=a.getBogus())&&o.remove(),n.enlarge(CKEDITOR.ENLARGE_INLINE),n.deleteContents(),i.getParent()&&(i.moveChildren(a,!1),t.lastElement.mergeSiblings(),l(a,i,!0)),(n=e.getSelection().getRanges()[0]).collapse(1),n.optimize(),""===n.startContainer.getHtml()&&n.startContainer.appendBogus(),n.select(),t=!0):t=!1;if(!t)return;return e.getSelection().scrollIntoView(),e.fire("saveSnapshot"),!1}}),this,null,100)}}},_:{detach:function(){var e;if(this.editor.setData(this.editor.getData(),0,1),this.clearListeners(),this.restoreAttrs(),e=this.removeCustomData("classes"))for(;e.length;)this.removeClass(e.pop());if(!this.is("textarea")){var t=(e=this.getDocument()).getHead();if(t.getCustomData("stylesheet")){var n=e.getCustomData("stylesheet_ref");--n?e.setCustomData("stylesheet_ref",n):(e.removeCustomData("stylesheet_ref"),t.removeCustomData("stylesheet").remove())}}this.editor.fire("contentDomUnload"),delete this.editor}}}),CKEDITOR.editor.prototype.editable=function(e){var t=this._.editable;return t&&e?0:(arguments.length&&(t=this._.editable=e?e instanceof CKEDITOR.editable?e:new CKEDITOR.editable(this,e):(t&&t.detach(),null)),t)},CKEDITOR.on("instanceLoaded",(function(t){var n=t.editor;n.on("insertElement",(function(e){(e=e.data).type==CKEDITOR.NODE_ELEMENT&&(e.is("input")||e.is("textarea"))&&("false"!=e.getAttribute("contentEditable")&&e.data("cke-editable",e.hasAttribute("contenteditable")?"true":"1"),e.setAttribute("contentEditable",!1))})),n.on("selectionChange",(function(t){if(!n.readOnly){var i=n.getSelection();i&&!i.isLocked&&(i=n.checkDirty(),n.fire("lockSnapshot"),e(t),n.fire("unlockSnapshot"),!i&&n.resetDirty())}}))})),CKEDITOR.on("instanceCreated",(function(e){var t=e.editor;t.on("mode",(function(){var e=t.editable();if(e&&e.isInline()){var n=t.title;if(e.changeAttr("role","textbox"),e.changeAttr("aria-label",n),n&&e.changeAttr("title",n),(o=t.fire("ariaEditorHelpLabel",{}).label)&&(n=this.ui.space(this.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"top":"contents"))){var i=CKEDITOR.tools.getNextId(),o=CKEDITOR.dom.element.createFromHtml('<span id="'+i+'" class="cke_voice_label">'+o+"</span>");n.append(o),e.changeAttr("aria-describedby",i)}}}))})),CKEDITOR.addCss(".cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}"),c=CKEDITOR.dom.walker.whitespaces(!0),d=CKEDITOR.dom.walker.bookmark(!1,!0),u=CKEDITOR.dom.walker.empty(),h=CKEDITOR.dom.walker.bogus(),p=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center|pre)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi,m=function(){function e(e){return e.type==CKEDITOR.NODE_ELEMENT}function t(n,i){var o,s=[],a=n.getChildren(),r=a.count(),c=0,d=l[i],u=!n.is(l.$inline)||n.is("br");for(u&&s.push(" ");c<r;c++)e(o=a.getItem(c))&&!o.is(d)?s=s.concat(t(o,i)):s.push(o);return u&&s.push(" "),s}function i(t){return e(t.startContainer)&&t.startContainer.getChild(t.startOffset-1)}function o(t){return t&&e(t)&&(t.is(l.$removeEmpty)||t.is("a")&&!t.isBlockBoundary())}function r(t,n,i,o){var s,a,l=t.clone();l.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),(s=new CKEDITOR.dom.walker(l).next())&&e(s)&&c[s.getName()]&&(a=s.getPrevious())&&e(a)&&!a.getParent().equals(t.startContainer)&&i.contains(a)&&o.contains(s)&&s.isIdentical(a)&&(s.moveChildren(a),s.remove(),r(t,n,i,o))}var l=CKEDITOR.dtd,c={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,li:1,pre:1,dl:1,blockquote:1},d={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},u=CKEDITOR.tools.extend({},l.$inline);return delete u.br,function(c,h,p,m){var _=c.editor,g=!1;if("unfiltered_html"==h&&(h="html",g=!0),!m.checkReadOnly()){var f,b,v;if(h=(c={type:h,dontFilter:g,editable:c,editor:_,range:m,blockLimit:D=new CKEDITOR.dom.elementPath(m.startContainer,m.root).blockLimit||m.root,mergeCandidates:[],zombies:[]}).range,m=c.mergeCandidates,"text"==c.type&&h.shrink(CKEDITOR.SHRINK_ELEMENT,!0,!1)&&(f=CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",h.document),h.insertNode(f),h.setStartAfter(f)),g=new CKEDITOR.dom.elementPath(h.startContainer),c.endPath=D=new CKEDITOR.dom.elementPath(h.endContainer),!h.collapsed){_=D.block||D.blockLimit;var A=h.getCommonAncestor();_&&!_.equals(A)&&!_.contains(A)&&h.checkEndOfBlock()&&c.zombies.push(_),h.deleteContents()}for(;(b=i(h))&&e(b)&&b.isBlockBoundary()&&g.contains(b);)h.moveToPosition(b,CKEDITOR.POSITION_BEFORE_END);for(r(h,c.blockLimit,g,D),f&&(h.setEndBefore(f),h.collapse(),f.remove()),(_=(f=h.startPath()).contains(o,!1,1))&&(h.splitElement(_),c.inlineStylesRoot=_,c.inlineStylesPeak=f.lastElement),(_=(f=h.createBookmark()).startNode.getPrevious(n))&&e(_)&&o(_)&&m.push(_),(_=f.startNode.getNext(n))&&e(_)&&o(_)&&m.push(_),_=f.startNode;(_=_.getParent())&&o(_);)m.push(_);if(h.moveToBookmark(f),f=p){if(f=c.range,"text"==c.type&&c.inlineStylesRoot){for(h=(b=c.inlineStylesPeak).getDocument().createText("{cke-peak}"),m=c.inlineStylesRoot.getParent();!b.equals(m);)h=h.appendTo(b.clone()),b=b.getParent();p=h.getOuterHtml().split("{cke-peak}").join(p)}if(b=c.blockLimit.getName(),/^\s+|\s+$/.test(p)&&"span"in CKEDITOR.dtd[b]&&(p=(w='<span data-cke-marker="1">&nbsp;</span>')+p+w),p=c.editor.dataProcessor.toHtml(p,{context:null,fixForBody:!1,protectedWhitespaces:!!w,dontFilter:c.dontFilter,filter:c.editor.activeFilter,enterMode:c.editor.activeEnterMode}),(b=f.document.createElement("body")).setHtml(p),w&&(b.getFirst().remove(),b.getLast().remove()),(w=f.startPath().block)&&(1!=w.getChildCount()||!w.getBogus()))e:{var E;if(1==b.getChildCount()&&e(E=b.getFirst())&&E.is(d)&&!E.hasAttribute("contenteditable")){for(f=0,m=(w=E.getElementsByTag("*")).count();f<m;f++)if(!(h=w.getItem(f)).is(u))break e;E.moveChildren(E.getParent(1)),E.remove()}}c.dataWrapper=b,f=p}if(f){var T;f=(E=c.range).document,b=c.blockLimit,m=0;var C,y,M,I,S,w=[];p=_=0,h=E.startContainer;var N,D=(g=c.endPath.elements[0]).getPosition(h);for(A=!(!g.getCommonAncestor(h)||D==CKEDITOR.POSITION_IDENTICAL||D&CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED),function(t,n){function i(t,n){if(n.isBlock&&n.isElement&&!n.node.is("br")&&e(t)&&t.is("br"))return t.remove(),1}var o=n.endContainer.getChild(n.endOffset),s=n.endContainer.getChild(n.endOffset-1);o&&i(o,t[t.length-1]),s&&i(s,t[0])&&(n.setEnd(n.endContainer,n.endOffset-1),n.collapse())}(h=function t(n,i){var o,s,a,r,c=[],d=i.range.startContainer;o=i.range.startPath(),d=l[d.getName()];for(var u=0,h=n.getChildren(),p=h.count(),m=-1,_=-1,g=0,f=o.contains(l.$list);u<p;++u)e(o=h.getItem(u))?(a=o.getName(),f&&a in CKEDITOR.dtd.$list?c=c.concat(t(o,i)):(r=!!d[a],"br"!=a||!o.data("cke-eol")||u&&u!=p-1||(g=(s=u?c[u-1].node:h.getItem(u+1))&&(!e(s)||!s.is("br")),s=s&&e(s)&&l.$block[s.getName()]),-1!=m||r||(m=u),r||(_=u),c.push({isElement:1,isLineBreak:g,isBlock:o.isBlockBoundary(),hasBlockSibling:s,node:o,name:a,allowed:r}),s=g=0)):c.push({isElement:0,node:o,allowed:1});return-1<m&&(c[m].firstNotAllowed=1),-1<_&&(c[_].lastNotAllowed=1),c}(c.dataWrapper,c),E);m<h.length;m++){if(T=(D=h[m]).isLineBreak){T=E,I=b;var L=void 0,O=void 0;D.hasBlockSibling?T=1:(L=T.startContainer.getAscendant(l.$block,1))&&L.is({div:1,p:1})?(O=L.getPosition(I))==CKEDITOR.POSITION_IDENTICAL||O==CKEDITOR.POSITION_CONTAINS?T=0:(I=T.splitElement(L),T.moveToPosition(I,CKEDITOR.POSITION_AFTER_START),T=1):T=0}if(T)p=0<m;else{if(T=E.startPath(),!D.isBlock&&s(c.editor,T.block,T.blockLimit)&&(M=a(c.editor))&&((M=f.createElement(M)).appendBogus(),E.insertNode(M),CKEDITOR.env.needsBrFiller&&(C=M.getBogus())&&C.remove(),E.moveToPosition(M,CKEDITOR.POSITION_BEFORE_END)),(T=E.startPath().block)&&!T.equals(y)&&((C=T.getBogus())&&(C.remove(),w.push(T)),y=T),D.firstNotAllowed&&(_=1),_&&D.isElement){for(T=E.startContainer,I=null;T&&!l[T.getName()][D.name];){if(T.equals(b)){T=null;break}I=T,T=T.getParent()}if(T)I&&(S=E.splitElement(I),c.zombies.push(S),c.zombies.push(I));else{I=b.getName(),N=!m,T=m==h.length-1,L=[],O=(I=t(D.node,I)).length;for(var P=0,x=void 0,R=0,k=-1;P<O;P++)" "==(x=I[P])?(R||N&&!P||(L.push(new CKEDITOR.dom.text(" ")),k=L.length),R=1):(L.push(x),R=0);T&&k==L.length&&L.pop(),N=L}}if(N){for(;T=N.pop();)E.insertNode(T);N=0}else E.insertNode(D.node);D.lastNotAllowed&&m<h.length-1&&((S=A?g:S)&&E.setEndAt(S,CKEDITOR.POSITION_AFTER_START),_=0),E.collapse()}}(C=1==h.length&&((C=h[0]).isElement&&"false"==C.node.getAttribute("contenteditable")))&&(p=!0,T=h[0].node,E.setStartAt(T,CKEDITOR.POSITION_BEFORE_START),E.setEndAt(T,CKEDITOR.POSITION_AFTER_END)),c.dontMoveCaret=p,c.bogusNeededBlocks=w}for(C=c.range,S=c.bogusNeededBlocks,N=C.createBookmark();y=c.zombies.pop();)y.getParent()&&((M=C.clone()).moveToElementEditStart(y),M.removeEmptyBlocksAtEnd());if(S)for(;y=S.pop();)CKEDITOR.env.needsBrFiller?y.appendBogus():y.append(C.document.createText(" "));for(;y=c.mergeCandidates.pop();)y.mergeSiblings();if(C.moveToBookmark(N),!c.dontMoveCaret){for(y=i(C);y&&e(y)&&!y.is(l.$empty);){if(y.isBlockBoundary())C.moveToPosition(y,CKEDITOR.POSITION_BEFORE_END);else{if(o(y)&&y.getHtml().match(/(\s|&nbsp;)$/g)){v=null;break}(v=C.clone()).moveToPosition(y,CKEDITOR.POSITION_BEFORE_END)}y=y.getLast(n)}v&&C.moveToRange(v)}}}}(),_=function(){function e(e){return(e=new CKEDITOR.dom.walker(e)).guard=function(e,t){return!t&&(e.type==CKEDITOR.NODE_ELEMENT?e.is(CKEDITOR.dtd.$tableContent):void 0)},e.evaluator=function(e){return e.type==CKEDITOR.NODE_ELEMENT},e}function t(e,t,n){return t=e.getDocument().createElement(t),e.append(t,n),t}function n(e){for(var t,n=e.count();0<n--;)t=e.getItem(n),CKEDITOR.tools.trim(t.getHtml())||(t.appendBogus(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&t.getChildCount()&&t.getFirst().remove())}return function(i){var o=i.startContainer,s=o.getAscendant("table",1),a=!1;n(s.getElementsByTag("td")),n(s.getElementsByTag("th")),(s=i.clone()).setStart(o,0),(s=e(s).lastBackward())||((s=i.clone()).setEndAt(o,CKEDITOR.POSITION_BEFORE_END),s=e(s).lastForward(),a=!0),s||(s=o),s.is("table")?(i.setStartAt(s,CKEDITOR.POSITION_BEFORE_START),i.collapse(!0),s.remove()):(s.is({tbody:1,thead:1,tfoot:1})&&(s=t(s,"tr",a)),s.is("tr")&&(s=t(s,s.getParent().is("thead")?"th":"td",a)),(o=s.getBogus())&&o.remove(),i.moveToPosition(s,a?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END))}}(),g={eol:{detect:function(e,t){var n=e.range,i=n.clone(),o=n.clone(),s=new CKEDITOR.dom.elementPath(n.startContainer,t),a=new CKEDITOR.dom.elementPath(n.endContainer,t);i.collapse(1),o.collapse(),s.block&&i.checkBoundaryOfElement(s.block,CKEDITOR.END)&&(n.setStartAfter(s.block),e.prependEolBr=1),a.block&&o.checkBoundaryOfElement(a.block,CKEDITOR.START)&&(n.setEndBefore(a.block),e.appendEolBr=1)},fix:function(e,t){var n,i=t.getDocument();e.appendEolBr&&(n=this.createEolBr(i),e.fragment.append(n)),!e.prependEolBr||n&&!n.getPrevious()||e.fragment.append(this.createEolBr(i),1)},createEolBr:function(e){return e.createElement("br",{attributes:{"data-cke-eol":1}})}},bogus:{exclude:function(e){var t,n=(t=e.range.getBoundaryNodes()).startNode;!(t=t.endNode)||!h(t)||n&&n.equals(t)||e.range.setEndBefore(t)}},tree:{rebuild:function(e,t){var n,i=(a=e.range).getCommonAncestor(),o=new CKEDITOR.dom.elementPath(i,t),s=new CKEDITOR.dom.elementPath(a.startContainer,t),a=new CKEDITOR.dom.elementPath(a.endContainer,t);if(i.type==CKEDITOR.NODE_TEXT&&(i=i.getParent()),o.blockLimit.is({tr:1,table:1})){var r=o.contains("table").getParent();n=function(e){return!e.equals(r)}}else if(o.block&&o.block.is(CKEDITOR.dtd.$listItem)&&(s=s.contains(CKEDITOR.dtd.$list),a=a.contains(CKEDITOR.dtd.$list),!s.equals(a))){var l=o.contains(CKEDITOR.dtd.$list).getParent();n=function(e){return!e.equals(l)}}n||(n=function(e){return!e.equals(o.block)&&!e.equals(o.blockLimit)}),this.rebuildFragment(e,t,i,n)},rebuildFragment:function(e,t,n,i){for(var o;n&&!n.equals(t)&&i(n);)o=n.clone(0,1),e.fragment.appendTo(o),e.fragment=o,n=n.getParent()}},cell:{shrink:function(e){var t=(e=e.range).startContainer,n=e.endContainer,i=e.startOffset,o=e.endOffset;t.type==CKEDITOR.NODE_ELEMENT&&t.equals(n)&&t.is("tr")&&++i==o&&e.shrink(CKEDITOR.SHRINK_TEXT)}}},f=function(){function e(e,t){var n=e.getParent();n.is(CKEDITOR.dtd.$inline)&&e[t?"insertBefore":"insertAfter"](n)}function t(t,n,i){e(n),e(i,1);for(var o;o=i.getNext();)o.insertAfter(n),n=o;u(t)&&t.remove()}function n(e,t){var n=new CKEDITOR.dom.range(e);return n.setStartAfter(t.startNode),n.setEndBefore(t.endNode),n}return{list:{detectMerge:function(e,t){var i=n(t,e.bookmark),o=i.startPath(),s=i.endPath(),a=o.contains(CKEDITOR.dtd.$list),r=s.contains(CKEDITOR.dtd.$list);e.mergeList=a&&r&&a.getParent().equals(r.getParent())&&!a.equals(r),e.mergeListItems=o.block&&s.block&&o.block.is(CKEDITOR.dtd.$listItem)&&s.block.is(CKEDITOR.dtd.$listItem),(e.mergeList||e.mergeListItems)&&((i=i.clone()).setStartBefore(e.bookmark.startNode),i.setEndAfter(e.bookmark.endNode),e.mergeListBookmark=i.createBookmark())},merge:function(e,n){if(e.mergeListBookmark){var i=e.mergeListBookmark.startNode,o=e.mergeListBookmark.endNode,s=new CKEDITOR.dom.elementPath(i,n),a=new CKEDITOR.dom.elementPath(o,n);if(e.mergeList){var r=s.contains(CKEDITOR.dtd.$list),l=a.contains(CKEDITOR.dtd.$list);r.equals(l)||(l.moveChildren(r),l.remove())}e.mergeListItems&&(s=s.contains(CKEDITOR.dtd.$listItem),a=a.contains(CKEDITOR.dtd.$listItem),s.equals(a)||t(a,i,o)),i.remove(),o.remove()}}},block:{detectMerge:function(e,t){if(!e.tableContentsRanges&&!e.mergeListBookmark){var n=new CKEDITOR.dom.range(t);n.setStartBefore(e.bookmark.startNode),n.setEndAfter(e.bookmark.endNode),e.mergeBlockBookmark=n.createBookmark()}},merge:function(e,n){if(e.mergeBlockBookmark&&!e.purgeTableBookmark){var i=e.mergeBlockBookmark.startNode,o=e.mergeBlockBookmark.endNode,s=new CKEDITOR.dom.elementPath(i,n),a=new CKEDITOR.dom.elementPath(o,n);s=s.block,a=a.block,s&&a&&!s.equals(a)&&t(a,i,o),i.remove(),o.remove()}}},table:function(){function e(e){var n,o=[],s=new CKEDITOR.dom.walker(e),a=e.startPath().contains(i),r=e.endPath().contains(i),l={};return s.guard=function(s,c){if(s.type==CKEDITOR.NODE_ELEMENT){var d="visited_"+(c?"out":"in");if(s.getCustomData(d))return;CKEDITOR.dom.element.setMarker(l,s,d,1)}c&&a&&s.equals(a)?((n=e.clone()).setEndAt(a,CKEDITOR.POSITION_BEFORE_END),o.push(n)):!c&&r&&s.equals(r)?((n=e.clone()).setStartAt(r,CKEDITOR.POSITION_AFTER_START),o.push(n)):((d=!c)&&(d=s.type==CKEDITOR.NODE_ELEMENT&&s.is(i)&&(!a||t(s,a))&&(!r||t(s,r))),d&&((n=e.clone()).selectNodeContents(s),o.push(n)))},s.lastForward(),CKEDITOR.dom.element.clearAllMarkers(l),o}function t(e,t){var n=CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED,i=e.getPosition(t);return i!==CKEDITOR.POSITION_IDENTICAL&&0==(i&n)}var i={td:1,th:1,caption:1};return{detectPurge:function(e){var t=e.range;(n=t.clone()).enlarge(CKEDITOR.ENLARGE_ELEMENT);var n=new CKEDITOR.dom.walker(n),o=0;if(n.evaluator=function(e){e.type==CKEDITOR.NODE_ELEMENT&&e.is(i)&&++o},n.checkForward(),1<o){n=t.startPath().contains("table");var s=t.endPath().contains("table");n&&s&&t.checkBoundaryOfElement(n,CKEDITOR.START)&&t.checkBoundaryOfElement(s,CKEDITOR.END)&&((t=e.range.clone()).setStartBefore(n),t.setEndAfter(s),e.purgeTableBookmark=t.createBookmark())}},detectRanges:function(o,s){var a,r,l=n(s,o.bookmark),c=l.clone(),d=l.getCommonAncestor();d.is(CKEDITOR.dtd.$tableContent)&&!d.is(i)&&(d=d.getAscendant("table",!0)),r=d,d=new CKEDITOR.dom.elementPath(l.startContainer,r),r=new CKEDITOR.dom.elementPath(l.endContainer,r),d=d.contains("table"),r=r.contains("table"),(d||r)&&(d&&r&&t(d,r)?(o.tableSurroundingRange=c,c.setStartAt(d,CKEDITOR.POSITION_AFTER_END),c.setEndAt(r,CKEDITOR.POSITION_BEFORE_START),(c=l.clone()).setEndAt(d,CKEDITOR.POSITION_AFTER_END),(a=l.clone()).setStartAt(r,CKEDITOR.POSITION_BEFORE_START),a=e(c).concat(e(a))):d?r||(o.tableSurroundingRange=c,c.setStartAt(d,CKEDITOR.POSITION_AFTER_END),l.setEndAt(d,CKEDITOR.POSITION_AFTER_END)):(o.tableSurroundingRange=c,c.setEndAt(r,CKEDITOR.POSITION_BEFORE_START),l.setStartAt(r,CKEDITOR.POSITION_AFTER_START)),o.tableContentsRanges=a||e(l))},deleteRanges:function(e){for(var t;t=e.tableContentsRanges.pop();)t.extractContents(),u(t.startContainer)&&t.startContainer.appendBogus();e.tableSurroundingRange&&e.tableSurroundingRange.extractContents()},purge:function(e){if(e.purgeTableBookmark){var t=e.doc,n=e.range.clone();(t=t.createElement("p")).insertBefore(e.purgeTableBookmark.startNode),n.moveToBookmark(e.purgeTableBookmark),n.deleteContents(),e.range.moveToPosition(t,CKEDITOR.POSITION_AFTER_START)}}}}(),detectExtractMerge:function(e){return!(e.range.startPath().contains(CKEDITOR.dtd.$listItem)&&e.range.endPath().contains(CKEDITOR.dtd.$listItem))},fixUneditableRangePosition:function(e){e.startContainer.getDtd()["#"]||e.moveToClosestEditablePosition(null,!0)},autoParagraph:function(e,t){var n,i=t.startPath();s(e,i.block,i.blockLimit)&&(n=a(e))&&((n=t.document.createElement(n)).appendBogus(),t.insertNode(n),t.moveToPosition(n,CKEDITOR.POSITION_AFTER_START))}}}()}(),function(){function e(){var e,t=this._.fakeSelection;t&&((e=this.getSelection(1))&&e.isHidden()||(t.reset(),t=0)),(t||(t=e||this.getSelection(1))&&t.getType()!=CKEDITOR.SELECTION_NONE)&&(this.fire("selectionCheck",t),(e=this.elementPath()).compare(this._.selectionPreviousPath)||(CKEDITOR.env.webkit&&(this._.previousActive=this.document.getActive()),this._.selectionPreviousPath=e,this.fire("selectionChange",{selection:t,path:e})))}function t(){c=!0,l||(n.call(this),l=CKEDITOR.tools.setTimeout(n,200,this))}function n(){l=null,c&&(CKEDITOR.tools.setTimeout(e,0,this),c=!1)}function i(e){return!(!d(e)&&(e.type!=CKEDITOR.NODE_ELEMENT||e.is(CKEDITOR.dtd.$empty)))}function o(e){function t(t,n){return!(!t||t.type==CKEDITOR.NODE_TEXT)&&e.clone()["moveToElementEdit"+(n?"End":"Start")](t)}if(!(e.root instanceof CKEDITOR.editable))return!1;var n=e.startContainer,o=e.getPreviousNode(i,null,n),s=e.getNextNode(i,null,n);return!(!t(o)&&!t(s,1)&&(o||s||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary()&&n.getBogus()))}function s(e){a(e,!1);var t=e.getDocument().createText(_);return e.setCustomData("cke-fillingChar",t),t}function a(e,t){var n=e&&e.removeCustomData("cke-fillingChar");if(n){if(!1!==t){var i=e.getDocument().getSelection().getNative(),o=i&&"None"!=i.type&&i.getRangeAt(0),s=_.length;if(n.getLength()>s&&o&&o.intersectsNode(n.$)){var a=[{node:i.anchorNode,offset:i.anchorOffset},{node:i.focusNode,offset:i.focusOffset}];i.anchorNode==n.$&&i.anchorOffset>s&&(a[0].offset-=s),i.focusNode==n.$&&i.focusOffset>s&&(a[1].offset-=s)}}n.setText(r(n.getText(),1)),a&&(i=(n=e.getDocument().$).getSelection(),(n=n.createRange()).setStart(a[0].node,a[0].offset),n.collapse(!0),i.removeAllRanges(),i.addRange(n),i.extend(a[1].node,a[1].offset))}}function r(e,t){return t?e.replace(g,(function(e,t){return t?" ":""})):e.replace(_,"")}var l,c,d=CKEDITOR.dom.walker.invisible(1),u=function(){function e(e){return function(t){var n=t.editor.createRange();return n.moveToClosestEditablePosition(t.selected,e)&&t.editor.getSelection().selectRanges([n]),!1}}function t(e){return function(t){var n,i=t.editor,o=i.createRange();return(n=o.moveToClosestEditablePosition(t.selected,e))||(n=o.moveToClosestEditablePosition(t.selected,!e)),n&&i.getSelection().selectRanges([o]),i.fire("saveSnapshot"),t.selected.remove(),n||(o.moveToElementEditablePosition(i.editable()),i.getSelection().selectRanges([o])),i.fire("saveSnapshot"),!1}}var n=e(),i=e(1);return{37:n,38:n,39:i,40:i,8:t(),46:t(1)}}();CKEDITOR.on("instanceCreated",(function(n){function i(){var e=o.getSelection();e&&e.removeAllRanges()}var o=n.editor;o.on("contentDom",(function(){function n(){(r=new CKEDITOR.dom.selection(o.getSelection())).lock()}function i(){u.removeListener("mouseup",i),_.removeListener("mouseup",i);var e=CKEDITOR.document.$.selection,t=e.createRange();"None"!=e.type&&t.parentElement().ownerDocument==d.$&&t.select()}var s,r,l,c,d=o.document,u=CKEDITOR.document,p=o.editable(),m=d.getBody(),_=d.getDocumentElement(),g=p.isInline();CKEDITOR.env.gecko&&p.attachListener(p,"focus",(function(e){e.removeListener(),0!==s&&(e=o.getSelection().getNative())&&e.isCollapsed&&e.anchorNode==p.$&&((e=o.createRange()).moveToElementEditStart(p),e.select())}),null,null,-2),p.attachListener(p,CKEDITOR.env.webkit?"DOMFocusIn":"focus",(function(){s&&CKEDITOR.env.webkit&&(s=o._.previousActive&&o._.previousActive.equals(d.getActive())),o.unlockSelection(s),s=0}),null,null,-1),p.attachListener(p,"mousedown",(function(){s=0})),(CKEDITOR.env.ie||g)&&(h?p.attachListener(p,"beforedeactivate",n,null,null,-1):p.attachListener(o,"selectionCheck",n,null,null,-1),p.attachListener(p,CKEDITOR.env.webkit?"DOMFocusOut":"blur",(function(){o.lockSelection(r),s=1}),null,null,-1),p.attachListener(p,"mousedown",(function(){s=0}))),CKEDITOR.env.ie&&!g&&(p.attachListener(p,"mousedown",(function(e){2==e.data.$.button&&((e=o.document.getSelection())&&e.getType()!=CKEDITOR.SELECTION_NONE||(l=o.window.getScrollPosition()))})),p.attachListener(p,"mouseup",(function(e){2==e.data.$.button&&l&&(o.document.$.documentElement.scrollLeft=l.x,o.document.$.documentElement.scrollTop=l.y),l=null})),"BackCompat"!=d.$.compatMode&&((CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&_.on("mousedown",(function(e){function t(e){if(e=e.data.$,i){var t=m.$.createTextRange();try{t.moveToPoint(e.clientX,e.clientY)}catch(e){}i.setEndPoint(0>o.compareEndPoints("StartToStart",t)?"EndToEnd":"StartToStart",t),i.select()}}function n(){_.removeListener("mousemove",t),u.removeListener("mouseup",n),_.removeListener("mouseup",n),i.select()}if((e=e.data).getTarget().is("html")&&e.$.y<_.$.clientHeight&&e.$.x<_.$.clientWidth){var i=m.$.createTextRange();try{i.moveToPoint(e.$.clientX,e.$.clientY)}catch(e){}var o=i.duplicate();_.on("mousemove",t),u.on("mouseup",n),_.on("mouseup",n)}})),7<CKEDITOR.env.version&&11>CKEDITOR.env.version&&_.on("mousedown",(function(e){e.data.getTarget().is("html")&&(u.on("mouseup",i),_.on("mouseup",i))})))),p.attachListener(p,"selectionchange",e,o),p.attachListener(p,"keyup",t,o),p.attachListener(p,CKEDITOR.env.webkit?"DOMFocusIn":"focus",(function(){o.forceNextSelectionCheck(),o.selectionChange(1)})),g&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko)?(p.attachListener(p,"mousedown",(function(){c=1})),p.attachListener(d.getDocumentElement(),"mouseup",(function(){c&&t.call(o),c=0}))):p.attachListener(CKEDITOR.env.ie?p:d.getDocumentElement(),"mouseup",t,o),CKEDITOR.env.webkit&&p.attachListener(d,"keydown",(function(e){switch(e.data.getKey()){case 13:case 33:case 34:case 35:case 36:case 37:case 39:case 8:case 45:case 46:a(p)}}),null,null,-1),p.attachListener(p,"keydown",function(e){var t={37:1,39:1,8:1,46:1};return function(n){var i=n.data.getKeystroke();if(t[i]){var o=e.getSelection().getRanges(),s=o[0];1==o.length&&s.collapsed&&(i=s[38>i?"getPreviousEditableNode":"getNextEditableNode"]())&&i.type==CKEDITOR.NODE_ELEMENT&&"false"==i.getAttribute("contenteditable")&&(e.getSelection().fake(i),n.data.preventDefault(),n.cancel())}}}(o),null,null,-1)})),o.on("setData",(function(){o.unlockSelection(),CKEDITOR.env.webkit&&i()})),o.on("contentDomUnload",(function(){o.unlockSelection()})),CKEDITOR.env.ie9Compat&&o.on("beforeDestroy",i,null,null,9),o.on("dataReady",(function(){delete o._.fakeSelection,delete o._.hiddenSelectionContainer,o.selectionChange(1)})),o.on("loadSnapshot",(function(){var e=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT),t=o.editable().getLast(e);t&&t.hasAttribute("data-cke-hidden-sel")&&(t.remove(),CKEDITOR.env.gecko&&(e=o.editable().getFirst(e))&&e.is("br")&&e.getAttribute("_moz_editor_bogus_node")&&e.remove())}),null,null,100),o.on("key",(function(e){if("wysiwyg"==o.mode){var t=o.getSelection();if(t.isFake){var n=u[e.data.keyCode];if(n)return n({editor:o,selected:t.getSelectedElement(),selection:t,keyEvent:e})}}}))})),CKEDITOR.env.webkit&&CKEDITOR.on("instanceReady",(function(e){var t=e.editor;t.on("selectionChange",(function(){var e=t.editable(),n=e.getCustomData("cke-fillingChar");n&&(n.getCustomData("ready")?a(e):n.setCustomData("ready",1))}),null,null,-1),t.on("beforeSetMode",(function(){a(t.editable())}),null,null,-1),t.on("getSnapshot",(function(e){e.data&&(e.data=r(e.data))}),t,null,20),t.on("toDataFormat",(function(e){e.data.dataValue=r(e.data.dataValue)}),null,null,0)})),CKEDITOR.editor.prototype.selectionChange=function(n){(n?e:t).call(this)},CKEDITOR.editor.prototype.getSelection=function(e){return!this._.savedSelection&&!this._.fakeSelection||e?(e=this.editable())&&"wysiwyg"==this.mode?new CKEDITOR.dom.selection(e):null:this._.savedSelection||this._.fakeSelection},CKEDITOR.editor.prototype.lockSelection=function(e){return(e=e||this.getSelection(1)).getType()!=CKEDITOR.SELECTION_NONE&&(!e.isLocked&&e.lock(),this._.savedSelection=e,!0)},CKEDITOR.editor.prototype.unlockSelection=function(e){var t=this._.savedSelection;return!!t&&(t.unlock(e),delete this._.savedSelection,!0)},CKEDITOR.editor.prototype.forceNextSelectionCheck=function(){delete this._.selectionPreviousPath},CKEDITOR.dom.document.prototype.getSelection=function(){return new CKEDITOR.dom.selection(this)},CKEDITOR.dom.range.prototype.select=function(){var e=this.root instanceof CKEDITOR.editable?this.root.editor.getSelection():new CKEDITOR.dom.selection(this.root);return e.selectRanges([this]),e},CKEDITOR.SELECTION_NONE=1,CKEDITOR.SELECTION_TEXT=2,CKEDITOR.SELECTION_ELEMENT=3;var h="function"!=typeof window.getSelection,p=1;CKEDITOR.dom.selection=function(e){if(e instanceof CKEDITOR.dom.selection){var t=e;e=e.root}var n,i,o=e instanceof CKEDITOR.dom.element;if(this.rev=t?t.rev:p++,this.document=e instanceof CKEDITOR.dom.document?e:e.getDocument(),this.root=o?e:this.document.getBody(),this.isLocked=0,this._={cache:{}},t)return CKEDITOR.tools.extend(this._.cache,t._.cache),this.isFake=t.isFake,this.isLocked=t.isLocked,this;if(e=this.getNative())if(e.getRangeAt)n=(i=e.rangeCount&&e.getRangeAt(0))&&new CKEDITOR.dom.node(i.commonAncestorContainer);else{try{i=e.createRange()}catch(e){}n=i&&CKEDITOR.dom.element.get(i.item&&i.item(0)||i.parentElement())}return(!n||n.type!=CKEDITOR.NODE_ELEMENT&&n.type!=CKEDITOR.NODE_TEXT||!this.root.equals(n)&&!this.root.contains(n))&&(this._.cache.type=CKEDITOR.SELECTION_NONE,this._.cache.startElement=null,this._.cache.selectedElement=null,this._.cache.selectedText="",this._.cache.ranges=new CKEDITOR.dom.rangeList),this};var m={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1},_=CKEDITOR.tools.repeat("​",7),g=new RegExp(_+"( )?","g");CKEDITOR.tools.extend(CKEDITOR.dom.selection,{_removeFillingCharSequenceString:r,_createFillingCharSequenceNode:s,FILLING_CHAR_SEQUENCE:_}),CKEDITOR.dom.selection.prototype={getNative:function(){return void 0!==this._.cache.nativeSel?this._.cache.nativeSel:this._.cache.nativeSel=h?this.document.$.selection:this.document.getWindow().$.getSelection()},getType:h?function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_NONE;try{var n=this.getNative(),i=n.type;"Text"==i&&(t=CKEDITOR.SELECTION_TEXT),"Control"==i&&(t=CKEDITOR.SELECTION_ELEMENT),n.createRange().parentElement()&&(t=CKEDITOR.SELECTION_TEXT)}catch(e){}return e.type=t}:function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_TEXT;if((n=this.getNative())&&n.rangeCount){if(1==n.rangeCount){var n,i=(n=n.getRangeAt(0)).startContainer;i==n.endContainer&&1==i.nodeType&&1==n.endOffset-n.startOffset&&m[i.childNodes[n.startOffset].nodeName.toLowerCase()]&&(t=CKEDITOR.SELECTION_ELEMENT)}}else t=CKEDITOR.SELECTION_NONE;return e.type=t},getRanges:function(){var e=h?function(){function e(e){return new CKEDITOR.dom.node(e).getIndex()}var t=function(t,n){(t=t.duplicate()).collapse(n);var i=t.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var o,s,a,r,l=i.children,c=t.duplicate(),d=0,u=l.length-1,h=-1;d<=u;)if(o=l[h=Math.floor((d+u)/2)],c.moveToElementText(o),0<(a=c.compareEndPoints("StartToStart",t)))u=h-1;else{if(!(0>a))return{container:i,offset:e(o)};d=h+1}if(-1==h||h==l.length-1&&0>a){if(c.moveToElementText(i),c.setEndPoint("StartToStart",t),c=c.text.replace(/(\r\n|\r)/g,"\n").length,l=i.childNodes,!c)return(o=l[l.length-1]).nodeType!=CKEDITOR.NODE_TEXT?{container:i,offset:l.length}:{container:o,offset:o.nodeValue.length};for(i=l.length;0<c&&0<i;)(s=l[--i]).nodeType==CKEDITOR.NODE_TEXT&&(r=s,c-=s.nodeValue.length);return{container:r,offset:-c}}if(c.collapse(0<a),c.setEndPoint(0<a?"StartToStart":"EndToStart",t),!(c=c.text.replace(/(\r\n|\r)/g,"\n").length))return{container:i,offset:e(o)+(0<a?0:1)};for(;0<c;)try{(s=o[0<a?"previousSibling":"nextSibling"]).nodeType==CKEDITOR.NODE_TEXT&&(c-=s.nodeValue.length,r=s),o=s}catch(t){return{container:i,offset:e(o)}}return{container:r,offset:0<a?-c:r.nodeValue.length+c}};return function(){var e=(r=this.getNative())&&r.createRange(),n=this.getType();if(!r)return[];if(n==CKEDITOR.SELECTION_TEXT)return r=new CKEDITOR.dom.range(this.root),n=t(e,!0),r.setStart(new CKEDITOR.dom.node(n.container),n.offset),n=t(e),r.setEnd(new CKEDITOR.dom.node(n.container),n.offset),r.endContainer.getPosition(r.startContainer)&CKEDITOR.POSITION_PRECEDING&&r.endOffset<=r.startContainer.getIndex()&&r.collapse(),[r];if(n==CKEDITOR.SELECTION_ELEMENT){n=[];for(var i=0;i<e.length;i++){for(var o=e.item(i),s=o.parentNode,a=0,r=new CKEDITOR.dom.range(this.root);a<s.childNodes.length&&s.childNodes[a]!=o;a++);r.setStart(new CKEDITOR.dom.node(s),a),r.setEnd(new CKEDITOR.dom.node(s),a+1),n.push(r)}return n}return[]}}():function(){var e,t=[],n=this.getNative();if(!n)return t;for(var i=0;i<n.rangeCount;i++){var o=n.getRangeAt(i);(e=new CKEDITOR.dom.range(this.root)).setStart(new CKEDITOR.dom.node(o.startContainer),o.startOffset),e.setEnd(new CKEDITOR.dom.node(o.endContainer),o.endOffset),t.push(e)}return t};return function(t){var n=this._.cache,i=n.ranges;return i||(n.ranges=i=new CKEDITOR.dom.rangeList(e.call(this))),t?function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.getCommonAncestor().isReadOnly()&&e.splice(t,1),!n.collapsed){if(n.startContainer.isReadOnly())for(var i,o=n.startContainer;o&&!((i=o.type==CKEDITOR.NODE_ELEMENT)&&o.is("body")||!o.isReadOnly());)i&&"false"==o.getAttribute("contentEditable")&&n.setStartAfter(o),o=o.getParent();o=n.startContainer,i=n.endContainer;var s=n.startOffset,a=n.endOffset,r=n.clone();o&&o.type==CKEDITOR.NODE_TEXT&&(s>=o.getLength()?r.setStartAfter(o):r.setStartBefore(o)),i&&i.type==CKEDITOR.NODE_TEXT&&(a?r.setEndAfter(i):r.setEndBefore(i)),(o=new CKEDITOR.dom.walker(r)).evaluator=function(i){if(i.type==CKEDITOR.NODE_ELEMENT&&i.isReadOnly()){var o=n.clone();return n.setEndBefore(i),n.collapsed&&e.splice(t--,1),i.getPosition(r.endContainer)&CKEDITOR.POSITION_CONTAINS||(o.setStartAfter(i),o.collapsed||e.splice(t+1,0,o)),!0}return!1},o.next()}}return e}(new CKEDITOR.dom.rangeList(i.slice())):i}}(),getStartElement:function(){var e,t=this._.cache;if(void 0!==t.startElement)return t.startElement;switch(this.getType()){case CKEDITOR.SELECTION_ELEMENT:return this.getSelectedElement();case CKEDITOR.SELECTION_TEXT:var n=this.getRanges()[0];if(n){if(n.collapsed)(e=n.startContainer).type!=CKEDITOR.NODE_ELEMENT&&(e=e.getParent());else{for(n.optimize();e=n.startContainer,n.startOffset==(e.getChildCount?e.getChildCount():e.getLength())&&!e.isBlockBoundary();)n.setStartAfter(e);if((e=n.startContainer).type!=CKEDITOR.NODE_ELEMENT)return e.getParent();if((e=e.getChild(n.startOffset))&&e.type==CKEDITOR.NODE_ELEMENT)for(n=e.getFirst();n&&n.type==CKEDITOR.NODE_ELEMENT;)e=n,n=n.getFirst();else e=n.startContainer}e=e.$}}return t.startElement=e?new CKEDITOR.dom.element(e):null},getSelectedElement:function(){var e=this._.cache;if(void 0!==e.selectedElement)return e.selectedElement;var t=this,n=CKEDITOR.tools.tryThese((function(){return t.getNative().createRange().item(0)}),(function(){for(var e,n,i=t.getRanges()[0].clone(),o=2;o&&!((e=i.getEnclosedNode())&&e.type==CKEDITOR.NODE_ELEMENT&&m[e.getName()]&&(n=e));o--)i.shrink(CKEDITOR.SHRINK_ELEMENT);return n&&n.$}));return e.selectedElement=n?new CKEDITOR.dom.element(n):null},getSelectedText:function(){var e=this._.cache;if(void 0!==e.selectedText)return e.selectedText;var t=this.getNative();return t=h?"Control"==t.type?"":t.createRange().text:t.toString(),e.selectedText=t},lock:function(){this.getRanges(),this.getStartElement(),this.getSelectedElement(),this.getSelectedText(),this._.cache.nativeSel=null,this.isLocked=1},unlock:function(e){if(this.isLocked){if(e)var t=this.getSelectedElement(),n=!t&&this.getRanges(),i=this.isFake;this.isLocked=0,this.reset(),e&&(e=t||n[0]&&n[0].getCommonAncestor())&&e.getAscendant("body",1)&&(i?this.fake(t):t?this.selectElement(t):this.selectRanges(n))}},reset:function(){this._.cache={},this.isFake=0;var e=this.root.editor;if(e&&e._.fakeSelection)if(this.rev==e._.fakeSelection.rev){delete e._.fakeSelection;var t=e._.hiddenSelectionContainer;if(t){var n=e.checkDirty();e.fire("lockSnapshot"),t.remove(),e.fire("unlockSnapshot"),!n&&e.resetDirty()}delete e._.hiddenSelectionContainer}else CKEDITOR.warn("selection-fake-reset");this.rev=p++},selectElement:function(e){var t=new CKEDITOR.dom.range(this.root);t.setStartBefore(e),t.setEndAfter(e),this.selectRanges([t])},selectRanges:function(e){var t=(t=this.root.editor)&&t._.hiddenSelectionContainer;if(this.reset(),t){t=this.root;for(var n,i=0;i<e.length;++i)(n=e[i]).endContainer.equals(t)&&(n.endOffset=Math.min(n.endOffset,t.getChildCount()))}if(e.length)if(this.isLocked){var r=CKEDITOR.document.getActive();this.unlock(),this.selectRanges(e),this.lock(),r&&!r.equals(this.root)&&r.focus()}else{var l,c,d;if(1==e.length&&!(d=e[0]).collapsed&&(l=d.getEnclosedNode())&&l.type==CKEDITOR.NODE_ELEMENT&&((d=d.clone()).shrink(CKEDITOR.SHRINK_ELEMENT,!0),(c=d.getEnclosedNode())&&c.type==CKEDITOR.NODE_ELEMENT&&(l=c),"false"==l.getAttribute("contenteditable"))||(l=void 0),l)this.fake(l);else{if(h){var u,p,_;if(d=CKEDITOR.dom.walker.whitespaces(!0),c=/\ufeff|\u00a0/,t={table:1,tbody:1,tr:1},1<e.length&&(l=e[e.length-1],e[0].setEnd(l.endContainer,l.endOffset)),e=(l=e[0]).collapsed,(n=l.getEnclosedNode())&&n.type==CKEDITOR.NODE_ELEMENT&&n.getName()in m&&(!n.is("a")||!n.getText()))try{return(_=n.$.createControlRange()).addElement(n.$),void _.select()}catch(e){}(l.startContainer.type==CKEDITOR.NODE_ELEMENT&&l.startContainer.getName()in t||l.endContainer.type==CKEDITOR.NODE_ELEMENT&&l.endContainer.getName()in t)&&(l.shrink(CKEDITOR.NODE_ELEMENT,!0),e=l.collapsed),t=(_=l.createBookmark()).startNode,e||(r=_.endNode),(_=l.document.$.body.createTextRange()).moveToElementText(t.$),_.moveStart("character",1),r?((c=l.document.$.body.createTextRange()).moveToElementText(r.$),_.setEndPoint("EndToEnd",c),_.moveEnd("character",-1)):(u=t.getNext(d),p=t.hasAscendant("pre"),u=!(u&&u.getText&&u.getText().match(c))&&(p||!t.hasPrevious()||t.getPrevious().is&&t.getPrevious().is("br")),(p=l.document.createElement("span")).setHtml("&#65279;"),p.insertBefore(t),u&&l.document.createText("\ufeff").insertBefore(t)),l.setStartBefore(t),t.remove(),e?(u?(_.moveStart("character",-1),_.select(),l.document.$.selection.clear()):_.select(),l.moveToPosition(p,CKEDITOR.POSITION_BEFORE_START),p.remove()):(l.setEndBefore(r),r.remove(),_.select())}else{if(!(r=this.getNative()))return;for(this.removeAllRanges(),_=0;_<e.length;_++)if(_<e.length-1&&(u=e[_],p=e[_+1],(c=u.clone()).setStart(u.endContainer,u.endOffset),c.setEnd(p.startContainer,p.startOffset),!c.collapsed&&(c.shrink(CKEDITOR.NODE_ELEMENT,!0),l=c.getCommonAncestor(),c=c.getEnclosedNode(),l.isReadOnly()||c&&c.isReadOnly())))p.setStart(u.startContainer,u.startOffset),e.splice(_--,1);else{l=e[_],p=this.document.$.createRange(),l.collapsed&&CKEDITOR.env.webkit&&o(l)&&(c=s(this.root),l.insertNode(c),(u=c.getNext())&&!c.getPrevious()&&u.type==CKEDITOR.NODE_ELEMENT&&"br"==u.getName()?(a(this.root),l.moveToPosition(u,CKEDITOR.POSITION_BEFORE_START)):l.moveToPosition(c,CKEDITOR.POSITION_AFTER_END)),p.setStart(l.startContainer.$,l.startOffset);try{p.setEnd(l.endContainer.$,l.endOffset)}catch(e){if(!(0<=e.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")))throw e;l.collapse(1),p.setEnd(l.endContainer.$,l.endOffset)}r.addRange(p)}}this.reset(),this.root.fire("selectionchange")}}},fake:function(e){var t=this.root.editor;this.reset(),function(e){var t=CKEDITOR.dom.element.createFromHtml('<div data-cke-hidden-sel="1" data-cke-temp="1" style="'+(CKEDITOR.env.ie?"display:none":"position:fixed;top:0;left:-1000px")+'">&nbsp;</div>',e.document);e.fire("lockSnapshot"),e.editable().append(t);var n=e.getSelection(1),i=e.createRange(),o=n.root.on("selectionchange",(function(e){e.cancel()}),null,null,0);i.setStartAt(t,CKEDITOR.POSITION_AFTER_START),i.setEndAt(t,CKEDITOR.POSITION_BEFORE_END),n.selectRanges([i]),o.removeListener(),e.fire("unlockSnapshot"),e._.hiddenSelectionContainer=t}(t);var n=this._.cache,i=new CKEDITOR.dom.range(this.root);i.setStartBefore(e),i.setEndAfter(e),n.ranges=new CKEDITOR.dom.rangeList(i),n.selectedElement=n.startElement=e,n.type=CKEDITOR.SELECTION_ELEMENT,n.selectedText=n.nativeSel=null,this.isFake=1,this.rev=p++,t._.fakeSelection=this,this.root.fire("selectionchange")},isHidden:function(){var e=this.getCommonAncestor();return e&&e.type==CKEDITOR.NODE_TEXT&&(e=e.getParent()),!(!e||!e.data("cke-hidden-sel"))},createBookmarks:function(e){return e=this.getRanges().createBookmarks(e),this.isFake&&(e.isFake=1),e},createBookmarks2:function(e){return e=this.getRanges().createBookmarks2(e),this.isFake&&(e.isFake=1),e},selectBookmarks:function(e){for(var t,n=[],i=0;i<e.length;i++){var o=new CKEDITOR.dom.range(this.root);o.moveToBookmark(e[i]),n.push(o)}return e.isFake&&((t=n[0].getEnclosedNode())&&t.type==CKEDITOR.NODE_ELEMENT||(CKEDITOR.warn("selection-not-fake"),e.isFake=0)),e.isFake?this.fake(t):this.selectRanges(n),this},getCommonAncestor:function(){var e=this.getRanges();return e.length?e[0].startContainer.getCommonAncestor(e[e.length-1].endContainer):null},scrollIntoView:function(){this.type!=CKEDITOR.SELECTION_NONE&&this.getRanges()[0].scrollIntoView()},removeAllRanges:function(){if(this.getType()!=CKEDITOR.SELECTION_NONE){var e=this.getNative();try{e&&e[h?"empty":"removeAllRanges"]()}catch(e){}this.reset()}}}}(),CKEDITOR.STYLE_BLOCK=1,CKEDITOR.STYLE_INLINE=2,CKEDITOR.STYLE_OBJECT=3,function(){function e(e,t){for(var n,i;(e=e.getParent())&&!e.equals(t);)if(e.getAttribute("data-nostyle"))n=e;else if(!i){var o=e.getAttribute("contentEditable");"false"==o?n=e:"true"==o&&(i=1)}return n}function t(e,t,n,i){return(e.getPosition(t)|i)==i&&(!n.childRule||n.childRule(e))}function n(i){var s=i.document;if(i.collapsed)s=_(this,s),i.insertNode(s),i.moveToPosition(s,CKEDITOR.POSITION_BEFORE_END);else{var a,r=this.element,l=this._.definition,c=(b=l.ignoreReadonly)||l.includeReadonly;null==c&&(c=i.root.getCustomData("cke_includeReadonly"));var d=CKEDITOR.dtd[r];d||(a=!0,d=CKEDITOR.dtd.span),i.enlarge(CKEDITOR.ENLARGE_INLINE,1),i.trim();var u,p=i.createBookmark(),m=p.startNode,g=p.endNode,f=m;if(!b){var b=e(m,v=i.getCommonAncestor()),v=e(g,v);b&&(f=b.getNextSourceNode(!0)),v&&(g=v)}for(f.getPosition(g)==CKEDITOR.POSITION_FOLLOWING&&(f=0);f;){if(b=!1,f.equals(g))f=null,b=!0;else{v=(N=f.type==CKEDITOR.NODE_ELEMENT?f.getName():null)&&"false"==f.getAttribute("contentEditable");var A=N&&f.getAttribute("data-nostyle");if(N&&f.data("cke-bookmark")){f=f.getNextSourceNode(!0);continue}if(v&&c&&CKEDITOR.dtd.$block[N])for(var E=void 0,T=0,C=(x=(P=o(C=f)).length)&&new CKEDITOR.dom.range(C.getDocument());T<x;++T){E=P[T];var y=CKEDITOR.filter.instances[E.data("cke-filter")];y&&!y.check(this)||(C.selectNodeContents(E),n.call(this,C))}if(P=N?!d[N]||A||v&&!c?0:t(f,g,l,S):1){if(P=l,x=r,T=a,!(E=f.getParent())||!(E.getDtd()||CKEDITOR.dtd.span)[x]&&!T||P.parentRule&&!P.parentRule(E))b=!0;else if(u||N&&CKEDITOR.dtd.$removeEmpty[N]&&(f.getPosition(g)|S)!=S||(u=i.clone()).setStartBefore(f),(N=f.type)==CKEDITOR.NODE_TEXT||v||N==CKEDITOR.NODE_ELEMENT&&!f.getChildCount()){for(var I,N=f;(b=!N.getNext(M))&&d[(I=N.getParent()).getName()]&&t(I,m,l,w);)N=I;u.setEndAfter(N)}}else b=!0;f=f.getNextSourceNode(A||v)}if(b&&u&&!u.collapsed){v=(b=_(this,s)).hasAttributes(),A=u.getCommonAncestor(),N={};for(var D,L,O,P={},x=(E={},{});b&&A;){if(A.getName()==r){for(D in l.attributes)!x[D]&&(O=A.getAttribute(L))&&(b.getAttribute(D)==O?P[D]=1:x[D]=1);for(L in l.styles)!E[L]&&(O=A.getStyle(L))&&(b.getStyle(L)==O?N[L]=1:E[L]=1)}A=A.getParent()}for(D in P)b.removeAttribute(D);for(L in N)b.removeStyle(L);v&&!b.hasAttributes()&&(b=null),b?(u.extractContents().appendTo(b),u.insertNode(b),h.call(this,b),b.mergeSiblings(),CKEDITOR.env.ie||b.$.normalize()):(b=new CKEDITOR.dom.element("span"),u.extractContents().appendTo(b),u.insertNode(b),h.call(this,b),b.remove(!0)),u=null}}i.moveToBookmark(p),i.shrink(CKEDITOR.SHRINK_TEXT),i.shrink(CKEDITOR.NODE_ELEMENT,!0)}}function i(e){function t(){for(var e=new CKEDITOR.dom.elementPath(i.getParent()),t=new CKEDITOR.dom.elementPath(c.getParent()),n=null,o=null,s=0;s<e.elements.length;s++){var a=e.elements[s];if(a==e.block||a==e.blockLimit)break;d.checkElementRemovable(a,!0)&&(n=a)}for(s=0;s<t.elements.length&&(a=t.elements[s])!=t.block&&a!=t.blockLimit;s++)d.checkElementRemovable(a,!0)&&(o=a);o&&c.breakParent(o),n&&i.breakParent(n)}e.enlarge(CKEDITOR.ENLARGE_INLINE,1);var n=e.createBookmark(),i=n.startNode;if(e.collapsed){for(var o,s,a=new CKEDITOR.dom.elementPath(i.getParent(),e.root),r=0;r<a.elements.length&&(s=a.elements[r])&&s!=a.block&&s!=a.blockLimit;r++)if(this.checkElementRemovable(s)){var l;e.collapsed&&(e.checkBoundaryOfElement(s,CKEDITOR.END)||(l=e.checkBoundaryOfElement(s,CKEDITOR.START)))?(o=s).match=l?"start":"end":(s.mergeSiblings(),s.is(this.element)?u.call(this,s):p(s,b(this)[s.getName()]))}if(o){for(s=i,r=0;!(l=a.elements[r]).equals(o);r++)l.match||((l=l.clone()).append(s),s=l);s["start"==o.match?"insertBefore":"insertAfter"](o)}}else{var c=n.endNode,d=this;for(t(),a=i;!a.equals(c);)o=a.getNextSourceNode(),a.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(a)&&(a.getName()==this.element?u.call(this,a):p(a,b(this)[a.getName()]),o.type==CKEDITOR.NODE_ELEMENT&&o.contains(i)&&(t(),o=i.getNext())),a=o}e.moveToBookmark(n),e.shrink(CKEDITOR.NODE_ELEMENT,!0)}function o(e){var t=[];return e.forEach((function(e){if("true"==e.getAttribute("contenteditable"))return t.push(e),!1}),CKEDITOR.NODE_ELEMENT,!0),t}function s(e){var t=e.getEnclosedNode()||e.getCommonAncestor(!1,!0);(e=new CKEDITOR.dom.elementPath(t,e.root).contains(this.element,1))&&!e.isReadOnly()&&g(e,this)}function a(e){var t=e.getCommonAncestor(!0,!0);if(e=new CKEDITOR.dom.elementPath(t,e.root).contains(this.element,1)){var n=(t=this._.definition).attributes;if(n)for(var i in n)e.removeAttribute(i,n[i]);if(t.styles)for(var o in t.styles)t.styles.hasOwnProperty(o)&&e.removeStyle(o)}}function r(e){var t=e.createBookmark(!0),n=e.createIterator();n.enforceRealBlocks=!0,this._.enterMode&&(n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR);for(var i,o=e.document;i=n.getNextParagraph();)!i.isReadOnly()&&(!n.activeFilter||n.activeFilter.check(this))&&c(i,_(this,o,i));e.moveToBookmark(t)}function l(e){var t,n,i=e.createBookmark(1),o=e.createIterator();for(o.enforceRealBlocks=!0,o.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;t=o.getNextParagraph();)this.checkElementRemovable(t)&&(t.is("pre")?((n=this._.enterMode==CKEDITOR.ENTER_BR?null:e.document.createElement(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))&&t.copyAttributes(n),c(t,n)):u.call(this,t));e.moveToBookmark(i)}function c(e,t){(n=!t)&&(t=e.getDocument().createElement("div"),e.copyAttributes(t));var n,i,o=t&&t.is("pre"),s=e.is("pre"),a=!o&&s;if(o&&!s){if(s=t,(a=e.getBogus())&&a.remove(),a=(a=(a=(a=d(a=e.getHtml(),/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"")).replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1")).replace(/([ \t\n\r]+|&nbsp;)/g," ")).replace(/<br\b[^>]*>/gi,"\n"),CKEDITOR.env.ie){var r=e.getDocument().createElement("div");r.append(s),s.$.outerHTML="<pre>"+a+"</pre>",s.copyAttributes(r.getFirst()),s=r.getFirst().remove()}else s.setHtml(a);t=s}else a?t=function(e,t){var n;1<e.length&&(n=new CKEDITOR.dom.documentFragment(t.getDocument()));for(var i=0;i<e.length;i++){var o=d(o=(o=e[i]).replace(/(\r\n|\r)/g,"\n"),/^[ \t]*\n/,"");if(o=d(o,/\n$/,""),o=(o=(o=d(o,/^[ \t]+|[ \t]+$/g,(function(e,t){return 1==e.length?"&nbsp;":t?" "+CKEDITOR.tools.repeat("&nbsp;",e.length-1):CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "}))).replace(/\n/g,"<br>")).replace(/[ \t]{2,}/g,(function(e){return CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "})),n){var s=t.clone();s.setHtml(o),n.append(s)}else t.setHtml(o)}return n||t}(n?[e.getHtml()]:function(e){var t=[];return d(e.getOuterHtml(),/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,(function(e,t,n){return t+"</pre>"+n+"<pre>"})).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,(function(e,n){t.push(n)})),t}(e),t):e.moveChildren(t);t.replace(e),o?(i=(n=t).getPrevious(I))&&i.type==CKEDITOR.NODE_ELEMENT&&i.is("pre")&&(o=d(i.getHtml(),/\n$/,"")+"\n\n"+d(n.getHtml(),/^\n/,""),CKEDITOR.env.ie?n.$.outerHTML="<pre>"+o+"</pre>":n.setHtml(o),i.remove()):n&&m(t)}function d(e,t,n){var i="",o="";return e=e.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,(function(e,t,n){return t&&(i=t),n&&(o=n),""})),i+e.replace(t,n)+o}function u(e,t){var n,i=(o=this._.definition).attributes,o=o.styles,s=b(this)[e.getName()],a=CKEDITOR.tools.isEmpty(i)&&CKEDITOR.tools.isEmpty(o);for(n in i)("class"!=n&&!this._.definition.fullMatch||e.getAttribute(n)==v(n,i[n]))&&(t&&"data-"==n.slice(0,5)||(a=e.hasAttribute(n),e.removeAttribute(n)));for(var r in o)this._.definition.fullMatch&&e.getStyle(r)!=v(r,o[r],!0)||(a=a||!!e.getStyle(r),e.removeStyle(r));p(e,s,E[e.getName()]),a&&(this._.definition.alwaysRemoveElement?m(e,1):!CKEDITOR.dtd.$block[e.getName()]||this._.enterMode==CKEDITOR.ENTER_BR&&!e.hasAttributes()?m(e):e.renameNode(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))}function h(e){for(var t,n=b(this),i=e.getElementsByTag(this.element),o=i.count();0<=--o;)(t=i.getItem(o)).isReadOnly()||u.call(this,t,!0);for(var s in n)if(s!=this.element)for(o=(i=e.getElementsByTag(s)).count()-1;0<=o;o--)(t=i.getItem(o)).isReadOnly()||p(t,n[s])}function p(e,t,n){if(t=t&&t.attributes)for(var i=0;i<t.length;i++){var o,s=t[i][0];if(o=e.getAttribute(s)){var a=t[i][1];(null===a||a.test&&a.test(o)||"string"==typeof a&&o==a)&&e.removeAttribute(s)}}n||m(e)}function m(e,t){if(!e.hasAttributes()||t)if(CKEDITOR.dtd.$block[e.getName()]){var n=e.getPrevious(I),i=e.getNext(I);!n||n.type!=CKEDITOR.NODE_TEXT&&n.isBlockBoundary({br:1})||e.append("br",1),!i||i.type!=CKEDITOR.NODE_TEXT&&i.isBlockBoundary({br:1})||e.append("br"),e.remove(!0)}else n=e.getFirst(),i=e.getLast(),e.remove(!0),n&&(n.type==CKEDITOR.NODE_ELEMENT&&n.mergeSiblings(),i&&!n.equals(i)&&i.type==CKEDITOR.NODE_ELEMENT&&i.mergeSiblings())}function _(e,t,n){var i;return"*"==(i=e.element)&&(i="span"),i=new CKEDITOR.dom.element(i,t),n&&n.copyAttributes(i),i=g(i,e),t.getCustomData("doc_processing_style")&&i.hasAttribute("id")?i.removeAttribute("id"):t.setCustomData("doc_processing_style",1),i}function g(e,t){var n=(i=t._.definition).attributes,i=CKEDITOR.style.getStyleText(i);if(n)for(var o in n)e.setAttribute(o,n[o]);return i&&e.setAttribute("style",i),e}function f(e,t){for(var n in e)e[n]=e[n].replace(y,(function(e,n){return t[n]}))}function b(e){if(e._.overrides)return e._.overrides;var t=e._.overrides={},n=e._.definition.overrides;if(n){CKEDITOR.tools.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++){var o,s;if("string"==typeof(r=n[i])?o=r.toLowerCase():(o=r.element?r.element.toLowerCase():e.element,s=r.attributes),r=t[o]||(t[o]={}),s){var a,r=r.attributes=r.attributes||[];for(a in s)r.push([a.toLowerCase(),s[a]])}}}return t}function v(e,t,n){var i=new CKEDITOR.dom.element("span");return i[n?"setStyle":"setAttribute"](e,t),i[n?"getStyle":"getAttribute"](e)}function A(e,t,n){var i=e.document,o=e.getRanges();t=t?this.removeFromRange:this.applyToRange;for(var s,a=o.createIterator();s=a.getNextRange();)t.call(this,s,n);e.selectRanges(o),i.removeCustomData("doc_processing_style")}var E={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},T={a:1,blockquote:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1},C=/\s*(?:;\s*|$)/,y=/#\((.+?)\)/g,M=CKEDITOR.dom.walker.bookmark(0,1),I=CKEDITOR.dom.walker.whitespaces(1);CKEDITOR.style=function(e,t){if("string"==typeof e.type)return new CKEDITOR.style.customHandlers[e.type](e);var n=e.attributes;n&&n.style&&(e.styles=CKEDITOR.tools.extend({},e.styles,CKEDITOR.tools.parseCssText(n.style)),delete n.style),t&&(f((e=CKEDITOR.tools.clone(e)).attributes,t),f(e.styles,t)),n=this.element=e.element?"string"==typeof e.element?e.element.toLowerCase():e.element:"*",this.type=e.type||(E[n]?CKEDITOR.STYLE_BLOCK:T[n]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE),"object"==typeof this.element&&(this.type=CKEDITOR.STYLE_OBJECT),this._={definition:e}},CKEDITOR.style.prototype={apply:function(e){if(e instanceof CKEDITOR.dom.document)return A.call(this,e.getSelection());if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),A.call(this,e.getSelection(),0,e),this._.enterMode=t}},remove:function(e){if(e instanceof CKEDITOR.dom.document)return A.call(this,e.getSelection(),1);if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),A.call(this,e.getSelection(),1,e),this._.enterMode=t}},applyToRange:function(e){return this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?n:this.type==CKEDITOR.STYLE_BLOCK?r:this.type==CKEDITOR.STYLE_OBJECT?s:null,this.applyToRange(e)},removeFromRange:function(e){return this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?i:this.type==CKEDITOR.STYLE_BLOCK?l:this.type==CKEDITOR.STYLE_OBJECT?a:null,this.removeFromRange(e)},applyToObject:function(e){g(e,this)},checkActive:function(e,t){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(e.block||e.blockLimit,!0,t);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:for(var n,i=e.elements,o=0;o<i.length;o++)if(n=i[o],this.type!=CKEDITOR.STYLE_INLINE||n!=e.block&&n!=e.blockLimit){if(this.type==CKEDITOR.STYLE_OBJECT){var s=n.getName();if(!("string"==typeof this.element?s==this.element:s in this.element))continue}if(this.checkElementRemovable(n,!0,t))return!0}}return!1},checkApplicable:function(e,t,n){if(t&&t instanceof CKEDITOR.filter&&(n=t),n&&!n.check(this))return!1;switch(this.type){case CKEDITOR.STYLE_OBJECT:return!!e.contains(this.element);case CKEDITOR.STYLE_BLOCK:return!!e.blockLimit.getDtd()[this.element]}return!0},checkElementMatch:function(e,t){var n=this._.definition;if(!e||!n.ignoreReadonly&&e.isReadOnly())return!1;var i=e.getName();if("string"==typeof this.element?i==this.element:i in this.element){if(!t&&!e.hasAttributes())return!0;if(i=n._AC)n=i;else{i={};var o=0,s=n.attributes;if(s)for(var a in s)o++,i[a]=s[a];(a=CKEDITOR.style.getStyleText(n))&&(i.style||o++,i.style=a),i._length=o,n=n._AC=i}if(!n._length)return!0;for(var r in n)if("_length"!=r){if(o=e.getAttribute(r)||"","style"==r)e:{for(a in"string"==typeof(i=n[r])&&(i=CKEDITOR.tools.parseCssText(i)),"string"==typeof o&&(o=CKEDITOR.tools.parseCssText(o,!0)),a=void 0,i)if(!(a in o)||o[a]!=i[a]&&"inherit"!=i[a]&&"inherit"!=o[a]){i=!1;break e}i=!0}else i=n[r]==o;if(i){if(!t)return!0}else if(t)return!1}if(t)return!0}return!1},checkElementRemovable:function(e,t,n){if(this.checkElementMatch(e,t,n))return!0;if(t=b(this)[e.getName()]){var i;if(!(t=t.attributes))return!0;for(n=0;n<t.length;n++)if(i=t[n][0],i=e.getAttribute(i)){var o=t[n][1];if(null===o)return!0;if("string"==typeof o){if(i==o)return!0}else if(o.test(i))return!0}}return!1},buildPreview:function(e){var t=this._.definition,n=[],i=t.element;"bdo"==i&&(i="span"),n=["<",i];var o=t.attributes;if(o)for(var s in o)n.push(" ",s,'="',o[s],'"');return(o=CKEDITOR.style.getStyleText(t))&&n.push(' style="',o,'"'),n.push(">",e||t.name,"</",i,">"),n.join("")},getDefinition:function(){return this._.definition}},CKEDITOR.style.getStyleText=function(e){if(t=e._ST)return t;var t=e.styles,n=e.attributes&&e.attributes.style||"",i="";for(var o in n.length&&(n=n.replace(C,";")),t){var s=t[o],a=(o+":"+s).replace(C,";");"inherit"==s?i+=a:n+=a}return n.length&&(n=CKEDITOR.tools.normalizeCssText(n,!0)),e._ST=n+i},CKEDITOR.style.customHandlers={},CKEDITOR.style.addCustomHandler=function(e){var t=function(e){this._={definition:e},this.setup&&this.setup(e)};return t.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.style.prototype),{assignedTo:CKEDITOR.STYLE_OBJECT},e,!0),this.customHandlers[e.type]=t};var S=CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED,w=CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED}(),CKEDITOR.styleCommand=function(e,t){this.requiredContent=this.allowedContent=this.style=e,CKEDITOR.tools.extend(this,t,!0)},CKEDITOR.styleCommand.prototype.exec=function(e){e.focus(),this.state==CKEDITOR.TRISTATE_OFF?e.applyStyle(this.style):this.state==CKEDITOR.TRISTATE_ON&&e.removeStyle(this.style)},CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet"),CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet),CKEDITOR.loadStylesSet=function(e,t,n){CKEDITOR.stylesSet.addExternal(e,t,""),CKEDITOR.stylesSet.load(e,n)},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{attachStyleStateChange:function(e,t){var n=this._.styleStateChangeCallbacks;n||(n=this._.styleStateChangeCallbacks=[],this.on("selectionChange",(function(e){for(var t=0;t<n.length;t++){var i=n[t],o=i.style.checkActive(e.data.path,this)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;i.fn.call(this,o)}}))),n.push({style:e,fn:t})},applyStyle:function(e){e.apply(this)},removeStyle:function(e){e.remove(this)},getStylesSet:function(e){if(this._.stylesDefinitions)e(this._.stylesDefinitions);else{var t=this;if(!1===(n=t.config.stylesCombo_stylesSet||t.config.stylesSet))e(null);else if(n instanceof Array)t._.stylesDefinitions=n,e(n);else{n||(n="default");var n,i=(n=n.split(":"))[0];CKEDITOR.stylesSet.addExternal(i,n[1]?n.slice(1).join(":"):CKEDITOR.getUrl("styles.js"),""),CKEDITOR.stylesSet.load(i,(function(n){t._.stylesDefinitions=n[i],e(t._.stylesDefinitions)}))}}}}),CKEDITOR.dom.comment=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createComment(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.comment.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.comment.prototype,{type:CKEDITOR.NODE_COMMENT,getOuterHtml:function(){return"\x3c!--"+this.$.nodeValue+"--\x3e"}}),function(){var e,t={},n={};for(e in CKEDITOR.dtd.$blockLimit)e in CKEDITOR.dtd.$list||(t[e]=1);for(e in CKEDITOR.dtd.$block)e in CKEDITOR.dtd.$blockLimit||e in CKEDITOR.dtd.$empty||(n[e]=1);CKEDITOR.dom.elementPath=function(e,i){var o,s=null,a=null,r=[],l=e;i=i||e.getDocument().getBody();do{if(l.type==CKEDITOR.NODE_ELEMENT){if(r.push(l),!this.lastElement&&(this.lastElement=l,l.is(CKEDITOR.dtd.$object)||"false"==l.getAttribute("contenteditable")))continue;if(l.equals(i))break;if(!a&&(o=l.getName(),"true"==l.getAttribute("contenteditable")?a=l:!s&&n[o]&&(s=l),t[o])){if(o=!s&&"div"==o){e:{for(var c=0,d=(o=l.getChildren()).count();c<d;c++){var u=o.getItem(c);if(u.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$block[u.getName()]){o=!0;break e}}o=!1}o=!o}o?s=l:a=l}}}while(l=l.getParent());a||(a=i),this.block=s,this.blockLimit=a,this.root=i,this.elements=r}}(),CKEDITOR.dom.elementPath.prototype={compare:function(e){var t=this.elements;if(!(e=e&&e.elements)||t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0},contains:function(e,t,n){var i;"string"==typeof e&&(i=function(t){return t.getName()==e}),e instanceof CKEDITOR.dom.element?i=function(t){return t.equals(e)}:CKEDITOR.tools.isArray(e)?i=function(t){return-1<CKEDITOR.tools.indexOf(e,t.getName())}:"function"==typeof e?i=e:"object"==typeof e&&(i=function(t){return t.getName()in e});var o=this.elements,s=o.length;for(t&&s--,n&&(o=Array.prototype.slice.call(o,0)).reverse(),t=0;t<s;t++)if(i(o[t]))return o[t];return null},isContextFor:function(e){return!(e in CKEDITOR.dtd.$block)||!!(this.contains(CKEDITOR.dtd.$intermediate)||this.root.equals(this.block)&&this.block||this.blockLimit).getDtd()[e]},direction:function(){return(this.block||this.blockLimit||this.root).getDirection(1)}},CKEDITOR.dom.text=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createTextNode(e)),this.$=e},CKEDITOR.dom.text.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.text.prototype,{type:CKEDITOR.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},setText:function(e){this.$.nodeValue=e},split:function(e){var t=this.$.parentNode,n=t.childNodes.length,i=this.getLength(),o=this.getDocument(),s=new CKEDITOR.dom.text(this.$.splitText(e),o);return t.childNodes.length==n&&(e>=i?(s=o.createText("")).insertAfter(this):((e=o.createText("")).insertAfter(s),e.remove())),s},substring:function(e,t){return"number"!=typeof t?this.$.nodeValue.substr(e):this.$.nodeValue.substring(e,t)}}),function(){function e(e,t,n){var i=e.serializable,o=t[n?"endContainer":"startContainer"],s=n?"endOffset":"startOffset",a=i?t.document.getById(e.startNode):e.startNode;return e=i?t.document.getById(e.endNode):e.endNode,o.equals(a.getPrevious())?(t.startOffset=t.startOffset-o.getLength()-e.getPrevious().getLength(),o=e.getNext()):o.equals(e.getPrevious())&&(t.startOffset-=o.getLength(),o=e.getNext()),o.equals(a.getParent())&&t[s]++,o.equals(e.getParent())&&t[s]++,t[n?"endContainer":"startContainer"]=o,t}CKEDITOR.dom.rangeList=function(e){return e instanceof CKEDITOR.dom.rangeList?e:(e?e instanceof CKEDITOR.dom.range&&(e=[e]):e=[],CKEDITOR.tools.extend(e,t))};var t={createIterator:function(){var e,t=this,n=CKEDITOR.dom.walker.bookmark(),i=[];return{getNextRange:function(o){var s=t[e=void 0===e?0:e+1];if(s&&1<t.length){if(!e)for(var a=t.length-1;0<=a;a--)i.unshift(t[a].createBookmark(!0));if(o)for(var r=0;t[e+r+1];){var l=s.document;for(o=0,a=l.getById(i[r].endNode),l=l.getById(i[r+1].startNode);;){if(a=a.getNextSourceNode(!1),l.equals(a))o=1;else if(n(a)||a.type==CKEDITOR.NODE_ELEMENT&&a.isBlockBoundary())continue;break}if(!o)break;r++}for(s.moveToBookmark(i.shift());r--;)(a=t[++e]).moveToBookmark(i.shift()),s.setEnd(a.endContainer,a.endOffset)}return s}}},createBookmarks:function(t){for(var n,i=[],o=0;o<this.length;o++){i.push(n=this[o].createBookmark(t,!0));for(var s=o+1;s<this.length;s++)this[s]=e(n,this[s]),this[s]=e(n,this[s],!0)}return i},createBookmarks2:function(e){for(var t=[],n=0;n<this.length;n++)t.push(this[n].createBookmark2(e));return t},moveToBookmarks:function(e){for(var t=0;t<this.length;t++)this[t].moveToBookmark(e[t])}}}(),function(){function e(){return CKEDITOR.getUrl(CKEDITOR.skinName.split(",")[1]||"skins/"+CKEDITOR.skinName.split(",")[0]+"/")}function t(t){var n=CKEDITOR.skin["ua_"+t],i=CKEDITOR.env;if(n){n=n.split(",").sort((function(e,t){return e>t?-1:1}));for(var o,s=0;s<n.length;s++)if(o=n[s],i.ie&&(o.replace(/^ie/,"")==i.version||i.quirks&&"iequirks"==o)&&(o="ie"),i[o]){t+="_"+n[s];break}}return CKEDITOR.getUrl(e()+t+".css")}function n(e,n){s[e]||(CKEDITOR.document.appendStyleSheet(t(e)),s[e]=1),n&&n()}function i(e){var t=e.getById(a);return t||((t=e.getHead().append("style")).setAttribute("id",a),t.setAttribute("type","text/css")),t}function o(e,t,n){var i,o,s;if(CKEDITOR.env.webkit)for(t=t.split("}").slice(0,-1),o=0;o<t.length;o++)t[o]=t[o].split("{");for(var a=0;a<e.length;a++)if(CKEDITOR.env.webkit)for(o=0;o<t.length;o++){for(s=t[o][1],i=0;i<n.length;i++)s=s.replace(n[i][0],n[i][1]);e[a].$.sheet.addRule(t[o][0],s)}else{for(s=t,i=0;i<n.length;i++)s=s.replace(n[i][0],n[i][1]);CKEDITOR.env.ie&&11>CKEDITOR.env.version?e[a].$.styleSheet.cssText+=s:e[a].$.innerHTML+=s}}var s={};CKEDITOR.skin={path:e,loadPart:function(t,i){CKEDITOR.skin.name!=CKEDITOR.skinName.split(",")[0]?CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(e()+"skin.js"),(function(){n(t,i)})):n(t,i)},getPath:function(e){return CKEDITOR.getUrl(t(e))},icons:{},addIcon:function(e,t,n,i){e=e.toLowerCase(),this.icons[e]||(this.icons[e]={path:t,offset:n||0,bgsize:i||"16px"})},getIconStyle:function(e,t,n,i,o){var s;return e&&(e=e.toLowerCase(),t&&(s=this.icons[e+"-rtl"]),s||(s=this.icons[e])),e=n||s&&s.path||"",i=i||s&&s.offset,o=o||s&&s.bgsize||"16px",e&&(e=e.replace(/'/g,"\\'")),e&&"background-image:url('"+CKEDITOR.getUrl(e)+"');background-position:0 "+i+"px;background-size:"+o+";"}},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{getUiColor:function(){return this.uiColor},setUiColor:function(e){var t=i(CKEDITOR.document);return(this.setUiColor=function(e){this.uiColor=e;var n=CKEDITOR.skin.chameleon,i="",s="";"function"==typeof n&&(i=n(this,"editor"),s=n(this,"panel")),o([t],i,e=[[l,e]]),o(r,s,e)}).call(this,e)}});var a="cke_ui_color",r=[],l=/\$color/g;CKEDITOR.on("instanceLoaded",(function(e){if(!CKEDITOR.env.ie||!CKEDITOR.env.quirks){var t=e.editor;e=function(e){if(!(e=(e.data[0]||e.data).element.getElementsByTag("iframe").getItem(0).getFrameDocument()).getById("cke_ui_color")){e=i(e),r.push(e);var n=t.getUiColor();n&&o([e],CKEDITOR.skin.chameleon(t,"panel"),[[l,n]])}},t.on("panelShow",e),t.on("menuShow",e),t.config.uiColor&&t.setUiColor(t.config.uiColor)}}))}(),function(){if(CKEDITOR.env.webkit)CKEDITOR.env.hc=!1;else{var e=CKEDITOR.dom.element.createFromHtml('<div style="width:0;height:0;position:absolute;left:-10000px;border:1px solid;border-color:red blue"></div>',CKEDITOR.document);e.appendTo(CKEDITOR.document.getHead());try{var t=e.getComputedStyle("border-top-color"),n=e.getComputedStyle("border-right-color");CKEDITOR.env.hc=!(!t||t!=n)}catch(e){CKEDITOR.env.hc=!1}e.remove()}if(CKEDITOR.env.hc&&(CKEDITOR.env.cssClass+=" cke_hc"),CKEDITOR.document.appendStyleText(".cke{visibility:hidden;}"),CKEDITOR.status="loaded",CKEDITOR.fireOnce("loaded"),e=CKEDITOR._.pending)for(delete CKEDITOR._.pending,t=0;t<e.length;t++)CKEDITOR.editor.prototype.constructor.apply(e[t][0],e[t][1]),CKEDITOR.add(e[t][0])}(),CKEDITOR.skin.name="moono",CKEDITOR.skin.ua_editor="ie,iequirks,ie7,ie8,gecko",CKEDITOR.skin.ua_dialog="ie,iequirks,ie7,ie8",CKEDITOR.skin.chameleon=function(){var e=function(e,t){for(var n=e.match(/[^#]./g),i=0;3>i;i++){var o,s=i;o=parseInt(n[i],16),o=("0"+(0>t?0|o*(1+t):0|o+(255-o)*t).toString(16)).slice(-2),n[s]=o}return"#"+n.join("")},t=function(){var e=new CKEDITOR.template("background:#{to};background-image:linear-gradient(to bottom,{from},{to});filter:progid:DXImageTransform.Microsoft.gradient(gradientType=0,startColorstr='{from}',endColorstr='{to}');");return function(t,n){return e.output({from:t,to:n})}}(),n={editor:new CKEDITOR.template("{id}.cke_chrome [border-color:{defaultBorder};] {id} .cke_top [ {defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_bottom [{defaultGradient}border-top-color:{defaultBorder};] {id} .cke_resizer [border-right-color:{ckeResizer}] {id} .cke_dialog_title [{defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_dialog_footer [{defaultGradient}outline-color:{defaultBorder};border-top-color:{defaultBorder};] {id} .cke_dialog_tab [{lightGradient}border-color:{defaultBorder};] {id} .cke_dialog_tab:hover [{mediumGradient}] {id} .cke_dialog_contents [border-top-color:{defaultBorder};] {id} .cke_dialog_tab_selected, {id} .cke_dialog_tab_selected:hover [background:{dialogTabSelected};border-bottom-color:{dialogTabSelectedBorder};] {id} .cke_dialog_body [background:{dialogBody};border-color:{defaultBorder};] {id} .cke_toolgroup [{lightGradient}border-color:{defaultBorder};] {id} a.cke_button_off:hover, {id} a.cke_button_off:focus, {id} a.cke_button_off:active [{mediumGradient}] {id} .cke_button_on [{ckeButtonOn}] {id} .cke_toolbar_separator [background-color: {ckeToolbarSeparator};] {id} .cke_combo_button [border-color:{defaultBorder};{lightGradient}] {id} a.cke_combo_button:hover, {id} a.cke_combo_button:focus, {id} .cke_combo_on a.cke_combo_button [border-color:{defaultBorder};{mediumGradient}] {id} .cke_path_item [color:{elementsPathColor};] {id} a.cke_path_item:hover, {id} a.cke_path_item:focus, {id} a.cke_path_item:active [background-color:{elementsPathBg};] {id}.cke_panel [border-color:{defaultBorder};] "),panel:new CKEDITOR.template(".cke_panel_grouptitle [{lightGradient}border-color:{defaultBorder};] .cke_menubutton_icon [background-color:{menubuttonIcon};] .cke_menubutton:hover .cke_menubutton_icon, .cke_menubutton:focus .cke_menubutton_icon, .cke_menubutton:active .cke_menubutton_icon [background-color:{menubuttonIconHover};] .cke_menuseparator [background-color:{menubuttonIcon};] a:hover.cke_colorbox, a:focus.cke_colorbox, a:active.cke_colorbox [border-color:{defaultBorder};] a:hover.cke_colorauto, a:hover.cke_colormore, a:focus.cke_colorauto, a:focus.cke_colormore, a:active.cke_colorauto, a:active.cke_colormore [background-color:{ckeColorauto};border-color:{defaultBorder};] ")};return function(i,o){var s=i.uiColor;return s={id:"."+i.id,defaultBorder:e(s,-.1),defaultGradient:t(e(s,.9),s),lightGradient:t(e(s,1),e(s,.7)),mediumGradient:t(e(s,.8),e(s,.5)),ckeButtonOn:t(e(s,.6),e(s,.7)),ckeResizer:e(s,-.4),ckeToolbarSeparator:e(s,.5),ckeColorauto:e(s,.8),dialogBody:e(s,.7),dialogTabSelected:t("#FFFFFF","#FFFFFF"),dialogTabSelectedBorder:"#FFF",elementsPathColor:e(s,-.6),elementsPathBg:s,menubuttonIcon:e(s,.5),menubuttonIconHover:e(s,.3)},n[o].output(s).replace(/\[/g,"{").replace(/\]/g,"}")}}(),CKEDITOR.config.plugins="",CKEDITOR.config.skin="moono",CKEDITOR.lang.languages={en:1}),e.exports=CKEDITOR},function(e,t,n){var i=n(563),o=n(2162),s=n(1998),a=n(152),r=n(799);e.exports=function(e,t){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.STICKER,apiType:"sticker",createModelFromJSON:i.createStickerByJSON,createWidgetView:function(e,t){var n=new o({model:t,el:e});return n.once("set:width",_.bind((function(e){s(this,e)}),this)),n},dragHandlerWidth:!1},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=(n(1616),n(2163)),s=n(906);return n(502),i.View.extend({attributes:{"data-viewname":"StickerWidgetView"},template:t.template(o),ui:{btnDelete:"._btnDelete",sticker:"._sticker"},triggers:{"click @ui.btnDelete":"remove"},behaviors:{ImageWidthSettingBehavior:{}},onRender:function(){this.getUI("sticker").setLoading({tag:'<p class="uLoading -widget"><img src="'+window.resBaseUrl+'/images/common/loading.gif" width="32" height="32" alt="loading" /></p>'}).one("setLoading:done",t.bind((function(){this.trigger(s.EVENT.WIDGET_MEDIA_LOADED)}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <img src="<%- imageUrl %>" alt="<%- IM(\'sticker\') %>" class="_sticker">\n</div>\n'},function(e,t,n){var i=n(563),o=n(1999),s=n(1617),a=n(152),r=n(799);e.exports=function(e,t){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.POLL,apiType:"poll",createModelFromJSON:i.createPollV1ByJSON,createWidgetView:r.widgetViewCreator(o),onWidgetModify:r.createLayoutModify((function(e){return s.openLayer(e,t.getBandCore().bandNo)}))},e,t)}},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <% if (isOpen) { %>\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _btnModify"><%- IM("ui.label.modify") %></button>\n    <% } %>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -vote">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-vote sf_color" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-vote-22"></use>\n                    </svg>\n                    <span class="status sf_color"><%- IM("web.postwrite.attach.title.poll") %></span>\n                    <%= IM("web.postlist.poll.txt.poll_count", {pollCount: pollCount}) %>\n                </p>\n                <p class="addTitle"><%- title %></p>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="lyContent -w480 ">\n    <header class="header">\n        <h1 class="title"><%-IM(\'web.postwrite.form_poll.title\')%></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="postWrite">\n            <div class="addWidget">\n                <div class="scrollArea _scrollArea" style="height:451px">\n                    <div class="titleWrap _titleWrap">\n                        <label for="pollTitle" class="gSrOnly"><%-IM(\'web.postwrite.form_poll.placeholder.title\')%></label>\n                        <input type="text" id="pollTitle" bm-bind="postPoll|title" maxlength="<%-msg_title_maxlength%>" value="<%-title%>" placeholder="<%-IM(\'web.postwrite.form_poll.placeholder.title\')%>" <%= (isExistVotedMember) ? \'readonly\' : \'\' %>>\n                        <div class="previousCheck">\n                            <button type="button" class="btnLoad _btnImportPrevPoll" <%= (isExistVotedMember) ? \'disabled\' : \'\' %>><span class="gSrOnly"><%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.label\') %></span></button>\n                            <% if (!pollImportHelpClosed) { %>\n                            <dl class="uHelpGuide -right -close" role="alert" aria-live="assertive">\n                                <dt><span class="gSrOnly"><%-IM(\'ui.label.help\')%></span></dt>\n                                <dd class="_popoverHelpImportPoll" style="width:190px;display:block;">\n                                    <%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.help_description\') %>\n                                    <button type="button" class="btnLyClose _btnCloseImportPollHelpPopover"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n                                </dd>\n                            </dl>\n                            <% } %>\n                        </div>\n                    </div>\n                    <div class="itemWriteList">\n                        <strong class="gSrOnly"><%-IM(\'web.postwrite.form_poll.title\')%></strong>\n                        <ul class="vote _pollSubjectList"></ul>\n                    </div>\n                    <button type="button" class="addItemBtn _btnAddPollSubject"><%-IM(\'web.postdetail.poll.add_subject\')%></button>\n                    <% // 투표 옵션 start %>\n                    <div class="optionCheck">\n                        <% // 멤버 누구나 항목 추가 %>\n                        <label for="pollOption1_<%-msg_cid%>" class="uCheck -checkbox -fs13">\n                            <input type="checkbox" id="pollOption1_<%-msg_cid%>" class="checkInput" bm-bind="postPoll|isSubjectAddible"<%if(isSubjectAddible){%> checked<%}%>>\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                                <span class="text"><%-IM(\'web.post.write.poll.is_additible\')%></span>\n                            </span>\n                        </label>\n                        <% // 복수 선택 허용 %>\n                        <div class="flexibleRow">\n                            <div class="left">\n                                <label for="pollOption2_<%-msg_cid%>" class="uCheck -checkbox -fs13">\n                                    <input type="checkbox" id="pollOption2_<%-msg_cid%>" class="checkInput _chkMultipleSelect" bm-bind="postPoll|isMultipleSelect"<%if(isMultipleSelect){%> checked<%}%>>\n                                    <span class="checkLabel">\n                                        <span class="shape"></span>\n                                        <span class="text"><%-IM(\'web.postwrite.form_poll.label.is_multiple_select\')%></span>\n                                    </span>\n                                </label>\n                            </div>\n                            <% // 복수 선택 개수 %>\n                            <div class="right _votableLimitWrapper">\n                                <label for="multiSelect" class="gFs13 gColorBk4 gMar10 gInlineBlock"><%-IM(\'poll_form.votable_limit.title\')%></label>\n                                <span class="uSelect">\n                                    <select id="multiSelect" class="_votableLimit" bm-bind="postPoll|votableLimit" title="<%-IM(\'poll_form.votable_limit.title\')%>" <% (isExistVotedMember) ? \'disabled\' : \'\' %>>\n                                        <option value=""<%if(!isVoteLimited){%> selected="selected"<%}%>><%-IM(\'poll_form.votable_limit.value.no_limit\')%></option>\n                                        <% _.each(_.range(2, 6), function(value) { %>\n                                        <option value="<%=value%>"<%if(isVoteLimited && votableLimit == value){%> selected="selected"<%}%>><%-IM(\'poll_form.votable_limit.value.other\', {\n                                        count : value\n                                        }) %></option>\n                                        <% }); %>\n                                    </select>\n                                </span>\n                            </div>\n                        </div>\n\n                        <% // 무기명 투표 %>\n                        <label for="pollOption3_<%-msg_cid%>" class="uCheck -checkbox -fs13">\n                            <input type="checkbox" id="pollOption3_<%-msg_cid%>" class="checkInput _chkAnonymous" bm-bind="postPoll|isAnonymous"<%if(isAnonymous){%> checked<%}%>>\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                                <span class="text"><%-IM(\'web.postwrite.form_poll.label.is_anonymous\')%></span>\n                            </span>\n                        </label>\n\n                        <% // 종료일 설정 %>\n                        <div class="flexList -h32 -tbSpaceNone">\n                            <div class="text">\n                                <label for="pollOption5_<%-msg_cid%>" class="uCheck -checkbox -fs13">\n                                    <input type="checkbox" id="pollOption5_<%-msg_cid%>" class="checkInput _chkEndedAt" <% if (canSetEndedAt) { %>checked<% } %>>\n                                    <span class="checkLabel">\n                                        <span class="shape"></span>\n                                        <span class="text"><%- IM("poll_form.set_ended_at.title") %></span>\n                                    </span>\n                                </label>\n                            </div>\n                            <% // 종료일시 %>\n                            <div class="etc _endedAtWrapper" style="width:245px">\n                                <div class="_endedAtInputRegion"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <% // 투표 옵션 end %>\n\n                    <% // 투표 현황 보기 %>\n                    <div class="flexList -tbSpace13 listLine -tLine">\n                        <p class="text">\n                            <label for="pollStatus"><%- IM("postwrite.form_poll.poll_status.label") %></label>\n                        </p>\n                        <div class="etc">\n                            <div class="uSelect -h32 -bg gColorBk2" style="width:178px">\n                                <select id="pollStatus" bm-bind="postPoll|voteVisibleQualification" title="<%- IM(\'postwrite.form_poll.poll_status.label\') %>">\n                                    <% _.each(voteVisibleQualificationOptions, function(option) { %>\n                                    <option value="<%- option.value %>" <%- option.selected ? \'selected\' : \'\' %>><%- option.label %></option>\n                                    <% }); %>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n\n                    <% // 투표 항목 정렬 %>\n                    <div class="flexList -tbSpaceNone gMab13">\n                        <p class="text">\n                            <label for="pollSort"><%- IM("web.postwrite.form_poll.label.order_by") %></label>\n                        </p>\n                        <div class="etc">\n                            <div class="uSelect -h32 -bg gColorBk2" style="width:178px">\n                                <select id="pollSort" class="_orderBySelector" bm-bind="postPoll|orderBy" title="<%- IM(\'web.postwrite.form_poll.label.order_by\') %>">\n                                    <option value="seq" <%if(orderBy === \'seq\'){%> selected<%}%>><%-IM(\'web.postwrite.form_poll.order_by.seq\')%></option>\n                                    <option value="vote" <%if(orderBy === \'vote\'){%> selected<%}%>><%-IM(\'web.postwrite.form_poll.order_by.vote\')%></option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -confirm -disabled _btnComplete"><%-IM(\'web.btn.attach\')%></button>\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n    </footer>\n</div>'},function(e,t){e.exports='<li bm-repeat="postPoll|subjects">\n    <input type="text"\n           id="poll_item_<%-index%>"\n           class="inputItem _pollSubjectTitle"\n           bm-bind="postPoll-subjects|title"\n           maxlength="<%-subjectMaxLength%>"\n           value="<%-title%>"\n           name="poll_item"\n           placeholder="<%-IM(\'web.postwrite.form_poll.placeholder.subject\')%>">\n    <input type="hidden" name="subjectId" bm-bind="postPoll-subjects|pollSubjectId" value="<%-pollSubjectId%>" />\n    <a role="button" class="dragBar uButton -iconListMove">\n        <span class="gSrOnly">Drag the mouse to change the order</span>\n    </a>\n    <span class="etc"></span>\n</li>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(4),s=n(486),a=n(586),r=n(2169),l=n(2171),c=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorPollImportView"},template:t.template(l),ui:{btnBack:"._btnBack"},events:{"click @ui.btnBack":"destroy"},regions:{pastItemListRegion:{el:"._pastItems"}},childViewTriggers:{"childview:select:item":"select:item-import"},onRender:function(){this._fetchCollection()},initialize:function(e){this.bandNo=e.bandNo},_fetchCollection:function(){a.getImportPoll(this.bandNo).then(t.bind((function(e){var t=new i.Collection;t.reset(e.slice(0,10)),0!=e.length?this.showChildView("pastItemListRegion",new d({collection:t})):this.showChildView("pastItemListRegion","<p class='uEmpty -h480'><span>"+IM("ui.message.empty_conents")+"</span></p>")}),this))}}),d=o.CollectionView.extend({tagName:"ul",className:"listLine",childView:r});return c.openAsLayer=function(e){var t=new c({bandNo:e});return s.open(t),t},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(9),s=n(2170);return i.View.extend({tagName:"li",className:"item tLine",template:t.template(s),templateContext:function(){return{createdAt:o.format.date(this.model.get("created_at"),"short_date_time")}},attributes:{"data-viewname":"DEditorPollImportItemView"},ui:{importPoll:"._btnImportPoll"},events:{"click @ui.importPoll":function(){this.trigger("select:item",this)}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button type="button" class="flexList _btnImportPoll">\n    <span class="text">\n        <span class="ellipsis"><%- title %></span>\n        <span class="sub -date"><%= createdAt %></span>\n    </span>\n</button>'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_title\') %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="previousAttendance">\n            <div class="topNoticeBar">\n                <p class="sDesc gMat0"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_desc\') %></p>\n            </div>\n            <div class="_pastItems rScroll -h480"></div>\n        </div>\n    </div>\n    <footer class="footer -spaceNone">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%-IM(\'ui.label.back\')%></span></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="flexItem -calendar _dateInput"></div>\n<div class="flexItem gMal5 _timeInput"></div>'},function(e,t){e.exports='<label for="<%- cid %>_pickedDateTime" class="gSrOnly"><%- placeholder %></label>\n<input type="text"\n       id="<%- cid %>_pickedDateTime"\n       class="_timeInput"\n       placeholder="<%- placeholder %>"\n       title="<%- placeholder %>"\n       value="<%- inputTime %>"\n       autocomplete="off"\n       <% if (readOnlyInput) { %>readonly<% } %>>\n<span class="border"></span>\n\x3c!-- [D] 옵션버튼이 있을 경우 : -option 클래스 사용 --\x3e\n<div class="dropDownList<% if (useTimeDelete) { %> -option<% } %>">\n    <ul class="_timePicker dropDown <% if(pickerDirection == \'up\') { %>-up<% } %>" tabindex="0">\n        <% _.each(times, function(time, index) { %>\n        <li class="dropDownItem">\n            <button type="button" class="btnDropDownItem _btnTime" data-index="<%- index %>" data-time="<%- time %>"><%- time %></button>\n        </li>\n        <% }); %>\n    </ul>\n    <% if (useTimeDelete) { %>\n    <div class="dropDownBottomOption">\n        <button class="btnSetting uButton -sizeS -confirm3 gMar5 _deleteBtn"><%- IM(\'ui.label.not_set\') %></button>\n    </div>\n    <% } %>\n</div>'},function(e,t){e.exports='<label for="<%-vid%>pickedDate" class="gSrOnly"><%- placeholder %></label>\n<input type="text"\n       id="<%-vid%>pickedDate"\n       class="gFs12 gColorBk2 _input"\n       title="<%- placeholder %>"\n       placeholder="<%- placeholder %>"\n       autocomplete="off"\n       value=""\n       maxlength="13"\n    <% if(readonly) { %>readonly<% } %>\n    <% if(disable) { %>disabled<% } %>\n>\n<span class="border"></span>\n<div class="datePickerRegion _datePickerRegion"></div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2176),a=n(523),r=n(567),l=n(43),c=n(1003),d=n(498),u=n(499),h=n(488),p=n(154),m=n(9),_=o.View.extend({attributes:{"data-viewname":"DDatePickerView",tabindex:"0"},className:"uCalendarPicker",getTemplate:function(){return this._dataFetched?t.template(s):t.template(d)},templateContext:function(){return this._dataFetched?{L:m}:{_loading_size:u.Size.MEDIUM,middleClass:h.ELEMENT.AREA_VERTICAL_MIDDLE}},ui:{prevMonthButton:"._prevMonthButton",nextMonthButton:"._nextMonthButton",prevYearButton:"._prevYearButton",nextYearButton:"._nextYearButton",todayButton:"._todayButton",day:"._day",deleteButton:"._deleteButton",isBeforeMinDate:"._isBeforeMinDate",isAfterMaxDate:"._isAfterMaxDate",td:"._td",calendar:"._calendar"},events:{"click @ui.prevMonthButton":function(e){e.preventDefault(),e.stopPropagation(),this._currentMonth.subtract(1,"month"),this.render()},"click @ui.nextMonthButton":function(e){e.preventDefault(),e.stopPropagation(),this._currentMonth.add(1,"month"),this.render()},"click @ui.prevYearButton":function(e){e.preventDefault(),e.stopPropagation(),this._currentMonth.subtract(1,"year"),this.render()},"click @ui.nextYearButton":function(e){e.preventDefault(),e.stopPropagation(),this._currentMonth.add(1,"year"),this.render()},"click @ui.todayButton":function(e){e.preventDefault(),e.stopPropagation(),this._currentMonth=l(this._today),this._targetDate=l(this._today),this.render()},"click @ui.day":function(e){var t=l(i(e.target).attr("data-date"));e.preventDefault(),this._isValidDate(t)&&this.trigger("selectday",t)},"click @ui.deleteButton":function(){this.trigger("delete")},"mouseenter @ui.td":"_showWeekRange","mouseleave @ui.td":"_showWeekRange"},_showWeekRange:function(e){var t=i(e.currentTarget);if(this._useWeekSelect&&!t.hasClass("disabled")){if(this.getUI("calendar").find(".-onWeekRange").removeClass("-onWeekRange"),"mouseleave"!==e.type){var n=t.data("week");this.getUI("calendar").find("[data-week="+n+"]").addClass("-onWeekRange")}}},initialize:function(e){this.direction=e.direction,this._useWeekSelect=e.useWeekSelect;var t,n=e.targetDate;if(l.isMoment(n))n=l(a.extractISODateString(n));else{var i=a.extractISODateString(l.parseZone(n));n=l(i)}if(n.isValid()||(n=l()),n._z){var o=n._z.name,s=a.extractISODateString(l.tz(o));t=l(s)}else t=l();this._targetDate=l(n),this._currentMonth=l(n),this._today=t,this._useDeleteBtn=e.useDeleteBtn,this._dateValidator=e.dateValidator},serializeData:function(){if(!this._dataFetched)return{};var e=[],n=a.getCalendarRange(this._currentMonth,this._startDayNum),i=t.result(this._dateValidator,"getMinDate")||null,o=t.result(this._dateValidator,"getMaxDate")||null,s=t.result(i,"tz")||t.result(o,"tz");n.by("day",t.bind((function(t){var n=l(t).startOf("day"),a=s?l.tz(n.format(_.DATE_FORMAT),_.DATE_FORMAT,s):n;e.push({date:n,disabled:a.isBefore(i)||a.isAfter(o)})}),this));var c=r.getFirstDateOfWeek(this._targetDate,r.DAYS.MONDAY.getDayNumber(),s),d=r.getEndDateOfWeek(this._targetDate,r.DAYS.MONDAY.getDayNumber(),s);return i&&c.diff(i)<0&&(c=i),o&&o.diff(d)<0&&(d=o),{targetDate:this._targetDate,currentMonth:this._currentMonth,daysOfTheWeek:r.makeDayNameArrayOrderBy(this._startDayNum,"dd"),firstDateOfWeek:l.tz(c,s),endDateOfWeek:l.tz(d,s),numberOfRows:e.length/7,days:e,useDeleteBtn:this._useDeleteBtn,useWeekSelect:this._useWeekSelect}},onBeforeAttach:function(){this.direction==_.DIRECTION.UP?this.$el.addClass("-up"):this.$el.removeClass("-up")},onAttach:function(){p.wrapActivePromise(c.getCachedStartDayNum(),this).then(t.bind((function(e){this._startDayNum=e,this._dataFetched=!0,this.render()}),this))},_isValidDate:function(e){return!this._dateValidator||!t.isFunction(this._dateValidator.isValid)||this._dateValidator.isValid(e)}});return _.DIRECTION={UP:"up",DOWN:"down"},_.DATE_FORMAT="YYYY-MM-DD",_.build=function(e,t,n,i,o){return new _({targetDate:e,direction:t,useDeleteBtn:!!n,dateValidator:i,useWeekSelect:o})},_}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="header">\n    <div class="month">\n        <button type="button" class="btnPrevYear _prevYearButton"><span class="gSrOnly">previous year</span></button>\n        <button type="button" class="btnPrevMonth _prevMonthButton"><span class="gSrOnly">previous month</span></button>\n        <strong class="monthTxt "><%=L.format.date(currentMonth, "year_month") %></strong>\n        <button type="button" class="btnNextMonth _nextMonthButton"><span class="gSrOnly">next month</span></button>\n        <button type="button" class="btnNextYear _nextYearButton"><span class="gSrOnly">next year</span></button>\n    </div>\n</div>\n<table class="calendar _calendar">\n    <thead>\n    <tr>\n        <% for(var i = 0; i < daysOfTheWeek.length; i++) { %>\n        <th><%= daysOfTheWeek[i] %></th>\n        <% } %>\n    </tr>\n    </thead>\n    <tbody>\n    <%\n    var weekCount = 1;\n    var numberOfRows = days.length / 7;\n    for(var i = 0; i < numberOfRows; i++){ %>\n    <tr>\n        <%\n        for(var j = 0; j < 7; j++){\n            var d = j + i * 7;\n            var isSelected = null;\n\n            if (useWeekSelect) {\n                isSelected = days[d].date.isBetween(firstDateOfWeek, endDateOfWeek) || days[d].date.isSame(endDateOfWeek) || days[d].date.isSame(firstDateOfWeek);\n            } else {\n                isSelected = days[d].date.isSame(targetDate, "day");\n            }\n\n            var tdClass = [];\n            if (days[d].date.isBefore(currentMonth, \'month\')) {\n                tdClass.push("prevMonth");\n            } else if (days[d].date.isAfter(currentMonth, \'month\')) {\n                tdClass.push("nextMonth");\n            }\n            if (days[d].disabled) {\n                tdClass.push(\'disabled\');\n            }\n\n            if (useWeekSelect) {\n                // 주단위 선택을 위해 월요일이마다 weekCount 증가 시킴\n                if (days[d].date.days() === 1) {\n                    weekCount++;\n                }\n                var weekOfMonth = \'week\' + weekCount;\n                tdClass.push(weekOfMonth);\n            }\n        %>\n        <td class="_td <%- (tdClass.length > 0) ? tdClass.join(\' \'):\'\' %>" <%= (useWeekSelect) ? \'data-week="\' + weekOfMonth + \'"\':\'\' %>>\n            <a href="#" role="button" class="_day <% if(isSelected) { %>on<% } %>" data-date="<%= days[d].date.format(\'YYYY-MM-DD\') %>"><%- days[d].date.date() %></a>\n        </td>\n        <% } %>\n    </tr>\n    <%\n    }\n    %>\n    </tbody>\n</table>\n<div class="footerPicker">\n    <button type="button" class="today _todayButton"><%=IM(\'schedule.list.button.today\')%></button>\n    <% if(useDeleteBtn) { %><button type="button" class="btnRight _deleteButton"><%=IM("ui.label.delete")%></button><% } %>\n</div>'},function(e,t,n){var o;void 0===(o=function(){function e(){var e;e="1,2,4,1,1,2,1,2,1,2,2,1,",e+="2,2,1,2,1,1,2,1,2,1,2,1,",e+="2,2,2,1,2,1,4,1,2,1,2,1,",e+="2,2,1,2,1,2,1,2,1,2,1,2,",e+="1,2,1,2,2,1,2,1,2,1,2,1,",e+="2,1,2,1,5,2,1,2,2,1,2,1,",e+="2,1,1,2,1,2,1,2,2,2,1,2,",e+="1,2,1,1,2,1,2,1,2,2,2,1,",e+="2,1,2,3,2,1,2,1,2,1,2,2,",e+="2,1,2,1,1,2,1,1,2,2,1,2,",e+="2,2,1,2,1,1,2,1,2,1,5,2,",e+="2,1,2,2,1,1,2,1,2,1,1,2,",e+="2,1,2,2,1,2,1,2,1,2,1,2,",e+="1,2,1,2,1,2,5,2,1,2,1,2,",e+="1,1,2,1,2,2,1,2,2,1,2,1,",e+="2,1,1,2,1,2,1,2,2,2,1,2,",e+="1,2,1,1,5,2,1,2,1,2,2,2,",e+="1,2,1,1,2,1,1,2,2,1,2,2,",e+="2,1,2,1,1,2,1,1,2,1,2,2,",e+="2,1,6,1,1,2,1,1,2,1,2,2,",e+="1,2,2,1,2,1,2,1,2,1,1,2,",e+="2,1,2,1,2,2,1,2,2,3,1,2,",e+="1,2,2,1,2,1,2,2,1,2,1,2,",e+="1,1,2,1,2,1,2,2,1,2,2,1,",e+="2,1,1,2,4,1,2,2,1,2,2,1,",e+="2,1,1,2,1,1,2,2,1,2,2,2,",e+="1,2,1,1,2,1,1,2,1,2,2,2,",e+="1,2,2,3,2,1,1,2,1,2,2,1,",e+="2,2,2,1,1,2,1,1,2,1,2,1,",e+="2,2,2,1,2,1,2,1,1,5,2,1,",e+="2,2,1,2,2,1,2,1,2,1,1,2,",e+="1,2,1,2,2,1,2,1,2,2,1,2,",e+="1,1,2,1,2,4,2,1,2,2,1,2,",e+="1,1,2,1,2,1,2,1,2,2,2,1,",e+="2,1,1,2,1,1,2,1,2,2,2,1,",e+="2,2,1,1,5,1,2,1,2,2,1,2,",e+="2,2,1,1,2,1,1,2,1,2,1,2,",e+="2,2,1,2,1,2,1,1,2,1,2,1,",e+="2,2,4,2,1,2,1,1,2,1,2,1,",e+="2,1,2,2,1,2,2,1,2,1,1,2,",e+="1,2,1,2,1,2,5,2,2,1,2,1,",e+="1,2,1,2,1,2,1,2,2,1,2,2,",e+="1,1,2,1,1,2,1,2,2,2,1,2,",e+="2,1,1,2,3,2,1,2,2,1,2,2,",e+="2,1,1,2,1,1,2,1,2,1,2,2,",e+="2,1,2,1,2,1,1,2,1,2,1,2,",e+="2,2,1,5,2,1,1,2,1,2,1,2,",e+="2,1,2,2,1,2,1,1,2,1,2,1,",e+="2,1,2,2,1,2,1,2,1,2,1,2,",e+="1,5,2,1,2,2,1,2,1,2,1,2,",e+="1,2,1,2,1,2,1,2,2,1,2,2,",e+="1,1,2,1,1,5,2,2,1,2,2,2,",e+="1,1,2,1,1,2,1,2,1,2,2,2,",e+="1,2,1,2,1,1,2,1,2,1,2,2,",e+="2,1,2,1,5,1,2,1,2,1,2,1,",e+="2,2,2,1,2,1,1,2,1,2,1,2,",e+="1,2,2,1,2,1,2,1,2,1,2,1,",e+="2,1,5,2,2,1,2,1,2,1,2,1,",e+="2,1,2,1,2,1,2,2,1,2,1,2,",e+="1,2,1,1,2,1,2,5,2,2,1,2,",e+="1,2,1,1,2,1,2,1,2,2,2,1,",e+="2,1,2,1,1,2,1,2,1,2,2,2,",e+="1,2,1,2,3,2,1,1,2,2,1,2,",e+="2,2,1,2,1,1,2,1,1,2,2,1,",e+="2,2,1,2,2,1,1,2,1,2,1,2,",e+="1,2,2,4,1,2,1,2,1,2,1,2,",e+="1,2,1,2,1,2,2,1,2,1,2,1,",e+="2,1,1,2,2,1,2,1,2,2,1,2,",e+="1,5,1,2,1,2,1,2,2,2,1,2,",e+="1,2,1,1,2,1,2,1,2,2,2,1,",e+="2,1,2,1,1,5,1,2,2,1,2,2,",e+="2,1,2,1,1,2,1,1,2,2,1,2,",e+="2,2,1,2,1,1,2,1,1,2,1,2,",e+="2,2,1,2,5,1,2,1,2,1,1,2,",e+="2,1,2,2,1,2,1,2,1,2,1,2,",e+="1,2,1,2,1,2,2,1,2,1,2,1,",e+="2,3,2,1,2,2,1,2,2,1,2,1,",e+="2,1,1,2,1,2,1,2,2,2,1,2,",e+="1,2,1,1,2,1,5,2,2,1,2,2,",e+="1,2,1,1,2,1,1,2,2,1,2,2,",e+="2,1,2,1,1,2,1,1,2,1,2,2,",e+="2,1,2,2,3,2,1,1,2,1,2,2,",e+="1,2,2,1,2,1,2,1,2,1,1,2,",e+="2,1,2,1,2,2,1,2,1,2,1,1,",e+="2,1,2,5,2,1,2,2,1,2,1,2,",e+="1,1,2,1,2,1,2,2,1,2,2,1,",e+="2,1,1,2,1,2,1,2,2,1,2,2,",e+="1,5,1,2,1,1,2,2,1,2,2,2,",e+="1,2,1,1,2,1,1,2,1,2,2,2,",e+="1,2,2,1,1,5,1,2,1,2,2,1,",e+="2,2,2,1,1,2,1,1,2,1,2,1,",e+="2,2,2,1,2,1,2,1,1,2,1,2,",e+="1,2,2,1,6,1,2,1,2,1,1,2,",e+="1,2,1,2,2,1,2,2,1,2,1,2,",e+="1,1,2,1,2,1,2,2,1,2,2,1,",e+="2,1,4,1,2,1,2,1,2,2,2,1,",e+="2,1,1,2,1,1,2,1,2,2,2,1,",e+="2,2,1,1,2,1,4,1,2,2,1,2,",e+="2,2,1,1,2,1,1,2,1,2,1,2,",e+="2,2,1,2,1,2,1,1,2,1,2,1,",e+="2,2,1,2,2,4,1,1,2,1,2,1,",e+="2,1,2,2,1,2,2,1,2,1,1,2,",e+="1,2,1,2,1,2,2,1,2,2,1,2,",e+="1,1,2,4,1,2,1,2,2,1,2,2,",e+="1,1,2,1,1,2,1,2,2,2,1,2,",e+="2,1,1,2,1,1,2,1,2,2,1,2,",e+="2,5,1,2,1,1,2,1,2,1,2,2,",e+="2,1,2,1,2,1,1,2,1,2,1,2,",e+="2,2,1,2,1,2,3,2,1,2,1,2,",e+="2,1,2,2,1,2,1,1,2,1,2,1,",e+="2,1,2,2,1,2,1,2,1,2,1,2,",e+="1,2,1,2,4,2,1,2,1,2,1,2,",e+="1,2,1,1,2,2,1,2,2,1,2,2,",e+="1,1,2,1,1,2,1,2,2,1,2,2,",e+="2,1,4,1,1,2,1,2,1,2,2,2,",e+="1,2,1,2,1,1,2,1,2,1,2,2,",e+="2,1,2,1,2,1,1,5,2,1,2,2,",e+="1,2,2,1,2,1,1,2,1,2,1,2,",e+="1,2,2,1,2,1,2,1,2,1,2,1,",e+="2,1,2,1,2,5,2,1,2,1,2,1,",e+="2,1,2,1,2,1,2,2,1,2,1,2,",e+="1,2,1,1,2,1,2,2,1,2,2,1,",e+="2,1,2,3,2,1,2,1,2,2,2,1,",e+="2,1,2,1,1,2,1,2,1,2,2,2,",e+="1,2,1,2,1,1,2,1,1,2,2,1,",e+="2,2,5,2,1,1,2,1,1,2,2,1,",e+="2,2,1,2,2,1,1,2,1,2,1,2,",e+="1,2,2,1,2,1,5,2,1,2,1,2,",e+="1,2,1,2,1,2,2,1,2,1,2,1,",e+="2,1,1,2,2,1,2,1,2,2,1,2,",e+="1,2,1,1,5,2,1,2,2,2,1,2,",e+="1,2,1,1,2,1,2,1,2,2,2,1,",e+="2,1,2,1,1,2,1,1,2,2,2,1,",e+="2,2,1,5,1,2,1,1,2,2,1,2,",e+="2,2,1,2,1,1,2,1,1,2,1,2,",e+="2,2,1,2,1,2,1,5,2,1,1,2,",e+="2,1,2,2,1,2,1,2,1,2,1,1,",e+="2,2,1,2,1,2,2,1,2,1,2,1,",e+="2,1,1,2,1,6,1,2,2,1,2,1,",e+="2,1,1,2,1,2,1,2,2,1,2,2,",e+="1,2,1,1,2,1,1,2,2,1,2,2,",e+="2,1,2,3,2,1,1,2,2,1,2,2,",e+="2,1,2,1,1,2,1,1,2,1,2,2,",e+="2,1,2,2,1,1,2,1,1,5,2,2,",e+="1,2,2,1,2,1,2,1,1,2,1,2,",e+="1,2,2,1,2,2,1,2,1,2,1,1,",e+="2,1,2,2,1,5,2,2,1,2,1,2,",e+="1,1,2,1,2,1,2,2,1,2,2,1,",e+="2,1,1,2,1,2,1,2,2,1,2,2,",e+="1,2,1,1,5,1,2,1,2,2,2,2,",e+="1,2,1,1,2,1,1,2,1,2,2,2,",e+="1,2,2,1,1,2,1,1,2,1,2,2,",e+="1,2,5,2,1,2,1,1,2,1,2,1,",e+="2,2,2,1,2,1,2,1,1,2,1,2,",e+="1,2,2,1,2,2,1,5,2,1,1,2,",e+="1,2,1,2,2,1,2,1,2,2,1,2,",e+="1,1,2,1,2,1,2,2,1,2,2,1,",e+="2,1,1,2,3,2,2,1,2,2,2,1,",e+="2,1,1,2,1,1,2,1,2,2,2,1,",e+="2,2,1,1,2,1,1,2,1,2,2,1,",e+="2,2,2,3,2,1,1,2,1,2,1,2,",e+="2,2,1,2,1,2,1,1,2,1,2,1,",e+="2,2,1,2,2,1,2,1,1,2,1,2,",e+="1,5,2,2,1,2,1,2,2,1,1,2,",e+="1,2,1,2,1,2,2,1,2,2,1,2,",e+="1,1,2,1,2,1,5,2,2,1,2,2,",e+="1,1,2,1,1,2,1,2,2,2,1,2,",e+="2,1,1,2,1,1,2,1,2,2,1,2,",e+="2,2,1,1,5,1,2,1,2,1,2,2,",e+="2,1,2,1,2,1,1,2,1,2,1,2,",e+="2,1,2,2,1,2,1,1,2,1,2,1,",e+="2,1,6,2,1,2,1,1,2,1,2,1,",e+="2,1,2,2,1,2,1,2,1,2,1,2,",e+="1,2,1,2,1,2,1,2,5,2,1,2,",e+="1,2,1,1,2,1,2,2,2,1,2,2,",e+="1,1,2,1,1,2,1,2,2,1,2,2,",e+="2,1,1,2,3,2,1,2,1,2,2,2,",e+="1,2,1,2,1,1,2,1,2,1,2,2,",e+="2,1,2,1,2,1,1,2,1,2,1,2,",e+="2,1,2,5,2,1,1,2,1,2,1,2,",e+="1,2,2,1,2,1,2,1,2,1,2,1,",e+="2,1,2,1,2,2,1,2,1,2,1,2,",e+="1,5,2,1,2,1,2,2,1,2,1,2,",e+="1,2,1,1,2,1,2,2,1,2,2,1,",e+="2,1,2,1,1,5,2,1,2,2,2,1,",e+="2,1,2,1,1,2,1,2,1,2,2,2,",e+="1,2,1,2,1,1,2,1,1,2,2,2,",e+="1,2,2,1,5,1,2,1,1,2,2,1,",e+="2,2,1,2,2,1,1,2,1,1,2,2,",e+="1,2,1,2,2,1,2,1,2,1,2,1,",e+="2,1,5,2,1,2,2,1,2,1,2,1,",e+="2,1,1,2,1,2,2,1,2,2,1,2,",e+="1,2,1,1,2,1,5,2,2,2,1,2,",e+="1,2,1,1,2,1,2,1,2,2,2,1,",e+="2,1,2,1,1,2,1,1,2,2,1,2,",e+="2,2,1,2,1,4,1,1,2,1,2,2,",e+="2,2,1,2,1,1,2,1,1,2,1,2,",e+="2,2,1,2,1,2,1,2,1,1,2,1,",e+="2,2,1,2,5,2,1,2,1,2,1,1,",e+="2,1,2,2,1,2,2,1,2,1,2,1,",e+="2,1,1,2,1,2,2,1,2,2,1,2,",e+="1,5,1,2,1,2,1,2,2,2,1,2,",e+="1,2,1,1,2,1,1,2,2,1,2,2";new Array;return e.split(",")}function t(e){var t;return(t=parseInt(e.substring(0,4),10))%4==0&&(t%100!=0||t%400==0)}function n(e,t){return null==e?"":e.length<t?e:e.substr(e.length-t,t)}return{solarToLunar:function(o){var s=function(o){var s,a,r,l,c,d,u,h=new Array,p=new Array,m=new Array;if(sY=parseInt(o.substr(0,4),10),sM=parseInt(o.substr(4,2),10),sD=parseInt(o.substr(6,2),10),sY<1841||sY>2043)return null;p=e(),h="31,0,31,30,31,30,31,31,30,31,30,31".split(","),1==t(o)?h[1]=29:h[1]=28;for(672069,a=365*(sY-1)+parseInt((sY-1)/4)-parseInt((sY-1)/100)+parseInt((sY-1)/400),i=0;i<=sM-2;i++)a+=parseInt(h[i]);for(a+=sD,s=a-672069+1,i=0;i<=sY-1841;i++)for(m[i]=0,j=0;j<=11;j++){switch(parseInt(p[12*i+j])){case 1:r=29;break;case 2:r=30;break;case 3:r=58;break;case 4:case 5:r=59;break;case 6:r=60}m[i]=m[i]+r}l=0;do{s-=m[l],l+=1}while(s>m[l]);c=0,u="0";for(;;)if(parseInt(p[12*l+c])<=2){if(r=parseInt(p[12*l+c])+28,!(s>r))break;s-=r,c+=1}else{switch(parseInt(p[12*l+c])){case 3:m1=29,m2=29;break;case 4:m1=29,m2=30;break;case 5:m1=30,m2=29;break;case 6:m1=30,m2=30}if(!(s>m1))break;(s-=m1)>m2?(s-=m2,c+=1):u="1"}return d=s,u+(l+=1841)+n("0"+(c+=1),2)+n("0"+d,2)}(o.replace(/-/g,""));return{isIntercalation:"1"==s.substr(0,1),lunarYear:s.substr(1,4),lunarMonth:s.substr(5,2),lunarDay:s.substr(7,2)}},lunarToSolar:function(i){var o=function(i){var o,s,a,r,l,c,d,u,h,p,m,_,g,f,b=new Array,v=new Array;if(9!=i.length)return null;if(r=i.substr(0,1),o=parseInt(i.substr(1,4),10),s=parseInt(i.substr(5,2),10),a=parseInt(i.substr(7,2),10),o<1841||o>2043)return null;if("0"!=r&&"1"!=r)return null;v=e(),b="31,0,31,30,31,30,31,31,30,31,30,31".split(","),1==t(i.substr(1,8))?b[1]=29:b[1]=28;u=o-1841,h=s-1,f=0,parseInt(v[12*u+h])>2&&(f=t(o+"0101"));if(1==f)switch(parseInt(v[12*u+h])){case 3:mm=29;break;case 4:mm=30;break;case 5:mm=29;break;case 6:mm=30}else switch(parseInt(v[12*u+h])){case 1:mm=29;break;case 2:mm=30;break;case 3:case 4:mm=29;break;case 5:case 6:mm=30}for(td=0,p=0;p<=u-1;p++)for(m=0;m<=11;m++)switch(parseInt(v[12*p+m])){case 1:td+=29;break;case 2:td+=30;break;case 3:td+=58;break;case 4:case 5:td+=59;break;case 6:td+=60}for(m=0;m<=h-1;m++)switch(parseInt(v[12*u+m])){case 1:td+=29;break;case 2:td+=30;break;case 3:td+=58;break;case 4:case 5:td+=59;break;case 6:td+=60}if(1==f)switch(parseInt(v[12*u+h])){case 3:case 4:mm=29;break;case 5:case 6:mm=30}if(td=td+a+22,"1"==r)switch(parseInt(v[12*u+h])){case 3:td+=29;break;case 4:td+=30;break;case 5:td+=29;break;case 6:td+=30}u=1840;for(;;){if(f=t((u+=1)+"0101"),_=1==f?366:365,td<=_)break;td-=_}l=u,b[1]=_-337,h=0;for(;;){if(h+=1,td<=parseInt(b[h-1]))break;td-=parseInt(b[h-1])}for(c=h,d=td,g=l,td=365*g+parseInt(g/4)-parseInt(g/100)+parseInt(g/400),p=0;p<=c-1;p++)td+=parseInt(b[p]);return td+=d,g+n("0"+c,2)+n("0"+d,2)}("0"+i.replace(/-/g,""));return{solarYear:o.substr(0,4),solarMonth:o.substr(4,2),solarDay:o.substr(6,2)}}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var i=n(563),o=n(1999),s=n(1617),a=n(152),r=n(799);e.exports=function(e,t){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.POLL_V2,apiType:"poll_v2",createModelFromJSON:i.createPollV2ByJSON,createWidgetView:r.widgetViewCreator(o),onWidgetModify:r.createLayoutModify((function(e){return s.openLayer(e,t.getBandCore().bandNo)}))},e,t)}},function(e,t,n){var i=n(563),o=n(2e3),s=n(1620),a=n(152),r=n(799);e.exports=function(e,t){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.TODO,apiType:"todo",createModelFromJSON:i.createTodoV1ByJSON,createWidgetView:r.widgetViewCreator(o),onWidgetModify:r.createLayoutModify((function(e){return s.openLayer(e,t.getBandNo())}))},e,t)}},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _btnModify"><%- IM("ui.label.modify") %></button>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -todo">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-todo sf_color" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-todo-22"></use>\n                    </svg>\n                    <span class="status sf_color"><%= IM("web.postlist.todo.txt.title") %></span>\n                    <%= isAllDone ? IM("web.postlist.todo.txt.done") : IM("web.postlist.todo.txt.in_progress", {doneCount: doneCount, taskCount: taskCount}) %>\n                </p>\n                <p class="addTitle"><%- title %></p>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="lyContent -w480 ">\n    <header class="header">\n        <h1 class="title"><%-IM(\'web.postwrite.form_todo.title\')%></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="postWrite">\n            <div class="addWidget">\n                <div class="scrollArea _scrollArea">\n                    <div class="titleWrap _titleWrap">\n                        <label for="todo_title" class="gSrOnly"><%-IM(\'web.postwrite.form_todo.label.title\')%></label>\n                        <input type="text"\n                               class="_todoTitle"\n                               id="todo_title"\n                               maxlength="<%-msg_titleMaxLength%>"\n                               bm-bind="postTodo|title"\n                               placeholder="<%-IM(\'web.postwrite.form_todo.label.title\')%>"\n                               value="<%-title%>">\n                        <div class="previousCheck">\n                            <button type="button" class="btnLoad _btnImportPrevTodo">불러오기<span class="gSrOnly"><%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.label\') %></span></button>\n                            <% if (!todoImportHelpClosed) { %>\n                            <dl class="uHelpGuide -right -close" role="alert" aria-live="assertive">\n                                <dt><span class="gSrOnly"><%-IM(\'ui.label.help\')%></span></dt>\n                                <dd class="_popoverHelpImportTodo" style="width:190px;display:block;">\n                                    <%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.help_description\') %>\n                                    <button type="button" class="btnLyClose _btnCloseImportTodoHelpPopover"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n                                </dd>\n                            </dl>\n                            <% } %>\n                        </div>\n                    </div>\n                    <div class="itemWriteList">\n                        <strong class="gSrOnly">TO DO LIST ITEM</strong>\n                        <ul class="todo _todoTaskList">\n                        </ul>\n                    </div>\n                    <button type="button" class="addItemBtn _btnAddTodoTask"><%-IM(\'web.postdetail.todo.add_task\')%></button>\n                    <% // 옵션 시작 %>\n                    <div class="optionCheck">\n                        <% // 멤버 누구나 항목 추가 %>\n                        <label for="todo_option1" class="uCheck -checkbox -fs13">\n                            <input type="checkbox" id="todo_option1" class="checkInput" bm-bind="postTodo|isTaskAddible" <%if(isTaskAddible){%>checked<%}%>>\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                                <span class="text"><%-IM(\'web.post.write.todo.is_additible\')%></span>\n                            </span>\n                        </label>\n                        <br>\n                        <% if (msg_checkableOnlyAuthorEnabled) { %>\n                        <% // 작성자만 체크 %>\n                        <label for="todo_option2" class="uCheck -checkbox -fs13">\n                            <input type="checkbox" id="todo_option2" class="checkInput" bm-bind="postTodo|isCheckableOnlyByAuthor" <%if(isCheckableOnlyByAuthor){%>checked<%}%>>\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                                <span class="text"><%-IM(\'web.postwrite.form_todo.label.is_checkable_only_by_author\')%></span>\n                            </span>\n                        </label>\n                        <% } %>\n                        <% // 마감일 설정 %>\n                        <div class="flexList -h32 -tbSpaceNone">\n                            <div class="text">\n                                <label for="todo_option3" class="uCheck -checkbox -fs13">\n                                    <input type="checkbox" id="todo_option3" class="checkInput _endedAtCheckbox" <%if(endedAt){%>checked<%}%>>\n                                    <span class="checkLabel">\n                                        <span class="shape"></span>\n                                        <span class="text"><%-IM(\'todo.set_ended_at.label.checkbox\')%></span>\n                                    </span>\n                                </label>\n                            </div>\n                            <% // 종료일시 %>\n                            <div class="etc _additionalOptionsWrap" style="width:275px;">\n                                <div class="_endedAtInputRegion"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <% // 옵션 끝 %>\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -confirm -disabled _btnComplete"><%-IM(\'web.btn.attach\')%></button>\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n    </footer>\n</div>'},function(e,t){e.exports='<li bm-repeat="postTodo|tasks">\n    <input type="text"\n           id="todo_item_<%-index%>"\n           class="inputItem _todoSubjectTitle"\n           name="poll_item"\n           bm-bind="postTodo-tasks|subject"\n           placeholder="<%-IM(\'web.postwrite.form_todo.placeholder.subject\')%>"\n           maxlength="<%-taskMaxLength%>"\n           value="<%-subject%>">\n    <input type="hidden" name="taskId" bm-bind="postTodo-tasks|taskId" value="<%-taskId%>" />\n    <a role="button" class="dragBar uButton -iconListMove"><span class="gSrOnly">Drag the mouse to change the order</span></a>\n    <span class="etc"></span>\n</li>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(4),s=n(486),a=n(706),r=n(2184),l=n(2186),c=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorTodoImportView"},template:t.template(l),ui:{btnBack:"._btnBack"},events:{"click @ui.btnBack":"destroy"},regions:{pastItemListRegion:{el:"._pastItems"}},childViewTriggers:{"childview:select:item":"select:item-import"},onRender:function(){this._fetchCollection()},initialize:function(e){this.bandNo=e.bandNo},_fetchCollection:function(){a.getImportTodo(this.bandNo).then(t.bind((function(e){var t=new i.Collection;t.reset(e.slice(0,10)),0!=e.length?this.showChildView("pastItemListRegion",new d({collection:t})):this.showChildView("pastItemListRegion","<p class='uEmpty -h480'><span>"+IM("ui.message.empty_conents")+"</span></p>")}),this))}}),d=o.CollectionView.extend({tagName:"ul",className:"listLine",childView:r});return c.openAsLayer=function(e){var t=new c({bandNo:e});return s.open(t),t},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(9),s=n(2185);return i.View.extend({tagName:"li",className:"item tLine",template:t.template(s),templateContext:function(){return{Localize:o}},attributes:{"data-viewname":"DEditorTodoImportItemView"},ui:{importTodo:"._btnImportTodo"},events:{"click @ui.importTodo":function(){this.trigger("select:item",this)}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button type="button" class="flexList _btnImportTodo">\n    <span class="text">\n        <span class="ellipsis"><%- title %></span>\n        <span class="sub -date"><%= Localize.format.date(created_at, \'short_date_time\') %></span>\n    </span>\n</button>'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_title\') %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="previousAttendance">\n            <div class="topNoticeBar">\n                <p class="sDesc gMat0"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_desc\') %></p>\n            </div>\n            <div class="_pastItems rScroll -h480"></div>\n        </div>\n    </div>\n    <footer class="footer -spaceNone">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%-IM(\'ui.label.back\')%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(563),o=n(2e3),s=n(1620),a=n(152),r=n(799);e.exports=function(e,t){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.TODO_V2,apiType:"todo_v2",createModelFromJSON:i.createTodoV2ByJSON,createWidgetView:r.widgetViewCreator(o),onWidgetModify:r.createLayoutModify((function(e){return s.openLayer(e,t.getBandNo())}))},e,t)}},function(e,t,n){var i=n(563),o=n(2189),s=n(152),a=n(799);e.exports=function(e,t){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.PHOTO_ALBUM,apiType:"photo_album",createModelFromJSON:i.createPhotoAlbumByJSON,createWidgetView:a.widgetViewCreator(o)},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=(n(82),n(2190));return i.View.extend({className:"",attributes:{"data-viewname":"AlbumWidgetView"},template:t.template(o),ui:{btnDelete:"._btnDelete"},triggers:{"click @ui.btnDelete":"remove"}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -album">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-album sf_color" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-photo-22"></use>\n                    </svg>\n                    <span class="status sf_color"><%= IM("web.postlist.attachphotoalbum.label") %></span>\n                    <%= isDeleted ? \'\' : IM(\'web.postlist.attachphotoalbum.title\', {count: photoCount || "0"}) %>\n                </p>\n                <p class="addTitle"><%- isDeleted ? IM(\'web.postlist.attachphotoalbum.title.deleted_album\') : name %></p>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){var i=n(563),o=n(2192),s=n(2001),a=n(152),r=n(799);e.exports=function(e,t){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.BILL_SPLIT,apiType:"bill_split",createModelFromJSON:i.createBillSplitByJSON,createWidgetView:r.widgetViewCreator(o),onWidgetModify:r.createLayoutModify((function(e){return s.openLayer(t.getBandNo(),e)}))},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2193);return i.View.extend({attributes:{"data-viewname":"BillSplitWidgetView"},template:t.template(o),ui:{btnModify:"._btnModify",btnDelete:"._btnDelete"},events:{"click @ui.btnModify":function(){this.model.get("isEditable")?this.trigger("modify"):alert(IM("web.postwrite.alert.modify_billsplit_denied"))}},triggers:{"click @ui.btnDelete":"remove"},serializeData:function(){return{paidMemberCount:this.model.get("paidMemberCount")||"0",currencyLabel:this.model.get("currencyLabel"),totalPrice:this.model.get("totalPrice"),memberCount:this.model.get("memberCount")||this.model.get("members").length||"0"}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _btnModify"><%- IM("ui.label.modify") %></button>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -n">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-nbang sf_color" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-nbang-22"></use>\n                    </svg>\n                    <span class="status sf_color"><%= IM("web.postlist.billsplit.title") %></span>\n                    <%= IM("web.postlist.billsplit.txt.paid_member_count", {count: paidMemberCount}) %>\n                </p>\n                <p class="addTitle"><%= currencyLabel + totalPrice%> / <i><%= IM("web.postlist.billsplit.txt.member_count", {count: memberCount}) %></i></p>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="lyContent -w480 ">\n    <header class="header">\n        <h1 class="title"><%-IM(\'web.postwrite.form_billsplit.title\')%></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="postWrite">\n            <div class="addWidget">\n                <div class="scrollArea -pa0">\n                    <div class="nHead">\n                        <div class="moneyUnit">\n                            <div class="flexList -tbSpaceNone">\n                                <div>\n                                    <div class="uSelect -h36 -bg">\n                                        <label for="moneyUnit" class="gSrOnly"><%-IM(\'web.postwrite.form_billsplit.select_currency\')%></label>\n                                        <select name="" id="moneyUnit" class="_currencyList" bm-bind="postBillSplit|currency">\n                                            <% _.each(msg_currencyList, function(item) { %>\n                                            <option value="<%-item.value%>"><%-item.label%></option>\n                                            <% }); %>\n                                        </select>\n                                    </div>\n                                </div>\n\n                                <div class="text gMal5 gPal0">\n                                    <div class="uInput">\n                                        <label for="money" class="gSrOnly"><%-IM(\'web.postwrite.form_billsplit.placeholder.total_price\')%></label>\n                                        <input type="text" id="money" class="gTaR _inputTotalPrice" bm-bind="postBillSplit|totalPrice" maxlength="50" placeholder="<%-IM(\'web.postwrite.form_billsplit.placeholder.total_price\')%>">\n                                        <span class="border"></span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <% if (members.length > 0) { %>\n                        <button type="button" class="memberSelect -on _btnSelectMember"><%-IM(\'web.postwrite.form_billsplit.label.selected_member_count\', {count: members.length})%></button>\n                        <% } else { %>\n                        <button type="button" class="memberSelect _btnSelectMember"><%-IM(\'web.postwrite.form_billsplit.btn.select_member\')%></button>\n                        <% } %>\n                    </div>\n                    <div class="nListWrap _billMembersWrap">\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="footer -lrSpaceNone -tLine">\n        <button type="button" class="uButton -confirm _btnComplete"><%-IM(\'web.btn.attach\')%></button>\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n    </footer>\n</div>'},function(e,t){e.exports='<ul class="nMemberList">\n    <% _.each(members, function(member, index) { %>\n    <li bm-repeat="postBillSplit|members">\n        <span class="cell">\n            <span class="uProfile -size40">\n                <span class="profileInner <%- member.profileInnerClass %>">\n                    <img src="<%-member.faceThumb%>" bm-bind="postBillSplit-members|faceThumb" width="40" height="40" alt="<%-member.name%>">\n                </span>\n            </span>\n        </span>\n        <span class="cell" bm-bind="postBillSplit-members|userNo" bm-value="<%-member.userNo%>">\n            <span bm-bind="postBillSplit-members|name"><%-member.name%></span>\n            <span class="uInput">\n                <input type="text" class="_memberPrice" bm-bind="postBillSplit-members|price" value="<%-member.price%>" data-index="<%-index%>">\n                <span class="border"></span>\n            </span>\n        </span>\n    </li>\n    <% }); %>\n</ul>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(4),a=n(555),r=n(82),l=n(164),c=n(491),d=n(2197),u=n(2198),h=n(493),p=n(1034),m=n(160),_=n(154),g=n(52),f=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorMemberSelectionView"},template:i.template(d),ui:{btnBack:"._btnBack",btnCancel:"._btnCancel",btnSubmit:"._btnSubmit",btnSearch:"._btnSearch",inputSearchTxt:"._inputSearchTxt",memberListWrap:"._memberListWrap",memberListItem:"._memberListItem",checkAllMemberWrap:"._checkAllMemberWrap",checkAllMember:"._checkAllMember",checkMember:"._checkMember",selectedMemberCount:"._selectedMemberCount",noSearchResultWrap:"._noSearchResultWrap",btnMemberDelete:"._btnMemberDelete",selectedMembersWrap:"._selectedMembersWrap",selectedMembers:"._selectedMembers",btnMemberGroupSelect:"._btnMemberGroupSelect"},events:{"click @ui.btnBack":"destroy","click @ui.btnCancel":"destroy","click @ui.btnSubmit":"_submitSelectedMember","click @ui.btnSearch":"_searchMember","click @ui.selectedMemberCount":"._updateMemberCount","click @ui.btnMemberDelete":"_memberUncheck","change @ui.checkAllMember":"_checkAllMember","change @ui.checkMember":"_onClickMembers","keyup @ui.inputSearchTxt":"_updateBtnSearchStatus","click @ui.btnMemberGroupSelect":"_openMemberGroupSelectLayer"},initialize:function(e){this._body=t("body"),this.bandNo=e.bandNo,this.selectedUserNoArray=e.selectedUserNoArray,this._selectedMembers=[],this._showMemberGroupBtn=!1},templateContext:function(){return{bandMemberCount:this.bandData&&this.bandData.getMemberCount(),bandCoverUrl:r.make(this.bandData&&this.bandData.getCoverUrl(),l.s75),makeProfileInnerClass:function(e){return r.makeProfileInnerClass(r.makeProfileThumbnailUrl(e))},makeProfileThumbnail:function(e){return r.makeProfileThumbnailUrl(e)},showMemberGroupBtn:this._showMemberGroupBtn}},onAttach:function(){_.wrapActivePromise(t.when(c.getCachedBandData(this.bandNo),h.getBandMembersOfBandWithFilter(this.bandNo,m.BILL_SPLIT)),this).then(i.bind((function(e,t){this.bandData=e;var n=g.camelizeKeys(t);if(this._showMemberGroupBtn=1==n.hasMemberGroup,this.collection.reset(n.members),this.render(),this.selectedUserNoArray){for(var o=0;o<this.collection.length;o++){var s=this.collection.at(o),a=s.get("userNo");i.contains(this.selectedUserNoArray,""+a)&&(this.ui.checkMember.get(o).checked=!0,this._addSelectedMember(s))}this._renderSelectedMembers(),this._changeSelectAllBtnCheckStatus()}}),this))},_submitSelectedMember:function(){var e=this.ui.checkMember.filter(":checked");if(e.length>0){var t=[];e.each(i.bind((function(e,n){var i=parseInt(n.value),o=this.collection.at(i),s=r.makeProfileThumbnailUrl(o.get("profileImageUrl"));o.set({faceThumb:s,profileInnerClass:r.makeProfileInnerClass(s)}),t.push(o)}),this)),this.trigger("select:member:done",t),this.destroy()}return!1},_checkAllMember:function(){var e=[];this.ui.checkAllMember[0].checked?(this.ui.checkMember.each((function(e,t){t.checked=!0})),this.collection.each((function(t){e.push(t)})),this._selectedMembers=e):(this.ui.checkMember.each((function(e,t){t.checked=!1})),this._selectedMembers=[]),this._renderSelectedMembers(),this._changeSelectAllBtnCheckStatus()},_updateBtnSearchStatus:function(e){e.keyCode==a.ENTER&&this._searchMember(),this.ui.inputSearchTxt.val()?this.ui.btnSearch.removeClass("-disabled").addClass("-active"):(this.ui.btnSearch.removeClass("-active").addClass("-disabled"),this._searchMember())},_openMemberGroupSelectLayer:function(e){e.preventDefault();var n=p.buildMemberGroupSelectView(this.bandNo);this.listenToOnce(n,"memberGroupView:selectedMemberGroups",(function(e){var n=i.pluck(e,"userNo");this.collection.chain().filter((function(e){return i.contains(n,e.getUserNo())})).each((function(e){this._addSelectedMember(e),t("[data-user="+e.getUserNo()+"]").prop("checked",!0)}),this),this._renderSelectedMembers(),this._changeSelectAllBtnCheckStatus()}))},_searchMember:function(){var e=this.ui.inputSearchTxt.val().toLowerCase();if(e){var n=!1;this.collection.each(i.bind((function(i,o){-1!==i.get("name").toLowerCase().indexOf(e)?(n=!0,t(this.ui.memberListItem.get(o)).show()):t(this.ui.memberListItem.get(o)).hide().addClass("-hide")}),this)),n?(this.ui.noSearchResultWrap.hide(),this.ui.memberListWrap.show()):(this.ui.noSearchResultWrap.show(),this.ui.memberListWrap.hide()),this.ui.checkAllMemberWrap.hide().addClass("-hide")}else this.ui.noSearchResultWrap.hide(),this.ui.checkAllMemberWrap.show().removeClass("-hide"),this.ui.memberListWrap.show(),this.ui.memberListItem.show().removeClass("-hide");return!1},_updateMemberCount:function(){var e=this.ui.checkMember.filter(":checked").length;e>0?(this.ui.btnSubmit.removeClass("-disabled"),this.ui.selectedMemberCount.text("("+e+")")):(this.ui.btnSubmit.addClass("-disabled"),this.ui.selectedMemberCount.text(""))},_renderSelectedMembers:function(){var e=[],t=i.template(u);this._updateMemberCount(),this._selectedMembers.length>0&&i.each(this._selectedMembers,(function(n,i){var o=r.makeProfileThumbnailUrl(n.get("profileImageUrl"));e.push(t({name:n.get("name"),profileThumbnail:o,profileInnerClass:r.makeProfileInnerClass(o),userNo:n.get("userNo"),index:i}))})),this._selectedMembers.length?(this.ui.selectedMembersWrap.show(),this.getUI("selectedMembers").empty().append(e.join("")).show()):(this.ui.selectedMembersWrap.hide(),this.ui.memberListWrap.css("max-height","")),this._selectedMembers.length>0&&this._selectedMembers.length<7?this.ui.memberListWrap.css("max-height","268px"):this._selectedMembers.length>6&&this.ui.memberListWrap.css("max-height","250px")},_changeSelectAllBtnCheckStatus:function(){this.collection.isEmpty()?this.ui.checkAllMember.prop("checked",!1):this.ui.checkAllMember.prop("checked",this.collection.length==this._selectedMembers.length)},_selectedMemberDelete:function(e){var t=i.findIndex(this._selectedMembers,(function(t){return t.get("userNo")==e}));this._selectedMembers.splice(t,1)},_memberUncheck:function(e){var n=this.$(e.target).attr("data-user");this.ui.checkMember.filter((function(){return t(this).attr("data-user")==n})).prop("checked",!1),this._selectedMemberDelete(n),this._renderSelectedMembers(),this._changeSelectAllBtnCheckStatus()},_onClickMembers:function(e){var n=this.collection.at(t(e.target).val()),i=n.get("userNo");t(e.target).is(":checked")?this._addSelectedMember(n):this._selectedMemberDelete(i),this._renderSelectedMembers(),this._changeSelectAllBtnCheckStatus()},_addSelectedMember:function(e){i.contains(this._selectedMembers,e)||this._selectedMembers.splice(0,0,e)}}),b=o.Model.extend({getUserNo:function(){return this.get("userNo")}});return f.buildDEditorMemberSelectionView=function(e,t){return new f({bandNo:e,selectedUserNoArray:t,collection:new o.Collection([],{model:b})})},f}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="modalHeader">\n        <h1 class="title"><%-IM(\'web.postwrite.form_billsplit_member.label.select_member\')%></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <form class="searchWrap" autocomplete="off">\n                <label for="searchMember" class="searchIcon">\n                    <span class="gSrOnly"><%-IM(\'web.profile.label.name\')%></span>\n                </label>\n                <span class="inputWrap">\n                <input type="text" id="searchMember" class="inputSearch _inputSearchTxt" placeholder="<%-IM(\'web.profile.label.name\')%>">\n            </span>\n                <button type="submit" class="btnSearch uButton -sizeS -default -disabled _btnSearch"><%-IM(\'web.postwrite.form_billsplit_member.btn.search\')%></button>\n            </form>\n\n            <div class="selectedMembersWrap _selectedMembersWrap">\n                <ul class="selectedMembers _selectedMembers"></ul>\n            </div>\n\n            <% if ( showMemberGroupBtn ) { %>\n            <div class="btnGroupMemberSelect gMat-1" >\n                <a href="#" role="button" class="button _btnMemberGroupSelect"><%- IM(\'band.member.group.select_member_groups\') %></a>\n            </div>\n            <% } %>\n            <div class="modalContentWrap rScroll -lrSpace gMat-1" style="height: 268px;">\n                <ul class="listLine _memberListWrap">\n                    <li class="tLine _checkAllMemberWrap">\n                        <label class="flexList">\n                            <span class="thumb">\n                                <span class="uProfile -size40">\n                                    <span class="profileInner">\n                                        <% if (!!bandCoverUrl) { %><img src="<%- bandCoverUrl %>" alt="Band Cover"><% } %>\n                                    </span>\n                                </span>\n                            </span>\n                            <span class="text -ellipsis"><%-IM(\'web.postwrite.form_billsplit_member.label.select_all_members\')%> (<%- bandMemberCount %>)</span>\n                                <span class="etc">\n                                <span for="uCheck" class="uCheck -checkbox">\n                                    <input type="checkbox" id="uCheck" class="checkInput _checkAllMember">\n                                    <span class="checkLabel">\n                                        <span class="shape"></span>\n                                    </span>\n                                </span>\n                            </span>\n                        </label>\n                    </li>\n\n                    <% _.each(items, function(member, index) { %>\n                    <li class="tLine _memberListItem">\n                        <label class="flexList">\n                            <span class="thumb">\n                                <span class="uProfile -size40">\n                                    <span class="profileInner <%- makeProfileInnerClass(member.profileImageUrl) %>">\n                                        <% if (!!member.profileImageUrl) { %>\n                                        <img src="<%- makeProfileThumbnail(member.profileImageUrl) %>" alt="<%-member.name%>">\n                                        <% } %>\n                                    </span>\n                                </span>\n                            </span>\n\n                            <span class="text -ellipsis">\n                                <span class="ellipsis"><%- member.name %></span>\n                                <% if (member.description) { %>\n                                <span class="sub2 -ellipsis"><%- member.description %></span>\n                                <% } %>\n                            </span>\n                            <span class="etc">\n                                <span for="uCheck_<%-index%>" class="uCheck -checkbox">\n                                    <input type="checkbox" id="uCheck_<%-index%>" data-user="<%-member.userNo%>" class="checkInput _checkMember" value="<%-index%>">\n                                    <span class="checkLabel">\n                                        <span class="shape"></span>\n                                    </span>\n                                </span>\n                            </span>\n                        </label>\n                    </li>\n                    <% }); %>\n                </ul>\n                <% // 검색결과 없을 경우 노출 %>\n                <p class="uEmpty -h162 _noSearchResultWrap" style="display:none;">\n                    <span><%-IM(\'web.postwrite.form_billsplit_member.message.no_search_result\')%></span>\n                </p>\n            </div>\n        </div>\n\n    </div>\n    <footer class="modalFooter -tLine">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%-IM(\'ui.label.back\')%></span></button>\n        <button type="button" class="uButton -cancel _btnCancel"><%-IM(\'ui.label.cancel\')%></button>\n        <button type="button" class="uButton -confirm -disabled _btnSubmit"><%-IM(\'ui.label.confirm\')%> <span class="_selectedMemberCount"></span></button>\n    </footer>\n</div>'},function(e,t){e.exports='<li>\n\t<span class="uProfile -size40">\n\t\t<span class="profileInner <%- profileInnerClass %>">\n\t\t\t<img src="<%- profileThumbnail %>" alt="<%-name%>">\n\t\t</span>\n\t</span>\n\t<span class="text"><%-name%></span>\n\t<button type="button" class="delete _btnMemberDelete" data-user="<%-userNo%>" index="<%-index%>"><span class="gSrOnly"><%= IM(\'ui.label.del\') %></span></button>\n</li>'},function(e,t,n){var i=n(563),o=n(2200),s=n(155),a=n(152),r=n(2002),l=n(799);e.exports=function(e,t){l.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP,apiType:"schedule_group",createModelFromJSON:i.createScheduleGroupByJSON,createWidgetView:l.widgetViewCreator(o),openModifyLayerView:function(e,t){return r.startEditingScheduleGroup({bandData:s.get(t.getBandNo()),scheduleGroup:e.clone()})},onWidgetModify:l.createLayoutModify((function(e){return r.startEditingScheduleGroup({bandData:s.get(t.getBandNo()),scheduleGroup:e.clone()})}))},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2201),s=n(653),a=n(9);return i.View.extend({attributes:{"data-viewname":"ScheduleWidgetView"},template:t.template(o),ui:{editBtn:"._editBtn",deleteBtn:"._deleteBtn"},triggers:{"click @ui.editBtn":"modify","click @ui.deleteBtn":"remove"},serializeData:function(){var e=this.model.getFirstScheduleModel(),t=a.isKoreanLanguage()?"dddd":"ddd";return{hasSingleSchedule:this.model.hasSingleSchedule(),scheduleDay:e.getStartAtMoment().format("DD"),scheduleDayName:e.getStartAtMoment().format(t),isDelete:e.get("isDelete"),name:e.get("name"),scheduleDateTime:s.multilineMessageForString(e.toJSON()),scheduleCount:this.model.getScheduleCount(),scheduleGroupTitle:this.model.get("title")}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _editBtn"><%- IM("ui.label.modify") %></button>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _deleteBtn"><%- IM("ui.label.delete") %></button>\n</div>\n<div class="bandWidgetContent sf_tOutline">\n    <% if (hasSingleSchedule) { %>\n    <div class="uWidget">\n<%\nif (isDelete) {\n%>\n        <div class="snippet" data-thumbnail="type0"><span class="snippetInfo"><span class="snippetTxt"><%= IM("web.postlist.attachschedule.title.deleted_or_secret_schedule") %></span> </span></div>\n<%\n} else {\n%>\n        <div class="item -calendar">\n            <div class="addHead scheduleHead">\n\n                <span class="day">\n                    <strong class="date"><%- scheduleDay %></strong>\n                    <span class="week sf_color"><%- scheduleDayName %></span>\n                </span>\n\n                <div class="contWrap">\n                    <div class="scheduleContWrap">\n                        <span class="addTitle"><%- name %></span>\n                        <time class="date"><%= scheduleDateTime %></time>\n                    </div>\n                </div>\n            </div>\n        </div>\n<% } %>\n    </div>\n    <% } else { %>\n    <div class="uWidget">\n        <div class="item -multiSchedule">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-mutiSchedule sf_color" aria-hidden="true">\n                        <use xlink:href="#ico-attach-mutiSchedule-22"></use>\n                        <use xlink:href="#ico-attach-mutiSchedule"></use>\n                    </svg>\n                    <span class="status sf_color"><%- IM(\'post.schedule_group.schedule_count\', {scheduleCount: scheduleCount}) %></span>\n                </p>\n                <p class="addTitle"><%- scheduleGroupTitle %></p>\n            </div>\n        </div>\n    </div>\n    <% } %>\n</div>'},function(e,t){e.exports='<%\nvar viewUniqueId = _.uniqueId("view_");\n%>\n<div class="_scheduleArticle lyContent -w480">\n    <header class="modalHeader <% if (editDescription) { %> -subDescType <% } %>">\n        <h1 class="title"><%- IM(\'schedule.edit.title.create\') %></h1>\n<% if (editDescription) { %>\n        <p class="desc"><%= editDescription %></p>\n<% } %>\n    </header>\n    <div class="modalBody -positionR">\n        <div class="modalContentWrap makeCalendar gMat20 _scheduleEditArea">\n            <div class="textInputArea">\n                <% // == 일정 제목 -- %>\n                <div class="uInput">\n                    <label class="gSrOnly" for="<%=viewUniqueId%>_name"><%=IM("schedule.txt.name")%></label>\n                    <input type="text"\n                           class="_scheduleName"\n                           id="<%=viewUniqueId%>_name"\n                           placeholder="<%=IM(\'schedule.edit.placeholder.name\')%>"\n                           maxlength="<%=nameMaxLength%>">\n                    <span class="border"></span>\n                    <div class="previousCheck">\n                        <button type="button" class="btnLoad _btnImportPrevSchedule">불러오기<span class="gSrOnly"><%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.label\') %></span></button>\n                        <% if (!scheduleImportHelpClosed) { %>\n                        <dl class="uHelpGuide -right -close -importHelpGuide" role="alert" aria-live="assertive">\n                            <dt><span class="gSrOnly"><%-IM(\'ui.label.help\')%></span></dt>\n                            <dd class="_popoverHelpImportSchedule" style="width:190px;display:block;">\n                                <%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.help_description\') %>\n                                <button type="button" class="btnLyClose _btnCloseImportScheduleHelpPopover"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n                            </dd>\n                        </dl>\n                        <% } %>\n                    </div>\n                </div>\n                <% // == 일정 설명 -- %>\n                <div class="uTextarea">\n                    <textarea class="_description" placeholder="<%=IM(\'schedule.edit.placeholder.description\') %>" maxlength="<%=descriptionMaxLength%>"></textarea>\n                    <span class="border"></span>\n                    <div class="btnUploadWrap">\n                        <span class="_schedulePhotoUpload image"><input type="file"></span>\n                        <span class="_scheduleFileUpload file -disabled"><input type="file"></span>\n                    </div>\n                </div>\n\n                <div class="_attachArea uploadArea -on">\n                    \x3c!-- 사진 첨부 --\x3e\n                    <div class="_photoArea photoArea" style="display:none">\n                        <ul class="_attachedPhotosRegion" style="display: none;"></ul>\n                        <button class="_btnAttachPhotoMore btnAttachPhoto"><span class="gSrOnly">attach more photos</span></button>\n                    </div>\n                    \x3c!-- 파일 첨부 --\x3e\n                    <ul class="_attachedFilesRegion" style="display:none"></ul>\n                    <ul class="_attachedDropboxFilesRegion" style="display:none"></ul>\n                    <ul class="_attachedExternalFilesRegion" style="display:none"></ul>\n                </div>\n            </div>\n            <div class="infoWrap gMat10">\n                <% // == 시작 일시 -- %>\n                <div class="flexList -tbSpaceNone gMat5">\n                    <div class="labelText"><%= IM(\'web.scheduleedit.date.start\') %></div>\n                    <div class="text gPal0 _startAtRegion"></div>\n                </div>\n                <% // == 종료 일시 -- %>\n                <div class="flexList -tbSpaceNone gMat5">\n                    <div class="labelText"><%= IM(\'web.scheduleedit.date.end\') %></div>\n                    <div class="text gPal0 _endAtRegion"></div>\n                </div>\n\n                <div class="dateOptionBox gMat7">\n<%\nif (useLunar) {\n%>\n                    <% // == 음력 설정 -- %>\n                    <label for="<%=viewUniqueId%>_isLunar" class="uCheck -checkbox">\n                        <input type="checkbox" id="<%=viewUniqueId%>_isLunar" class="_lunarCheckbox checkInput" value="true">\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%=IM("schedule.txt.lunar")%></span>\n                        </span>\n                    </label>\n<%\n}\n%>\n                    <% // == 하루종일 일정 설정 -- %>\n                    <label for="<%=viewUniqueId%>_allDay" class="uCheck -checkbox <% if (useLunar) { %>gMal20<% } %>">\n                        <input type="checkbox" id="<%=viewUniqueId%>_allDay" class="_allDayCheckbox checkInput" value="true">\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%=IM("schedule.edit.label.all_day_check") %></span>\n                        </span>\n                    </label>\n                    <% // == 시간대 설정 버튼 -- %>\n                    <button type="button" class="_btnTimezone btnTimezone"><%= IM(\'web.scheduleedit.date.timezone\') %></button>\n                </div>\n                <% // == 시간대 설정 -- %>\n                <div class="flexList -tbSpaceNone gMat16">\n                    <div class="_timezoneSelectRegion timezoneArea"></div>\n                </div>\n<% // -- 지도 첨부 -- %>\n<%\nif ( canAttachLocation ) {\n%>\n                <div class="flexList gMat5">\n                    <div class="labelText gPat0 gPab0"><%-IM("schedule.edit.location.label") %></div>\n                    <div class="attachLocation">\n                        <% // -- placeholderText -- %>\n                        <div class="locationLabel _locationLabel"><%=IM("location") %></div>\n\n                        <div class="locationArea _locationWrap">\n\n                            <span class="location _locationTitle"></span>\n                            <button type="button" class="btnCancel _btnRemoveLocation"><span class="gSrOnly"><%-IM("ui.label.delete") %></span></button>\n                        </div>\n                        <button type="button" class="btnMap _btnSelectLocation"><span class="gSrOnly"><%-IM("schedule.edit.location.btn.selectLocation") %></span></button>\n                    </div>\n                </div>\n<%\n}\n%>\n                <% // == 캘린더 카테고리 목록 -- %>\n                <div class="_calendarCategoryRegion"></div>\n            </div>\n        \n            <div class="_sharerSelectRegion"></div>\n\n            <div class="checkBottom _belowCalendarCategoryArea">\n                <div class="notiRepeat">\n                    <% // == 반복등록 설정-- %>\n                    <div class="_recurrenceRegion"></div>\n\n                    <% // == 미리알림 설정 -- %>\n                    <div class="_alarmsRegion"></div>\n                </div>\n\n                <% // == 참석여부 확인요청(RSVP) 설정 -- %>\n                <div class="_rsvpRegion"></div>\n\n<%\nif (showPosting) {\n%>\n                <% // == 게시글로 공유 설정 -- %>\n                <div class="gMat26 gMab-2 _belowCalendarCategoryArea">\n                    <label for="<%=viewUniqueId%>_post" class="uCheck -checkbox">\n                        <input type="checkbox"\n                               id="<%=viewUniqueId%>_post"\n                               class="_announceableCheckbox checkInput"\n                               value="true" checked>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%=IM("schedule.edit.label.auto_posting") %></span>\n                        </span>\n                    </label>\n                </div>\n<%\n}\n%>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter -positionR">\n        <span class="buttonWrap">\n            <button type="button" class="uButton -confirm _btnSubmit"><%- submitButtonText %></button>\n        </span>\n    </footer>\n    <div class="modalButton">\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose">\n            <span class="gSrOnly"><%=IM("ui.label.close_layer")%></span>\n        </button>\n    </div>\n</div>'},function(e,t){e.exports='<%\nvar viewUniqueId = _.uniqueId("view_");\n%>\n<div class="_scheduleArticle lyContent -w480">\n    <header class="modalHeader <% if (editDescription) { %> -subDescType <% } %>">\n        <h1 class="title"><%- IM(\'schedule.local_meetup_schedule\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap makeMeetupSchedule gMat20 _scheduleEditArea">\n            <h2 class="meetupTitle gMat-2 gMal-1"><%- IM(\'schedule.local_meetup_schedule_introduction_description\') %></h2>\n            <div class="introWrap gPat10">\n                <% // == 일정 제목 -- %>\n                <div class="uInput">\n                    <label class="gSrOnly" for="<%=viewUniqueId%>_name"><%=IM("schedule.txt.name")%></label>\n                    <input type="text"\n                           class="_scheduleName"\n                           id="<%=viewUniqueId%>_name"\n                           placeholder="<%=IM(\'schedule.edit.placeholder.name\')%>"\n                           maxlength="<%=nameMaxLength%>">\n                    <span class="border"></span>\n                    <div class="previousCheck">\n                        <button type="button" class="btnLoad _btnImportPrevSchedule"><span class="gSrOnly"><%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.label\') %></span></button>\n                        <% if (!scheduleImportHelpClosed) { %>\n                        <dl class="uHelpGuide -right -close -importHelpGuide" role="alert" aria-live="assertive">\n                            <dt><span class="gSrOnly"><%-IM(\'ui.label.help\')%></span></dt>\n                            <dd class="_popoverHelpImportSchedule" style="width:190px;display:block;">\n                                <%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.help_description\') %>\n                                <button type="button" class="btnLyClose _btnCloseImportScheduleHelpPopover"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n                            </dd>\n                        </dl>\n                        <% } %>\n                    </div>\n                </div>\n                <% // == 일정 설명 -- %>\n                <div class="uTextarea">\n                    <textarea class="_description" placeholder="<%=IM(\'schedule.edit.placeholder.description\') %>" maxlength="<%=descriptionMaxLength%>"></textarea>\n                    <span class="border"></span>\n                    <div class="btnUploadWrap">\n                        <span class="_schedulePhotoUpload image"><input type="file"></span>\n                        <span class="_scheduleFileUpload file -disabled"><input type="file"></span>\n                    </div>\n                </div>\n                <div class="_attachArea uploadArea -on">\n                    <% // -- 사진 첨부 -- %>\n                    <div class="_photoArea photoArea" style="display:none">\n                        <ul class="_attachedPhotosRegion" style="display: none;"></ul>\n                        <button class="_btnAttachPhotoMore btnAttachPhoto"><span class="gSrOnly">attach more photos</span></button>\n                    </div>\n                    <% //-- 파일 첨부 -- %>\n                    <ul class="_attachedFilesRegion" style="display:none"></ul>\n                    <ul class="_attachedDropboxFilesRegion" style="display:none"></ul>\n                    <ul class="_attachedExternalFilesRegion" style="display:none"></ul>\n                </div>\n            </div>\n            <h2 class="meetupTitle gMat18 gMal-1"><%- IM(\'schedule.local_meetup_schedule_time_place_description\') %></h2>\n\n\n            <div class="infoWrap gMat10">\n                <% // == 시작 일시 -- %>\n                <div class="flexList -tbSpaceNone gMat5">\n                    <div class="labelText"><%= IM(\'web.scheduleedit.date.start\') %></div>\n                    <div class="text gPal0 _startAtRegion"></div>\n                </div>\n                <% // == 종료 일시 -- %>\n                <div class="flexList -tbSpaceNone gMat5">\n                    <div class="dateTitle"><%= IM(\'web.scheduleedit.date.end\') %></div>\n                    <div class="text gPal0 _endAtRegion"></div>\n                </div>\n                <div class="dateOptionBox gMat7">\n                    <% if (useLunar) { %>\n                    <% // == 음력 설정 -- %>\n                    <label for="<%=viewUniqueId%>_isLunar" class="uCheck -checkbox">\n                        <input type="checkbox" id="<%=viewUniqueId%>_isLunar" class="_lunarCheckbox checkInput" value="true">\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%=IM("schedule.txt.lunar")%></span>\n                        </span>\n                    </label>\n                    <% } %>\n\n                    <input type="checkbox" id="<%=viewUniqueId%>_allDay" class="_allDayCheckbox checkInput" value="false" style="display: none;">\n\n                    <% // == 시간대 설정 버튼 -- %>\n                    <button type="button" class="_btnTimezone btnTimezone"><%= IM(\'web.scheduleedit.date.timezone\') %></button>\n                </div>\n                <% // == 시간대 설정 -- %>\n                <div class="flexList -tbSpaceNone gMat16">\n                    <div class="_timezoneSelectRegion timezoneArea"></div>\n                </div>\n\n                <% // -- 지도 첨부 -- %>\n<%\nif ( canAttachLocation ) {\n%>\n                <div class="flexList gMat5">\n                    <div class="labelText gPat0 gPab0"><%-IM("schedule.edit.location.label") %></div>\n\n                    <div class="attachLocation">\n                        <% // -- placeholderText -- %>\n                        <div class="locationLabel _locationLabel"><%=IM("location") %></div>\n\n                        <div class="locationArea _locationWrap">\n                            <span class="location _locationTitle"></span>\n                            <button type="button" class="btnCancel _btnRemoveLocation"><span class="gSrOnly"><%-IM("ui.label.delete") %></span></button>\n                        </div>\n                        <button type="button" class="btnMap _btnSelectLocation"><span class="gSrOnly"><%-IM("schedule.edit.location.btn.selectLocation") %></span></button>\n                    </div>\n                </div>\n<%\n}\n%>\n                <% // == 캘린더 카테고리 목록 -- %>\n                <div class="_calendarCategoryRegion"></div>\n\n                <% // -- [D] 추가옵션 클릭 시 style="display:none" 시켜 주시고, class="optionInfoWrap" 에 "-active" 추가 %>\n                <div class="optionButtonBox gMat4 _openExtraArea" style="display: none;">\n                    <button class="btnOptionPlus _openExtraBtn"><%- IM(\'schedule.extra_option\') %></button>\n                </div>\n            </div>\n            <div class="checkBottom _belowCalendarCategoryArea">\n                <% // -- [D] 추가옵션 클릭 시 class="-active" 추가 %>\n                <div class="optionInfoWrap _extraOptionArea" >\n                    <div class="explanatoryText gPat8 gPab8"><%- IM(\'schedule.local_meetup_schedule_default_attendance_absent_description\') %></div>\n\n                    <% // == 참석여부 확인요청(RSVP) 설정 -- %>\n                    <div class="_rsvpRegion"></div>\n\n                    <% // -- 반복등록 및 미리알림 %>\n                    <div class="notiRepeat">\n                        <% // == 반복등록 설정-- %>\n                        <div class="_recurrenceRegion"></div>\n\n                        <% // == 미리알림 설정 -- %>\n                        <div class="_alarmsRegion"></div>\n                    </div>\n                </div>\n<%\nif (showPosting) {\n%>\n                    <% // == 게시글로 공유 설정 -- %>\n                <div class="gMat26 gMab-2 _belowCalendarCategoryArea">\n                    <label for="<%=viewUniqueId%>_post" class="uCheck -checkbox">\n                        <input type="checkbox"\n                               id="<%=viewUniqueId%>_post"\n                               class="_announceableCheckbox checkInput"\n                               value="true" checked>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%=IM("schedule.edit.label.auto_posting") %></span>\n                        </span>\n                    </label>\n                </div>\n<%\n}\n%>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter">\n        <span class="buttonWrap">\n            <button type="button" class="uButton -confirm _btnSubmit"><%- submitButtonText %></button>\n        </span>\n\n        <div class="closeWrap">\n            <button type="button" class="btnLyClose uButton -iconClose _btnClose">\n                <span class="gSrOnly"><%=IM("ui.label.close_layer")%></span>\n            </button>\n        </div>\n    </footer>\n</div>'},function(e,t){e.exports='<% if (isShowTimezoneTitle) { %>\n<span class="dateTitle">\n    <label for="timezone"><%= IM(\'web.scheduleedit.date.timezone\') %></label>\n</span>\n<% } %>\n<span class="flexListBox" style="width: 350px">\n    <span class="flexList -tbSpaceNone -layoutFixed">\n        <span class="flexItem">\n            <span class="uSelect -h32 -bg -block gColorBk2">\n                <select id="timezone" class="gColorBk2 _countrySelect" data-value="<%- selectedCountry.code %>">\n                    <% _.each(countries, function(country) { %>\n                    <option value="<%- country.code %>" <% if(country.code == selectedCountry.code) { %>selected<% } %>><%- country.name %></option>\n                    <% }); %>\n                </select>\n            </span>\n        </span>\n        <span class="flexItem gMal5">\n            <span class="uSelect -h32 -bg -block gColorBk2">\n                <label for="timezone2" class="gSrOnly">GMT 선택</label>\n                <select id="timezone2" class="gColorBk2 _timezoneSelect" data-value="<%- selectedTimezone.id%>">\n                    <% _.each(selectedCountryTimezones, function(timezone) { %>\n                    <option value="<%- timezone.id %>" <% if(timezone.id == selectedTimezone.id) { %>selected<% } %>>(<%- timezone.gmtString %>) <%- timezone.cityName %></option>\n                    <% }); %>\n                </select>\n            </span>\n        </span>\n    </span>\n</span>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(82),s=n(164),a=i.View.extend({tagName:"li",template:t.template('<img src="<%- thumbnailUrl %>"><button type="button" class="deletePhoto _deletePhoto"><%- IM("web.commentmodify.attach.btn.delete_attach_info") %></button>'),serializeData:function(){var e=this.getOption("photo").url;return{url:e,thumbnailUrl:o.make(e,s.s150_low)}},ui:{deletePhoto:"._deletePhoto"},triggers:{"click @ui.deletePhoto":"deletePhoto"}}),r=i.CollectionView.extend({tagName:"ul",attributes:{"data-viewname":"DScheduleEditAttachedPhotosView"},onRender:function(){t.each(this.getOption("photos").toJSON(),(function(e){this.addChildView(new a({photo:e}))}),this)},childViewEvents:{deletePhoto:function(e){this.trigger("deletePhoto",e.getOption("photo"))}}});return r.buildDScheduleEditAttachedPhotosView=function(e){return new r({photos:e})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(848),s=n(631),a=n(632),r=i.View.extend({tagName:"li",template:t.template('<span class="fileName"><%- attachFileName %></span><span class="fileSize"><%- attachFileSize %></span><button class="deleteFile _deleteFile" ><%- IM("web.commentmodify.attach.btn.delete_attach_info") %></button>'),templateContext:function(){var e=this.getOption("file"),t=o.generateTemplateData(e)||{};return{attachFileSize:t.attachFileSize,attachFileName:t.attachFileName}},ui:{deleteFile:"._deleteFile"},events:{"click @ui.deleteFile":function(){var e=this.getOption("file");e instanceof s?this.trigger("deleteDropboxFile",e):e instanceof a?this.trigger("deleteExternalFile",e):this.trigger("deleteFile",e)}}}),l=i.CollectionView.extend({tagName:"ul",className:"fileArea",attributes:{"data-viewname":"DScheduleEditAttachedFilesView"},onRender:function(){this.getOption("fileUnionCollection").each((function(e){this.addChildView(new r({file:e}))}),this)},childViewEvents:{deleteFile:function(e){this.trigger("deleteFile",e)},deleteDropboxFile:function(e){this.trigger("deleteDropboxFile",e)},deleteExternalFile:function(e){this.trigger("deleteExternalFile",e)}}});return l.buildDScheduleEditAttachedFilesView=function(e,t,n){var i=(e||new Backbone.Collection).clone();return i.add((t||new Backbone.Collection).models),i.add((n||new Backbone.Collection).models),new l({fileUnionCollection:i})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(6),s=n(4),a=n(2208),r=n(2209),l=n(531),c=n(610),d=n(1115),u=n(43),h=n(2210),p=s.View.extend({attributes:{"data-viewname":"DScheduleEditRsvpView"},getTemplate:function(){return this._localMeetup?t.template(r):t.template(a)},templateContext:function(){return{rsvpVisibleQualification:l.RSVP_VISIBLE_QUALIFICATION,responseMemberVisibleToAll:this._localMeetup,rsvpOnAsDefault:this._localMeetup,localMeetup:this._localMeetup,cid:this.cid}},className:function(){return this.options.localMeetup?"":"gInlineBlock gMar23 gMat20"},ui:{rsvpRequested:"._rsvpRequested",dateTimeRegion:"._dateTimeRegion",attendeeLimit:"._attendeeLimit",setEndedAtWrap:"._setEndedAtWrap",checkChildMemberAddible:"._checkChildMemberAddible",childMemberLimit:"._childMemberLimit",childMemberLimitWrap:"._childMemberLimitWrap",childMemberHelpGuide:"._childMemberHelpGuide",btnHelpGuide:"._btnHelpGuide",btnHelpGuideClose:"._btnHelpGuideClose",isMaybeEnabled:"._isMaybeEnabled",addCustomState:"._addCustomState",customRsvpStatusCount:"._customRsvpStatusCount",selectRsvpVisibleQualification:"._selectRsvpVisibleQualification",btnRsvpVisibleGuide:"._btnRsvpVisibleGuide",btnRsvpVisibleGuideClose:"._btnRsvpVisibleGuideClose",rsvpVisibleGuide:"._rsvpVisibleGuide"},regions:{dateTimeRegion:"@ui.dateTimeRegion"},events:{"change @ui.rsvpRequested":"_setRsvpRequest","blur @ui.attendeeLimit":"_setAttendeeLimit","click @ui.checkChildMemberAddible":"_setRsvpChildMemberRequest","blur @ui.childMemberLimit":"_setRsvpChildMemberLimit","click @ui.btnHelpGuide":"_displayChileMemberHelpGuide","click @ui.btnHelpGuideClose":"_displayChileMemberHelpGuide","click @ui.isMaybeEnabled":function(){this.model.set("isMaybeEnabled",this.ui.isMaybeEnabled.is(":checked"))},"click @ui.addCustomState":function(){var e=h.buildDRsvpCustomStateEditViewAsLayer(this.model.getCustomStateList());this.listenTo(e,"confirm:customState",(function(e){this.model.set("customStates",e);var t=e.length>0?e.length:"";this.ui.customRsvpStatusCount.text(t)}))},"change @ui.selectRsvpVisibleQualification":function(){var e=this.ui.selectRsvpVisibleQualification.val();this.model.set("rsvpVisibleQualification",e)},"click @ui.btnRsvpVisibleGuide":function(){this.ui.rsvpVisibleGuide.show()},"click @ui.btnRsvpVisibleGuideClose":function(){this.ui.rsvpVisibleGuide.hide()}},modelEvents:{change:function(){this.model.isUpdating()||this.trigger("rsvpChanged",this.model.toRsvpInputModel()),this._updateUI()}},childViewEvents:{dateTimeChanged:function(e){e.date||e.time?e.date&&e.time&&this._changeEndedAt(u(e.date+"T"+e.time,e.dateFormat+"T"+e.timeFormat)):this.model.set("endedAt",null)}},initialize:function(e){this._originalAttendeeCount=e.originalAttendeeCount,this._localMeetup=e.localMeetup},_setRsvpRequest:function(){this.model.set("rsvpRequested",this.getUI("rsvpRequested").is(":checked"))},_setAttendeeLimit:function(){var e=i.trim(this.getUI("attendeeLimit").val());if(""!==e){var n=parseInt(e);if(!t.isFinite(n)||n<1)this._updateUI();else{if(n>1e3)return alert(IM("schedule.edit.rsvp.alert.exceed_attendee_limit",{attendeeLimit:n})),void this._updateUI();this.getUI("attendeeLimit").val(n),this.model.set("attendeeLimit",n)}}else this.model.set("attendeeLimit",null)},_setRsvpChildMemberRequest:function(){var e=this.ui.checkChildMemberAddible.prop("checked");this.model.set("isChildMemberAddible",e),this._updateUI()},_setRsvpChildMemberLimit:function(){var e=parseInt(this.getUI("childMemberLimit").val());if(""!==i.trim(e))if(!t.isFinite(e)||e<1)this._updateUI();else{if(e>1e3)return alert(IM("schedule.edit.rsvp.child_member_limit.notice",{maxCount:l.RSVP.ATTENDEE_MAX_COUNT})),void this._updateUI();this.getUI("childMemberLimit").val(e),this.model.set("childMemberLimit",e)}else this.model.set("childMemberLimit",null)},_changeEndedAt:function(e){return e.isBefore(u())?(alert(IM("schedule.edit.rsvp.alert.invalid_ended_at")),void this._updateUI()):u().add(90,"day").isBefore(e)?(alert(IM("schedule.edit.rsvp.alert_ended_at_maximum",{maximum:90})),void this._updateUI()):void this.model.set("endedAt",e.valueOf())},onDomRefresh:function(){this._updateUI()},_updateUI:function(){var e=this.model.get("rsvpRequested");this.getUI("rsvpRequested").prop("checked",e),this.$el.toggleClass("-active",e),this.getUI("attendeeLimit").val(this.model.get("attendeeLimit")),this.model.get("canSetEndedAt")?this.getUI("setEndedAtWrap").show():this.getUI("setEndedAtWrap").hide();var t={useDelete:!0,datePlaceholder:IM("ui.datepicker.placeholder.optional"),timePlaceholder:IM("ui.timepicker.placeholder.optional"),datepickerDirection:d.DATEPICKER_DIRECTION.UP,timepickerDirection:d.TIMEPICKER_DIRECTION.UP};if(this.model.get("endedAt")){var n=u(this.model.get("endedAt"));t.date=n.format("YYYY-MM-DD"),t.time=n.format("HH:mm")}this.showChildView("dateTimeRegion",d.buildDDateInputView(t));var i=this.model.get("isChildMemberAddible");this.getUI("checkChildMemberAddible").prop("checked",i),this.getUI("childMemberLimitWrap").toggle(i),this.getUI("childMemberLimit").val(this.model.get("childMemberLimit")),this.ui.isMaybeEnabled.prop("checked",this.model.get("isMaybeEnabled"));var o=this.model.getCustomStateList(),s=o&&o.length>0?o.length:"";this.ui.customRsvpStatusCount.text(s);var a=this.model.isShowRsvpResponseMemberToAll()?l.RSVP_VISIBLE_QUALIFICATION.ALL:l.RSVP_VISIBLE_QUALIFICATION.ONLY_MANAGER;this.ui.selectRsvpVisibleQualification.val(a)},updateRsvpInfo:function(e,t){this.model.setScheduleInfo(e,t)},editCompleted:function(){return!this.model.has("attendeeLimit")||(!(this.model.get("attendeeLimit")<this._originalAttendeeCount&&!confirm(IM("schedule.edit.rsvp.confirm.change_attendee_count")))||(this.getUI("attendeeLimit").focus(),!1))},_displayChileMemberHelpGuide:function(){this.getUI("childMemberHelpGuide").toggle()}}),m=o.Model.extend({defaults:{rsvpRequested:!1,attendeeLimit:null,canSetEndedAt:!0,endedAt:null,isChildMemberAddible:!1,childMemberLimit:null,isMaybeEnabled:!0,customStates:null,rsvpVisibleQualification:l.RSVP_VISIBLE_QUALIFICATION.ALL},initialize:function(){this._updating=!1},toRsvpInputModel:function(){return this.get("rsvpRequested")?c.createScheduleRsvpModel({attendeeLimit:this.get("attendeeLimit"),endedAt:this.get("endedAt"),isChildMemberAddible:this.get("isChildMemberAddible"),childMemberLimit:this.get("childMemberLimit"),isMaybeEnabled:this.get("isMaybeEnabled"),customStates:this.get("customStates"),rsvpVisibleQualification:this.get("rsvpVisibleQualification")}):null},setScheduleInfo:function(e,t){if(!c.isSameRsvpInput(this.toRsvpInputModel(),e,!1)||t!==this.get("canSetEndedAt")){this._updating=!0;try{var n={rsvpRequested:!!e,canSetEndedAt:t};n.rsvpRequested&&(n.attendeeLimit=e.get("attendeeLimit"),n.endedAt=e.get("endedAt"),n.isChildMemberAddible=e.get("isChildMemberAddible"),n.childMemberLimit=e.get("childMemberLimit"),n.isMaybeEnabled=e.get("isMaybeEnabled"),n.customStates=e.get("customStates"),n.rsvpVisibleQualification=e.get("rsvpVisibleQualification")),this.set(n)}finally{this._updating=!1}}},isUpdating:function(){return this._updating},getCustomStateList:function(){return this.get("customStates")},isShowRsvpResponseMemberToAll:function(){return this.get("rsvpVisibleQualification")==l.RSVP_VISIBLE_QUALIFICATION.ALL}});return p.buildDScheduleEditRsvpView=function(e,t){var n=new m;return t&&n.set("rsvpRequested",!0),new p({model:n,originalAttendeeCount:e||0,localMeetup:1==t})},p}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% //  // 참석 여부 확인 요청 버튼  %>\n<label class="uCheck -checkbox" >\n    <input type="checkbox" class="checkInput _rsvpRequested" >\n    <span class="checkLabel">\n        <span class="shape"></span>\n        <span class="text"><%-IM("schedule.edit.rsvp.label") %></span>\n    </span>\n</label>\n\n<div class="rsvpCheckbox gMat5 gPal26">\n    <% //  미정 응답 사용 여부  %>\n    <div class="flexList gPat8 gPab8 -spaceBetween">\n        <label for="rsvp-maybe-enabled" class="flexLabel gFs13 gMal-1"><%= IM("schedule.edit.rsvp.maybe.enabled")%></label>\n        <span class="flexItem">\n            <label for="rsvp-maybe-enabled" class="uCheck -switch ">\n                <input type="checkbox" id="rsvp-maybe-enabled" name="uCheck" class="checkInput _isMaybeEnabled">\n                <span class="checkLabel">\n                    <span class="shape "></span>\n                    <span class="text"></span>\n                </span>\n            </label>\n        </span>\n    </div>\n    <% //  응답 항목 추가  %>\n    <button type="button" class="flexList customRsvp gPat7 gPab8 -spaceBetween _addCustomState">\n        <span class="flexLabel gFs13 gColorBk2 addCustomText"><%= IM("rsvp.custom.edit.title") %></span><span class="flexItem customRsvpStatusCount _customRsvpStatusCount"></span>\n    </button>\n\n    <% //  // 참석 확인 종료일  %>\n    <div class="flexList -spaceBetween _setEndedAtWrap">\n        <label class="flexLabel gFs13"><%-IM("schedule.edit.rsvp.ended_at.label") %></label>\n        <span class="flexItem _dateTimeRegion" style="width:270px"></span>\n    </div>\n\n    <% //  // 참석인원 제한  %>\n    <div class="flexList -spaceBetween">\n        <label for="attendeeLimitCheckbox" class="flexLabel gFs13"><%-IM("schedule.edit.rsvp.attendee_limit.label") %></label>\n        <% //  [D] 비활성시 class="-off"  %>\n        <span class="flexItem" style="width:132px">\n            <span class="uInput -h32">\n                <input id="attendeeLimitCheckbox" type="text" placeholder="<%-IM("schedule.edit.rsvp.attendee_limit.placeholder")%>" class="_attendeeLimit">\n                <span class="border"></span>\n            </span>\n        </span>\n    </div>\n\n    <% //  [D] 응답 멤버 보기 추가  %>\n    <div class="flexList -spaceBetween" >\n        <div class="flexLabel">\n            <dl class="uHelpGuide -up -arrowLeft -small -close">\n                <dt>\n                    <button type="button" id="helpGuideNotice" class="gMal0 gPar21 gFs13 gColorBk2 _btnRsvpVisibleGuide" aria-haspopup="true" aria-controls="popupHelpGuide">\n                        <span><%= IM("rsvp.visible_qualification.title") %></span><span class="gSrOnly"><%= IM("ui.label.help") %></span>\n                    </button>\n                </dt>\n                <dd id="popupHelpGuide" class="_rsvpVisibleGuide" aria-labelledby="helpGuideNotice" aria-hidden="true" style="display: none; width:240px">\n                    <%= IM("rsvp.visible_qualification.help.txt") %>\n                    <button type="button" class="btnLyClose _btnRsvpVisibleGuideClose"><span class="gSrOnly"><%- IM(\'uil.label.help.close\') %></span></button>\n                </dd>\n            </dl>\n        </div>\n\n        <div class="flexItem" style="width:132px">\n            <div class="uSelect -h32 -bg -block gColorBk2">\n                <label for="selectRepeat3" class="gSrOnly"><%= IM("rsvp.visible_qualification.title") %></label>\n                <select id="selectRepeat3" class="_selectRsvpVisibleQualification">\n                    <option value="<%= rsvpVisibleQualification.ALL %>"><%= IM("rsvp.visible_qualification.all.label") %></option>\n                    <option value="<%= rsvpVisibleQualification.ONLY_MANAGER %>"><%= IM("rsvp.visible_qualification.only_manager.label") %></option>\n                </select>\n            </div>\n        </div>\n    </div>\n    <% //  //응답 멤버 보기  %>\n</div>\n\n<div class="outsiders">\n    <div class="addRow">\n        <% //  // 외부 멤버 추가  %>\n        <dl class="uHelpGuide -up -arrowLeft -small -close">\n            <dt>\n                <button type="button" id="helpGuide" aria-haspopup="true" aria-controls="popupMenu" class="_btnHelpGuide">\n                <span><%- IM("schedule.edit.rsvp.add_child_member.title") %></span>\n                <span class="gSrOnly"><%- IM(\'ui.label.help\') %></span></button>\n            </dt>\n            <dd id="popupMenu" aria-labelledby="helpGuide" aria-hidden="true" style="display: none; width:250px" class="_childMemberHelpGuide">\n                <%- IM(\'schedule.edit.rsvp.add_child_member.help_guide\') %>\n                <button type="button" class="btnLyClose _btnHelpGuideClose">\n                    <span class="gSrOnly"><%- IM(\'uil.label.help.close\') %></span>\n                </button>\n            </dd>\n        </dl>\n        <label for="notice" class="uCheck -switch">\n            <input type="checkbox" id="notice" name="uCheck" class="checkInput _checkChildMemberAddible">\n            <span class="checkLabel">\n                <span class="shape "></span>\n                <span class="text"></span>\n            </span>\n        </label>\n    </div>\n\n    <% //  // 외부 멤버 추가 인원 제한  %>\n    <div class="rsvpCheckbox _childMemberLimitWrap">\n        <div class="flexList -spaceBetween">\n            <label for="rsvpCheckbox3" class="flexLabel gFs13"><%- IM("schedule.edit.rsvp.child_member_limit.label") %></label>\n            <% //  [D] 비활성시 class="-off"  %>\n            <span class="flexItem" style="width:132px">\n                <span class="uInput -h32">\n                    <input type="text" id="rsvpCheckbox3" placeholder="<%- IM(\'schedule.edit.rsvp.child_member_limit.placeholder\') %>" class="_childMemberLimit">\n                    <span class="border"></span>\n                </span>\n            </span>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<% //  // 참석 여부 확인 요청 버튼  %>\n<label class="uCheck -checkbox" style="display:none;">\n    <input type="checkbox" class="checkInput _rsvpRequested" checked>\n    <span class="checkLabel">\n        <span class="shape"></span>\n        <span class="text"><%-IM("schedule.edit.rsvp.label") %></span>\n    </span>\n</label>\n\n<div class="rsvpCheckbox">\n    <% //  미정 응답 사용 여부  %>\n    <div class="flexList -spaceBetween">\n        <label for="rsvp-maybe-enabled_<%- cid %>" class="flexLabel gFs13 gMal-1 gPat7 gPab8"><%= IM("schedule.edit.rsvp.maybe.enabled")%></label>\n        <span class="flexItem">\n            <label for="rsvp-maybe-enabled_<%- cid %>" class="uCheck -switch ">\n                <input type="checkbox" id="rsvp-maybe-enabled_<%- cid %>" name="uCheck" class="checkInput _isMaybeEnabled">\n                <span class="checkLabel">\n                    <span class="shape "></span>\n                    <span class="text"></span>\n                </span>\n            </label>\n        </span>\n    </div>\n    <% //  응답 항목 추가  %>\n    <button type="button" class="flexList customRsvp -spaceBetween _addCustomState">\n        <span class="flexLabel addCustomText gFs13 gColorBk2  gPat7 gPab8"><%= IM("rsvp.custom.edit.title") %></span><span class="flexItem customRsvpStatusCount _customRsvpStatusCount"></span>\n    </button>\n\n    <% //  // 참석 확인 종료일  %>\n    <div class="flexList -spaceBetween _setEndedAtWrap">\n        <label class="flexLabel gFs13  gPat10 gPab8"><%-IM("schedule.edit.rsvp.ended_at.label") %></label>\n        <span class="flexItem _dateTimeRegion" style="width:270px"></span>\n    </div>\n\n    <% //  // 참석인원 제한  %>\n    <div class="flexList -spaceBetween">\n        <label for="attendeeLimitCheckbox" class="flexLabel gFs13  gPat10 gPab8"><%-IM("schedule.edit.rsvp.attendee_limit.label") %></label>\n        <% //  [D] 비활성시 class="-off"  %>\n        <span class="flexItem" >\n            <span class="uInput -h32" style="width:132px">\n                <input id="attendeeLimitCheckbox" type="text" placeholder="<%-IM("schedule.edit.rsvp.attendee_limit.placeholder")%>" class="_attendeeLimit">\n                <span class="border"></span>\n            </span>\n        </span>\n    </div>\n\n    <% //  // 외부 멤버 추가  %>\n    <div class="flexList -spaceBetween gMat2">\n        <div class="flexLabel  gPat8 gPab8">\n            <dl class="uHelpGuide -up -arrowLeft -small -close">\n                <dt>\n                    <button type="button" id="helpGuideNotice_<%- cid %>" class="gMal0 gPar21 gFs13 gColorBk2 _btnHelpGuide" aria-haspopup="true" aria-controls="popupHelpGuide">\n                        <span><%- IM("schedule.edit.rsvp.add_child_member.title") %></span>\n                        <span class="gSrOnly"><%- IM(\'ui.label.help\') %></span></button>\n                    </button>\n                </dt>\n                <dd id="popupHelpGuide_<%- cid %>" aria-labelledby="helpGuideNotice" aria-hidden="true" style="display: none; width:240px" class="_childMemberHelpGuide">\n                    <%- IM(\'schedule.edit.rsvp.add_child_member.help_guide\') %>\n                    <button type="button" class="btnLyClose _btnHelpGuideClose">\n                        <span class="gSrOnly"><%- IM(\'uil.label.help.close\') %></span>\n                    </button>\n                </dd>\n            </dl>\n        </div>\n        <span class="flexItem">\n            <label for="rsvpCheckbox1-0_<%- cid %>" aria-label="" class="uCheck -switch ">\n                <input type="checkbox" id="rsvpCheckbox1-0_<%- cid %>" name="uCheck" class="checkInput _checkChildMemberAddible">\n                <span class="checkLabel">\n                    <span class="shape  "></span>\n                    <span class="text"></span>\n                </span>\n            </label>\n        </span>\n    </div>\n    <% //  // 외부 멤버 추가 인원 제한  %>\n    <div class="rsvpCheckbox _childMemberLimitWrap">\n        <div class="flexList -spaceBetween">\n            <label for="rsvpCheckbox3_<% cid %>" class="flexLabel gFs13"><%- IM("schedule.edit.rsvp.child_member_limit.label") %></label>\n            <% //  [D] 비활성시 class="-off"  %>\n            <span class="flexItem" style="width:132px">\n                <span class="uInput -h32">\n                    <input type="text" id="rsvpCheckbox3_<% cid %>" placeholder="<%- IM(\'schedule.edit.rsvp.child_member_limit.placeholder\') %>" class="_childMemberLimit">\n                    <span class="border"></span>\n                </span>\n            </span>\n        </div>\n    </div>\n</div>'},function(e,t,n){var i=n(4),o=n(2211),s=n(0),a=n(486),r=n(197),l=i.View.extend({attributes:{"data-viewname":"DRsvpCustomStateEditView"},className:"lyWrap layer_wrap",template:s.template(o),templateContext:function(){return{customInputInfoList:this._makeCustomStateListToShow(),dragEnabledElementClass:"_dragEnabledEl",maxLength:200}},ui:{btnClose:"._btnClose",customStateItem:"._customStateItem",scrollArea:"._scrollArea",customStateList:"._customStateList",addedCustomStateList:"._addedCustomStateList",customStateInput:"._customStateInput",btnComplete:"._btnComplete",btnAddCustomStateInfo:"._btnAddCustomStateInfo"},events:{"click @ui.btnClose":function(){this._confirmCustomState()},"keyup @ui.customStateInput":s.debounce((function(e){var t=this._isCustomStateListModified();this._toggleConfirmBtn(t);var n=e.target;n.value.trim().length<=0||n!=this.ui.customStateInput.last()[0]||10==this.ui.customStateInput.length||this._addCustomStateItemAndCheckUI()}),100),"click @ui.btnComplete":function(){if(!this._confirmEnabled)return!1;this._confirmCustomState()},"click @ui.btnAddCustomStateInfo":function(){this._addCustomStateItemAndCheckUI()}},initialize:function(e){this._originalCustomStateInfoArr=e.originalCustomStateInfoArr?e.originalCustomStateInfoArr:[],this._confirmEnabled=!1},onAttach:function(){this._sortable=r.create(this.ui.customStateList[0],{scrollSensitivity:70,handle:"._dragEnabledEl",onEnd:s.bind((function(e){var t=this._isCustomStateListModified();this._toggleConfirmBtn(t)}),this),setData:null}),10==this._originalCustomStateInfoArr.length&&this.ui.btnAddCustomStateInfo.hide()},onBeforeDetach:function(){this._sortable&&this._sortable.destroy()},_confirmCustomState:function(){var e=this._getEdittedCustomStateInfoList();this._isCustomStateListModified()&&confirm(IM("rsvp.custom.edit.confirm.msg"))&&this.trigger("confirm:customState",e),this.destroy()},_addCustomStateItemAndCheckUI:function(){this.ui.customStateList.append(s.template('<li class="_customStateItem"><input type="text" value="" placeholder="<%= IM("web.postwrite.form_todo.placeholder.subject") %>" class="inputItem  _customStateInput" maxlength="<%= maxLength %>"><a href="#" role="button" class="dragBar uButton -iconListMove <%= dragEnabledClass%>"><span class="gSrOnly">순서변경시 마우스 드래그</span></a><span class="etc"></span></li>')({dragEnabledClass:"_dragEnabledEl",maxLength:200})),this.bindUIElements(),this.ui.scrollArea.stop().animate({scrollTop:this.ui.customStateList.height()-this.ui.scrollArea.height()/2}),10==this.ui.customStateItem.length&&this.ui.btnAddCustomStateInfo.hide()},_isCustomStateListModified:function(){var e=this._getEdittedCustomStateInfoList();if(e.length>0&&!this._originalCustomStateInfoArr)return!0;if(e.length!=this._originalCustomStateInfoArr.length)return!0;if(e.length==this._originalCustomStateInfoArr.length){return!!e.some(s.bind((function(e,t){if(e.title!=this._originalCustomStateInfoArr[t].title||e.customStateId!=this._originalCustomStateInfoArr[t].customStateId)return!0}),this))}},_toggleConfirmBtn:function(e){if(e)return this._confirmEnabled=!0,void this.ui.btnComplete.removeClass("-disabled");e||this.ui.btnComplete.hasClass("-disabled")||(this._confirmEnabled=!1,this.ui.btnComplete.addClass("-disabled"))},_makeCustomStateListToShow:function(){if(s.isEmpty(this._originalCustomStateInfoArr)){var e=[];return s.times(3,(function(){e.push({title:""})})),e}return this._originalCustomStateInfoArr},_getEdittedCustomStateInfoList:function(){this.bindUIElements();var e=[];return this.ui.customStateInput.each(s.bind((function(t){var n=this.ui.customStateInput[t];if(n.value.trim()){var i={title:n.value.trim()},o=n.dataset.id;if(o){var a=s.find(this._originalCustomStateInfoArr,(function(e){return e.customStateId==o}));(i=s.clone(a)).title=n.value.trim()}e.push(i)}}),this)),e}});l.buildDRsvpCustomStateEditViewAsLayer=function(e){var t=new l({originalCustomStateInfoArr:e});return a.open(t),t},e.exports=l},function(e,t){e.exports='<div class="lyContent -w480 ">\n    <header class="header">\n        <h1 class="title"><%= IM("rsvp.custom.edit.title") %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="postWrite">\n            <div class="addWidget">\n                <div class="scrollArea _scrollArea" style="height:240px">\n                    <div class="guideArea gMat24">\n                        <p class="sDesc gFs13"><%= IM("rsvp.custom.edit.desc") %></p>\n                    </div>\n                    <div class="itemWriteList">\n                        <strong class="gSrOnly"><%= IM("rsvp.custom.edit.list.msg") %></strong>\n                        <ul class="todo _customStateList">\n                            <% _.each(customInputInfoList, function(customStateInfo) { %>\n                            <li class="_customStateItem">\n                                <input type="text" value="<%- customStateInfo.title %>" data-id="<%= customStateInfo.customStateId %>" placeholder="<%- IM(\'web.postwrite.form_todo.placeholder.subject\') %>" class="inputItem _customStateInput" maxlength="<%= maxLength %>">\n                                <a href="#" role="button" class=" dragBar uButton -iconListMove <%= dragEnabledElementClass %>" ><span class="gSrOnly">순서변경시 마우스 드래그</span></a>\n                                <span class="etc"></span>\n                            </li>\n                            <% }) %>\n                        </ul>\n                        <button type="button" class="addItemBtn _btnAddCustomStateInfo"><%= IM("rsvp.custom.edit.add.button") %></button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _btnClose"><%= IM("web.postwrite.btn.cancel") %></button>\n        <button type="button" class="uButton -confirm -disabled _btnComplete"><%= IM("web.modal.btn.confirm") %></button>\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnClose"><span class="gSrOnly"><%= IM("ui.label.back") %></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(4),s=n(2213),a=n(16),r=n(2214),l=n(531),c=n(651),d=n(523),u=n(2216),h=n(1116),p=n(1621),m=o.View.extend({attributes:{"data-viewname":"DScheduleEditRecurrenceView"},template:t.template(s),templateContext:function(){return{vid:this.cid}},initialize:function(){this._scheduleRsvpModel=null,this._isRequireUntilSelectDirectAlerted=!1},ui:{recurrenceType:"._recurrenceType",freq:"._freq",interval:"._interval",customRecurrenceWrap:"._customRecurrenceWrap",byDaySelectionRegion:"._byDaySelectionRegion",untilWrap:"._untilWrap",untilRegion:"._untilRegion",infinite:"._infinite"},regions:{byDaySelectionRegion:"@ui.byDaySelectionRegion",untilRegion:"@ui.untilRegion"},modelEvents:{"change:startAtMoment":function(){this._isRequireUntilSelectDirectAlerted=!1},"change:interval":"_checkUntilSelectDirectAlertRequired","change:freq":"_checkUntilSelectDirectAlertRequired",alert:function(e){this._renderUI(),this._showAlertMessage(e)},change:function(){this._renderUI(),this.trigger("changeRecurrence",this.model.getRecurrenceModel())}},_checkUntilSelectDirectAlertRequired:function(){c.FREQ_SPEC[this.model.get("freq")].isRequireUntilSelectDirect(this.model.get("interval"))&&!this._isRequireUntilSelectDirectAlerted&&(this._isRequireUntilSelectDirectAlerted=!0,this._alertRequireUntilSelectDirect())},events:{"change @ui.recurrenceType":function(){"CUSTOM"!=this.getUI("recurrenceType").val()&&this._scheduleRsvpModel&&this._scheduleRsvpModel.has("endedAt")&&!confirm(IM("schedule.edit.recurrence.confirm.rsvp_ended_at_removal"))?this._renderUI():this.model.changeRecurrenceType(this.getUI("recurrenceType").val())},"change @ui.freq":function(){this._isRequireUntilSelectDirectAlerted=!1,this.model.changeFreq(this.getUI("freq").val())},"change @ui.interval":function(){var e=parseInt(this.getUI("interval").val());this.model.changeInterval(e||null)},"change @ui.infinite":function(){this.model.changeInfinite(this.getUI("infinite").is(":checked"))}},childViewEvents:{changeMonthDay:function(e){this.model.set("monthlyByDaySelection",e)},weekdaySelectionChanged:function(e){var n=this.model.get("weeklyByDaySelection");e.checked?this.model.set("weeklyByDaySelection",t.uniq(n.concat([e.day]))):this.model.set("weeklyByDaySelection",t.uniq(t.without(n,e.day)))}},onDomRefresh:function(){this._renderUI()},_renderUI:function(){this._insertRecurrenceTypeOption(),this.getUI("customRecurrenceWrap").toggleClass("-on",this.model.isCustom()),this.getUI("customRecurrenceWrap").toggleClass("-off",!this.model.isCustom()),this.getUI("freq").val([this.model.get("freq")]),this.model.isCustom()&&"MONTHLY"===this.model.get("freq")?(this.getUI("byDaySelectionRegion").show(),this.getChildView("byDaySelectionRegion")&&this.getChildView("byDaySelectionRegion")instanceof r||this.showChildView("byDaySelectionRegion",new r({startAtMoment:this.model.get("startAtMoment"),monthlyByDaySelection:this.model.get("monthlyByDaySelection")})),this.getChildView("byDaySelectionRegion").updateSelection({startAtMoment:this.model.get("startAtMoment"),monthlyByDaySelection:this.model.get("monthlyByDaySelection")})):this.model.isCustom()&&"WEEKLY"===this.model.get("freq")?(this.getUI("byDaySelectionRegion").show(),this.getChildView("byDaySelectionRegion")&&this.getChildView("byDaySelectionRegion")instanceof u||this.showChildView("byDaySelectionRegion",new u({startAtMoment:this.model.get("startAtMoment"),monthlyByDaySelection:this.model.get("monthlyByDaySelection")||[]})),this.getChildView("byDaySelectionRegion").updateSelection({startAtMoment:this.model.get("startAtMoment"),weeklyByDaySelection:this.model.get("weeklyByDaySelection")||[]})):(this.getUI("byDaySelectionRegion").hide(),this.getRegion("byDaySelectionRegion").empty()),this._insertIntervalOption(),this.getUI("untilWrap").toggleClass("-off","none"===this.model.get("recurrenceType")),this.showChildView("untilRegion",h.buildDDateInputView({date:this.model.get("until"),disable:this.model.get("infinite"),pickerDirection:h.PICKER_DIRECTION.UP,pickerWidth:l.DATE_PICKER_WIDTH})),this.listenTo(this.getChildView("untilRegion"),"dateChanged",(function(e){this.model.changeUntil(e.value)})),this.getUI("infinite").prop("checked",this.model.get("infinite"))},_insertRecurrenceTypeOption:function(){var e;e=this.model.get("isLunar")?p({selectedValue:this.model.get("recurrenceType"),options:[{value:"none",text:IM("schedule.edit.recurrence.none")}].concat(t.map(c.LUNAR_PREDEFINEDS,(function(e){return{value:e.key,text:e.makeName(this.model.get("startAtMoment"))}}),this))}):p({selectedValue:this.model.get("recurrenceType"),options:[{value:"none",text:IM("schedule.edit.recurrence.none")}].concat(t.map(c.PREDEFINEDS,(function(e){return{value:e.key,text:e.makeName(this.model.get("startAtMoment"))}}),this)).concat([{value:"CUSTOM",text:IM("schedule.edit.recurrence.custom")}])}),this.getUI("recurrenceType").html(e)},_insertIntervalOption:function(){var e=this.model.get("interval"),n='<option value="" disabled selected hidden>'+IM("ui.label.selection")+"</option>";this.model.has("freq")&&(n+=p({selectedValue:this.model.get("interval"),options:t.map(t.range(1,c.FREQ_SPEC[this.model.get("freq")].MAX_INTERVAL+1),(function(t){return{value:t,text:t,selected:e===t}}))})),this.getUI("interval").html(n)},updateScheduleInfo:function(e,t,n,i){this.model.updateScheduleInfo(e,t,n,i),this._scheduleRsvpModel=i},_showAlertMessage:function(e){alert(e)},_alertRequireUntilSelectDirect:function(){alert(IM("schedule.edit.recurrence.alert.require_until_select_direct"))}}),_=i.Model.extend({defaults:{startAtMoment:null,recurrenceType:"none",freq:"WEEKLY",interval:1,monthlyByDaySelection:null,weeklyByDaySelection:[],until:null,infinite:!1,isLunar:!1},validate:function(e){if(!e.recurrenceType||"CUSTOM"==e.recurrenceType)return e.interval&&("MONTHLY"!==e.freq||e.monthlyByDaySelection)?void 0:"intervalRequired"},isCustom:function(){return"CUSTOM"===this.get("recurrenceType")},changeRecurrenceType:function(e){var n={recurrenceType:e,startAtMoment:this.get("startAtMoment"),isLunar:this.get("isLunar"),freq:this.get("freq")};n=t.extend(n,this._makeTobeUntilChanges(n)),this.set(n)},changeFreq:function(e){var n={recurrenceType:this.get("recurrenceType"),startAtMoment:this.get("startAtMoment"),isLunar:this.get("isLunar"),freq:e};this.get("interval")>c.FREQ_SPEC[e].MAX_INTERVAL&&(n.interval=1),n=t.extend(n,this._makeTobeUntilChanges(n)),this.set(n)},_makeTobeUntilChanges:function(e){return"none"===e.recurrenceType?{until:null,infinite:!1}:(t="CUSTOM"!==e.recurrenceType?c.FREQ_SPEC[c.PREDEFINED_CONTAINER.findByKey(e.recurrenceType,e.isLunar).MATCH_FREQ]:c.FREQ_SPEC[e.freq],n="none"===this.get("recurrenceType")?{}:"CUSTOM"!==this.get("recurrenceType")?c.FREQ_SPEC[c.PREDEFINED_CONTAINER.findByKey(this.get("recurrenceType"),this.get("isLunar")).MATCH_FREQ]:c.FREQ_SPEC[this.get("freq")],t.defaultUntilDuration===n.defaultUntilDuration?{}:{until:d.toISO(a(e.startAtMoment).add(a.duration(t.defaultUntilDuration))),infinite:e.isLunar});var t,n},changeInterval:function(e){this.set("interval",e)},changeUntil:function(e){e=a(e);var t=this._getCurrentMaxUntilDuration();if(t){var n=a(this.get("startAtMoment")).add(t);if(n.isBefore(e))return this.set({until:d.toISO(n),infinite:!1}),void this.trigger("alert",IM("schedule.edit.msg.repeat_end_at_limit"))}this.set({until:d.toISO(e),infinite:!1})},changeInfinite:function(e){e=!!e;var t=this._getCurrentMaxUntilDuration();if(e&&t){var n=a(this.get("startAtMoment")).add(t);return this.set({infinite:!1,until:d.toISO(n)}),void this.trigger("alert",IM("schedule.edit.msg.repeat_end_at_limit"))}this.set({infinite:e})},_getCurrentMaxUntilDuration:function(){var e,t=this.get("recurrenceType");return t&&"none"!==t?(e="CUSTOM"!==t?c.PREDEFINED_CONTAINER.findByKey(t,this.get("isLunar")).MATCH_FREQ:this.get("freq"),c.FREQ_SPEC[e].maxUntilDuration):null},getRecurrenceModel:function(){return"none"!==this.get("recurrenceType")&&this.isValid()?this.isCustom()?this._createCustomScheduleRecurrenceModel():c.PREDEFINED_CONTAINER.createPredefined(this.get("recurrenceType"),this.get("startAtMoment"),this.get("infinite")?null:this.get("until")):null},_createCustomScheduleRecurrenceModel:function(){var e={freq:this.get("freq")};return this.has("interval")&&this.get("interval")>=1&&(e.interval=this.get("interval")),"WEEKLY"===e.freq?e.byDay=t.chain(this.get("weeklyByDaySelection")).union([this.get("startAtMoment").day()]).sortBy().uniq().map((function(e){return c.makeWeekByDay(e)})).value():"MONTHLY"===e.freq&&(e=t.extend(e,c.makeMonthlyByDay(this.get("startAtMoment"),this.get("monthlyByDaySelection")))),this.get("infinite")||(e.until=this.get("until")),new c(e)},updateScheduleInfo:function(e,n,i){i===this.get("isLunar")&&c.isSameRecurrence(this.getRecurrenceModel(),n)&&e.isSame(this.get("startAtMoment"),"day")||n||this.set(t.extend({},t.result(this,"defaults"),{startAtMoment:a(e),isLunar:i}))}});return _.fromRecurrenceModel=function(e,n,i){var o={startAtMoment:a(e),isLunar:i};if(n){var s=c.PREDEFINED_CONTAINER.findByScheduleRecurrenceModel(n,e,i);o.recurrenceType=s?s.key:"CUSTOM","CUSTOM"===o.recurrenceType&&(o.freq=n.get("freq"),o.interval=n.get("interval"),"MONTHLY"===o.freq?o.monthlyByDaySelection=c.matchedMonthlyDayType(n):"WEEKLY"===o.freq&&(o.weeklyByDaySelection=t.map(n.get("byDay"),(function(e){return c.WeekDayKey.indexOf(e.day)})))),n.has("until")?(o.until=n.get("until"),o.infinite=!1):o.infinite=!0}return new _(o)},m.buildDScheduleEditRecurrenceView=function(e,t,n){if(null==e)throw new Error("startAt required");return new m({model:_.fromRecurrenceModel(e,t,n)})},m}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="flexList -tbSpaceNone gMat5">\n    <div class="dateTitle gMat2"><%-IM("schedule.edit.recurrence.label") %></div>\n\n    <div class="flexItem gMat-2">\n        <span class="uSelect -h32 -bg -block gColorBk2" style="width:173px;">\n            <select class="_recurrenceType"></select>\n        </span>\n    </div>\n</div>\n\x3c!-- [D] 비활성시 class="-off" --\x3e\n<div class="option flexList -off -tbSpaceNone gMat5 _customRecurrenceWrap">\n    <div class="uSelect -h32 -bg -block gColorBk2" style="width:82px;">\n        <label for="<%-vid%>interval" class="gSrOnly"><%-IM("schedule.edit.recurrence.interval.label")%></label>\n        <select id="<%-vid%>interval" class="_interval">\n            <option value="" disabled selected hidden><%-IM("schedule.edit.recurrence.interval.label")%></option>\n        </select>\n    </div>\n\n    <div class="uSelect -h32 -bg -block gColorBk2 gMal5" style="width:137px;">\n        <label for="<%-vid%>freq" class="gSrOnly"><%-IM("schedule.edit.recurrence.freq.label")%></label>\n        <select id="<%-vid%>freq" class="_freq">\n            <option value="DAILY"><%-IM("schedule.edit.recurrence.freq.label.daily") %></option>\n            <option value="WEEKLY"><%-IM("schedule.edit.recurrence.freq.label.weekly") %></option>\n            <option value="MONTHLY"><%-IM("schedule.edit.recurrence.freq.label.monthly") %></option>\n        </select>\n    </div>\n</div>\n\n<div class="option -on gMat16 gMab16 _byDaySelectionRegion"></div>\n<div class="flexList -tbSpaceNone gMat5 _untilWrap">\n    <div class="dateTitle"><%-IM("schedule.edit.recurrence.until.label")%></div>\n    <div class="etc _untilRegion"></div>\n    <div class="etc gPal10">\n        <label class="uCheck -checkbox ">\n            <input type="checkbox" class="checkInput _infinite">\n                <span class="checkLabel">\n                    <span class="shape"></span>\n                    <span class="text"><%-IM("schedule.edit.recurrence.until.infinite.label") %></span>\n                </span>\n        </label>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2215),s=n(523),a=n(651);return i.View.extend({attributes:{"data-viewname":"DRecurrenceMonthlyDaySelectionView"},className:"customDate",template:t.template(o),templateContext:function(){var e=this.getOption("startAtMoment");return{vid:this.cid,byMonthDayText:a.MonthDayName.byMonthDay(e),byMonthWeekDayText:a.MonthDayName.byMonthWeekDay(e),showLastWeekDay:s.isLastWeekOfMonth(e),showLastDay:s.isLastDayOfMonth(e),byLastMonthWeekDayText:a.MonthDayName.byLastMonthWeekDay(e),byLastMonthDayText:a.MonthDayName.byLastMonthDay(e),currentSelection:this.getOption("monthlyByDaySelection")}},ui:{radio:"._radio"},events:{"change @ui.radio":function(){this.trigger("changeMonthDay",this.getUI("radio").filter(":checked").val())}},updateSelection:function(e){var t=!e.startAtMoment.isSame(this.getOption("startAtMoment"),"day");this.options.startAtMoment=e.startAtMoment,this.options.monthlyByDaySelection=e.monthlyByDaySelection,t?this.render():this.getUI("radio").filter("[value="+this.getOption("monthlyByDaySelection")+"]").prop("checked",!0)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="row">\n    <span class="cell">\n        <label class="uCheck -radio ">\n            <input type="radio" id="<%-vid%>byMonthDay" name="customMonth" class="checkInput _radio" value="byMonthDay" <% if(currentSelection === \'byMonthDay\'){%>checked<% } %>>\n            <span class="checkLabel">\n                <span class="shape "></span>\n                <span class="text"><%-byMonthDayText%></span>\n            </span>\n        </label>\n    </span>\n    <span class="cell">\n        <label class="uCheck -radio ">\n            <input type="radio" id="<%-vid%>byMonthWeekDay" name="customMonth" class="checkInput _radio" value="byMonthWeekDay" <% if(currentSelection === \'byMonthWeekDay\'){%>checked<% } %>>\n            <span class="checkLabel">\n                <span class="shape "></span>\n                <span class="text"><%-byMonthWeekDayText%></span>\n            </span>\n        </label>\n    </span>\n</span>\n<% if (showLastWeekDay) { %>\n<span class="row">\n    <span class="cell">\n        <label class="uCheck -radio ">\n            <input type="radio" id="<%-vid%>byLastMonthWeekDay" name="customMonth" class="checkInput _radio" value="byLastMonthWeekDay" <% if(currentSelection === \'byLastMonthWeekDay\'){%>checked<% } %>>\n            <span class="checkLabel">\n                <span class="shape "></span>\n                <span class="text"><%-byLastMonthWeekDayText%></span>\n            </span>\n        </label>\n    </span>\n    <% if (showLastDay) { %>\n    <span class="cell">\n        <label class="uCheck -radio ">\n            <input type="radio" id="<%-vid%>byLastMonthDay" name="customMonth" class="checkInput _radio" value="byLastMonthDay" <% if(currentSelection === \'byLastMonthDay\'){%>checked<% } %>>\n            <span class="checkLabel">\n                <span class="shape "></span>\n                <span class="text"><%-byLastMonthDayText%></span>\n            </span>\n        </label>\n    </span>\n    <% } %>\n</span>\n<% } %>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2217),s=n(498),a=n(499),r=n(154),l=n(488),c=n(1003),d=n(567),u=n(16);return i.View.extend({attributes:{"data-viewname":"DRecurrenceWeeklyDaySelectionView"},className:"customDate",getTemplate:function(){return this._dataFetched?t.template(o):t.template(s)},templateContext:function(){if(!this._dataFetched)return{_loading_size:a.Size.MEDIUM,middleClass:l.ELEMENT.AREA_VERTICAL_MIDDLE};var e=t.map(d.makeDayOfWeekListOrderBy(this._startDayNum),(function(e){var t=e.getDayNumber();return{name:u().day(t).format("dd"),dayNumber:t}}));return{vid:this.cid,firstLineWeekDays:e.slice(0,4),secondLineWeekDays:e.slice(4)}},ui:{checkbox:"._checkbox"},events:{"click @ui.checkbox":function(e){e.currentTarget.hasAttribute("readonly")&&e.preventDefault()},"change @ui.checkbox":function(e){this.trigger("weekdaySelectionChanged",{day:parseInt(e.currentTarget.value),checked:e.currentTarget.checked})}},onDomRefresh:function(){this._dataFetched&&this._renderSelection()},onAttach:function(){r.wrapActivePromise(c.getCachedStartDayNum(),this).then(t.bind((function(e){this._startDayNum=e,this._dataFetched=!0,this.render()}),this))},_renderSelection:function(){var e=this.getOption("startAtMoment").day(),n=t.chain([e].concat(this.getOption("weeklyByDaySelection"))).filter((function(e){return t.isNumber(e)})).uniq().value();this.getUI("checkbox").each((function(){this.checked=t.contains(n,parseInt(this.value)),this.readOnly=parseInt(this.value)===e}))},updateSelection:function(e){this.options.startAtMoment=e.startAtMoment,this.options.weeklyByDaySelection=e.weeklyByDaySelection,this._renderSelection()}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="row">\n    <% _.each(firstLineWeekDays, function(dayInfo) { %>\n    <span class="cell">\n        <label class="uCheck -checkbox ">\n            <input type="checkbox" class="checkInput _checkbox" value="<%-dayInfo.dayNumber%>">\n            <span class="checkLabel">\n                <span class="shape"></span>\n                <span class="text"><%-dayInfo.name%></span>\n            </span>\n        </label>\n    </span>\n    <% }); %>\n</span>\n<span class="row">\n    <% _.each(secondLineWeekDays, function(dayInfo) { %>\n    <span class="cell">\n        <label class="uCheck -checkbox ">\n            <input type="checkbox" class="checkInput _checkbox" value="<%-dayInfo.dayNumber%>">\n            <span class="checkLabel">\n                <span class="shape"></span>\n                <span class="text"><%-dayInfo.name%></span>\n            </span>\n        </label>\n    </span>\n    <% }); %>\n</span>\n'},function(e,t){e.exports='<% _.each(options, function(option) { %>\n<option value="<%-option.value%>" <% if(option.value === selectedValue) { %>selected<% } %>><%-option.text%></option>\n<% });%>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(4),o=n(0),s=n(26),a=n(488),r=n(159),l=n(545),c=n(1622),d=n(2221),u=i.View.extend({className:"flexList -tbSpaceNone gMat5",attributes:{"data-viewname":"DBandCalendarCategoryView"},template:o.template(d),behaviors:[r],ui:{calendarWrapper:"._calendarWrapper",calendarColor:"._calendarColor",calendarName:"._calendarName",selectedCalendar:"._selectedCalendar",addCalendar:"._addCalendar",dropDownList:"._dropDownList"},events:{"click @ui.calendarWrapper":function(e){this.isDestroyed()||(this.spawn(r.MSG.SCHEDULE_EDIT_CALENDAR_CATEGORY_TOGGLE,this.ui.dropDownList.height()),e.stopPropagation())},"click @ui.selectedCalendar":function(e){var n=t(e.currentTarget).data("calendarIndex");this._selectCalendar(this._calendarCollection.at(n))},"click @ui.addCalendar":"_addCalendar"},initialize:function(e){this._bandNo=e.bandNo,this._calendarInfo=e.calendarInfo,this._canAddCalendar=e.canAddCalendar,this._calendarCollection=e.calendarCollection},templateContext:function(){var e=null,t=null;return this._calendarInfo&&(e=this._calendarInfo.get("color"),t=this._calendarInfo.get("name")),{canAddCalendar:this._canAddCalendar,calendars:this._calendarCollection.toJSON(),calendarColor:e,calendarName:t}},onAttach:function(){this.listenTo(s.getDGlobalChannel(),s.EVENT.HTML_CLICK,(function(){this.ui.calendarWrapper.removeClass("-dropDownOn")}))},_selectCalendar:function(e){this._calendarInfo=e,this.trigger(u.EVENT.CALENDAR_SELECTED,e)},toggleCalendarList:function(e){this.isDestroyed()||(this.ui.dropDownList.toggleClass(a.ELEMENT.UP,e),this.ui.calendarWrapper.toggleClass("-dropDownOn"))},_addCalendar:function(){if(this._calendarCollection.length>=l.MAX_CALENDAR_COUNT)alert(IM("bandsetting.calendar.notice.exceed_maximum_calendar_count",{maxCount:l.MAX_CALENDAR_COUNT}));else{var e=c.openAsLayer(this._bandNo,{isCreateCalendar:!0,type:this.calendarType});this.listenTo(e,"bandCalendar:createCalendar",o.bind((function(e){this._calendarCollection.add(e),this._selectCalendar(e)}),this))}}});return u.EVENT={CALENDAR_SELECTED:"CALENDAR_SELECTED"},u.buildDCalendarCategoryView=function(e,t,n,i){return new u({bandNo:e,calendarCollection:t,calendarInfo:n,canAddCalendar:i})},u}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="header">\n        <h1 class="title"><%= IM("bandsetting.calendar.band_calendar.txt.manage_calendar") %></h1>\n    </header>\n    <div class="main">\n        <label for="calendarName" class="title -fwN gMab6"><%= IM("calendar.band_calendar.txt.calendar_name") %></label>\n        <div class="uInput">\n            <input type="text" id="calendarName" class="_calendarName" value="<%- calendarName %>" maxlength="<%- MAX_LENGTH_OF_CALENDAR_NAME %>" placeholder="<%= IM(\'calendar.band_calendar.txt.calendar_name\') %>">\n            <span class="border"></span>\n        </div>\n        <p class="scheduleUrl gMat10">\n            <span class="gSrOnly"><%= IM("calendar.band_calendar.txt.calendar_url") %></span>\n            <%- calendarUrl %>\n        </p>\n        <% if (calendarUrl) { %>\n        <div class="refreshCalendar">\n            <h1 class="title -fwN gMat22 gMab6"><%- IM("label.calendar.refresh_external") %></h1>\n            <div class="refreshInfo">\n                <time class="_refreshedAt" datetime="<%- refreshedAt %>"><%- refreshedAt %></time>\n                <button type="button" class="btnRefreshCal _refreshCalendar"><span class="gSrOnly"><%- IM("label.synchronization") %></span></button>\n            </div>\n\n            <p class="desc"><%= IM("calendar.external.refresh.desc") %></p>\n        </div>\n        <% } %>\n        <p id="selectScheduleColorLabel" class="title -fwN gMat22 gMab6"><%= IM("calendar.band_calendar.txt.calendar_color") %></p>\n        <ul class="selectScheduleColorList gMal10 gMab6">\n        <%\n            var _color = \'\';\n\n            if (isCreateCalendar) { // 캘린더 생성인 경우\n                var randomColorIndex = _.random(0, supportColorList.length - 1); // 캘린더 생성 시에는 random 색상으로 지정\n                _color = supportColorList[randomColorIndex];\n\n            } else { // 캘린더 수정인 경우\n                _color = calendarColor;\n            }\n\n            _.each(supportColorList, function(color, index) {\n        %>\n            <li>\n                <input type="radio" name="selectScheduleColor" id="calendarColor_<%- index %>" class="_calendarColor" aria-label="selectScheduleColorLabel" value="<%- color %>" <% if (_color == color) { %> checked<% } %>>\n                <span class="circle" style="background:#<%- color %>;border-color:#<%- color %>"></span> <span class="gSrOnly"><%= IM("calendar.band_calendar.txt.calendar_color") %> : #<%- color %></span>\n            </li>\n        <%\n            });\n        %>\n        </ul>\n    </div>\n    <footer class="footer -tLine -lrSpaceNone">\n        <button type="button" class="uButton -cancel _btnCancel"><%= IM("ui.label.cancel") %></button>\n        <button type="button" class="uButton -confirm _btnConfirm" disabled><%= IM("ui.label.complete") %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="dateTitle"><%= IM("calendar.band_calendar.title.calendar") %></div>\n<div class="text gPal0">\n    <div class="flexList -tbSpaceNone">\n        <div class="flexItem" style="max-width:100%;min-width:173px;">\n            \x3c!-- [D] 드랍다운박스 토글 : -dropDownOn 클래스 사용 --\x3e\n            <div class="uInput -dropDown -bg -block -h32 gPal0 gPar0 _calendarWrapper">\n                <button type="button" class="btnCalendarName gPr">\n                <% if (calendarColor) { %>\n                    <span class="calendarColor _calendarColor" style="background:#<%- calendarColor %>">#<%- calendarColor %></span>\n                <% } else if (calendars[0].color) { %>\n                    <span class="calendarColor _calendarColor" style="background:#<%- calendars[0].color %>">#<%- calendars[0].color %></span>\n                <% } else { %>\n                    <span class="calendarColor sf_bg _calendarColor"></span>\n                <% } %>\n\n                <% if (calendarName) { %>\n                    <span class="_calendarName"><%- calendarName %></span>\n                <% } else { %>\n                    <span class="_calendarName"><%- calendars[0].name %></span>\n                <% } %>\n                </button>\n\n                \x3c!-- [D] 인풋 위쪽으로 출력 : -up 클래스 사용 --\x3e\n                <ul class="dropDown _dropDownList" style="max-width:351px">\n                <% _.each(calendars, function(calendar, index) { %>\n                    <li class="_selectedCalendar" data-calendar-index="<%- index %>">\n                    <% if (calendar.color) { %>\n                        <button type="button" class="btnSelectCalendar">\n                            <span class="calendarColor" style="background:#<%- calendar.color %>"><%= IM("calendar.band_calendar.txt.calendar_color") %> : #<%- calendar.color %></span>\n                            <span class="calendarName"><%- calendar.name %></span>\n                        </button>\n                    <% } else { %>\n                        <button type="button" class="btnSelectCalendar">\n                            <span class="calendarColor sf_bg"></span>\n                            <span class="calendarName"><%- calendar.name %></span>\n                        </button>\n                    <% } %>\n                    </li>\n                <% }); %>\n                <% if (canAddCalendar) { %>\n                    <li class="_addCalendar">\n                        <button type="button" class="btnSelectCalendar">\n                            <span class="iconPlus">\n                                <svg class="svgIcon" aria-hidden="true">\n                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#inviteAdd"></use>\n                                </svg>\n                            </span>\n                            <span class="calendarName"><%= IM("bandsetting.calendar.band_calendar.txt.add_calendar") %></span>\n                        </button>\n                    </li>\n                <% } %>\n                </ul>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="lyContent -w480 ">\n    <header class="header">\n        <h1 class="title">\n            <%-IM("geolocation.select_location.title") %>\n        </h1>\n    </header>\n\n    <div class="main -spaceNone _content"></div>\n\n    <footer class="footer -spaceNone">\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM("ui.label.close") %></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(486),s=n(2224),a={CANCEL:"modal:cancel",CONFIRM:"modal:confirm"},r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DLocationAgreementLayerView"},template:t.template(s),ui:{btnCancel:"._btnCancel",btnConfirm:"._btnConfirm"},events:{"click @ui.btnCancel":function(e){this.trigger(a.CANCEL),this.destroy()},"click @ui.btnConfirm":function(e){this.trigger(a.CONFIRM),this.destroy()}},onAttach:function(){this.getUI("btnConfirm").focus()}});return r.EVENTS=a,r.openLayer=function(){var e=new r;return o.open(e),e},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent">\n    <div class="modalHeader">\n        <h5 class="title"><%= IM(\'geolocation.confirm.location_policy_agreement.title\') %></h5>\n    </div>\n\n    <div class="modalBody">\n        <div class="msgWrap">\n            <p class="pText">\n                <%= IM(\'geolocation.confirm.location_policy_agreement.desc\') %>\n            </p>\n            <p class="pText -smallFont gMat8">\n                <a href="https://band.us/policy/terms#agreement_location" class="-pointColor -noUnderline" target="_blank">&gt; <%= IM(\'geolocation.confirm.location_policy_agreement.btn.agreement\') %></a>\n            </p>\n        </div>\n    </div>\n\n    <div class="modalFooter">\n        <button type="button" class="uButton -cancel _btnCancel"><%= IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM(\'ui.label.agree\') %></button>\n    </div>\n</div>'},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent -noTitle" style="width:360px">\n        <div class="main">\n            <h1 class="bTit gTaC"><strong><%= noticeMessage %></strong></h1>\n        </div>\n        <footer class="footer">\n            <button type="button" class="uButton -cancel -wSmall -hLarge _btnCancel"><%= IM("ui.label.cancel") %></button>\n            <button type="button" class="uButton -point -wSmall -hLarge _btnConfirm"><%= IM("ui.label.confirm") %></button>\n        </footer>\n    </div>\n</section>'},function(e,t,n){var i=n(2),o=n(0),s=n(637),a="weekly";window.envReal&&(a="quarterly");var r,l="https://maps.googleapis.com/maps/api/js?v="+a;t.load=function(){var e;return e||(e=function(){if(!r){var e=i.Deferred(),t=o.uniqueId("googleMapInit");window[t]=function(){e.resolve(window.google.maps)};var n=l+"&callback="+t+"&key="+s.GOOGLE_MAP_API_KEY;i("<SCRIPT>").attr("src",n).appendTo(document.head),r=e.promise()}return r}()),e}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(2228),a=(n(486),n(2229)),r=n(2235),l=n(2237),c=n(1147),d=n(1556),u=o.View.extend({options:{currentPosition:null,googleMaps:null},className:"postWrite",attributes:{"data-viewname":"DSelectLocationContentView"},template:t.template(s),ui:{btnSearch:"._btnSearch",map:"._map",locationName:"#locationName",searchResult:"._searchResult"},events:{"input @ui.locationName":function(){this.getUI("locationName").val()||this.model.resetSearch(),this._renderSearchButton()},"click @ui.btnSearch":function(){var e=i.trim(this.getUI("locationName").val());return e&&this._search(e),!1}},regions:{map:{el:"@ui.map",replaceElement:!0},searchResult:"@ui.searchResult"},childViewEvents:{"googlemap:selectPoint":function(e){this.model.has("keyword")&&this.model.spotCollection.isEmpty()&&(this.model.resetSearch(),this.getUI("locationName").val(""),this._renderSearchButton()),this.model.selectPosition(e)},"googlemap:selectLocation":function(){this.model.requestSelectedLocation().then(t.bind((function(e){this.trigger("locationSelected",e)}),this))},"childview:selectSpot":function(e){this.model.selectSpot(e.model)}},modelEvents:{"change:selectedPosition":function(){var e=this.model.getSelectedGeoCoordinates();e?this.getChildView("map").setMarkerPosition(e.latLng()):this.getChildView("map").setMarkerPosition(null)},"change:selectedSpotName":"_renderMarkerBalloon","change:keyword":"_renderSearchUI"},onAttach:function(){this.showChildView("map",a.buildDGoogleMapView({googleMaps:this.options.googleMaps,center:this.options.currentPosition.latLng(),selectedPosition:this.model.getSelectedGeoCoordinates().latLng()})),this._renderSearchUI(),this._renderMarkerBalloon()},_renderSearchButton:function(){this.getUI("locationName").val()?this.getUI("btnSearch").removeAttr("disabled"):this.getUI("btnSearch").attr("disabled","disabled")},_renderMarkerBalloon:function(){this.getChildView("map").setMarkerDescription(this.model.get("selectedSpotName"))},_renderSearchUI:function(){this.model.get("keyword")?(this.getChildView("map").fold(),this.getUI("searchResult").show(),this.model.spotCollection.isEmpty()?this.showChildView("searchResult",c.html(IM("geolocation.select_location.search_spot.no_result",{query:'<span class="keyword">'+t.escape(this.model.get("keyword"))+"</span>"}))):this.showChildView("searchResult",l.buildDSpotListView(this.model))):(this.getChildView("map").unfold(),this.getRegion("searchResult").empty(),this.getUI("searchResult").hide())},_search:function(e){var n=this.model.getSelectedGeoCoordinates();return n||(n=this.options.currentPosition),this.model.searchSpots(e,n).then(t.bind((function(){this.model.spotCollection.isEmpty()?this.model.unselect():this.model.selectSpot(this.model.spotCollection.at(0))}),this)),!1}});return u.buildDSelectLocationContentView=function(e){var t=null,n=null,i=null;return e.locationObject?(t=d.fromCoordinates(e.locationObject).toUrlValue(),n=e.locationObject.name,i=e.locationObject.address):t=e.currentPosition.toUrlValue(),new u({model:new r({selectedPosition:t,selectedSpotName:n,selectedSpotAddress:i}),currentPosition:e.currentPosition,googleMaps:e.googleMaps})},u}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<form class="searchWrap" role="search">\n    <label for="locationName" class="searchIcon"><span class="gSrOnly"><%-IM("geolocation.select_location.search_spot.title") %></span></label>\n    <span class="inputWrap">\n        <input type="text" id="locationName" class="inputSearch" placeholder="<%-IM(\'geolocation.select_location.search_spot.keyword.placeholder\') %>">\n    </span>\n\n    <button type="submit" class="btnSearch uButton -sizeS -default -active _btnSearch" disabled><%-IM("ui.label.search") %></button>\n</form>\n\n\x3c!-- [D] 첨부 리스트 노출시 지도이미지 높이값 변경 -h260 클래스 추가 --\x3e\n<div class="mapArea _map"></div>\n\n<div class="mapListArea _searchResult" style="display: none;"></div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2230),s=n(2232),a=i.View.extend({attributes:{"data-viewname":"DGoogleMapView"},options:{googleMaps:null,center:null,selectedPosition:null},className:"mapArea",template:t.noop,initialize:function(){this._map=null,this._balloonMarker=null},onAttach:function(){var e=this._map=o.createMap(this.options.googleMaps,this.el,this.options.selectedPosition,this.options.center);this._map.addListener("click",t.bind((function(e){this.trigger("googlemap:selectPoint",e.latLng.toUrlValue())}),this)),this._balloonMarker=s.createBalloonMarker(this.options.googleMaps,this._map,this.options.selectedPosition),this._balloonMarker.addListener("band:positionMoved",(function(){e.panTo(this.getPosition())})),this._balloonMarker.addListener("dragend",t.bind((function(e){this.trigger("googlemap:selectPoint",e.latLng.toUrlValue())}),this)),this._balloonMarker.addListener("band:balloonClicked",t.bind((function(){this.trigger("googlemap:selectLocation")}),this))},fold:function(){this.$el.addClass("-h260"),this.options.googleMaps.event.trigger(this._map,"resize")},unfold:function(){this.$el.removeClass("-h260"),this.options.googleMaps.event.trigger(this._map,"resize")},setMarkerPosition:function(e){e?(this._balloonMarker.show(!0),this._balloonMarker.setPosition(e)):this._balloonMarker.hide(!1)},setMarkerDescription:function(e){this._balloonMarker.setDescription(e)}});return a.buildDGoogleMapView=function(e){return new a({selectedPosition:e.selectedPosition,center:e.center,googleMaps:e.googleMaps})},a}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(2231);return{createMap:function(e,n,s,a){var r=new e.Map(n,{zoom:15,center:s,disableDefaultUI:!0,draggableCursor:"pointer",draggingCursor:"all-scroll"}),l=i(t.template(o)());return l.on("click","._centerButton",(function(){r.panTo(a)})),l.on("click","._zoomInButton",(function(){r.setZoom(r.getZoom()+1)})),l.on("click","._zoomOutButton",(function(){r.setZoom(r.getZoom()-1)})),r.controls[e.ControlPosition.RIGHT_BOTTOM].push(l[0]),r}}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="locationAdjust" style="bottom:14px;right:0">\n    <button type="button" class="buttonLocation _centerButton">\n        <span class="gSrOnly"><%-IM("geolocation.select_location.map.btn.center_button") %></span>\n        <span class="icon">\n\t\t\t\x3c!-- [D] 선택시 sf_color 클래스 추가 --\x3e\n\t\t\t<svg class="svgIcon" aria-hidden="true">\n\t\t\t\t<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-map-location"></use>\n\t\t\t</svg>\n\t\t</span>\n    </button>\n    <button type="button" class="buttonZoomin _zoomInButton">\n        <span class="gSrOnly"><%- IM("geolocation.select_location.map.btn.zoomin_button") %></span>\n    </button>\n    <button type="button" class="buttonZoomout _zoomOutButton">\n        <span class="gSrOnly"><%-IM("geolocation.select_location.map.btn.zoomout_button") %></span>\n    </button>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2233);return{createBalloonMarker:function(e,n,o){var s=function(e,t,n){var i=new e.Marker({map:t,position:n,draggable:!0,icon:{url:window.resBaseUrl+"/images/pin-img.svg",scaledSize:new e.Size(40,40)},title:IM("geolocation.select_location.map.label.attach_location")}),o=!1;return i.addListener("position_changed",(function(){o||e.event.trigger(i,"band:positionMoved")})),i.addListener("dragstart",(function(){o=!0})),i.addListener("dragend",(function(){o=!1})),i}(e,n,o),a=function(e,n,o){return i.assignGoogleMap(e),new i({onMouseClick:t.bind((function(){return e.event.trigger(o,"band:balloonClicked"),!1}),this),map:n,marker:o})}(e,n,s);return{addListener:function(e,t){s.addListener(e,t)},setDescription:function(e){a.setDescription(e)},show:function(){s.setVisible(!0)},hide:function(){s.setVisible(!1)},setPosition:function(e){s.setPosition(e)}}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(2),s=t.template(n(2234)),a=function(e){if(!this.setMap)throw new Error("assignGoogleMap() required");e&&e.onMouseClick&&(this.onMouseClick=e.onMouseClick),this._locationLabel="",this.setMap(e.map),this._map=e.map,this._mapsEventListeners=[],this._marker=e.marker};return a.prototype.onAdd=function(){this._$el=o(s()),this._$el.on("click",this.onMouseClick),this.getPanes().floatPane.appendChild(this._$el[0])},a.prototype.onRemove=function(){t.invoke(this._mapsEventListeners,"remove"),this._$el.remove(),this._$el=null},a.prototype.draw=function(){this._marker&&this._marker.get("anchorPoint")&&this._marker.getVisible()?this._$el.show():this._$el.hide(),this._$el.find("._locationName").text(this._locationLabel),this._changePositionToFollowee()},a.prototype._changePositionToFollowee=function(){if(this._marker){var e=this._marker.get("anchorPoint");if(e){var t=this.getProjection().fromLatLngToDivPixel(this._marker.getPosition());this._$el[0].style.left=t.x-this._$el.outerWidth()/2+e.x+"px",this._$el[0].style.top=t.y-(this._$el.outerHeight()+6)+e.y+"px"}else this._map.panBy(0,0)}},a.prototype.onMouseDown=function(){},a.prototype.setDescription=function(e){this._locationLabel=i.trim(e)},a.assignGoogleMap=function(e){a.googleMaps||(a.googleMaps=e,a.prototype=t.extend({},new a.googleMaps.OverlayView,a.prototype))},a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="markerInfo" style="position:absolute;display:none;">\n    <button type="button" class="button _btnMarkerBalloon">\n        <strong class="text"><%-IM("geolocation.select_location.map.label.attach_location") %></strong>\n        <span class="name _locationName"></span>\n\t\t\t<span class="icon">\n\t\t\t\t<svg class="svgIcon sf_color" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-map-arrow"></use>\n                </svg>\n\t\t\t</span>\n    </button>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(6),s=n(2236),a=n(1556),r=n(2003),l=o.Model.extend({defaults:function(){return{selectedSpotCid:null,selectedSpotName:null,selectedSpotAddress:null,keyword:"",selectedPosition:null}},initialize:function(){this.spotCollection=new o.Collection(void 0,{model:s})},searchSpots:function(e,n){return r.searchSpots({keyword:e,latitude:n.lat(),longitude:n.lng()}).then(t.bind((function(t){this.spotCollection.reset(t),this.set("keyword",e)}),this))},resetSearch:function(){this.set({keyword:""})},unselect:function(){this.set({selectedSpotCid:null,selectedPosition:null,selectedSpotName:null,selectedSpotAddress:null})},selectSpot:function(e){this.set({selectedSpotCid:e.cid,selectedPosition:e.getGeoCoordinates().toUrlValue(),selectedSpotName:e.get("name"),selectedSpotAddress:e.get("address")})},selectPosition:function(e){this.set({selectedPosition:e,selectedSpotCid:null,selectedSpotName:null,selectedSpotAddress:null})},select:function(e){var t,n;e instanceof a?(t=null,n=e):a.isValidGeoUrlValue(e)&&(t=null,n=a.fromGeoUrlValue(e)),this.set({selectedSpotCid:t,selectedPosition:n.toUrlValue(),selectedSpotName:null,selectedSpotAddress:null})},getSelectedGeoCoordinates:function(){return this.has("selectedPosition")?a.fromGeoUrlValue(this.get("selectedPosition")):null},requestSelectedLocation:function(){return i.Deferred(t.bind((function(e){var n=this.getSelectedGeoCoordinates().coordinates();this.has("selectedSpotAddress")?e.resolve(t.extend({name:this.get("selectedSpotName"),address:this.get("selectedSpotAddress")},n)):r.getLocation(n).then((function(i){e.resolve(t.extend({address:i},n))}))}),this)).promise()}});return l.buildSelectLocationModel=function(e){return new l({selectedPosition:e.toUrlValue()})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(1556);return t.Model.extend({defaults:function(){return{address:null,latitude:null,longitude:null,name:null}},getGeoCoordinates:function(){return i.fromCoordinates({latitude:this.get("latitude"),longitude:this.get("longitude")})}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(2238),o=t.CollectionView.extend({tagName:"ul",className:"mapList",attributes:{"data-viewname":"DSpotListView"},childView:i,childViewOptions:function(){return{searchLocationModel:this.options.searchLocationModel}}});return o.buildDSpotListView=function(e){return new o({collection:e.spotCollection,searchLocationModel:e})},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2239);return i.View.extend({options:{searchLocationModel:null},tagName:"li",className:"mapItem",attributes:{"data-viewname":"DSpotListItemView"},template:t.template(o),triggers:{click:"selectSpot"},initialize:function(){this.listenTo(this.options.searchLocationModel,"change:selectedSpotCid",this._renderActive)},onRender:function(){this._renderActive()},_renderActive:function(){this.$el.toggleClass("-active",this.options.searchLocationModel.get("selectedSpotCid")===this.model.cid)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="icon">\n    <svg class="svgIcon sf_color" aria-hidden="true">\n        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-map-15"></use>\n    </svg>\n</span>\n<div class="mapInfo">\n    <strong class="title"><%-name %></strong>\n    <span href="#" class="text"><%-address %></span>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(4),s=n(486),a=n(503),r=n(2241),l=n(2243),c=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DScheduleEditorImportView"},template:t.template(l),ui:{btnBack:"._btnBack"},events:{"click @ui.btnBack":"destroy"},regions:{pastItemListRegion:{el:"._pastItems"}},childViewTriggers:{"childview:select:item":"select:item-import"},onAttach:function(){this._fetchMySchedules()},initialize:function(e){this._bandNo=e.bandNo,this._isLocalMeetup=1==e.isLocalMeetup},_fetchMySchedules:function(){a.getImportMySchedules(this._bandNo).then(t.bind((function(e){var t=new i.Collection;t.reset(e);var n=t.filter((function(e){return(e.get("is_local_meetup")||!1)==this._isLocalMeetup}),this);t.reset(n),0!=t.length?this.showChildView("pastItemListRegion",new d({collection:t})):this.showChildView("pastItemListRegion","<p class='uEmpty -h480'><span>"+IM("ui.message.empty_conents")+"</span></p>")}),this))}}),d=o.CollectionView.extend({tagName:"ul",className:"listLine",childView:r});return c.openScheduleImportLayer=function(e,t){var n=new c({bandNo:e,isLocalMeetup:t});return s.openWithoutHiding(n),n},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(9),s=n(2242);return i.View.extend({tagName:"li",className:"item tLine",template:t.template(s),templateContext:function(){var e=this.model.get("end_at"),t=o.format.date(this.model.get("start_at"),"date_time"),n=o.format.date(e,"date_time"),i=this.model.get("is_lunar");return i&&(t=t+" ("+this.model.get("lunar_date_string")+")",n=n+" ("+this.model.get("lunar_end_date_string")+")"),e&&(t+=" ~"),{isLunar:i,startAtDate:t,endAt:e,endAtDate:n}},attributes:{"data-viewname":"DScheduleEditorImportItemView"},ui:{btnImportSchedule:"._btnImportSchedule"},events:{"click @ui.btnImportSchedule":function(){this.trigger("select:item",this)}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button type="button" class="flexList _btnImportSchedule">\n    <span class="text">\n        <span class="ellipsis"><%- name %></span>\n        <span class="sub -date"><%= startAtDate %></span>\n        <% if (endAt) { %>\n        <span class="sub -date"><%= endAtDate %></span>\n        <% } %>\n    </span>\n</button>'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_title\') %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="previousAttendance">\n            <div class="topNoticeBar">\n                <p class="sDesc gMat0"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_desc\') %></p>\n            </div>\n            <div class="_pastItems rScroll -h480"></div>\n        </div>\n    </div>\n    <footer class="footer -spaceNone">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%-IM(\'ui.label.back\')%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(4),o=n(2245),s=n(0),a=n(724),r=n(531),l=Backbone.Collection.extend({model:a,checkIsValid:function(e){var t=this.filter((function(t){if(t.cid!=e.cid)return a.isSameValue(t,e)}));return s.isEmpty(t)},addScheduleAlarmModelLessThanMaximum:function(){var e=this.filterScheduleAlarmCollectionWithoutEmptyValue(this._isAllDay).length==this.length,t=this.length<r.MAX_COUNT_FOR_COMMON_ALARM;if(e&&t){var n=a.buildScheduleAlarmModel();this.add(n)}},filterScheduleAlarmCollectionWithoutEmptyValue:function(e){return this.filter((function(t){return e?t.checkValidValueWithAlarmTime():t.checkValidValueWithoutAlarmTime()}))}}),c=i.CollectionView.extend({attributes:{"data-viewname":"DScheduleEditAlarmCollectionView"},tagName:"div",className:"gMat3",childView:o,childViewOptions:function(e,t){return{isAllDay:this._isAllDay,model:e,labelText:t>0?IM("schedule.detail.button.add_schedule_alarm"):IM("schedule.edit.label.alarm")}},childViewEvents:function(){var e={};return e[o.EVENT.ALARM_CHANGED]=function(e){this.collection.checkIsValid(e)?this.collection.addScheduleAlarmModelLessThanMaximum():(alert(IM("schedule.alarm.set_personal_alarm.notice.existing_alarm")),this.children.findByModelCid(e.cid).resetScheduleAlarmModel())},e},initialize:function(e){this._isAllDay=!!e.isAllDay},filterAlarmCollectionWithoutEmpty:function(e){return this.collection.filterScheduleAlarmCollectionWithoutEmptyValue(e)},onAttach:function(){if(this.collection.filterScheduleAlarmCollectionWithoutEmptyValue().length>0){var e=this.collection.filterScheduleAlarmCollectionWithoutEmptyValue();this.collection.set(e)}this.collection.addScheduleAlarmModelLessThanMaximum()}});c.buildDScheduleEditAlarmCollectionView=function(e){return new c({collection:new l(e.alarms),isAllDay:e.isAllDay})},e.exports=c},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2246),a=n(593),r=n(159),l=n(2004),c=o.View.extend({attributes:{"data-viewname":"DScheduleEditAlarmView"},template:t.template(s),templateContext:function(){return{labelText:this._labelText}},behaviors:[r],ui:{alarmSelect:"._alarmSelect",customAlarmRegion:"._customAlarmRegion"},events:{"change @ui.alarmSelect":"_onAlarmChanged"},modelEvents:{change:function(){this.model.isValidWith(this.getOption("isAllDay"))&&this.trigger(c.EVENT.ALARM_CHANGED,this.model)}},regions:{customAlarmRegion:{el:"@ui.customAlarmRegion",replaceElement:!1}},initialize:function(e){this._labelText=e.labelText},resetScheduleAlarmModel:function(){this.model.setAlarm(null),this.render()},_renderOptions:function(){if(!(this.getUI("alarmSelect").children().length>0)){i("<OPTION>").attr("value","").html(a.getNoneAlarmMessage()).appendTo(this.getUI("alarmSelect"));var e=this.getOption("isAllDay"),n=a.getPredefinedAlarms(e);t.each(n,(function(t){var n=t.duration_type+"_"+t.amount;e&&(n+="_"+t.alarm_time),i("<OPTION>").attr("value",n).data("value",t).html(a.getMessage(e,t)).appendTo(this.getUI("alarmSelect"))}),this),i("<OPTION>").attr("value","custom").html(a.getCustomAlarmMessage()).appendTo(this.getUI("alarmSelect"));var o=this.model.toJSONForSave(),s=o.duration_type&&o.duration_type+"_"+o.amount;s&&e&&(s+="_"+o.alarm_time),s&&!a.isPredefinedAlarm(e,o)&&(s="custom"),this.getUI("alarmSelect").val(s),"custom"==this.getUI("alarmSelect").val()?this._showCustomAlarmRegion():this.getRegion("customAlarmRegion").empty(),this.spawn(r.MSG.SCHEDULE_EDIT_ALARM_RENDERED)}},_onAlarmChanged:function(e){e.preventDefault(),"custom"==this.ui.alarmSelect.val()?(this.model.setAlarm(null),this._showCustomAlarmRegion()):(this.getRegion("customAlarmRegion").empty(),this.ui.alarmSelect.val()?this.model.setAlarm(this.ui.alarmSelect.find(":selected").data("value")):this.model.setAlarm(null)),this.spawn(r.MSG.SCHEDULE_EDIT_ALARM_RENDERED)},onDomRefresh:function(){this._renderOptions()},_showCustomAlarmRegion:function(){if(!this.getRegion("customAlarmRegion").hasView()){var e=new l({isAllDay:this.getOption("isAllDay"),alarm:this.model.has("durationType")?this.model.toJSONForSave():null});this.listenTo(e,l.EVENT.CUSTOM_ALARM_CHANGED,(function(e){this.model.setAlarm(e)})),this.getRegion("customAlarmRegion").show(e)}}});return c.EVENT={ALARM_CHANGED:"alarm:changed"},c}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="flexList">\n    <div class="dateTitle gPat8 gPab10"><label for="notification"><%= labelText %></label></div>\n    <div class="flexItem gMat-5">\n        <span class="uSelect -h32 -bg -block gColorBk2" style="width:173px;">\n            <select id="notification" class="_alarmSelect"></select>\n        </span>\n    </div>\n</div>\n<div class="_customAlarmRegion customAlarmRegion -editPage"></div>'},function(e,t){e.exports='<% // 미리알림 Custom 설정 > 미리 알림 amount %>\n<div class="uSelect -h32 -bg -block gColorBk2 alramSelect1">\n    <label for="alarmAmount" class="gSrOnly">select alarm amount</label>\n    <select id="alarmAmount" class="_alarmAmountSelect" data-value="<%- selectedAlarm.amount %>">\n        <option value="" disabled hidden selected><%= IM(\'ui.label.selection\') %></option>\n        <% _.each(selectableAmounts, function(amount) { %>\n        <option value="<%= amount %>" <% if(amount == selectedAlarm.amount) { %>selected<% } %>><%= amount %></option>\n        <% }); %>\n    </select>\n</div>\n<% // 미리알림 Custom 설정 > 미리 알림 단위 %>\n<div class="uSelect -h32 -bg -block gColorBk2 gMal5 alramSelect2">\n    <label for="alarmDuration" class="gSrOnly">select alarm unit</label>\n    <select id="alarmDuration" class="_alarmDurationTypeSelect" data-value="<%- selectedAlarm.duration_type %>">\n        <% _.each(selectableDurationTypes, function(durationType) { %>\n        <option value="<%= durationType.value %>" <% if(durationType.value == selectedAlarm.duration_type) { %>selected<% } %>><%- durationType.beforeMessage %></option>\n        <% }); %>\n    </select>\n</div>\n<% // 미리알림 Custom 설정 > 하루 종일 일정일 경우, 알림 시간 %>\n<div class="region alramSelect3">\n    <div class="flexItem gMal5 _alarmTimeRegion"></div>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(6),s=n(2249),a=n(800),r=n(722),l=n(2250),c=o.Model.extend({initialize:function(e){this.setIsSecret(e.isSecret),this.setSecretSharers(e.secretSharers)},isSecret:function(){return this.get("isSecret")},setIsSecret:function(e){return this.set("isSecret",e)},getSecretSharers:function(){return this.get("secretSharers")},createSecretSharers:function(e){this.setSecretSharers(r.buildScheduleSharerCollection(e))},getSafeSecretSharers:function(){return this.getSecretSharers()||this.createSecretSharers(null),this.getSecretSharers()},setSecretSharers:function(e){return this.set("secretSharers",e)}}),d=i.View.extend({tag:"div",className:"infoWrap -borderTop gMat20 gMab-21",attributes:{"data-viewname":"DScheduleSharerSelectView"},template:t.template(s),ui:{btnMemberSelect:"._btnMemberSelect"},events:{"click @ui.btnMemberSelect":"_openScheduleMemberSelectModal"},initialize:function(e){this._bandData=e.bandData,this.model=new c({isSecret:e.isSecret,secretSharers:e.secretSharers}),this._ownerUserNo=e.ownerUserNo},templateContext:function(){return{scheduleSharerConditionText:this.model.isSecret()?IM("schedule.member_select.count",{count:this.model.getSafeSecretSharers().length}):IM("schedule.member_select.all")}},_openScheduleMemberSelectModal:function(){var e=a.openAsLayer({title:IM("schedule.member_select.option_modal.title"),description:IM("schedule.secret.always_visible_to_leader"),confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:[{label:IM("schedule.member_select.all"),value:"all"},{label:IM("schedule.member_select.select"),value:"select"}],initialCheckedValue:this.model.isSecret()?"select":"all",withoutHiding:!0});this.listenTo(e,"modal:confirm",(function(e){"all"===e?(this.model.setIsSecret(!1),this.model.getSafeSecretSharers().reset([]),this.trigger(d.EVENTS.SHARER_CHANGE,{isSecret:this.model.isSecret(),secretSharers:this.model.getSafeSecretSharers()}),this.render()):this._openScheduleMemberSelect()}))},_openScheduleMemberSelect:function(){var e=l.openAsLayer({bandData:this._bandData,model:this.model,ownerUserNo:this._ownerUserNo});this.listenTo(e,l.EVENT.SHARER_CHANGE,(function(e){this.model.setIsSecret(0!==e.length),this.model.setSecretSharers(e),this.trigger(d.EVENTS.SHARER_CHANGE,{isSecret:this.model.isSecret(),secretSharers:this.model.getSafeSecretSharers()}),this.render()}))}});return d.EVENTS={SHARER_CHANGE:"SHARER_CHANGE"},d.buildDScheduleSharerSelectView=function(e){return new d({bandData:e.bandData,isSecret:e.isSecret,secretSharers:e.secretSharers,ownerUserNo:e.ownerUserNo})},d}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button type="button" class="flexList -wFull gPat8 gPab8 -spaceBetween memberSelectSection _btnMemberSelect">\n    <span class="flexLabel addCustomText gFs13 gColorBk2"><%-IM("schedule.member_select.label") %></span>\n    <span class="flexItem memberStatusCount gPar22"><%= scheduleSharerConditionText %></span>\n</button>\n'},function(e,t,n){var i=n(0),o=n(4),s=n(486),a=n(732),r=n(1624),l=n(907),c=n(581),d=n(527),u=n(1034),h=n(160),p=n(154),m=n(2253),_=n(562),g=n(531),f=o.View.extend({tagName:"section",className:"lyWrap",template:i.template(m),attributes:{"data-viewname":"DScheduleSharerEntryListView"},ui:{memberEntryListRegion:"._memberEntryListRegion",memberEntryCount:"._memberEntryCount",wrapRemoveAll:"._wrapRemoveAll",btnRemoveAll:"._btnRemoveAll",btnAddMemberEntry:"._btnAddMemberEntry",btnBack:"._btnBack",btnConfirm:"._btnConfirm"},regions:{memberEntryListRegion:{el:"@ui.memberEntryListRegion",replaceElement:!0}},events:{"click @ui.btnAddMemberEntry":function(){this._openAddMemberLayer(!1)},"click @ui.btnRemoveAll":function(){this.hasChanged=!0,this.model.getSecretSharers().reset([]),this._renderMemberEntryCount()},"click @ui.btnBack":"destroy","click @ui.btnConfirm":"destroy"},initialize:function(e){this.bandData=e.bandData,this.model=e.model,this.memberEntryCollectionView=new r({collection:this.model.getSafeSecretSharers()}),this._ownerUserNo=e.ownerUserNo,this._bandNo=this.bandData.getBandCore().bandNo},onAttach:function(){this.listenTo(this.memberEntryCollectionView,"entry:remove",(function(e){this.model.getSecretSharers().remove(e),this.hasChanged=!0,this._renderMemberEntryCount()})),this.showChildView("memberEntryListRegion",this.memberEntryCollectionView),this._renderMemberEntryCount(),0===this.model.getSecretSharers().length&&this._openAddMemberLayer(!0)},onBeforeDestroy:function(){this.hasChanged&&this.trigger(f.EVENT.SHARER_CHANGE,this.model.getSecretSharers())},_openAddMemberLayer:function(e){var t=this.model.getSecretSharers().pluck("userNo");t.push(this._ownerUserNo);var n=l.openDMemberSelectionView({wideView:!0,submitBtnText:IM("ui.label.confirm"),profileClickAsSelect:!0}),o=d.buildBandMemberWithFilterDataCollection(this._bandNo,h.ADD_SCHEDULE_SHARER,100),s=d.buildBandMemberWithFilterDataCollection(this._bandNo,h.ADD_SCHEDULE_SHARER,100);p.wrapActivePromise(o.fetchBandMemberWithFilterDataCollection(),this).then(i.bind((function(){this._memberModels=i.filter(o.toMemberSelectionViewModels(),(function(e){return!i.contains(t,e.getUserNo())})),this._memberModels.unshift(c.buildSelectAllBtnModel({btnName:IM("web.bandmemberselection.select_all_members")+" ("+this._memberModels.length+")",btnImageUrl:this.bandData.getBandCore().cover})),n.renderMemberListToSelect({memberModels:this._memberModels,memberGroupSelectSupport:o.hasMemberGroup(),showSearchMoreMemberBtn:o.hasMoreMember()})}),this)),this.listenTo(n,l.EVENT.MEMBER_SELECTION_MEMBER_SELECT_CLICK,(function(e){e.selectedMemberCount+t.length>g.MAX_SHARER_NUMBER?_.openLayer({bodyTitle:IM("schedule.member_select.count_exceeded"),confirm:IM("web.modal.btn.confirm"),withoutHiding:!0}):n.selectMember(e.selectedMember)})),this.listenTo(n,l.EVENT.MEMBER_SELECTION_MEMBER_DESELECT_CLICK,(function(e){n.deselectMember(e)})),this.listenTo(n,l.EVENT.MEMBER_SELECTION_SEARCH,(function(e){p.wrapActivePromise(s.searchBandMemberWithFilterDataCollection(e),this).then((function(){n.renderMemberListToSelect({memberModels:i.filter(s.toMemberSelectionViewModels(),(function(e){return!i.contains(t,e.getUserNo())})),memberGroupSelectSupport:o.hasMemberGroup(),showSearchMoreMemberBtn:s.hasMoreMember()})}))})),this.listenTo(n,l.EVENT.MEMBER_SELECTION_INPUT_EMPTY,(function(){n.renderMemberListToSelect({memberModels:this._memberModels,memberGroupSelectSupport:o.hasMemberGroup(),showSearchMoreMemberBtn:o.hasMoreMember()})})),this.listenTo(n,l.EVENT.MEMBER_SELECTION_COMPLETE,(function(e){this.model.getSecretSharers().add(i.map(e.selectedMembers,(function(e){return a.createScheduleSharerModel({userNo:e.getUserNo(),name:e.getUserName(),profileImageUrl:e.getProfileImageUrl(),description:e.getDescription()},{parse:!0})}))),this.hasChanged=!0,this._renderMemberEntryCount(),n.destroyView()})),this.listenTo(n,l.EVENT.MEMBER_SELECTION_MEMBER_GROUP_CLICK,(function(){var e=u.buildMemberGroupSelectView(this._bandNo);this.listenTo(e,"memberGroupView:selectedMemberGroups",(function(e){var o=i.map(n.getSelectedMembers(),(function(e){return e.getUserNo()})),s=i.filter(e,(function(e){return!i.contains(t,e.userNo)&&!i.contains(o,e.userNo)}),this);n.getSelectedMemberCount()+s.length+t.length-1>g.MAX_SHARER_NUMBER?_.openLayer({bodyTitle:IM("schedule.member_select.count_exceeded"),confirm:IM("web.modal.btn.confirm"),withoutHiding:!0}):i.chain(s).map((function(e){return c.buildMemberSelectionViewModel({userNo:e.userNo,userName:e.name,description:e.description,profileImageUrl:e.profileImageUrl,isKid:e.isKid})})).each((function(e){n.selectMember(e)})).value()}))})),this.listenTo(n,l.EVENT.MEMBER_SELECTION_ALL_SELECT_CLICK,(function(e){var o=i.filter(e.memberSelectionModels,(function(e){return!e.isSelected()}));if(n.getSelectedMemberCount()+o.length+t.length-1>g.MAX_SHARER_NUMBER)_.openLayer({bodyTitle:IM("schedule.member_select.count_exceeded"),confirm:IM("web.modal.btn.confirm"),withoutHiding:!0});else{var s=i.filter(e.memberSelectionModels,(function(e){return e.isSelected()}));i.each(s,(function(e){n.deselectMember(e.getUserNo())})),i.chain(e.memberSelectionModels).reverse().each((function(e){n.selectMember(e)})).value()}})),this.listenTo(n,l.EVENT.MEMBER_SELECTION_ALL_DESELECT_CLICK,(function(e){i.each(e.memberSelectionModels,(function(e){n.deselectMember(e.getUserNo())}))})),e&&this.listenToOnce(n,"destroy",this.destroy)},_renderMemberEntryCount:function(){this.getUI("memberEntryCount").html(this.model.getSecretSharers().length>0?this.model.getSecretSharers().length:"")}});f.EVENT={SHARER_CHANGE:"entry:sharerChange"},f.openAsLayer=function(e){var t=new f(e);return s.open(t),t},e.exports=f},function(e,t,n){var i=n(4),o=n(2252),s=i.View.extend({tagName:"li",className:"tLine flexList",attributes:{"data-viewname":"DMemberEntryItemView"},template:_.template(o),ui:{removeMenu:"._removeMenu"},events:{"click @ui.removeMenu":function(){if(confirm(IM("web.postwrite.form_attendance_check.user_selection.remove_member_confirm")))return this.trigger("entry:remove",this.model),!1}},templateContext:function(){return{isAuthor:!this.model.get("userNo"),isModifiable:!!this.model.get("userNo")}}});e.exports=s},function(e,t){e.exports='<span class="thumb">\n    <span class="uProfile -size40">\n        <span class="profileInner <%- profileInnerClass %>">\n            <% if (!!profileImageUrl) { %><img src="<%- faceThumb %>" width="40" height="40" alt="<%- name %>"><% } %>\n        </span>\n    </span>\n</span>\n<span class="text">\n    <span class="ellipsis"><%- name %></span>\n    <span class="sub2 -ellipsis"><% if (isAuthor) { %><span><%-IM("post.writer.label") %></span><% } %></span>\n</span>\n<% if (isModifiable) { %>\n<span class="etc">\n    <button class="uButton -sizeS -confirm2 _removeMenu"><%- IM(\'ui.label.delete\') %></button>\n</span>\n<% } %>'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM("schedule.member_select.select") %>&nbsp;<span class="_memberEntryCount"></span></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="memberListBox">\n                <div class="topNoticeBar _wrapRemoveAll">\n                    <button type="button" class="btnDelet _btnRemoveAll"><%-IM("web.postwrite.form_attendance_check.attendee_list.btn_remove_all")%></button>\n                </div>\n                <div class="addMemberAttend">\n                    <a href="#" role="button" class="button _btnAddMemberEntry"><%- IM(\'web.postwrite.form_attendance_check.btn_add_members\') %></a>\n                </div>\n                <div class="_memberEntryListRegion"></div>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%= IM("ui.label.prev") %></span></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(2255),a=n(2005),r=n(2256),l=n(486),c=n(16),d=n(9),u=n(1558),h=n(583),p=n(154),m=n(158),_=-1,g=1,f=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorScheduleSelectView"},template:i.template(s),ui:{prevBtn:"._prevBtn",monthText:"._monthText",nextBtn:"._nextBtn",scheduleList:"._scheduleList",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},regions:{scheduleList:{el:"@ui.scheduleList",replaceElement:!0}},events:{"click @ui.prevBtn":function(){this._moveMonth(_)},"click @ui.nextBtn":function(){this._moveMonth(g)},"click @ui.cancelBtn":function(){this._cancel()},"click @ui.confirmBtn":function(){this.ui.confirmBtn.prop("disabled")||this._confirm()},intersect:function(e,n){var i=t(n.target).data("markerType"),o=n.isIntersecting;switch(i){case"schedule-list-bottom":o&&this._collection.fetchMonthNextPageSchedules()}}},behaviors:[{behaviorClass:u,observations:[{elements:"._scheduleListMarker",root:"._scheduleListWrap"}]}],initialize:function(e){this._bandData=e.bandData,this._selection=e.selection,this._doNotClose=!!e.doNotClose,this._month=c().startOf("month"),this._bandNo=this._bandData.getBandCore().bandNo,this._collection=a.buildEditorScheduleSelectCollection({bandNo:this._bandNo})},serializeData:function(){return{month:this._getMonthText()}},onAttach:function(){this.listenTo(this._selection,"all",this._toggleConfirmBtn)},onBeforeDetach:function(){this.stopListening(this._selection)},onDomRefresh:function(){this._toggleConfirmBtn(),this._moveMonth()},_getMonthText:function(){return d.format.date(this._month,"year_month")},_toggleConfirmBtn:function(){this.ui.confirmBtn.prop("disabled",this._selection.isEmpty())},_confirm:function(){this.trigger("confirm"),this._destroy()},_cancel:function(){this.trigger("cancel"),this._destroy()},_destroy:function(){this._doNotClose||this.destroy()},_moveMonth:function(e){e&&this._month.add(e,"months"),this.ui.monthText.text(this._getMonthText()),this._renderScheduleList(!0),p.wrapActivePromise(this._collection.fetchMonthFirstPageSchedules(this._month),this).then(i.bind((function(){this._renderScheduleList(!1)}),this))},_renderScheduleList:function(e){var t=null;t=e?h.buildAsMediumAreaMiddle():this._collection.isEmpty()?new o.View({tagName:"div",className:"uEmpty",attributes:{style:"height: 100%"},template:i.template('<div class="uEmptyDesc">'+m.nl2br(IM("post.schedule_group.no_month_schedules"))+"</div>")}):new o.CollectionView({tagName:"ul",className:"dailyScheduleList gMat-20",childView:r,childViewOptions:{selection:this._selection},collection:this._collection}),this.showChildView("scheduleList",t)}});return f.openEditorScheduleSelectLayer=function(e){var t=new f(e);return e.withoutHiding?l.openWithoutHiding(t):l.open(t),t},f}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lySchedule" style="width:480px">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'post.schedule_group.select_schedule\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContent">\n            <h2 class="scheduleHeader">\n                <div class="month">\n                    <button type="button" class="prev _prevBtn"><span class="gSrOnly"><%- IM(\'schedule.list.button.prev_month\') %></span></button>\n                    <span class="monthTxt _monthText"><%- month %></span>\n                    <button type="button" class="next _nextBtn"><span class="gSrOnly"><%- IM(\'schedule.list.button.next_month\') %></span></button>\n                </div>\n            </h2>\n            <article class="scheduleList -scrollYBox _scheduleListWrap" style="height:396px">\n                <h2 class="gSrOnly"><%- IM(\'schedule.txt.schedule_list\') %></h2>\n                <ul class="_scheduleList"></ul>\n                <div class="_scheduleListMarker" data-marker-type="schedule-list-bottom"></div>\n            </article>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2257),s=n(1625),a=n(16);return i.View.extend({tagName:"li",className:"scheduleListItem -alignItemFlexStart",attributes:{"data-viewname":"DEditorScheduleSelectItemView"},template:t.template(o),ui:{checkbox:"._checkbox",schedule:"._schedule"},events:{"click @ui.checkbox":function(e){this.ui.checkbox.prop("checked")?this._selection.canAddEditorSchedule()?this._selection.add(this.model):(e.preventDefault(),alert(IM("post.schedule_group.schedule_max_count",{count:this._selection.getEditorScheduleMaxCount()}))):this._selection.remove(this.model)}},regions:{schedule:{el:"@ui.schedule",replaceElement:!0}},initialize:function(e){this._selection=e.selection},serializeData:function(){var e=a(this.model.get("startAt"));return{id:"schedule_"+this.cid,ymd:e.format("YYYY-MM-DD"),date:e.format("D"),day:e.format("dddd"),checked:this._selection.has(this.model)}},onRender:function(){this._renderSchedule()},_renderSchedule:function(){var e=s.build({scheduleEvents:this.model});this.showChildView("schedule",e)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="checkOption gMat20">\n    <label for="<%- id %>" class="uCheck -checkbox">\n        <input type="checkbox" id="<%- id %>" class="checkInput _checkbox" <%- checked ? \' checked\' : \'\' %>>\n        <span class="checkLabel">\n            <span class="shape"></span>\n            <span class="text"></span>\n        </span>\n    </label>\n</div>\n<label class="checkOptionLabel" for="<%- id %>"></label>\n<time class="date gMar-7" datetime="<%- ymd %>"><span><%- date %> <em><%- day %></em></span></time>\n<span class="_schedule"></span>'},,,function(e,t){e.exports='<%\n// 생일, 밴드 생성일, 공휴일인 경우\nif (scheduleType.isBirthday || scheduleType.isBandOpen || scheduleType.isHoliday) {\n%>\n    <span class="scheduleInfo" style="max-width: 340px">\n    <% if (isNewSchedule) { // 새 일정 %>\n        <em class="gNewIcon -w5"><%= IM("schedule.txt.schedule_created_recently") %></em>\n    <% } %>\n        <strong class="title"><%- scheduleName %></strong>\n\n    <% // 생일, 밴드 생성일인 경우는 글쓰기 유도 문구 노출 %>\n    <% if (scheduleType.isBirthday || scheduleType.isBandOpen) { %>\n        <span class="name"><%= IM("schedule.msg.recommend_post_celebration") %></span>\n    <% } %>\n    <% if ( commentCount ) { %>\n        <span class="scheduleComment _openScheduleWithScrollToComment"><%- commentCount %></span>\n    <% } %>\n    </span>\n    <span class="scheduleInfoEtc">\n        <svg class="svgIcon sf_color" aria-hidden=”true”>\n        <%\n            var icon = "";\n\n            if (scheduleType.isBirthday) { // 생일\n                icon = "ico-birthday";\n            } else if (scheduleType.isBandOpen) { // 밴드 생성일\n                icon = "ico-band-created";\n            } else if (scheduleType.isHoliday) { // 구독 일정 (공휴일)\n                icon = "ico-holiday";\n            }\n        %>\n            <use xlink:href="#<%= icon %>"></use>\n        </svg>\n    </span>\n<%\n// 일반 일정인 경우\n} else {\n%>\n    <span class="scheduleInfo <%= !_.isEmpty(band) ? band.getSkinColorClass() : \'\' %>"  style="max-width: 340px">\n        <% if (!_.isEmpty(band)) { %>\n        <span class="bandName sf_color"><%- band.name %></span>\n        <% } %>\n    <% // 새 일정 %>\n    <% if (isNewSchedule) { %>\n        <em class="gNewIcon -w5"><%= IM("schedule.txt.schedule_created_recently") %></em>\n    <% } %>\n        <strong class="title"><%- scheduleName %></strong>\n        <span class="info">\n            <% if (scheduleTime) { %><span class="scheduleEndTime"><%= scheduleTime %></span><% } %>\n            <% if (mapName) { %><span class="location"><%- mapName %></span><% } %>\n        </span>\n\n    <% // RSVP %>\n    <% if (rsvpInfo) { %>\n        <span class="rsvp">\n            <em <% if (rsvpInfo.isAttendanceStatus) { %> class="sf_color"<% } %>><%= IM("schedule.rsvp.attendance") %> <%- rsvpInfo.attendeeCount %></em>\n        <% if (rsvpInfo.pendingAttendeeCount > 0) { %>\n            <em <% if (rsvpInfo.isPendingAttendanceStatus) { %> class="sf_color"<% } %>><%= IM("schedule.rsvp.pending_attendee") %> <%- rsvpInfo.pendingAttendeeCount %></em>\n        <% } %>\n            <em <% if (rsvpInfo.isAbsenceStatus) { %> class="sf_color"<% } %>><%= IM("schedule.rsvp.absentee") %> <%- rsvpInfo.absenteeCount %></em>\n        <% if (rsvpInfo.isMaybeEnabled) { %>\n            <em <% if (rsvpInfo.isMaybeStatus) { %> class="sf_color"<% } %>><%= IM("schedule.rsvp.maybe") %> <%- rsvpInfo.maybeCount %></em>\n        <% } %>\n        <% if (rsvpInfo.hasCustomState) { %>\n            <em <% if (rsvpInfo.isCustomStatus) { %> class="sf_color"<% } %>><%= IM("rsvp.custom.desc") %> <%- rsvpInfo.customCount %></em>\n        <% } %>\n        </span>\n    <% } %>\n\n    <% // 캘린더 정보 %>\n    <% if (calendarInfo) { %>\n        <span class="desc">\n        <% if (calendarInfo.color) { %>\n            <span class="scheduleColor" style="background:#<%- calendarInfo.color %>">\n                <span class="gSrOnly">#<%- calendarInfo.color %></span>\n            </span>\n        <% } else { %>\n            <span class="scheduleColor sf_bg">\n                <span class="gSrOnly"></span>\n            </span>\n        <% } %>\n\n        <%- calendarInfo.name %>\n\n        <% if (scheduleType.isNormal && ownerName != \'\') { %>\n            <span class="name"><%- ownerName %></span>\n        <% } else if (scheduleType.isExternal && calendarInfo.serviceProvider != \'\') { %>\n            <span class="name"><%- calendarInfo.serviceProvider %></span>\n        <% } %>\n\n        <% if (isSecret) { %>\n            <span class="isDisclosed">\n                <span class="iconDisclosed"></span>\n                <span class="gSrOnly">일부멤버공개</span>\n            </span>\n        <% } %>\n        </span>\n    <% } %>\n\n    <% // 첨부 파일 %>\n    <% if (fileInfo) { %>\n        <span class="attachment <%= fileInfo.hasExpiredFile ? \'-disabled\' : \'\' %> _openScheduleWithScrollToFile"><%= (fileInfo.fileCount) %></span>\n    <% } %>\n\n    <% if ( commentCount ) { %>\n        <span class="scheduleComment _openScheduleWithScrollToComment"><%- commentCount %></span>\n    <% } %>\n    </span>\n\n    <% // 사진 첨부 %>\n    <% if (photoInfo) { %>\n    <span class="scheduleInfoEtc -pic _openScheduleImageViewer">\n        <img src="<%- photoInfo.thumbnailUrl %>" alt="<%- photoInfo.thumbnailUrl %>">\n        <% if (photoInfo.photoCount > 1) { %><em><%= photoInfo.photoCount %></em><% } %>\n    </span>\n    <% } %>\n<%\n}\n%>'},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'post.schedule_group.attach_schedule\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gMat-2">\n            <ul class="listLine">\n                <li class="tLine notiSettingItem">\n                    <div class="optionItem gMat10 gMal2 gMab-8">\n                        <label  aria-label="" class="uCheck -checkbox ">\n                            <input  type="checkbox" class="checkInput _scheduleCreationInput" name="scheduleCreationInput" checked value="<%- normalSchedule %>">\n                            <span class="checkLabel">\n                                <span class="shape  "></span>\n                                <span class="text"><%- IM(\'schedule.list.button.add_schedule\') %></span>\n                            </span>\n                        </label>\n                        <div class="optionItemDesc gFs12 gColorGr1 gMat4 gMal28 gMab13"><%- IM(\'schedule.normal_schedule_creation_description\') %></div>\n                    </div>\n<% if ( canSelectLocalMeetup ) { %>\n                    <div class="optionItem gPat12">\n                        <label  aria-label="" class="uCheck -checkbox ">\n                            <input type="checkbox" class="checkInput _scheduleCreationInput" name="scheduleCreationInput" value="<%- localMeetup %>">\n                            <span class="checkLabel">\n                                <span class="shape  "></span>\n                                <span class="text"><%- IM(\'schedule.local_meetup_schedule_creation\') %></span>\n                            </span>\n                        </label>\n                        <div class="optionItemDesc gFs12 gColorGr1 gMat4 gMal28 gMab9"><%- IM(\'schedule.local_meetup_schedule_creation_description\') %></div>\n                    </div>\n<% } %>\n<% if ( canSelectExistSchedule ) { %>\n                    <div class="optionItem gPat12">\n                        <label  aria-label="" class="uCheck -checkbox ">\n                            <input  type="checkbox" class="checkInput _scheduleCreationInput" name="scheduleCreationInput" value="<%- existingSchedule %>">\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                                <span class="text"><%- IM(\'schedule.import_existing_schedule\') %></span>\n                            </span>\n                        </label>\n                        <div class="optionItemDesc gFs12 gColorGr1 gMat4 gMal28 gMab9"><%- IM(\'schedule.import_existing_schedule_description\') %></div>\n                    </div>\n<% } %>\n                </li>\n            </ul>\n        </div>\n    </div>\n    <footer class="modalFooter -tLongLine">\n        <button type="button" class="uButton -cancel _creationCancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _creationConfirmBtn"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(563),o=n(2263),s=n(2008),a=n(152),r=n(799);e.exports=function(e,t){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.ATTENDANCE_CHECK,apiType:"attendance_check",createModelFromJSON:i.createAttendanceCheck,createWidgetView:r.widgetViewCreator(o),onWidgetModify:r.createLayoutModify((function(e){return s.openLayer(t.getBandNo(),e)}))},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2264);return i.View.extend({attributes:{"data-viewname":"AttendanceCheckWidgetView"},template:t.template(o),ui:{btnModify:"._btnModify",btnDelete:"._btnDelete"},triggers:{"click @ui.btnModify":"modify","click @ui.btnDelete":"remove"}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _btnModify"><%- IM("ui.label.modify") %></button>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -attendance">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-attendance sf_color" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-attendance-26"></use>\n                    </svg>\n                    <span class="status sf_color"><%- IM(\'post.attendance_check.title\') %></span>\n                    <%- IM(\'post.attendance_check.count\', {done: checkedAttendeeCount.toString(), all: attendeeCount.toString()}) %>\n                </p>\n                <p class="addTitle"><%- title %></p>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="lyContent -w480 ">\n    <header class="header">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.title\') %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="postWrite">\n            <div class="addWidget">\n                <div class="attendanceCheck">\n                    <% // 제목 영역 %>\n                    <div class="titleWrap _titleWrap">\n                        <label for="attendanceCheckTitle" class="gSrOnly"><%- IM(\'web.postwrite.form_attendance_check.title_area.label\') %></label>\n                        <input type="text" id="attendanceCheckTitle" maxlength="<%- attendanceTitleMaxLength %>" placeholder="<%- IM(\'web.postwrite.form_attendance_check.title_area.placeholder\') %>" value="<%- title %>">\n                        <div class="previousCheck">\n                            <button type="button" class="btnLoad _btnImportPrevAttendanceCheck"><span class="gSrOnly"><%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.label\') %></span></button>\n                            <dl class="uHelpGuide -right -close" role="alert" aria-live="assertive">\n                                <dt><span class="gSrOnly"><%-IM(\'ui.label.help\')%></span></dt>\n                                <dd class="_popoverHelpImportAttendanceCheck" style="width:190px;display:<%- attendanceCheckImportHelpClosed ? \'none\' : \'block\' %>;">\n                                    <%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.help_description\') %>\n                                    <button type="button" class="btnLyClose _btnCloseImportAttendanceCheckHelpPopover"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n                                </dd>\n                            </dl>\n                        </div>\n                    </div>\n                    <% // 출석 멤버 %>\n                    <div class="flexList">\n                        <strong class="title"><%- IM(\'web.postwrite.form_attendance_check.add_attendees.title\') %></strong>\n                        <div class="utillBox">\n                            <button type="button" class="btnAdd _btnAddAttendees" aria-haspopup="listbox" aria-expanded="true"><%- attendeeCount > 0 ? IM(\'web.postwrite.form_attendance_check.add_attendees.attendee_count\', {count: attendeeCount}) : IM(\'web.postwrite.form_attendance_check.add_attendees.btn.add\') %></button>\n                            <div class="lyMenu _attendeesAddMenu" style="display:none;width:162px">\n                                <ul>\n                                    <li class="attendeesMemberItem"><a href="#" class="_btnAddBandMemberAttendees"><%- IM(\'web.postwrite.form_attendance_check.btn_add_members\') %></a></li>\n                                    <li class="attendeesMemberItem"><a href="#" class="_btnAddChildMemberAttendees"><%= IM(\'web.postwrite.form_attendance_check.btn_add_child_members\') %></a></li>\n                                    <li class="attendeesMemberItem"><a href="#" class="_btnAddAttendeesFromRsvpMembers"><%- IM(\'web.postwrite.form_attendance_check.btn_add_members_from_rsvp\') %></a></li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n\n                    <% // 응답 항목 설정 %>\n                    <div class="flexList">\n                        <strong class="title"><%= IM(\'web.postwrite.form_attendance_check.select_supported_states.title\') %></strong>\n                        <span class="flexItem">\n                            <span class="uSelect -h32 -bg -block gColorBk2" style="width:173px">\n                                <label for="selectSupportedStates" class="gSrOnly"><%= IM(\'web.postwrite.form_attendance_check.select_supported_states.select_label\') %></label>\n                                <select id="selectSupportedStates">\n                                    <option value="checked,unchecked" <%= _.isEqual(supportedStates, [\'checked\',\'unchecked\']) ? \'selected\' : \'\' %>><%= IM(\'web.postwrite.form_attendance_check.select_supported_states.option.checked_only\') %></option>\n                                    <option value="checked,absent,unchecked" <%= _.isEqual(supportedStates, [\'checked\',\'absent\',\'unchecked\']) ? \'selected\' : \'\' %>><%= IM(\'web.postwrite.form_attendance_check.select_supported_states.option.checked_absent\') %></option>\n                                    <option value="checked,tardy,early_left,absent,unchecked" <%= _.isEqual(supportedStates, [\'checked\',\'tardy\',\'early_left\',\'absent\',\'unchecked\']) ? \'selected\' : \'\' %>><%= IM(\'web.postwrite.form_attendance_check.select_supported_states.option.checked_absent_tardy_early_left\') %></option>\n                                </select>\n                            </span>\n                        </span>\n                    </div>\n\n                    <% // 출석 관리자 추가 %>\n                    <div class="flexList">\n                        <strong class="title">\n                            <%- IM(\'web.postwrite.form_attendance_check.add_managers.title\') %>\n                            <dl class="uHelpGuide -small -close" role="alert" aria-live="assertive">\n                                <dt><button type="button" class="_btnAddManagersHelp"><span class="gSrOnly"><%-IM(\'ui.label.help\')%></span></button></dt>\n                                <dd class="_popoverAddMenagersHelp" role="dialog" style="display: none; width:188px">\n                                    <%- IM(\'web.postwrite.form_attendance_check.add_managers.help_description\') %>\n                                    <button type="button" class="btnLyClose _btnCloseAddManagersHelpPopover"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n                                </dd>\n                            </dl>\n                        </strong>\n                        <div class="utillBox">\n                            <button type="button" class="btnAdd _btnSelectManagers"><%- managerCount > 1 ? IM(\'web.postwrite.form_attendance_check.add_managers.manager_count\', {count: managerCount}) : IM(\'web.postwrite.form_attendance_check.add_managers.btn.add.default\') %></button>\n                        </div>\n                    </div>\n                    <% // 멤버가 출석 체크 직접 하는지 여부 %>\n                    <div class="optionCheck gMab9">\n                        <label for="checkableByMemberInput" class="uCheck -checkbox -fs13 gMat5">\n                            <input type="checkbox" id="checkableByMemberInput" class="checkInput" <%- !isCheckableOnlyByManagers ? \'checked\': \'\' %>>\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                                <span class="text"><%- IM(\'web.postwrite.form_attendance_check.checkable_by_member.label\') %></span>\n                            </span>\n                        </label>\n                        <% // 멤버가 출석 체크 직접 하면 마감일 설정 가능 (Optional) %>\n                        <div class="flexList -h32 gMat8 _startAtInputRegionWrap">\n                            <div class="text"><%- IM(\'web.postwrite.form_attendance_check.start_at.label\') %></div>\n                            <div class="etc" style="width:325px">\n                                <div class="_startAtInputRegion"></div>\n                            </div>\n                        </div>\n                        <div class="flexList -h32 -btN gMat20 _endedAtInputRegionWrap">\n                            <div class="text"><%- IM(\'web.postwrite.form_attendance_check.ended_at.label\') %></div>\n                            <div class="etc" style="width:325px">\n                                <div class="_endedAtInputRegion"></div>\n                            </div>\n                        </div>\n                        <div class="flexList -h32 -btN gMat20 _timeZoneRegionWrap">\n                            <div class="text"><%- IM(\'web.scheduleedit.date.timezone\') %></div>\n                            <div class="etc" style="width:325px">\n                                <div class="_timeZoneRegion"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="optionCheck">\n                        <label for="attendanceVisibleToViewer" class="uCheck -checkbox -fs13">\n                            <input type="checkbox" id="attendanceVisibleToViewer" class="checkInput" <%- isAttendanceVisibleToViewer ? \'checked\': \'\' %>>\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                                <span class="text"><%- IM(\'post.write.attendance_check.result_view_permission.title\') %></span>\n                            </span>\n                        </label>\n                        <p class="optionDesc gFs12 gColorGr1 gMat4 gMal28 _attendanceVisibleQualificationDesc"></p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -confirm _btnComplete" <%- isAttachable ? \'\':\'disabled\' %>><%-IM(\'web.btn.attach\')%></button>\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(4),a=n(486),r=n(714),l=n(9),c=n(667),d=n(2267),u=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorAttendanceCheckImportView"},template:i.template(d),ui:{btnBack:"._btnBack",btnImportAttendanceCheck:"._btnImportAttendanceCheck"},events:{"click @ui.btnBack":"destroy","click @ui.btnImportAttendanceCheck":function(e){var n=t(e.currentTarget);r.getAttendanceCheck({band_no:this.bandNo,post_no:parseInt(n.data("postNo")),attendance_check_id:parseInt(n.data("attendanceCheckId"))}).then(i.bind((function(e){e.attendance_check.checked_attendee_count=0,e.attendance_check.attendees=i.filter(e.attendance_check.attendees,(function(e){var t=e.attendee.is_deleted||!1;return!t&&e.is_checked&&(e.is_checked=!1,delete e.checked_at),!t})),e.attendance_check.managers=i.filter(e.attendance_check.managers,(function(e){return!(e.is_deleted||!1)})),this.trigger("attendanceCheck:selected",e.attendance_check),this.destroy()}),this))}},initialize:function(e){this.bandNo=e.bandNo,this.collection=new o.Collection(null,{model:c})},templateContext:function(){return{Localize:l}},onAttach:function(){r.getMyAttendanceChecks(this.bandNo).then(i.bind((function(e){this.collection.reset(e.items,{parse:!0}),this.render()}),this))}});return u.openAsLayer=function(e){var t=new u({bandNo:e});return a.open(t),t},u}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_title\') %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="previousAttendance">\n            <div class="topNoticeBar">\n                <p class="sDesc gMat0"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_desc\') %></p>\n            </div>\n            <% if (!!items && items.length > 0) { %>\n            <ul class="listLine rScroll -h480">\n                <% _.each(items, function(eachAttendanceCheck, index) { %>\n                <li class="tLine">\n                    <button type="button" class="flexList _btnImportAttendanceCheck" data-post-no="<%- eachAttendanceCheck.postNo %>" data-attendance-check-id="<%- eachAttendanceCheck.attendanceCheckId %>">\n                        <span class="text">\n                            <span class="ellipsis"><%- eachAttendanceCheck.title %></span>\n                            <span class="sub -date"><%= Localize.format.date(eachAttendanceCheck.createdAt, \'short_date_time\') %></span>\n                        </span>\n                    </button>\n                </li>\n                <% }) %>\n            </ul>\n            <% } else { %>\n            <p class="uEmpty -h480">\n                <span><%- IM(\'ui.message.empty_conents\') %></span>\n            </p>\n            <% } %>\n        </div>\n    </div>\n    <footer class="footer -spaceNone">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%-IM(\'ui.label.back\')%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(16),s=n(6),a=n(4),r=n(486),l=n(490),c=n(9),d=n(503),u=n(549),h=n(2269),p=n(2270),m={RSVP_ATTENDEES_SELECTED:"rsvpAttendees:selected"},_=a.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorAttendanceCheckRsvpAttendeeImportView"},template:i.template(h),ui:{btnBack:"._btnBack",btnSelectSchedule:"._btnSelectSchedule"},events:{"click @ui.btnBack":"destroy","click @ui.btnSelectSchedule":function(e){var n=t(e.currentTarget).data("scheduleId");0!=this.collection.get(n).get("rsvp").get("attendeeCount")?p.openAsLayer(this.bandNo,n).on(p.EVENT.RSVP_ATTENDEES_SELECTED,i.bind((function(e){this.trigger(m.RSVP_ATTENDEES_SELECTED,e),this.destroy()}),this)):alert(IM("web.postwrite.form_attendance_check.no_attendee_schedule_alert"))}},initialize:function(e){this.bandNo=e.bandNo,this.collection=new s.Collection(null,{model:u})},serializeCollection:function(){return this.collection?this.collection.map((function(e){var t=o(e.get("startAt"));return e.set("startAt",c.format.date(t,"short_date_time")),l.toRecursiveJSON(e)})):{}},onAttach:function(){d.getSchedules({bandNo:this.bandNo,startAt:o(),pastEndAt:o().subtract(10,"days"),futureEndAt:o().add(30,"days"),rsvpOnly:!0}).then(i.bind((function(e){this.collection.reset(e.items.slice(0,30),{parse:!0}),this.render()}),this))}});return _.EVENT=m,_.openAsLayer=function(e){var t=new _({bandNo:e});return r.open(t),t},_}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.import_rsvp_attendee_title\') %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="previousAttendance">\n            <div class="topNoticeBar">\n                <p class="sDesc gMat-0"><%- IM(\'web.postwrite.form_attendance_check.import_rsvp_attendee_desc\') %></p>\n            </div>\n            <% if (!!items && items.length > 0) { %>\n            <ul class="listLine rScroll -h480">\n                <% _.each(items, function(eachSchedule, index) { %>\n                <li class="tLine">\n                    <button type="button" class="flexList _btnSelectSchedule" data-schedule-id="<%- eachSchedule.scheduleId %>">\n                        <span class="text">\n                            <span class="ellipsis"><%- eachSchedule.name %></span>\n                            <span class="sub -date"><%- eachSchedule.startAt %></span>\n                            <span class="sub"><em class="point memberCount"><%- IM(\'web.postwrite.form_attendance_check.rsvp_member_import.attendee_count\', {count: eachSchedule.rsvp.attendeeCount.toString()}) %></em></span>\n                        </span>\n                    </button>\n                </li>\n                <% }) %>\n            </ul>\n            <% } else { %>\n            <p class="uEmpty -h480">\n                <span><%- IM(\'ui.message.empty_conents\') %></span>\n            </p>\n            <% } %>\n        </div>\n    </div>\n    <footer class="footer -spaceNone">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%-IM(\'ui.label.back\')%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){n(2);var t=n(0),i=n(6),o=n(4),s=n(486),a=n(490),r=n(511),l=n(503),c=n(834),d=n(2271),u={RSVP_ATTENDEES_SELECTED:"rsvpAttendees:selected"},h=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorAttendanceCheckRsvpAttendeeListView"},template:t.template(d),ui:{btnBack:"._btnBack",btnConfirm:"._btnConfirm"},events:{"click @ui.btnBack":"destroy","click @ui.btnConfirm":function(e){this.trigger(u.RSVP_ATTENDEES_SELECTED,this.collection),this.destroy()}},initialize:function(e){this.bandNo=e.bandNo,this.scheduleId=e.scheduleId,this.collection=new i.Collection(null,{model:c})},serializeCollection:function(){return this.collection?this.collection.map((function(e){return a.toRecursiveJSON(e)})):{}},onAttach:function(){l.getRsvpMembers(this.bandNo,this.scheduleId,r.ATTENDANCE).then(t.bind((function(e){var n=t.filter(e.members,(function(e){return!(e.member.is_delete||!1)}));this.collection.reset(n,{parse:!0}),this.render()}),this))}});return h.EVENT=u,h.openAsLayer=function(e,t){var n=new h({bandNo:e,scheduleId:t});return s.open(n),n},h}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.title_rsvp_attendee_list\') %>&nbsp;<span><%- items.length %></span></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="memberListBox">\n                <ul class="listLine rScroll -lrSpace">\n                    <% _.each(items, function(rsvpAttendee, index) { %>\n                    <li class="tLine flexList">\n                    <span class="thumb">\n                        <span class="uProfile -size40">\n                            <span class="profileInner">\n                                <% if (!!rsvpAttendee.member.profileImageUrl) { %><img src="<%- rsvpAttendee.member.faceThumb %>" width="40" height="40" alt="<%- rsvpAttendee.member.name %>"><% } %>\n                            </span>\n                        </span>\n                    </span>\n                        <span class="text">\n                        <span class="ellipsis"><%- rsvpAttendee.member.name %></span>\n                         <% if (rsvpAttendee.member.desc) { %>\n                        <span class="sub2 -ellipsis"><%- rsvpAttendee.member.desc %></span>\n                        <% } %>\n                        <% if (!!rsvpAttendee.member.childMembershipId) { %>\n                        <span class="sub2">\n                            <span class="memberType"><%- IM(\'web.common.child_member\') %></span><span class="name"><%= IM(\'child_member.attendance_check.attendee_owner\', {\'name\' : _.escape(rsvpAttendee.actor.name)}) %></span>\n                        </span>\n                        <% } %>\n                    </span>\n                    </li>\n                    <% }) %>\n                </ul>\n            </div>\n        </div>\n\n    </div>\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%-IM(\'ui.label.back\')%></span></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%- IM(\'web.postwrite.form_attendance_check.add_attendees.btn.add\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(4),a=n(486),r=n(626),l=n(2273),c=n(2274),d=n(491),u=n(802),h=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorAttendanceCheckAttendeeListView"},template:i.template(l),ui:{attendeeListRegion:"._attendeeListRegion",spanAttendeeCount:"._spanAttendeeCount",btnRemoveAllAttendees:"._btnRemoveAllAttendees",btnAddBandMemberAttendees:"._btnAddBandMemberAttendees",btnAddChildMemberAttendees:"._btnAddChildMemberAttendees",btnAddAttendeesFromRsvpMembers:"._btnAddAttendeesFromRsvpMembers",btnBack:"._btnBack",btnConfirm:"._btnConfirm"},regions:{attendeeListRegion:{el:"@ui.attendeeListRegion",replaceElement:!0}},events:{"click @ui.btnRemoveAllAttendees":"_removeAllAttendees","click @ui.btnAddBandMemberAttendees":function(e){this.trigger("openBandMemberAttendeeSelectionView")},"click @ui.btnAddChildMemberAttendees":function(e){this.trigger("openChildMemberAttendeeSelectionView")},"click @ui.btnAddAttendeesFromRsvpMembers":function(e){this.trigger("openRsvpAttendeeImportView")},"click @ui.btnBack":"destroy","click @ui.btnConfirm":"destroy",click:function(e){var n=t(e.target);0==n.parents('[data-viewname="DEditorAttendanceCheckAttendeeListView.AttendeeCollectionView"]').length&&"DEditorAttendanceCheckAttendeeListView.AttendeeCollectionView"!=n.attr("data-viewname")&&this.attendeeCollectionView.hideAllChildViewMenus()}},modelEvents:{"change:attendeeCount":function(e,t){this.ui.spanAttendeeCount.text(t)}},initialize:function(e){this.bandNo=e.bandNo,this.model.get("attendees").comparator=function(e){return e.get("attendee").get("name").toLowerCase()},this.model.get("attendees").sort(),this.attendeeCollectionView=new h.AttendeeCollectionView({collection:this.model.get("attendees")}),this.model.get("attendees").on("update",i.bind((function(){this.model.set("attendeeCount",this.model.get("attendees").length)}),this)),this.model.get("attendees").on("reset",i.bind((function(){this.model.set("attendeeCount",0)}),this))},onAttach:function(){d.getCachedBandData(this.bandNo).then(i.bind((function(e){this.bandData=e,this.showChildView("attendeeListRegion",this.attendeeCollectionView),this.attendeeCollectionView.on("attendee:removed",i.bind((function(e){this.model.get("attendees").remove(e.cid)}),this))}),this))},_removeAllAttendees:function(e){confirm(IM("web.postwrite.form_attendance_check.attendee_list.remove_all_confirm"))&&this.model.get("attendees").reset()}});return h.AttendeeView=s.View.extend({tagName:"li",className:"tLine flexList",attributes:{"data-viewname":"DEditorAttendanceCheckAttendeeListView.AttendeeView"},template:i.template(c),ui:{btnMenu:"._btnMenu",menusWrap:"._menusWrap",menuRemoveAttendee:"._menuRemoveAttendee"},events:{"click @ui.btnMenu":function(e){"none"!==this.ui.menusWrap.css("display")?this.hideMenu():this.showMenu()},"click @ui.menuRemoveAttendee":function(e){if(confirm(IM("web.postwrite.form_attendance_check.user_selection.remove_member_confirm")))return this.trigger("attendee:removed",this.model),!1;this.hideMenu()},click:function(e){t(e.target).hasClass("_btnMenu")||this.hideMenu(),this.trigger("clicked",this)}},templateContext:function(){return{isChildMemberAttendee:!!this.model.get("attendee").get("childMembershipId")}},serializeData:function(){return this.model.toJSON()},showMenu:function(){this.ui.menusWrap.show();var e=this.$el.scrollParent(),t=this.ui.menusWrap;r.adjustLayerPosition(e,t,"lyTop")},hideMenu:function(){this.ui.menusWrap.removeClass("lyTop"),this.ui.menusWrap.hide()}}),h.AttendeeCollectionView=s.CollectionView.extend({tagName:"ul",className:"listLine rScroll -lrSpace",attributes:{"data-viewname":"DEditorAttendanceCheckAttendeeListView.AttendeeCollectionView"},collection:new o.Collection(null,{model:u}),childView:h.AttendeeView,childViewTriggers:{"attendee:removed":"attendee:removed"},childViewEvents:{clicked:function(e){this.children.each((function(t){e.cid!=t.cid&&t.hideMenu()}))}},hideAllChildViewMenus:function(){this.children.each((function(e){e.hideMenu()}))}}),h.openAsLayer=function(e,t){var n=new h({bandNo:e,model:t});return a.open(n),n},h}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.add_attendees.title\') %>&nbsp;<span class="_spanAttendeeCount"><%- attendeeCount %></span></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="memberListBox">\n                <div class="topNoticeBar">\n                    <button type="button" class="btnDelet _btnRemoveAllAttendees"><%- IM(\'web.postwrite.form_attendance_check.attendee_list.btn_remove_all\') %></button>\n                </div>\n                <div class="addMemberAttend">\n                    <a href="#" role="button" class="button _btnAddBandMemberAttendees"><%- IM(\'web.postwrite.form_attendance_check.btn_add_members\') %></a>\n                </div>\n                <div class="addOuterMember">\n                    <a href="#" role="button" class="button _btnAddChildMemberAttendees"><%- IM(\'web.postwrite.form_attendance_check.btn_add_child_members\') %></a>\n                </div>\n                <div class="addScheduleMember">\n                    <a href="#" role="button" class="button _btnAddAttendeesFromRsvpMembers"><%- IM(\'web.postwrite.form_attendance_check.btn_add_members_from_rsvp\') %></a>\n                </div>\n                <% // 출석 멤버 목록 %>\n                <div class="_attendeeListRegion"></div>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%= IM("ui.label.prev") %></span></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<span class="thumb">\n    <span class="uProfile -size40">\n        <span class="profileInner <%- attendee.profileInnerClass %>">\n            <% if (!!attendee.profileImageUrl) { %><img src="<%- attendee.faceThumb %>" width="40" height="40" alt="<%- attendee.name %>"><% } %>\n        </span>\n    </span>\n</span>\n<span class="text">\n    <span class="ellipsis"><%- attendee.name %></span>\n    <span class="sub2 -ellipsis"><%- attendee.desc %></span>\n    <% // 외부 멤버 추가 설명 %>\n    <% if (isChildMemberAttendee) { %>\n    <span class="sub2">\n        <span class="memberType"><%- IM(\'web.common.child_member\') %></span><span class="name"><%= IM(\'child_member.attendance_check.attendee_owner\', {\'name\' : _.escape(attendeeOwner.name)}) %></span>\n    </span>\n    <% } %>\n</span>\n<span class="etc">\n    <div class="option">\n        <button type="button" class="memberSet _btnMenu"><%- IM(\'web.postwrite.form_attendance_check.member_menu_btn\') %></button>\n        <div class="lyMenu _menusWrap" style="min-width:158px;display: none">\n            <ul>\n                <li><a href="#" class="_menuRemoveAttendee"><%- IM(\'ui.label.delete\') %></a></li>\n            </ul>\n        </div>\n    </div>\n</span>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(4),a=n(486),r=n(626),l=n(2276),c=n(2277),d=n(667),u=n(501),h=n(1004),p=n(2009),m=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorAttendanceCheckManagerListView"},template:i.template(l),ui:{managerListRegion:"._managerListRegion",spanManagerCount:"._spanManagerCount",btnAddManagersFromSelection:"._btnAddManagersFromSelection",btnBack:"._btnBack",btnConfirm:"._btnConfirm"},regions:{managerListRegion:{el:"@ui.managerListRegion",replaceElement:!0}},events:{"click @ui.btnAddManagersFromSelection":"_openAddMemberLayer","click @ui.btnBack":"destroy","click @ui.btnConfirm":"destroy",click:function(e){var n=t(e.target);0==n.parents('[data-viewname="DEditorAttendanceCheckManagerListView.ManagerCollectionView"]').length&&"DEditorAttendanceCheckManagerListView.ManagerCollectionView"!=n.attr("data-viewname")&&this.managerCollectionView.hideAllChildViewMenus()}},modelEvents:{"change:managerCount":function(e,t){this.ui.spanManagerCount.text(t)}},initialize:function(e){this.bandData=e.bandData,this.bandNo=this.bandData.getBandCore().bandNo,this.model.get("managers").comparator=function(e){return e.isMyself()?"":e.get("name").toLowerCase()},this.model.get("managers").sort(),this.managerCollectionView=new m.ManagerCollectionView({collection:this.model.get("managers")}),this.model.get("managers").on("update",i.bind((function(e){this.model.set("managerCount",this.model.get("managers").length)}),this))},onAttach:function(){this.showChildView("managerListRegion",this.managerCollectionView),this.managerCollectionView.on("manager:removed",i.bind((function(e){this.model.get("managers").remove(e.cid)}),this))},_openAddMemberLayer:function(e){var t=d.CONSTANTS.MAX_MANAGER_COUNT-this.model.get("managerCount");if(t<=0)alert(IM("web.postwrite.form_attendance_check.user_selection_exceeded_alert",{count:d.CONSTANTS.MAX_MANAGER_COUNT}));else{var n=this.model.get("managers").pluck("userNo"),o=new p(null,{bandData:this.bandData,excludedUserNos:n}),s=h.openAsLayer(this.bandData,o,t,!0);this.listenToOnce(s,h.EVENT.MEMBER_SELECTED,(function(e){if(!e.isEmpty()){var t=e.map(i.bind((function(e){return new u(e.toJSON(),{parse:!0})}),this));this.model.get("managers").add(t)}})),this.listenToOnce(s,h.EVENT.SELECTION_COUNT_EXCEEDED,(function(){alert(IM("web.postwrite.form_attendance_check.user_selection_exceeded_alert",{count:d.CONSTANTS.MAX_MANAGER_COUNT}))}))}}});return m.ManagerView=s.View.extend({tagName:"li",className:"tLine flexList",attributes:{"data-viewname":"DEditorAttendanceCheckManagerListView.ManagerView"},template:i.template(c),ui:{btnMenu:"._btnMenu",menusWrap:"._menusWrap",menuRemoveManager:"._menuRemoveManager"},events:{"click @ui.btnMenu":function(e){"none"!==this.ui.menusWrap.css("display")?this.hideMenu():this.showMenu()},"click @ui.menuRemoveManager":function(e){if(confirm(IM("web.postwrite.form_attendance_check.user_selection.remove_member_confirm")))return this.trigger("manager:removed",this.model),!1;this.hideMenu()},click:function(e){t(e.target).hasClass("_btnMenu")||this.hideMenu(),this.trigger("clicked",this)}},templateContext:function(){return{isLoginUser:this.model.isMyself()}},showMenu:function(){this.ui.menusWrap.show();var e=this.$el.scrollParent(),t=this.ui.menusWrap;r.adjustLayerPosition(e,t,"lyTop")},hideMenu:function(){this.ui.menusWrap.removeClass("lyTop"),this.ui.menusWrap.hide()}}),m.ManagerCollectionView=s.CollectionView.extend({tagName:"ul",className:"listLine rScroll -lrSpace",attributes:{"data-viewname":"DEditorAttendanceCheckManagerListView.ManagerCollectionView"},collection:new o.Collection(null,{model:u}),childView:m.ManagerView,childViewTriggers:{"manager:removed":"manager:removed"},childViewEvents:{clicked:function(e){this.children.each((function(t){e.cid!=t.cid&&t.hideMenu()}))}},hideAllChildViewMenus:function(){this.children.each((function(e){e.hideMenu()}))}}),m.openAsLayer=function(e,t){var n=new m({bandData:e,model:t});return a.open(n),n},m}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.add_managers.title\') %>&nbsp;<span class="_spanManagerCount"><%- managerCount %></span></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="memberListBox">\n                <div class="addMemberAttend">\n                    <a href="#" role="button" class="button _btnAddManagersFromSelection"><%- IM(\'web.postwrite.form_attendance_check.btn_add_members\') %></a>\n                </div>\n                <% // 출석 관리자 목록 %>\n                <div class="_managerListRegion"></div>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine gMal0 gMar0">\n\t\t<button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%= IM("ui.label.prev") %></span></button>\n\t\t<button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<span class="thumb">\n    <span class="uProfile -size40">\n        <span class="profileInner <%- profileInnerClass %>">\n            <% if (!!profileImageUrl) { %><img src="<%- faceThumb %>" width="40" height="40" alt="<%- name %>"><% } %>\n        </span>\n    </span>\n</span>\n<span class="text">\n    <span class="ellipsis"><%- name %></span>\n    <span class="sub2 -ellipsis"><%- desc %></span>\n</span>\n<% if (!isLoginUser) { %>\n<span class="etc">\n    <div class="option">\n        <button type="button" class="memberSet _btnMenu"><%- IM(\'web.postwrite.form_attendance_check.member_menu_btn\') %></button>\n        <div class="lyMenu _menusWrap" style="min-width:158px;display: none">\n            <ul>\n                <li><a href="#" class="_menuRemoveManager"><%- IM(\'ui.label.delete\') %></a></li>\n            </ul>\n        </div>\n    </div>\n</span>\n<% } %>'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%= IM("ui.label.add_child_member") %></h1>\n    </header>\n\n    <div class="modalBody -spaceNone">\n        <div data-viewname="DEditorAttendanceCheckChildMemberSelectionView" class="modalContentWrap gPal0 gPar0">\n            <form class="searchWrap _formChildMemberAdd">\n                <label for="childMemberNameInput" class="gSrOnly"><%= IM("ui.label.input_name") %></label>\n                <span class="inputWrap">\n                    <input type="text" id="childMemberNameInput" class="inputSearch _childMemberNameInput" maxlength="<%= nameMaxCount %>" placeholder="<%= IM("ui.label.input_name") %>">\n                </span>\n                <button type="button" class="btnSearch uButton -sizeS -default -disabled _btnAddChildMember" disabled=""><%= IM("ui.label.add") %></button>\n            </form>\n            <p class="uEmpty -h400 _descriptionForEmpty" style="display:none">\n                <span class="gWordKeep"><%= IM("band.do_it.add_child_member") %></span>\n            </p>\n            <div class="rScroll -lrSpace -h400 -tLine gMat-1 _childMemberListRegionWrap">\n            </div>\n        </div>\n    </div>\n\n    <footer class="modalFooter -tLine gMar0 gMal0">\n        <button type="button" class="uButton -cancel _cancelBtn"><%= IM("ui.label.cancel") %></button>\n        <button type="button" class="uButton -confirm _confirmBtn -disabled" disabled="disabled"><%= IM("ui.label.confirm") %><span class="_selectChildMemberCount"></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(2280);return t.View.extend({tagName:"li",className:"tLine",attributes:{"data-viewname":"DBandChildMemberItemView"},ui:{checkInput:"._checkInput",checkboxIcon:"._checkboxIcon",btnDeleteChildMember:"._btnDeleteChildMember"},events:{"click @ui.checkInput":function(){this.model.setIsSelected(!this.model.getIsSelected()),this.trigger("childMemberItemView:selectMember",this.model)},"click @ui.btnDeleteChildMember":function(){confirm(IM("ui.confirm.delete"))&&this.trigger("childMemberItemView:deleteMember",this.model)}},onAttach:function(){this.model.get("isDisabled")&&(this.getUI("checkboxIcon").addClass("-disabled"),this.getUI("checkInput").attr("disabled","disabled")),this.getUI("checkInput").attr("checked",this.model.getIsSelected())},template:i.template(o)})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="outerMemberItemWrap">\n    <label class="flexList">\n        <span class="etc">\n            <span class="uCheck -checkbox -noLabel _checkboxIcon">\n                <input type="checkbox" id="uCheck" class="checkInput _checkInput">\n                <span class="checkLabel">\n                    <span class="shape "></span>\n                </span>\n            </span>\n        </span>\n        <span class="text">\n            <span class="ellipsis"><%- name %></span>\n        </span>\n    </label>\n    <button type="button" class="uButton -iconListRemove _btnDeleteChildMember"><span class="gSrOnly"><%= IM("ui.label.delete") %></span></button>\n</div>'},function(e,t,n){var i=n(563),o=n(2282),s=n(152),a=n(2010),r=n(799);e.exports=function(e,t,n){r.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.ADDON,apiType:"addon",createModelFromJSON:i.createAddonByJSON,createWidgetView:function(e,t){return new o({model:t,el:e,allowedAddonCollection:n})},onWidgetModify:r.createLayoutModify((function(e){var i=n.findAllowedAddonModelByType(e.getAddonType());return a.openAddonAttachLayer(i,!0,t.getBandNo(),t.getPostNo(),e.getPostAddonId(),e.getOneTimeToken())}))},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2283),s=n(2284);return i.View.extend({attributes:{"data-viewname":"AddonWidgetView"},ui:{btnModify:"._btnModify",btnDelete:"._btnDelete"},triggers:{"click @ui.btnModify":"modify","click @ui.btnDelete":"remove"},initialize:function(e){this._allowedAddonCollection=e.allowedAddonCollection,this._allowedAddonModel=this._allowedAddonCollection.findAllowedAddonModelByType(this.model.getAddonType()),this._unknownAddon=t.isEmpty(this._allowedAddonModel)||!this.model.isSupportVersion()},getTemplate:function(){return this._unknownAddon?t.template(s):t.template(o)},serializeData:function(){return this._unknownAddon?{}:{addonName:this._allowedAddonModel.getLocaleName(),description:this.model.getDescription()}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _btnModify"><%- IM("ui.label.modify") %></button>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -markdown">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-markdown sf_color" aria-hidden="true">\n                        <use xlink:href="#ico-markdown-attachment"></use>\n                    </svg>\n                    <span class="status sf_color"><%- addonName %></span>\n                </p>\n                <p class="subTxt"><%- description %></p>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -addon">\n            <div class="addHead">\n                <p class="addStatus"></p>\n                <p class="addTitle -noSvgMsg"><%- IM("web.post.subpost.alert.not_supported_in_web") %></p>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="lyContent -postWriteStyle" style="width:600px;height:510px;margin-top:77px;">\n    <div class="_addonLoadingRegion"></div>\n<% if ( dataFetched ) { %>\n    <iframe src="<%- addonUri %>" class="addonEditorIframe _addonEditorIframe" style="height:1px;"></iframe>\n<% } %>\n</div>'},function(e,t,n){var i=n(0),o=n(563),s=n(2287),a=n(1177),r=n(152),l=n(799);e.exports=function(e,t){l.injectAttachmentWidget({postSpecType:r.POST_ATTACHMENT_TYPE.LOCATION,apiType:"location",createModelFromJSON:o.createLocationByJSON,createWidgetView:l.widgetViewCreator(s),onWidgetModify:function(e,t,n){a.asyncOpenDSelectLocationLayer({latitude:e.get("latitude"),longitude:e.get("longitude"),address:e.get("address"),name:e.get("name")}).then(i.bind((function(e){this.view.listenTo(e,"locationSelected",i.bind((function(n){e.destroy();var i=o.createLocation(n);t(i)}),this)),this.view.listenTo(e,"destroy",i.bind((function(e){n()}),this))}),this),n)}},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2288);return i.View.extend({attributes:{"data-viewname":"LocationWidgetView"},template:t.template(o),ui:{btnModify:"._btnModify",btnDelete:"._btnDelete"},triggers:{"click @ui.btnModify":"modify","click @ui.btnDelete":"remove"}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _btnModify"><%- IM("ui.label.modify") %></button>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -map">\n            <img src="/dres/images/e_images/ico-post-attach-location.png" srcset="/dres/images/e_images/2x/ico-post-attach-location.png 2x" alt="" class="imgMap">\n            <% if (name) { %>\n            <p class="addTitle"><%- name %></p>\n            <% } %>\n            <p class="subTxt"><%- address %></p>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){var i=n(563),o=n(2290),s=n(152),a=n(799),r=n(2292);e.exports=function(e,t){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.SUBPOST,apiType:"subpost",createModelFromJSON:i.createSubpostByJSON,createWidgetView:a.widgetViewCreator(o),callback:function(e){r(e)}},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(82),s=n(2291);return i.View.extend({className:"",attributes:{"data-viewname":"SubpostWidgetView"},template:t.template(s),ui:{btnDelete:"._btnDelete"},triggers:{"click @ui.btnDelete":"remove"},serializeData:function(){return{snippetImage:this.model.get("image"),thumbnailUrl:o.make(this.model.get("image"),o.TYPE.s150),title:this.model.get("title"),description:this.model.get("description"),subtitle:this.model.get("subtitle")}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="snippet" data-thumbnail="<% if (snippetImage) { %>type1<% } else { %>false<% } %>">\n            <% if (snippetImage) { %>\n            <span class="snippetThumb">\n                <img src="<%- thumbnailUrl %>" alt="<%- title %>" class="thumb">\n            </span>\n            <% } %>\n            <span class="snippetInfo">\n                <span class="snippetTit -multiline"><%- title %></span>\n                <span class="snippetTxt -multiline"><%- description %></span>\n                <span class="snippetLink"><%- subtitle %></span>\n            </span>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){return function(e){e.element.addClass("_disable_remove"),e.on("key",(function(e){var t=e.data.keyCode;if(8==t||46==t||t==CKEDITOR.CTRL+88||t==CKEDITOR.CTRL+86)return console.log("remove disabled"),!1}))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(563),o=n(2294),s=n(152),a=n(799);e.exports=function(e,t,n,r){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.SNIPPET,apiType:"snippet",createModelFromJSON:i.createSnippetByJSON,createWidgetView:function(e,t){return new o({model:t,el:e,editMode:n,bandData:r})}},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2295),s=n(2296),a=n(718),r=n(885),l=n(633),c=n(906);return n(502),i.View.extend({attributes:{"data-viewname":"SnippetWidgetView"},template:t.template(o),ui:{btnModify:"._btnModify",btnDelete:"._btnDelete",btnThumbDelete:"._btnThumbDelete",thumbnailWrapper:"._thumbnailWrapper",btnViewSmaller:"._btnViewSmaller",thumb:"._thumb"},events:{"click @ui.btnThumbDelete":function(){return this.getUI("thumbnailWrapper").closest("[data-thumbnail]").attr("data-thumbnail","false"),this.getUI("thumbnailWrapper").remove(),this.getUI("btnViewSmaller").remove(),this.model.deleteRichSnippetImage(),this._changedSnippet(),!1},"click @ui.btnModify":function(){var e=this.model.pick("title","description","image","imageWidth","imageHeight","authorizedFeature");this.listenToOnce(s.openLayer({snippet:e,bandData:this._bandData}),"editor:snippet:attach",(function(e){this.model.setRichSnippetAttributes(e),this.render()}))},"click @ui.btnViewSmaller":function(){this.model.setRichSnippetAttributes({imageType:l.SNIPPET_VIEW_TYPE.SMALL}),this.render()}},triggers:{"click @ui.btnDelete":"remove"},serializeData:function(){var e=this.model.toJSON(),n=e.authorizedFeature?e.authorizedFeature.footerText:e.domain,i=r.buildPostSnippetViewData({model:this.model}),o=i.getPostSnippetImageType();return t.extend(e,{footerText:n,imageType:o,thumbnailUrl:i.getPostSnippetImageUrl(),showViewSmallerButton:o===l.TYPE_WIDTH_IS_LONGER,editable:this._editable})},initialize:function(e){this._bandData=e.bandData,this._editable=(this._bandData.canEditNormalSnippet()||this._bandData.canEditExtendedSnippet())&&this._isNewOrModify(e.editMode)},onRender:function(){this.getUI("thumb").setLoading({tag:'<p class="uLoading -widget"><img src="'+window.resBaseUrl+'/images/common/loading.gif" width="32" height="32" alt="loading" /></p>'}).one("setLoading:done",t.bind(this._changedSnippet,this))},_changedSnippet:function(){this.trigger(c.EVENT.WIDGET_MEDIA_LOADED)},_isNewOrModify:function(e){return e===a.EDIT_MODE.NEW||e===a.EDIT_MODE.MODIFY}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <% if (editable) { %>\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _btnModify"><%= IM(\'ui.label.modify\') %></button>\n    <% } %>\n    <% if (showViewSmallerButton) { %>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnViewSmaller"><%- IM(\'ui.label.view_smaller\') %></button>\n    <% } %>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="snippet" data-thumbnail="<%= imageType ? imageType : \'false\' %>">\n            <% if (thumbnailUrl) { %>\n            <span class="_thumbnailWrapper snippetThumb<%= type === \'video\' ? \' player\' : \'\' %>">\n                <img src="<%- thumbnailUrl %>" alt="<%- title %>" class="thumb _thumb">\n                <button type="button" class="_btnThumbDelete delete"><span class="gSrOnly"><%- IM("ui.label.delete") %></span></button>\n            </span>\n            <% } %>\n            <span class="snippetInfo">\n                <span class="snippetTit -multiline"><%- title %></span>\n                <% if (description) { %>\n                <span class="snippetTxt -multiline"><%- description %></span>\n                <% } %>\n                <% if (footerText) { %>\n                <span class="snippetLink"><%- footerText %></span>\n                <% } %>\n            </span>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(2297),a=n(486),r=n(82),l=n(600),c=n(507),d=t.template('<span class="cell"><img src="<%- image %>" alt="<%- IM("editor.snippet_editing.body.image") %>" class="thumb <%-type%>"></span>'),u=t.template('<span class="noImg"><%= IM("ui.label.no_image") %></span>'),h=o.View.extend({tagName:"section",className:"lyWrap -liteBg",attributes:{"data-viewname":"DEditorSnippetAttachView"},template:t.template(s),templateContext:function(){return{hasEditExtendedSnippetPermission:this._bandData.canEditExtendedSnippet()}},ui:{imageWrap:"._imageWrap",imageDelBtn:"._imageDelBtn",imageUpBtn:"._imageUpBtn",titleTextarea:"._titleTextarea",descriptionTextarea:"._descriptionTextarea",confirmBtn:"._confirmBtn",closeBtn:"._closeBtn",footerText:"._footerText",webURL:"._webURL",androidURL:"._androidURL",iosURL:"._iosURL"},events:{"click @ui.imageDelBtn":function(){this._snippet.image=null,this._snippet.imageWidth=null,this._snippet.imageHeight=null,this._renderImage()},"click @ui.confirmBtn":function(){var e=this._extractSnippetInfo(),t=this._validateEditedSnippet(e);if(t)return alert(t.message),void t.$invalidElement.focus();this.trigger("editor:snippet:attach",e),this.destroy()},"click @ui.closeBtn":function(){confirm(IM("ui.confirm.cancel_editing"))&&(this.trigger("editor:snippet:cancel"),this.destroy())}},serializeData:function(){return t.extend({viewId:this.cid,titleMax:150,descriptionMax:210},this._snippet)},onRender:function(){this._renderImage()},onAttach:function(){this._createPhotoUploader()},onBeforeDetach:function(){this._destroyPhotoUploader()},initialize:function(e){this._snippet=t.extend({image:null,title:null,description:null,imageWidth:null,imageHeight:null,authorizedFeature:null},e.snippet),this._bandData=e.bandData},_extractSnippetInfo:function(){var e={image:this._snippet.image,imageWidth:this._snippet.imageWidth,imageHeight:this._snippet.imageHeight,title:i.trim(this.ui.titleTextarea.val()).substring(0,150),description:i.trim(this.ui.descriptionTextarea.val()).substring(0,210)||null},t=i.trim(this.getUI("webURL").val()),n=i.trim(this.getUI("androidURL").val()),o=i.trim(this.getUI("iosURL").val()),s=null;(t||n||o)&&(s={pc:t,android:n,ios:o});var a=i.trim(this.getUI("footerText").val())||null;return e.authorizedFeature=null,(s||a)&&(e.authorizedFeature={action:s,footerText:a}),e},_validateEditedSnippet:function(e){return e.title?this._validateSnippetAuthorizedFeature(e.authorizedFeature):{message:IM("editor.snippet_editing.body.required_title"),$invalidElement:this.ui.titleTextarea}},_validateSnippetAuthorizedFeature:function(e){if(!e||!e.action||e.action.pc||e.action.android||e.action.ios||(e.action=null),!e||e.footerText||e.action||(e=null),e){if(e.footerText&&!e.action)return{message:IM("extended_snippet.invalid.action_urls_required"),$invalidElement:this.getUI("webURL")};var t=e.action;if(t)return!t.pc||t.android||t.ios?!t.android&&t.ios?{message:IM("extended_snippet.invalid.android_url_required"),$invalidElement:this.getUI("androidURL")}:t.android&&!t.ios?{message:IM("extended_snippet.invalid.ios_url_required"),$invalidElement:this.getUI("iosURL")}:!t.pc||i.startsWith(t.pc,"http://")||i.startsWith(t.pc,"https://")?!t.android||i.startsWith(t.android,"bandapp://")||i.startsWith(t.android,"http://")||i.startsWith(t.android,"https://")?!t.ios||i.startsWith(t.ios,"bandapp://")||i.startsWith(t.ios,"http://")||i.startsWith(t.ios,"https://")?void 0:{message:IM("extended_snippet.invalid.ios_field"),$invalidElement:this.getUI("iosURL")}:{message:IM("extended_snippet.invalid.android_field"),$invalidElement:this.getUI("androidURL")}:{message:IM("extended_snippet.invalid.web_field"),$invalidElement:this.getUI("webURL")}:{message:IM("extended_snippet.invalid.app_url_required"),$invalidElement:this.getUI("androidURL")}}},_renderImage:function(){var e=this._snippet.image,t=e?d:u,n="";if(e){var i=this._snippet.imageWidth,o=this._snippet.imageHeight;n=i<o?"type2":i==o?"type1":"type3"}this.ui.imageWrap.html(t({image:r.make(e,r.TYPE.original),type:n}))},_createPhotoUploader:function(){this._destroyPhotoUploader(),this._photoUploader=l.createPhotoUploader(this.ui.imageUpBtn,{multiple:!1,showProgress:!0,autoUpload:!0,fileInputTitle:IM("editor.snippet_editing.body.image"),skinColor:this._bandData.getBandCore().getSkinColorClass(),data:{band_no:this._bandData.getBandNo()}}),this.listenTo(this._photoUploader,c.BEFORE_UPLOAD,t.bind((function(){}),this)),this.listenTo(this._photoUploader,c.UPLOAD_COMPLETE,t.bind((function(e){var n=t.first(t.propertyOf(e)("resultList"));n&&(this._snippet.image=n.url,this._snippet.imageWidth=n.width,this._snippet.imageHeight=n.height,this._renderImage())}),this))},_destroyPhotoUploader:function(){this._photoUploader&&(this._photoUploader.destroy(),this._photoUploader=null)}});return h.openLayer=function(e){var t=new h(e);return a.openWithoutHiding(t),t},h}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="modalHeader">\n        <h1 class="title"><%= IM(\'editor.snippet_editing.header.title\') %></h1>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gMat20">\n            <div class="snippetModify">\n                <div class="snippetWrap">\n                    <span class="snippetThumb _imageWrap"></span>\n                </div>\n                <p class="btnSet">\n                    <button type="button" class="uButton -sizeS -del _imageDelBtn"><%= IM(\'ui.label.delete\') %></button>\n                    <label for="imgFile<%- viewId %>" class="uButton -sizeS sf_bg -modify _imageUpBtn"><%= IM(\'ui.label.change\') %><input type="file" id="imgFile<%- viewId %>" accept="image/*" name="attachment"></label>\n                </p>\n                <form action="">\n                    <fieldset class="formField">\n                        <legend class="gSrOnly"><%= IM(\'editor.snippet_editing.body.sr_text\') %></legend>\n                        <p class="uTextarea">\n                            <label for="title<%- viewId %>" class="gSrOnly"><%= IM(\'editor.snippet_editing.body.title\') %></label>\n                            <textarea class="_titleTextarea" maxlength="<%- titleMax %>" cols="10" rows="1" id="title<%- viewId %>" placeholder="<%- IM(\'editor.snippet_editing.body.title\') %> (<%- IM(\'ui.label.required_input\') %>)"><%- title %></textarea>\n                            <span class="border"></span>\n                        </p>\n                        <p class="uTextarea">\n                            <label for="contents<%- viewId %>" class="gSrOnly"><%= IM(\'editor.snippet_editing.body.description\') %></label>\n                            <textarea class="_descriptionTextarea" maxlength="<%- descriptionMax %>" cols="10" rows="3" id="contents<%- viewId %>" placeholder="<%- IM(\'editor.snippet_editing.body.description\') %>"><%- description %></textarea>\n                            <span class="border"></span>\n                        </p>\n                        <% if (hasEditExtendedSnippetPermission) { %>\n                        <p class="uInput gMat11 -h40">\n                            <label for="footerText<%- viewId %>" class="gSrOnly">Footer Text</label>\n                            <input class="_footerText" type="text" id="footerText<%- viewId %>" placeholder="Footer Text" value="<%- authorizedFeature && authorizedFeature.footerText %>"/>\n                            <span class="border"></span>\n                        </p>\n                        <p class="uInput gMat10 -h40">\n                            <label for="webURL<%- viewId %>" class="gSrOnly">Web URL</label>\n                            <input class="_webURL" type="text" id="webURL<%- viewId %>" placeholder="Web URL" value="<%- authorizedFeature && authorizedFeature.action && authorizedFeature.action.pc %>" />\n                            <span class="border"></span>\n                        </p>\n                        <p class="uInput gMat10 -h40">\n                            <label for="androidURL<%- viewId %>" class="gSrOnly">Android URL</label>\n                            <input class="_androidURL" type="text" id="androidURL<%- viewId %>" placeholder="Android URL" value="<%- authorizedFeature && authorizedFeature.action && authorizedFeature.action.android %>" />\n                            <span class="border"></span>\n                        </p>\n                        <p class="uInput gMat10 -h40">\n                            <label for="iosURL<%- viewId %>" class="gSrOnly">iOS URL</label>\n                            <input class="_iosURL" type="text" id="iosURL<%- viewId %>" placeholder="iOS URL" value="<%- authorizedFeature && authorizedFeature.action && authorizedFeature.action.ios %>" />\n                            <span class="border"></span>\n                        </p>\n                        <% } %>\n\n                    </fieldset>\n                </form>\n            </div>\n        </div>\n\n    </div>\n\n    <footer class="modalFooter gMat3">\n        <button type="button" class="uButton -confirm _confirmBtn"><%= IM(\'ui.label.confirm\') %></button>\n        <button type="button" class="btnLyClose uButton -iconClose _closeBtn"><span class="gSrOnly"><%= IM(\'ui.label.close_layer\') %></span></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(563),o=n(2299),s=n(152),a=n(799);e.exports=function(e,t){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.SHARED_POST_SNIPPET,apiType:"shared_post_snippet",createModelFromJSON:i.createSharedPostSnippetModelByJSON,createWidgetView:a.widgetViewCreator(o)},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=(n(1616),n(2300)),s=n(82),a=n(164);return i.View.extend({attributes:{"data-viewname":"SharedPostSnippetWidgetView"},template:t.template(o),ui:{btnDelete:"._btnDelete"},triggers:{"click @ui.btnDelete":"remove"},initialize:function(e){this.sharedPostSnippetModel=e.model},serializeData:function(){var e=this.model.isSourcePostUnavailable()?null:s.make(this.sharedPostSnippetModel.get("image"),a.s150);return{isSourcePostUnavailable:this.model.isSourcePostUnavailable(),thumbnailType:this._getThumbnailType(),snippetImage:e,isPlayButtonVisible:this.sharedPostSnippetModel.get("isPlayButtonVisible"),bandName:this.sharedPostSnippetModel.get("band").get("name"),snippetContents:this.sharedPostSnippetModel.get("body")}},_getThumbnailType:function(){return this.model.isSourcePostUnavailable()?"type0":null!=this.sharedPostSnippetModel.get("image")?"type1":"false"}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="snippet" data-thumbnail="<%- thumbnailType %>">\n            <% if (snippetImage) { %>\n            <span class="snippetThumb<%= isPlayButtonVisible ? \' player\' : \'\' %>">\n                <img src="<%- snippetImage %>" alt="<%- bandName %>" class="thumb">\n            </span>\n            <% } %>\n            <span class="snippetInfo">\n                <% if (isSourcePostUnavailable) { %>\n                <span class="snippetTxt"><%= IM(\'web.postdetail.shared.not_exist_post\') %></span>\n                <% } else { %>\n                <span class="snippetTit -multi3line"><%- snippetContents %></span>\n                <span class="snippetLink">[BAND] <%- bandName %></span>\n                <% } %>\n            </span>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){var i=n(563),o=n(152),s=n(2302),a=n(799);e.exports=function(e,t){a.injectAttachmentWidget({postSpecType:o.POST_ATTACHMENT_TYPE.SHARED_PAGE_POST_SNIPPET,apiType:"shared_page_post_snippet",createModelFromJSON:i.createSharedPagePostSnippetModelByJSON,createWidgetView:a.widgetViewCreator(s)},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=(n(1616),n(82)),s=n(164),a=n(2303);return i.View.extend({attributes:{"data-viewname":"SharedPagePostSnippetWidgetView"},template:t.template(a),ui:{btnDelete:"._btnDelete"},triggers:{"click @ui.btnDelete":"remove"},initialize:function(e){this.sharedPagePostSnippetModel=e.model},serializeData:function(){var e=this.model.isSourcePostUnavailable()?null:o.make(this.sharedPagePostSnippetModel.get("image"),s.s150);return{isSourcePostUnavailable:this.model.isSourcePostUnavailable(),thumbnailType:this._getThumbnailType(),snippetImage:e,isPlayButtonVisible:this.sharedPagePostSnippetModel.get("isPlayButtonVisible"),bandName:this.sharedPagePostSnippetModel.get("band").get("name"),snippetContents:this.sharedPagePostSnippetModel.get("body")}},_getThumbnailType:function(){return this.model.isSourcePostUnavailable()?"type0":null!=this.sharedPagePostSnippetModel.get("image")?"type1":"false"}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="snippet" data-thumbnail="<%- thumbnailType %>">\n            <% if (snippetImage) { %>\n            <span class="snippetThumb<%= isPlayButtonVisible ? \' player\' : \'\' %>">\n                <img src="<%- snippetImage %>" alt="<%- bandName %>" class="thumb">\n            </span>\n            <% } %>\n            <span class="snippetInfo">\n                <% if (isSourcePostUnavailable) { %>\n                <span class="snippetTxt"><%= IM(\'web.postdetail.shared.not_exist_post\') %></span>\n                <% } else { %>\n                <span class="snippetTit -multi3line"><%- snippetContents %></span>\n                <span class="snippetLink"><%- bandName %> - BAND Page</span>\n                <% } %>\n            </span>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){var i=n(563),o=n(2305),s=n(152),a=n(799);e.exports=function(e,t){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.PROMOTION_PHOTO,apiType:"promotion_photo",createModelFromJSON:i.createPromotionPhotoByJSON,createWidgetView:a.widgetViewCreator(o),dragHandlerWidth:function(e){return e.model.get("width")}},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2306);return i.View.extend({className:"",attributes:{"data-viewname":"PromotionPhotoWidgetView"},template:t.template(o),ui:{btnDelete:"._btnDelete"},triggers:{"click @ui.btnDelete":"remove"}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM(\'ui.label.delete\') %></button>\n</div>\n<div class="bandWidgetContent sf_tOutline">\n    <img src="<%- url %>" width="<%- width %>" class="_thumbnail" alt="<%- IM(\'photo\') %>">\n</div>\n'},function(e,t,n){var i=n(563),o=n(2308),s=n(152),a=n(799);e.exports=function(e,t,n){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.PHOTO,apiType:"photo",createModelFromJSON:i.createPhotoByJSON,createWidgetView:function(i,s){return new o({model:s,el:i,postModel:t,albumSelectable:n,editor:e})},dragHandlerWidth:function(e){return e.model.get("width")}},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2309),s=n(82),a=n(164),r=n(2011),l=n(156),c=n(906);return n(502),i.View.extend({attributes:{"data-viewname":"PhotoWidgetView"},template:t.template(o),ui:{btnDelete:"._btnDelete",thumbnail:"._thumbnail",bandWidgetContent:"._bandWidgetContent"},behaviors:function(){return{AlbumSettingBehavior:{behaviorClass:r,postModel:this.options.postModel,editor:this.options.editor}}},triggers:{"click @ui.btnDelete":"remove"},serializeData:function(){return t.extend(this.model.toJSON(),{albumSelectable:1==this.options.albumSelectable,albumSelected:!!this.options.postModel.get("album"),thumbnailUrl:s.make(this.model.get("photoUrl"),a.w520),isGif:l.isGif(this.model.get("photoUrl"))})},onRender:function(){this.ui.thumbnail.setLoading({tag:'<p class="uLoading -widget"><img src="'+window.resBaseUrl+'/images/common/loading.gif" width="32" height="32" alt="loading"  /></p>'}).one("setLoading:done",t.bind((function(){this.trigger(c.EVENT.WIDGET_MEDIA_LOADED)}),this)).one("setLoading:fail",t.bind((function(){this.getUI("bandWidgetContent").addClass("-thumbError"),this.trigger(c.EVENT.WIDGET_MEDIA_LOADED)}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <% if ( albumSelectable ) { %>\n    <button type="button" class="bandWidgetBtn uButton -sizeS -change _btnChangeAlbum">\n        <% if (albumSelected) { %><%- IM(\'change_album\') %><% } else { %><%- IM(\'select_album\') %><% } %>\n    </button>\n    <% } %>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM(\'ui.label.delete\') %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline _bandWidgetContent <%- isGif ? \'-gif\' : \'\' %>">\n    <img src="<%- thumbnailUrl %>" class="_thumbnail" alt="<%- IM(\'photo\') %>">\n</div>\n'},function(e,t,n){var i=n(563),o=n(2311),s=n(152),a=n(799);e.exports=function(e,t,n){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.VIDEO,apiType:"video",createModelFromJSON:i.createVideoByJSON,createWidgetView:function(i,s){return new o({model:s,el:i,postModel:t,albumSelectable:n,editor:e})},dragHandlerWidth:function(e){return e.model.get("width")}},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2312),s=n(164),a=n(82),r=n(2011),l=n(906);return n(502),i.View.extend({attributes:{"data-viewname":"VideoWidgetView"},template:t.template(o),ui:{btnDelete:"._btnDelete",thumbnail:"._thumbnail",bandWidgetContent:"._bandWidgetContent"},behaviors:function(){return{AlbumSettingBehavior:{behaviorClass:r,postModel:this.options.postModel,editor:this.options.editor}}},triggers:{"click @ui.btnDelete":"remove"},serializeData:function(){return t.extend(this.model.toJSON(),{albumSelectable:1==this.options.albumSelectable,albumSelected:!!this.options.postModel.get("album"),thumbnailUrl:a.make(this.model.get("logoImage"),s.w520)})},onRender:function(){this.getUI("thumbnail").setLoading({tag:'<p class="uLoading -widget"><img src="'+window.resBaseUrl+'/images/common/loading.gif" width="32" height="32" alt="loading"></p>'}).one("setLoading:done",t.bind((function(){this.trigger(l.EVENT.WIDGET_MEDIA_LOADED)}),this)).one("setLoading:fail",t.bind((function(){this.getUI("bandWidgetContent").addClass("-thumbError"),this.trigger(l.EVENT.WIDGET_MEDIA_LOADED)}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% if(isLive) { %>\n<div class="liveState -finished">\n    <span class="liveStateText"><%= IM(\'ui.label.live_end\') %></span>\n</div>\n<% } %>\n<div class="bandWidgetBtnWrap">\n    <% if ( albumSelectable ) { %>\n    <button type="button" class="bandWidgetBtn uButton -sizeS -change _btnChangeAlbum">\n        <% if (albumSelected) { %><%- IM(\'change_album\') %><% } else { %><%- IM(\'select_album\') %><% } %>\n    </button>\n    <% } %>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM(\'ui.label.delete\') %></button>\n</div>\n<div class="bandWidgetContent sf_tOutline _bandWidgetContent <%- isGif ? \'-gif\' : \'-player\' %>">\n    <img src="<%- thumbnailUrl %>" class="_thumbnail" alt="<%= IM(\'video\') %>">\n</div>'},function(e,t,n){var i=n(563),o=n(1630),s=n(152),a=n(799);e.exports=function(e,t){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.FILE,apiType:"file",createModelFromJSON:i.createFileByJSON,createWidgetView:function(e,n){return new o({model:n,el:e,postModel:t})}},e,t)}},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <% if (folderBtn) { %>\n    <button type="button" class="bandWidgetBtn -modify uButton -sizeS sf_bg _folderBtn"><%- IM(\'file.move_to_another_folder\') %></button>\n    <% } %>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM(\'ui.label.delete\') %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -file">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-file sf_color" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-file-22"></use>\n                    </svg>\n                    <span class="status sf_color"><%= outputFileType %></span>\n                </p>\n                <p class="addTitle"><%- title %></p>\n                <% if ( typeof isRestricted != \'undefined\' && isRestricted ) { %>\n                <p class="addStatus -error"><%- IM(\'upload_disabled\') %></p>\n                <% } %>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'file.move_to_another_folder\') %></h1>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gPa0">\n            <div class="folderArea">\n                <div class="fileFolderBox">\n                    <% if (newFolderBtn) { %>\n                    <div class="uploadButtonBox">\n                        <button type="button" class="uploadButton _newFolderBtn">\n                            <div class="folderIcon">\n                                <svg class="svgIcon" aria-hidden="true">\n                                    <use xlink:href="#ico-folder"></use>\n                                </svg>\n                            </div>\n                            <%- IM(\'file.create_new_folder\') %>\n                        </button>\n                    </div>\n                    <% } %>\n\n                    <div style="height:270px;overflow-y:auto">\n                        <div class="_folderList" style="display:none"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <footer class="modalFooter -tLine gMar0 gMal0">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton _confirmBtn"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(4),s=n(2317),a=n(1052),r=n(156),l=o.View.extend({tagName:"li",className:"cFolderItem uFlexItem",attributes:{"data-viewname":"DBandFolderItemView"},template:i.template(s),ui:{checkbox:"._checkbox"},events:{"change @ui.checkbox":function(){this.trigger("folder:checked",{folder:this.model,checked:this.ui.checkbox.prop("checked")})}},modelEvents:{"folder:checked":function(e){this.ui.checkbox.prop("checked",e)}},initialize:function(e){this._bandData=e.bandData,this._checkable=e.checkable,this._checked=e.checked||!1,this._bandNo=this._bandData.getBandCore().bandNo},serializeData:function(){var e=this.model.getFolderLatestFileCreatedAt()||this.model.getFolderCreatedAt(),t=this.model.getFolderFileCount();return{viewId:this.cid,checkable:this._checkable,checked:this._checked,url:this._checkable?null:a.getFolderUrl(this._bandNo,this.model),name:this._escapeSearchResult(this.model.getFolderName()),date:r.formatFileDate(e),count:IM("file.folder_file_count",{count:t||"0"})}},_escapeSearchResult:function(e){return i.escape(e).replace(/&lt;strong&gt;(.*?)&lt;\/strong&gt;/g,"<strong>$1</strong>")}});e.exports=l},function(e,t){e.exports='<div class="folderIcon">\n    <svg class="svgIcon" aria-hidden="true">\n        <use xlink:href="#ico-folder"></use>\n    </svg>\n</div>\n<div class="body">\n    <span class="text -ellipsis gFw4"><%= name /* 태그 있음 */ %></span>\n    <span class="subText -ellipsis"><span class="creationDate"><%- date %></span><span class="files"><%- count %></span></span>\n</div>\n<% if (url) { %>\n<a href="<%- url %>" class="cFolderItemLink"></a>\n<% } %>\n<% if (checkable) { %>\n<div class="etc">\n    <label for="uCheck_<%- viewId %>" class="uCheck -checkbox">\n        <input type="checkbox" id="uCheck_<%- viewId %>" class="checkInput _checkbox" <%- checked ? \'checked\' : \'\' %>>\n        <span class="checkLabel">\n        <span class="shape sf_tAfterBg"></span>\n        <span class="text"></span>\n    </span>\n    </label>\n</div>\n<% } %>'},function(e,t,n){var i=n(563),o=n(1630),s=n(152),a=n(799);e.exports=function(e,t){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.DROPBOX_FILE,apiType:"dropbox_file",createModelFromJSON:i.createDropboxFileByJSON,createWidgetView:function(e,n){return new o({model:n,el:e,postModel:t})}},e,t)}},function(e,t,n){var i=n(563),o=n(1630),s=n(152),a=n(799);e.exports=function(e,t){a.injectAttachmentWidget({postSpecType:s.POST_ATTACHMENT_TYPE.EXTERNAL_FILE,apiType:"external_file",createModelFromJSON:i.createExternalFileByJSON,createWidgetView:function(e,n){return new o({model:n,el:e,postModel:t})}},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(555),s=n(569),a=n(207),r=n(2321),l=t.template(r);n(56);var c={},d=/(\s*_mentionName[^>]*>)([^<]+)</i,u=[o.ESCAPE,o.END,o.HOME,o.LEFT,o.RIGHT];function h(e,n){this.editor=e,this.bandNo=n,this.mentionTyping=!1,this.typingString=null,this.mentionInputTimer=null,this.$elEditor=i(this.editor.element.$),this.$mentionList=null,this.$activeItem=null,this.exHtml=null,this.charAtStartOffset="",this.mentionCharOffset=null,this.$mentionParent=i("#autoCompleteParent"),this.$win=i(window),this.mentionListClass="_mentionList_"+e.id,this.mentionListSelector="."+this.mentionListClass,this.isDestroyed=!1,this.dataFetched=!1,this.scrollEventVars={event:"scroll",scrollTop:null,eventHandler:t.bind(this.closeLayerOnScrollEvent,this)},s.fetchMentionMembersAndMemberGroups(this.bandNo).then(t.bind((function(e){var t=e.memberGroupMentionArray,n=s.convertCollectionToMentionArray(e.memberCollection);this.initMentionTargetList=s.concatMentionArrayAndSort(t,n),this.dynamicSearchRequired=e.hasMoreMember,this.firstMatchingList=[],this.secondMatchingList=[],this._canMentionMemberGroup=e.canMentionMemberGroup,this.dataFetched=!0}),this))}return h.prototype.removeAutoCompleteList=function(){this.$mentionList&&(this.$mentionList.off(),this.$mentionList=null),i(this.mentionListSelector).remove(),this.$activeItem=null,this.$mentionParent.css({top:"0",left:"0"}),this.$mentionParent.removeClass("-top"),this.scrollParentEventOff()},h.prototype.startMention=function(e){this.mentionTyping=!0,this.mentionCharOffset=e},h.prototype.isMentionTyping=function(){return this.mentionTyping},h.prototype.isDataFetched=function(){return this.dataFetched},h.prototype.stopMentionTyping=function(){this.mentionTyping=!1,this.typingString=null,this.charAtStartOffset="",this.removeAutoCompleteList()},h.prototype.asyncSearchMentions=function(){if(!this.dynamicSearchRequired)return clearTimeout(this.mentionInputTimer),void(this.mentionInputTimer=setTimeout(t.bind(this.filterAndShowTargetsFromInitList,this),50));var e=this.extractTypingStrButAtChar(),n=s.debouncedFetchMemberList(this.bandNo,e,this.fetchMemberTimer);this.fetchMemberTimer=n.timer;var o=i.Deferred().resolve([]);this._canMentionMemberGroup&&(o=s.fetchCachedBandMemberGroups(this.bandNo)),i.when(n.promise,o).then(t.bind((function(e,t){if(this.extractTypingStrButAtChar()==e.query){var n=s.extractMatchingMentionsButEmptyQuery(t,e.query),i=s.convertCollectionToMentionArray(e.firstMatchingList);this.firstMatchingList=s.concatMentionArrayAndSort(n,i);var o=s.extractMatchingMentionsButEmptyQuery(t,e.query.slice(0,-1)),a=s.convertCollectionToMentionArray(e.secondMatchingList);this.secondMatchingList=s.concatMentionArrayAndSort(o,a),this.filterAndShowTargetsFromFetchingList()}}),this))},h.prototype.extractTypingStrButAtChar=function(){return(this.typingString||"").substring(1)},h.prototype.filterAndShowTargetsFromInitList=function(){if(!this.isDestroyed&&this.isMentionTyping()){var e=(this.typingString||"").substring(1),n=this.createMentionTargetList(e);t.isEmpty(n)?this.stopMentionTyping():(this.showMentionList(n,e),this.bindMentionListEvent())}},h.prototype.filterAndShowTargetsFromFetchingList=function(){if(!this.isDestroyed&&this.isMentionTyping()&&"@"!=this.typingString){var e=(this.typingString||"").substring(1),n=this.createDynamicMentionTargetList(e);t.isEmpty(n)?this.stopMentionTyping():(this.showMentionList(n,e),this.bindMentionListEvent())}},h.prototype.shouldStopMentionTyping=function(e){return t.contains(u,e)},h.prototype.highlightText=function(e,n){return""==n?e:e.replace(d,(function(e,i,o){var s=t.unescape(o),a=s.toLowerCase().indexOf(n.toLowerCase());if(a<0)return i+o+"<";var r=s.substring(0,a),l=s.substring(a,a+n.length),c=s.substring(a+n.length);return i+t.escape(r)+"<b>"+t.escape(l)+"</b>"+t.escape(c)+"<"}))},h.prototype.makeKey=function(e){return"_"+e},h.prototype.checkMentionTyping=function(e){if(this.isMentionTyping()&&this.isDataFetched()){var t=e.getRanges()[0];if(!this.checkIEMentionTyping(t)){var n=t.startContainer.$.textContent||"",i=t.startOffset;if(-1!=(n=n.substring(0,i+1)).lastIndexOf("@")){this.adjustMentionCharOffset(n),this.charAtStartOffset!=n.charAt(i)&&(i+=1);var o=n.substr(this.mentionCharOffset,i-this.mentionCharOffset);o==this.typingString&&(i+=1,o=n.substr(this.mentionCharOffset,i-this.mentionCharOffset)),this.typingString=o,this.charAtStartOffset=n.charAt(t.startOffset),this.asyncSearchMentions()}else this.stopMentionTyping()}}},h.prototype.adjustMentionCharOffset=function(e){"@"!=e.charAt(this.mentionCharOffset)&&(this.mentionCharOffset=e.lastIndexOf("@"),-1==this.mentionCharOffset&&(this.mentionCharOffset=0))},h.prototype.checkIEMentionTyping=function(e){if(e.startContainer.type==CKEDITOR.NODE_TEXT)return!1;var t=e.startContainer.getChild(0);if(null==t)return this.stopMentionTyping(),!0;var n=t.$.textContent,i=n.lastIndexOf("@");return-1==i?(this.stopMentionTyping(),!0):(this.typingString=n.substr(i),this.charAtStartOffset=n.charAt(n.length-1),this.asyncSearchMentions(),!0)},h.prototype.saveCursorChar=function(){var e=this.editor.getSelection().getRanges()[0],t=e.startContainer.$.textContent||"";this.charAtStartOffset=t.charAt(e.startOffset)},h.prototype.convertModificationContent=function(){this.convertModificationMemberMention(),this.convertModificationMemberGroupMention()},h.prototype.convertModificationMemberMention=function(){var e=this.$elEditor.find("._modificationMemberMention");0!=e.length&&e.each(t.bind((function(e,t){var n=i(t),o=n.data("userno"),s=n.text(),a={style:"width: "+n.width()+"px",class:"mentionUser _mentionMember","data-userno":o,value:s},r=new CKEDITOR.dom.element(t);new CKEDITOR.dom.element(this.createMentionTag(a)[0]).replace(r)}),this))},h.prototype.convertModificationMemberGroupMention=function(){var e=this.$elEditor.find("._modificationMemberGroupMention");0!=e.length&&e.each(t.bind((function(e,t){var n=i(t),o=n.width(),s=n.data("member-group-id"),a={style:"width: "+o+"px",class:"mentionUser _mentionMemberGroup",value:n.text(),"data-member-group-id":s},r=new CKEDITOR.dom.element(t);new CKEDITOR.dom.element(this.createMentionTag(a)[0]).replace(r)}),this))},h.prototype.createMentionTargetList=function(e){var n=this.extractTypingMatchingList(this.initMentionTargetList,e);if(!t.isEmpty(n))return n;var i=e.slice(0,-1);return this.extractTypingMatchingList(this.initMentionTargetList,i)},h.prototype.createDynamicMentionTargetList=function(e){var n=this.extractTypingMatchingList(this.firstMatchingList,e);if(!t.isEmpty(n))return n;if(t.isEmpty(this.secondMatchingList))return[];var i=e.slice(0,-1);return this.extractTypingMatchingList(this.secondMatchingList,i)},h.prototype.extractTypingMatchingList=function(e,n){return t.filter(e,(function(e){return e.getMentionName().toLowerCase().indexOf(n.toLowerCase())>-1}))},h.prototype.set$MentionList=function(e){this.$mentionList=e},h.prototype.showMentionList=function(e,n){var o=this.editor.getSelection(),s=i(o.getStartElement().$),a=s.offset(),r=a.top+s.height(),c=a.left,d=i('<article class="cAutoCompleteList '+this.mentionListClass+'"><div class="scrollWrap _scrollWrap"></div></article>'),u=i('<ul class="roundThumbList"></ul>');t.each(e,t.bind((function(e){var i=l(t.extend({MENTION_ITEM_CLASS:"_eachMentionItem"},e.toMentionJson()));u.append(this.highlightText(i,n))}),this)),this.removeAutoCompleteList(),d.find("._scrollWrap").append(u),this.$mentionParent.css({top:r+"px",left:c+"px"}),this.$mentionParent.html(d),d.show(),this.adjustMentionListOffset(d,s);var h=u.children().first();this.highlightItem(h),this.scrollToItem(h),this.closeLayerWhenScrolling()},h.prototype.getScrollParent=function(){return this.$elEditor.scrollParent()},h.prototype.closeLayerWhenScrolling=function(){var e=this.getScrollParent();e&&e.length&&e.on(this.scrollEventVars.event,this.scrollEventVars.eventHandler)},h.prototype.closeLayerOnScrollEvent=function(e){var t=i(e.currentTarget).scrollTop();null!==this.scrollEventVars.scrollTop?(this.scrollEventVars.scrollTop<t+20||this.scrollEventVars.scrollTop>t-20)&&this.removeAutoCompleteList():this.scrollEventVars.scrollTop=t},h.prototype.scrollParentEventOff=function(){this.getScrollParent().off(this.scrollEventVars.event,this.scrollEventVars.eventHandler)},h.prototype.adjustMentionListOffset=function(e,t){var n=t.offset(),i=t.position().top+t.height()+e.height(),o=this.getScrollParent(),s=o.scrollParent();9==s[0].nodeType?i+o.offset().top-o.scrollTop()>this.$win.height()+this.$win.scrollTop()&&this.placeMentionListUp(e,n.top):i+s.position().top-o.scrollTop()+96+107>this.$win.height()&&this.placeMentionListUp(e,n.top)},h.prototype.placeMentionListUp=function(e,t){this.$mentionParent.addClass("-top"),this.$mentionParent.css("top",t)},h.prototype.bindMentionListEvent=function(){var e=i(this.mentionListSelector).find("._eachMentionItem");this.set$MentionList(e),e.mousedown((function(){return!1})),e.mouseup((function(){return!1})),e.click(t.bind((function(e){return this.setActiveItem(i(e.currentTarget)),this.selectItem(),!1}),this)),e.mouseover(t.bind((function(e){return this.setActiveItem(i(e.currentTarget)),this.highlightItem(this.$activeItem),!1}),this)),e.contextmenu(t.bind((function(){this.stopMentionTyping()}),this))},h.prototype.createMentionTag=function(e){var n=i("<input/>");return n.attr(t.extend({disabled:"disabled",unselectable:"on","data-nostyle":"true"},e)),n},h.prototype.insertMentionTag=function(e,t,n,i){var o=t.textContent.substr(n+i.length);t.textContent=t.textContent.substr(0,n);var s=null;""!=o&&(s=document.createTextNode(o));var a=t.nextSibling;this.placeMentionTag(t.parentNode,e[0],a),this.placeAfterTextTag(t.parentNode,s,a)},h.prototype.placeMentionTag=function(e,t,n){n?e.insertBefore(t,n):e.appendChild(t)},h.prototype.placeAfterTextTag=function(e,t,n){t&&(n?e.insertBefore(t,n):e.appendChild(t))},h.prototype.highlightItem=function(e){0!=e.length&&(e.siblings().removeClass("active"),e.addClass("active"),this.setActiveItem(e))},h.prototype.scrollToItem=function(e){if(0!=e.length){var t=e.scrollParent();t.finish(),t.animate({scrollTop:e.outerHeight()*e.index()},{duration:30})}},h.prototype.highlightNextItem=function(){if(null!=this.$activeItem){var e=i(this.$activeItem.next());this.highlightItem(e),this.scrollToItem(e)}},h.prototype.highlightPrevItem=function(){if(null!=this.$activeItem){var e=i(this.$activeItem.prev());this.highlightItem(e),this.scrollToItem(e)}},h.prototype.selectItem=function(){if(this.$activeItem){var e=this.editor.getSelection().getRanges()[0],n=this.typingString||"",i=parseInt(e.startOffset-n.length)||0,o=e.startContainer.$;if(e.startContainer.type!=CKEDITOR.NODE_TEXT){var s=e.startContainer.getChild(0),r=e.startContainer.getChild(1),l=s.$.textContent,c=r.$.textContent;s.setText(l+c),r.remove(),i=(o=s.$).textContent.lastIndexOf("@")}var d=a.findMentionTypeByName(this.$activeItem.data("mention-type-name"));if(null!=d){var u={style:"width: "+this.$activeItem.find("._elForSize").width()+"px"};if(d==a.BAND_MEMBER)u.class="mentionUser _mentionMember",u["data-userno"]=this.$activeItem.data("userno"),u.value=this.$activeItem.data("name");else{u.class="mentionUser _mentionMemberGroup";var h=this.$activeItem.data("member-group-name");u["data-member-group-id"]=this.$activeItem.data("member-group-id"),u.value=h}this.stopMentionTyping();var p=this.createMentionTag(u);this.insertMentionTag(p,o,i,n),this.editor.focus();var m=new CKEDITOR.dom.element(p[0]);e.moveToClosestEditablePosition(m,!0),e.select();for(var _,g=m.getParent();"p"!==g.getName()&&"li"!==g.getName();)_=g,g=g.getParent();_&&setTimeout(t.bind((function(){var e=this.editor.getSelection().createBookmarks();m.breakParent(_),this.editor.getSelection().selectBookmarks(e)}),this),0)}else this.stopMentionTyping()}},h.prototype.setActiveItem=function(e){this.$activeItem=e},h.prototype.setExHtml=function(e){this.exHtml=e},h.prototype.isSameAsBefore=function(e){return this.exHtml==e},h.prototype.destroyMention=function(){this.isDestroyed=!0,clearTimeout(this.mentionInputTimer),this.stopMentionTyping(),this.destroyScrollHandler(),this.$elEditor=null},h.prototype.destroyScrollHandler=function(){var e=this.getScrollParent();e&&e.length&&e.off(this.scrollEventVars.event,this.scrollEventVars.eventHandler)},function(e,t,n){if(!n){var s=function(e,t){var n="_"+e.id;return null!=c[n]||(c[n]=new h(e,t)),c[n]}(e,t),a=function(e){if(s.isDataFetched()&&s.isMentionTyping()){var t=e.data.keyCode;if(s.shouldStopMentionTyping(t))s.stopMentionTyping();else{switch(t){case o.UP:s.highlightPrevItem();break;case o.DOWN:s.highlightNextItem();break;case o.ENTER:case 2228237:case 1114125:case o.TAB:s.selectItem();break;default:return}e.cancel()}}},r=function(){if(s.isDataFetched()){var t=e.editable().getData(!0);s.isSameAsBefore(t)||s.checkMentionTyping(e.getSelection()),s.setExHtml(t)}},l=function(){s.isMentionTyping()&&s.isDataFetched()&&r()};e.on("contentDom",(function(){var t=e.editable();t.attachListener(t,"keypress",(function(t){var n=t.data.$.which;if("@"===String.fromCharCode(n)&&!s.isMentionTyping()&&s.isDataFetched()){var i=e.getSelection(),o=i.getStartElement();o.is("span")&&o.hasAttribute("data-nostyle")||(s.startMention(i.getRanges()[0].startOffset),s.saveCursorChar())}})),t.attachListener(t,"click",(function(){s.isDataFetched()&&s.stopMentionTyping()})),t.attachListener(t,"contextmenu",(function(){s.isDataFetched()&&s.stopMentionTyping()})),(i.browser.msie||i.browser.msedge)&&t.attachListener(t,"keyup",l),s.convertModificationContent()})),e.hasListeners("key")&&e.removeListener("key",a),e.on("key",a),e.hasListeners("change")&&e.removeListener("change",r),e.on("change",r),e.on("destroy",(function(){s.destroyMention(),e.removeListener("key",a),e.removeListener("change",r),e.removeListener("keyup",l)}))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<%\n// 멤버 그룹의 경우\nif ( memberGroup ) {\n%>\n<li data-member-group-name="<%- mentionName %>" data-member-group-id="<%- memberGroupId %>" data-mention-type-name="<%- mentionTypeName %>" class="<%- MENTION_ITEM_CLASS %>">\n    <span class="groupProfileThumb"></span>\n    <div class="textInfoBox">\n        <div class="name">\n            <p class="nameText _mentionName"><%- mentionName %></p>\n        </div>\n        <p class="memberGroupDesc gMal12"><%- IM(\'mention.member_group_count_description\', {memberCount: memberCount + \'\'}) %></p>\n    </div>\n\n    <span class="elForSize _elForSize"><%- mentionName %></span>\n</li>\n<%\n// 일반 멤버 + 다른밴드 멤버의 경우\n} else {\n%>\n<li data-name="<%- mentionName %>" data-userno="<%- userNo %>" data-mention-type-name="<%- mentionTypeName %>" class="<%- MENTION_ITEM_CLASS %>">\n    <span class="thumb <%- thumbnailInnerClass %>">\n        <img src="<%- mentionThumbnail %>" />\n    </span>\n    <div class="textInfoBox">\n        <div class="name">\n            <p class="nameText _mentionName"><%- mentionName %></p>\n            <% if (!!mentionDescription) { %><p class="descText"><%- mentionDescription %></p><% } %>\n        </div>\n    </div>\n\n    <span class="elForSize _elForSize"><%- mentionName %></span>\n</li>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(718),s=n(2323),a=n(152);return function(e,n){var r=new s({editor:e});e.widgets.on("instanceCreated",(function(e){e.data.on("key",(function(e){var t=e.data.keyCode,n=e.sender.wrapper;return 13==t?(r.addLineAfter(n),!1):t==CKEDITOR.SHIFT+13?(r.addLineBefore(n),!1):void 0}))})),e.addCommand("addBandWidget",{editorFocus:!0,exec:i.bind((function(e,s){var l=s.type,c=s.params,d=e.getSelection().getRanges(),u=e.widgets.selected||[];if(!d||0==d.length||t(d[0].startContainer.$).hasClass("cke_widget_wrapper")&&0==u.length){var h=e.element.getChild(0);r.addLineBefore(h)}u.length>0&&r.addLineAfter(u[0].wrapper);var p=e.elementPath().contains("li");if(p){var m=d[0].clone();m.moveToElementEditEnd(p),m.select(),e.execCommand("enter"),e.getSelection().getStartElement().is("li")&&e.execCommand("enter")}var _=c.model.cid;if(e.widgets.registered[l].defaults=i.extend(c,{id:_,widgetName:l}),t.browser.msedge){var g=e.getSelection().getRanges();g&&g.length>0&&t(g[0].startContainer.$.parentNode).hasClass(o.PLACE_HOLDER_CLASS)?e.getSelection().selectElement(e.element.getFirst()):e.getSelection().getStartElement()&&t(e.getSelection().getStartElement().$).parents("."+o.RICH_EDITOR_CLASS)[0]||e.getSelection().selectElement(e.element.getLast())}a.isSingleAttachmentType(l)?n.setAttachment(l,c.model):n.addAttachment(l,_,c.model),e.execCommand(l)}),this)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return n(4).Object.extend({editor:null,initialize:function(e){this.editor=e.editor},addLineAfter:function(e){return this.add(e,CKEDITOR.POSITION_AFTER_END)},addLineBefore:function(e){return this.add(e,CKEDITOR.POSITION_BEFORE_START)},add:function(e,t){var n=this.editor.createRange(),i=this.editor.document.createElement("p");return(CKEDITOR.env.ie&&CKEDITOR.env.version<11?this.editor.document.createText(" "):this.editor.document.createElement("br")).appendTo(i),n.setStartAt(e,t),n.collapse(!0),n.insertNode(i),n.setStartAt(i,CKEDITOR.POSITION_AFTER_START),n.collapse(!0),n.select(),this.editor.focus(),i}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(718);return function(e){var n=!1,o=null;e.on("instanceReady",(function(){if(e.focusManager.focus(!0),a()){var t=e.element.getFirst();t.is("p")?o=t:((o=e.document.createElement("p")).appendBogus(),e.element.append(o,!0)),o.append(s(),!0);var n=e.createRange();n.moveToPosition(o,CKEDITOR.POSITION_AFTER_START),n.select(),e.once("key",(function(e){if(o){var t=e.data.keyCode;8!==t&&46!==t||e.cancel(),r(o),o=null}}))}e.widgets.on("instanceCreated",c),e.widgets.on("instanceDestroyed",d),e.on("selectionChange",d)}));var s=function(){var t=e.document.createElement("span");return t.addClass("placeholder"),t.addClass(i.PLACE_HOLDER_CLASS),t.setHtml(e.config.placeholder),t.setAttribute("aria-hidden","true"),t},a=function(){var t=e.element.getFirst(),n=t.getNext();return t.type===CKEDITOR.NODE_ELEMENT&&!t.is("p")||l(t)&&!(n&&n.type===CKEDITOR.NODE_ELEMENT&&n.is("p"))},r=function(e){if(!e||!e.is("p"))return!1;for(var t=e.getFirst();t;){if(t&&t.type===CKEDITOR.NODE_ELEMENT&&t.hasClass("placeholder")){t.remove();break}t=t.getNext()}},l=function(e){for(var n=e.getChildren(),i=0;i<n.count();i++){var o=n.getItem(i);if(o.type===CKEDITOR.NODE_ELEMENT&&o.is("input"))return!1}var s=e.getText().replace(/&\S+?;/g,"");return!t.trim(s)},c=function(){n=!0,setTimeout((function(){if(o&&(o.remove(),o=null),r(e.element.getFirst()),a()){var t=e.element.getFirst();t.is("p")?o=t:((o=e.document.createElement("p")).appendBogus(),o.insertBefore(t)),o.append(s(),!0)}n=!1}),0)},d=function(){if(!n){var t=e.element.getFirst();if(t){var i,l=t.getNext(),c=e.getSelection().getRanges()[0];c&&(i=e.element.equals(c.startContainer)&&0===c.startOffset?t:(i=e.getSelection().getStartElement()).getAscendant("p",!0),o?o.equals(i)?(r(i),o=null,c.moveToElementEditStart(i),c.select()):l&&l.is&&l.is("p")&&(o.remove(),o=null):t.type===CKEDITOR.NODE_ELEMENT&&t.is("p")&&!t.equals(i)&&a()&&(t.append(s(),!0),o=t))}}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i,o;i=[n(0),n(2),n(56)],void 0===(o=function(e,t,n){return function(e){if(t.browser.mozilla){var n=null,i=null,o=!1,s=function(){if(!o){var t=e.editable().getData();t!=n&&(n=t,e.fire("change"))}},a=function(){clearInterval(i)},r=function(){a(),i=setInterval(s,500)};e.on("focus",r),e.on("change",r),e.on("blur",(function(){a(),s()})),e.on("destroy",(function(){o=!0,a(),e.removeListener("focus",r),e.removeListener("change",r),e.removeListener("blur",a)}))}}}.apply(t,i))||(e.exports=o)},function(e,t,n){var i=n(563),o=n(2327),s=n(2013),a=n(152),r=n(799);e.exports=function(e,t){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.SIGNUP,apiType:"signup",createModelFromJSON:i.createSignup,createWidgetView:r.widgetViewCreator(o),openModifyLayerView:s.openAsLayer,onWidgetModify:r.createLayoutModify((function(e){return s.openAsLayer(e,t)}))},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2328),s=n(9),a=n(43),r="YYYY-MM-DD";return i.View.extend({attributes:{"data-viewname":"SignupWidgetView"},template:t.template(o),templateContext:function(){return{progressText:this._getDoneCount(),startDate:this._getStartDate()}},ui:{modifyBtn:"._modifyBtn",deleteBtn:"._deleteBtn"},triggers:{"click @ui.modifyBtn":"modify","click @ui.deleteBtn":"remove"},_getDoneCount:function(){var e=this.model.get("completedTaskCount")||"0",t=this.model.getSignupActualTaskCount()||"0";return e==t?IM("web.postlist.todo.txt.done"):IM("web.postlist.todo.txt.in_progress",{doneCount:e,taskCount:t})},_getStartDate:function(){var e=this.model.get("startAt"),t=this.model.get("timeZoneId"),n=e?a.tz(e,t).format(r):null;return n?s.format.date(a(n,r),"year_month_day"):null}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _modifyBtn"><%- IM(\'ui.label.modify\') %></button>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _deleteBtn"><%- IM(\'ui.label.delete\') %></button>\n</div>\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -signup">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-signup sf_color" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-signup-22"></use>\n                    </svg>\n                    <span class="status sf_color"><%- IM(\'signup.type_name\') %></span>\n                    <em><%- progressText %></em>\n                </p>\n                <p class="addTitle"><%- title %></p>\n                <% if (startDate) { %>\n                <div class="addStatus"><time class="date"><%- startDate %></time></div>\n                <% } %>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title" id="signup_<%- cid %>_type_1"><%- IM(\'signup.type_name\') %></h1>\n        \x3c!-- 참가신청서 진입시 1번만 보이는 코치마크입니다. --\x3e\n        <dl class="uHelpGuide -w -arrowCenter -small -close" style="top:38px;left:50%;margin-left:-105px;display:block">\n            <dt class="gSrOnly"><%- IM(\'ui.label.help\') %></dt>\n            <dd id="signup_<%- cid %>_type_2" aria-labelledby="signup_<%- cid %>_type_1" aria-hidden="true" style="display:none;width:210px" class="_typeGuide">\n                <%= IM(\'signup.editor.type_description\') %>\n                <button type="button" class="btnLyClose _signupGuideBtn" aria-controls="signup_<%- cid %>_type_2">\n                    <span class="gSrOnly"><%- IM(\'uil.label.help.close\') %></span>\n                </button>\n            </dd>\n        </dl>\n    </header>\n\n    <div class="main -spaceNone">\n        <div class="postWrite">\n            <div class="addWidget">\n                <div class="scrollArea _scrollArea">\n                    <div class="titleWrap _titleWrap">\n                        <label for="signup_<%- cid %>_title" class="gSrOnly"><%- IM(\'ui.label.title\') %></label>\n                        <input type="text" id="signup_<%- cid %>_title" class="_titleInput" maxlength="<%- titleMaxLength %>" placeholder="<%- IM(\'ui.label.title\') %>" value="">\n                        <div class="previousCheck">\n                            <button type="button" class="btnLoad _importBtn"><span class="gSrOnly"><%- IM(\'web.postwrite.form_attendance_check.load_prev_attendance_check.label\') %></span></button>\n                        </div>\n                    </div>\n\n                    <div class="dateInfoWrap gMat16">\n                        \x3c!-- [D] 날짜선택영역 --\x3e\n                        <div class="dateInfo">\n                            <div class="flexList -tbSpaceNone">\n                                <div class="dateTitle -langWidth"><label class="_startDateLabel"><%- IM(\'ui.label.date\') %></label></div>\n                                <div class="signupInputWrap -langWidth _startDateRegion"></div>\n                            </div>\n                        </div>\n\n                        \x3c!-- [D] 날짜선택 완료시 -disabled 클래스를 없애주세요. --\x3e\n                        <div class="timeInfo gMat10 -disabled _timeZoneWrap">\n                            <div class="flexList -tbSpaceNone">\n                                <div class="dateTitle -langWidth"><label class="_timeZoneLabel"><%- IM(\'web.scheduleedit.date.timezone\') %></label></div>\n                                <div class="text gPal0 _timeZoneRegion"></div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="itemWriteList">\n                        <strong class="gSrOnly">SIGNUP LIST ITEM</strong>\n                        <ul class="signupList _taskListRegion"></ul>\n                    </div>\n\n                    <button type="button" class="addItemBtn _addTaskBtn"><%- IM(\'web.postdetail.todo.add_task\') %></button>\n\n                    <div class="optionCheck">\n                        <% if (msg_showAddMemberOption) { %>\n                        <div class="optionCheckItem">\n                            <label for="signup_<%- cid %>_child" class="uCheck -checkbox -fs13">\n                                <input type="checkbox" id="signup_<%- cid %>_child" class="checkInput _childMemberCheckbox">\n                                <span class="checkLabel">\n                                    <span class="shape"></span>\n                                    <span class="text"><%- IM(\'signup.editor.allow_adding_child_member\') %></span>\n                                </span>\n                            </label>\n                            <dl class="uHelpGuide -up -arrowLeft -small -close gMat0">\n                                <dt><button type="button" id="signup_<%- cid %>_guide_child_1" aria-haspopup="true" aria-controls="signup_<%- cid %>_guide_child_2" class="_signupGuideBtn"><span class="gSrOnly"><%- IM(\'ui.label.help\') %></span></button></dt>\n                                <dd id="signup_<%- cid %>_guide_child_2" aria-labelledby="signup_<%- cid %>_guide_child_1" aria-hidden="true" style="display:none;width:196px"><%- IM(\'schedule.edit.rsvp.add_child_member.help_guide\') %><button type="button" class="btnLyClose _signupGuideBtn" aria-controls="signup_<%- cid %>_guide_child_2"><span class="gSrOnly"><%- IM(\'uil.label.help.close\') %></span></button></dd>\n                            </dl>\n                            \x3c!-- [D] 외부 멤버 추가를 체크하면 -disabled 클래스를 뺴줍니다. --\x3e\n                            <div class="memberPlusWrap flexList -tbSpaceNone gMal28 p -bLine -disabled _childMemberLimitWrap">\n                                <div class="dateTitle"><label for="signup_<%- cid %>_child_limit"><%- IM(\'schedule.edit.rsvp.child_member_limit.label\') %></label></div>\n                                <div class="text gMal20">\n                                    <input type="number" id="signup_<%- cid %>_child_limit" placeholder="<%- IM(\'schedule.edit.rsvp.child_member_limit.placeholder\') %>" class="inputText -h30 -w153 _childMemberLimitInput" min="1" max="<%= childMemberLimitCount %>">\n                                </div>\n                            </div>\n                        </div>\n                        <% } %>\n\n                        <div class="optionCheckItem">\n                            <div class="flexList -tbSpaceNone -h32">\n                                <div class="text">\n                                    <label for="signup_<%- cid %>_end" class="uCheck -checkbox -fs13">\n                                        <input type="checkbox" id="signup_<%- cid %>_end" class="checkInput _endedAtCheckbox">\n                                        <span class="checkLabel">\n                                            <span class="shape"></span>\n                                            <span class="text -w80"><%- IM(\'todo.set_ended_at.label.checkbox\') %></span>\n                                        </span>\n                                    </label>\n                                </div>\n                                \x3c!-- [D] 마감일 설정을 체크하면 -disabled 클래스를 뺴줍니다. --\x3e\n                                <div class="etc deadLineWrap -disabled _endedAtRegion" style="width:331px"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -confirm -disabled _attachBtn" disabled><%- IM(\'web.btn.attach\') %></button>\n        <button type="button" class="btnLyClose uButton -iconClose _closeBtn"><span class="gSrOnly"><%- IM(\'ui.label.close\') %></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=(n(52),n(4)),a=n(2331),r=n(152),l=n(43),c=n(9),d=n(578),u=n(593),h=n(1314),p=n(2332),m=(n(523),{EDIT_COMPLETE:"EDIT_COMPLETE"}),_="HH:mm",g="YYYY-MM-DD HH:mm",f=":",b=i.template('<span class="signupMemberNum"><%- CurrencyUtil.numberWithCommas(number) %></span> '),v=s.View.extend({tagName:"li",className:"signupItem",template:i.template(a),ui:{defaultWrap:"._defaultWrap",editorWrap:"._editorWrap",previewWrap:"._previewWrap",subjectInput:"._subjectInput",attendeeLimitInput:"._attendeeLimitInput",startTimeLabel:"._startTimeLabel",startTimeRegion:"._startTimeRegion",endTimeRegion:"._endTimeRegion",alarmLabel:"._alarmLabel",alarmRegion:"._alarmRegion",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn",signupTaskGuideBtn:"._signupTaskGuideBtn"},events:{"blur @ui.attendeeLimitInput":"_checkAttendeeLimitInput","input @ui.subjectInput":"_toggleConfirmBtn","click @ui.cancelBtn":"_cancel","click @ui.confirmBtn":"_confirm","click @ui.previewWrap":function(){this.ui.previewWrap.removeClass("-active").addClass("-disabled"),this.ui.defaultWrap.removeClass("-disabled").addClass("-active"),this.ui.editorWrap.removeClass("-disabled")},"click @ui.subjectInput":function(){this.ui.editorWrap.removeClass("-disabled")},"click @ui.signupTaskGuideBtn":function(e){var n=this.$("#"+t(e.currentTarget).attr("aria-controls")),i="none"!=n.css("display");n.css("display",i?"none":"block")}},regions:{startTimeRegion:{el:"@ui.startTimeRegion",replaceElement:!1},endTimeRegion:{el:"@ui.endTimeRegion",replaceElement:!1},alarmRegion:{el:"@ui.alarmRegion",replaceElement:!1}},serializeData:function(){var e=this.model.get("subject"),t=this.model.getSignupTaskAlarms(),n=this.model.get("attendeeLimit")||1,i=!!this._startDate;return this._startAt=this.model.get("startAt"),this._endAt=this.model.get("endAt"),this._alarm=t.size()>0?t.first().toJSON():{},{cid:this.cid,subjectMaxLength:r.SIGNUP_TASK_SUBJECT_MAX_LENGTH,cancelBtnLabel:e?IM("signup.editor.task.delete_task"):IM("ui.label.cancel"),timeSupport:i,placeholder:i?IM("signup.editor.task.placeholder.subject_time"):IM("signup.editor.task.placeholder.subject"),subject:e,attendeeLimit:n,startTime:this._formatTime(this._startAt),endTime:this._formatTime(this._endAt),alarm:t.size()>0?u.getFullMessage(!this._startAt,t.first()):"",formattedAttendeeLimit:IM("signup.editor.task.attendee_limit",{count:b({number:n,CurrencyUtil:d})}),attendeeLimitCount:1e3}},initialize:function(e){this._startDate=e.startDate,this._timeZoneId=e.timeZoneId},onRender:function(){this._toggleConfirmBtn(),this._startDate&&(this._renderStartTime(),this._renderEndTime(),this._renderAlarm()),this.model.get("subject")?this.ui.previewWrap.removeClass("-disabled").addClass("-active"):this.ui.defaultWrap.removeClass("-disabled").addClass("-active")},setSignupTaskOptions:function(e){var t=e.startDate,n=e.timeZoneId,i=!!this._startDate^!!t,o=this._startAt?l.tz(this._startAt,this._timeZoneId).format(_):null,s=this._endAt?l.tz(this._endAt,this._timeZoneId).format(_):null;this._startDate=t,this._timeZoneId=n,i?(this.model.unsetSignupTaskTimeAttributes(),this.render()):t&&(this._setStartAt(o),this._setEndAt(s),this.model.set({startAt:this._startAt,endAt:this._endAt}))},_formatTime:function(e){var t=e?l.tz(e,this._timeZoneId).format(g):null,n=t?l(t,g):null;return n?c.format.time(n,"hour_minute"):null},_checkAttendeeLimitInput:function(){var e=parseInt(this.ui.attendeeLimitInput.val()),t=this.model.get("checkedAttendeeCount")||0;!e||e<1?e=1:e>1e3&&(e=1e3),e<t&&(alert(IM("signup.editor.task.attendee_limit_smaller_checked")),e=t),this.ui.attendeeLimitInput.val(e)},_cancel:function(){this.model.get("checkedAttendeeCount")?alert(IM("signup.editor.task.cannot_delete_exists_attendees")):this.model.get("subject")&&!confirm(IM("ui.confirm.delete"))||(this.model.resetSignupTask(),this.render(),this.trigger(m.EDIT_COMPLETE))},_confirm:function(){var e={subject:o.trim(this.ui.subjectInput.val()),startAt:this._startAt,endAt:this._endAt,alarms:i.isEmpty(this._alarm)?[]:[this._alarm],attendeeLimit:parseInt(this.ui.attendeeLimitInput.val())||1};this.model.setSignupTaskToEditedAttributes(e),this.trigger(m.EDIT_COMPLETE),this.render()},_renderStartTime:function(){var e=h.buildTimeInputView({inputTime:this._formatTime(this._startAt),pickerTime:this._startAt?null:this._getNextHour(1),minutesInterval:30,readOnlyInput:!1,pickerDirection:h.PICKER_DIRECTION.DOWN,placeholder:IM("ui.timepicker.placeholder.start_optional"),useTimeDelete:!0});this.listenTo(e,h.EVENT.TIME_CHANGED,(function(e){this._setStartAt(e.time||null),this._endAt&&(!this._startAt||this._startAt>=this._endAt)&&this._setEndAt(null)})),this.showChildView("startTimeRegion",e),this.ui.startTimeLabel.attr("for",e.getElementId())},_renderEndTime:function(){var e=h.buildTimeInputView({inputTime:this._formatTime(this._endAt),pickerTime:this._endAt?null:this._getNextHour(2),minutesInterval:30,readOnlyInput:!1,pickerDirection:h.PICKER_DIRECTION.DOWN,placeholder:IM("ui.timepicker.placeholder.end_optional"),useTimeDelete:!0});this.listenTo(e,h.EVENT.FOCUSED,(function(){this._startAt||(this._setStartAt(this._getNextHour(1)),this._setEndAt(this._getNextHour(2)))})),this.listenTo(e,h.EVENT.TIME_CHANGED,(function(e){var t=this._endAt;this._setEndAt(e.time||null),this._endAt&&this._endAt<=this._startAt&&(alert(IM("web.scheduleedit.alert.endtime_invlid_before_start")),this._setEndAt(t?l.tz(t,this._timeZoneId).format(_):null))})),this.showChildView("endTimeRegion",e)},_parseTime:function(e){var t=e?e.split(f):[];return 2==t.length?l.tz(this._startDate,this._timeZoneId).set({hour:parseInt(t[0]),minute:parseInt(t[1])}).valueOf():null},_setStartAt:function(e){var t=this._startAt;this._startAt=this._parseTime(e),!!this._startAt^!!t&&(this._alarm={},this._renderAlarm()),this.getChildView("startTimeRegion").setTime(this._startAt?l.tz(this._startAt,this._timeZoneId).format(_):null)},_setEndAt:function(e){this._endAt=this._parseTime(e),this.getChildView("endTimeRegion").setTime(this._endAt?l.tz(this._endAt,this._timeZoneId).format(_):null)},_getNextHour:function(e){return l().tz(this._timeZoneId).add(e,"hours").startOf("hour").format(_)},_renderAlarm:function(){var e=p.build({alarm:i.clone(this._alarm),isAllDay:!this._startAt,timePickerDirection:h.PICKER_DIRECTION.UP});this.listenTo(e,p.EVENT.ALARM_CHANGED,(function(e){e.durationType&&i.isNumber(e.amount)&&!!this._startAt^!!e.alarmTime?this._alarm=e:this._alarm={}})),this.showChildView("alarmRegion",e),this.ui.alarmLabel.attr("for",e.getElementId())},_toggleConfirmBtn:function(){var e=!o.trim(this.ui.subjectInput.val());this.ui.confirmBtn.prop("disabled",e).toggleClass("-disabled",e)}}),A=s.CollectionView.extend({tagName:"ul",className:"signupList",attributes:{"data-viewname":"DEditorSignupTaskListView"},childView:v,childViewOptions:function(){return this._options},childViewEvents:function(){var e={};return e[m.EDIT_COMPLETE]=function(){this.trigger(m.EDIT_COMPLETE)},e},initialize:function(e){this._options={startDate:e.startDate,timeZoneId:e.timeZoneId}},setSignupTaskListOptions:function(e){this._options={startDate:e.startDate,timeZoneId:e.timeZoneId},this.children.invoke("setSignupTaskOptions",this._options)}});return A.EVENT=m,A.build=function(e){return new A(e)},A}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='\x3c!-- [D] 스타일 조정을 위한 개발 조치사항 : value="" 기본 attribute 꼭 추가, $(this).blur()시 $(this).val() 값을 $(this).attr(\'value\', $(this).val()) 꼭 지정 --\x3e\n\x3c!-- [D]등록/수정영역 (정보보기 영역과 토글되는 영역입니다.) -disabled/ -active --\x3e\n<div class="signupRegister -disabled _defaultWrap">\n    <div class="signupItemTitle">\n        <label for="<%- cid %>_subject" class="gSrOnly"><%- placeholder %></label>\n        <input type="text" id="<%- cid %>_subject" value="<%- subject %>" maxlength="<%- subjectMaxLength %>" placeholder="<%- placeholder %>" class="inputItem _subjectInput">\n        <span class="etc"></span>\n    </div>\n    \x3c!-- [D] 항목 input 영역 포커스시 -disabled 클래스를 빼줍니다. --\x3e\n    <div class="singupItemWrap -disabled _editorWrap">\n        <div class="signupItemInputWrap">\n            <div class="flexList -tbSpaceNone">\n                <div class="dateTitle -langWidth"><label for="<%- cid %>_member_limit"><%- IM(\'signup.editor.task.member_limit\') %></label></div>\n                <div class="text gPal0">\n                    <input type="number" id="<%- cid %>_member_limit" placeholder="1" class="inputText -langWidth _attendeeLimitInput" value="<%- attendeeLimit %>" min="1" max="<%= attendeeLimitCount %>" style="height: 30px">\n                </div>\n            </div>\n\n            <% if (timeSupport) { %>\n            <div class="flexList  gMat10 -tbSpaceNone">\n                <div class="dateTitle -langWidth"><label class="_startTimeLabel"><%- IM(\'web.timepicker.topbar.text.title\') %></label></div>\n\n                <div class="text gPal0">\n                    <span class="flexList -tbSpaceNone -layoutFixed">\n                        <div class="flexItem _startTimeRegion"></div>\n                        <div class="flexItem gMal5 _endTimeRegion"></div>\n                    </span>\n                </div>\n            </div>\n            <div class="flexList gMat10 -tbSpaceNone">\n                <div class="dateTitle -langWidth">\n                    <label class="_alarmLabel"><%- IM(\'schedule.edit.label.alarm\') %></label>\n                    <dl class="uHelpGuide -up -arrowLeft -small -close">\n                        <dt><button type="button" id="<%- cid %>_alarm_guide_1" aria-haspopup="true" aria-controls="<%- cid %>_alarm_guide_2" class="_signupTaskGuideBtn"><span class="gSrOnly"><%- IM(\'ui.label.help\') %></span></button></dt>\n                        <dd id="<%- cid %>_alarm_guide_2" aria-labelledby="<%- cid %>_alarm_guide_1" aria-hidden="true" style="display:none;width:205px">\n                            <%- IM(\'signup.editor.task.alarm_guide\') %>\n                            <button type="button" class="btnLyClose _signupTaskGuideBtn" aria-controls="<%- cid %>_alarm_guide_2"><span class="gSrOnly"><%- IM(\'uil.label.help.close\') %></span></button>\n                        </dd>\n                    </dl>\n                </div>\n\n                <div class="text gPal0 _alarmRegion"></div>\n            </div>\n            <% } %>\n        </div>\n        <div class="signupItemConfirm">\n            <button class="uButton -sizeS -cancel _cancelBtn"><%- cancelBtnLabel %></button>\n            \x3c!-- [D]필수요소 작성시 -disabled를 -confirm으로 변경합니다. --\x3e\n            <button class="uButton -sizeS -confirm -disabled _confirmBtn" disabled><%- IM(\'ui.label.confirm\') %></button>\n        </div>\n    </div>\n</div>\n\n\x3c!-- [D]완료 후 정보보기 영역 -disabled/ -active--\x3e\n<div class="signupView -disabled _previewWrap">\n    <div class="singupViewInfo">\n        <div class="signupViewTitle"><%- subject %></div>\n        \x3c!-- [D] 시간 정보가 없을 경우 시간을 지워줍니다. --\x3e\n        <% if (startTime || alarm) { %>\n        <div class="signupViewAddInfo gPat5">\n            <% if (startTime) { %>\n            <span class="singupViewPeriod"><%- startTime %><%- endTime ? \' ~ \' + endTime : \'\' %></span>\n            <% } %>\n            \x3c!-- [D] 알람이 없을 경우 태그를 지워줍니다. --\x3e\n            <% if (alarm) { %>\n            <span class="singupViewAlarm"><%- alarm %></span>\n            <% } %>\n        </div>\n        <% } %>\n    </div>\n    <div class="singupViewInfo -w100">\n        <div class="signupMember gMar15">\n            \x3c!-- HTML --\x3e\n            <%= formattedAttendeeLimit %>\n        </div>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(52),n(4)),o=n(2333),s=n(593),a=n(1314),r=(n(16),t.map(s.getPredefinedAlarms(!0),(function(e){return{value:[e.duration_type,e.amount,e.alarm_time].join("_"),label:s.getMessage(!0,e)}}))),l=t.map(s.getPredefinedAlarms(!1),(function(e){return{value:[e.duration_type,e.amount].join("_"),label:s.getMessage(!1,e)}})),c={CUSTOM:"custom",NONE:""},d={ALARM_CHANGED:"ALARM_CHANGED"},u=i.View.extend({tagName:"div",attributes:{"data-viewname":"DAlarmInputView"},template:t.template(o),templateContext:function(){var e=this._alarmSelectValue==c.CUSTOM,t={cid:this.cid,VALUE:c,alarms:this._isAllDay?r:l,customEnabled:e};return e&&(t.durationTypes=s.getDurationTypes(this._isAllDay),t.amounts=s.getDurationAmounts(this._alarm.durationType,this._isAllDay),t.alarmTimeEnabled=this._isAllDay),t},ui:{alarmSelect:"._alarmSelect",amountSelect:"._amountSelect",durationTypeSelect:"._durationTypeSelect",alarmTimeRegion:"._alarmTimeRegion"},events:{"change @ui.alarmSelect":function(){var e=this._alarmSelectValue,n={durationType:null,amount:null,alarmTime:null};this._alarmSelectValue=this.ui.alarmSelect.val(),this._alarmSelectValue==c.CUSTOM?n.durationType=s.getDurationTypes(this._isAllDay)[0].value:this._alarmSelectValue!=c.NONE&&t.extend(n,this._toAlarmObject(this._alarmSelectValue)),this._alarm=n,this._triggerAlarmChanged(),this._alarmSelectValue==c.CUSTOM^e==c.CUSTOM&&this.render()},"change @ui.amountSelect":function(){this._alarm.amount=parseInt(this.ui.amountSelect.val()),this._triggerAlarmChanged()},"change @ui.durationTypeSelect":function(){this._alarm.durationType=this.ui.durationTypeSelect.val(),this._alarm.amount=null,this._triggerAlarmChanged(),this.render()}},regions:{alarmTimeRegion:{el:"@ui.alarmTimeRegion",replaceElement:!1}},initialize:function(e){this._timePickerDirection=e.timePickerDirection,this._isAllDay=e.isAllDay,this._alarm=e.alarm||{},this._alarmSelectValue=this._toAlarmSelectValue(this._alarm)},onRender:function(){this.ui.alarmSelect.val(this._alarmSelectValue),this._alarmSelectValue==c.CUSTOM&&(t.isNumber(this._alarm.amount)&&this.ui.amountSelect.val(this._alarm.amount),this._alarm.durationType&&this.ui.durationTypeSelect.val(this._alarm.durationType),this._isAllDay&&this._renderAlarmTime())},_renderAlarmTime:function(){var e=a.buildTimeInputView({inputTime:this._alarm.alarmTime,minutesInterval:30,readOnlyInput:!1,pickerDirection:this._timePickerDirection});this.listenTo(e,a.EVENT.TIME_CHANGED,(function(e){this._alarm.alarmTime=e.time,this._triggerAlarmChanged()})),this.showChildView("alarmTimeRegion",e)},getElementId:function(){return this.ui.alarmSelect.attr("id")},_toAlarmSelectValue:function(e){return e.durationType&&t.isNumber(e.amount)?s.isPredefinedAlarm(this._isAllDay,{duration_type:e.durationType,amount:e.amount,alarm_time:e.alarmTime})?this._isAllDay?[e.durationType,e.amount,e.alarmTime].join("_"):[e.durationType,e.amount].join("_"):"custom":""},_toAlarmObject:function(e){var t=e.split("_");return{durationType:t[0],amount:parseInt(t[1]),alarmTime:t[2]||null}},_triggerAlarmChanged:function(){this.trigger(d.ALARM_CHANGED,t.clone(this._alarm))}});return u.EVENT=d,u.build=function(e){return new u(e)},u}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="flexList -tbSpaceNone -layoutFixed">\n    <span class="flexItem">\n        <span class="uSelect -h32 -bg -block gColorBk2 -langWidth">\n            <select id="<%- cid %>_alarm" class="_alarmSelect">\n                <option value="<%- VALUE.NONE %>"><%- IM(\'web.schedule.alarm.none\') %></option>\n                <% _.each(alarms, function(alarm, index) { %>\n                <option value="<%- alarm.value %>" data-index="<%- index %>"><%- alarm.label %></option>\n                <% }); %>\n                <option value="<%- VALUE.CUSTOM %>"><%- IM(\'web.schedule.alarm.custom\') %></option>\n            </select>\n        </span>\n    </span>\n</div>\n<% if (customEnabled) { %>\n\x3c!-- [D] 비활성시 class="-off" --\x3e\n<div class="option flexList -tbSpaceNone gMat5 gMab16">\n    <div class="uSelect -h32 -bg -block gColorBk2" style="width:82px;">\n        <label for="<%- cid %>_amount" class="gSrOnly">select alarm amount</label>\n        <select id="<%- cid %>_amount" class="_amountSelect">\n            <option value="" disabled hidden selected><%- IM(\'ui.label.selection\') %></option>\n            <% _.each(amounts, function(amount) { %>\n            <option value="<%- amount %>"><%- amount %></option>\n            <% }); %>\n        </select>\n    </div>\n\n    <div class="uSelect -h32 -bg -block gColorBk2 gMal5" style="width:137px;">\n        <label for="<%- cid %>_duration_type" class="gSrOnly">select alarm unit</label>\n        <select id="<%- cid %>_duration_type" class="_durationTypeSelect">\n            <% _.each(durationTypes, function(durationType) { %>\n            <option value="<%- durationType.value %>"><%- durationType.beforeMessage %></option>\n            <% }); %>\n        </select>\n    </div>\n\n    <% if (alarmTimeEnabled) { %>\n    <div class="flexible gMal5 _alarmTimeRegion"></div>\n    <% } %>\n</div>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(2335),a=n(719),r=n(486),l=n(563),c=n(152),d=n(9),u=n(43),h={SELECTED:"SELECTED"},p=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorSignupImportView"},template:i.template(s),ui:{selectBtn:"._selectBtn",closeBtn:"._closeBtn"},events:{"click @ui.selectBtn":function(e){this.trigger(h.SELECTED,this._items[t(e.currentTarget).data("index")])},"click @ui.closeBtn":function(){r.closeTop()}},initialize:function(e){this._items=e.items},templateContext:function(){var e=IM("ui.label.writing");return{items:i.map(this._items,(function(t){var n=t.startAt,i=t.timeZoneId,o=t.title,s=t.createdAt;return n&&(o=[o," (",u.tz(n,i).format("YYYY.MM.DD"),")"].join("")),{title:o,createdAt:s?d.format.date(s,"short_date_time"):e}}))}}});return p.EVENT=h,p.openAsLayer=function(e){var t=a.getMySignups(e.getBandNo()).then((function(t){var n=i.chain(t.items||[]).first(10).map((function(e){return l.createSignup(e).toJSON()})).value(),o=i.chain(e.getAttachment(c.POST_ATTACHMENT_TYPE.SIGNUP).values()).filter((function(e){return!e.get("signupId")})).sortBy((function(e){return-e.get("seq")})).map((function(e){return e.toJSON()})).value();return new p({items:i.first(o.concat(n),10)})}));return r.openPromiseView(t,!1,{width:480,height:563}),t},p}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_title\') %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="previousAttendance">\n            <div class="topNoticeBar">\n                <p class="sDesc gMat0"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_desc\') %></p>\n            </div>\n            <% if (!!items && items.length > 0) { %>\n            <ul class="listLine rScroll -h480">\n                <% _.each(items, function(item, index) { %>\n                <li class="tLine">\n                    <button type="button" class="flexList _selectBtn" data-index="<%- index %>">\n                        <span class="text">\n                            <span class="ellipsis"><%- item.title %></span>\n                            <span class="sub -date"><%- item.createdAt %></span>\n                        </span>\n                    </button>\n                </li>\n                <% }) %>\n            </ul>\n            <% } else { %>\n            <p class="uEmpty -h480">\n                <span><%- IM(\'ui.message.empty_conents\') %></span>\n            </p>\n            <% } %>\n        </div>\n    </div>\n    <footer class="footer -spaceNone">\n        <button type="button" class="btnLyBack uButton -iconLyBack _closeBtn"><span class="gSrOnly"><%- IM(\'ui.label.back\') %></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2337),s=n(165),a={TIMEZONE_CHANGED:"TIMEZONE_CHANGED"},r=i.View.extend({tagName:"span",className:"flexList -tbSpaceNone -layoutFixed",attributes:{"data-viewname":"DTimezoneInputView"},template:t.template(o),ui:{countrySelect:"._countrySelect",timezoneSelect:"._timezoneSelect"},events:{"change @ui.countrySelect":function(){var e=this.ui.countrySelect.val();this._selectedCountry=s.getTimezoneCountry(e),this._selectedCountryTimezones=s.getTimezones(e),this._selectedTimezone=this._selectedCountryTimezones[0],this.trigger(a.TIMEZONE_CHANGED,this._selectedTimezone.id),this.render()},"change @ui.timezoneSelect":function(){var e=this.ui.timezoneSelect.val();this.ui.timezoneSelect.attr("data-value",e),this._selectedTimezone=s.getTimezone(e),this.trigger(a.TIMEZONE_CHANGED,e)}},initialize:function(e){var t=s.getTimezone(e.timezoneId)||s.getCurrentTimezone(),n=t.country.code;this._selectedTimezone=t,this._countries=s.getAllTimezoneCountries(),this._selectedCountry=s.getTimezoneCountry(n),this._selectedCountryTimezones=s.getTimezones(n)},serializeData:function(){return{cid:this.cid,countries:this._countries,selectedCountryTimezones:this._selectedCountryTimezones}},onRender:function(){this.ui.countrySelect.val(this._selectedCountry.code),this.ui.timezoneSelect.val(this._selectedTimezone.id)},getElementId:function(){return this.ui.countrySelect.attr("id")}});return r.EVENT=a,r.build=function(e){return new r(e)},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="flexItem">\n    <span class="uSelect -h32 -bg -block gColorBk2">\n        <select id="timezone_<%- cid %>_country" class="_countrySelect">\n            <% _.each(countries, function(country) { %>\n            <option value="<%- country.code %>"><%- country.name %></option>\n            <% }); %>\n        </select>\n    </span>\n</span>\n<span class="flexItem gMal5">\n    <span class="uSelect -h32 -bg -block gColorBk2">\n        <label for="timezone_<%- cid %>_id" class="gSrOnly">GMT 선택</label>\n        <select id="timezone_<%- cid %>_id" class="_timezoneSelect">\n            <% _.each(selectedCountryTimezones, function(timezone) { %>\n            <option value="<%- timezone.id %>">(<%- timezone.gmtString %>) <%- timezone.cityName %></option>\n            <% }); %>\n        </select>\n    </span>\n</span>'},function(e,t,n){var i=n(152),o=n(563),s=n(2339),a=n(799);e.exports=function(e,t){a.injectAttachmentWidget({postSpecType:i.POST_ATTACHMENT_TYPE.AUDIO,apiType:"audio",createModelFromJSON:o.createAudioByJSON,createWidgetView:a.widgetViewCreator(s)},e,t)}},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(2340),s=n(158);return t.View.extend({attribute:{"data-viewname":"AudioWidgetView"},template:i.template(o),templateContext:function(){var e=Math.floor(this.model.getAudioDuration());return{durationMinuteTime:s.zeropadWithParseInt(e/60,1),durationSecondTime:s.zeropadWithParseInt(e%60,2)}},ui:{btnDelete:"._btnDelete"},triggers:{"click @ui.btnDelete":"remove"},onDomRefresh:function(){this.isRendered()&&!this.$el.hasClass("sf_tOutline")&&this.$el.addClass("sf_tOutline")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent">\n    <div class="uWidget">\n        <div class="item -voice">\n            <div class="uVoicePlayer">\n                <button type="button" class="control -play"><%= IM("web.audioplayer.player.btn.play") %></button>\n                <div class="status">\n                    <span class="timeText">\n                        <span class="minutes"><%= durationMinuteTime %></span>:<span class="second"><%= durationSecondTime %></span>\n                    </span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){var i=n(563),o=n(2342),s=n(2014),a=n(152),r=n(799);e.exports=function(e,t,n,l){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.QUIZ,apiType:"quiz",createModelFromJSON:i.createRichQuizModelByJSON,createWidgetView:function(e,t){return new o({model:t,el:e,noModify:l})},onWidgetModify:r.createLayoutModify((function(e){return s.openLayer(e,n)}))},e,t)}},function(e,t,n){var i=n(4),o=n(2343),s=n(530),a=i.View.extend({options:{noModify:!1},attributes:{"data-viewname":"QuizWidgetView"},template:_.template(o),templateContext:function(){return{takerCountText:s.getTakerCountText(this.model.get("takenMemberCount"),this.model.get("takers").length),showModifyButton:!(this.options.noModify||this.model.isQuizStateOpened())}},ui:{btnModify:"._btnModify",btnDelete:"._btnDelete"},events:{"click @ui.btnModify":function(){this.trigger("modify")}},triggers:{"click @ui.btnDelete":"remove"}});e.exports=a},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <% if (showModifyButton) { %>\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _btnModify"><%- IM("ui.label.modify") %></button>\n    <% } %>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -quiz">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-quiz sf_color" aria-hidden="true">\n                        <use xlink:href="#ico-attach-quiz-24"></use>\n                    </svg>\n                    <span class="status sf_color"><%-IM("post.quiz.title")%></span> <em><%-takerCountText %></em></p>\n                <p class="addTitle"><%- title %></p>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title"><%-IM("quiz.editor.form.title") %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="postWrite">\n            <div class="addWidget">\n                <div class="attachmentQuiz">\n                    <div class="titleWrap">\n                        <label for="title_<%=vid%>" class="gSrOnly"><%- IM("ui.label.title") %></label>\n                        <input class="_title" type="text" id="title_<%=vid%>" maxlength="200" placeholder="<%- IM(\'ui.label.title\') %>" value="<%- title %>">\n                    </div>\n\n                    <div class="optionItem">\n                        \x3c!-- 질문 만들기 --\x3e\n                        <div class="buttonCreateBox">\n                            <button type="button" class="buttonCreate gBoxHoverShadow _btnEditQuestions">\n                                <span class="iconCirclePlus"></span><span class="buttonText"><%-IM("quiz.editor.form.edit_question.btn") %></span>\n                                \x3c!-- [D] 생성된 질문이 0개인경우 미표기 --\x3e\n                                <span class="questions _questionCount"></span>\n                                <span class="iconArrow"></span>\n                            </button>\n                        </div>\n                        \x3c!-- //질문 만들기 --\x3e\n                        \x3c!-- 객관식 보기 순서 섞기 --\x3e\n                        <div class="flexList gMat12 gMab6">\n                            <div class="text">\n                                <label for="isRandomOrderTest" class="labelTitle gFs13"><%-IM("quiz.editor.form.random_order.label") %></label>\n                                <p class="labelDesc gFs12 gColorGr2 gMat4 gMab4"><%-IM("quiz.editor.form.random_order.desc") %></p>\n                            </div>\n                            <div class="etc">\n                                <label for="isRandomOrderTest" class="uCheck -switch ">\n                                    <input type="checkbox" id="isRandomOrderTest" class="checkInput _checkRandomOrderTest">\n                                    <span class="checkLabel">\n                                    <span class="shape "></span>\n                                    <span class="text"></span>\n                                </span>\n                                </label>\n                            </div>\n                        </div>\n                        \x3c!-- //객관식 보기 순서 섞기 --\x3e\n                    </div>\n\n                    <div class="optionItem">\n                        <div class="flexList gMat7 gMab6">\n                            <div class="text">\n                                <label for="checkIsAnswerEssential" class="labelTitle gFs13"><%-IM("quiz.editor.form.all_question_answer_essential.label")%></label>\n                                <p class="labelDesc gFs12 gColorGr2 gMat4 gMab4"><%-IM("quiz.editor.form.all_question_answer_essential.desc")%></p>\n                            </div>\n                            <div class="etc">\n                                <label for="checkIsAnswerEssential" class="uCheck -switch ">\n                                    <input type="checkbox" id="checkIsAnswerEssential" class="checkInput _checkIsAnswerEssential">\n                                        <span class="checkLabel">\n                                        <span class="shape "></span>\n                                        <span class="text"></span>\n                                    </span>\n                                </label>\n                            </div>\n                        </div>\n                    </div>\n                    \x3c!-- 멤버 선택 --\x3e\n                    <div class="optionItem">\n                        <div class="flexList">\n                            <div class="optionItemTitle"><%-IM("quiz.editor.form.taker.title") %></div>\n                            <div class="utillBox">\n                                <button type="button" class="btnAdd _btnSelectTakers" aria-haspopup="listbox" aria-expanded="true"><%-IM("ui.label.add") %></button>\n                            </div>\n                        </div>\n                    </div>\n                    \x3c!-- //멤버 선택 --\x3e\n\n                    \x3c!-- 시작일/종료일 --\x3e\n                    <div class="optionItem">\n                        <div class="optionCheck gMab16 gMat16">\n                            <div class="flexList -h32">\n                                <div class="text gFs13"><%-IM("ui.label.set_period_start")%></div>\n                                <div class="etc _startAtRegion" style="width:346px"></div>\n                            </div>\n                            <div class="flexList -h32 -btN">\n                                <div class="text gFs13"><%-IM("ui.label.set_period_end")%></div>\n                                <div class="etc _endAtRegion" style="width:346px"></div>\n                            </div>\n                            <div class="flexList -h32 -btN">\n                                <div class="text gFs13"><%-IM("ui.label.set_period_timezone")%></div>\n                                <div class="etc _timezoneSelectRegion" style="width:346px"></div>\n                            </div>\n                        </div>\n                    </div>\n                    \x3c!-- //시작일/종료일 --\x3e\n\n                    \x3c!-- 관리자 선택 --\x3e\n                    <div class="optionItem">\n                        <div class="flexList">\n                            <div class="optionItemTitle">\n                                <%-IM("quiz.editor.form.manager.title") %>\n                                <dl class="uHelpGuide -small -close" role="alert" aria-live="assertive">\n                                    <dt><button type="button" class="_btnToggleManagerGuide"><span class="gSrOnly"><%-IM("ui.label.help")%></span></button></dt>\n                                    <dd role="dialog" class="_wrapManagerGuide" style="display: none; width:188px">\n                                        <%-IM("quiz.editor.form.manager.desc")%>\n                                        <button type="button" class="btnLyClose _btnCloseManagerGuide"><span class="gSrOnly"><%-IM("ui.label.close")%></span></button>\n                                    </dd>\n                                </dl>\n                            </div>\n                            <div class="utillBox">\n                                <button type="button" class="btnAdd _btnSelectManagers"></button>\n                            </div>\n                        </div>\n                    </div>\n                    \x3c!-- //관리자 선택 --\x3e\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -confirm _btnComplete"><%-IM("web.btn.attach")%></button>\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(4),s=n(486),a=n(2346),r=n(501),l=n(1004),c=n(160),d=n(2015),u=n(1624),h=n(13),p=o.View.extend({options:{title:IM("web.bandmemberselection.title"),useRemoveAll:!1},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorQuizMemberEntryListView"},template:i.template(a),templateContext:function(){return{title:this.options.title,showRemoveAll:this.options.useRemoveAll}},ui:{memberEntryListRegion:"._memberEntryListRegion",memberEntryCount:"._memberEntryCount",wrapRemoveAll:"._wrapRemoveAll",btnRemoveAll:"._btnRemoveAll",btnAddMemberEntry:"._btnAddMemberEntry",btnBack:"._btnBack",btnConfirm:"._btnConfirm"},regions:{memberEntryListRegion:{el:"@ui.memberEntryListRegion",replaceElement:!0}},events:{"click @ui.btnAddMemberEntry":function(){this._openAddMemberLayer(!1)},"click @ui.btnRemoveAll":function(){this.trigger(p.EVENT.REMOVE_ALL_ENTRIES)},"click @ui.btnBack":"destroy","click @ui.btnConfirm":"destroy"},initialize:function(e){this.bandData=e.bandData,this.memberEntryCollectionView=new u({collection:this.collection})},onAttach:function(){this.showChildView("memberEntryListRegion",this.memberEntryCollectionView),this._renderMemberEntryCount(),this.listenTo(this.memberEntryCollectionView,"entry:remove",(function(e){this.trigger(p.EVENT.REMOVE_ENTRY,e.get("userNo"))})),0===this.collection.length&&this._openAddMemberLayer(!0)},_openAddMemberLayer:function(e){var t=this.collection.pluck("userNo").concat(h.getUserData().getUserNo()),n=d.createSimpleMemberLocalSearchCollection({bandData:this.bandData,excludedUserNos:t,memberOfBandFilterType:c.QUIZ});n.fetchAllMembers().then(i.bind((function(){var t=l.openAsLayerWithOption({bandData:this.bandData,collection:n,supportMemberGroup:!0});this.listenToOnce(t,l.EVENT.MEMBER_SELECTED,(function(e){if(!e.isEmpty()){var t=e.map(i.bind((function(e){return new r(e.toJSON(),{parse:!0})}),this));this.trigger(p.EVENT.ADD_ENTRIES,t)}})),e&&this.listenToOnce(t,"destroy",this.destroy)}),this))},renderCollection:function(e){this.collection=e,this.memberEntryCollectionView.collection=e,this.memberEntryCollectionView.render(),this._renderMemberEntryCount()},_renderMemberEntryCount:function(){this.getUI("memberEntryCount").html(this.collection.length>0?this.collection.length:"")}});p.EVENT={ADD_ENTRIES:"entry:add",REMOVE_ENTRY:"entry:remove",REMOVE_ALL_ENTRIES:"entry:removeAll"},p.openLayer=function(e){var t=new p(e);return s.open(t),t},e.exports=p},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%- title %>&nbsp;<span class="_memberEntryCount"></span></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="memberListBox">\n                <% if (showRemoveAll) { %>\n                <div class="topNoticeBar _wrapRemoveAll">\n                    <button type="button" class="btnDelet _btnRemoveAll"><%-IM("web.postwrite.form_attendance_check.attendee_list.btn_remove_all")%></button>\n                </div>\n                <% } %>\n                <div class="addMemberAttend">\n                    <a href="#" role="button" class="button _btnAddMemberEntry"><%- IM(\'web.postwrite.form_attendance_check.btn_add_members\') %></a>\n                </div>\n                <% // 멤버 목록 %>\n                <div class="_memberEntryListRegion"></div>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%= IM("ui.label.prev") %></span></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(4),s=n(2348),a=n(2349),r=n(2350),l=n(2354),c=n(2356),d=n(2364),u=n(690),h=n(530),p=n(612),m=n(486),_="DOWN",g="UP",f="CHOICE",b="SHORT_ANSWER",v="ESSAY",A=r.EVENT,E=l.EVENT,T=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DQuizQuestionListEditView"},template:i.template(s),ui:{title:"._title",choiceBtn:"._choiceBtn",shortAnswerBtn:"._shortAnswerBtn",essayBtn:"._essayBtn",point:"._point",count:"._count",editBtn:"._editBtn",downBtn:"._downBtn",upBtn:"._upBtn",questions:"._questions",footer:"._footer"},regions:{questions:{el:"@ui.questions",replaceElement:!0},footer:{el:"@ui.footer",replaceElement:!0}},events:{"click @ui.choiceBtn":function(){this._createQuestion(f)},"click @ui.shortAnswerBtn":function(){this._createQuestion(b)},"click @ui.essayBtn":function(){this._createQuestion(v)},"click @ui.editBtn":function(){this._toggleEditMode(!0)},"click @ui.downBtn":function(){this._moveItemUpOrDown(_)},"click @ui.upBtn":function(){this._moveItemUpOrDown(g)}},initialize:function(e){this._editContext=e.editContext,this._questions=this._editContext.getQuestions(),this._selectedQuestion=null,this._questionListView=null},serializeData:function(){return{empty:this._questions.isEmpty(),point:this._getPointText(),count:this._getCountText()}},onRender:function(){this._renderQuestions(),this._renderFooter(!1)},_renderQuestions:function(){this._questions.isEmpty()?this._questionListView=null:(this._questions.resetQuestionNumbers(),this._questionListView=new o.CollectionView({tagName:"ul",className:"questionList",reorderOnSort:!0,collection:this._questions,childView:r,childViewEvents:i.bind((function(){var e={};return e[A.ALL]=i.bind(this._handleItemEvent,this),e}),this)}),this.listenTo(this._questionListView,"reorder",(function(){this._scrollQuestionIntoView(this._selectedQuestion)})),this.showChildView("questions",this._questionListView))},_renderFooter:function(e){var t=l.build({add:!e&&!this._questions.isEmpty(),edit:e,back:!e});this.listenTo(t,E.ALL,this._handleFooterEvent),this.showChildView("footer",t)},_getPointText:function(){return IM("question.edit.list.total_point",{point:this._questions.getTotalPoints()})},_getCountText:function(){return IM("question.edit.list.count",{count:this._questions.size()})},_toggleEditMode:function(e){this._editContext.alertQuizStateOpened()||(this._prevOrder=e?this._questions.toArray():null,this.ui.title.html(e?IM("ui.label.edit_order"):IM("question.edit.list.header_title")),this.ui.editBtn.css("display",e?"none":""),this.ui.downBtn.css("display",e?"":"none"),this.ui.upBtn.css("display",e?"":"none"),this._questionListView.children.invoke("setQuestionItemCheckMode",e),this._renderFooter(e))},_moveItemUpOrDown:function(e){var t=this._questions.indexOf(this._selectedQuestion),n=t+(e===_?1:-1);p.changeModelIndex(this._questions,t,n),this._questions.resetQuestionNumbers()},_scrollQuestionIntoView:function(e){if(!this.isDestroyed()&&e&&this._questionListView){var t=this._questionListView.children.findByModel(e);if(t){var n=t.el;i.isFunction(n.scrollIntoView)&&n.scrollIntoView({block:"nearest",behavior:"smooth"})}}},_restoreOrder:function(){var e=this._questions.models;Array.prototype.splice.apply(e,[0,e.length].concat(this._prevOrder)),this._questions.resetQuestionNumbers(),this._questions.trigger("sort",this._questions,{}),this._toggleEditMode(!1)},_createQuestion:function(e){var t=this._buildQuestionModel(e);this._addToQuestions(t)},_addToQuestions:function(e){if(!this._editContext.alertTakenMemberExist())if(this._questions.size()>=h.QUESTION_MAX_COUNT)alert(IM("ui.message.make_up_to_max_count",{count:h.QUESTION_MAX_COUNT}));else{var t=this._questions.getTotalPoints(),n=this._openQuestionEditView(e,t);this.listenToOnce(n,"confirm",(function(){this._questions.add(e),i.defer(i.bind(this._scrollQuestionIntoView,this,e)),this._updateQuestionList()}))}},_buildQuestionModel:function(e){switch(e){case f:return u.createChoiceType();case b:return u.createShortAnswerType();case v:return u.createEssayType()}},_editQuestion:function(e){var t=this._questions.getTotalPoints()-e.getPoint(),n=this._openQuestionEditView(e,t);this.listenToOnce(n,"confirm",this._updateSummaries)},_deleteQuestion:function(e){this._editContext.alertTakenMemberExist()||confirm(IM("ui.confirm.delete"))&&(this._questions.remove(e),this._updateQuestionList())},_updateQuestionList:function(){!this._questions.isEmpty()&&this._questionListView?(this._questions.resetQuestionNumbers(),this._updateSummaries()):this.render()},_updateSummaries:function(){this.ui.point.html(this._getPointText()),this.ui.count.html(this._getCountText())},_openQuestionEditView:function(e,t){var n={question:e,total:t,editContext:this._editContext};return e.isMultipleChoiceQuestion()?c.openLayer(n):d.openLayer(n)},_handleItemEvent:function(e,t){switch(e){case A.SELECT:this._selectedQuestion=t;break;case A.COPY:this._addToQuestions(t.copyQuestion());break;case A.EDIT:this._editQuestion(t);break;case A.DELETE:this._deleteQuestion(t)}},_handleFooterEvent:function(e){switch(e){case E.CHOICE:this._createQuestion(f);break;case E.SHORT_ANSWER:this._createQuestion(b);break;case E.ESSAY:this._createQuestion(v);break;case E.COMPLETE:this._closeView();break;case E.CANCEL:this._restoreOrder();break;case E.SAVE:this._toggleEditMode(!1);break;case E.BACK:this._closeView()}},_closeView:function(){this.trigger("confirm",this._questions),this.destroy()}});T.openLayer=function(e){var t=new T({editContext:a.create(e)});return m.open(t),t},e.exports=T},function(e,t){e.exports='<div class="lyContent lyQuizContent" style="width:600px;<%= (!empty) ? \'height:700px\' : \'\'%>">\n    <header class="modalHeader">\n        <h1 class="title _title"><%- IM(\'question.edit.list.header_title\') %></h1>\n    </header>\n    <div class="modalBody -spaceNone">\n        <div class="questionsListArea">\n            <% if (empty) { %>\n            <div class="createQuizButtonBox">\n                <div class="createQuizButton -column">\n                    <button class="uButton -sizeXL -confirm _choiceBtn"><%- IM(\'question.edit.list.add_choice\') %></button>\n                    <button class="uButton -sizeXL -confirm _shortAnswerBtn"><%- IM(\'quiz.question_edit.add_short_answer\') %></button>\n                    <button class="uButton -sizeXL -confirm _essayBtn"><%- IM(\'quiz.question_edit.add_essay\') %></button>\n                </div>\n            </div>\n            <% } else { %>\n            <div class="questionStatusBox">\n                <div class="questionStatus">\n                    <span class="totalScore _point"><%- point %></span><span class="questions _count"><%- count %></span>\n                </div>\n                <div class="modificationMode">\n                    <button type="button" class="buttonSelect _editBtn"><%- IM(\'ui.label.edit_order\') %></button>\n                    <button type="button" class="buttonDown _downBtn" style="display:none"><%- IM(\'ui.label.move_down\') %></button>\n                    <button type="button" class="buttonUp _upBtn" style="display:none"><%- IM(\'ui.label.move_up\') %></button>\n                </div>\n            </div>\n            <div class="_questions"></div>\n            <% } %>\n        </div>\n    </div>\n    <div class="_footer"></div>\n</div>'},function(e,t,n){var i=n(530);function o(e){this._quiz=e.quiz,this._bandData=e.bandData,this._questions=this._quiz.get("questions")}o.prototype.getQuestions=function(){return this._questions},o.prototype.getSkinColorClass=function(){return this._bandData.getBandCore().getSkinColorClass()},o.prototype.validatePoint=function(e){var t=i.POINT_MIM_VALUE,n=i.POINT_MAX_VALUE;return!(e<t||n<e)||(alert(IM("question.edit.input.point_error_message",{min:t,max:n})),!1)},o.prototype.isTakenMemberExist=function(){return this._quiz.isTakenMemberExist()},o.prototype.alertTakenMemberExist=function(){return!!this.isTakenMemberExist()&&(alert(IM("postwrite.attach.poll.alert_voted_member_exist")),!0)},o.prototype.isQuizStateOpened=function(){return this._quiz.isQuizStateOpened()},o.prototype.alertQuizStateOpened=function(){return!!this.isQuizStateOpened()&&(alert(IM("postwrite.attach.poll.alert_voted_member_exist")),!0)},o.create=function(e){return new o(e)},e.exports=o},function(e,t,n){var i=n(0),o=n(4),s=n(2351),a=n(1632),r=n(2016),l=n(26),c={ALL:"QUESTION_ITEM_EVENT",SELECT:"SELECT",COPY:"COPY",EDIT:"EDIT",DELETE:"DELETE"},d=o.View.extend({tagName:"li",className:"questionItem",attributes:{"data-viewname":"DQuizQuestionItemEditView"},template:i.template(s),ui:{itemCheckbox:"._itemCheckbox",itemSelect:"._itemSelect",itemTextBox:"._itemTextBox",itemNumber:"._itemNumber",itemFile:"._itemFile",itemImage:"._itemImage",itemMenuBox:"._itemMenuBox",itemMenuBtn:"._itemMenuBtn",itemMenuList:"._itemMenuList",itemCopyBtn:"._itemCopyBtn",itemEditBtn:"._itemEditBtn",itemDeleteBtn:"._itemDeleteBtn"},regions:{itemFile:{el:"@ui.itemFile",replaceElement:!0},itemImage:{el:"@ui.itemImage",replaceElement:!0}},events:{"change @ui.itemSelect":function(){this.ui.itemSelect.prop("checked")&&this._triggerEvent(c.SELECT)},"click @ui.itemTextBox":function(){this._checkable||this._triggerEvent(c.EDIT)},"click @ui.itemMenuBtn":"_toggleMenu","click @ui.itemCopyBtn":function(){this._triggerEvent(c.COPY)},"click @ui.itemEditBtn":function(){this._triggerEvent(c.EDIT)},"click @ui.itemDeleteBtn":function(){this._triggerEvent(c.DELETE)}},modelEvents:{"question:update":"render","question:number":function(){this.ui.itemNumber.html(this._getQuestionNumberText())}},initialize:function(e){this._checkable=!1},serializeData:function(){return{viewId:this.cid,number:this._getQuestionNumberText(),point:this._getPointText(),title:this.model.getTitle()}},onRender:function(){this._renderFileView(),this._renderImageView()},onAttach:function(){this.listenTo(l.getDGlobalChannel(),l.EVENT.HTML_CLICK,this._hideMenu)},onBeforeDetach:function(){this.stopListening(l.getDGlobalChannel())},setQuestionItemCheckMode:function(e){this._checkable=e,this.ui.itemCheckbox.css("display",this._checkable?"":"none"),this.ui.itemSelect.prop("checked",!1),this.ui.itemTextBox.toggleClass("gCursorDefault",this._checkable),this.ui.itemMenuBox.css("display",this._checkable?"none":"")},_getQuestionNumberText:function(){return IM("question.item.number",{number:this.model.getQuestionNumber()})},_getPointText:function(){return IM("question.item.point",{point:this.model.getPoint()})},_renderFileView:function(){var e=this.model.getFile(),t=this.model.getAudio();if(e||t){var n=r.build({file:e,audio:t});this.showChildView("itemFile",n)}},_renderImageView:function(){var e=this.model.getImage(),t=this.model.getVideo();if(e||t){var n=a.build({image:e,video:t});this.showChildView("itemImage",n)}},_toggleMenu:function(){"none"===this.ui.itemMenuList.css("display")&&i.defer(i.bind((function(){this.ui.itemMenuList.css("display","");var e=this.$el.scrollParent().get(0).getBoundingClientRect(),t=this.ui.itemMenuList.get(0).getBoundingClientRect();e.bottom<t.bottom&&this.ui.itemMenuList.addClass("-up")}),this))},_hideMenu:function(){this.ui.itemMenuList.css("display","none").removeClass("-up")},_triggerEvent:function(e){this.trigger(c.ALL,e,this.model)}});d.EVENT=c,e.exports=d},function(e,t){e.exports='<div class="itemCheckBox _itemCheckbox" style="display:none">\n    <label for="item_<%- viewId %>" class="uCheck -radio">\n        <input type="radio" id="item_<%- viewId %>" name="questionItemSelect" class="checkInput _itemSelect">\n        <span class="checkLabel">\n            <span class="shape sf_afterBg"></span>\n            <span class="text"></span>\n        </span>\n    </label>\n</div>\n<div class="questionTextBox _itemTextBox">\n    <div class="questionInfo"><em class="number _itemNumber"><%- number %></em><span class="score"><%- point %></span></div>\n    <div class="questionText"><%- title %></div>\n    <div class="_itemFile" style="display:none"></div>\n</div>\n<div class="_itemImage" style="display:none"></div>\n<div class="moreMenuBox _itemMenuBox">\n    <button type="button" class="btnMore _itemMenuBtn"><span class="gSrOnly"><%- IM(\'web.uicomponent.topbar.button.menuopen\') %></span></button>\n    <div class="lyMenu _itemMenuList" style="display:none;min-width:132px;">\n        <ul>\n            <li><button type="button" class="_itemCopyBtn"><%- IM(\'question.edit.item.copy_btn\') %></button></li>\n            <li><button type="button" class="_itemEditBtn"><%- IM(\'ui.label.modify_long\') %></button></li>\n            <li><button type="button" class="_itemDeleteBtn"><%- IM(\'ui.label.delete_long\') %></button></li>\n        </ul>\n    </div>\n</div>'},function(e,t){e.exports='<img src="<%- imgUrl %>" alt="<%- playIcon ? IM(\'video\') : IM(\'photo\') %>" class="inputThumb _thumbImg">\n<% if (playIcon) { %>\n<span class="iconPlay"><span class="gSrOnly"><%- IM(\'video\') %></span></span>\n<% } %>\n<% if (deleteBtn) { %>\n<button type="button" class="buttonDelete _deleteBtn"><span class="gSrOnly"><%- IM(\'web.commentmodify.attach.btn.delete_attach_info\') %></span></button>\n<% } %>'},function(e,t){e.exports='<div class="fileItem">\n    <span class="fileName <%- isAudio ? \'-voice\' :\'\' %>"><%- fileName %></span><span class="fileSize"><%- fileSize %></span><% if (deleteBtn) { %><button type="button" class="buttonDelete _deleteBtn"><%- IM(\'web.commentmodify.attach.btn.delete_attach_info\') %></button><% } %>\n</div>'},function(e,t,n){var i=n(0),o=n(4),s=n(2355),a=n(26),r={ALL:"QUESTION_FOOTER_EVENT",CHOICE:"CHOICE",SHORT_ANSWER:"SHORT_ANSWER",ESSAY:"ESSAY",COMPLETE:"COMPLETE",CANCEL:"CANCEL",SAVE:"SAVE",BACK:"BACK"},l=o.View.extend({tagName:"footer",className:function(){return this.options.add||this.options.edit?"modalFooter gMal0 gMar0 gPa0 -tLine":"modalFooter gPa0"},attributes:{"data-viewname":"DQuizQuestionListEditFooterView"},template:i.template(s),ui:{footerAddBtn:"._footerAddBtn",footerAddMenu:"._footerAddMenu",footerChoiceBtn:"._footerChoiceBtn",footerShortAnswerBtn:"._footerShortAnswerBtn",footerEssayBtn:"._footerEssayBtn",footerCompleteBtn:"._footerCompleteBtn",footerCancelBtn:"._footerCancelBtn",footerSaveBtn:"._footerSaveBtn",footerBackBtn:"._footerBackBtn"},events:{"click @ui.footerAddBtn":"_toggleAddMenu","click @ui.footerChoiceBtn":function(){this._triggerEvent(r.CHOICE)},"click @ui.footerShortAnswerBtn":function(){this._triggerEvent(r.SHORT_ANSWER)},"click @ui.footerEssayBtn":function(){this._triggerEvent(r.ESSAY)},"click @ui.footerCompleteBtn":function(){this._triggerEvent(r.COMPLETE)},"click @ui.footerCancelBtn":function(){this._triggerEvent(r.CANCEL)},"click @ui.footerSaveBtn":function(){this._triggerEvent(r.SAVE)},"click @ui.footerBackBtn":function(){this._triggerEvent(r.BACK)}},initialize:function(e){this._add=e.add,this._edit=e.edit,this._back=e.back},serializeData:function(){return{add:this._add,edit:this._edit,back:this._back}},onAttach:function(){this.listenTo(a.getDGlobalChannel(),a.EVENT.HTML_CLICK,this._hideAddMenu)},onBeforeDetach:function(){this.stopListening(a.getDGlobalChannel())},_toggleAddMenu:function(){"none"===this.ui.footerAddMenu.css("display")&&i.defer(i.bind((function(){this.ui.footerAddMenu.css("display","")}),this))},_hideAddMenu:function(){this.ui.footerAddMenu.css("display","none")},_triggerEvent:function(e){this.trigger(r.ALL,e)}});l.EVENT=r,l.build=function(e){return new l(e)},e.exports=l},function(e,t){e.exports='<% if (add) { %>\n<div class="buttonBox gPal15 gPar15 gPat12 gPab12 -flexible">\n    <div class="createButton">\n        <button class="uButton -createPlus -cancel gMar0 -h38 _footerAddBtn"><%- IM(\'quiz.question_edit.add_question\') %></button>\n        <div class="lyMenu _footerAddMenu" style="display:none;min-width:132px;">\n            <ul>\n                <li><button type="button" class="_footerChoiceBtn"><%- IM(\'question.edit.list.add_choice\') %></button></li>\n                <li><button type="button" class="_footerShortAnswerBtn"><%- IM(\'quiz.question_edit.add_short_answer\') %></button></li>\n                <li><button type="button" class="_footerEssayBtn"><%- IM(\'quiz.question_edit.add_essay\') %></button></li>\n            </ul>\n        </div>\n    </div>\n    <button class="uButton -confirm -h38 _footerCompleteBtn"><%- IM(\'ui.label.complete\') %></button>\n</div>\n<% } %>\n<% if (edit) { %>\n<div class="buttonBox gPal15 gPar15 gPat21 gPab25">\n    <button type="button" class="uButton -cancel _footerCancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n    <button type="button" class="uButton -confirm _footerSaveBtn"><%- IM(\'ui.label.save\') %></button>\n</div>\n<% } %>\n<% if (back) { %>\n<button type="button" class="btnLyBack uButton -iconLyBack _footerBackBtn"><span class="gSrOnly"><%- IM(\'ui.label.back\') %></span></button>\n<% } %>'},function(e,t,n){var i=n(0),o=n(4),s=n(2357),a=n(2017),r=n(2019),l=n(2361),c=n(530),d=n(486),u=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DQuizChoiceQuestionEditView"},template:i.template(s),ui:{title:"._title",selectBtn:"._selectBtn",choices:"._choices",addBtn:"._addBtn",multiple:"._multiple",point:"._point",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},regions:{title:{el:"@ui.title",replaceElement:!0},choices:{el:"@ui.choices",replaceElement:!0},point:{el:"@ui.point",replaceElement:!0}},events:{"click @ui.selectBtn":"_toggleCheckable","click @ui.addBtn":"_addEmptyChoice","change @ui.multiple":"_updateMultiple","click @ui.multiple":"_checkEditable","click @ui.cancelBtn":"_closeView","click @ui.confirmBtn":"_saveInputValues"},initialize:function(e){this.model=e.question,this._total=e.total,this._editContext=e.editContext,this._titleAttachment={title:this.model.getTitle(),image:this.model.getImage(),video:this.model.getVideo(),file:this.model.getFile(),audio:this.model.getAudio()},this._choices=this.model.getChoices().cloneChoices(),this._point=this.model.getPoint(),this._multiple=this.model.hasMultipleCorrectAnswers(),this._checkable=!1,this._choiceListView=null},serializeData:function(){return{viewId:this.cid,multiple:this._multiple}},onRender:function(){this._setEditable(),this._renderTitleEditView(),this._toggleSelectBtn(),this._renderChoiceList(),this._renderPointEditView(),this._toggleAddBtn(),this._toggleConfirmBtn()},_setEditable:function(){var e=this._editContext.isTakenMemberExist();this.ui.multiple.prop("readonly",e)},_renderTitleEditView:function(){var e=i.extend({editContext:this._editContext},this._titleAttachment),t=a.buildChoiceStyle(e);this.listenTo(t,t.EVENT.UPDATE,(function(e){this._titleAttachment=e,this._toggleConfirmBtn()})),this.showChildView("title",t)},_renderPointEditView:function(){var e=r.build({point:this._point,total:this._total,editContext:this._editContext});this.listenTo(e,e.EVENT.UPDATE,(function(e){this._point=e})),this.showChildView("point",e)},_renderChoiceList:function(){this._choiceListView=l.build({collection:this._choices,checkable:this._checkable,multiple:this._multiple,editContext:this._editContext}),this.listenTo(this._choiceListView,this._choiceListView.EVENT.UPDATE,(function(){this._toggleConfirmBtn(),this._toggleSelectBtn()})),this.showChildView("choices",this._choiceListView)},_toggleConfirmBtn:function(){var e=this._canEnableConfirmBtn();this.ui.confirmBtn.prop("disabled",!e)},_checkEditable:function(e){this._editContext.alertTakenMemberExist()&&e.preventDefault()},_toggleCheckable:function(){this._editContext.alertTakenMemberExist()||(this._checkable||this._choices.hasContent())&&(this._checkable=!this._checkable,this._toggleSelectBtn(),this._toggleAddBtn(),this._choiceListView.setCheckable(this._checkable))},_addEmptyChoice:function(){this._choiceListView.addEmptyChoice()},_updateMultiple:function(){this._multiple=this.ui.multiple.prop("checked"),this._choiceListView.setMultiple(this._multiple)},_toggleSelectBtn:function(){var e=this._checkable?IM("ui.label.complete"):IM("question.edit.input.choose_answer"),t=this._choices.hasContent();this.ui.selectBtn.html(e).toggleClass("-isActive",t).prop("disabled",!t)},_toggleAddBtn:function(){this.ui.addBtn.prop("disabled",this._checkable)},_canEnableConfirmBtn:function(){return!!this._titleAttachment.title&&!!this._choices.hasContent()},_saveInputValues:function(){if(this._editContext.isTakenMemberExist())this._closeView();else if(this._canEnableConfirmBtn()){if(!this._editContext.validatePoint(this._point))return this._point=c.POINT_DEFAULT_VALUE,void this._renderPointEditView();if(this._updateMultiple(),this._validateCorrectAnswers()){var e={point:this._point,choices:this._choices,hasMultipleCorrectAnswers:this._multiple};this.model.setValues(i.extend(e,this._titleAttachment)),this.trigger("confirm",this.model),this._closeView()}}else this._toggleConfirmBtn()},_validateCorrectAnswers:function(){var e=this._choices.getCorrectAnswerCount();return 0!==e&&e>1===this._multiple&&!this._hasEmptyCorrectAnswer()||(alert(IM("question.edit.input.check_correct_answer")),!1)},_hasEmptyCorrectAnswer:function(){return this._choices.some((function(e){return e.isCorrectAnswer()&&!e.hasContent()}))},_closeView:function(){this.destroy()}});u.openLayer=function(e){var t=new u(e);return d.open(t),t},e.exports=u},function(e,t){e.exports='<div class="lyContent" style="width:600px">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'question.edit.input.header_title\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="questionCreateArea">\n            <div class="_title" style="display:none"></div>\n\n            <div class="questionListBox">\n                <h2 class="boxTitle"><%- IM(\'question.edit.input.choices\') %></h2>\n                <div class="selectionMode">\n                    <button type="button" class="buttonSelect _selectBtn" disabled><%- IM(\'question.edit.input.choose_answer\') %></button>\n                </div>\n\n                <div class="_choices"></div>\n\n                <button type="button" class="buttonAddItem _addBtn" disabled><%- IM(\'question.edit.input.add_choice\') %></button>\n            </div>\n\n            <div class="createSetting">\n                <div class="settingText">\n                    <div class="title"><%- IM(\'question.edit.input.multiple_answers\') %></div>\n                </div>\n                <div class="settingAction">\n                    <label for="notice_<%- viewId %>" class="uCheck -switch">\n                        <input type="checkbox" id="notice_<%- viewId %>" name="uCheck" class="checkInput _multiple" <%- multiple ? \'checked\' : \'\' %>>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"></span>\n                        </span>\n                    </label>\n                </div>\n            </div>\n\n            <div class="_point" style="display:none"></div>\n        </div>\n    </div>\n    <footer class="modalFooter gMar0 gMal0 -tLine">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn" disabled><%- IM(\'ui.label.save\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="uTextarea">\n    <textarea class="_title" maxlength="<%- maxlength %>" placeholder="<%- IM(\'question.edit.input.title_placeholder\') %>" style="max-width:454px;height:56px;"><%- title %></textarea>\n    <span class="border"></span>\n</div>\n<div class="_attachment" style="display:none"></div>'},function(e,t){e.exports='<% if (uploadImage) { %>\n<label class="uploadImg _imageInput"><input type="file" accept="image/*"></label>\n<% } %>\n<% if (uploadFile) { %>\n<button type="button" class="uploadFile _fileMenuBtn"><span class="gSrOnly"><%- IM(\'web.postwrite.attach.d_title.file\') %></span></button>\n<div class="lyMenu _fileMenuBox" style="display:none;min-width:147px;">\n    <ul>\n        <li><label class="labelButton _fileInput"><%- IM(\'file\') %><input type="file" accept="*/*"></label></li>\n        <li><label class="labelButton _audioInput"><%- IM(\'ui.label.audio_file\') %><input type="file" accept="*/*"></label></li>\n    </ul>\n</div>\n<% } %>\n<% if (handleClassName) { %>\n<button type="button" class="uButton -iconListMove <%- handleClassName %>"><span class="gSrOnly"><%- IM(\'ui.label.move\') %></span></button>\n<% } %>\n<% if (deleteBtn) { %>\n<button type="button" class="buttonDelete _deleteBtn"><span class="gSrOnly"><%- IM(\'ui.label.delete\') %></span></button>\n<% } %>'},function(e,t){e.exports='<div class="settingText">\n    <div class="title"><%- IM(\'question.edit.input.point\') %></div>\n    <div class="subText _total"><%- total %></div>\n</div>\n<div class="settingAction">\n    <span class="uInput -h32" style="width:78px">\n        <input type="text" value="<%- point %>" class="_point" maxlength="3">\n        <span class="border"></span>\n    </span>\n</div>'},function(e,t,n){var i=n(4),o=n(2362),s=n(530),a=n(612),r=n(197),l=o.SELECTOR,c=o.EVENT,d=i.CollectionView.extend({EVENT:{UPDATE:"UPDATE"},tagName:"ul",className:"questionList",attributes:{"data-viewname":"DQuizChoiceListEditView"},reorderOnSort:!0,childView:o,childViewOptions:function(){return{checkable:this._checkable,editContext:this._editContext}},childViewEvents:function(){var e={};return e[c.ALL]="_handleItemEvent",e},initialize:function(e){this._checkable=e.checkable,this._multiple=e.multiple,this._editContext=e.editContext},onBeforeRender:function(){this._destroySortable(),this._addDefaultChoice()},onRender:function(){this._toggleListClass(),this._createSortable()},onBeforeDetach:function(){this._destroySortable()},setCheckable:function(e){this._checkable=e,this._toggleListClass(),this.children.invoke("setCheckable",this._checkable)},setMultiple:function(e){this._multiple=e},addEmptyChoice:function(){if(!this._editContext.alertTakenMemberExist()){var e=s.CHOICE_MAX_COUNT;this.collection.size()>=e?alert(IM("question.edit.input.add_up_to_max_count_choices",{count:e})):(this.collection.addEmptyChoice(),setTimeout(_.bind((function(){var e=this.children.last();e&&e.setFocus()}),this)))}},_toggleListClass:function(){this.$el.toggleClass("-isSelectionMode",this._checkable)},_addDefaultChoice:function(){if(!this._editContext.isTakenMemberExist())for(var e=s.CHOICE_DEFAULT_COUNT-this.collection.size(),t=0;t<e;t++)this.collection.addEmptyChoice()},_handleItemEvent:function(e,t){switch(e){case c.ANSWER:this._uncheckOtherCorrectAnswers(t);break;case c.DELETE:this._deleteChoice(t);break;case c.ADD:this.addEmptyChoice()}this.trigger(this.EVENT.UPDATE)},_uncheckOtherCorrectAnswers:function(e){!this._multiple&&e.isCorrectAnswer()&&this.children.each((function(t){t.model!==e&&t.uncheckCorrectAnswer()}))},_deleteChoice:function(e){this._editContext.alertTakenMemberExist()||confirm(IM("ui.confirm.delete"))&&(this.collection.remove(e),this._addDefaultChoice())},_createSortable:function(){this._destroySortable(),this._sortable=r.create(this.el,{group:"choices",sort:!this._editContext.isTakenMemberExist(),animation:150,handle:l.HANDLE,draggable:l.DRAGGABLE,scroll:!0,onEnd:_.bind((function(e){this._editContext.alertTakenMemberExist()||a.changeModelIndex(this.collection,e.oldIndex,e.newIndex)}),this)})},_destroySortable:function(){this._sortable&&(this._sortable.destroy(),this._sortable=null)}});d.build=function(e){return new d(e)},e.exports=d},function(e,t,n){var i=n(0),o=n(10),s=n(4),a=n(2363),r=n(2018),l=n(1632),c=n(2020),d=n(2021),u=n(530),h={ALL:"CHOICE_ITEM_EVENT",TITLE:"TITLE",ANSWER:"ANSWER",IMAGE:"IMAGE",DELETE:"DELETE",ADD:"ADD"},p={DRAGGABLE:"._itemDraggable",HANDLE:"._itemHandle"},m=s.View.extend({tagName:"li",className:"questionItem _itemDraggable",attributes:{"data-viewname":"DQuizChoiceItemEditView"},template:i.template(a),ui:{title:"._title",correct:"._correct",buttons:"._buttons",image:"._image"},regions:{buttons:{el:"@ui.buttons",replaceElement:!0},image:{el:"@ui.image",replaceElement:!0}},events:{"click @ui.title":"_checkEditable","click @ui.correct":function(e){this._checkable||e.preventDefault()},"change @ui.correct":function(){this.model.setCorrectAnswer(this.ui.correct.prop("checked")),this._triggerEvent(h.ANSWER)}},initialize:function(e){this._checkable=e.checkable,this._editContext=e.editContext},serializeData:function(){return{viewId:this.cid,correct:this.model.isCorrectAnswer(),title:this.model.getTitle()}},onRender:function(){this.setCheckable(this._checkable),this._setTitleMaxLength(),this._createFocusMover()},setCheckable:function(e){this._checkable=e;var t=this._editContext.isTakenMemberExist();this.ui.title.prop("contenteditable",!t&&!this._checkable),this.ui.correct.prop("readonly",t),this._renderButtonGroupView(),this._renderImageEditView()},uncheckCorrectAnswer:function(){this.ui.correct.prop("checked",!1),this.model.setCorrectAnswer(!1)},setFocus:function(){this.isRendered()&&this.ui.title.focus()},_setTitleMaxLength:function(){c.setMaxLength({element:this.ui.title,maxlength:u.CHOICE_TITLE_MAX_LENGTH,newline:!1,onInput:i.bind((function(e){this.model.setTitle(o.trim(e)),this._triggerEvent(h.TITLE)}),this)})},_createFocusMover:function(){d.createSimpleNextMover({itemEl:this.el,selector:this.ui.title.selector,onLast:i.bind(this._triggerEvent,this,h.ADD)})},_renderButtonGroupView:function(){var e=this.getRegion("buttons");if(this._checkable)e.empty();else{var t=r.build({uploadImage:!0,handleClassName:"_itemHandle",deleteBtn:!0,editContext:this._editContext});this.listenTo(t,t.EVENT.UPLOAD,(function(e){this._updateImage(e.image)})),this.listenTo(t,t.EVENT.DELETE,(function(){this._triggerEvent(h.DELETE)})),e.show(t)}},_renderImageEditView:function(){var e=this.getRegion("image"),t=this.model.getImage(),n=!!t;if(this.$el.toggleClass("-isAttach",n),n){var i=l.build({image:t,deletable:!this._checkable});this.listenTo(i,i.EVENT.DELETE,(function(){this._updateImage(null)})),e.show(i)}else e.empty()},_updateImage:function(e){this.model.setImage(e),this._renderImageEditView(),this._triggerEvent(h.IMAGE)},_checkEditable:function(e){this._editContext.alertTakenMemberExist()&&e.preventDefault()},_triggerEvent:function(e){this.model.hasContent()||this.uncheckCorrectAnswer(),this.trigger(h.ALL,e,this.model)}});m.SELECTOR=p,m.EVENT=h,e.exports=m},function(e,t){e.exports='<div class="itemInputBox">\n    <div class="itemInput _title" contenteditable="true" placeholder="<%- IM(\'question.edit.input.choices\') %>"><%- title %></div>\n    <div class="itemCheck">\n        <label for="item_<%- viewId %>" class="uCheck -checkbox">\n            <input type="checkbox" id="item_<%- viewId %>" class="checkInput _correct" <%- correct ? \'checked\' : \'\' %>>\n            <span class="checkLabel">\n                <span class="shape"></span>\n                <span class="text"></span>\n            </span>\n        </label>\n    </div>\n    <div class="btnUploadWrap _buttons" style="display:none"></div>\n</div>\n<div class="_image" style="display:none"></div>\n'},function(e,t,n){var i=n(0),o=n(4),s=n(2365),a=n(2017),r=n(2019),l=n(2366),c=n(530),d=n(486),u=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DQuizEssayQuestionEditView"},template:i.template(s),ui:{title:"._title",isAttachmentEnabled:"._isAttachmentEnabled",correctAnswerEditBtn:"._correctAnswerEditBtn",correctAnswerCount:"._correctAnswerCount",point:"._point",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},regions:{title:{el:"@ui.title",replaceElement:!0},point:{el:"@ui.point",replaceElement:!0}},events:{"click @ui.isAttachmentEnabled":"_checkEditable","click @ui.correctAnswerEditBtn":"_editCorrectAnswer","click @ui.cancelBtn":"_closeView","click @ui.confirmBtn":"_saveInputValues"},initialize:function(e){this.model=e.question,this._total=e.total,this._editContext=e.editContext,this._titleAttachment={title:this.model.getTitle(),image:this.model.getImage(),video:this.model.getVideo(),file:this.model.getFile(),audio:this.model.getAudio()},this._correctEssayAnswers=this.model.getCorrectEssayAnswers(),this._point=this.model.getPoint()},serializeData:function(){return{viewId:this.cid,attachmentMenu:this.model.isEssayQuestion(),correctAnswerMenu:this.model.isShortAnswerQuestion()}},onRender:function(){this._setEditable(),this._renderTitleEditView(),this._setAttachmentEnabledChecked(),this._setCorrectAnswerCountText(),this._renderPointEditView(),this._toggleConfirmBtn()},_setEditable:function(){var e=this._editContext.isTakenMemberExist();this.ui.isAttachmentEnabled.prop("readonly",e),this.ui.point.prop("readonly",e)},_renderTitleEditView:function(){var e=i.extend({editContext:this._editContext},this._titleAttachment),t=a.buildEssayStyle(e);this.listenTo(t,t.EVENT.UPDATE,(function(e){this._titleAttachment=e,this._toggleConfirmBtn()})),this.showChildView("title",t)},_setAttachmentEnabledChecked:function(){this.ui.isAttachmentEnabled.prop("checked",this.model.isAttachmentEnabled())},_setCorrectAnswerCountText:function(){var e=i.size(this._correctEssayAnswers);this.ui.correctAnswerCount.css("display",0===e?"none":"").html(IM("ui.label.count",{count:e||"0"}))},_renderPointEditView:function(){var e=r.build({point:this._point,total:this._total,editContext:this._editContext});this.listenTo(e,e.EVENT.UPDATE,(function(e){this._point=e})),this.showChildView("point",e)},_toggleConfirmBtn:function(){var e=this._canEnableConfirmBtn();this.ui.confirmBtn.prop("disabled",!e)},_checkEditable:function(e){this._editContext.alertTakenMemberExist()&&e.preventDefault()},_editCorrectAnswer:function(){var e=l.openLayer({correctEssayAnswers:this._correctEssayAnswers,editContext:this._editContext});this.listenTo(e,e.EVENT.UPDATE,(function(e){this._correctEssayAnswers=e,this._setCorrectAnswerCountText()}))},_canEnableConfirmBtn:function(){return!!this._titleAttachment.title},_saveInputValues:function(){if(this._editContext.isTakenMemberExist())this._closeView();else if(this._canEnableConfirmBtn())if(this.model.isShortAnswerQuestion()&&i.isEmpty(this._correctEssayAnswers))alert(IM("quiz.question_edit.check_correct_essay_answers"));else{if(!this._editContext.validatePoint(this._point))return this._point=c.POINT_DEFAULT_VALUE,void this._renderPointEditView();var e={point:this._point,isAttachmentEnabled:this.ui.isAttachmentEnabled.prop("checked"),correctEssayAnswers:this._correctEssayAnswers};this.model.setValues(i.extend(e,this._titleAttachment)),this.trigger("confirm",this.model),this._closeView()}else this._toggleConfirmBtn()},_closeView:function(){this.destroy()}});u.openLayer=function(e){var t=new u(e);return d.open(t),t},e.exports=u},function(e,t){e.exports='<div class="lyContent" style="width:600px">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'question.edit.input.header_title\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="questionCreateArea">\n            <div class="_title" style="display:none"></div>\n\n            <% if (attachmentMenu) { %>\n            <div class="createSetting">\n                <div class="settingText">\n                    <div class="title"><%- IM(\'question.edit.input.attachment\') %></div>\n                    <div class="subText"><%- IM(\'question.edit.input.attachment_desc\') %></div>\n                </div>\n                <div class="settingAction">\n                    <label for="notice_<%- viewId %>" class="uCheck -switch">\n                        <input type="checkbox" id="notice_<%- viewId %>" name="uCheck" class="checkInput _isAttachmentEnabled">\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"></span>\n                        </span>\n                    </label>\n                </div>\n            </div>\n            <% } %>\n\n            <% if (correctAnswerMenu) { %>\n            <button type="button" class="createSetting -clickTypeOption _correctAnswerEditBtn">\n                <div class="settingText">\n                    <div class="title"><%- IM(\'quiz.question_edit.input_correct_answer\') %></div>\n                    <div class="subText"><%- IM(\'quiz.question_edit.input_correct_answer_desc\') %></div>\n                </div>\n                <div class="settingAction">\n                    <span class="correctAnswer _correctAnswerCount" style="display:none"></span>\n                </div>\n            </button>\n            <% } %>\n\n            <div class="_point"></div>\n        </div>\n    </div>\n    <footer class="modalFooter gMar0 gMal0 -tLine">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn" disabled><%- IM(\'ui.label.save\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(10),s=n(4),a=n(6),r=n(2367),l=n(2368),c=n(530),d=n(486),u=n(668),h=l.EVENT,p=c.CORRECT_ESSAY_ANSWER_MAX_COUNT,m=s.View.extend({EVENT:{UPDATE:"UPDATE"},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DQuizCorrectEssayAnswerListEditView"},template:i.template(r),ui:{answerList:"._answerList",addBtn:"._addBtn",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},regions:{answerList:{el:"@ui.answerList",replaceElement:!0}},events:{"click @ui.addBtn":"_addAnswer","click @ui.cancelBtn":"_cancel","click @ui.confirmBtn":"_confirm"},initialize:function(e){this._editContext=e.editContext,this._answers=i.map(e.correctEssayAnswers,o.trim,o),this._collection=new a.Collection(i.map(this._answers,(function(e){return{answer:e}})))},serializeData:function(){return{max:p}},onBeforeRender:function(){this._addDefaultAnswer(),this._answerListView=null},onRender:function(){this._renderAnswerListView(),this._toggleAddBtn()},onAttach:function(){this._setInitFocus()},_renderAnswerListView:function(){this._answerListView=new s.CollectionView({tagName:"div",className:"enterAnswerBox",collection:this._collection,childView:l,childViewOptions:{editContext:this._editContext},childViewEvents:i.bind((function(){var e={};return e[h.ALL]=i.bind(this._handleItemEvent,this),e}),this)}),this.showChildView("answerList",this._answerListView)},_handleItemEvent:function(e){switch(e){case h.ADD:this._addAnswer()}},_setInitFocus:function(){var e=this._answerListView?this._answerListView.children.first():null;e&&e.setFocus()},_toggleAddBtn:function(){var e=this._canAddAnswer();this.ui.addBtn.css("display",e?"":"none")},_canAddAnswer:function(){return!(this._collection.size()>=p)&&!this._editContext.isTakenMemberExist()},_addAnswer:function(){this._canAddAnswer()&&(this._collection.add({}),this._toggleAddBtn(),setTimeout(i.bind((function(){var e=this._answerListView?this._answerListView.children.last():null;e&&e.setFocus()}),this)))},_addDefaultAnswer:function(){if(this._canAddAnswer())for(var e=c.CORRECT_ESSAY_ANSWER_DEFAULT_COUNT-this._collection.size(),t=0;t<e;t++)this._collection.add({})},_getEditedAnswers:function(){var e=this._collection.map((function(e){return o.trim(e.get("answer"))}));return i.compact(e)},_cancel:function(){i.isEqual(this._answers,this._getEditedAnswers())?this.destroy():u.openConfirm({bodyTitle:IM("confirm.close_without_save"),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no"),withoutHiding:!0}).confirm(i.bind(this.destroy,this))},_confirm:function(){this.trigger(this.EVENT.UPDATE,this._getEditedAnswers()),this.destroy()}});m.openLayer=function(e){var t=new m(e);return d.openWithoutHiding(t),t},e.exports=m},function(e,t){e.exports='<div class="lyContent" style="width:353px">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'quiz.question_edit.input_correct_answer\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="enterAnswerArea">\n            <div class="_answerList" style="display:none"></div>\n            <button type="button" class="buttonAddItem _addBtn"><%- IM(\'quiz.question_edit.add_correct_answer\') %></button>\n            <ul class="quizGuideList gMat16">\n                <li class="quizGuideItem"><%- IM(\'quiz.question_edit.add_correct_answer_desc1\', {max: max}) %></li>\n                <li class="quizGuideItem"><%- IM(\'quiz.question_edit.add_correct_answer_desc2\') %></li>\n            </ul>\n        </div>\n    </div>\n    <footer class="modalFooter gMar0 gMal0">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(10),s=n(4),a=n(2369),r=n(530),l=n(2021),c={ALL:"ANSWER_ITEM_EVENT-ITEM",ADD:"ADD"},d=r.CORRECT_ESSAY_ANSWER_MAX_LENGTH,u=s.View.extend({tagName:"div",className:"answerInput",attributes:{"data-viewname":"DQuizCorrectEssayAnswerItemEditView"},template:i.template(a),ui:{answer:"._answer"},events:{"click @ui.answer":"_checkEditable","input @ui.answer":"_inputAnswer"},initialize:function(e){this._editContext=e.editContext},serializeData:function(){return{maxlength:d,answer:this.model.get("answer")}},onRender:function(){this._setEditable(),this._createFocusMover()},setFocus:function(){this.isRendered()&&this.ui.answer.focus()},_setEditable:function(){var e=this._editContext.isTakenMemberExist();this.ui.answer.prop("readonly",e)},_createFocusMover:function(){l.createSimpleNextMover({itemEl:this.el,selector:this.ui.answer.selector,onLast:i.bind(this._triggerEvent,this,c.ADD)})},_checkEditable:function(e){this._editContext.alertTakenMemberExist()&&e.preventDefault()},_inputAnswer:function(){var e=o.trim(this.ui.answer.val()).substring(0,d);this.model.set("answer",e)},_triggerEvent:function(e){this.trigger(c.ALL,e,this.model)}});u.EVENT=c,e.exports=u},function(e,t){e.exports='<input type="text" class="inputText _answer" maxlength="<%- maxlength %>" placeholder="<%- IM(\'quiz.question_edit.input_correct_answer\') %>" value="<%- answer %>">\n<span class="inputLabel"><span class="gSrOnly"><%- IM(\'quiz.question_edit.input_correct_answer\') %></span></span>'},function(e,t,n){var i=n(563),o=n(2371),s=n(2024),a=n(152),r=n(799);e.exports=function(e,t,n){r.injectAttachmentWidget({postSpecType:a.POST_ATTACHMENT_TYPE.SURVEY,apiType:"survey",createModelFromJSON:i.createRichSurveyModelByJSON,createWidgetView:function(e,t){return new o({model:t,el:e})},onWidgetModify:r.createLayoutModify((function(e){return s.openLayer(e,n)}))},e,t)}},function(e,t,n){var i=n(4),o=n(2372),s=n(622),a=i.View.extend({options:{noModify:!1},attributes:{"data-viewname":"SurveyWidgetView"},template:_.template(o),templateContext:function(){return{surveyeeCountText:s.getSurveyeeCountText(this.model.get("respondedMemberCount"),this.model.get("isSurveyeeQualified")&&this.model.get("surveyees").length),showModifyButton:!(this.options.noModify||this.model.isEnded())}},ui:{btnModify:"._btnModify",btnDelete:"._btnDelete"},events:{"click @ui.btnModify":function(){this.trigger("modify")}},triggers:{"click @ui.btnDelete":"remove"}});e.exports=a},function(e,t){e.exports='<div class="bandWidgetBtnWrap">\n    <% if (showModifyButton) { %>\n    <button type="button" class="bandWidgetBtn uButton -sizeS -modify _btnModify"><%- IM("ui.label.modify") %></button>\n    <% } %>\n    <button type="button" class="bandWidgetBtn -del uButton -sizeS sf_bg _btnDelete"><%- IM("ui.label.delete") %></button>\n</div>\n\n<div class="bandWidgetContent sf_tOutline">\n    <div class="uWidget">\n        <div class="item -survey">\n            <div class="addHead">\n                <p class="addStatus">\n                    <svg class="svgIcon ico-survey sf_color" aria-hidden="true">\n                        <use xlink:href="#ico-attach-survey-24"></use>\n                    </svg>\n                    <span class="status sf_color"><%-IM("survey.editor.form.title")%></span> <em><%-surveyeeCountText%></em>\n                </p>\n                <p class="addTitle"><%- title %></p>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title"><%-IM("survey.editor.form.title")%></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="postWrite">\n            <div class="addWidget">\n                <div class="attachmentQuiz attachmentSurvey">\n                    \x3c!-- 설문 제목 --\x3e\n                    <div class="titleWrap">\n                        <div class="uInput">\n                            <label for="title_<%=vid%>" class="gSrOnly"><%- IM("ui.label.title") %></label>\n                            <input class="_title" type="text" id="title_<%=vid%>" maxlength="200" placeholder="<%- IM(\'ui.label.title\') %>" value="<%- title %>">\n                            <span class="border"></span>\n                        </div>\n\n                        <div class="previousCheck">\n                            <button type="button" class="btnLoad _btnImportPrevSurvey"><span class="gSrOnly"><%-IM("survey.editor.form.previous_content.btn")%></span></button>\n                            <span class="_importHelpGuideRegion"></span>\n                        </div>\n                    </div>\n                    \x3c!-- //설문 제목 --\x3e\n\n                    \x3c!-- 설문 설명 --\x3e\n                    <div class="textareaBox">\n                        <div class="uTextarea">\n                            <textarea class="_description" maxlength="500" placeholder="<%-IM("survey.editor.form.description.placeholder")%>"><%= description %></textarea>\n                            <span class="border"></span>\n                        </div>\n                    </div>\n                    \x3c!-- //설문 설명 --\x3e\n\n                    <div class="optionItem">\n                        \x3c!-- 질문 만들기 --\x3e\n                        <div class="buttonCreateBox">\n                            <button type="button" class="buttonCreate gBoxHoverShadow _btnEditQuestions">\n                                <span class="iconCirclePlus"></span><span class="buttonText"><%-IM("survey.editor.form.edit_question.btn") %></span>\n                                <span class="questions _questionCount"></span>\n                                <span class="iconArrow"></span>\n                            </button>\n                        </div>\n                        \x3c!-- //질문 만들기 --\x3e\n                    </div>\n\n                    \x3c!-- 시작일/종료일 --\x3e\n                    <div class="optionItem">\n                        <div class="optionCheck gMab16 gMat16">\n                            <div class="flexList -h32">\n                                <div class="text gFs13"><%-IM("ui.label.set_period_start")%></div>\n                                <div class="etc _startAtRegion" style="width:346px"></div>\n                            </div>\n                            <div class="flexList -h32 -btN">\n                                <div class="text gFs13"><%-IM("ui.label.set_period_end")%></div>\n                                <div class="etc _endAtRegion" style="width:346px"></div>\n                            </div>\n                            <div class="flexList -h32 -btN">\n                                <div class="text gFs13"><%-IM("ui.label.set_period_timezone")%></div>\n                                <div class="etc _timezoneSelectRegion" style="width:346px"></div>\n                            </div>\n                        </div>\n                    </div>\n                    \x3c!-- //시작일/종료일 --\x3e\n\n\n                    <% if (showSurveyeeQualified) { %>\n                    \x3c!-- 설문 참여 멤버 선택 --\x3e\n                    <div class="optionItem">\n                        <div class="flexList">\n                            <div class="optionItemTitle"><%-IM("survey.editor.form.surveyee.title") %></div>\n                            <div class="utillBox">\n                                <button type="button" class="btnAdd _btnSelectSurveyees" aria-haspopup="listbox" aria-expanded="true"><%-IM("ui.label.add") %></button>\n                            </div>\n                        </div>\n                    </div>\n                    \x3c!-- //설문 참여 멤버 선택 --\x3e\n                    <% } %>\n\n                    \x3c!-- 관리자 선택 --\x3e\n                    <div class="optionItem">\n                        <div class="flexList">\n                            <div class="optionItemTitle">\n                                <%-IM("survey.editor.form.manager.title") %>\n                                <dl class="uHelpGuide -small -close" role="alert" aria-live="assertive">\n                                    <dt><button type="button" class="_btnToggleManagerGuide"><span class="gSrOnly"><%-IM("ui.label.help")%></span></button></dt>\n                                    <dd role="dialog" class="_wrapManagerGuide" style="display: none; width:188px">\n                                        <%-IM("survey.editor.form.manager.desc")%>\n                                        <button type="button" class="btnLyClose _btnCloseManagerGuide"><span class="gSrOnly"><%-IM("ui.label.close")%></span></button>\n                                    </dd>\n                                </dl>\n                            </div>\n                            <div class="utillBox">\n                                <button type="button" class="btnAdd _btnSelectManagers"></button>\n                            </div>\n                        </div>\n                    </div>\n                    \x3c!-- //관리자 선택 --\x3e\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -confirm _btnComplete"><%-IM("web.btn.attach")%></button>\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2375),s=n(2376),a=n(2378),r=n(2380),l=n(2386),c=n(683),d=n(1259),u=n(622),h=n(612),p=n(486),m="DOWN",_="UP",g="CHOICE",f="ESSAY",b=s.ITEM_EVENT,v=a.FOOTER_EVENT,A=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorSurveyQuestionListView"},template:t.template(o),ui:{title:"._title",choiceBtn:"._choiceBtn",essayBtn:"._essayBtn",count:"._count",editBtn:"._editBtn",downBtn:"._downBtn",upBtn:"._upBtn",questions:"._questions",footer:"._footer"},regions:{questions:{el:"@ui.questions",replaceElement:!0},footer:{el:"@ui.footer",replaceElement:!0}},events:{"click @ui.choiceBtn":function(){this._createQuestion(g)},"click @ui.essayBtn":function(){this._createQuestion(f)},"click @ui.editBtn":function(){this._toggleEditMode(!0)},"click @ui.downBtn":function(){this._moveItemUpOrDown(m)},"click @ui.upBtn":function(){this._moveItemUpOrDown(_)}},initialize:function(e){this._survey=e.survey,this._questions=this._survey.get("questions"),this._selectedQuestion=null,this._questionListView=null},serializeData:function(){return{empty:this._questions.isEmpty(),count:this._getCountText()}},onRender:function(){this._renderQuestions(),this._renderFooter(!1)},_renderQuestions:function(){this._questions.isEmpty()?this._questionListView=null:(this._questions.resetQuestionNumbers(),this._questionListView=this._buildQuestionListView(),this.listenTo(this._questionListView,"reorder",(function(){this._scrollQuestionIntoView(this._selectedQuestion)})),this.listenTo(this._questionListView,b.NAME,this._handleItemEvent),this.showChildView("questions",this._questionListView))},_renderFooter:function(e){var t=a.build({add:!e&&!this._questions.isEmpty(),edit:e,back:!e});this.listenTo(t,v.NAME,this._handleFooterEvent),this.showChildView("footer",t)},_getCountText:function(){return IM("question.edit.list.count",{count:this._questions.size()})},_toggleEditMode:function(e){this._prevOrder=e?this._questions.toArray():null,this.ui.title.html(e?IM("ui.label.edit_order"):IM("question.edit.list.header_title")),this.ui.editBtn.css("display",e?"none":""),this.ui.downBtn.css("display",e?"":"none"),this.ui.upBtn.css("display",e?"":"none"),this._questionListView.children.invoke("setQuestionItemCheckMode",e),this._renderFooter(e)},_moveItemUpOrDown:function(e){var t=this._questions.indexOf(this._selectedQuestion),n=t+(e===m?1:-1);h.changeModelIndex(this._questions,t,n),this._questions.resetQuestionNumbers()},_scrollQuestionIntoView:function(e){if(!this.isDestroyed()&&e&&this._questionListView){var n=this._questionListView.children.findByModel(e);if(n){var i=n.el;t.isFunction(i.scrollIntoView)&&i.scrollIntoView({block:"nearest",behavior:"smooth"})}}},_restoreOrder:function(){var e=this._questions.models;Array.prototype.splice.apply(e,[0,e.length].concat(this._prevOrder)),this._questions.resetQuestionNumbers(),this._questions.trigger("sort",this._questions,{}),this._toggleEditMode(!1)},_createQuestion:function(e){var t=this._buildQuestionModel(e);this._addToQuestions(t)},_addToQuestions:function(e){if(this._survey.isRespondedMemberExist())d.alertRespondedMemberExist();else{var n=u.QUESTION_MAX_COUNT;if(this._questions.size()>=n)alert(IM("ui.message.make_up_to_max_count",{count:n}));else{var i=this._openQuestionEditView(e);this.listenToOnce(i,"confirm",(function(){this._questions.add(e),t.defer(t.bind(this._scrollQuestionIntoView,this,e)),this._updateQuestionList()}))}}},_buildQuestionModel:function(e){return e===g?c.buildChoiceType():c.buildEssayType()},_editQuestion:function(e){var t=this._openQuestionEditView(e);this.listenToOnce(t,"confirm",this._updateSummaries)},_deleteQuestion:function(e){this._survey.isRespondedMemberExist()?d.alertRespondedMemberExist():confirm(IM("ui.confirm.delete"))&&(this._questions.remove(e),this._updateQuestionList())},_updateQuestionList:function(){!this._questions.isEmpty()&&this._questionListView?(this._questions.resetQuestionNumbers(),this._updateSummaries()):this.render()},_updateSummaries:function(){this.ui.count.html(this._getCountText())},_openQuestionEditView:function(e){return e.isMultipleChoiceType()?r.openLayer({question:e,survey:this._survey}):l.openLayer({question:e,survey:this._survey})},_buildQuestionListView:function(){return new i.CollectionView({tagName:"ul",className:"questionList",reorderOnSort:!0,collection:this._questions,childView:s,childViewEvents:function(){var e={};return e[b.NAME]=function(){this.trigger.apply(this,[b.NAME].concat(t.toArray(arguments)))},e}})},_handleItemEvent:function(e,t){switch(e){case b.SELECT:this._selectedQuestion=t;break;case b.COPY:this._addToQuestions(t.copyQuestion());break;case b.EDIT:this._editQuestion(t);break;case b.DELETE:this._deleteQuestion(t)}},_handleFooterEvent:function(e){switch(e){case v.CHOICE:this._createQuestion(g);break;case v.ESSAY:this._createQuestion(f);break;case v.COMPLETE:this._closeView();break;case v.CANCEL:this._restoreOrder();break;case v.SAVE:this._toggleEditMode(!1);break;case v.BACK:this._closeView()}},_closeView:function(){this.trigger("confirm",this._questions),this.destroy()}});return A.openLayer=function(e){var t=new A(e);return p.open(t),t},A}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent lyQuizContent" style="width:600px;<%= (!empty) ? \'height:700px\' : \'\'%>">\n    <header class="modalHeader">\n        <h1 class="title _title"><%- IM(\'question.edit.list.header_title\') %></h1>\n    </header>\n    <div class="modalBody -spaceNone">\n        <div class="questionsListArea">\n            <% if (empty) { %>\n            <div class="createQuizButtonBox">\n                <div class="createQuizButton">\n                    <button class="uButton -sizeXL -confirm _choiceBtn"><%- IM(\'question.edit.list.add_choice\') %></button>\n                    <button class="uButton -sizeXL -confirm _essayBtn"><%- IM(\'question.edit.list.add_essay\') %></button>\n                </div>\n            </div>\n            <% } else { %>\n            <div class="questionStatusBox">\n                <div class="questionStatus">\n                    <span class="questions _count"><%- count %></span>\n                </div>\n                <div class="modificationMode">\n                    <button type="button" class="buttonSelect _editBtn"><%- IM(\'ui.label.edit_order\') %></button>\n                    <button type="button" class="buttonDown _downBtn" style="display:none"><%- IM(\'ui.label.move_down\') %></button>\n                    <button type="button" class="buttonUp _upBtn" style="display:none"><%- IM(\'ui.label.move_up\') %></button>\n                </div>\n            </div>\n            <div class="_questions"></div>\n            <% } %>\n        </div>\n    </div>\n    <div class="_footer"></div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2377),s=n(82),a=n(26),r={NAME:"QUESTION-ITEM",SELECT:"SELECT",COPY:"COPY",EDIT:"EDIT",DELETE:"DELETE"},l=i.View.extend({tagName:"li",className:"questionItem",attributes:{"data-viewname":"DEditorSurveyQuestionItemView"},template:t.template(o),ui:{itemCheckbox:"._itemCheckbox",itemSelect:"._itemSelect",itemTextBox:"._itemTextBox",itemNumber:"._itemNumber",itemMenuBox:"._itemMenuBox",itemMenuBtn:"._itemMenuBtn",itemMenuList:"._itemMenuList",itemCopyBtn:"._itemCopyBtn",itemEditBtn:"._itemEditBtn",itemDeleteBtn:"._itemDeleteBtn"},events:{"change @ui.itemSelect":function(){this.ui.itemSelect.prop("checked")&&this._triggerItemEvent(r.SELECT)},"click @ui.itemTextBox":function(){this._checkable||this._triggerItemEvent(r.EDIT)},"click @ui.itemMenuBtn":"_toggleMenu","click @ui.itemCopyBtn":function(){this._triggerItemEvent(r.COPY)},"click @ui.itemEditBtn":function(){this._triggerItemEvent(r.EDIT)},"click @ui.itemDeleteBtn":function(){this._triggerItemEvent(r.DELETE)}},modelEvents:{"survey-question:update":"render","survey-question:number":function(){this.ui.itemNumber.html(this._getQuestionNumberText())}},initialize:function(e){this._checkable=!1},serializeData:function(){var e=this.model.getImage();return{viewId:this.cid,number:this._getQuestionNumberText(),title:this.model.getTitle(),image:e?s.make(e.url,s.TYPE.s150):null}},onAttach:function(){this.listenTo(a.getDGlobalChannel(),a.EVENT.HTML_CLICK,this._closeMenu)},onBeforeDetach:function(){this.stopListening(a.getDGlobalChannel())},setQuestionItemCheckMode:function(e){this._checkable=e,this.ui.itemCheckbox.css("display",this._checkable?"":"none"),this.ui.itemSelect.prop("checked",!1),this.ui.itemTextBox.toggleClass("gCursorDefault",this._checkable),this.ui.itemMenuBox.css("display",this._checkable?"none":"")},_getQuestionNumberText:function(){return IM("question.item.survey_number",{number:this.model.getQuestionNumber()})},_toggleMenu:function(){"none"===this.ui.itemMenuList.css("display")&&t.defer(t.bind((function(){this.ui.itemMenuList.css("display","");var e=this.$el.scrollParent().get(0).getBoundingClientRect(),t=this.ui.itemMenuList.get(0).getBoundingClientRect();e.bottom<t.bottom&&this.ui.itemMenuList.addClass("-up")}),this))},_closeMenu:function(){this.ui.itemMenuList.css("display","none").removeClass("-up")},_triggerItemEvent:function(e){this.trigger(r.NAME,e,this.model)}});return l.ITEM_EVENT=r,l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="itemCheckBox _itemCheckbox" style="display:none">\n    <label for="item_<%- viewId %>" class="uCheck -radio">\n        <input type="radio" id="item_<%- viewId %>" name="questionItemSelect" class="checkInput _itemSelect">\n        <span class="checkLabel">\n            <span class="shape sf_afterBg"></span>\n            <span class="text"></span>\n        </span>\n    </label>\n</div>\n<div class="questionTextBox _itemTextBox">\n    <div class="questionInfo"><em class="number _itemNumber"><%- number %></em></div>\n    <div class="questionText"><%- title %></div>\n</div>\n<% if (image) { %>\n<div class="photoBox">\n    <img src="<%- image %>" alt="<%- IM(\'photo\') %>" class="inputThumb">\n</div>\n<% } %>\n<div class="moreMenuBox _itemMenuBox">\n    <button type="button" class="btnMore _itemMenuBtn"><span class="gSrOnly"><%- IM(\'web.uicomponent.topbar.button.menuopen\') %></span></button>\n    <div class="lyMenu _itemMenuList" style="display:none;min-width:132px;">\n        <ul>\n            <li><button type="button" class="_itemCopyBtn"><%- IM(\'question.edit.item.copy_btn\') %></button></li>\n            <li><button type="button" class="_itemEditBtn"><%- IM(\'ui.label.modify_long\') %></button></li>\n            <li><button type="button" class="_itemDeleteBtn"><%- IM(\'ui.label.delete_long\') %></button></li>\n        </ul>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2379),s={NAME:"QUESTION-FOOTER",CHOICE:"CHOICE",ESSAY:"ESSAY",COMPLETE:"COMPLETE",CANCEL:"CANCEL",SAVE:"SAVE",BACK:"BACK"},a=i.View.extend({tagName:"footer",className:function(){return this.options.add||this.options.edit?"modalFooter gMal0 gMar0 gPa0 -tLine":"modalFooter gPa0"},attributes:{"data-viewname":"DEditorQuestionListFooterView"},template:t.template(o),ui:{footerChoiceBtn:"._footerChoiceBtn",footerEssayBtn:"._footerEssayBtn",footerCompleteBtn:"._footerCompleteBtn",footerCancelBtn:"._footerCancelBtn",footerSaveBtn:"._footerSaveBtn",footerBackBtn:"._footerBackBtn"},events:{"click @ui.footerChoiceBtn":function(){this._triggerFooterEvent(s.CHOICE)},"click @ui.footerEssayBtn":function(){this._triggerFooterEvent(s.ESSAY)},"click @ui.footerCompleteBtn":function(){this._triggerFooterEvent(s.COMPLETE)},"click @ui.footerCancelBtn":function(){this._triggerFooterEvent(s.CANCEL)},"click @ui.footerSaveBtn":function(){this._triggerFooterEvent(s.SAVE)},"click @ui.footerBackBtn":function(){this._triggerFooterEvent(s.BACK)}},initialize:function(e){this._add=e.add,this._edit=e.edit,this._back=e.back},serializeData:function(){return{add:this._add,edit:this._edit,back:this._back}},_triggerFooterEvent:function(e){this.trigger(s.NAME,e)}});return a.FOOTER_EVENT=s,a.build=function(e){return new a(e)},a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% if (add) { %>\n<div class="buttonBox gPal15 gPar15 gPat12 gPab12 -flexible">\n    <div class="createButton">\n        <button class="uButton -createPlus -cancel gMar0 -h38 _footerChoiceBtn"><%- IM(\'question.edit.list.add_choice\') %></button>\n        <button class="uButton -createPlus -cancel gMal8 -h38 _footerEssayBtn"><%- IM(\'question.edit.list.add_essay\') %></button>\n    </div>\n    <button class="uButton -confirm -h38 _footerCompleteBtn"><%- IM(\'ui.label.complete\') %></button>\n</div>\n<% } %>\n<% if (edit) { %>\n<div class="buttonBox gPal15 gPar15 gPat21 gPab25">\n    <button type="button" class="uButton -cancel _footerCancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n    <button type="button" class="uButton -confirm _footerSaveBtn"><%- IM(\'ui.label.save\') %></button>\n</div>\n<% } %>\n<% if (back) { %>\n<button type="button" class="btnLyBack uButton -iconLyBack _footerBackBtn"><span class="gSrOnly"><%- IM(\'ui.label.back\') %></span></button>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(2381),a=n(1633),r=n(2383),l=n(1259),c=n(622),d=n(486),u=a.IMAGE_EVENT,h=r.LIST_EVENT,p=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorSurveyChoiceQuestionView"},template:t.template(s),ui:{title:"._title",image:"._image",choices:"._choices",addBtn:"._addBtn",other:"._other",multiple:"._multiple",essential:"._essential",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},regions:{image:{el:"@ui.image",replaceElement:!0},choices:{el:"@ui.choices",replaceElement:!0}},events:{"input @ui.title":"_toggleConfirmBtn","click @ui.title":"_checkEditable","click @ui.addBtn":"_addEmptyChoice","click @ui.other":"_checkEditable","change @ui.other":"_changeOther","click @ui.multiple":"_checkEditable","click @ui.essential":"_checkEditable","click @ui.cancelBtn":"_closeView","click @ui.confirmBtn":"_saveInputValues"},initialize:function(e){this.model=e.question,this._survey=e.survey,this._choices=this.model.getChoices().copyChoices(),this._image=this.model.getImage(),this._choiceListView=null},serializeData:function(){return{viewId:this.cid,maxlength:c.QUESTION_TITLE_MAX_LENGTH,title:this.model.getTitle(),other:this.model.isOtherChoiceEnabled(),multiple:this.model.isMultipleChoicesEnabled(),essential:this.model.isResponseEssential()}},onRender:function(){this._setEditable(),this._renderImage(),this._renderChoiceList(),this._toggleConfirmBtn()},onAttach:function(){this.ui.title.focus()},_setEditable:function(){var e=this._survey.isRespondedMemberExist();this.ui.title.prop("readonly",e),this.ui.other.prop("readonly",e),this.ui.multiple.prop("readonly",e),this.ui.essential.prop("readonly",e)},_renderImage:function(){var e=a.build({image:this._image,deletable:!0,uploadable:!0,survey:this._survey});this.listenTo(e,u.NAME,this._handleImageEvent),this.showChildView("image",e)},_handleImageEvent:function(e,t){switch(e){case u.CHANGE:this._image=t,this._renderImage()}},_renderChoiceList:function(){this._choiceListView=r.build({collection:this._choices,survey:this._survey,other:this.model.isOtherChoiceEnabled()}),this.listenTo(this._choiceListView,h.NAME,this._handleListEvent),this.showChildView("choices",this._choiceListView)},_handleListEvent:function(e){switch(e){case h.ITEM_MODIFIED:this._toggleConfirmBtn()}},_toggleConfirmBtn:function(){var e=this._canEnableConfirmBtn();this.ui.confirmBtn.prop("disabled",!e)},_checkEditable:function(e){this._survey.isRespondedMemberExist()&&(e.preventDefault(),l.alertRespondedMemberExist())},_addEmptyChoice:function(){this._choiceListView.addEmptyChoice()},_changeOther:function(){var e=this.ui.other.prop("checked");this._choiceListView.toggleOtherChoice(e)},_canEnableConfirmBtn:function(){return!!this._getTitleInputValue()&&!!this._choices.hasContent()},_getTitleInputValue:function(){return i.trim(this.ui.title.val())},_saveInputValues:function(){this._survey.isRespondedMemberExist()?this._closeView():this._canEnableConfirmBtn()?(this.model.setMultipleChoiceValues({title:this._getTitleInputValue(),image:this._image,choices:this._choices,isOtherChoiceEnabled:this.ui.other.prop("checked"),isMultipleChoicesEnabled:this.ui.multiple.prop("checked"),isResponseEssential:this.ui.essential.prop("checked")}),this.trigger("confirm",this.model),this._closeView()):this._toggleConfirmBtn()},_closeView:function(){this.destroy()}});return p.openLayer=function(e){var t=new p(e);return d.open(t),t},p}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent" style="width:600px">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'question.edit.input.header_title\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="questionCreateArea">\n            <div class="questionInputBox">\n                <div class="uTextarea">\n                    <textarea class="_title" maxlength="<%- maxlength %>" placeholder="<%- IM(\'question.edit.input.title_placeholder\') %>" style="max-width:454px;height:56px;"><%- title %></textarea>\n                    <span class="border"></span>\n                </div>\n                <div class="_image"></div>\n            </div>\n\n            <div class="questionListBox">\n                <h2 class="boxTitle"><%- IM(\'question.edit.input.choices\') %></h2>\n\n                <div class="_choices"></div>\n\n                <button type="button" class="buttonAddItem _addBtn"><%- IM(\'question.edit.input.add_choice\') %></button>\n            </div>\n\n            <div class="createSetting">\n                <div class="settingText">\n                    <div class="title"><%- IM(\'question.edit.input.other_choice\') %></div>\n                    <div class="subText"><%- IM(\'question.edit.input.other_choice_desc\') %></div>\n                </div>\n                <div class="settingAction">\n                    <label for="other<%- viewId %>" class="uCheck -switch">\n                        <input type="checkbox" id="other<%- viewId %>" name="uCheck" class="checkInput _other" <%- other ? \'checked\' : \'\' %>>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"></span>\n                        </span>\n                    </label>\n                </div>\n            </div>\n\n            <div class="createSetting">\n                <div class="settingText">\n                    <div class="title"><%- IM(\'question.edit.input.multiple_answers\') %></div>\n                </div>\n                <div class="settingAction">\n                    <label for="multiple<%- viewId %>" class="uCheck -switch">\n                        <input type="checkbox" id="multiple<%- viewId %>" name="uCheck" class="checkInput _multiple" <%- multiple ? \'checked\' : \'\' %>>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"></span>\n                        </span>\n                    </label>\n                </div>\n            </div>\n\n            <div class="createSetting">\n                <div class="settingText">\n                    <div class="title"><%- IM(\'question.edit.input.essential\') %></div>\n                </div>\n                <div class="settingAction">\n                    <label for="essential<%- viewId %>" class="uCheck -switch">\n                        <input type="checkbox" id="essential<%- viewId %>" name="uCheck" class="checkInput _essential" <%- essential ? \'checked\' : \'\' %>>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"></span>\n                        </span>\n                    </label>\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter gMar0 gMal0 -tLine">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn" disabled><%- IM(\'ui.label.save\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<% if (imageUrl) { %>\n<img src="<%- imageUrl %>" alt="<%- IM(\'photo\') %>" class="inputThumb">\n<% } %>\n<% if (imgDelBtn) { %>\n<button type="button" class="buttonDelete _imageDelBtn"><span class="gSrOnly"><%- IM(\'ui.label.delete\') %></span></button>\n<% } %>\n<% if (imgFile) { %>\n<label class="uploadImg _imageFile"><input type="file" accept="image/*"></label>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(2384),o=n(622),s=n(1259),a=n(612),r=n(197),l={NAME:"CHOICE-LIST",ITEM_MODIFIED:"ITEM_MODIFIED"},c=i.ITEM_CLASS,d=i.ITEM_EVENT,u=t.CollectionView.extend({tagName:"ul",className:"questionList surveyList",attributes:{"data-viewname":"DEditorSurveyChoiceListView"},reorderOnSort:!0,childView:i,childViewOptions:function(){return{survey:this._survey}},childViewEvents:function(){var e={};return e[d.NAME]="_handleItemEvent",e},initialize:function(e){this._survey=e.survey,this._other=e.other},onBeforeRender:function(){this._destroySortable(),this._addEmptyChoicesUpToDefaultCount(),this.toggleOtherChoice(this._other)},onRender:function(){this._createSortable()},onBeforeDetach:function(){this._destroySortable()},addEmptyChoice:function(){if(this._survey.isRespondedMemberExist())s.alertRespondedMemberExist();else{var e=o.CHOICE_MAX_COUNT;this.collection.getChoiceCount()>=e?alert(IM("question.edit.input.add_up_to_max_count_choices",{count:e})):this.collection.addEmptyChoice()}},toggleOtherChoice:function(e){this.collection.toggleOtherChoice(e)},_addEmptyChoicesUpToDefaultCount:function(){var e=o.CHOICE_DEFAULT_COUNT-this.collection.size();e>0&&_.times(e,this.collection.addEmptyChoice,this.collection)},_handleItemEvent:function(e,t){switch(e){case d.DELETE:this._deleteChoice(t);break;case d.ADD:this.addEmptyChoice()}this._triggerItemModifiedEvent()},_deleteChoice:function(e){this._survey.isRespondedMemberExist()?s.alertRespondedMemberExist():confirm(IM("ui.confirm.delete"))&&(this.collection.remove(e),this._addEmptyChoicesUpToDefaultCount())},_triggerItemModifiedEvent:function(){this._triggerListEvent(l.ITEM_MODIFIED)},_triggerListEvent:function(e){this.trigger(l.NAME,e)},_createSortable:function(){this._destroySortable(),this._sortable=r.create(this.el,{group:"choices",sort:!this._survey.isRespondedMemberExist(),animation:150,handle:"."+c.HANDLE,draggable:"."+c.DRAGGABLE,scroll:!0,onEnd:_.bind((function(e){this._survey.isRespondedMemberExist()?s.alertRespondedMemberExist():a.changeModelIndex(this.collection,e.oldIndex,e.newIndex)}),this)})},_destroySortable:function(){this._sortable&&(this._sortable.destroy(),this._sortable=null)}});return u.LIST_EVENT=l,u.build=function(e){return new u(e)},u}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(2385),a=n(1633),r=n(1259),l=n(622),c=n(1402),d=n(2020),u=n(555),h=n(154),p={DRAGGABLE:"_choiceItemDraggable",HANDLE:"_choiceItemHandle"},m={NAME:"CHOICE-ITEM",TITLE_:"TITLE",IMAGE:"IMAGE",DELETE:"DELETE",ADD:"ADD"},_=a.IMAGE_EVENT,g=o.View.extend({tagName:"li",className:function(){return this.options.model.isOtherChoice()?"questionItem":"questionItem "+p.DRAGGABLE},attributes:{"data-viewname":"DEditorSurveyChoiceItemView"},template:t.template(s),ui:{itemTitle:"._itemTitle",itemFile:"._itemFile",itemDelBtn:"._itemDelBtn",itemImage:"._itemImage"},regions:{itemImage:{el:"@ui.itemImage",replaceElement:!0}},events:{"keydown @ui.itemTitle":"_keydownTitle","keyup @ui.itemTitle":"_keyupTitle","click @ui.itemTitle":"_checkEditable","click @ui.itemFile":"_checkEditable","click @ui.itemDelBtn":"_deleteChoice"},initialize:function(e){this._survey=e.survey,this._other=this.model.isOtherChoice()},serializeData:function(){return{editable:!this._other&&!this._survey.isRespondedMemberExist(),title:this._other?IM("question.choice.other"):this.model.getTitle(),buttons:!this._other,handle:p.HANDLE}},onBeforeRender:function(){this._destroyUploader()},onRender:function(){this._setTitleMaxLength(),this._renderImage(),this._createUploader()},onBeforeDetach:function(){this._destroyUploader()},_setTitleMaxLength:function(){this._other||this._survey.isRespondedMemberExist()||d.setMaxLength({element:this.ui.itemTitle,maxlength:l.CHOICE_TITLE_MAX_LENGTH,newline:!1,onInput:t.bind((function(e){this.model.setTitle(i.trim(e)),this._triggerItemEvent(m.TITLE)}),this)})},_renderImage:function(){var e=this.getRegion("itemImage"),t=this.model.getImage();if(this.$el.toggleClass("-isAttach",!!t),t){var n=a.build({image:t,deletable:!0,uploadable:!1,survey:this._survey});this.listenTo(n,_.NAME,this._handleImageEvent),e.show(n)}else e.empty()},_handleImageEvent:function(e,t){switch(e){case _.CHANGE:this._setImage(t)}},_setImage:function(e){this.model.setImage(e),this._renderImage(),this._triggerItemEvent(m.IMAGE)},_checkEditable:function(e){if(!this._other)return this._survey.isRespondedMemberExist()?(e.preventDefault(),void r.alertRespondedMemberExist()):void 0;e.preventDefault()},_keydownTitle:function(e){switch(e.keyCode){case u.ENTER:this._isEnterKeyPressed=!0}},_keyupTitle:function(e){switch(e.keyCode){case u.ENTER:this._isEnterKeyPressed&&(this._isEnterKeyPressed=!1,this._moveToNextItem())}},_moveToNextItem:function(){var e="."+p.DRAGGABLE;0===this.$el.next(e).length&&this._triggerItemEvent(m.ADD),h.wrapDeferPromise(this).then(t.bind((function(){this.$el.next(e).find(this.ui.itemTitle.selector).focus()}),this))},_deleteChoice:function(){this._triggerItemEvent(m.DELETE)},_createUploader:function(){this._other||this._survey.isRespondedMemberExist()||(this._uploader=c.createUploader({element:this.ui.itemFile}),this.listenTo(this._uploader,"complete",(function(e){this._setImage(e[0])})))},_destroyUploader:function(){this._uploader&&this._createUploader()},_triggerItemEvent:function(e){this.trigger(m.NAME,e,this.model)}});return g.ITEM_CLASS=p,g.ITEM_EVENT=m,g}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="itemInputBox">\n    <div class="itemInput _itemTitle" contenteditable="<%- editable %>" placeholder="<%- IM(\'question.edit.input.choices\') %>"><%- title %></div>\n\n    <% if (buttons) { %>\n    <div class="btnUploadWrap">\n        <label class="uploadImg _itemFile"><input type="file" accept="image/*"></label>\n        <button type="button" class="uButton -iconListMove <%- handle %>"><span class="gSrOnly"><%- IM(\'ui.label.move\') %></span></button>\n        <button type="button" class="buttonDelete _itemDelBtn"><span class="gSrOnly"><%- IM(\'ui.label.delete\') %></span></button>\n    </div>\n    <% } %>\n</div>\n<div class="_itemImage" style="display:none"></div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(2387),a=n(1633),r=n(1259),l=n(622),c=n(486),d=a.IMAGE_EVENT,u=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorSurveyEssayQuestionView"},template:t.template(s),ui:{title:"._title",image:"._image",attachable:"._attachable",essential:"._essential",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},regions:{image:{el:"@ui.image",replaceElement:!0}},events:{"input @ui.title":"_toggleConfirmBtn","click @ui.title":"_checkEditable","click @ui.attachable":"_checkEditable","click @ui.essential":"_checkEditable","click @ui.cancelBtn":"_closeView","click @ui.confirmBtn":"_saveInputValues"},initialize:function(e){this.model=e.question,this._survey=e.survey,this._image=this.model.getImage()},serializeData:function(){return{viewId:this.cid,maxlength:l.QUESTION_TITLE_MAX_LENGTH,title:this.model.getTitle(),attachable:this.model.isAttachmentEnabled(),essential:this.model.isResponseEssential()}},onRender:function(){this._setEditable(),this._renderImage(),this._toggleConfirmBtn()},onAttach:function(){this.ui.title.focus()},_setEditable:function(){var e=this._survey.isRespondedMemberExist();this.ui.title.prop("readonly",e),this.ui.attachable.prop("readonly",e),this.ui.essential.prop("readonly",e)},_renderImage:function(){var e=a.build({image:this._image,deletable:!0,uploadable:!0,survey:this._survey});this.listenTo(e,d.NAME,this._handleImageEvent),this.showChildView("image",e)},_handleImageEvent:function(e,t){switch(e){case d.CHANGE:this._image=t,this._renderImage()}},_toggleConfirmBtn:function(){var e=this._canEnableConfirmBtn();this.ui.confirmBtn.prop("disabled",!e)},_checkEditable:function(e){this._survey.isRespondedMemberExist()&&(e.preventDefault(),r.alertRespondedMemberExist())},_canEnableConfirmBtn:function(){return!!this._getTitleInputValue()},_getTitleInputValue:function(){return i.trim(this.ui.title.val())},_saveInputValues:function(){this._survey.isRespondedMemberExist()?this._closeView():this._canEnableConfirmBtn()?(this.model.setEssayValues({title:this._getTitleInputValue(),image:this._image,isAttachmentEnabled:this.ui.attachable.prop("checked"),isResponseEssential:this.ui.essential.prop("checked")}),this.trigger("confirm",this.model),this._closeView()):this._toggleConfirmBtn()},_closeView:function(){this.destroy()}});return u.openLayer=function(e){var t=new u(e);return c.open(t),t},u}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent" style="width:600px">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'question.edit.input.header_title\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="questionCreateArea">\n            <div class="questionInputBox">\n                <div class="uTextarea">\n                    <textarea class="_title" maxlength="<%- maxlength %>" placeholder="<%- IM(\'question.edit.input.title_placeholder\') %>" style="max-width:454px;height:115px;"><%- title %></textarea>\n                    <span class="border"></span>\n                </div>\n                <div class="_image"></div>\n            </div>\n\n            <div class="createSetting">\n                <div class="settingText">\n                    <div class="title"><%- IM(\'question.edit.input.attachment\') %></div>\n                    <div class="subText"><%- IM(\'question.edit.input.survey_attachment_desc\') %></div>\n                </div>\n                <div class="settingAction">\n                    <label for="attachable<%- viewId %>" class="uCheck -switch">\n                        <input type="checkbox" id="attachable<%- viewId %>" name="uCheck" class="checkInput _attachable" <%- attachable ? \'checked\' : \'\' %>>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"></span>\n                        </span>\n                    </label>\n                </div>\n            </div>\n\n            <div class="createSetting">\n                <div class="settingText">\n                    <div class="title"><%- IM(\'question.edit.input.essential\') %></div>\n                </div>\n                <div class="settingAction">\n                    <label for="essential<%- viewId %>" class="uCheck -switch">\n                        <input type="checkbox" id="essential<%- viewId %>" name="uCheck" class="checkInput _essential" <%- essential ? \'checked\' : \'\' %>>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"></span>\n                        </span>\n                    </label>\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter gMar0 gMal0 -tLine">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn" disabled><%- IM(\'ui.label.save\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(4),s=n(486),a=n(2389),r=n(501),l=n(1004),c=n(2015),d=n(1624),u=o.View.extend({options:{title:IM("web.bandmemberselection.title"),useRemoveAll:!1},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorSurveyMemberEntryListView"},template:i.template(a),templateContext:function(){return{title:this.options.title,showRemoveAll:this.options.useRemoveAll}},ui:{memberEntryListRegion:"._memberEntryListRegion",memberEntryCount:"._memberEntryCount",wrapRemoveAll:"._wrapRemoveAll",btnRemoveAll:"._btnRemoveAll",btnAddMemberEntry:"._btnAddMemberEntry",btnBack:"._btnBack",btnConfirm:"._btnConfirm"},regions:{memberEntryListRegion:{el:"@ui.memberEntryListRegion",replaceElement:!0}},events:{"click @ui.btnAddMemberEntry":function(){this._openAddMemberLayer(!1)},"click @ui.btnRemoveAll":function(){this.trigger(u.EVENT.REMOVE_ALL_ENTRIES)},"click @ui.btnBack":"destroy","click @ui.btnConfirm":"destroy"},initialize:function(e){this.bandData=e.bandData,this.memberEntryCollectionView=new d({collection:this.collection})},onAttach:function(){this.showChildView("memberEntryListRegion",this.memberEntryCollectionView),this._renderMemberEntryCount(),this.listenTo(this.memberEntryCollectionView,"entry:remove",(function(e){this.trigger(u.EVENT.REMOVE_ENTRY,e.get("userNo"))})),0===this.collection.length&&this._openAddMemberLayer(!0)},_openAddMemberLayer:function(e){var t=this.collection.pluck("userNo"),n=c.createSimpleMemberLocalSearchCollection({bandData:this.bandData,excludedUserNos:t,memberOfBandFilterType:this.options.memberOfBandFilterType});n.fetchAllMembers().then(i.bind((function(){var t=l.openAsLayerWithOption({bandData:this.bandData,collection:n,supportMemberGroup:!0});this.listenToOnce(t,l.EVENT.MEMBER_SELECTED,(function(e){if(!e.isEmpty()){var t=e.map(i.bind((function(e){return new r(e.toJSON(),{parse:!0})}),this));this.trigger(u.EVENT.ADD_ENTRIES,t)}})),e&&this.listenToOnce(t,"destroy",this.destroy)}),this))},renderCollection:function(e){this.collection=e,this.memberEntryCollectionView.collection=e,this.memberEntryCollectionView.render(),this._renderMemberEntryCount()},_renderMemberEntryCount:function(){this.getUI("memberEntryCount").html(this.collection.length>0?this.collection.length:"")}});u.EVENT={ADD_ENTRIES:"entry:add",REMOVE_ENTRY:"entry:remove",REMOVE_ALL_ENTRIES:"entry:removeAll"},u.openLayer=function(e){var t=new u(e);return s.open(t),t},e.exports=u},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%- title %>&nbsp;<span class="_memberEntryCount"></span></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="memberListBox">\n                <% if (showRemoveAll) { %>\n                <div class="topNoticeBar _wrapRemoveAll">\n                    <button type="button" class="btnDelet _btnRemoveAll"><%-IM("web.postwrite.form_attendance_check.attendee_list.btn_remove_all")%></button>\n                </div>\n                <% } %>\n                <div class="addMemberAttend">\n                    <a href="#" role="button" class="button _btnAddMemberEntry"><%- IM(\'web.postwrite.form_attendance_check.btn_add_members\') %></a>\n                </div>\n                <% // 멤버 목록 %>\n                <div class="_memberEntryListRegion"></div>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%= IM("ui.label.prev") %></span></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(6),s=n(4),a=n(2391),r=n(486),l=n(9),c=s.View.extend({options:{itemsGetter:void 0,getTitleFromItem:function(e){return e.title},getDateTextFromItem:function(e){return l.format.date(e.created_at,"short_date_time")},maxItemCount:void 0},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DImportPreviousContentLayerView"},template:i.template(a),initialize:function(){if(!i.isFunction(this.options.itemsGetter))throw new Error("itemsGetter required");this.collection=new o.Collection},templateContext:function(){return{getTitleFromItem:this.options.getTitleFromItem,getDateTextFromItem:this.options.getDateTextFromItem}},serializeData:function(){var e=this.serializeCollection();return{items:this.options.maxItemCount?i.first(e,this.options.maxItemCount):e}},ui:{btnItem:"._btnItem",btnBack:"._btnBack"},events:{"click @ui.btnItem":function(e){var t=Number(this.$(e.currentTarget).data("index")),n=this.collection.at(t);this.trigger("importData:selected",n.toJSON()),this.destroy()},"click @ui.btnBack":"destroy"},onAttach:function(){this.options.itemsGetter().then(i.bind((function(e){this.collection.reset(e),this.render()}),this))}});c.openAsLayer=function(e,t){var n=new c({itemsGetter:e,maxItemCount:t});return r.open(n),n},e.exports=c},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_title\') %></h1>\n    </header>\n    <div class="main -spaceNone">\n        <div class="previousAttendance">\n            <div class="topNoticeBar">\n                <p class="sDesc gMat0"><%- IM(\'web.postwrite.form_attendance_check.import_attendance_check_desc\') %></p>\n            </div>\n            <% if (!!items && items.length > 0) { %>\n            <ul class="listLine rScroll -h480">\n                <% _.each(items, function(item, index) { %>\n                <li class="tLine">\n                    <button type="button" class="flexList _btnItem" data-index="<%- index %>">\n                        <span class="text">\n                            <span class="ellipsis"><%- getTitleFromItem(item) %></span>\n                            <span class="sub -date"><%- getDateTextFromItem(item) %></span>\n                        </span>\n                    </button>\n                </li>\n                <% }) %>\n            </ul>\n            <% } else { %>\n            <p class="uEmpty -h480">\n                <span><%- IM(\'ui.message.empty_conents\') %></span>\n            </p>\n            <% } %>\n        </div>\n    </div>\n    <footer class="footer -spaceNone">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnBack"><span class="gSrOnly"><%-IM(\'ui.label.back\')%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(4),s=n(2393),a=n(167),r=o.View.extend({options:{userEnvStorageKeys:[],description:"",width:179},className:"uHelpGuide -right -close",attributes:{"data-viewname":"DHelpGuideView",role:"alert","aria-live":"assertive"},initialize:function(){if(i.isEmpty(this.options.userEnvStorageKeys))throw new Error("userEnvStorageKeys is required");if(!this.options.description)throw new Error("description is required")},template:i.template(s),templateContext:function(){return{description:this.options.description,width:this.options.width}},ui:{wrap:"._wrap",btnClose:"._btnClose"},events:{"click @ui.btnClose":function(){return this.getUI("wrap").hide(),a.getCurrentUserEnvStorage().set(this.options.userEnvStorageKeys,!0),!1}},onRender:function(){a.getCurrentUserEnvStorage().get(this.options.userEnvStorageKeys)?this.getUI("wrap").hide():this.getUI("wrap").show()}});r.buildDHelpGuideView=function(e,t){return new r({userEnvStorageKeys:e,description:t})},e.exports=r},function(e,t){e.exports='<dt><span class="gSrOnly"><%-IM("ui.label.help")%></span></dt>\n<dd class="_wrap" style="display: block; width:<%-width%>px">\n    <%-description %>\n    <button type="button" class="btnLyClose _btnClose"><span class="gSrOnly"><%-IM("ui.label.close")%></span></button>\n</dd>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(906),{SCROLL_SPEED:20,MINIMUM_SIZE_TO_SCALE:40,SCROLL_SENSITIVITY:50,autoScroll:{},_autoScroll:function(e,t){var n,i,o,s,a=this.SCROLL_SENSITIVITY,r=this.SCROLL_SPEED,l=e.clientX,c=e.clientY,d=Math.abs;t&&(n=t,i=t.getBoundingClientRect(),o=(d(i.right-l)<=a)-(d(i.left-l)<=a),s=(d(i.bottom-c)<=a)-(d(i.top-c)<=a)),this.autoScroll.vx===o&&this.autoScroll.vy===s&&this.autoScroll.el===n||(this.autoScroll.el=n,this.autoScroll.vx=o,this.autoScroll.vy=s,clearInterval(this.autoScroll.pid),n&&(this.autoScroll.pid=setInterval((function(){s&&(n.scrollTop+=s*r),o&&(n.scrollLeft+=o*r)}),24)))},clearListeners:function(){$(window).off("mousemove",this._onMouseMove),this._hideLineOnScrollListener&&this._hideLineOnScrollListener.removeListener()},_createOnMouseMove:function(e){return t.bind(t.throttle((function(t){var n=t;return this._autoScroll(n,e.element.$.parentElement),!0}),50),this)},bind:function(e){e.on("dragstart",t.bind((function(t){this.clearListeners();var n=t.data.target;n.type==CKEDITOR.NODE_ELEMENT&&n.hasClass("cke_widget_drag_handler")&&(this._onMouseMove=this._createOnMouseMove(e),$(window).on("mousemove",this._onMouseMove),this._hideLineOnScrollListener=e.editable().attachListener(e.element.getParent(),"scroll",(function(){console.log("hideVisible"),e.widgets.liner.hideVisible()})))}),this)),e.on("dragend",t.bind((function(e){clearInterval(this.autoScroll.pid),this.clearListeners()}),this))}});return function(e){i.bind(e)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return function(e){var t=e.element.$,n=$(t),i=["dragenter","dragover","drop"];function o(e){if("dragenter"==e.type||"dragover"==e.type||"drop"==e.type)return e.stopPropagation&&(e.preventDefault(),e.stopPropagation()),!1}_.each(i,(function(e){n.on(e,o)})),e.once("destroy",(function(){_.each(i,(function(e){n.off(e,o)}))}))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){return function(e){function t(e){return e.preventDefault(),e.stopPropagation(),!1}var n=$(e.element.$);n.on("contextmenu",".cke_widget_wrapper",t),e.once("destroy",(function(){n.off("contextmenu",t)}))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(1560);return function(e){e.on("paste",(function(n){if("paste"===n.data.method){var s=CKEDITOR.plugins.clipboard.canClipboardApiBeTrusted(n.data.dataTransfer,e),a=null,r=!1,l=!1;if(n.data.dataTransfer.getData("text/html")||!n.data.dataTransfer.getData("text/plain")){if(n.data.dataValue){if(s)a=t.parseHTML(n.data.dataValue);else{var c=(n.data.dataValue||"").replace(/\n/gi,"<br />");a=t.parseHTML(c)}if(a){for(var d=0,u=a.length;d<u&&!r;d++)switch(a[d].nodeName){case"DIV":r=!0;break;case"P":l=!0}if(r)n.cancel();else if(n.data.dataTransfer.getTransferType(e)!==CKEDITOR.DATA_TRANSFER_INTERNAL){var h,p=!1;l?h=i.chain(a).filter((function(e){return!!e.innerHTML&&e.nodeType!==Node.COMMENT_NODE})).map((function(e){return t("<p>").html(e.innerHTML.replace(/<br\s?\/?>/g,"\n")).text()})).value().join("\n"):s?h=n.data.dataTransfer.getData("text/plain"):(p=!0,h=n.data.dataValue.replace(/<br\s?\/?>/g,"\n")),h=h.replace(/[\u2028|\u2029]/g,""),n.data.dataValue=o.convertNewLineToP(h,p)}}}}else n.data.dataValue=o.convertNewLineToP(n.data.dataTransfer.getData("text/plain"))}}))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=n(158),a=n(540),r=n(563),l=n(555),c=n(725),d=n(26),u=n(488),h=n(906),p=/(\s|^)#\S+/,m=/(\s|^)#\S*/,_=/\u200B/g;return function(e,n,g){var f=n.getBandNo();e.on("contentDom",(function(){e.on("afterPaste",(function(){G(e.editable().getFirst())})),e.widgets.on("checkSelection",(function(){setTimeout((function(){var t=e.getSelection();if(t){var n=t.getStartElement(),i=t.getRanges()[0];n&&(F(n)&&i&&i.collapsed&&0==i.startOffset&&setTimeout((function(){var t=e.document.createText("");t.insertBefore(n),i.moveToPosition(t,CKEDITOR.POSITION_BEFORE_START),i.select()}),0),C())}}),0)})),e.on("key",(function(t){var n=e.getSelection(),i=n.getRanges()[0];if(i.collapsed)switch(t.data.keyCode){case l.BACKSPACE:case l.DELETE:b(t,n,i);break;case l.ENTER:case CKEDITOR.SHIFT+l.ENTER:case l.SPACE:case CKEDITOR.SHIFT+l.SPACE:v(t,n,i);break;case CKEDITOR.SHIFT+51:E(!1);break;case l.IME:case CKEDITOR.SHIFT+l.IME:A(t,n,i)}}))}));var b=function(t,n,i){var o=t.data.domEvent.$.keyCode===l.BACKSPACE,s=!1,a=n.getStartElement();if(o&&(s=F(a)),!s){var r=i.getNextEditableNode();F(r)&&(s=!0,a=r)}s&&(setTimeout((function(){z(a)}),0),"#"===i.startContainer.getText().replace(_,"")&&e.startHashTagStart&&Q.removeAutoCompleteList())},v=function(t,n,i){var o=t.data.domEvent.$.keyCode===l.ENTER;if(!o||!e.startHashTagStart){e.startHashTagStart&&Q.removeAutoCompleteList();var s=n.getStartElement();if(F(s)){i.splitElement(s),i.optimize(),i.select(),z(s);var a=i.getNextNode((function(e){return e.type===CKEDITOR.NODE_ELEMENT}));if(a.getText())z(a);else{a.remove();var r=i.getNextEditableNode();r&&r.type===CKEDITOR.NODE_ELEMENT&&(!o&&r.getText()||(i.moveToElementEditablePosition(r),i.select()))}}else K(s)}},A=function(e,t,n){var i=e.data.domEvent.$;switch(i.code){case"Enter":case"Space":i.isComposing||v(e,t,n);break;case"Digit3":i.shiftKey&&(E(!1),setTimeout(j))}},E=function(n){var i=e.getSelection(),o=i.getStartElement(),s=i.getRanges()[0];if(!s.collapsed&&n){var a=s.endContainer,r=s.endOffset;s.setStart(a,r),s.setEnd(a,r),s.collapse(!0),e.getSelection().selectRanges([s]),e.focus(),o=(i=e.getSelection()).getStartElement(),s=i.getRanges()[0]}if(s.collapsed&&(n||!F(o))){if(n&&F(o)){var l=o.getNext();R(l)||(l=new CKEDITOR.dom.text(" ")).insertAfter(o),s.moveToPosition(l,CKEDITOR.POSITION_AFTER_END),s.select()}if(s.startContainer.type===CKEDITOR.NODE_TEXT&&s.startOffset>0){var c=(s.startContainer.getText()||"").charAt(s.startOffset-1).charCodeAt(0);if(32!==c&&160!==c&&8203!==c&&12288!==c){if(!n)return;var d=new CKEDITOR.dom.text(" ");s.insertNode(d),CKEDITOR.env.ie?s.moveToElementEditEnd(d):s.moveToElementEditStart(d),s.select()}}if(n&&!F(s)){var h=(s.startContainer.getText()||"").charAt(s.startOffset).charCodeAt(0);if(32!==h&&160!==h&&8203!==h&&12288!==h){d=new CKEDITOR.dom.text(" ");s.insertNode(d),s.moveToElementEditStart(d),s.select()}}if(n&&"div"===s.startContainer.getName()){var p=new CKEDITOR.dom.element("p");s.insertNode(p),s.moveToElementEditEnd(p),s.select()}var m=H();m.addClass(u.ELEMENT.HASHTAG),s.insertNode(m),W(m),s.moveToElementEditStart(m),s.select(),n&&T(s);var _=t(e.element.getParent().$),g=_.scrollTop(),f=_.height()+g,b=t(m.$).position().top;(g>b||f<=b)&&m.$.scrollIntoView(),Q.initialize()}},T=function(e){CKEDITOR.env.ie&&(this.tmpIESelectRange=e)},C=function(){var t=e.getSelection(),n=t?t.getRanges()[0]:null;!n||I(n)?M():y()},y=function(){i.each(e.toolbar[0].items,(function(t){var n=e.getCommand(t.command);n?n.disable():i.isFunction(t.disable)?t.disable():i.isFunction(t.setState)&&t.setState(CKEDITOR.TRISTATE_DISABLED)}))},M=function(){i.each(e.toolbar[0].items,(function(t){var n=e.getCommand(t.command);n?n.enable():i.isFunction(t.enable)?t.enable():i.isFunction(t.setState)&&t.setState(CKEDITOR.TRISTATE_OFF)}))},I=function(e){var t=e.getBoundaryNodes(),n=S(t.startNode);if(!n)return!0;if(e.collapsed)return!F(n);var o=S(t.endNode);if(!o)return!0;var s=w(n,o);return i.find(s,(function(e){return!e.isReadOnly()&&(!F(e)&&(!U(e)&&(!B(e)&&!V(e))))}))},S=function(e){if(!O(e))return null;var t=D(e),n=t[0];if(k(n)){var i=t[1];return i||n.getFirst()}return n},w=function(e,t){var n=N(e),o=N(t);if(!n||!o)return null;var s=L(n,o),a=e.$,r=t.$,l=i.findIndex(s,(function(e){return e.$===a})),c=i.findLastIndex(s,(function(e){return e.$===r}));return-1===l||-1===c?null:s.slice(l,c+1)},N=function(e){return O(e)?D(e)[0]:null},D=function(e){for(var t=[];O(e);)t.unshift(e),e=e.getParent();return t},L=function(e,t){for(var n,i,o,s,a=[],r=e,l=t.$;r;){if(k(r))for(i=(n=r.getChildren()).count(),o=0;o<i;o++)-1!==(s=n.getItem(o)).getIndex()&&a.push(s);else a.push(r);if(r.$===l)break;r=r.getNext()}return a},O=function(t){return t&&e.element.contains(t)},P=function(e){return e instanceof CKEDITOR.dom.element},x=function(e){return e instanceof CKEDITOR.dom.text},R=function(e){return x(e)&&" "===e.getText()},k=function(e){return P(e)&&e.is("p")},B=function(e){return P(e)&&e.is("br")},V=function(e){return x(e)&&o.isBlank(e.getText())},U=function(e){return!!P(e)&&(e.is("input")&&e.hasAttribute("data-nostyle"))},F=function(e){return!!P(e)&&(e.is("span")&&e.hasAttribute("data-nostyle"))},H=function(){var e=new CKEDITOR.dom.element("span");return e.setAttribute("data-nostyle","true"),e},z=function(t){var n=t.getText();if(!m.test(n)&&!s.extractUrlString(n)){var i=e.getSelection().createBookmarks();t.remove(!0),e.getSelection().selectBookmarks(i)}},W=function(t){if(F(t)){var n=e.elementPath().contains({b:1,i:1,u:1,del:1,span:1},!1,!0);n&&!n.equals(t)&&t.breakParent(n)}},G=function(e){for(;e;)e.type===CKEDITOR.NODE_ELEMENT&&("p"===e.getName()?K(e):"ul"===e.getName()&&G(e.getFirst())),e=e.getNext()},K=function(t){for(var n=e.getSelection().getRanges()[0].clone(),i=t.getFirst(),o=e.getSelection().createBookmarks();i;){if(i.type===CKEDITOR.NODE_TEXT){var a=i.getText(),r=u.ELEMENT.HASHTAG,l=a.match(p);if(l||(r="gOuterLink",l=s.extractUrlString(a)),l){var c=l[0].trim(),d=a.indexOf(c),h=d+c.length,m=H();if(m.setAttribute("data-cke-filter","off"),m.setText(c),m.addClass(r),n.setStart(i,d),n.setEnd(i,h),n.deleteContents(),n.insertNode(m),e.getSelection().selectRanges([n]),W(m),"gOuterLink"===r){var _=t.getAscendant({p:1,li:1},!0);Y(c,_)}}}i=i.getNext()}try{e.getSelection().selectBookmarks(o)}catch(e){}},Y=function(t,n){var o=n.getCustomData("data-band-snippet")?n.getCustomData("data-band-snippet").split(","):[];i.contains(o,t)||a.getSnippet(t).then(i.bind((function(i){o.push(t),n.setCustomData("data-band-snippet",o.join(","));var s=e.getSelection().createBookmarks(),a=e.createRange();a.moveToElementEditEnd(n),a.select(),e.execCommand("addBandWidget",{type:"snippet",params:{model:r.createSnippet(i)}});try{e.getSelection().selectBookmarks(s)}catch(e){}}),this))},j=function(){var t=e.getSelection(),n=t.getStartElement(),i=t.getRanges()[0],o=i.startContainer;if(F(n)&&x(o)){var s=o.getText().replace(_,"");if(s&&1===s.length)65283===s.charCodeAt(0)&&(o.setText("#"),i.moveToElementEditEnd(o),i.select())}},Q={_TAG_PARENT:t("#autoCompleteParent"),_TAG_LIST_CLASS:"_hashTag_"+e.id,_TAG_LIST_SELECTOR:function(){return"."+this._TAG_LIST_CLASS},_TAG_ITEM_CLASS:"_hashTagItem",_TAG_ACTIVE_ITEM_CLASS:"active",_TAG_ITEM_TEMPLATE:function(e){return e.is_pinned?i.template('<li data-hashtag="'+e.hashtag+'" class="'+this._TAG_ITEM_CLASS+'"><span class="name">'+e.hashtag+"</span><em class=\"pinnedTag sf_tBorderOpacity sf_color\"><%-IM('web.board.search.hashtag.label.pinned')%></em></li>"):i.template('<li data-hashtag="'+e.hashtag+'" class="'+this._TAG_ITEM_CLASS+'"><span class="name">'+e.hashtag+"</span></li>")},_ESCAPE_REGEX:/[-[\]{}()*+?.,\\^$|#\s]/g,_CK_SHIFT_ENTER:2228237,_CK_CTRL_ENTER:1114125,_LAYER_MARGIN_TOP:107,_HEADER_HEIGHT:96,_DOCUMENT_NODE_TYPE:9,_DATA_FETCHED:!1,_HASH_TAG_MODEL:null,_SEARCH_INPUT_TIMER:null,_SEARCH_DELAY:50,_TYPING_TAG:!0,_EX_HTML:null,_SCROLL_TOP:null,_SCROLL_EVENT:"scroll",initialize:function(){this._autoCloseLayer(),this._isDataFetched()?this._createHashTagList():this._fetchBandHashTags().then(i.bind((function(e){this._DATA_FETCHED=!0,this._HASH_TAG_MODEL=e,this._createHashTagList()}),this))},_getEditorscrollParent:function(){return e.element&&e.element.$?t(e.element.$).scrollParent():null},_autoCloseLayer:function(){var e=this._getEditorscrollParent();e&&e.length&&(this._autoCloseOnScrollEventHandler=i.bind(this._autoCloseOnScrollEvent,this),this._autoCloseOnClickEventHandler=i.bind(this._autoCloseOnClickEvent,this),e.off(this._SCROLL_EVENT,this._autoCloseOnScrollEventHandler).on(this._SCROLL_EVENT,this._autoCloseOnScrollEventHandler),d.getDGlobalChannel().off(d.EVENT.HTML_CLICK,this._autoCloseOnClickEventHandler).on(d.EVENT.HTML_CLICK,this._autoCloseOnClickEventHandler))},_autoCloseOnScrollEvent:function(e){var n=t(e.currentTarget).scrollTop();null!==this._SCROLL_TOP?(this._SCROLL_TOP<n+20||this._SCROLL_TOP>n-20)&&this.removeAutoCompleteList():this._SCROLL_TOP=n},_autoCloseOnClickEvent:function(e){e&&(t.contains(this._TAG_PARENT.get(0),e.target)||this.removeAutoCompleteList())},_fetchBandHashTags:function(){return(new c).fetchBandTags(f)},_isDataFetched:function(){return this._DATA_FETCHED},_getBandHashTags:function(){return this._HASH_TAG_MODEL},_searchHashTagList:function(){clearTimeout(this._SEARCH_INPUT_TIMER),this._SEARCH_INPUT_TIMER=setTimeout(i.bind(this._filterAndShowTargetsFromInitList,this),this._SEARCH_DELAY)},_filterAndShowTargetsFromInitList:function(){if(e.startHashTagStart){var t=e.getSelection().getRanges()[0].startContainer.getText().replace(_,""),n=this._filterTargetList(t);i.isEmpty(n)?this.removeAutoCompleteList():(this._createHashTagList(n,t),this._bindBandHashTagListEvent())}},_filterTargetList:function(e){var t=this._extractTypingMatchingList(this._HASH_TAG_MODEL,e);if(!i.isEmpty(t))return t;var n=e.slice(0,-1);return this._extractTypingMatchingList(this._HASH_TAG_MODEL,n)},_extractTypingMatchingList:function(e,t){e=e.get("bandTags");var n=i.filter(e,(function(e){return e.hashtag.toLowerCase().indexOf(t.toLowerCase())>-1}));return n.length?n:e},_createHashTagList:function(n,o){if(n=n||this._getBandHashTags().get("bandTags"),!i.isEmpty(n)){var s=e.getSelection(),a=t(s.getStartElement().$),r=a.offset(),l=r.top+a.height(),c=r.left,d=t('<div class="cAutoCompleteList '+this._TAG_LIST_CLASS+'" style="top:'+l+"px; left:"+c+'px;"></div>'),u=g?t('<em class="infoTag">'+IM("autocomplete.post_hashtag.desc")+"</em>"):"",h=t('<div class="scrollWrap _scrollWrap"></div>'),p=t('<ul class="roundThumbList"></ul>');i.each(n,i.bind((function(e){var t=this._TAG_ITEM_TEMPLATE(e);p.append(this._highlightText(t,o))}),this)),h.append(u),d.append(h.append(p)),this._TAG_PARENT.html(d),d.show(),this._startHashTagStart(),this._adjustMentionListOffset(d,a),this._bindBandHashTagListEvent(),this._bindKeyEvent()}},_startHashTagStart:function(){e.startHashTagStart=!0},_adjustMentionListOffset:function(e,n){var i=n.offset(),o=n.position().top+n.height()+e.height(),s=t(window),a=this._getEditorscrollParent(),r=a.scrollParent();r[0].nodeType==this._DOCUMENT_NODE_TYPE?o+a.offset().top-a.scrollTop()>this.$win.height()+s.scrollTop()&&this._placeListUp(e,i.top):o+r.position().top-a.scrollTop()+this._HEADER_HEIGHT+this._LAYER_MARGIN_TOP>s.height()&&this._placeListUp(e,i.top)},_placeListUp:function(e,n){var i=t(window).height(),o=e.height(),s="absolute";n+o>=i&&(n=i-o-10,s="fixed"),e.addClass("-top"),e.css({position:s,top:n})},_bindKeyEvent:function(){var n=e.editable();(t.browser.msie||t.browser.msedge)&&n.attachListener(n,"keyup",i.bind((function(){this._keyUpListenerForIe()}),this)),n.attachListener(n,"click",i.bind((function(){this.removeAutoCompleteList()}),this)),e.hasListeners("key")&&e.removeListener("key",this._keyListener),e.on("key",i.bind((function(e){this._keyListener(e)}),this)),e.hasListeners("change")&&e.removeListener("change",i.bind((function(){}),this)),e.on("change",i.bind((function(){this._changeListener()}),this)),e.on("destroy",i.bind((function(){this.removeAutoCompleteList()}),this))},_keyListener:function(t){if(e.startHashTagStart)if(this._shouldStopTyping(t))this.removeAutoCompleteList();else{switch(t.data.keyCode){case l.UP:this._highlightPrevNextItem(!1);break;case l.DOWN:this._highlightPrevNextItem(!0);break;case l.ENTER:case this._CK_SHIFT_ENTER:case this._CK_CTRL_ENTER:case l.TAB:this._selectItem();break;case l.IME:case CKEDITOR.SHIFT+l.IME:case CKEDITOR.CTRL+l.IME:var n=t.data.domEvent.$.code;"Enter"!==n&&"NumpadEnter"!==n||setTimeout(i.bind(this._selectItem,this),10);break;default:return}t.cancel()}},_changeListener:function(){if(this._isDataFetched()){var t=e.editable().getData(!0);this._isSameAsBefore(t)?this._setExHtml(t):(this._TYPING_TAG=!0,this._setExHtml(t),this._searchHashTagList())}},_keyUpListenerForIe:function(){this._changeListener()},_setExHtml:function(e){this._EX_HTML=e},_isSameAsBefore:function(e){return this._EX_HTML==e},_shouldStopTyping:function(e){var t=e.data.domEvent.$,n=t.keyCode;switch(n){case l.ESCAPE:case l.END:case l.HOME:case l.LEFT:case l.RIGHT:case l.PAGE_UP:case l.PAGE_DOWN:return!0}if(229===n)switch(t.code){case"Escape":case"End":case"Home":case"ArrowLeft":case"ArrowRight":case"PageUp":case"PageDown":return!0}return!1},_highlightSearchItem:function(e){return t(this._TAG_LIST_SELECTOR()).filter(":visible").find("."+this._TAG_ITEM_CLASS+e)},_highlightPrevNextItem:function(e){this._TYPING_TAG=!1;var n=null,i=":last-child";e&&(i=":first-child"),(n=null==this._activeItem?this._highlightSearchItem(i):t(e?this._activeItem.next():this._activeItem.prev())).is(":visible")||(n=this._highlightSearchItem(i)),this._highlightItem(n),this._scrollToItem(n)},_scrollToItem:function(e){e.closest("._scrollWrap").finish().animate({scrollTop:e.innerHeight()*e.index()},{duration:30})},_highlightText:function(e,t){if(!t)return e();var n=i.escape(t).replace(this._ESCAPE_REGEX,"\\$&");return e().replace(new RegExp("(>[^<]*?)("+n+")([^<]*</li>)","gi"),"$1<b>$2</b>$3")},_bindBandHashTagListEvent:function(){var e=t(this._TAG_LIST_SELECTOR()).find("."+this._TAG_ITEM_CLASS);this._setBandHashTagList(e),e.off(),e.mousedown((function(){return!1})),e.mouseup((function(){return!1})),e.click(i.bind((function(e){return this._TYPING_TAG=!1,this._setActiveItem(t(e.currentTarget)),this._selectItem(),!1}),this)),e.mouseover(i.bind((function(e){return this._TYPING_TAG=!1,this._setActiveItem(t(e.currentTarget)),this._highlightItem(this._activeItem),!1}),this))},_setBandHashTagList:function(e){this._bandHashTagList=e},_setActiveItem:function(e){this._activeItem=e},_highlightItem:function(e){0!=e.length&&(e.siblings().removeClass(this._TAG_ACTIVE_ITEM_CLASS),e.addClass(this._TAG_ACTIVE_ITEM_CLASS),this._setActiveItem(e))},_selectItem:function(){if(!this._TYPING_TAG&&this._activeItem){var t=e.getSelection().getRanges()[0],n=this._activeItem.data("hashtag"),o=function(){return this.tmpIESelectRange||null}(),s=CKEDITOR.env.ie&&!i.isNull(o),a=s?o.startContainer:t.startContainer;a.setText(n),e.focus();var r=F(a)?a:a.getParent();W(r);var l=r.getNext();R(l)||(l=new CKEDITOR.dom.text(" ")).insertAfter(r),t.moveToPosition(l,CKEDITOR.POSITION_AFTER_END),t.select(),s&&T(null),e.fire(h.EVENT.WIDGET_ADDED_HASHTAG),this.removeAutoCompleteList()}else this.removeAutoCompleteList()},removeAutoCompleteList:function(){this._bandHashTagList&&(this._bandHashTagList.off(),this._bandHashTagList=null),this._activeItem=null,t(this._TAG_LIST_SELECTOR()).remove(),e.startHashTagStart=!1,e.removeListener("key",i.bind((function(){this._keyListener()}),this)),e.removeListener("change",i.bind((function(){this._changeListener()}),this)),e.removeListener("keyup",i.bind((function(){this._keyUpListenerForIe()}),this)),this._autoCloseOnScrollEventHandler&&this._getEditorscrollParent()&&(this._getEditorscrollParent().off(this._SCROLL_EVENT,this._autoCloseOnScrollEventHandler),this._SCROLL_TOP=null,this._autoCloseOnScrollEventHandler=null),this._autoCloseOnClickEventHandler&&(d.getDGlobalChannel().off(d.EVENT.HTML_CLICK,this._autoCloseOnClickEventHandler),this._autoCloseOnClickEventHandler=null)}};return{openHashtagList:E}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(4),s=n(2400),a=n(563),r=n(1093),l=n(159),c=n(486),d=o.View.extend({tagName:"section",className:"lyWrap -liteBg",attributes:{"data-viewname":"DEditorStickerAttachView"},template:i.template(s),regions:{stickerRegion:"._stickerRegion"},events:{"click ._dimmed":"destroy","click ._btnClose":"destroy"},behaviors:{CourierBehavior:""},onMessages:(t={},t[l.MSG.DSTICKER_CLICK]=function(e){var t=a.createSticker({sticker_id:e.stickerId,pack_no:e.packNo});this.trigger("editor:sticker:selected",t),this.destroy()},t),initialize:function(e){this._bandNo=e.bandNo,this._useBandStickerPack=e.useBandStickerPack},onAttach:function(){var e={};this._useBandStickerPack&&(e.bandNo=this._bandNo),this.showChildView("stickerRegion",r.buildDStickerSelectionLayoutView(e))}});return d.openLayer=function(e){var t=new d(e);return c.openWithoutHiding(t),t},d}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='\n<div class="lyContent -w530">\n    <header class="header">\n        <h1 class="title"><%-IM(\'web.postwrite.attach.title.sticker\')%></h1>\n    </header>\n\n    <div class="main -spaceNone _stickerRegion postWriteSticker"></div>\n\n    <footer class="footer -h0">\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM(\'web.ui.button.label.close\')%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(486),s=n(43),a=n(9),r=n(2402),l=n(1115),c=n(1260),d=n(165),u=n(1146),h=n(204),p=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DEditorWriteSettingView"},template:t.template(r),templateContext:function(){return{msg_isNoticeEditPermitted:this.bandData.isNoticeEditPermitted(),msg_isCreateReservedPostPermitted:this.bandData.isCreateReservedPostPermitted()&&this._setReservedInfoEnabled,msg_isSetLinkedBandNoticeEnabled:this._isSetLinkedBandNoticeEnabled,msg_isLinkedBandNotice:this.model.get("isLinkedBandNotice"),msg_savableDesc:this._getSavableDesc(),isCopiableState:this._isCopiable,supportSaveSettingPerContent:this.bandData.getBandCore().supportSaveSettingPerContent(),commentDisableMenu:this.bandData.canSetDisableCommentOnPost(),shouldDisableComment:this.model.get("shouldDisableComment")}},ui:{checkNotice:"._checkNotice",checkMajorNotice:"._checkMajorNotice",noticeSettingWrap:"._noticeSettingWrap",checkReserve:"._checkReserve",reserveDateWrap:"._reserveDateWrap",reserveDateInputRegion:"._reserveDateInputRegion",reserveTextSpan:"._reserveTextSpan",btnComplete:"._btnComplete",btnCancel:"._btnCancel",checkLinkedBandNotice:"._checkLinkedBandNotice",noticeNewsDescription:"._noticeNewsDescription",reserveDescription:"._reserveDescription",reserveGmtText:"._reserveGmtText",reserveTimezoneRegion:"._reserveTimezoneRegion",checkSavable:"._checkSavable",savableTxt:"._savableTxt",checkNoticeUnset:"._checkNoticeUnset",noticeEndItemWrap:"._noticeEndItemWrap",noticeEndDataWrap:"._noticeEndDataWrap",noticeUnSetTextSpan:"._noticeUnSetTextSpan",noticeGmtText:"._noticeGmtText",noticeDateInputRegion:"._noticeDateInputRegion",noticeTimezoneRegion:"._noticeTimezoneRegion",commentEnable:"._commentEnable"},regions:{reserveDateInputRegion:{el:"@ui.reserveDateInputRegion",replaceElement:!0},reserveTimezoneRegion:{el:"@ui.reserveTimezoneRegion",replaceElement:!0},noticeDateInputRegion:{el:"@ui.noticeDateInputRegion",replaceElement:!0},noticeTimezoneRegion:{el:"@ui.noticeTimezoneRegion",replaceElement:!0}},events:{"click @ui.checkNotice":"_toggleNoticeSettingWrap","click @ui.checkReserve":function(e){if(this.ui.checkReserve.is(":checked")){if(this._openReserveDateInputRegion(),this._getBandNoticeUnsetAt().diff(this.publishesAt,"minutes")>=30)return;this.ui.checkNoticeUnset.is(":checked")&&(this.bandNoticeUnsetAt=this._getNoticeAtMinDate(),this._closeNoticeDateInputRegion(),this._openNoticeDateInputRegion())}else this._closeReserveDateInputRegion()},"click @ui.reserveGmtText":"_showReserveTimezoneSettingArea","click @ui.btnCancel":"destroy","click @ui.btnComplete":"_saveSetting","click @ui.checkSavable":"_toggleSavableSetting","click @ui.checkNoticeUnset":function(){this.ui.checkNoticeUnset.is(":checked")?this._openNoticeDateInputRegion():this._closeNoticeDateInputRegion()},"click @ui.noticeGmtText":"_showNoticeTimezoneSettingArea"},initialize:function(e){this._body=$("body"),this.bandData=e.bandData,this._setReservedInfoEnabled=e.setReservedInfoEnabled||!1,this._isSetLinkedBandNoticeEnabled=e.isSetLinkedBandNoticeEnabled||!1,this._isCopiable=this._isCopiableState(),this.publishesAt=this.model.get("publishesAt")?s(this.model.get("publishesAt")):this.model.getMinimumReserveTime(),this.bandNoticeUnsetAt=this.model.get("bandNoticeUnsetAt")?s(this.model.get("bandNoticeUnsetAt")):this.model.getMinimumReserveTime(),this._originLinkedBandNotice=this.model.get("isLinkedBandNotice"),this._reservationTimezoneId=this.model.get("reservationTimeZoneId")||d.getCurrentTimezoneId(),this._noticeEndTimezoneId=this.model.get("bandNoticeTimeZoneId")||d.getCurrentTimezoneId()},onRender:function(){var e=c.isNotificationTypePost(this.model);this.ui.noticeNewsDescription.toggle(e),this.ui.noticeSettingWrap.toggle(e),this.bandData.isCreateReservedPostPermitted()&&this.model.get("publishesAt")?this._openReserveDateInputRegion():this._closeReserveDateInputRegion(),e&&this.model.get("bandNoticeUnsetAt")?this._openNoticeDateInputRegion():this._closeNoticeDateInputRegion()},_getBandNoticeUnsetAt:function(){return this.model.get("bandNoticeUnsetAt")?s.tz(this.bandNoticeUnsetAt,this._noticeEndTimezoneId):this._getNoticeAtMinDate()},_isCopiableState:function(){switch(this.model.getCopiableState()){case h.STATE.ENABLED:return!0;case h.STATE.DISABLED:return!1;default:return this.bandData.isMediaSavable()}},_getSavableDesc:function(){return this.bandData.isPostCopySupportable()?this._isCopiable?IM("bandsetting.media_download_setting.desc1"):IM("bandsetting.media_download_setting.desc2"):this._isCopiable?IM("bandsetting.media_download_setting.desc3"):IM("bandsetting.media_download_setting.desc4")},_toggleSavableSetting:function(){this._isCopiable=this.getUI("checkSavable").prop("checked"),this.getUI("savableTxt").text(this._getSavableDesc())},_renderPublishesAtUI:function(){var e=this.ui.checkReserve.is(":checked");e&&(this.ui.reserveTextSpan.text(a.format.dateByTimezone(this.publishesAt,"date_time",this._reservationTimezoneId)),this.ui.reserveTextSpan.css({display:"block"})),this.ui.reserveTextSpan.toggle(e)},_renderReserveGmtText:function(){var e=this.getUI("checkReserve").is(":checked");e&&(this.getUI("reserveGmtText").text(d.getTimezone(this._reservationTimezoneId).gmtString),this.getUI("reserveGmtText").css("display","block")),this.getUI("reserveGmtText").toggle(e)},_renderNoticeUnsetAtUI:function(){var e=this.ui.checkNoticeUnset.is(":checked");e&&(this.ui.noticeUnSetTextSpan.text(a.format.dateByTimezone(this._getBandNoticeUnsetAt(),"date_time",this._noticeEndTimezoneId)),this.ui.noticeUnSetTextSpan.css({display:"block"})),this.ui.noticeUnSetTextSpan.toggle(e)},_renderNoticeGmtText:function(){var e=this.getUI("checkNoticeUnset").is(":checked");e&&(this.getUI("noticeGmtText").text(d.getTimezone(this._noticeEndTimezoneId).gmtString),this.getUI("noticeGmtText").css("display","block")),this.getUI("noticeGmtText").toggle(e)},_showReserveTimezoneSettingArea:function(){if(this.getRegion("reserveTimezoneRegion").hasView())this.getRegion("reserveTimezoneRegion").empty();else{var e=new u({timezoneId:this._reservationTimezoneId,isShowTimezoneTitle:!1});this.getRegion("reserveTimezoneRegion").show(e),this.listenTo(e,u.EVENT.TIMEZONE_CHANGED,(function(e){this._reservationTimezoneId=e;var t=this._getPublishesAtMinDate();this.publishesAt.isBefore(t)&&(this.publishesAt=t);var n=this._getPublishesAtMaxDate();this.publishesAt.isAfter(n)&&(this.publishesAt=n);var i=s.tz(this.publishesAt,this._reservationTimezoneId),o=i.format("YYYY-MM-DD"),a=i.format("HH:mm");this._reserveDateTimePickerView.setDateTime(o,a),this._renderPublishesAtUI(),this._renderReserveGmtText()}))}},_showNoticeTimezoneSettingArea:function(){if(this.getRegion("noticeTimezoneRegion").hasView())this.getRegion("noticeTimezoneRegion").empty();else{var e=new u({timezoneId:this._noticeEndTimezoneId,isShowTimezoneTitle:!1});this.getRegion("noticeTimezoneRegion").show(e),this.listenTo(e,u.EVENT.TIMEZONE_CHANGED,(function(e){this._noticeEndTimezoneId=e;var t=this._getNoticeAtMinDate();this.bandNoticeUnsetAt.isBefore(t)&&(this.bandNoticeUnsetAt=t);var n=this._getNoticeAtMaxDate();this.bandNoticeUnsetAt.isAfter(n)&&(this.bandNoticeUnsetAt=n);var i=s.tz(this.bandNoticeUnsetAt,this._noticeEndTimezoneId),o=i.format("YYYY-MM-DD"),a=i.format("HH:mm");this._noticeDateTimePickerView.setDateTime(o,a),this._renderNoticeUnsetAtUI(),this._renderNoticeGmtText()}))}},_toggleNoticeSettingWrap:function(){var e=this.ui.checkNotice.is(":checked");e?(this.ui.noticeSettingWrap.slideDown(),this.ui.noticeEndItemWrap.show()):(this.ui.noticeSettingWrap.slideUp(),this.ui.noticeEndItemWrap.hide()),this.ui.noticeNewsDescription.toggle(e)},_openReserveDateInputRegion:function(){var e=this.getRegion("reserveDateInputRegion");e&&e.hasView()||(this._reserveDateTimePickerView=l.buildSolarDateInputView({dateTime:this.publishesAt,timezoneId:this._reservationTimezoneId,canTextEdit:!0,timeMinutesInterval:5,datepickerDirection:l.DATEPICKER_DIRECTION.DOWN,timepickerDirection:l.TIMEPICKER_DIRECTION.DOWN,dateValidator:{isValid:t.bind(this._isValidReserveDateTime,this),getMinDate:t.bind(this._getPublishesAtMinDate,this),getMaxDate:t.bind(this._getPublishesAtMaxDate,this)}}),this.listenTo(this._reserveDateTimePickerView,"dateTimeChanged",(function(e){this._reserveDateTimePickerView.isDestroyed()||(this.publishesAt=s.tz(e.date+" "+e.time,e.dateFormat+" "+e.timeFormat,this._reservationTimezoneId),this.ui.checkNoticeUnset.is(":checked")&&this._getBandNoticeUnsetAt().diff(this.publishesAt,"minutes")<=29&&(this.bandNoticeUnsetAt=this._getNoticeAtMinDate(),this._closeNoticeDateInputRegion(),this._openNoticeDateInputRegion()),this._renderPublishesAtUI())})),this.ui.reserveDateWrap.show(),e.show(this._reserveDateTimePickerView),this._renderPublishesAtUI(),this._renderReserveGmtText(),this._reservationTimezoneId!=d.getCurrentTimezoneId()&&this._showReserveTimezoneSettingArea())},_closeReserveDateInputRegion:function(){var e=this.getRegion("reserveDateInputRegion");this.ui.reserveDateWrap.hide(),e&&e.hasView()&&e.empty(),this._renderPublishesAtUI(),this._renderReserveGmtText(),this.getUI("reserveTimezoneRegion").hide(),this.getRegion("reserveTimezoneRegion")&&this.getRegion("reserveTimezoneRegion").hasView()&&this.getRegion("reserveTimezoneRegion").empty()},_openNoticeDateInputRegion:function(){var e=this.getRegion("noticeDateInputRegion");e&&e.hasView()||(this._noticeDateTimePickerView=l.buildSolarDateInputView({dateTime:this._getBandNoticeUnsetAt(),timezoneId:this._noticeEndTimezoneId,canTextEdit:!0,timeMinutesInterval:5,datepickerDirection:l.DATEPICKER_DIRECTION.DOWN,timepickerDirection:l.TIMEPICKER_DIRECTION.DOWN,dateValidator:{isValid:t.bind(this._isValidNoticeDateTime,this),getMinDate:t.bind(this._getNoticeAtMinDate,this),getMaxDate:t.bind(this._getNoticeAtMaxDate,this)}}),this.listenTo(this._noticeDateTimePickerView,"dateTimeChanged",(function(e){this._noticeDateTimePickerView.isDestroyed()||(this.bandNoticeUnsetAt=s.tz(e.date+" "+e.time,e.dateFormat+" "+e.timeFormat,this._noticeEndTimezoneId),this._renderNoticeUnsetAtUI())})),this.ui.noticeEndDataWrap.show(),e.show(this._noticeDateTimePickerView),this._renderNoticeUnsetAtUI(),this._renderNoticeGmtText(),this._noticeEndTimezoneId!=d.getCurrentTimezoneId()&&this._showNoticeTimezoneSettingArea())},_closeNoticeDateInputRegion:function(){var e=this.getRegion("noticeDateInputRegion");this.ui.noticeEndDataWrap.hide(),e&&e.hasView()&&e.empty(),this._renderNoticeUnsetAtUI(),this._renderNoticeGmtText(),this.getUI("noticeTimezoneRegion").hide(),this.getRegion("noticeTimezoneRegion")&&this.getRegion("noticeTimezoneRegion").hasView()&&this.getRegion("noticeTimezoneRegion").empty()},_getPublishesAtMinDate:function(){return s.tz(this.model.getMinimumReserveTime(),this._reservationTimezoneId)},_getPublishesAtMaxDate:function(){return s().tz(this._reservationTimezoneId).add(59,"days").endOf("day")},_getNoticeAtMinDate:function(){var e=this.model.getMinimumReserveTime();return this.ui.checkReserve.is(":checked")&&(e=s(this.publishesAt).add(30,"m").startOf("minute")),s.tz(e,this._noticeEndTimezoneId)},_getNoticeAtMaxDate:function(){return s().tz(this._noticeEndTimezoneId).add(59,"days").endOf("day")},_isValidReserveDateTime:function(e){var t=s.tz(e.date+" "+e.time,e.dateFormat+" "+e.timeFormat,this._reservationTimezoneId);return t.isBefore(this._getPublishesAtMinDate())?(alert(IM("web.postwrite.alert.reservation_time_min")),!1):!t.isAfter(this._getPublishesAtMaxDate())||(alert(IM("web.postwrite.alert.reservation_time_max")),!1)},_isValidNoticeDateTime:function(e){var t=s.tz(e.date+" "+e.time,e.dateFormat+" "+e.timeFormat,this._noticeEndTimezoneId);return!t.isBefore(this._getNoticeAtMinDate())&&!t.isAfter(this._getNoticeAtMaxDate())||(alert(IM("postwrite.attach.poll.alert_invalid_ended_at")),!1)},_saveSetting:function(){this.bandData.isNoticeEditPermitted()&&(this.model.set("isNotice",this.ui.checkNotice.is(":checked")),this.model.set("isMajorNotice",this.ui.checkNotice.is(":checked")&&this.ui.checkMajorNotice.is(":checked")),this._setLinkedBandNotice()),this.bandData.isCreateReservedPostPermitted()&&this.ui.checkReserve.is(":checked")?(this.model.set("publishesAt",this.publishesAt.valueOf()),this.model.set("reservationTimeZoneId",this._reservationTimezoneId)):(this.model.set("publishesAt",null),this.model.set("reservationTimeZoneId",null)),this.bandData.isNoticeEditPermitted()&&this.ui.checkNoticeUnset.is(":checked")?(this.model.set("bandNoticeUnsetAt",this.bandNoticeUnsetAt.valueOf()),this.model.set("bandNoticeTimeZoneId",this._noticeEndTimezoneId)):this.model.set("bandNoticeUnsetAt",null),this.model.set("copiableState",this._isCopiable?h.STATE.ENABLED:h.STATE.DISABLED),this.model.set("shouldDisableComment",!1===this.ui.commentEnable.prop("checked")),this.destroy()},_setLinkedBandNotice:function(){var e=this.ui.checkLinkedBandNotice.is(":checked");this._originLinkedBandNotice==this.ui.checkLinkedBandNotice.is(":checked")&&(e=null),c.isNotificationTypePost(this.model)||(e=!1),this.model.set("isLinkedBandNotice",e)}});return p.openLayer=function(e,t,n,i){var s=new p({bandData:e,model:t,setReservedInfoEnabled:n,isSetLinkedBandNoticeEnabled:i});return o.openWithoutHiding(s),s},p}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title"><%-IM(\'web.postwrite.btn.write_setting\')%></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gMat-2">\n            <ul class="listLine">\n                <% // "공지로 등록" %>\n                <% if (msg_isNoticeEditPermitted) { %>\n                <li class="tLine notiSettingItem">\n                    <div class="flexList -alignItemstart">\n                        <div class="text">\n                            <label for="notice" class="text gFs14 gFw6"><%-IM(\'web.postwrite.set_notice\')%></label>\n                        </div>\n                        <div class="etc gPal0 gMat2">\n                            <label for="notice" class="uCheck -switch">\n                                <input type="checkbox" id="notice" class="checkInput _checkNotice" <%if(isNotice){%>checked<%}%>>\n                                <span class="checkLabel">\n                                <span class="shape"></span>\n                            </span>\n                            </label>\n                        </div>\n                    </div>\n                    <p class="notiSettingDese gMat-9 _noticeNewsDescription" style="display: none;"><%- IM(\'postwrite.setting.notice_news_description\') %></p>\n                    <div class=" _noticeSettingWrap">\n                        <% // "중요 공지로 등록" %>\n                        <div class="optionItem gMat11 gMal0">\n                            <label for="important" class="uCheck -checkbox ">\n                                <input type="checkbox" id="important" class="checkInput _checkMajorNotice" <%if(isMajorNotice){%>checked<%}%>>\n                                <span class="checkLabel">\n                                <span class="shape"></span>\n                                <span class="text gMal10"><%-IM(\'web.postwrite.set_major_notice\')%></span>\n                            </span>\n                            </label>\n                            <div class="optionItemDesc gFs12 gColorGr1 gMat4 gMal30 gMab13"><%=IM(\'web.postwrite.major_notice_desc\')%></div>\n                        </div>\n\n                        \x3c!-- 페이지 게시글 설정 > 연결된 밴드에 공지로 등록 --\x3e\n                        <% if (msg_isSetLinkedBandNoticeEnabled) { %>\n                        <div class="pageNotiCheck optionItem gPat12">\n\n                            <label for="connected" class="uCheck -checkbox ">\n                                <input type="checkbox" id="connected" class="checkInput _checkLinkedBandNotice" <% if (msg_isLinkedBandNotice) { %> checked <%}%>>\n                                <span class="checkLabel">\n                                <span class="shape "></span>\n                                <span class="text"><%= IM("pageBand.notice.setConnectBand") %></span>\n                            </span>\n                            </label>\n                            <div class="optionItemDesc gFs12 gColorGr1 gMat4 gMal28 gMab9"><%= IM("page.notice.linked_band.desc") %></div>\n                        </div>\n                        <% } %>\n                    </div>\n                </li>\n\n                <% // "공지 내리기(종료) 설정" %>\n                <li class="tLine notiSettingItem gMab5 _noticeEndItemWrap" <%- isNotice ? \'\' : \'style=display:none\'%> >\n                    <div class="flexList -alignItemstart">\n                        <div class="text">\n                            <label for="noticeUnSet" class="text gFs14 gFw6"><%-IM(\'web.postwrite.unset_notice\')%></label>\n                        </div>\n                        <div class="etc gPal0 gMat2">\n                            <label for="notice" class="uCheck -switch">\n                                <input type="checkbox" id="noticeUnSet" class="checkInput _checkNoticeUnset" <%if(isNotice && bandNoticeUnsetAt){%>checked<%}%>>\n                                <span class="checkLabel">\n                                <span class="shape"></span>\n                            </span>\n                            </label>\n                        </div>\n                    </div>\n\n                    <div class="_noticeEndDataWrap">\n                        <div class="flexList -spaceBetween">\n                            <time datetime="" class="gFs12 _noticeUnSetTextSpan" style="display: none;"></time>\n                            <button class="btnLinkText gFs12 gMat-2 _noticeGmtText" style="display: none;"></button>\n                        </div>\n                        <% // 공지 종료 일시 선택 영역 %>\n                        <div class="optionDateTime gMat-4 gMab7">\n                            <div class="_noticeDateInputRegion"></div>\n                        </div>\n                        <% // 타임존 선택 영역 %>\n                        <div class="optionDateTime gMat-2 gMab7">\n                            <div class="_noticeTimezoneRegion"></div>\n                        </div>\n                    </div>\n\n                </li>\n                <% } %>\n\n                <% // "예약시간 설정" %>\n                <% if (msg_isCreateReservedPostPermitted) { %>\n                <li class="tLine notiSettingItem gMab5">\n                    <div class="flexList gMat-2">\n                        <div class="text gFs14 gFw6">\n                            <label for="reserve"><%-IM(\'web.postwrite.set_reserve_time\')%></label>\n                        </div>\n                        <div class="etc gMat2">\n                            <label for="reserve" class="uCheck -switch">\n                                <input type="checkbox" id="reserve" class="checkInput _checkReserve" <%if(publishesAt){%>checked<%}%>>\n                                <span class="checkLabel">\n                                <span class="shape"></span>\n                            </span>\n                            </label>\n                        </div>\n                    </div>\n                    <p class="notiSettingDese gMat-10"><%-IM(\'web.postwrite.reserve_desc\')%></p>\n                    <div class="reserveDataSettingWrap _reserveDateWrap">\n                        <div class="flexList -spaceBetween gMat8">\n                            <time datetime="" class="gFs12 _reserveTextSpan" style="display: none;"></time>\n                            <button class="btnLinkText gFs12 gMat-2 _reserveGmtText" style="display: none;"></button>\n                        </div>\n                        <% // 예약 일시 선택 영역 %>\n                        <div class="optionDateTime gMat-4 gMab7">\n                            <div class="_reserveDateInputRegion"></div>\n                        </div>\n                        <% // 타임존 선택 영역 %>\n                        <div class="optionDateTime gMat-2 gMab7">\n                            <div class="_reserveTimezoneRegion"></div>\n                        </div>\n                    </div>\n\n                </li>\n                <% } %>\n\n                <% if (supportSaveSettingPerContent) { %>\n                <li class="tLine notiSettingItem">\n                    <div class="flexList -alignItemstart gMat-1">\n                        <div class="text">\n                            <label for="savable" class="labelTitle gFs14"><%- IM(\'bandsetting.media_download_permission.download_enabled\') %></label>\n                            <p class="sub2 gMat1 _savableTxt"><%= msg_savableDesc %></p>\n                        </div>\n                        <div class="etc gMat2">\n                            <label for="savable" class="uCheck -switch">\n                                <input type="checkbox" id="savable" class="checkInput _checkSavable" <%- (isCopiableState) ? \'checked\' : \'\' %>>\n                                <span class="checkLabel">\n                                    <span class="shape"></span>\n                                </span>\n                            </label>\n                        </div>\n                    </div>\n                </li>\n                <% } %>\n\n                <% if (commentDisableMenu) { %>\n                <li class="tLine notiSettingItem">\n                    <div class="flexList -alignItemstart gMat-1">\n                        <div class="text">\n                            <label for="comment_enable" class="labelTitle gFs14"><%- IM(\'postwrite.enable_comment\') %></label>\n                        </div>\n                        <div class="etc gMat2">\n                            <label for="savable" class="uCheck -switch">\n                                <input type="checkbox" id="comment_enable" class="checkInput _commentEnable" <%- shouldDisableComment ? \'\' : \'checked\' %>>\n                                <span class="checkLabel">\n                                    <span class="shape"></span>\n                                </span>\n                            </label>\n                        </div>\n                    </div>\n                </li>\n                <% } %>\n            </ul>\n        </div>\n    </div>\n    <footer class="modalFooter gPat2">\n        <button type="button" class="uButton -cancel _btnCancel"><%-IM(\'ui.label.cancel\')%></button>\n        <button type="button" class="uButton -confirm _btnComplete"><%-IM(\'ui.label.confirm\')%></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(10),s=n(4),a=n(2404),r=n(2405),l=n(2407),c=n(1559),d=n(2410),u=n(1052),h=n(600),p=n(507),m=n(177),_=n(537),g=n(486),f=n(154),b=s.View.extend({EVENT:{CONFIRM:"CONFIRM",FOLDER_CREATED:"FOLDER_CREATED"},tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DBandFileUploadView"},template:i.template(a),ui:{fileCount:"._fileCount",fileList:"._fileList",fileInput:"._fileInput",folderWrap:"._folderWrap",folderBtn:"._folderBtn",folderListWrap:"._folderListWrap",folderNameInput:"._folderNameInput",folderAddBtn:"._folderAddBtn",folderUnsetBtn:"._folderUnsetBtn",folderList:"._folderList",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},regions:{fileList:{el:"@ui.fileList",replaceElement:!0},folderList:{el:"@ui.folderList",replaceElement:!0}},events:{"click @ui.folderBtn":"_toggleFolderList","input @ui.folderNameInput":"_toggleFolderAddBtn","click @ui.folderAddBtn":"_createFolder","click @ui.folderUnsetBtn":function(){this._selectFolder(null)},"click @ui.cancelBtn":"_cancel","click @ui.confirmBtn":"_confirm",click:function(e){this.isDestroyed()||this.ui.folderWrap.get(0).contains(e.target)||this._hideFolderList()}},childViewEvents:{"file:delete":"_deleteFile","folder:select":"_selectFolder"},initialize:function(e){this._bandData=e.bandData,this._files=e.files,this._folders=e.folders,this._folder=e.folder,this._fileCount=e.fileCount||i.constant(0),this._countLimit=e.countLimit||m.FILE.COUNT_LIMIT,this._bandNo=this._bandData.getBandCore().bandNo},serializeData:function(){return{fileCount:this._getFileCount(),countLimit:this._countLimit,folderAddBtn:this._bandData.isCreateAlbumPermitted(),folderNameMaxLength:u.getFolderNameMaxLength()}},onBeforeRender:function(){this._destroyUploader()},onRender:function(){this._renderFileCount(),this._renderFileList(),this._createUploader(),this._renderFolder(),this._renderFolderList()},onBeforeDetach:function(){this._destroyUploader()},_destroyUploader:function(){this._uploader&&(this._uploader.destroy(),this._uploader=null)},_createUploader:function(){this._destroyUploader(),this._uploader=h.createFileUploader(this.ui.fileInput,{fileInputTitle:this.ui.fileInput.attr("title"),skinColor:this._bandData.getBandCore().getSkinColorClass()}),this.listenTo(this._uploader,p.BEFORE_VALIDATE,(function(){this._uploader.setValidators([i.partial(_.FILE_VALIDATOR,i,this._getFileCount(),this._countLimit)])})),this.listenTo(this._uploader,p.UPLOAD_COMPLETE,(function(e){var t=i.map(e.resultList,(function(e){return{id:e.id,file_name:e.name,file_size:e.file_size}}));this._files.addUploadFiles(t),this._renderFileCount()}))},_getFileCount:function(){return this._fileCount()+this._files.size()},_renderFileCount:function(){this.ui.fileCount.html(this._getFileCount()),this.ui.confirmBtn.prop("disabled",this._files.isEmpty())},_renderFileList:function(){var e=l.build({collection:this._files,bandData:this._bandData});this.showChildView("fileList",e)},_renderFolder:function(){this._hideFolderList(),this._folder?this.ui.folderBtn.addClass("-selected").html(i.escape(this._folder.getFolderName())):this.ui.folderBtn.removeClass("-selected").html(IM("file.not_for_folders"))},_renderFolderList:function(){this._folders.sortByNameAsc(),this.showChildView("folderList",d.build({collection:this._folders}))},_toggleFolderList:function(){"none"!==this.ui.folderListWrap.css("display")?this._hideFolderList():this._showFolderList()},_showFolderList:function(){this.ui.folderNameInput.val(""),this._toggleFolderAddBtn(),this.ui.folderListWrap.css("display",""),this.ui.folderNameInput.focus()},_hideFolderList:function(){this.ui.folderListWrap.css("display","none"),this.ui.folderNameInput.val(""),this._toggleFolderAddBtn()},_toggleFolderAddBtn:function(){var e=o.isBlank(this.ui.folderNameInput.val());this.ui.folderAddBtn.toggleClass("-active",!e).prop("disabled",e)},_createFolder:function(){var e=o.trim(this.ui.folderNameInput.val()),t=u.createFolder(this._bandNo,e);f.wrapActivePromise(t,this).then(i.bind((function(e){this._folder=e,this._folders.add(this._folder),this._renderFolder(),this.trigger(this.EVENT.FOLDER_CREATED,this._folder)}),this))},_selectFolder:function(e){this._folder=e,this._renderFolder()},_deleteFile:function(e){this._files.remove(e),this._renderFileCount()},_cancel:function(){this.destroy()},_confirm:function(){this.trigger(this.EVENT.CONFIRM,{files:this._files.getUploadFiles(),folder:this._folder,folderId:this._folder?this._folder.getFolderId():null}),this.destroy()}});b.openLayer=function(e){var t=e.bandData.getBandCore().bandNo,n=r.build(e.files),o=c.build(),s=o.fetchFolders(t),a=new b(i.extend({},e,{files:n,folders:o}));return g.openPromiseView(s,!0,{width:480,height:426,view:a}),a},e.exports=b},function(e,t){e.exports='<div class="lyContent -w480">\n        <header class="modalHeader">\n            <h1 class="title"><%- IM(\'file.upload_file\') %></h1>\n        </header>\n\n        <div class="modalBody">\n            <div class="modalContentWrap gPa0">\n                <div class="fileFolderBox">\n                    <div class="statusBox">\n                        <span class="statusText"><%- IM(\'file\') %><em class="statusNumber _fileCount"><%- fileCount %></em>/<%- countLimit %></span>\n                    </div>\n\n                    <div class="_fileList" style="display:none"></div>\n                    <div class="uploadButtonBox">\n                        <div class="uploadButton _fileInput">\n                            <span class="uploadIcon"></span><%- IM(\'file.add_files\') %>\n                            <input type="file" title="<%- IM(\'file.upload_file\') %>" name="attachment" class="inputFile">\n                        </div>\n                    </div>\n\n                    <div class="selectFolderBox">\n                        <div class="selectFolderBoxTitle"><%- IM(\'file.select_folder\') %></div>\n\n                        <div class="selectFolder _folderWrap">\n                            <div class="uSelect -h36 -block">\n                                <button type="button" class="select _folderBtn"><%- IM(\'file.not_for_folders\') %></button>\n                            </div>\n\n                            <div class="createFolderBox _folderListWrap" style="display:none">\n                                <% if (folderAddBtn) { %>\n                                <div class="createFolder">\n                                    <div class="uInputWrap">\n                                        <div class="uInput">\n                                            <input type="text" class="_folderNameInput" maxlength="<%- folderNameMaxLength %>" placeholder="<%- IM(\'file.create_new_folder\') %>">\n                                            <span class="border"></span>\n                                        </div>\n                                    </div>\n                                    <div class="etc gPal15">\n                                        <button type="button" class="uButton -sizeS -default _folderAddBtn"><%- IM(\'ui.label.add\') %></button>\n                                    </div>\n                                </div>\n                                <% } %>\n\n                                <button type="button" class="selectFolderButton _folderUnsetBtn"><%- IM(\'file.not_for_folders\') %></button>\n\n                                <div style="max-height:183px;overflow-y:auto">\n                                    <div class="_folderList" style="display:none"></div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <footer class="modalFooter">\n            <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n            <button type="button" class="uButton _confirmBtn"><%- IM(\'web.btn.attach\') %></button>\n        </footer>\n    </div>'},function(e,t,n){var i=n(6),o=n(2406),s=i.Collection.extend({model:o,modelId:function(e){return e.id},initialize:function(e,t){},addUploadFiles:function(e){this.add(e,{parse:!0})},getUploadFiles:function(){return this.map((function(e){return e.getUploadFileResponse()}))}});s.build=function(e){return new s(e,{parse:!0})},e.exports=s},function(e,t,n){var i=n(52),o=n(6).Model.extend({initialize:function(e,t){this._response=e},parse:function(e,t){return i.camelizeKeys(e)},getUploadFileResponse:function(){return this._response},getUploadFileName:function(){return this.get("fileName")},getUploadFileSize:function(){return this.get("fileSize")}});e.exports=o},function(e,t,n){var i=n(4),o=n(2408),s=i.CollectionView.extend({tagName:"ul",className:"cFile",attributes:{"data-viewname":"DBandUploadFileListView"},childView:o,childViewOptions:function(){return{bandData:this._bandData}},childViewEvents:{"file:delete":function(e){this.trigger("file:delete",e)}},initialize:function(e){this._bandData=e.bandData}});s.build=function(e){return new s(e)},e.exports=s},function(e,t,n){var i=n(0),o=n(4),s=n(2409),a=n(156),r=o.View.extend({tagName:"li",className:"cFileItem uFlexItem",attributes:{"data-viewname":"DBandUploadFileItemView"},template:i.template(s),ui:{deleteBtn:"._deleteBtn"},events:{"click @ui.deleteBtn":function(){this.trigger("file:delete",this.model)}},initialize:function(e){this._bandData=e.bandData},serializeData:function(){var e=this._bandData.getMembershipMemberProfile(),t=this.model.getUploadFileName(),n=a.getFileType(null,null,t);return{icon:n,svg:"#ico"+n,name:t,size:a.toStringFileSize(this.model.getUploadFileSize()),date:a.formatFileDate(Date.now()),author:e.name}}});e.exports=r},function(e,t){e.exports='<div class="gFileType <%- icon %>">\n    <svg class="svgIcon" aria-hidden="true">\n        <use xlink:href="<%- svg %>"></use>\n    </svg>\n</div>\n<div class="body">\n    <span class="text -ellipsis gFw4"><%- name %></span>\n    <span class="subText -ellipsis"><span class="fileSize"><%- size %></span><span class="creationDate"><%- date %></span><span class="authorName"><%- author %></span></span>\n</div>\n\n<div class="etc">\n    <button class="uButton -iconListRemove _deleteBtn"><span class="gSrOnly"><%- IM(\'ui.label.del\') %></span></button>\n</div>'},function(e,t,n){var i=n(4),o=n(2411),s=i.CollectionView.extend({tagName:"ul",className:"selectFolderList",attributes:{"data-viewname":"DBandUploadFolderListView"},childView:o,childViewEvents:{"folder:select":function(e){this.trigger("folder:select",e)}},initialize:function(e){}});s.build=function(e){return new s(e)},e.exports=s},function(e,t,n){var i=n(0),o=n(4),s=n(2412),a=n(156),r=o.View.extend({tagName:"li",className:"selectFolderItem",attributes:{"data-viewname":"DBandUploadFolderItemView"},template:i.template(s),ui:{folderItemBtn:"._folderItemBtn"},events:{"click @ui.folderItemBtn":function(){this.trigger("folder:select",this.model)}},initialize:function(e){},serializeData:function(){var e=this.model.getFolderLatestFileCreatedAt(),t=this.model.getFolderFileCount();return{name:this.model.getFolderName(),date:e?a.formatFileDate(e):null,count:e?IM("file.folder_file_count",{count:t||"0"}):null}}});e.exports=r},function(e,t){e.exports='<button type="button" class="selectFolderButton _folderItemBtn">\n    <div class="folderIcon">\n        <svg class="svgIcon" aria-hidden="true">\n            <use xlink:href="#ico-folder"></use>\n        </svg>\n    </div>\n    <div class="folderInfo">\n        <span class="folderName -ellipsis"><%- name %></span>\n        <% if (date) { %>\n        <span class="folderStatus"><span class="creationDate"><%- date %></span><span class="files"><%- count %></span></span>\n        <% } %>\n    </div>\n</button>'},function(e,t,n){var i=n(0),o=n(6),s=n(2414),a=o.Collection.extend({model:s,getUploadResultList:function(){var e=this.filter((function(e){return e.hasUploadResult()}));return i.map(e,(function(e){return e.getUploadResult()}))},getLocalFileList:function(){var e=this._getLocalFileModelList();return i.map(e,(function(e){return e.getLocalFile()}))},addUploadResultList:function(e){var t=i.map(e,(function(e){return{uploadResult:e}}));this.add(t)},addLocalFileList:function(e){var t=i.map(e,(function(e){return{localFile:e}}));this.add(t)},_getLocalFileModelList:function(){return this.filter((function(e){return!e.hasUploadResult()}))},putUploadResultList:function(e){var t=i.indexBy(e,"fileId"),n=this._getLocalFileModelList();i.each(n,(function(e){e.setUploadResult(t[e.getLocalFileId()])}))}});a.build=function(){return new a},e.exports=a},function(e,t,n){var i=n(6).Model.extend({initialize:function(e,t){this._uploadResult=e.uploadResult,this._localFile=this._uploadResult?null:e.localFile,this._localFile&&(this._localFile.isVideo=/^video/.test(this._localFile.type),this._localFile.thumbnailMsec=null,this._localFile.isVideo&&(this._localFile.videoWidth=0,this._localFile.videoHeight=0)),this._localFileUrl=null},destroyLocalFileUrl:function(){this._localFileUrl&&(window.URL.revokeObjectURL(this._localFileUrl),this._localFileUrl=null)},_createLocalFileUrl:function(){return this._uploadResult?null:(this._localFileUrl||(this._localFileUrl=window.URL.createObjectURL(this._localFile)),this._localFileUrl)},isGif:function(){return this._uploadResult?this._uploadResult.isGif:"image/gif"===this._localFile.type},isVideo:function(){return this._uploadResult?this._uploadResult.isVideo&&!this._uploadResult.isGifVideo:this._localFile.isVideo},getUploadResultImageUrl:function(){return this._uploadResult?this._uploadResult.url:null},getLocalFileVideoUrl:function(){return this._uploadResult||!this.isVideo()?null:this._createLocalFileUrl()},getLocalFileImageUrl:function(){return this._uploadResult||this.isVideo()?null:this._createLocalFileUrl()},getLocalFile:function(){return this._localFile},getUploadResult:function(){return this._uploadResult},setUploadResult:function(e){this._uploadResult=e},hasUploadResult:function(){return!!this._uploadResult},getLocalFileId:function(){return this._localFile?this._localFile.fileId:null},setLocalVideoWidthHeight:function(e,t){this._localFile&&this._localFile.isVideo&&(this._localFile.videoWidth=e||0,this._localFile.videoHeight=t||0)},setLocalVideoThumbnailMs:function(e){this._localFile&&this._localFile.isVideo&&(this._localFile.thumbnailMsec=e||null)}});e.exports=i},function(e,t,n){var i=n(0),o=n(2),s=n(4),a=n(2416),r=n(2417),l=n(2419),c=n(2424),d=n(2426),u=n(2025),h=n(568),p=n(600),m=n(626),_=n(154),g=n(155),f=n(486),b=n(26),v=s.View.extend({EVENT:{CANCEL:"CANCEL",SUBMIT:"SUBMIT"},tagName:"section",className:"lyWrap",template:i.template(a),attributes:{"data-viewname":"DPhotoUploadLayoutView"},ui:{title:"._title",tip:"._tip",count:"._count",itemList:"._itemList",addBtn:"._addBtn",videoQuality:"._videoQuality",albumBtn:"._albumBtn",albumList:"._albumList",textWarningDesc:"._textWarningDesc",cancelBtn:"._cancelBtn",submitBtn:"._submitBtn"},regions:{count:{el:"@ui.count",replaceElement:!0},itemList:{el:"@ui.itemList",replaceElement:!0},videoQuality:{el:"@ui.videoQuality",replaceElement:!0},albumList:{el:"@ui.albumList",replaceElement:!1}},events:{"click @ui.albumBtn":"_toggleAlbumList","click @ui.cancelBtn":"_cancel","click @ui.submitBtn":"_submit"},initialize:function(e){this._bandNo=e.bandNo,this._skinColor=e.skinColor,this._readPhotographedAt=e.readPhotographedAt,this._countInfo=e.countInfo,this._albumNo=+e.albumNo||h.TOTAL_ALBUM_NO,this._addToAlbum=e.addToAlbum,this._albumCollection=e.albumCollection,this._albumName=this._albumCollection?this._albumCollection.findAlbumName(this._albumNo):null,this._addToAlbum=e.addToAlbum,this._submitBtnText=e.submitBtnText||IM("ui.label.upload"),this._uploadType=e.uploadType,this._uploadResultList=e.uploadResultList,this._localFileList=e.localFileList},serializeData:function(){return{albumSelectable:!!this._albumCollection,albumName:this._albumName||IM("photo.do_not_select_album"),submitBtnText:this._submitBtnText}},onBeforeRender:function(){this._destroyUploader()},onRender:function(){this._createUploader(),this._updateTitle(),this._updateSubmitBtn(),this._renderCountView(),this._renderItemListView(),this._updateAddBtn(),this._renderVideoQualityView(),this._uploader.isVideoUploadMode()&&this.getUI("textWarningDesc").show()},onAttach:function(){this.listenTo(b.getDGlobalChannel(),b.EVENT.HTML_CLICK,(function(e){e&&!m.isContaining([this.ui.albumBtn,this.ui.albumList],e.target)&&this._hideAlbumList()}))},onBeforeDetach:function(){this.stopListening(b.getDGlobalChannel()),this._destroyUploader()},_updateTitle:function(){var e=IM("ui.label.upload_photo"),t=IM("photo.order_draggable");this._uploader.isVideoUploadMode()&&(e=IM("upload_video"),t=IM("video.order_draggable")),this.ui.title.text(e),this.ui.tip.html(t)},_updateSubmitBtn:function(){this.ui.submitBtn.prop("disabled",!this._uploader.hasItem())},_renderCountView:function(){this.showChildView("count",r.build(this._uploader))},_renderItemListView:function(){this.showChildView("itemList",l.build(this._uploader))},_updateAddBtn:function(){var e=this._uploader.canAddItem();this.ui.addBtn.css("display",e?"":"none")},_renderVideoQualityView:function(){this._uploader.canSetVideoQuality()?this._videoQualityView||(this._videoQualityView=c.build(),this.showChildView("videoQuality",this._videoQualityView)):this._videoQualityView&&(this._videoQualityView.destroy(),this._videoQualityView=null)},_toggleAlbumList:function(){this._albumListView?this._hideAlbumList():(this._albumListView=d.buildDAlbumSelectBoxView(this._bandNo,this._albumCollection,this._albumNo),this.listenTo(this._albumListView,"album-select-box:select",(function(e){this._albumNo=e.albumNo,this._albumName=e.albumName,this.ui.albumBtn.text(this._albumName),this._hideAlbumList()})),this.showChildView("albumList",this._albumListView))},_hideAlbumList:function(){this._albumListView&&(this._albumListView.destroy(),this._albumListView=null)},_cancel:function(){this.trigger(this.EVENT.CANCEL),this.destroy()},_submit:function(){var e=!!this._videoQualityView&&this._videoQualityView.isHighQualityChecked();this._uploader.uploadItem({uploadHighQualityVideo:e})},_addToAlbumAndDestroy:function(e){var t=p.addUploadResultListToBandAlbum(this._bandNo,this._albumNo,e);_.wrapActivePromise(t,this).then(i.bind((function(){b.getAlbumChannel().trigger(b.EVENT.ALBUM_PHOTO_ADDED,this._bandNo,this._albumNo),this.destroy()}),this))},_triggerSubmitAndDestroy:function(e){this.trigger(this.EVENT.SUBMIT,{bandNo:this._bandNo,albumNo:this._albumNo,uploadResultList:e}),this.destroy()},_createUploader:function(){this._destroyUploader(),this._uploader=u.create({inputElement:this.ui.addBtn,bandNo:this._bandNo,skinColor:this._skinColor,readPhotographedAt:this._readPhotographedAt,countInfo:this._countInfo,uploadType:this._uploadType,uploadResultList:this._uploadResultList,localFileList:this._localFileList}),this.listenTo(this._uploader,this._uploader.EVENT.UPDATE,(function(){this._updateTitle(),this._updateAddBtn(),this._renderVideoQualityView(),this._updateSubmitBtn()})),this.listenTo(this._uploader,this._uploader.EVENT.UPLOAD,(function(e){var t=e.uploadResultList;this._addToAlbum?this._addToAlbumAndDestroy(t):this._triggerSubmitAndDestroy(t)}))},_destroyUploader:function(){this._uploader&&(this._uploader.destroy(),this._uploader=null)}});v.openLayer=function(e){var t=e.bandNo;return(!1!==e.albumSelectable?function(e){var t=g.get(e);return t.loadBandData().then((function(){if(t.canSelectAlbumWhenUploadMedia())return d.asyncFetchAlbums(e)}))}(t):o.when()).then((function(t){e=i.extend({},e,{albumCollection:t});var n=new v(e);return e.openWithoutHiding?f.openWithoutHiding(n):f.open(n),n}))},e.exports=v},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="header">\n        <h1 class="title _title"></h1>\n    </header>\n    <div class="main -tSpaceNone">\n        <p class="sDesc -bLine -bSpace13 -tSpace15 flexContent">\n            <em class="tip cell">TIP</em>\n            <span class="flexCell _tip"></span>\n        </p>\n\n        <div class="attachPhoto">\n            <div class="_count" style="display:none"></div>\n\n            <div class="imageList">\n                <div class="_itemList" style="display:none"></div>\n                <span class="btnAdd _addBtn"><input type="file"></span>\n            </div>\n\n            <div class="_videoQuality" style="display:none"></div>\n\n            <% if(albumSelectable){ %>\n            <div class="selectAlbum">\n                <p class="labelSelectAlbum"><%- IM(\'photo.select_album\') %></p>\n                <div class="uSelect -h36 -block">\n                    <button type="button" class="select _albumBtn"><%- albumName %></button>\n                </div>\n                <div class="albumMakeWrap _albumList"></div>\n            </div>\n            <% } %>\n\n            <p class="sDesc gMat10 gColorGr2 _textWarningDesc" style="display: none;"><%= IM(\'photo.select_album.desc\') %></p>\n        </div>\n    </div>\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _submitBtn"><%- submitBtnText %></button>\n    </footer>\n</div>\n'},function(e,t,n){var i=n(0),o=n(4),s=n(2418),a=o.View.extend({tagName:"p",className:"total",attributes:{"data-viewname":"DPhotoUploadCountView"},template:i.template(s),initialize:function(e){this._uploader=e.uploader},serializeData:function(){var e=this._getItemList();return{totalCount:i.reduce(e,(function(e,t){return e+t.count}),0)||"0",itemList:e}},onAttach:function(){this.listenTo(this._uploader,this._uploader.EVENT.UPDATE,this.render)},onBeforeDetach:function(){this.stopListening(this._uploader)},_getItemList:function(){return this._uploader.isVideoUploadMode()?[this._getVideoItem()]:[this._getPhotoItem(),this._getGifItem()]},_getVideoItem:function(){return{name:null,count:this._uploader.getVideoCount(),max:this._uploader.getMaxVideoCount()}},_getPhotoItem:function(){return{name:IM("photo"),count:this._uploader.getPhotoCount(),max:this._uploader.getMaxPhotoCount()}},_getGifItem:function(){return{name:"GIF",count:this._uploader.getGifCount(),max:this._uploader.getMaxGifCount()}}});a.build=function(e){return new a({uploader:e})},e.exports=a},function(e,t){e.exports="<span class=\"gSrOnly\"><%- IM('ui.label.total_n', {value: totalCount}) %></span>\n<% _.each(itemList, function(item, index) { %>\n<% if (item.name) { %><span class=\"item\"><%- item.name %></span> <% } %><span class=\"point\"><%- item.count %></span>/<%- item.max %><%- index + 1 < itemList.length ? ',' : '' %>\n<% }); %>"},function(e,t,n){var i=n(4),o=n(2420),s=n(612),a=n(197),r=o.ITEM_CLASS,l=i.CollectionView.extend({tagName:"ul",attributes:{"data-viewname":"DPhotoUploadListView"},reorderOnSort:!0,childView:o,childViewOptions:function(e,t){return{index:t}},childViewEvents:{"upload-item:remove":"_removeItem"},initialize:function(e){this._uploader=e.uploader,this.collection=this._uploader.getCollection()},onBeforeRender:function(){this._destroySortable()},onRender:function(){this._createSortable()},onBeforeDetach:function(){this._destroySortable()},_removeItem:function(e){this._uploader.removeItem(e)},_createSortable:function(){this._sortable=a.create(this.el,{group:"items",sort:!0,animation:150,handle:"."+r.HANDLE,draggable:"."+r.DRAGGABLE,scroll:!0,forceFallback:!0,onEnd:_.bind((function(e){s.changeModelIndex(this.collection,e.oldIndex,e.newIndex)}),this)})},_destroySortable:function(){this._sortable&&(this._sortable.destroy(),this._sortable=null)}});l.build=function(e){return new l({uploader:e})},e.exports=l},function(e,t,n){var i=n(0),o=n(4),s=n(2421),a=n(82),r=n(1012),l=n(2422),c=n(167),d=n(166),u=n(13),h=n(668);n(502);var p={DRAGGABLE:"_itemDraggable",HANDLE:"_itemHandle"},m=o.View.extend({tagName:"li",className:p.DRAGGABLE+" "+p.HANDLE,attributes:{"data-viewname":"DPhotoUploadItemView"},template:i.template(s),ui:{thumbImg:"._thumbImg",localVideo:"._localVideo",localImg:"._localImg",itemDelBtn:"._itemDelBtn",btnChooseThumb:"._btnChooseThumb",videoWrap:"._videoWrap",btnCloseTooltip:"._btnCloseTooltip",tooltipGuide:"._tooltipGuide"},events:{"click @ui.itemDelBtn":function(){this.trigger("upload-item:remove",this.model)},"click @ui.btnChooseThumb":"_openSelectThumbnailView","click @ui.btnCloseTooltip":"_setHideThumbnailTooltip"},initialize:function(e){this._userNo=u.getUserData().getUserNo(),this._currentUserEnvStorage=c.getCurrentUserEnvStorage()},serializeData:function(){return{isGif:this.model.isGif(),isVideo:this.model.isVideo(),thumbImgUrl:a.make(this.model.getUploadResultImageUrl(),a.TYPE.s75),localVideoUrl:this.model.getLocalFileVideoUrl(),canChooseVideoThumbnail:!1,localImgUrl:this.model.getLocalFileImageUrl(),canShowThumbnailTooltip:this._canShowThumbnailTooltip()}},onRender:function(){this._setThumbImgLoading(),this._setLocalVideoStyle(),this._setLocalImgStyle()},onDestroy:function(){this.model.destroyLocalFileUrl()},_canShowThumbnailTooltip:function(){return!1},_setHideThumbnailTooltip:function(){this._currentUserEnvStorage.set([d.VideoThumbnailSelectionGuideClosed,this._userNo],!0),this.getUI("tooltipGuide").remove()},_openSelectThumbnailView:function(){if(this.model.isVideo()&&this.video){var e=l.openAsLayer({videoInfo:this.model.getLocalFile(),videoSrc:this.video.src,selected:this.selectedThumbnail||0});this.listenTo(e,l.EVENT.SET_THUMBNAIL,i.bind((function(e){this.selectedThumbnail=e.index,this.model.setLocalVideoThumbnailMs(e.thumbnailMsec),this.getUI("videoWrap").find(".selectedThumb").remove(),this.getUI("videoWrap").prepend('<div class="selectedThumb" style="background-image:url('+e.src+')" />')}),this))}else h.openSimpleAlert(IM("ui.label.process_failed"))},_setThumbImgLoading:function(){this.ui.thumbImg.setLoading({tag:r.html(r.Size.SMALL,r.MiddleClass.AREA_VERTICAL_MIDDLE),timeout:2e3})},_setLocalVideoStyle:function(){this.ui.localVideo.on("loadeddata",i.bind((function(){this.video=this.ui.localVideo.get(0);var e=this.video.videoWidth||0,t=this.video.videoHeight||0;this.model.setLocalVideoWidthHeight(e,t);var n=this._getLocalFileStyleProps(e,t);this.ui.localVideo.css(n);try{this.video.currentTime=Math.min(this.video.duration,1)}catch(e){}}),this))},_setLocalImgStyle:function(){this.ui.localImg.on("load",i.bind((function(){var e=this.ui.localImg.get(0),t=this._getLocalFileStyleProps(e.naturalWidth,e.naturalHeight);this.ui.localImg.css(t)}),this))},_getLocalFileStyleProps:function(e,t){var n={width:"100%",height:"100%",visibility:"visible"};return e>t?n.width="auto":e<t&&(n.height="auto"),n}});m.ITEM_CLASS=p,e.exports=m},function(e,t){e.exports='<div class="item">\n    <% if (isGif) { %>\n    <span class="gif">GIF</span>\n    <% } else if (isVideo) { %>\n    <span class="movie">Video</span>\n    <% } %>\n\n    <% if (thumbImgUrl) { %>\n    <img src="<%- thumbImgUrl %>" class="_thumbImg" width="80" height="80" style="position:absolute;visibility:hidden;">\n    <% } else if (localVideoUrl || localImgUrl) { %>\n    <div class="videoWrap _videoWrap">\n        <% if (localVideoUrl) { %>\n        <video src="<%- localVideoUrl %>" class="_localVideo" style="visibility:visible"></video>\n        <% } else if (localImgUrl) { %>\n        <img src="<%- localImgUrl %>" class="_localImg" style="visibility:visible">\n        <% } %>\n    </div>\n    <% } %>\n\n    <% if (canChooseVideoThumbnail) { %>\n    <button type="button" class="btnChooseThumb _btnChooseThumb"><span class="gSrOnly"><%= IM(\'photo.upload.select_thunmbnail\') %></span></button>\n    <% } %>\n    <button type="button" class="btnDel _itemDelBtn"><span class="gSrOnly"><%- IM(\'photo.delete_selected_photos\') %></span></button>\n</div>\n\n<% if (canShowThumbnailTooltip) { %>\n<dl class="uHelpGuide -left -close _tooltipGuide" role="alert" aria-live="assertive">\n    <dt><span class="gSrOnly"><%= IM("ui.label.help")%></span></dt>\n    <dd style="width:200px;display:block">\n        <%= IM(\'photo.upload.video_tooltip\') %>\n        <button type="button" class="btnLyClose _btnCloseTooltip"><span class="gSrOnly"><%- IM(\'web.ui.button.label.close\') %></span></button>\n    </dd>\n</dl>\n<% } %>'},function(e,t,n){var i=n(0),o=n(4),s=n(2423),a=n(486),r=n(668),l={SET_THUMBNAIL:"SET_THUMBNAIL"},c=o.View.extend({attributes:{"data-viewname":"DPhotoUploadItemSelectThumbnailView"},template:i.template(s),ui:{thumbList:"._thumbList",btnConfirm:"._btnConfirm",btnCancel:"._btnCancel",mainImage:"._mainImage",btnThumbnail:"._btnThumbnail"},events:{"click @ui.btnConfirm":"_setThumbnail","click @ui.btnThumbnail":"_onClickBtnThumbnail","click @ui.btnCancel":"destroy"},initialize:function(e){this.video=e.video,this.videoSrc=e.videoSrc,this.selected=e.selected,this.thumbnailMsec=0,this.loading=!0},onAttach:function(){this._extractVideoThumbnail()},onDestroy:function(){$(this.video).off("loadedmetadata timeupdate"),this.video=null},_extractVideoThumbnail:function(){$(this.video).on("loadedmetadata",i.bind((function(){$(this.video).on("timeupdate",i.bind((function(){var e=this._getImageFromVideo();this.videoCaptureIndex===this.selected&&this._setMainThumbnail(e,!0),this._appendThumbnails(e,this.videoCaptureIndex),this._increaseCurrentTime()}),this)),this._increaseCurrentTime()}),this)),this.video.src=this.videoSrc,this.video.load()},_appendThumbnails:function(e,t){var n=i.template('<li class="item"><button type="button" class="buttonImage <%= isActive ? \'-active\': \'\' %> _btnThumbnail" data-index="<%= index %>" data-current-time="<%= currentTime %>" style="background-image: url(<%- src %>)"><span class="gSrOnly">Video thumbnail <%= index + 1 %></span><span class="border"></span></button></li>')({isActive:t===this.selected,src:e,index:t,currentTime:this.video.currentTime});this.getUI("thumbList").append(n),4===t&&this.getUI("btnConfirm").attr("disabled",!1)},_setMainThumbnail:function(e,t){var n=this.video.videoHeight>this.video.videoWidth,o=i.template('<% if(isVerticalType) { %><img src="<%- src %>" alt="" class="img -blur"><% } %><img src="<%- src %>" alt="Video thumbnail" class="img">')({isVerticalType:n,src:e});t&&this.getUI("mainImage").addClass((function(){return n?"-vertical":"-horizontal"})),this.getUI("mainImage").empty().append(o)},_onClickBtnThumbnail:function(e){var t=$(e.currentTarget),n=this._getDataImgUrl(t);this._setMainThumbnail(n,!1),this._setThumbnailMs(t.data("currentTime"),t.data("index")),this.getUI("thumbList").find(".-active").removeClass("-active"),t.addClass("-active")},_setThumbnailMs:function(e){this.thumbnailMsec=parseInt(1e3*e)},_getDataImgUrl:function(e){return e.css("backgroundImage").replace(/^url\("|"\)$/g,"")},_getImageFromVideo:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.height=this.video.videoHeight,e.width=this.video.videoWidth,t.drawImage(this.video,0,0,e.width,e.height),e.toDataURL("image/jpeg",1)},_increaseCurrentTime:function(){i.isUndefined(this.videoCaptureIndex)?this.videoCaptureIndex=0:this.videoCaptureIndex++,this.videoCaptureIndex>4||(0!==this.videoCaptureIndex?4!==this.videoCaptureIndex?this.video.currentTime=this.video.duration*(this.videoCaptureIndex/4):this.video.currentTime=this.video.duration*(this.videoCaptureIndex/4)-Math.min(this.video.duration,1):this.video.currentTime=.1)},_setThumbnail:function(){var e=this.getUI("thumbList").find(".-active");this.trigger(l.SET_THUMBNAIL,{index:e.data("index"),src:this._getDataImgUrl(e),thumbnailMsec:this.thumbnailMsec}),this.destroy()}});c.openAsLayer=function(e){var t=document.createElement("video"),n=e.videoInfo,i=n.videoWidth,o=n.videoHeight;if("probably"===t.canPlayType(n.type)||0!==i&&0!==o){var s=new c({video:t,videoSrc:e.videoSrc,selected:e.selected});return a.openWithoutHiding(s),s}r.openSimpleAlert(IM("ui.label.process_failed"))},c.EVENT=l,e.exports=c},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent -w480">\n        <header class="header">\n            <h1 class="title"><%- IM(\'photo.upload.select_thunmbnail\') %></h1>\n        </header>\n\n        <div class="modalBody">\n            <div class="modalContentWrap -tSpaceNone">\n                <div class="mediaThumbnail">\n                    <div class="mainImage -horizontal _mainImage">\n                        <p class="uLoading"><img src="<%-resBaseUrl%>/images/common/loading.gif" width="32" height="32" alt="loading..."></p>\n                    </div>\n                </div>\n                <div class="selectImageMedia">\n                    <h2 class="title"><%= IM(\'video.upload.representative_thumbnails\') %></h2>\n                    <ul class="timeLineImage _thumbList"></ul>\n                </div>\n            </div>\n        </div>\n\n        <footer class="modalFooter -tLine">\n            <button type="button" class="uButton -confirm -sizeL _btnConfirm" disabled><%= IM(\'ui.label.confirm\') %></button>\n            <button type="button" class="uButton -iconClose btnLyClose _btnCancel"><span class="gSrOnly"><%- IM(\'ui.label.close\') %></span></button>\n        </footer>\n    </div>\n</section>'},function(e,t,n){var i=n(0),o=n(4),s=n(2425),a=o.View.extend({tagName:"div",className:"uploadOption flexList",attributes:{"data-viewname":"DPhotoUploadVideoQualityView"},template:i.template(s),ui:{checkbox:"._checkbox"},events:{"change @ui.checkbox":"_onChangeCheckbox"},serializeData:function(){return{viewId:this.cid}},isHighQualityChecked:function(){return this.ui.checkbox.prop("checked")}});a.build=function(){return new a},e.exports=a},function(e,t){e.exports='<div class="text">\n    <label for="checkbox_<%- viewId %>" class="labelTitle gFs13"><%- IM(\'upload.video_quality_name\') %></label>\n    <p class="labelDesc gFs12 gColorBk4 gMat3"><%- IM(\'upload.video_quality_desc\') %></p>\n</div>\n<div class="etc">\n    <label for="checkbox_<%- viewId %>" class="uCheck -switch ">\n        <input type="checkbox" id="checkbox_<%- viewId %>" class="checkInput _checkbox">\n        <span class="checkLabel">\n    <span class="shape"></span>\n    <span class="text"></span>\n</span>\n    </label>\n</div>'},function(e,t,n){var i,o;i=[n(0),n(2),n(6),n(4),n(2427),n(595),n(568),n(154)],void 0===(o=function(e,t,n,i,o,s,a,r){var l=i.View.extend({template:e.template(o),className:"albumMake",attributes:{"data-type":"make","data-viewname":"DAlbumSelectBoxView"},ui:{selectBox:"[data-uiselector=selectBox]",addAlbum:"[data-uiselector=addAlbum]",addAlbumInput:"[data-uiselector=addAlbumInput]"},events:{"click @ui.selectBox li":function(e){var n=t(e.target),i=n.text();this._initAlbumNo=n.data("value"),this._triggerSelectAlbum(this._initAlbumNo,i)},"keydown @ui.addAlbumInput":"_checkInputBox","keyup @ui.addAlbumInput":"_checkInputBox","cut @ui.addAlbumInput":"_checkInputBox","paste @ui.addAlbumInput":"_checkInputBox","change @ui.addAlbumInput":"_checkInputBox","click @ui.addAlbumInput":function(){this.ui.addAlbumInput.focus()},"click @ui.addAlbum":function(){this._createAlbum()}},initialize:function(e){this._bandNo=e.bandNo,this.collection=e.collection,this._initAlbumNo=e.initAlbumNo},serializeData:function(){return{items:this.collection.toJSON(),initAlbumNo:this._initAlbumNo,selectBoxId:this.cid}},_checkInputBox:function(){this.ui.addAlbumInput.val().length>a.MAX_ALBUM_NAME_LENGTH&&this.ui.addAlbumInput.val(this.ui.addAlbumInput.val().substring(0,a.MAX_ALBUM_NAME_LENGTH)),this._checkButtonHighlight()},_checkButtonHighlight:function(){t.trim(this.ui.addAlbumInput.val()).length>0?this.ui.addAlbum.addClass("-active"):this.ui.addAlbum.removeClass("-active")},_createAlbum:function(){var n=t.trim(this.ui.addAlbumInput.val());n.length<=0||s.createPhotoAlbum(this._bandNo,n,!1).then(e.bind((function(t){r.wrapActivePromise(l.asyncFetchAlbums(this._bandNo),this).then(e.bind((function(e){this.collection.reset(e.models),this._initAlbumNo=t.photo_album.no,this._triggerSelectAlbum(this._initAlbumNo,n)}),this))}),this))},_triggerSelectAlbum:function(e,t){this.trigger("album-select-box:select",{albumNo:e,albumName:t})}}),c=n.Model.extend({getUpdatedAt:function(){return this.get("updated_at")},isUnspecified:function(){return 1==this.get("unspecified")},isPhotoAttached:function(){return this.get("covers")&&this.get("covers").length>0}}),d=n.Collection.extend({model:c,comparator:function(e){var t=e.getUpdatedAt();if(e.isUnspecified()&&(t=(new Date).getTime()+10),!e.isPhotoAttached()){var n=new Date(t);n.setDate(n.getDate()-36500),t=n.getTime()}return-1*t},findAlbumName:function(e){var t=this.findWhere({no:e});return t?t.get("name"):null}});return l.asyncFetchAlbums=function(e){var t={band_no:e,album_cover_count:1,album_count:999999};return s.getPhotoAlbums(t).then((function(e){return new d(e.photo_albums)}))},l.buildDAlbumSelectBoxView=function(e,t,n){return new l({bandNo:e,collection:t,initAlbumNo:n})},l}.apply(t,i))||(e.exports=o)},function(e,t){e.exports='<div class="make flexList -tbSpaceNone">\n    <div class="text">\n        <div class="uInput">\n            <input type="text" data-uiselector="addAlbumInput" placeholder="<%- IM(\'web.postwrite.album.label.create_album\') %>">\n            <span class="border"></span>\n        </div>\n    </div>\n\n    <div class="etc gPal15">\n        <button type="button" data-uiselector="addAlbum" class="uButton -sizeS -default"><%- IM("web.postdetail.btn.add") %></button>\n    </div>\n</div>\n<ul id="<%= selectBoxId %>" class="list" data-uiselector="selectBox">\n    <li><button type="button" data-value="0" <% if (0 == initAlbumNo) {%>class="selected"<% } %> ><%= IM(\'photo.do_not_select_album\') %></button></li>\n    <%\n    _.each(items, function(eachAlbum) {\n    %>\n    <li><button type="button" data-value="<%= eachAlbum.no %>" <% if (eachAlbum.no == initAlbumNo) {%>class="selected"<% } %> ><%- eachAlbum.name %></button></li>\n    <%\n    });\n    %>\n</ul>'},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title"><%= title %></h1>\n    </header>\n\n    <div class="modalBody">\n        <% if (bandGuideMessage) { %>\n        <p class="sDesc gFs14 gMat18 gPab18 gMar20 gMal20 -bLine"><%= bandGuideMessage %></p>\n        <% } %>\n\n        <div class="serviceSelectListWrap _pageBandListWrap" style="display:none">\n            <% if (showSubTitle) { %>\n            <h2 class="subTitle gMat-1"><%= IM(\'pageband.page\') %></h2>\n            <% } %>\n            <div class="modalContentWrap -tSpaceNone <%= groupBandCount > 0 ? \'-mH220\' : \'-mH365\' %>">\n                <div class="_pageBandListRegion"></div>\n            </div>\n        </div>\n        <div class="serviceSelectListWrap _groupBandListWrap" style="display:none">\n            <% if (showSubTitle) { %>\n            <h2 class="subTitle gMat-1"><%= IM(\'web.noui.band.title.band\') %></h2>\n            <% } %>\n\n            <div class="modalContentWrap -tSpaceNone <%= pageBandCount > 0 ? \'-mH220\' : \'-mH365\' %>">\n                <div class="_groupBandListRegion"></div>\n            </div>\n        </div>\n\n        <div class="_emptyViewRegion"></div>\n    </div>\n\n    <footer class="footer -tLine">\n        <% if(isSingleSelect) { %>\n        <button type="button" class="uButton -confirm _btnClose"><%- confirmText %></button>\n        <% } else { %>\n        <button type="button" class="uButton -cancel _btnClose"><%-IM(\'web.modal.btn.cancel\')%></button>\n        <button type="button" class="uButton -confirm _btnConfirm" disabled><%- confirmText %><em class="_countSelectedBand"></em></button>\n        <% } %>\n    </footer>\n</div>'},function(e,t){e.exports='<a href="#" class="flexList _btnBandSelect" role="button">\n<% if(type == \'page\') { %>\n    <div class="thum">\n        <span class="uProfile -size36 -border -pageProfile">\n            <span class="profileInner"><% if (!!coverThumbUrl) { %><img class="_imgCover" src="<%- coverThumbUrl %>" alt="<%- name %>"><% } %></span>\n        </span>\n    </div>\n<% } else { %>\n    <div class="thum">\n        <div class="uCoverImage -w36 -border">\n            <span class="coverInner">\n                 <% if (!!coverThumbUrl) { %>\n                <img class="_imgCover" src="<%- coverThumbUrl %>" alt="<%- name %>">\n                <% } %>\n            </span>\n        </div>\n    </div>\n<% } %>\n    <span class="text -ellipsis"><%- name %></span>\n    <span class="etc -arrow"> </span>\n</a>'},function(e,t){e.exports='<label class="flexList">\n<% if(type == \'page\') { %>\n    <div class="thum">\n        <span class="uProfile -size36 -border -pageProfile">\n            <span class="profileInner"><% if (coverThumbUrl) { %><img src="<%- coverThumbUrl %>" class="_imgCover" alt="<%- name %>"><% } %></span>\n        </span>\n    </div>\n\n<% } else { %>\n    <div class="thum">\n        <div class="uCoverImage -w36 -border">\n            <span class="coverInner">\n                <% if (!!coverThumbUrl) { %>\n                <img src="<%- coverThumbUrl %>" class="_imgCover" alt="<%- name %>">\n                <% } %>\n            </span>\n        </div>\n    </div>\n<% } %>\n    <span class="text -ellipsis"><%- name %></span>\n    <span class="etc">\n        <span for="band_check_<%- bandNo %>" class="uCheck -checkbox">\n            <input type="checkbox" id="band_check_<%- bandNo %>" class="checkInput _checkboxBandSelect" <%=(selected ? \'checked\' : \'\') %>>\n            <span class="checkLabel"><span class="shape"></span></span>\n        </span>\n    </span>\n</label>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(52),s=n(4),a=n(2432),r=n(2026),l=n(546),c=n(486),d=n(22),u=n(1039),h=n(83),p="GROUP_BAND",m="PAGE_BAND";var _=s.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DTabSeperatedBandSelectView"},template:t.template(a),templateContext:function(){return{title:this._title||IM("web.inviteband.btn.choice_band"),pageBandCount:this._pageBandListCollection.length,groupBandCount:this._groupBandListCollection.length,isNoSelectableBand:this._pageBandListCollection.isEmpty()&&this._groupBandListCollection.isEmpty(),showTabMenu:!this._pageBandListCollection.isEmpty()&&!this._groupBandListCollection.isEmpty()}},ui:{bandListWrap:"._bandListWrap",bandListRegion:"._bandListRegion",tabs:"._tabs",btnTabGroupBand:"._btnTabGroupBand",btnTabPageBand:"._btnTabPageBand",btnClose:"._btnClose",btnConfirm:"._btnConfirm"},regions:{bandListRegion:{el:"@ui.bandListRegion",replaceElement:!0}},events:{"click @ui.btnClose":"destroy","click @ui.btnConfirm":function(e){var t=this._selectedBandCollection.map((function(e){return e.pick("bandNo","name","cover","type","currentUserPostingPermitted")}));this.trigger("multipleBand:selected",t),this.destroy()},"click @ui.btnTabGroupBand":function(){this._contentsViewType=p,this._refreshContents()},"click @ui.btnTabPageBand":function(){this._contentsViewType=m,this._refreshContents()}},childViewEvents:{"multipleBand:selected":function(e){this._selectedBandCollection.add(e),this._changeConfirmButtonState()},"multipleBand:deselected":function(e){this._selectedBandCollection.remove(e),this._changeConfirmButtonState()}},initialize:function(e){this._title=e.title,this._bandTypes=e.bandTypes,this._pageBandListCollection=new Backbone.Collection([]),this._groupBandListCollection=new Backbone.Collection([]),this._selectedBandCollection=new Backbone.Collection([]),this._contentsViewType="",e.excludedBandNos=t.map(e.excludedBandNos||[],(function(e){return Number(e)})),e.groupBandFilters=e.groupBandFilters||[],e.pageBandFilters=e.pageBandFilters||[],i.when(this._fetchGroupBandListCollection(e.excludedBandNos,e.groupBandFilters),this._fetchPageBandListCollection(e.excludedBandNos,e.pageBandFilters)).then(t.bind((function(){this._groupBandListCollection.length>0?this._contentsViewType=p:this._contentsViewType=m,this.render()}),this))},onRender:function(){this._showBandList()},_refreshContents:function(){this._selectedBandCollection.length>0&&alert(IM("alert.bandlist.cancel_selection")),this._selectedBandCollection.reset(),this.getRegion("bandListRegion").empty(),this._groupBandListCollection.each((function(e){e.set("selected",!1)})),this._pageBandListCollection.each((function(e){e.set("selected",!1)})),this._changeConfirmButtonState(),this._refreshTabClass(),this._showBandList()},_refreshTabClass:function(){this.getUI("tabs").removeClass("-on"),this._contentsViewType===p?this.getUI("btnTabGroupBand").parent().addClass("-on"):this.getUI("btnTabPageBand").parent().addClass("-on")},_showBandList:function(){var e,t=this.getRegion("bandListRegion");this._pageBandListCollection.isEmpty()&&this._groupBandListCollection.isEmpty()||(this._contentsViewType===p?(this._groupBandListCollection.each((function(e){e.set("type",d.BAND_TYPE.GROUP)})),e=this._groupBandListCollection):e=this._pageBandListCollection,t.show(r.build({selectionType:"MULTIPLE_SELECT",collection:e})))},_fetchPageBandListCollection:function(e,n){if(!t.contains(this._bandTypes,d.BAND_TYPE.PAGE))return i.Deferred().resolve();var s=[u.BAND_FIELD.BAND.BAND_NO,u.BAND_FIELD.BAND.TYPE,u.BAND_FIELD.BAND.PROFILE_IMAGE,u.BAND_FIELD.BAND.NAME];return h.getBandListWithFilter(n,s).then(t.bind((function(n){n=t.chain(o.camelizeKeys(n||[])).filter((function(n){return!t.contains(e,n.band.bandNo)})).pluck("band").value(),this._pageBandListCollection=new Backbone.Collection(n)}),this))},_fetchGroupBandListCollection:function(e,n){if(!t.contains(this._bandTypes,d.BAND_TYPE.GROUP))return i.Deferred().resolve();var o=[u.BAND_FIELD.BAND.BAND_NO,u.BAND_FIELD.BAND.TYPE,u.BAND_FIELD.BAND.COVER,u.BAND_FIELD.BAND.NAME,u.BAND_FIELD.MEMBER.PERMITTED_OPERATION.POSTING];return l.build(n,o,e).fetchBandWithFilterDataCollection().then(t.bind((function(e){this._groupBandListCollection=e}),this))},_changeConfirmButtonState:function(){this._selectedBandCollection.isEmpty()?this.getUI("btnConfirm").prop("disabled",!0):this.getUI("btnConfirm").prop("disabled",!1)}});return _.openLayer=function(e){var t=new _({title:e.title,excludedBandNos:e.excludedBandNos,bandTypes:e.bandTypes,groupBandFilters:e.groupBandFilters,pageBandFilters:e.pageBandFilters});return e.withoutHiding?c.openWithoutHiding(t):c.open(t),t},_}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title"><%= title %></h1>\n    </header>\n\n    <div class="modalBody">\n        <% if(showTabMenu){ %>\n        <div class="tab columnFixed gMab-1">\n            <span class="cell sf_color -on _tabs"><button type="button" class="_btnTabGroupBand"><%- IM(\'web.noui.band.title.band\') %><span class="gPal4  sf_color "></span></button></span>\n            <span class="cell sf_color _tabs"><button type="button" class="_btnTabPageBand"><%- IM(\'pageband.page\') %><span class="gPal4 sf_color "></span></button></span>\n        </div>\n        <% } %>\n        <div class="serviceSelectListWrap _bandListWrap">\n            <div class="modalContentWrap -tSpaceNone <%= pageBandCount > 0 ? \'-mH220\' : \'-mH365\' %>">\n                <div class="_bandListRegion"></div>\n            </div>\n        </div>\n        <% if (isNoSelectableBand) { %>\n        <p class="uEmpty -h480"><span><%= IM("discover.search.txt.no_band") %></span></p>\n        <% } %>\n    </div>\n\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -cancel _btnClose"><%-IM(\'web.modal.btn.cancel\')%></button>\n        <button type="button" class="uButton -confirm _btnConfirm" disabled><%-IM(\'web.bandselection.btn.submit\')%></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(0),o=n(4),s=n(16),a=n(2434),r=n(486),l=n(2435),c=n(2436),d=n(153),u=n(1126),h=n(9),p=n(156),m=n(495),_=n(487);n(1095);var g=o.View.extend({attributes:{"data-viewname":"DMissionConfirmCelebrationLayerView"},className:"lyWrap lyMissionCompleteWrap",template:i.template(a),templateContext:function(){var e=this.options.bandMissionModel,t=c.get(e,this.options.bandMissionConfirmSummaryModel),n=this.options.bandData,i=e.get("title");return{titleText:t.confirmDayText,bandName:n.getBandCore().name,missionName:i,missionText:h.isKoreaCountryCode()?"MISSION":"Progress update",isMissionEndDay:e.isMissionEndDay(),missionNameFontSizeClass:this._getMissionNameFontSizeClass(i),confirmDayFontSizeClass:this._getConfirmDayFontSizeClass(t.confirmDayText)}},behaviors:[_,{behaviorClass:m,sceneId:m.SCENE.MISSION_CONFIRM_POST_COMPLETE}],ui:{animation:"._animation",btnClose:"._btnClose",btnViewMyStatus:"._btnViewMyStatus",btnDownloadImg:"._btnDownloadImg",captureArea:"._captureArea",missionName:"._missionName",bandName:"._bandName",missionState:"._missionState"},events:{"click @ui.btnClose":"destroy","click @ui.btnViewMyStatus":"_goMissionMyStatus","click @ui.btnDownloadImg":"_saveAsImageFile"},regions:{animation:{el:"@ui.animation",replaceElement:!0}},initialize:function(e){this._bandMissionModel=e.bandMissionModel,this._bandMissionConfirmSummaryModel=e.bandMissionConfirmSummaryModel,this._bandData=e.bandData,this._bandNo=this._bandData.getBandCore().bandNo},onDomRefresh:function(){var e=c.get(this._bandMissionModel,this._bandMissionConfirmSummaryModel);this.showChildView("animation",l.buildLottieAnimationView({animationUrl:e.animationUrl,altImageUrl:e.animationAltImageUrl,altText:e.animationAltImageText}))},onAttach:function(){this.jplSceneEnter(_.CLASSIFIER.MISSION_CONFIRM_POST_COMPLETE,{band_no:this._bandNo}),this._txtTruncate()},_txtTruncate:function(){var e=this.getUI("missionName").height(),t=this.getUI("missionState").height(),n=this.getUI("bandName").height();this.getUI("missionName").removeClass("-ellipsis"),this.getUI("missionState").removeClass("-ellipsis"),setTimeout(i.bind((function(){this.getUI("missionName").dotdotdot({ellipsis:"...",wrap:"letter",height:e+5}),this.getUI("missionState").dotdotdot({ellipsis:"...",wrap:"letter",height:t+25}),this.getUI("bandName").dotdotdot({ellipsis:"...",wrap:"letter",height:n})}),this),0)},_getMissionNameFontSizeClass:function(e){return e.length<18?"":"gFs14"},_getConfirmDayFontSizeClass:function(e){var t=$(e).text().length;return this._bandMissionModel.isMissionEndDay()?t>=10?"-fs20":"":t>=9?"-fs40":t>=7?"-fs52":""},_goMissionMyStatus:function(){var e={band_no:this._bandNo,mission_id:this._bandMissionModel.getMissionId()};d.GROUP_BAND_MISSION_MY_STATUS.goDForced(e)},_saveAsImageFile:function(){this.jplClick(_.CLASSIFIER.SAVE_MISSION_RECORD_IMAGE,{band_no:this._bandNo,location:"top"}),this._renderImageCaptureLoadingView();var e=this.getUI("captureArea").get(0),t={width:e.offsetWidth,height:e.offsetHeight,useCORS:!0,logging:!1,scale:1,scrollX:0,scrollY:0,backgroundColor:null};u(e,t).then(i.bind((function(e){var t=e.toDataURL("image/png",1),n=h.format.date(s(),"short_noweekday").replace(/[^0-9]/g,""),o=[this._bandData.getBandCore().name,IM("mission.confirm_celebration.save_filename"),n].join("_");p.saveAs(t,o,"png").then(i.bind((function(){this._renderImageCaptureLoadingView(!0)}),this))}),this))},_renderImageCaptureLoadingView:function(e){this._imageUploadLoadingView&&this._imageUploadLoadingView.destroy(),e||(this._imageUploadLoadingView=new o.View({template:i.template('<div class="lyWrap"><div class="lyContent -bgTransparency -noBorder"><div class="modalBody"><p class="uLoading"><img src="'+window.resBaseUrl+'/images/common/loading.gif" width="32" height="32" alt="loading"></p></div></div></div>')}),r.openWithoutHiding(this._imageUploadLoadingView))}});g.openDMissionConfirmCelebrationLayer=function(e,t,n){var i=new g({bandMissionModel:e,bandMissionConfirmSummaryModel:t,bandData:n});return r.openWithoutHiding(i),i},e.exports=g},function(e,t){e.exports='\x3c!-- [D] 해더 푸터 고정 -fixed 클래스 추가 --\x3e\n<div class="lyContent -w340">\n    <header class="modalHeader -noTitlebar gTaC">\n        <h1 class="title"><%- IM(\'mission.confirm_celebration.modal_title\') %></h1>\n    </header>\n\n    <div class="modalBody -spaceNone">\n        <div class="missionCompleteMessage gTaC">\n            <div class="missionShareBox _captureArea">\n                <div class="missionShareInfo <%= isMissionEndDay ? \'-finished\' : \'\' %>">\n                    <div class="missionShareName">\n                        <em class="missionLogo"><%- missionText %></em>\n                        <span class="missionName -ellipsis <%- missionNameFontSizeClass %> _missionName"><%- missionName %></span>\n                    </div>\n                    <div class="missionState -ellipsis sf_color <%- confirmDayFontSizeClass %> _missionState"><%= titleText %></div>\n\n                    <div class="iconAnimationBox">\n                        <% if (isMissionEndDay) { %>\n                        <div class="iconTrophy"></div>\n                        <% } %>\n\n                        <div class="iconAnimation _animation"></div>\n                    </div>\n                </div>\n                <div class="groupBandName">\n                    <span class="bandLogo"><span class="gSrOnly">BAND</span></span>\n                    <span class="bandName _bandName"><%- bandName %></span>\n                </div>\n            </div>\n            <div class="missionShareDesc"><%= IM(\'mission.confirm_celebration.img_download_desc\') %></div>\n        </div>\n    </div>\n\n    <footer class="modalFooter gPab20">\n        <span class="buttonWrap">\n            <button type="button" class="uButton -confirm gMab5 _btnViewMyStatus" style="min-width:112px"><%-IM("mission.view_my_status_calendar") %></button>\n            <button type="button" class="uButton -confirm gMab5 _btnDownloadImg" style="min-width:112px"><%-IM("ui.label.save_as_image") %></button>\n        </span>\n        <button type="button" class="uButton -iconClose btnLyClose _btnClose"><%-IM("ui.label.close") %></button>\n    </footer>\n</div>\n'},function(e,t,n){var i=n(0),o=n(4),s=n(2027),a=o.View.extend({options:{altImageUrl:"",altText:"",animationUrl:""},attributes:{"data-viewname":"LottieAnimationView"},className:"iconAnimation",initialize:function(){this._animation=void 0},getTemplate:function(){return s.lottie?i.constant(""):this.options.altImageUrl?i.template('<img src="<%=altImageUrl %>">'):i.template("")},templateContext:function(){return{altImageUrl:this.options.altImageUrl}},onBeforeRender:function(){this._destroyRunningAnimation()},onRender:function(){s.lottie&&(this._animation=s.lottie.loadAnimation({container:this.el,renderer:"svg",loop:!1,autoplay:!0,path:this.options.animationUrl}))},onAttach:function(){s.lottie||s.loadLottie().then(i.bind((function(){this.render()}),this))},onBeforeDetach:function(){this._destroyRunningAnimation()},_destroyRunningAnimation:function(){this._animation&&(this._animation.destroy(),this._animation=void 0)}});a.buildLottieAnimationView=function(e){return new a(e)},e.exports=a},function(e,t){var n=["&#128077;","&#128076;","&#128079;","&#127881;","&#127919;","&#128467;","&#127882;","&#128293;","&#128588;","&#127941;","&#128578;","&#128512;","&#128516;"];t.get=function(e,t){return e.isMissionEndDay()?{confirmDayText:IM("band_mission.confirm_celebration.last_confirmed_day_text",{dayCount:t.getBandMissionConfirmSummaryConfirmCount()+1}),animationUrl:window.resBaseUrl+"/images/animation/mission_animation_trophy_firecracker.json",animationAltImageUrl:window.resBaseUrl+"/images/template/mission_animation_trophy.png",animationAltImageText:IM("band_mission.confirm_celebration.last_confirm.image_alt_text")}:{confirmDayText:IM("band_mission.confirm_celebration.ongoing_confirm_day_text",{dayCount:t.getBandMissionConfirmSummaryConfirmCount()+1,emoji:_.sample(n)}),animationUrl:window.resBaseUrl+"/images/animation/mission_animation_firecracker.json",animationAltImageUrl:"",animationAltImageText:IM("band_mission.confirm_celebration.ongoing_confirm.image_alt_text")}}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(493),s=n(486),a=n(2438),r=i.View.extend({attributes:{"data-viewname":"DPostDeleteWithReportView"},template:t.template(a),ui:{checkDeletePost:"._checkDeletePost",checkMemberWithdrawalAndBlock:"._checkMemberWithdrawalAndBlock",btnCancel:"._btnCancel",btnConfirm:"._btnConfirm"},events:{"click @ui.checkDeletePost":"_setActiveButtonStyle","click @ui.checkMemberWithdrawalAndBlock":"_setActiveButtonStyle","click @ui.btnConfirm":"_confirmPostDeleteAndMemberWithdrawal","click @ui.btnCancel":"destroy"},initialize:function(e){this.bandNo=e.bandNo,this.userNo=e.userNo,this.canDelete=e.canDelete,this.canBanMember=e.canBanMember},serializeData:function(){return{canDelete:this.canDelete,canBanMember:this.canBanMember}},onAttach:function(){this._setActiveButtonStyle()},onBeforeDetach:function(){this.trigger("DPostDeleteWithReportView:postReported")},_setActiveButtonStyle:function(){this.ui.checkDeletePost.is(":checked")||this.ui.checkMemberWithdrawalAndBlock.is(":checked")?this.ui.btnConfirm.removeClass("-disabled").prop("disabled",!1):this.ui.btnConfirm.addClass("-disabled").prop("disabled",!0)},_confirmPostDeleteAndMemberWithdrawal:function(){if(!this.ui.checkDeletePost.is(":checked")&&!this.ui.checkMemberWithdrawalAndBlock.is(":checked"))return this.destroy(),!1;if(this.ui.checkMemberWithdrawalAndBlock.is(":checked")){o.doWithdrawBandMember(this.bandNo,this.userNo,!0)}this.ui.checkDeletePost.is(":checked")&&this.trigger("postItem:postDelete"),this.destroy()}});return r.buildAsLayer=function(e){var t=new r({bandNo:e.bandNo,userNo:e.userNo,canDelete:e.canDelete,canBanMember:e.canBanMember});return s.open(t),t},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent -w360">\n        <header class="header -noTitlebar">\n            <h1 class="title"><%= IM("bandsetting.member_withdrawal.txt.description.done_report") %></h1>\n        </header>\n        <div class="main">\n            <p class="p"><%= IM("bandsetting.member_withdrawal.txt.description.done_report2").replace("<br>", " ") %></p>\n            <ul class="selectArea">\n                <% if (canDelete) { %>\n                <li>\n                    <label for="checkbox1" class="uCheck -checkbox">\n                        <input type="checkbox" id="checkbox1" class="checkInput _checkDeletePost" checked>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%= IM("web.postdetail.txt.post_delete") %></span>\n                        </span>\n                    </label>\n                </li>\n                <% } %>\n                <% if (canBanMember) { %>\n                <li>\n                    <label for="checkbox2" class="uCheck -checkbox">\n                        <input type="checkbox" id="checkbox2" class="checkInput _checkMemberWithdrawalAndBlock">\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%= IM("bandsetting.member_withdrawal.label.compulsory_withdrawal_and_block") %></span>\n                        </span>\n                    </label>\n                </li>\n                <% } %>\n            </ul>\n        </div>\n        <footer class="footer">\n            <button type="button" class="uButton -cancel _btnCancel"><%= IM("ui.label.cancel") %></button>\n            <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n        </footer>\n    </div>\n</section>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(486),s=n(2440),a=i.View.extend({attributes:{"data-viewname":"DPostDeleteOptionView"},template:t.template(s),ui:{panelPostDelete:"._panelPostDelete",checkPostDelete:"._checkPostDelete",btnCancel:"._btnCancel",btnConfirm:"._btnConfirm"},events:{"click @ui.checkPostDelete":"_setActiveButtonStyle","click @ui.btnConfirm":"_confirmReport","click @ui.btnCancel":"destroy"},initialize:function(e){this.bandNo=e.bandNo,this.postNo=e.postNo,this.canDelete=e.canDelete,this.canReport=e.canReport},serializeData:function(){return{canDelete:this.canDelete,canReport:this.canReport}},onAttach:function(){this._setActiveButtonStyle()},_setActiveButtonStyle:function(){this.ui.btnConfirm.removeClass("-disabled").prop("disabled",!1)},_confirmReport:function(){var e=this.canDelete&&!this.canReport?"postDelete":this.ui.checkPostDelete.filter(":checked").val();return"postDelete"==e?this.trigger("postItem:postDelete"):"postDeleteWithReport"==e&&this.trigger("postItem:postDeleteWithReport"),!1}});return a.buildAsLayer=function(e){var t=new a({bandNo:e.bandNo,postNo:e.postNo,canDelete:e.canDelete,canReport:e.canReport});return o.open(t),t},a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<section class="lyWrap ">\n    <div class="lyContent -w360">\n        <header class="header -noTitlebar">\n            <h1 class="title"><%= IM("web.postdetail.confirm.delete_post") %></h1>\n        </header>\n        <% if (canReport) { %>\n        <div class="main">\n            <ul class="selectArea">\n                <% if (canReport && canDelete) { %>\n                <li>\n                    <label for="radio1" class="uCheck -radio _panelPostDelete">\n                        <input type="radio" id="radio1" name="radio" class="checkInput _checkPostDelete" value="postDelete" checked>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%= IM("web.postdetail.menu.delete_post") %></span>\n                        </span>\n                    </label>\n                </li>\n                <% } %>\n                <% if (canReport) { %>\n                <li>\n                    <label for="radio2" class="uCheck -radio">\n                        <input type="radio" id="radio2" name="radio" class="checkInput _checkPostDelete" value="postDeleteWithReport" <% if (!canDelete) { %> checked<% } %>>\n                        <span class="checkLabel">\n                            <span class="shape"></span>\n                            <span class="text"><%= IM("web.postdetail.txt.delete_with_report") %></span>\n                        </span>\n                    </label>\n                </li>\n                <% } %>\n            </ul>\n        </div>\n        <% } %>\n        <footer class="footer">\n            <button type="button" class="uButton -cancel _btnCancel"><%= IM("ui.label.cancel") %></button>\n            <button type="button" class="uButton -confirm _btnConfirm -disabled"><%= IM("ui.label.confirm") %></button>\n        </footer>\n    </div>\n</section>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2442),s=n(153),a=n(180),r=n(162),l=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DPostDetailUrlView"},template:t.template(o),templateContext:function(){var e="";return e=this.options.postNo?this.options.bandCore.makeBandRouteUrl(s.GROUP_BAND_POST_DETAIL,r.PAGE_BAND_POST_DETAIL,{band_no:this.options.bandCore.bandNo,post_no:this.options.postNo}):r.PAGE_BAND_HOME.makeUrl({band_no:this.options.bandCore.bandNo}),{msg_postDetailUrl:location.protocol+"//"+location.hostname+e}},ui:{btnCopyUrl:"._btnCopyUrl",btnClose:"._btnClose"},events:{"click @ui.btnClose":"destroy"},onAttach:function(){this._initUrlCopyClipboard()},onBeforeDetach:function(){this._destroyUrlCopyClipboard()},_initUrlCopyClipboard:function(){a.isSupported()?this.$el&&0!=this.$el.find("._btnCopyUrl").length&&(this._destroyUrlCopyClipboard(),this.clipboard=new a("._btnCopyUrl"),this.clipboard.on("success",t.bind((function(e){alert(IM("copy_url.success")),this.destroy()}),this)),this.clipboard.on("error",t.bind((function(e){alert(IM("url_copy.fail")),this.destroy()}),this))):this.getUI("btnCopyUrl").click(t.bind((function(){alert(IM("url_copy.fail"))}),this))},_destroyUrlCopyClipboard:function(){this.clipboard&&this.clipboard.destroy()}});return l.buildDPostDetailUrlView=function(e,t){return new l({bandCore:e,postNo:t})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="header">\n        <h1 class="title"><%-IM(\'web.postdetail.popup.title.post_url\')%></h1>\n    </header>\n    <div class="main">\n        <p class="p"><%- IM("copy_url.label.try_copy_to_paste") %></p>\n        <div class="p -tSpace">\n            <div class="uInput">\n                <label class="gSrOnly" for="postDetailUrl"><%-IM(\'web.postdetail.popup.title.post_url\')%></label>\n                <input type="text" id="postDetailUrl" value="<%-msg_postDetailUrl%>">\n                <span class="border"></span>\n            </div>\n        </div>\n    </div>\n    <footer class="footer">\n        <button type="button" class="uButton _btnCopyUrl" data-clipboard-target="#postDetailUrl"><%- IM(\'copy_url.label\') %></button>\n        <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly"><%-IM("ui.label.close") %></span></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title"><%= IM("page.notice.setting.title") %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap  gMat-2">\n            <ul class="listLine">\n                <li class="tLine notiSettingItem">\n                    <div class="flexList -alignItemstart">\n                        <div class="text">\n                            <label for="notice" class="text gFs14 gFw6"><%= IM("web.postdetail.menu.set_notice") %></label>\n                        </div>\n                        <div class="etc gPal0 gMat2">\n                            <label for="notice" class="uCheck -switch">\n                                <input type="checkbox" id="notice" class="checkInput _checkNotice" <%if(msg_isNotice){%>checked<%}%>>\n                                <span class="checkLabel">\n                                <span class="shape "></span>\n                                <span class="text"></span>\n                            </span>\n                            </label>\n                        </div>\n                    </div>\n                    <p class="notiSettingDese gMat-9 _noticeNewsDescription" style="display: none;"><%- IM(\'postwrite.setting.notice_news_description\') %></p>\n                    <div class="_noticeSettingWrap">\n                        \x3c!-- 중요 공지로 등록 --\x3e\n                        <div class="optionItem gMat11 gMal0">\n                            <label for="important" class="uCheck -checkbox ">\n                                <input type="checkbox" id="important" class="checkInput _checkMajorNotice" <%if(msg_isMajorNotice){%>checked<%}%>>\n                                <span class="checkLabel">\n                                <span class="shape "></span>\n                                <span class="text"><%-IM(\'web.postwrite.set_major_notice\')%></span>\n                            </span>\n                            </label>\n                            <div class="optionItemDesc gFs12 gColorGr1 gMat4 gMal30 gMab13"><%=IM(\'web.postwrite.major_notice_desc\')%></div>\n                        </div>\n\n                        \x3c!-- 페이지 게시글 설정 > 연결된 밴드에 공지로 등록 --\x3e\n                        <% if (msg_hasLinkedBand) { %>\n                        <div class="pageNotiCheck optionItem gPat12 ">\n                            <label for="connected" class="uCheck -checkbox ">\n                                <input type="checkbox" id="connected" class="checkInput _checkLinkedBandNotice" <%if(msg_isLinkedBandNotice) {%> checked <%}%>>\n                                <span class="checkLabel">\n                                <span class="shape "></span>\n                                <span class="text gMal10"><%= IM("pageBand.notice.setConnectBand") %></span>\n                            </span>\n                            </label>\n                            <div class="optionItemDesc gFs12 gColorGr1 gMat4 gMal28 gMab9"><%= IM("page.notice.linked_band.desc") %></div>\n                        </div>\n                        <% } %>\n                    </div>\n\n                </li>\n\n                <% // "공지 내리기(종료) 설정" %>\n                <li class="tLine notiSettingItem gMab5 _noticeEndItemWrap" <%- msg_isNotice ? \'\' : \'style=display:none\'%> >\n                    <div class="flexList -alignItemstart">\n                        <div class="text">\n                            <label for="noticeUnSet" class="text gFs14 gFw6"><%-IM(\'web.postwrite.unset_notice\')%></label>\n                        </div>\n                        <div class="etc gPal0 gMat2">\n                            <label for="notice" class="uCheck -switch">\n                                <input type="checkbox" id="noticeUnSet" class="checkInput _checkNoticeUnset" <%if(msg_isNotice && msg_unsetAt){%>checked<%}%>>\n                                <span class="checkLabel">\n                                    <span class="shape"></span>\n                                </span>\n                            </label>\n                        </div>\n                    </div>\n\n                    <div class="_noticeEndDataWrap">\n                        <div class="flexList -spaceBetween">\n                            <time datetime="" class="gFs12 _noticeUnSetTextSpan" style="display: none;"></time>\n                            <button class="btnLinkText gFs12 gMat-2 _noticeGmtText" style="display: none;"></button>\n                        </div>\n                        <% // 공지 종료 일시 선택 영역 %>\n                        <div class="optionDateTime gMat-4 gMab7">\n                            <div class="_noticeDateInputRegion"></div>\n                        </div>\n                        <% // 타임존 선택 영역 %>\n                        <div class="optionDateTime gMat-2 gMab7">\n                            <div class="_noticeTimezoneRegion"></div>\n                        </div>\n                    </div>\n\n                </li>\n            </ul>\n        </div>\n    </div>\n    <footer class="modalFooter">\n        <button type="button" class="uButton -cancel"><%-IM(\'ui.label.cancel\')%></button>\n        <button type="button" class="uButton -confirm"><%-IM(\'ui.label.confirm\')%></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2445),s=(n(53),n(162)),a=n(2029),r=n(1154),l=i.View.extend({attributes:{"data-viewname":"DBandPagePostStatsView"},template:t.template(o),ui:{statsBodyContent:"._statsBodyContent",btnConfirm:"._btnConfirm",btnPrint:"._btnPrint",btnExcelDownload:"._btnExcelDownload",btnMore:"._btnMore",moreLyMenu:"._moreLyMenu"},regions:{statsBodyContent:{el:"@ui.statsBodyContent"}},events:{click:function(){this._toggleMoreLyMenu(!0)},"click @ui.btnConfirm":function(){return this.destroy(),!1},"click @ui.btnMore":function(){return this._toggleMoreLyMenu(),!1},"click @ui.btnExcelDownload":function(){this._isStatsBodyRegionEnabled()&&this._statsBodyContent.creteExcelFile()},"click @ui.btnPrint":function(){var e={from:null,to:null};this._isStatsBodyRegionEnabled()&&(e=this._statsBodyContent.getPeriodDates());var t=s.PAGE_BAND_POST_STATS_PRINT.makeUrl({band_no:this._bandNo,post_no:this._postNo},{from:e.from,to:e.to});window.open(t)}},initialize:function(e){this._bandNo=e.bandNo,this._postNo=e.postNo},onAttach:function(){var e=a.build(this._bandNo,this._postNo);this.showChildView("statsBodyContent",e),this._statsBodyContent=this.getChildView("statsBodyContent"),this.listenTo(e,r.EVENT.CONTENT_BODY_CLICK,(function(){this._toggleMoreLyMenu(!0)}))},_toggleMoreLyMenu:function(e){var t=this.getUI("moreLyMenu");e?t.hide():t.toggle(!t.is(":visible"))},_isStatsBodyRegionEnabled:function(){return this.hasRegion("statsBodyContent")&&!this._statsBodyContent.isDestroyed()}});return l.buildDBandPagePostStatsView=function(e,t){return new l({bandNo:e,postNo:t})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent" style="width:480px">\n        <header class="modalHeader">\n            <h1 class="title"><%- IM("page_band.post.stats.title") %></h1>\n\n            <div class="pageBandStatisticsMoreWrap">\n                <button type="button" class="btnMore _btnMore"><span class="gSrOnly"><%- IM(\'ui.label.more.short\') %></span></button>\n                <div class="lyMenu _moreLyMenu" style="display:none">\n                    <ul>\n                        <li><button class="btnListItem _btnExcelDownload"><%- IM(\'ui.label.excel_download\') %></button></li>\n                        <li><button class="btnListItem _btnPrint"><%- IM(\'ui.label.print\') %></button></li>\n                    </ul>\n                </div>\n            </div>\n        </header>\n\n        <div class="modalBody -spaceNone _statsBodyContent">\n        </div>\n\n        <footer class="modalFooter -tLine">\n            <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.close") %></button>\n        </footer>\n    </div>\n</section>'},function(e,t){e.exports='<% if (!isBandPagePost) { %>\n<div class="uHeaderWrap -h50">\n    <header class="header">\n        <h1 class="title"><%- IM(\'page_band.stats.title\') %></h1>\n\n        <div class="btnsWrap">\n            <div class="moreWrap">\n                <button type="button" class="btnMore _btnMore"><span class="gSrOnly"><%- IM(\'ui.label.more.short\') %></span></button>\n                <div class="lyMenu _pageBandStatisticsMoreMenu" style="display:none">\n                    <ul>\n                        <li><button type="button" class="_btnExcelDownload"><%- IM(\'ui.label.excel_download\') %></button></li>\n                        <li><button type="button" class="_btnPrint"><%- IM(\'ui.label.print\') %></button></li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </header>\n</div>\n<% } %>\n\n<div class="pageBandStatisticsWrap">\n    <div class="pageBandTabArea">\n        <ul class="userPostNav">\n            <% if (isBandPagePost) { %>\n            <li class="userNavListItem"><button type="button" class="navItem _btnTab _btnTabParticipation <%- tabLinkParticipationClass %>"><%- IM(\'page_band.stats.tab.participation\') %></button></li>\n            <li class="userNavListItem"><button type="button" class="navItem _btnTab _btnTabReaction <%- tabLinkReactionClass %>"><%- IM(\'page_band.stats.title.reaction_count\') %></button></li>\n            <% } else { %>\n            <li class="userNavListItem"><a href="<%- tabLinkFollowersUrl %>" class="navItem <%- tabLinkFollowersClass %>"><%- IM(\'page_band.stats.tab.followers\') %></a></li>\n            <li class="userNavListItem"><a href="<%- tabLinkParticipationUrl %>" class="navItem <%- tabLinkParticipationClass %>"><%- IM(\'page_band.stats.tab.participation\') %></a></li>\n            <li class="userNavListItem"><a href="<%- tabLinkReactionUrl %>" class="navItem <%- tabLinkReactionClass %>"><%- IM(\'page_band.stats.title.reaction_count\') %></a></li>\n            <% } %>\n        </ul>\n    </div>\n\n    <div class="pageBandStatisticsPeriodArea _pageBandStatisticsPeriodArea">\n        <div class="btnGroup">\n            <button type="button" class="btnPeriod _btnYesterday"><%- IM(\'page_band.stats.title.yesterday\') %></button>\n            <button type="button" class="btnPeriod  _btnLast7days"><%- IM(\'page_band.stats.title.recent7days\') %></button>\n            <button type="button" class="btnPeriod _btnLast4Weeks"><%- IM(\'page_band.stats.title.recent4weeks\') %></button>\n        </div>\n\n        <div class="periodSettingWrap">\n            <div class="_fromDate"></div>\n            <div class="dash"></div>\n            <div class="_toDate"></div>\n            <div class="btnWrap"><button type="button" class="uButton -confirm _btnLookup" disabled><%- IM(\'page_band.stats.lookup\') %></button></div>\n        </div>\n    </div>\n\n    <div class="_contentBodyView"></div>\n\n    <div class="pageBandStatisticsCommentArea">\n        <p class="cmtText"><%- IM(\'page_band.stats.lookup.desc\') %></p>\n    </div>\n</div>'},function(e,t){e.exports='<% if (isEmptyData) { %>\n<div class="uEmpty gContentCardShadow" style="height:547px">\n    <p>\n        <span class="uEmptyIcon -noData"></span>\n        <strong class="uEmptyTitle"><%- IM(\'page_band.stats.data.none\') %></strong>\n    </p>\n</div>\n<%\n} else {\n    var totalCount1 = 0;\n    var totalCount2 = 0;\n    var totalCount3 = 0;\n%>\n\n    <% if (currentTab === TAB_INFO.FOLLOWERS || (isPrintPage && !isPostPrintPage)) { %>\n    <div class="pageBandStatisticsWrap">\n        <% if (isPrintPage) { %>\n        <div class="statsTitWrap">\n            <h3 class="statsTitle"><%- IM(\'page_band.stats.title.followers\') %></h3>\n        </div>\n        <%} %>\n\n        <div class="pageBandStatisticsDataArea _pageBandStatisticsDataArea">\n            <table class="statsTable">\n                <thead>\n                    <tr>\n                        <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'schedule.edit.label.datearea\') %></div></th>\n                        <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'page_band.title.new_followers\') %></div></th>\n                        <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'page_band.stats.title.unsubscribe\') %></div></th>\n                        <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'page_band.stats.title.total_followers\') %></div></th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <%\n                        _.forEach(stats, function(stat){\n                    %>\n                    <tr>\n                        <td class="statsTbodyTd" scope="row"><div class="statsTd -tdCenter"><%- dateFormat(stat.work_date) %></div></td>\n                        <td class="statsTbodyTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(stat.joiner_count) %></div></td>\n                        <td class="statsTbodyTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(stat.withdrawer_count) %></div></td>\n                        <td class="statsTbodyTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(stat.member_count) %></div></td>\n                    </tr>\n                    <%  }); %>\n                </tbody>\n            </table>\n        </div>\n    </div>\n    <% } %>\n\n    <% if (currentTab === TAB_INFO.PARTICIPATION  || isPrintPage) { %>\n    <div class="pageBandStatisticsWrap">\n        <% if (isPrintPage) { %>\n        <div class="statsTitWrap">\n            <h3 class="statsTitle"><%- IM(\'page_band.stats.title.participation\') %></h3>\n        </div>\n        <%} %>\n\n        <div class="pageBandStatisticsDataArea _pageBandStatisticsDataArea">\n        <table class="statsTable">\n            <thead>\n            <tr>\n                <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'schedule.edit.label.datearea\') %></div></th>\n                <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'page_band.stats.title.exposure_count\') %></div></th>\n                <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'page_band.stats.title.click_count\') %></div></th>\n                <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'page_band.stats.title.reaction_count\') %></div></th>\n            </tr>\n            </thead>\n            <tbody>\n            <%\n            totalCount1 = 0;\n            totalCount2 = 0;\n            totalCount3 = 0;\n\n            _.forEach(stats, function(stat){\n                totalCount1 += stat.exposure_count;\n                totalCount2 += stat.read_count;\n                totalCount3 += stat.reaction_count;\n            %>\n            <tr>\n                <td class="statsTbodyTd" scope="row"><div class="statsTd -tdCenter"><%- dateFormat(stat.work_date) %></div></td>\n                <td class="statsTbodyTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(stat.exposure_count) %></div></td>\n                <td class="statsTbodyTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(stat.read_count) %></div></td>\n                <td class="statsTbodyTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(stat.reaction_count) %></div></td>\n            </tr>\n            <%  }); %>\n            </tbody>\n            <tfoot>\n            <tr>\n                <td class="statsTfootTd" scope="row"><div class="statsTd -tdCenter"><%- IM(\'ui.label.total\') %></div></td>\n                <td class="statsTfootTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(totalCount1) %></div></td>\n                <td class="statsTfootTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(totalCount2) %></div></td>\n                <td class="statsTfootTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(totalCount3) %></div></td>\n            </tr>\n            </tfoot>\n        </table>\n    </div>\n    </div>\n    <% } %>\n\n    <% if (currentTab === TAB_INFO.REACTION  || isPrintPage) { %>\n    <div class="pageBandStatisticsWrap">\n        <% if (isPrintPage) { %>\n        <div class="statsTitWrap">\n            <h3 class="statsTitle"><%- IM(\'page_band.stats.title.reaction_count\') %></h3>\n        </div>\n        <%} %>\n\n        <div class="pageBandStatisticsDataArea _pageBandStatisticsDataArea">\n            <table class="statsTable">\n                <thead>\n                <tr>\n                    <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'schedule.edit.label.datearea\') %></div></th>\n                    <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'page_band.stats.title.comment_count\') %></div></th>\n                    <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'page_band.stats.title.emotion_count\') %></div></th>\n                    <th class="statsTheadTh" scope="col"><div class="statsTh"><%- IM(\'page_band.stats.title.share_count\') %></div></th>\n                </tr>\n                </thead>\n                <tbody>\n                <%\n                    totalCount1 = 0;\n                    totalCount2 = 0;\n                    totalCount3 = 0;\n\n                _.forEach(stats, function(stat){\n                    totalCount1 += stat.comment_count;\n                    totalCount2 += stat.emotion_count;\n                    totalCount3 += stat.share_count;\n                %>\n                <tr>\n                    <td class="statsTbodyTd" scope="row"><div class="statsTd -tdCenter"><%- dateFormat(stat.work_date) %></div></td>\n                    <td class="statsTbodyTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(stat.comment_count) %></div></td>\n                    <td class="statsTbodyTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(stat.emotion_count) %></div></td>\n                    <td class="statsTbodyTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(stat.share_count) %></div></td>\n                </tr>\n                <%  }); %>\n                </tbody>\n                <tfoot>\n                <tr>\n                    <td class="statsTfootTd" scope="row"><div class="statsTd -tdCenter"><%- IM(\'ui.label.total\') %></div></td>\n                    <td class="statsTfootTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(totalCount1) %></div></td>\n                    <td class="statsTfootTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(totalCount2) %></div></td>\n                    <td class="statsTfootTd"><div class="statsTd -tdCenter"><%- _s.numberFormat(totalCount3) %></div></td>\n                </tr>\n                </tfoot>\n            </table>\n        </div>\n    </div>\n    <% } %>\n<% } %>'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM("web.bandmemberselection.title") %></h1>\n    </header>\n\n    <div class="modalBody -spaceNone -heightFix _mainContainer" style="height:536px">\n        <% if (isNotifyMemberPermitted) { %>\n        <div class="tab columnFixed gMab-1">\n            <span class="cell sf_color _tabs"><button type="button" class="_btnVirtualMemberTab"><%- IM(\'virtual.member.list.title\') %><span class="gPal4  sf_color _selectedVirtualMemberCount"></span></button></span>\n            <span class="cell sf_color -on _tabs"><button type="button" class="_btnBandMemberTab"><%- IM(\'web.common.members\') %><span class="gPal4 sf_color _selectedBandMemberCount"></span></button></span>\n        </div>\n        <% } %>\n\n        <form class="searchWrap -bottomLineNone -tLine  columnFixed" autocomplete="off">\n            <label for="searchMember" class="searchIcon"><span class="gSrOnly"><%- IM("band_member_select.label.name") %></span></label>\n\n            <span class="inputWrap">\n                <input type="text" id="searchMember" class="inputSearch _txtQuery" placeholder="<%- IM(\'band_member_select.label.name\') %>">\n            </span>\n\n            <button data-uiselector="btnSearch" type="submit" class="btnSearch uButton -sizeS -default -disabled _btnSearch"><%- IM("ui.label.search") %></button>\n        </form>\n\n        <div class="selectedMembersWrap columnFixed -tLine _selectedMembersWrap">\n            <ul class="selectedMembers _selectedMembers"></ul>\n        </div>\n\n        <div class="msgWrap -tLine columnFixed gPab15">\n            <p class="pText -smallFont -lightGray2 -lineHH gMat-2 _tabDesc"></p>\n\n            <div class="pText gPab1 _btnVirtualMemberManageWrap"><a href="<%- membersPageUrl %>" class="linkText -light gMat3 _btnVirtualMemberManage"><%- IM(\'send_an_alert.layer.virtual_member.manage\') %></a></div>\n\n            <% if (checkMemberSortEnabled) { %>\n            <div class="memberSelectWrap gMat10 ">\n                <div class="uInput -h32 -dropDown -bgNone _sortBandMemberListWrap" style="width:250px">\n                    <button type="button" aria-haspopup="listbox" class="dropdownToggle -flexible _selectedSortBtn" data-type="<%= selectedSortBandMemberInfo.TYPE %>" title="<%- selectedSortBandMemberInfo.LABEL%>">\n                        <span class="customText -ellipsis _selectedBtnTitle"><%- selectedSortBandMemberInfo.LABEL %></span>\n                    </button>\n                    <ul class="dropDown _sortBandMemberSortList" style="left:auto;right:0;max-width: 250px">\n                        <% _.each(bandMembersSort, function(bandMembersSortItem) { %>\n                        <li class="dropDownItem _sortBandMemberSortItem" role="option" data-type="<%= bandMembersSortItem.TYPE %>" data-custom-state-id="<%= bandMembersSortItem.customStateId %>">\n                            <button class="btnDropDownItem" type="button" title="<%- bandMembersSortItem.LABEL %>"><%- bandMembersSortItem.LABEL %></button>\n                        </li>\n                        <% }); %>\n                    </ul>\n                </div>\n            </div>\n            <% } %>\n        </div>\n\n        <div class="modalContentWrap rScroll -lrSpace -tLine gMat-1 columnFlexible _memberListContainerWrapper">\n            <div class="allSelectWrap _selectAllWrap">\n                <label class="flexList">\n                    <span class="text gMat2 -ellipsis"><%- IM(\'ui.label.select_all\') %> (<span class="_selectAllTotalCount">0</span>)</span>\n                    <span class="etc">\n                        <span class="uCheck -checkbox -noLabel">\n                            <input type="checkbox" class="checkInput _btnSelectAll">\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                            </span>\n                        </span>\n                    </span>\n                </label>\n            </div>\n\n            <ul class="listLine _memberListContainer" ></ul>\n\n            <button class="flexList -wFull listLine -tLine _btnHasMoreMember" style="display:none;">\n                <span class="thumb -searchIcon"></span>\n                <span class="text gTaL">\n                    <span class="gFs13 gColorBk2"><%- IM("member_list.label.has_more_member") %></span><br>\n                    <em class="gFs12 gColorGr1"><%- IM("member_list.label.search_more_member") %></em>\n                </span>\n            </button>\n\n            <button class="flexList -wFull listLine -tLine gPat10 gPab10 _btnAddSubscriber" style="display: none;">\n                <span class="btnAddIcon"></span>\n                <span class="pText -smallFont gPal10 gMat1"><%- IM(\'virtual.member.add\') %></span>\n            </button>\n\n            <p class="uEmpty _noResult" style="display:none; height:100%"></p>\n\n            <% // 가입 전 멤버 등록하기 안내 문구 %>\n            <div class="msgWrap -tLine  columnFixed gPal0 gPat12 gPab12 _helpGuideRegisterVirtualMember">\n                <div class="pText -smallFont -lightGray2 -lineHH"><%= IM("email_alarm.help_guide.register_virtual_member") %></div>\n                <div class="pText gPat-5"><a href="#" class="linkText -light _btnRegisterVirtualMember"><%= IM("email_alarm.help_guide.register_virtual_member.button_text") %></a></div>\n            </div>\n\n        </div>\n    </div>\n\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -cancel _btnClose"><%- IM("ui.label.cancel") %></button>\n        <button type="button" class="uButton -confirm -disabled _confirm" disabled><%- btnConfirmValue %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<label class="flexList">\n    <span class="thumb gPat11 gPab11">\n        <% if(isVirtualMemberData) { %>\n        <span class="uProfile -size40">\n            <span class="profileInner">\n                <img src="<%- profileThumbnail %>" alt="<%- name %>">\n            </span>\n        </span>\n        <% } else { %>\n        <a href="#" role="button" class="uProfile -size40 _btnProfileImage">\n            <span class="profileInner">\n                <img src="<%- profileThumbnail %>" alt="<%- name %>">\n            </span>\n        </a>\n        <% } %>\n    </span>\n    <span class="text <%- getIconClass() %>">\n        <span class="ellipsis -displayInlineBlock"><%- name %></span>\n    </span>\n    <span class="etc">\n        <span class="uCheck -checkbox">\n            <input type="checkbox" class="checkInput _chkMember" value="<%- userNo %>" <% if (selected) { %> checked="checked" <% } %>>\n            <span class="checkLabel">\n                <span class="shape"></span>\n            </span>\n        </span>\n    </span>\n</label>'},function(e,t){e.exports='<li>\n\t<span class="uProfile -size40">\n\t\t<span class="profileInner">\n\t\t\t<img src="<%- profileThumbnail %>" alt="<%- name %>">\n\t\t</span>\n\t</span>\n\t<span class="text"><%- name %></span>\n\t<button type="button" class="delete _btnMemberDelete" data-user="<%= userNo %>"><span class="gSrOnly"><%= IM(\'ui.label.del\') %></span></button>\n</li>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(6),i=n(0),o=n(493),s=n(82),a=n(160),r=n(503),l=n(511),c=t.Model.extend({defaults:{name:null,profileImageUrl:null,profileThumbnail:null,userNo:0,selected:!1,cellphone:null,isOpenCellphone:null,receiveEmailNotification:null},idAttribute:"userNo",parse:function(e){var t=null,n=null,i=null;return!function(e){return!!e.virtual_member_id}(e)?(t=e.profile_image_url,n=e.user_no,i=e.receive_email_notification):(t="",n=e.virtual_member_id,i=e.email),{name:e.name,profileImageUrl:t,userNo:n,selected:this.collection.selectedMembers.where({userNo:n}).length>0,profileThumbnail:s.makeProfileThumbnailUrl(t),cellphone:e.cellphone,isOpenCellphone:!!e.cellphone,receiveEmailNotification:!!i}},getName:function(){return this.get("name")},getUserNo:function(){return this.get("userNo")},getProfileThumbnail:function(){return this.get("profileThumbnail")}}),d=t.Collection.extend({model:c,initialize:function(e,t){t&&(this.bandNo=t.bandNo,this.memberFilter=t.filter,this.memberCountLimit=t.memberCountLimit),this._hasMoreMember=!1},_isPost:function(){return this.memberFilter===a.NOTIFY_POST},fetchBandMemberWithFilterDataCollectionForPost:function(e){var t=e||null;return o.getBandMembersOfBandWithFilter(this.bandNo,this.memberFilter,t).then(i.bind((function(e){this._hasMoreMember=!1,e.member_count>this.memberCountLimit&&(this._hasMoreMember=!0),e=this._extractDataWithReceiveEmailNotification(e),this._resetCollectionAndTotalCount(e)}),this))},fetchBandMemberWithFilterDataCollectionForSchedule:function(e,t){var n=e||null,s=o.getBandMembersOfBandWithFilter(this.bandNo,this.memberFilter,n);return this._bandMembersFilteringAsRsvpState(s,n,t).then(i.bind((function(e){this._hasMoreMember=!1,e.members>this.memberCountLimit&&(this._hasMoreMember=!0),e=this._extractDataWithReceiveEmailNotification(e),this._resetCollectionAndTotalCount(e)}),this))},_bandMembersFilteringAsRsvpState:function(e,t,n){var o=[e];return n&&o.push(r.getScheduleRsvpStatesOfMembers(this.bandNo,t)),$.when.apply($,o).then((function(e,t){if(this._hasMoreMember=!1,t){var o=[],s=[];i.each(t.rsvp_states,(function(e,t){(e.rsvp_state===l.CUSTOM&&e.custom_state_id==n.customStateId||e.rsvp_state!=l.CUSTOM&&e.rsvp_state===n.rsvpState)&&o.push(Number(t))})),i.each(e.members,(function(e){i.contains(o,e.user_no)&&s.push(e)})),e.members=s}return e}))},searchBandMemberWithFilterDataCollection:function(e,t){var n=t||null;return o.searchMember(e,this.bandNo,this.memberFilter,n).then(i.bind((function(e){this._hasMoreMember=!1,e=this._extractDataWithReceiveEmailNotification(e),this._resetBandMemberWithFilterDataCollection(e)}),this))},searchScheduleRsvpStatesOfMembersWithFilterDataCollection:function(e,t,n){var s=o.searchMember(e,this.bandNo,this.memberFilter,t);return this._bandMembersFilteringAsRsvpState(s,t,n).then(i.bind((function(e){this._hasMoreMember=!1,e=this._extractDataWithReceiveEmailNotification(e),this._resetBandMemberWithFilterDataCollection(e)}),this))},fetchVirtualMemberCollectionWithEmail:function(e){return o.getVirtualMembers(e).then(i.bind((function(e){this._hasMoreMember=!1,e=i.reject(e,(function(e){return!e.email})),this._resetBandMemberWithFilterDataCollection({members:e})}),this))},_extractDataWithReceiveEmailNotification:function(e){return e.members=i.reject(e.members,(function(e){return!e.receive_email_notification})),e},_resetCollectionAndTotalCount:function(e){this._totalMemberCount=e.member_count,this._resetBandMemberWithFilterDataCollection(e)},_resetBandMemberWithFilterDataCollection:function(e){this.hasMoreMember()?this.reset(e.members.slice(0,this.memberCountLimit),{parse:!0}):this.reset(e.members,{parse:!0})},hasMoreMember:function(){return this._hasMoreMember},setSelectedMember:function(e,t){var n=this.get(e);t?n&&(n.set("selected",!0),this.selectedMembers.add(n,{at:0})):(this.selectedMembers.remove(e),n&&n.set("selected",!1))},isEmpty:function(){return 0===this.length},setDataName:function(e){this.dataName=e},getDataName:function(e){return this.dataName},getBandNo:function(){return this.bandNo}});return d.buildMemberFilterDataCollection=function(e,n,i){var o=new d([],{bandNo:e,filter:n,memberCountLimit:i=i||1e3});return o.selectedMembers=new t.Collection(void 0,{model:c}),o},d}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="header">\n        <h1 class="title"><% if (virtual_member_id) { %><%- IM("ui.label.modify") %><% } else { %><%- IM("virtual.member.add") %><% } %></h1>\n    </header>\n\n    <div class="main">\n        <div class="virtualMember">\n            <p class="p -alignC"><%= IM("virtual.member.add.description") %></p>\n\n            <div class="uInputWrap gMat15">\n                <div class="uInput -simpleLine">\n                    <label for="name" class="gSrOnly"><%- IM("web.profile.label.name") %></label>\n                    <input type="text" id="name" class="_inputName" maxlength="20" value="<%- name %>" placeholder="<%- IM("web.profile.label.name") %>">\n                </div>\n            </div>\n\n            <div class="uInputWrap gMat15">\n                <div class="cell">\n                    <div class="uSelect" style="width:30px">\n                        <label for="selected_region_code" class="gSrOnly"><%- IM("virtual.member.add.country_code") %></label>\n                        <select title="<%= IM(\'setting.account.label.select_country_code\') %>" class="_selectCountryCode" id="selected_region_code">\n                            <% _.each(countryCodeList, function(value) { %>\n                            <option value="<%- value.nationCode %>" <% if (regionCode == value.nationCode) { %> selected<% } %>>+<%- value.regionNum %></option>\n                            <% }) %>\n                        </select>\n                    </div>\n                    <div class="uInput -simpleLine">\n                        <label for="cellphone" class="gSrOnly"><%- IM("web.bandsetting.home.label.cellphone") %></label>\n                        <input type="text" id="cellphone" class="_inputCellphone" value="<%- phoneNumber %>" placeholder="<%- IM("web.bandsetting.home.label.cellphone") %>">\n                    </div>\n                </div>\n                <p class="inputError _inputErrorCellphone" style="display:none;">\n                    <%- IM("virtual.member.add.wrong_cellphone") %>\n                </p>\n            </div>\n\n            <div class="uInputWrap gMat15">\n                    <div class="uInput -simpleLine">\n                        <label for="email" class="gSrOnly"><%- IM("web.setting.account.btn.email") %></label>\n                        <input type="email" id="email" class="_inputEmail" value="<%- email %>" placeholder="<%- IM("web.setting.account.btn.email") %>">\n                    </div>\n                    <p class="inputError _inputErrorEmail" style="display:none;">\n                        <%- IM("virtual.member.add.wrong_email") %>\n                    </p>\n                </div>\n\n            <p class="sDesc -alignC gMat20"><%- IM("virtual.member.add.permission_only_reader") %></p>\n        </div>\n    </div>\n    <footer class="footer">\n        <% if (virtual_member_id) { %>\n        <button type="button" class="uButton -sizeL -cancel _btnDelete"><%- IM("ui.label.delete") %></button>\n        <button type="button" class="uButton -sizeL _btnConfirm" disabled><%- IM("ui.label.modify") %></button>\n        <% } else { %>\n        <button type="button" class="uButton -sizeL _btnConfirm" disabled><%- IM("ui.label.registration") %></button>\n        <% } %>\n        <button type="button" class="btnLyClose uButton -iconClose _btnCancel"><span class="gSrOnly"><%- IM("ui.label.registration_cancel") %></span></button>\n    </footer>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(543),s=n(152),a=n(2454),r=n(2456),l=t.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DPostReadersView"},template:i.template(r),ui:{tabRead:"._tabRead",tabUnread:"._tabUnread",btnConfirm:"._btnConfirm",readUserListRegion:"._readUserListRegion",unreadUserListRegion:"._unreadUserListRegion"},regions:{readUserListRegion:"@ui.readUserListRegion",unreadUserListRegion:"@ui.unreadUserListRegion"},events:{"click @ui.tabRead":"_showReadUserList","click @ui.tabUnread":"_showUnreadUserList","click @ui.btnConfirm":"destroy"},initialize:function(e){this.isOverMaxMemberCount=e.bandData.getMemberCount()>=s.VIEW_POST_READERS_MAX_MEMBER_COUNT,this.bandData=e.bandData},serializeData:function(){return{readUsersCount:this.model.get("readCount"),unreadUsersCount:this.model.get("unreadUsers").length,isOverMaxMemberCount:this.isOverMaxMemberCount}},onAttach:function(){if(this.model.get("readUsers").length>0){var e=new a({userList:this.model.get("readUsers"),isNotice:this.model.get("isNotice"),isReadUserList:!0,viewPostReaderLevel:o.getBandViewPostReaderLevelAuthority(this.model.get("viewPostReaderLevel")),canUseSelectChatMember:!1,bandData:this.bandData});this.getRegion("readUserListRegion").show(e)}if(this.model.get("unreadUsers").length>0&&!this.options.isOverMaxMemberCount){var t=new a({userList:this.model.get("unreadUsers"),isReadUserList:!1,canUseSelectChatMember:!0,bandData:this.bandData});this.getRegion("unreadUserListRegion").show(t)}this._showReadUserList()},_showReadUserList:function(){return this.getUI("tabRead").parent().toggleClass("-on",!0),this.getUI("tabUnread").parent().toggleClass("-on",!1),this.ui.unreadUserListRegion.hide(),this.ui.readUserListRegion.show(),!1},_showUnreadUserList:function(){return this.getUI("tabRead").parent().toggleClass("-on",!1),this.getUI("tabUnread").parent().toggleClass("-on",!0),this.ui.readUserListRegion.hide(),this.ui.unreadUserListRegion.show(),!1}});return l.build=function(e){return new l({model:e.model,bandData:e.bandData})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(152),o=n(589),s=n(2455),a=n(720),r=n(780),l=n(1004);return t.View.extend({attributes:{"data-viewname":"DPostReadUserListView"},template:_.template(s),templateContext:{getReadUserCount:function(){return this.userList.length<i.VIEW_POST_READERS_MAX_MEMBER_COUNT?this.userList.length+"":"999+"},isOverMaxMemberCount:function(){return this.isReadUserList&&this.userList.length>=i.VIEW_POST_READERS_MAX_MEMBER_COUNT}},ui:{btnProfile:"._btnProfile",btnOneOnOneChat:"._btnOneOnOneChat",btnSelectChatMember:"._btnSelectChatMember"},events:{"click @ui.btnProfile":function(e){var t=this.userList.at($(e.currentTarget).data("index"));return o.openProfileView(t.get("bandNo"),t.get("userNo")),!1},"click @ui.btnOneOnOneChat":"_openOneOnOneChat","click @ui.btnSelectChatMember":"_openSelectChatMember"},initialize:function(e){this.isReadUserList=e.isReadUserList,this.isNotice=e.isNotice,this.userList=e.userList,this.viewAuthority=e.viewPostReaderLevel,this.canUseSelectChatMember=e.canUseSelectChatMember,this.bandData=e.bandData},serializeData:function(){return{isReadUserList:this.isReadUserList,isNotice:this.isNotice,userList:this.userList.toJSON(),viewAuthority:this.viewAuthority,maxMemberCount:i.VIEW_POST_READERS_MAX_MEMBER_COUNT,canUseSelectChatMember:this.canUseSelectChatMember}},_openOneOnOneChat:function(e){var t=$(e.currentTarget).data("index"),n=this.userList.at(t),i=n.get("userNo"),o=n.get("name");this._openChat([{userNo:i,name:o}])},_openSelectChatMember:function(){var e=this._getChatableSimpleMemberViewModels(),t=l.openAsLayer(this.bandData,new Backbone.Collection(e,{parse:!0}),null,!1,360);this.listenTo(t,"member:selected",_.bind((function(e){var t=e.map((function(e){return e.pick("userNo","name")}));this._openChat(t)}),this))},_getChatableSimpleMemberViewModels:function(){return _.map(this.userList.models,(function(e){return new r(e.toJSON(),{parse:!0})}))},_openChat:function(e){a.startChattingWithUsers(e,this.bandData.getBandNo())}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="listLine rScroll -lrSpace -h360 gPr">\n<% if (isReadUserList) { %>\n    <p class="sDesc -bLine gMat10">\n        <%= IM("post.read_user_list.comment.read_user", {count: getReadUserCount()}) %>\n        <br>\n        <% if (isNotice) { %>\n        <%= IM("post.notice_read_user_list.comment.read_user.view_authority", {viewAuthority: viewAuthority}) %>\n        <% } else { %>\n        <%= IM("post.read_user_list.comment.read_user.view_authority", {viewAuthority: viewAuthority}) %>\n        <% } %>\n    </p>\n    <% } %>\n\n    <% if (canUseSelectChatMember) { %>\n    <button type="button" class="buttonMemberChat -arrow -borderBottom _btnSelectChatMember">\n        <span class="iconChatPlus"></span><span class="text"><%= IM(\'ui.label.chat_with_following_members\') %></span>\n    </button>\n    <% } %>\n\n    <ul>\n        <% _.each(userList, function(user, index) { %>\n        <li class="tLine flexList">\n            <span class="thumb">\n                <a href="#" role="button" class="uProfile -size40 -border _btnProfile" data-index="<%- index %>">\n                    <span class="profileInner">\n                        <img src="<%- user.faceThumb %>" width="40" height="40" alt="">\n                    </span>\n                </a>\n            </span>\n            <span class="text">\n                <span class="ellipsis"><%- user.name %></span>\n                <span class="sub2"><%- user.desc %></span>\n            </span>\n\n            <span class="etc">\n                <button type="button" class="buttonChatting _btnOneOnOneChat" data-index="<%- index %>">\n                    <span class="gSrOnly"><%- IM(\'chat.btn.private_chat\') %></span>\n                    <svg class="svgIcon sf_color" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-chat"></use>\n                    </svg>\n                </button>\n            </span>\n        </li>\n        <% }); %>\n    </ul>\n</div>\n\n<% if (isOverMaxMemberCount()) { %>\n<p class="sDesc -tLine gPat10 gMab10 gMal20 gMar20"><%= IM("post.read_user_list.comment.read_user.about_max_count", {maxMemberCount: maxMemberCount}) %></p>\n<% } %>\n'},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title"><%= IM("post.read_user_list.layer.title") %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <% // 읽은 사용자/ 읽지 않은 사용자 탭 %>\n            <div class="tab">\n            <span class="cell sf_color">\n                <button type="button" class="_tabRead"><%= IM("post.read_user_list.tab.title.read_user") %> <span class="sf_color"><%- readUsersCount %></span></button>\n            </span>\n                <span class="cell sf_color">\n                <button type="button" class="_tabUnread"><%= IM("post.read_user_list.tab.title.unread_user") %> <span class="sf_color"><%- unreadUsersCount %></span></button>\n            </span>\n            </div>\n            <% // 읽은 사용자 목록 %>\n            <div class="_readUserListRegion">\n                <div class="uEmpty -h360">\n                    <span><%= IM("post.read_user_list.message.empty_list") %></span>\n                </div>\n            </div>\n            <% // 안 읽은 사용자 목록 %>\n            <div class="postFaceList h415 _unreadUserListRegion">\n                <div class="uEmpty -h360">\n                    <% if (isOverMaxMemberCount) { // 빅밴드인 경우 %>\n                    <span><%= IM("post.read_user_list.message.limit_max_member_count") %></span>\n                    <% } else { %>\n                    <span><%= IM("post.read_user_list.message.empty_list") %></span>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n    </footer>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){n(556);var t,i=n(152),o=n(1641),s=n(1563),a=n(1155),r=n(2460),l=n(2484),c=n(2526),d=n(1568),u=n(2042),h=n(2530),p=n(2589),m=n(2591),_=n(2663),g=n(1263),f=n(1575),b=n(1576),v=n(1264),A=n(2055),E=n(2056),T=n(1577),C=n(2665),y=n(1578),M=n(2059),I=n(2060),S=n(2062),w=o.extend({attributes:{"data-viewname":"DPostContentListView"},className:"postBody",defaultChildView:s,attachmentViews:(t={},t[i.POST_ATTACHMENT_TYPE.STICKER]=a,t[i.POST_ATTACHMENT_TYPE.POLL]=r,t[i.POST_ATTACHMENT_TYPE.POLL_V2]=r,t[i.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP]=function(e){return e.hasSingleSchedule()?l:c},t[i.POST_ATTACHMENT_TYPE.ATTENDANCE_CHECK]=E,t[i.POST_ATTACHMENT_TYPE.BILL_SPLIT]=u,t[i.POST_ATTACHMENT_TYPE.TODO]=d,t[i.POST_ATTACHMENT_TYPE.TODO_V2]=d,t[i.POST_ATTACHMENT_TYPE.SIGNUP]=y,t[i.POST_ATTACHMENT_TYPE.VIDEO]=h,t[i.POST_ATTACHMENT_TYPE.PHOTO]=p,t[i.POST_ATTACHMENT_TYPE.PROMOTION_PHOTO]=p,t[i.POST_ATTACHMENT_TYPE.SHARED_POST_SNIPPET]=m,t[i.POST_ATTACHMENT_TYPE.SHARED_PAGE_POST_SNIPPET]=_,t[i.POST_ATTACHMENT_TYPE.SNIPPET]=g,t[i.POST_ATTACHMENT_TYPE.FILE]=f,t[i.POST_ATTACHMENT_TYPE.DROPBOX_FILE]=f,t[i.POST_ATTACHMENT_TYPE.EXTERNAL_FILE]=f,t[i.POST_ATTACHMENT_TYPE.LOCATION]=b,t[i.POST_ATTACHMENT_TYPE.PHOTO_ALBUM]=A,t[i.POST_ATTACHMENT_TYPE.SUBPOST]=v,t[i.POST_ATTACHMENT_TYPE.ADDON]=T,t[i.POST_ATTACHMENT_TYPE.AUDIO]=M,t[i.POST_ATTACHMENT_TYPE.QUIZ]=I,t[i.POST_ATTACHMENT_TYPE.SURVEY]=S,t.unknown=C,t)});return w.build=function(e){return new w(e)},w}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="postText _postText" tabindex="-1">\n<% if (isRestricted) { %>\n    <% // 징계 처리 블라인드 텍스트 %>\n    <div class="blindGuideBox gMat2 gMab2">\n        <p class="blindGuideText gColorGr2"><%= (bPostDetail) ? content : content[0] %></p>\n    </div>\n<% } else { %>\n    <% // 글 상세 페이지인 경우 %>\n    <% if (bPostDetail) { %>\n        <div class="txtBody"><%= content %></div>\n    <% } else { %>\n        <p class="txtBody"><%= content[0] %></p>\n        <% if (content[1]) { // \'...더보기\' %>\n        <span class="seeMore">\n            <button type="button" class="_btnMore">...<%= IM(\'ui.label.more.long\') %></button>\n        </span>\n        <% } %>\n    <% } %>\n<% } %>\n</div>\n'},function(e,t){e.exports='<div class="attachmentSticker _attachmentSticker" tabindex="-1">\n    <% // 스티커가 있다면 스티커 노출 %>\n    <% if (imageUrl != "") { %>\n    <div class="sticker _apngParent">\n        <img src="<%- imageUrl %>" alt="sticker" class=" _prevent_context _stickerImage" data-apng-url="<%- aniStickerImageUrl %>"  style="width:<%- convertedWidth %>px;height:<%- convertedHeight %>px" />\n    </div>\n    <% } %>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(6),o=n(4),s=n(486),a=n(152),r=n(523),l=n(1642),c=n(501),d=n(2464),u=n(2465),h=n(2467),p=n(586),m=n(555),_=n(513),g=n(26),f=(n(615),n(553)),b=n(1564),v=o.View.extend({behaviors:[b],options:{attachmentDisplayType:null,bandData:null},attributes:function(){var e={"data-viewname":"DPostPollView"};return this.options.attachmentDisplayType===a.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},className:function(){var e="uWidget";return this.options.bandData.canUseAttachedPostPoll()&&!this.options.clickDisabledPostTypeOnDetail||(e+=" gCursorDefault"),e},template:t.template(d),ui:{pollCheck:"._pollCheck",pollNonWrap:"._pollNonWrap",btnPollHistory:"._btnPollHistory",btnAddPollSubjectWrap:"._btnAddPollSubjectWrap",btnAddPollSubject:"._btnAddPollSubject",addPollSubjectWrap:"._addPollSubjectWrap",textAddPollSubject:"._textAddPollSubject",btnCancelAddPollSubject:"._btnCancelAddPollSubject",btnConfirmAddPollSubject:"._btnConfirmAddPollSubject",btnPollSubjectVoters:"._btnPollSubjectVoters",voteClose:"._voteClose",menuToggleBtn:"._menuToggleBtn",menuLayer:"._menuLayer",excelLink:"._excelLink",printLink:"._printLink"},events:function(){return!this.options.bandData.canUseAttachedPostPoll()||this.options.clickDisabledPostTypeOnDetail?{}:{"change @ui.pollCheck":"_vote","click @ui.btnPollHistory":"_openPollSubjectHistory","click @ui.btnAddPollSubject":"_showAddPollSubjectForm","click @ui.btnCancelAddPollSubject":"_cancelAddPollSubject","click @ui.voteClose":"_closeVote","click @ui.pollNonWrap":"_openRemainedVotersList","click @ui.btnPollSubjectVoters":"_openPollSubjectVoters","click @ui.btnConfirmAddPollSubject":"_submitAddPollSubject","keyup @ui.textAddPollSubject":function(e){var t=e.keyCode;if(37==t||39==t)return!1;this._confirmAddPollSubject(e)},"click @ui.menuToggleBtn":function(){this.ui.menuLayer.is(":visible")||t.defer(t.bind((function(){this.ui.menuLayer.show()}),this))},"click @ui.excelLink":function(e){e.preventDefault(),this._getPollBeforeDownloadExcelFile()},"click @ui.printLink":function(e){e.preventDefault(),this._openPrintView()}}},initialize:function(e){this.pollModel=e.model,this.postModel=e.postModel,this._bandData=e.bandData,this.listenTo(g.getDGlobalChannel(),g.EVENT.HTML_CLICK,this._closeLayers),this._isClickable=this.options.bandData.canUseAttachedPostPoll()&&!this.options.clickDisabledPostTypeOnDetail},templateContext:function(){var e=IM("web.postlist.poll.label.done");return this.pollModel.get("isOpen")&&(e=this.pollModel.get("isAnonymous")?IM("post.poll.title.anonymous_poll_in_progress"):IM("web.postlist.poll.label.in_progress")),{msg_pollProgressStatus:e,msg_remainingTime:this._getRemainingTime()}},serializeData:function(){var e={cid:this.pollModel.cid,pollSubjectMaxLength:a.POLL_SUBJECT_MAX_LENGTH,isOpen:this.pollModel.get("isOpen"),isVoted:this.pollModel.get("isVoted"),isMultipleSelect:this.pollModel.get("isMultipleSelect"),isSubjectCountless:this.pollModel.get("isSubjectCountless"),pollVoterCount:this.pollModel.get("count")||"0",title:this.pollModel.get("title"),endedAt:this.pollModel.get("endedAt"),isVoteVisibleToViewer:this.pollModel.get("isVoteVisibleToViewer"),voteVisibleQualificationDesc:this._getVoteVisibleQualificationDesc(),isVoteLimited:this.pollModel.get("isVoteLimited"),votableLimit:this.pollModel.get("votableLimit"),isShowPollOptionMenu:this._getPollOptionAccessPermission()},n={pollSubjects:this.pollModel.get("subjects").toJSON(),condition:{isCheckboxClickable:this._isClickable,isAnonymous:this.pollModel.get("isAnonymous"),isSubjectAddible:this.pollModel.get("isSubjectAddible"),isAuthor:this.pollModel.get("isAuthor")}},i=this.pollModel.get("remainMember");return n.isVisibleRemainMember=!!i&&!!i.get("voterCount")&&this.postModel.getBand().showRemainMemberAtPostPoll(),n.remainMember={voterCount:i?i.get("voterCount"):0,voters:i?i.get("voters"):null},t.extend(e,n)},onRender:function(){this._renderVoteBar()},_getVoteVisibleQualificationDesc:function(){switch(this.pollModel.get("voteVisibleQualification")){case a.POLL_VOTE_VISIBLE_QUALIFICATION.ONLY_MANAGER:return IM("post.vote_visible_qualification.only_manager.desc");case a.POLL_VOTE_VISIBLE_QUALIFICATION.ALL_AFTER_POLL_END:if(this.pollModel.get("isOpen")&&this.pollModel.get("isVoted"))return IM("post.poll.txt.before_poll_end")}return null},_openRemainedVotersList:function(){var e=this.pollModel.get("remainMember").get("voterCount");if(e>0&&!this._onMemberLoading){this._onMemberLoading=!0;var n,o=this.pollModel.get("bandNo"),s=this.pollModel.get("postNo");if(this.pollModel.isV1())n=p.getRemainedVotersV1(o,s);else{var a=this.pollModel.get("pollId");n=p.getRemainedVotersV2(o,s,a)}n.done(t.bind((function(t){if(t.voters.length>0){var n=IM("ui.label.nonresponse_member")+" "+e,o=new i.Collection(t.voters,{model:c,parse:!0});u.openAsLayer(n,o)}this._onMemberLoading=!1}),this))}return!1},_openPollSubjectVoters:function(e){if(!this.votersPromise){var n=this.pollModel.get("bandNo"),i=this.pollModel.get("postNo"),o=$(e.currentTarget).data("subjectid"),s=this.pollModel.get("subjects"),a="";if(s.forEach(t.bind((function(e,t){var n=e.get("pollSubjectId");o==n&&(a=e.get("title"))}),this)),this.pollModel.isV1())this.votersPromise=h.openMemberListV1(n,i,o,a);else{var r=this.pollModel.get("pollId");this.votersPromise=h.openMemberListV2(n,i,r,o,a)}return this.votersPromise.always(t.bind((function(){this.votersPromise=null}),this)),!1}},_showPostDetailLayer:function(){this.trigger("attachmentPoll:showPostDetailLayer")},_renderVoteBar:function(){var e=this.pollModel.get("subjects");if(!e.isEmpty()){var n=e.max((function(e){return e.get("voterCount")})).get("voterCount");e.forEach(t.bind((function(e,t){var i=e.get("voterCount");if(!(i<1)){var o=i/n*98;this.$el.find("._voteBar"+e.get("pollSubjectId")).css("width",o+"%")}}),this))}},_vote:function(e){var n=$(e.currentTarget);return this.pollModel.saveVote(n.data("subjectid"),n.is(":checked")).then(null,(function(e){e.result_data&&e.result_data.message&&alert(e.result_data.message)})).always(t.bind((function(){this.postModel.fetchPostDetail()}),this)),!1},_openPollSubjectHistory:function(e){var t,n=this.pollModel.get("bandNo"),i=this.pollModel.get("postNo"),o=$(e.currentTarget).data("subjectid");if(this.pollModel.isV1())t=l.buildForPollSubjectHistroyV1(n,i,o);else{var a=this.pollModel.get("pollId");t=l.buildForPollSubjectHistroyV2(n,i,a,o)}return s.openWithoutHiding(t),!1},_showAddPollSubjectForm:function(){this.ui.btnAddPollSubjectWrap.hide(),this.ui.addPollSubjectWrap.show(),this.ui.textAddPollSubject.val(""),this.ui.textAddPollSubject.triggerHandler("update"),this.ui.textAddPollSubject.focus()},_cancelAddPollSubject:function(){this.ui.btnAddPollSubjectWrap.show(),this.ui.addPollSubjectWrap.hide()},_confirmAddPollSubject:function(e){e.keyCode==m.ENTER&&this._submitAddPollSubject()},_submitAddPollSubject:function(){var e=this.ui.textAddPollSubject.val();e&&this.pollModel.addSubject(e).then(t.bind((function(){this.postModel.fetchPostDetail()}),this))},_closeVote:function(){return confirm(IM("web.postdetail.poll.confirm.vote"))&&this.pollModel.closePoll().then(t.bind((function(e){this.postModel.fetchPostDetail().done(t.bind((function(){this.postModel.trigger("DPostPollVIew:closeVote"),alert(e)}),this))}),this)),!1},_getRemainingTime:function(){var e=this.pollModel,t=e.get("endedAt");if(e.get("isOpen")&&t>0){var n=r.getRemainingTime(t);return IM("web.postdetail.poll.remaining_time_format_"+n.format,{value:n.value})}return""},_closeLayers:function(){try{this.ui.menuLayer.hide()}catch(e){}},_getPollOptionAccessPermission:function(){return!!this.options.bandData.canGetAllPollVoterAtOnce()&&!!this.pollModel.get("isVoteVisibleToViewer")},_getPollBeforeDownloadExcelFile:function(){this.startDownload(b.KEY.POLL,[{band_no:this.postModel.getBandNo(),post_no:this.postModel.getPostNo(),attachment_id:this.pollModel.get("pollId")}],{bandCore:this.options.bandData.getBandCore()})},_openPrintView:function(){var e=f.attachmentPrint(this._bandData.getBandCore(),"poll",[{post_no:this.model.get("postNo"),attachment_id:this.model.get("pollId")}]).url;_.openWindowXSSSafely(e,"_blank")}});return v.buildListItemView=function(e){return new v({model:e.model,postModel:e.postModel,attachmentDisplayType:e.attachmentDisplayType})},v}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%-IM(\'web.post.subject_history.title\')%></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap">\n            <div class="memberListBox  _historyListRegion" style="height: 390px">\n\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter gMat9 gPat11 -tLine">\n        <button type="button" class="btnLyBack uButton -iconLyBack _btnConfirm"><span class="gSrOnly"><%= IM("ui.label.back") %></span></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%-IM(\'ui.label.confirm\')%></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(16),s=n(9),a=n(618),r=n(155),l=n(2463),c=n(874),d=n(152);return i.View.extend({options:{bandNo:null,isLast:null},tagName:"li",className:"tLine flexList",attributes:{"data-viewname":"DAttachmentHistoryItemView"},template:t.template(l),templateContext:function(){return{simpleDate:o(this.model.get("createdAt")).format(o.defaultFormat),relativeTime:s.format.relative(this.model.get("createdAt"),"month_day_time"),stateMessage:this.getStateText(),changedItem:this.edittedInfo.changedItem}},regions:{profileImageRegion:"._profileImageRegion"},initialize:function(e){this._attachmentType=e.attachmentType,this._isHistoryForRSVP=this._attachmentType==d.POST_ATTACHMENT_TYPE.SCHEDULE_GROUP,this.edittedInfo={relativeTime:s.format.relative(this.model.getCreatedAt(),"month_day_time"),simpleDate:o(this.model.getCreatedAt()).format(o.defaultFormat)},this.edittedInfo.editUserInfo=this._isHistoryForRSVP?this.model.getActorInfo():this.model.getEditorInfo(),this.edittedInfo.changedItem=this._isHistoryForRSVP?this.model.getRsvpStateText():this.model.getSubject()},onRender:function(){this.showChildView("profileImageRegion",a.buildContentCreatorProfileImageView({memberProfile:this.edittedInfo.editUserInfo.profileInfo,userNoOrMemberKey:this.edittedInfo.editUserInfo.userNo,bandCore:r.get(this.options.bandNo).getBandCore(),role:this.edittedInfo.editUserInfo.roleName}))},getStateText:function(){var e=!this.edittedInfo.editUserInfo.userNo;this.attachmentType!=d.POST_ATTACHMENT_TYPE.POLL&&this.attachmentType!=d.POST_ATTACHMENT_TYPE.POLL_V2||(e=!this.edittedInfo.editUserInfo.userNo);var n=t.escape(this.edittedInfo.editUserInfo.userName);return c.makeStateMessage(this._attachmentType,this.options.isLast,n,e)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="thumb _profileImageRegion"></span>\n<span class="text">\n    <span class="ellipsis2"><%- changedItem %></span>\n    <span class="gFs12">\n        <%= stateMessage %>\n    </span>\n    <time class="blockTime  gMat2" datetime="<%- simpleDate %>"><%-relativeTime%></time>\n</span>\n\n'},function(e,t){e.exports='<div class="item -vote">\n<% // 투표 Title 정보 (글 목록과 글 상세에서 모두 노출) %>\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-vote sf_color" aria-hidden="true">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-vote"></use>\n            </svg>\n            <span class="status sf_color">\n                <%= msg_pollProgressStatus %>\n            </span>\n\n            <%= IM("web.postlist.poll.txt.poll_count", {pollCount: pollVoterCount}) %>\n        </p>\n        <p class="addTitle"><%- title %></p>\n        <% if (msg_remainingTime) { %>\n        <time class="timeSUp sf_color"><%= msg_remainingTime %></time>\n        <% } %>\n        <% if (isOpen && isMultipleSelect) { %>\n        <p class="alert"><%= (isVoteLimited ? IM(\'post.poll.txt.can_limited_multiple_select\', {count : votableLimit}) : IM(\'post.poll.txt.can_multiple_select\')) %></p>\n        <% } %>\n\n        <% if (voteVisibleQualificationDesc) { %>\n        <p class="alert gColorBk4 gBlock"><%- voteVisibleQualificationDesc %></p>\n        <% } %>\n\n        <% if (isShowPollOptionMenu) { %>\n        <div class="option">\n            <button type="button" class="memberSet _menuToggleBtn"><%= IM("web.uicomponent.topbar.button.menuopen") %></button>\n            <div class="lyMenu _menuLayer" style="min-width:130px;display:none">\n                <ul>\n                    <li><a href="#" class="_excelLink"><%= IM("ui.label.excel_download") %></a></li>\n                    <li><a href="#" class="_printLink"><%= IM("ui.label.print") %></a></li>\n                </ul>\n            </div>\n        </div>\n        <% } %>\n    </div>\n\n    <% if (!isOpen) { %>\n    \x3c!--투표 종료--\x3e\n    <div class="addDetail">\n        <% // 투표 현황 조회 권한이 없는 경우 -private 클래스 추가 %>\n        <ul class="pollQuestionList -finish <%- (!isVoteVisibleToViewer ? \'-private\' : \'\') %>">\n            <% _.each(pollSubjects, function(subject) { %>\n            <% // 내가 투표한 항목일때 votedItem 클래스 추가 %>\n            <li class="<%- (subject.isVoted ? \'votedItem\' : \'\') %>">\n                <span class="cCheckList">\n                    <strong class="labelTitle"><%- subject.title %></strong>\n                    <% // 수정되었거나 추가된 투표 항목인 경우 %>\n                    <% if (subject.isUpdated || subject.isAdded) { %>\n                    <button type="button" class="status _btnPollHistory" data-subjectid="<%- subject.pollSubjectId %>"><%= subject.isUpdated ? IM(\'web.postdetail.poll.label.updated\') : IM(\'web.postdetail.poll.label.added\') %></button>\n                    <% } %>\n                    <% // 그래프 조건 - 투표종료되었거나 투표 전 득표현황 보기가 ON 이거나 계정 사용자가 투표한 경우 %>\n                    <% if (isVoteVisibleToViewer) { %>\n                    <span class="graphBar<%= (subject.voterCount > 0 ? \' sf_color\' : \'\') %>"><span class="bar sf_tBg _voteBar<%= subject.pollSubjectId %>"></span><%= subject.voterCount %></span>\n                    <% } %>\n                    <% // 투표한 멤버 목록 %>\n                    <% if (isVoteVisibleToViewer && !condition.isAnonymous && subject.voterCount > 0) { %>\n                    <span class="labelDesc gMat6"><%- _.pluck(subject.voters, \'name\').join(\', \') %></span>\n                    <button type="button" class="status _btnPollSubjectVoters" data-subjectid="<%- subject.pollSubjectId %>"><%= IM(\'web.board.notice.more\') %></button>\n                    <% } %>\n                </span>\n            </li>\n            <% }); %>\n        </ul>\n\n        <% // 미참여 인원 목록 %>\n        <%if (isVisibleRemainMember) { %>\n            <% if (condition.isAnonymous) { %>\n                <div class="pollNon">\n                    <p class="pollNonInfo"><%- IM("ui.label.nonresponse_member") %> <strong><%- remainMember.voterCount %></strong></p>\n                </div>\n            <% } else { %>\n                <a href="#" role="button" class="pollNon _pollNonWrap">\n                    <p class="pollNonInfo"><%- IM("ui.label.nonresponse_member") %> <strong><%- remainMember.voterCount %></strong></p>\n                    <p class="pollNonList"><%- _.pluck(remainMember.voters, "name").join(", ") %></p>\n                </a>\n            <% } %>\n        <% } %>\n    </div>\n\n    <% } else { %>\n    \x3c!--투표중--\x3e\n    <div class="addDetail">\n        <ul class="pollQuestionList">\n            <% _.each(pollSubjects, function(subject, index) { %>\n            <li>\n                <label class="checkboxArea">\n                    <span class="uCheck -checkbox -noLabel">\n                        <input type="checkbox" name="subject" id="poll_<%= cid %>_<%= index %>" data-subjectid="<%- subject.pollSubjectId %>" class="checkInput _pollCheck"<% if (subject.isVoted) { %> checked="checked"<% } %><% if (!condition.isCheckboxClickable) { %> disabled="disabled"<% } %>>\n                        <span class="checkLabel">\n                            <span class="shape sf_tAfterBg"></span>\n                        </span>\n                    </span>\n                </label>\n                <label for="poll_<%= cid %>_<%= index %>" class="cCheckList">\n                    <strong class="labelTitle"><%- subject.title %></strong>\n                    <% // 수정되었거나 추가된 투표 항목인 경우 %>\n                    <% if (subject.isUpdated || subject.isAdded) { %>\n                    <button type="button" class="status _btnPollHistory" data-subjectid="<%- subject.pollSubjectId %>"><%= subject.isUpdated ? IM(\'web.postdetail.poll.label.updated\') : IM(\'web.postdetail.poll.label.added\') %></button>\n                    <% } %>\n\n                    <% // 그래프 조건 - 투표종료되었거나 득표현황 보기가 항상보기 일때, 투표 후 현황보기 시에는 계정 사용자가 투표한 경우 %>\n                    <% if (isVoteVisibleToViewer) { %>\n                    <span class="graphBar<%= (subject.voterCount > 0 ? \' sf_color\' : \'\') %>"><span class="bar sf_tBg _voteBar<%= subject.pollSubjectId %>"></span><%= subject.voterCount %></span>\n                    <% } %>\n                    <% // 투표한 멤버 목록 %>\n                    <% if (isVoteVisibleToViewer && !condition.isAnonymous && subject.voterCount > 0) { %>\n                    <span class="labelDesc gMat6"><%- _.pluck(subject.voters, \'name\').join(\', \') %></span>\n                    <button type="button" class="status _btnPollSubjectVoters" data-subjectid="<%- subject.pollSubjectId %>"><%= IM(\'web.board.notice.more\') %></button>\n                    <% } %>\n                </label>\n            </li>\n            <% }); %>\n        </ul>\n\n        <% // 항목 추가 버튼 %>\n        <% if (condition.isSubjectAddible) { %>\n            <div class="addListItem _btnAddPollSubjectWrap">\n                <button type="button" class="btnAdd _btnAddPollSubject"><%= IM(\'web.postdetail.poll.add_subject\') %></button>\n            </div>\n            <div class="addListItem _addPollSubjectWrap" style="display:none;">\n                \x3c!-- max-height:96px; / min-height: 42px; --\x3e\n                <div class="uTextarea">\n                    <input type="text" class="_textAddPollSubject" maxlength="<%- pollSubjectMaxLength %>" placeholder="<%- IM(\'web.postdetail.poll.add_subject\') %>" autocomplete="off">\n                    <span class="border"></span>\n                </div>\n                <button type="button" class="btnCancel _btnCancelAddPollSubject"><%- IM("web.postdetail.btn.cancel") %></button><button type="button" class="btnConfirm _btnConfirmAddPollSubject"><%- IM("web.postdetail.btn.add")%></button>\n            </div>\n        <% } %>\n\n        <% // 미참여 인원 목록 %>\n        <%if (isVisibleRemainMember) { %>\n            <% if (condition.isAnonymous) { %>\n                <div class="pollNon">\n                    <p class="pollNonInfo"><%- IM("ui.label.nonresponse_member") %> <strong><%- remainMember.voterCount %></strong></p>\n                </div>\n            <% } else { %>\n                <a href="#" role="button" class="pollNon _pollNonWrap">\n                    <p class="pollNonInfo"><%- IM("ui.label.nonresponse_member") %> <strong><%- remainMember.voterCount %></strong></p>\n                    <p class="pollNonList"><%- _.pluck(remainMember.voters, "name").join(", ") %></p>\n                </a>\n            <% } %>\n        <% } %>\n\n        <% // 종료하기 버튼 %>\n        <% if (condition.isAuthor) { %>\n            <div class="pollBtns">\n                <button class="uButton -sizeL -close sf_color sf_tBorder _voteClose">\n                    <svg class="svgIcon" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-end-check"></use>\n                    </svg>\n                    <%= IM(\'web.postdetail.poll.btn.close\') %>\n                </button>\n            </div>\n        <% } %>\n    </div>\n    <% } %>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2466),s=n(589),a=n(486),r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DPostPollNonParticipatedVotersView"},template:t.template(o),templateContext:function(){return{msg_title:this.options.title}},ui:{dimmed:".dimmed",btnConfirm:"._btnConfirm",userItem:"._userItem"},events:{"click @ui.btnConfirm":"destroy","click @ui.dimmed":"destroy","click @ui.userItem":"_openProfileView"},_openProfileView:function(e){var t=$(e.currentTarget).data("index"),n=this.collection.at(t);return s.openProfileView(n.get("bandNo"),n.get("userNo")),!1}});return r.openAsLayer=function(e,t){var n=new r({title:e,collection:t});a.open(n)},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="modalHeader">\n        <h1 class="title"><%- msg_title %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap">\n            <ul class="listLine rScroll -h360">\n                <% _.each(items, function(item, index) { %>\n                <li class="tLine">\n                    <a href="#" class="flexList _userItem" data-index="<%-index%>">\n                    <span class="thumb">\n                        <span class="uProfile -size40">\n                            <span class="profileInner <%- item.profileInnerClass %>">\n                                <% if (item.profileImageUrl) { %>\n                                <img src="<%- item.faceThumb %>" width="40" height="40" alt="<%- item.name %>">\n                                <% } %>\n                            </span>\n                        </span>\n                    </span>\n                        <span class="text">\n                        <span class="ellipsis"><%- item.name %></span>\n                        <span class="sub2 -ellipsis"><%- item.desc %></span>\n                    </span>\n                    </a>\n                </li>\n                <% }); %>\n            </ul>\n        </div>\n\n    </div>\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2468),s=n(586),a=n(486),r=n(589),l=n(82),c=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DPostPollSubjectVotersView"},template:t.template(o),templateContext:{makeProfileImageUrl:function(e){return l.makeProfileThumbnailUrl(e)},makeProfileInnerClass:function(e){return l.makeProfileInnerClass(e)}},ui:{btnConfirm:"._btnConfirm",userItem:"._userItem",selectSort:"._selectSort"},events:{click:function(e){0==$(e.target).parents("._lyContent:first").length&&this.destroy()},"click @ui.btnConfirm":"destroy","click @ui.userItem":"_openProfileView","change @ui.selectSort":"_selectSort"},initialize:function(e){this._title=e.subjectTitle,this.selectedSortText="index"},serializeData:function(){var e=IM("web.voters.memberlist.order_type.date");return"name"==this.collection.comparator&&(e=IM("web.voters.memberlist.order_type.name")),{subjectTitle:this._title,subjects:this.collection.toJSON(),subjectsLength:this.collection.length,selectedSortText:e}},onRender:function(){"name"==this.collection.comparator&&this.getUI("selectSort").val(this.collection.comparator)},_selectSort:function(e){var t=$(e.currentTarget).val();return this.collection.comparator=t,this.collection.sort(),this.selectedSortText=t,this.render(),!1},_openProfileView:function(e){var t=$(e.currentTarget).data("index"),n=this.collection.at(t);return r.openProfileView(n.get("band_no"),n.get("user_no")),!1}}),d=Backbone.Model.extend({}),u=Backbone.Collection.extend({model:d,makeIndex:function(){for(var e=0,t=this.length;e<t;e++)this.models[e].set("index",e)},initialize:function(){}});return c.openMemberListV1=function(e,t,n,i){return s.getPollSubjectVotersV1(e,t,n).then((function(e){var t=new u(e),n=new c({collection:t,subjectTitle:i});t.makeIndex(),a.openWithoutHiding(n)}))},c.openMemberListV2=function(e,t,n,i,o){return s.getPollSubjectVotersV2(e,t,n,i).then((function(e){var t=new u(e),n=new c({collection:t,subjectTitle:o});t.makeIndex(),a.openWithoutHiding(n)}))},c}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w360 _lyContent">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM("web.postdetail.poll.label.voters") %> <%- subjectsLength %></h1>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap">\n            <p class="memberList"><%- subjectTitle %></p>\n\n            <div class="memberListStatusBar">\n                <p class="count"><%= IM("voters.memberlist") %> <span class="point"><%= subjectsLength %></span></p>\n                <div class="uSelect -textType -sizeS -h20">\n                    <label for="pollSort" class="gSrOnly"><%= selectedSortText %></label>\n                    <select id="pollSort" class="_selectSort">\n                        <option value="index"><%= IM("web.voters.memberlist.order_type.date") %></option>\n                        <option value="name"><%= IM("web.voters.memberlist.order_type.name") %></option>\n                    </select>\n                </div>\n            </div>\n\n            <ul class="listLine rScroll -h360">\n                <% _.each(subjects, function(subject, index) { %>\n                <li class="tLine">\n                    <a href="#" role="button" class="flexList _userItem" data-index="<%-index%>">\n                    <span class="thumb">\n                        <span class="uProfile -size40">\n                            <span class="profileInner <%- makeProfileInnerClass(subject.profile_image_url) %>">\n                                <img src="<%- makeProfileImageUrl(subject.profile_image_url) %>" width="40" height="40" alt="<%-subject.name%>">\n                            </span>\n                        </span>\n                    </span>\n                        <span class="text">\n                        <span class="ellipsis"><%-subject.name%></span>\n                        <span class="sub2"><%-subject.description%></span>\n                    </span>\n                    </a>\n                </li>\n                <% }); %>\n            </ul>\n        </div>\n\n    </div>\n\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -confirm _btnConfirm"><%-IM(\'ui.label.confirm\')%></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){n(2);var t=n(0),i=n(4),o=n(2470),s=n(82);return i.View.extend({tagName:"MAIN",className:"main",attributes:{"data-viewname":"DPostSignupPrintView"},template:t.template(o),templateContext:function(){return{makeProfileThumbnail:function(e){return s.makeProfileImageUrl(e)},isAnonymous:this._isAnonymous,title:this._title,subjects:this._subjects,remainedCount:this._remainedCount,remainedVoters:this._remainedVoters,remainedVoterShow:this._bandData.getBandCore().showRemainMemberAtPostPoll()}},initialize:function(e){this._bandData=e.bandData,this._isAnonymous=this.model.get("isAnonymous"),this._title=this.model.get("title"),this._subjects=this.model.get("subjects").toJSON(),this._remainedCount=this.model.get("remainMember").get("voterCount"),this._remainedVoters=this.model.get("remainMember").get("voters")},getTitle:function(){return this._title}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="rsvpDetail">\n    <% _.each(subjects, function(subject) { %>\n    <section class="type -poll">\n        <div class="titleWrap -poll">\n            <h3 class="title"><%- subject.title %> <span class="memberNum"><%- subject.voterCount %></span></h3>\n        </div>\n        <% if (!isAnonymous && (subject.voterCount!=0)) { %>\n            <ul class="memberList">\n                <% _.each(subject.voters, function(voter) { %>\n                <li class="memberItem">\n                    <span class="thumb"><img src="<%- makeProfileThumbnail(voter.profileImageUrl) %>" alt="<%- IM(\'voter.name\') %>"></span>\n                    <span class="txt">\n                        <strong class="name"><%- voter.name%></strong>\n                        <span class="info3"><%- voter.description %></span>\n                    </span>\n                </li>\n                <% }); %>\n            </ul>\n        <% } %>\n    </section>\n    <% }); %>\n    <% if(remainedVoterShow) {%>\n    <section class="type -poll">\n        <div class="titleWrap -poll">\n            <h3 class="title"><%- IM("ui.label.nonresponse_member") %> <span class="memberNum"><%- remainedCount %></span></h3>\n        </div>\n        <% if (!isAnonymous) { %>\n            <ul class="memberList">\n                <% _.each(remainedVoters, function(voter) { %>\n                <li class="memberItem">\n                    <span class="thumb -bgDisplay"><img src="<%- makeProfileThumbnail(voter.profileImageUrl) %>" alt="<%- IM(\'voter.name\') %>"></span>\n                    <span class="txt">\n                        <strong class="name"><%- voter.name%></strong>\n                        <span class="info3"><%- voter.description %></span>\n                    </span>\n                </li>\n                <% }); %>\n            </ul>\n        <% } %>\n    </section>\n    <% } %>\n</div>\n'},function(e,t,n){var i=n(0),o=n(1262);e.exports=function(e,t,n){o.setCreateAtToExcelData(n,e.get("createdAt"));var s=function(e,t){var n=e.get("remainMember"),s=[{A:IM("attachments.excel_download.header.created_date"),B:IM("attachments.excel_download.header.title"),C:IM("attachments.excel_download.header.poll.item_title"),D:IM("attachments.excel_download.header.poll.vote_count"),E:IM("attachments.excel_download.header.poll.member")}],a=o.formatStartAndEnd(e.get("createdAt"),e.get("endedAt"));return e.get("subjects").each((function(t){var n=t.get("voters")||{},o=t.get("title"),r=t.get("voterCount"),l=i.pluck(n,"name").join(",");s.push({A:1===s.length?a:"",B:e.get("title"),C:o,D:r,E:l})})),t&&n&&n.get("voterCount")>0&&s.push({A:1===s.length?a:"",B:e.get("title"),C:IM("ui.label.nonresponse_member"),D:n.get("voterCount"),E:e.get("isAnonymous")?"":i.pluck(n.get("voters"),"name").join(",")}),{name:e.get("title"),data:s,opts:{header:["A","B","C","D","E"],skipHeader:!0}}}(e,t.bandCore&&t.bandCore.showRemainMemberAtPostPoll());return o.addSheetToExcelData(n,s,t),n}},function(e,t,n){var i=n(4),o=n(2473),s=n(82),a=n(9),r=i.View.extend({options:{bandData:null,showPrintBtn:!1},tagName:"MAIN",className:"main gMat16",attributes:{"data-viewname":"DTodoPrintView"},template:_.template(o),templateContext:function(){return{makeProfileThumbnail:function(e){return s.makeProfileImageUrl(e)},bandName:this.options.bandData.getBandCore().name,bandCoverThumbnail:s.make(this.options.bandData.getBandCore().cover,s.TYPE.s75),showPrintBtn:this.options.showPrintBtn}},getTitle:function(){return this.model.get("title")},getDate:function(){return a.format.date(this.model.get("created_at"),"year_month_day")}});e.exports=r},function(e,t){e.exports='<% _.each(tasks, function(task) { %>\n<div class="titleWrap gMat40">\n    <h2 class="title"><%=task.subject %></h2>\n</div>\n    <% if (task.is_checked && task.actor) { %>\n<ul class="memberList gMat24">\n    <li class="memberItem">\n        <% if (task.actor.profile_image_url) { %>\n        <span class="thumb"><img src="<%-makeProfileThumbnail(task.actor.profile_image_url)%>" alt="<%-task.actor.name %>"></span>\n        <% } %>\n        <span class="txt">\n            <strong class="name"><%-task.actor.name %>\n                <% if (task.actor.role === \'leader\') { %>\n                <span class="leader"><img src="<%-resBaseUrl%>/images/common/ico_leader_x2.png" width="11" height="11" alt=""><span><%-IM("web.band.member.role.leader") %></span></span>\n                <% } else if (task.actor.role === \'coleader\') { %>\n                <span class="coleader"><img src="<%-resBaseUrl%>/images/common/ico_leader_x2.png" width="11" height="11" alt=""><span><%-IM("web.band.member.role.coleader") %></span></span>\n                <% } %>\n            </strong>\n            <% if (task.actor.description) { %>\n            <span class="info"><%-task.actor.description %></span>\n            <% } %>\n        </span>\n    </li>\n</ul>\n    <% } %>\n<% }); %>\n'},function(e,t,n){var i=n(0),o=n(1262),s=n(9);e.exports=function(e,t,n){o.setCreateAtToExcelData(n,e.get("created_at"));var a=function(e){var t=[{A:IM("attachments.excel_download.header.created_date"),B:IM("attachments.excel_download.header.title"),C:IM("attachments.excel_download.header.todo.item_title"),D:IM("attachments.excel_download.header.todo.member"),E:IM("attachments.excel_download.header.todo.checked_at")}];return i.each(e.get("tasks"),(function(n){var i=o.formatStartAndEnd(e.get("created_at"),e.get("ended_at"));t.push({A:1===t.length?i:"",B:e.get("title"),C:n.subject,D:n.is_checked?n.actor.name:"",E:n.is_checked?s.format.date(n.checked_at,"short_date_time"):""})})),{name:e.get("title"),data:t,opts:{header:["A","B","C","D","E"],skipHeader:!0}}}(e);return o.addSheetToExcelData(n,a,t),n}},function(e,t,n){var i=n(4),o=n(2476),s=n(82),a=n(578),r=n(9),l=i.View.extend({options:{bandData:null,showPrintBtn:!1},tagName:"MAIN",className:"main gMat16",attributes:{"data-viewname":"DBillSplitPrintItemView"},template:_.template(o),templateContext:function(){return{makeProfileThumbnail:function(e){return s.makeProfileImageUrl(e)},bandName:this.options.bandData.getBandCore().name,bandCoverThumbnail:s.make(this.options.bandData.getBandCore().cover,s.TYPE.s75),showPrintBtn:this.options.showPrintBtn,currencyLabel:a.getCurrencyLabel(this.model.get("currency")||"USD")}},getTitle:function(){return""},getDate:function(){return r.format.date(this.model.get("created_at"),"year_month_day")}});e.exports=l},function(e,t){e.exports='<div class="titleWrap gMat40">\n    <h2 class="title"><%=currencyLabel%> <%-total_price%> / <%= IM(\'web.postlist.billsplit.txt.member_count\', {count: member_count}) %></h2>\n</div>\n\n<ul class="flexList">\n    <% _.each(members, function(memberInfo) { %>\n    <li class="flexItem">\n        <span class="thumb">\n            <span class="uProfile -size50">\n                <span class="profileInner">\n                    <% if (memberInfo.member.profile_image_url) { %>\n                    <img src="<%-makeProfileThumbnail(memberInfo.member.profile_image_url) %>" width="50" height="50" alt="">\n                    <% } %>\n                </span>\n            </span>\n        </span>\n        <span class="text">\n            <strong class="labelTitle"><%-memberInfo.member.name %></strong>\n            <% if (memberInfo.member.description) { %>\n            <span class="labelDesc"><%-memberInfo.member.description %></span>\n            <% } %>\n        </span>\n        <span class="etc">\n            <em class="price"><%=currencyLabel%> <%-memberInfo.price %></em>\n            <em class="nStatus"><%-memberInfo.is_paid ? IM("attachments.value.bill_split.paid") : \'\' %></em>\n        </span>\n    </li>\n    <% }); %>\n</ul>\n'},function(e,t,n){var i=n(0),o=n(9),s=n(1262),a=n(16),r=n(578);e.exports=function(e,t,n){s.setCreateAtToExcelData(n,e.get("created_at"));var l=function(e){var t=[{A:IM("attachments.excel_download.header.created_date"),B:IM("attachments.excel_download.header.bill_split.member"),C:IM("attachments.excel_download.header.bill_split.price"),D:IM("attachments.excel_download.header.bill_split.is_paid")}];return i.each(e.get("members"),(function(n){var i,s=o.format.date(e.get("created_at"),"year_month_day");t.push({A:1===t.length?s:"",B:n.member.name,C:(i=e.get("currency"),("KRW"===i?"￦":r.getCurrencyLabel(i))+n.price),D:n.is_paid?IM("attachments.value.bill_split.paid"):""})})),{name:a(e.get("created_at")).format("YYYYMMDD"),data:t,opts:{header:["A","B","C","D"],skipHeader:!0}}}(e);return s.addSheetToExcelData(n,l,t),n}},function(e,t,n){var i;void 0===(i=function(e){n(2);var t=n(0),i=n(4),o=n(2479),s=(n(667),n(82)),a=n(9),r=(n(532),n(1643));return i.View.extend({tagName:"MAIN",className:"main",attributes:{"data-viewname":"DAttendanceCheckPrintView"},template:t.template(o),initialize:function(e){e.states?this._states=e.states.split(","):this._states=this.model.getSupportedStates(),this._bandData=e.bandData},serializeData:function(){return{states:this._states,attendeesGroup:this._getAttendeesGroup()}},_getAttendeesGroup:function(){return t.chain(this.model.get("attendees").models).filter(t.bind((function(e){return t.contains(this._states,e.getState())}),this)).map(t.bind((function(e){var n=e.get("attendee");return{name:n.get("name"),profile:s.makeProfileThumbnailUrl(n.get("profileImageUrl")),owner:n.get("childMembershipId")?IM("schedule.rsvp.state.change_actor",{actorName:t.escape(e.get("attendeeOwner").get("name"))}):null,checked:e.get("isChecked"),checkedAt:a.format.date(e.get("checkedAt"),"short_date_time"),desc:n.get("desc"),state:e.getState(),reasonText:this._getReasonText(e)}}),this)).groupBy((function(e){return e.state})).value()},_getReasonText:function(e){var t=e.getStateDescription();return t?e.getAttendee().isMyself()||this.model.isAttendanceCheckManager()?t:IM("attendance_check.exist_check_state_reason"):""},_getTimeZoneId:function(){return this.model.getTimeZoneId()||null},getTitle:function(){return this.model.get("title")},getStatus:function(){return{msg:IM("post.attendance_check.count",{done:Number(this.model.get("checkedAttendeeCount")).toString(),all:Number(this.model.get("attendeeCount")).toString()}),time:r.makeRemainingTimeText({startAt:this.model.getStartAt(),endedAt:this.model.getEndedAt(),timeZoneId:this._getTimeZoneId(),closedText:IM("todo.label.participation_ended")})}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="infoWrap">\n    <% _.each(states, function(state) { %>\n    <% if (_.size(attendeesGroup[state]) > 0) { %>\n    <div class="attendanceDetail">\n        <div class="titleWrap">\n            <h3 class="title"><%= IM(\'attendance_check.state.\' + state) %> <%= _.size(attendeesGroup[state]) %></h3>\n        </div>\n        <ul class="flexList -fdColumn">\n            <% _.each(attendeesGroup[state], function(attendee) { %>\n            <li class="flexItem">\n                <span class="thumb">\n                    <span class="uProfile -size50">\n                        <span class="profileInner">\n                            <img src="<%- attendee.profile %>" width="50" height="50" alt="<%- IM(\'photo\') %>">\n                        </span>\n                    </span>\n                </span>\n                <span class="text">\n                    <strong class="labelTitle"><%- attendee.name %></strong>\n                    <% if (attendee.owner) { %>\n                    <span class="labelDesc">\n                        <span class="memberType"><%- IM(\'web.common.child_member\') %></span><span class="name"><%= attendee.owner /* escaped string */ %></span>\n                    </span>\n                    <% } %>\n                    <% if (attendee.desc) { %>\n                    <span class="labelDesc"><%- attendee.desc %> </span>\n                    <% } %>\n                    <span class="labelDesc">\n                        <span class="reasonText"><%- attendee.reasonText %></span>\n                    </span>\n                </span>\n                <span class="etc">\n                    <% if (attendee.checked) { %>\n                    <span class="date"><%- attendee.checkedAt %></span>\n                    <% } %>\n                </span>\n            </li>\n            <% }); %>\n        </ul>\n    </div>\n    <% } %>\n    <% }); %>\n</div>\n'},function(e,t,n){var i=n(9),o=n(1262);n(532);function s(e,t){var n=e.getStateDescription();return n?e.getAttendee().isMyself()||t?n:IM("attendance_check.exist_check_state_reason"):""}e.exports=function(e,t,n){return o.setCreateAtToExcelData(n,e.get("createdAt")),"onesheet"===t.sheet?function(e,t,n){_.isEmpty(n)&&(n=t.getSupportedStates());var a=void 0;0===e.sheets.length&&(a={name:t.get("title"),data:[{A:IM("attachments.excel_download.header.title"),B:""},{A:IM("attachments.excel_download.header.attendance_check.period"),B:""},{A:"",B:""},{A:IM("attachments.excel_download.header.attendance_check.member"),B:IM("web.common.child_member")}],opts:{header:["A","B"],skipHeader:!0}},e.sheets.push(a),e.properties={userMap:{}});var r=[String.fromCharCode(65+e.sheets[0].opts.header.length),String.fromCharCode(66+e.sheets[0].opts.header.length),String.fromCharCode(67+e.sheets[0].opts.header.length)];e.sheets[0].opts.header.push(r[0]),e.sheets[0].opts.header.push(r[1]),e.sheets[0].opts.header.push(r[2]);var l=e.sheets[0].data;l[0][r[0]]=t.get("title"),l[0][r[1]]="",l[0][r[2]]="",l[1][r[0]]=o.formatAttachmentPeriod(t.get("createdAt"),t.getStartAt(),t.getEndedAt(),"date_time"),l[1][r[1]]="",l[1][r[2]]="",l[2][r[0]]="",l[2][r[1]]="",l[2][r[2]]="",l[3][r[0]]=IM("attendance_check.excel.column_title.selected_state"),l[3][r[1]]=IM("attendance_check.excel.column_title.selected_state_reason"),l[3][r[2]]=IM("attachments.excel_download.header.attendance_check.checked_at"),_.chain(t.get("attendees").models).filter((function(e){return _.contains(n,e.getState())})).each((function(n){var o=n.get("attendee"),a=o.get("childMembershipId"),c=n.get("isChecked"),d=a?[o.get("userNo"),o.get("childMembershipId")].join("-"):o.get("userNo");if(!e.properties.userMap[d]){e.properties.userMap[d]=l.length;var u={A:o.get("name"),B:a?IM("schedule.rsvp.excel_download.actor_name",{name:n.get("attendeeOwner").get("name")}):""},h=_.chain(_.range(2,e.sheets[0].opts.header.length-r.length)).map((function(e){return[String.fromCharCode(65+e),e%2==0?IM("attachments.value.attendance_check.not_memeber"):""]})).object().value();l.push(_.extend(u,h))}var p=l[e.properties.userMap[d]];p[r[0]]=IM("attendance_check.state."+n.getState()),p[r[1]]=s(n,t.isAttendanceCheckManager()),p[r[2]]=c?i.format.date(n.get("checkedAt"),"short_date_time"):""})).value();for(var c=3;c<l.length;c++){var d=l[c];d[r[0]]||(d[r[0]]=IM("attachments.value.attendance_check.not_memeber"))}}(n,e,t.states):n.sheets.push(function(e,t){_.isEmpty(t)&&(t=e.getSupportedStates());var n=[{A:IM("attachments.excel_download.header.title"),B:"",C:e.get("title"),D:"",E:""},{A:IM("attachments.excel_download.header.attendance_check.period"),B:"",C:o.formatAttachmentPeriod(e.get("createdAt"),e.getStartAt(),e.getEndedAt(),"date_time"),D:"",E:""},{A:"",B:"",C:"",D:"",E:""},{A:IM("attachments.excel_download.header.attendance_check.member"),B:IM("web.common.child_member"),C:IM("attendance_check.excel.column_title.selected_state"),D:IM("attendance_check.excel.column_title.selected_state_reason"),E:IM("attachments.excel_download.header.attendance_check.checked_at")}];return _.chain(e.get("attendees").models).filter((function(e){return _.contains(t,e.getState())})).each((function(t){var o=t.get("attendee"),a=o.get("childMembershipId"),r=t.get("isChecked");n.push({A:o.get("name"),B:a?IM("schedule.rsvp.excel_download.actor_name",{name:t.get("attendeeOwner").get("name")}):"",C:IM("attendance_check.state."+t.getState()),D:s(t,e.isAttendanceCheckManager()),E:r?i.format.date(t.get("checkedAt"),"short_date_time"):""})})).value(),{name:e.get("title"),data:n,opts:{header:["A","B","C","D","E"],skipHeader:!0}}}(e,t.states)),n}},function(e,t,n){var i;void 0===(i=function(e){n(2);var t=n(0),i=n(4),o=n(2482),s=n(82),a=n(9),r=n(43);return i.View.extend({tagName:"MAIN",className:"main",attributes:{"data-viewname":"DPostSignupPrintView"},template:t.template(o),initialize:function(e){var n=e.task||"",i=t.indexBy(n.split(","));this._bandData=e.bandData;var o=t.chain(this.model.getTaskGroups());n&&(o=o.filter((function(e){return e.tasks.some((function(e){return!!i[e.get("taskId")]}))}))),this._tasks=o.map((function(e){return e.tasks.map((function(n){var i=n.attributes;return{subject:i.subject,checkedAttendeeCount:i.checkedAttendeeCount,attendeeLimit:i.attendeeLimit,time:e.time,attendees:t.map(i.attendees,(function(e){return{name:e.name,description:e.description,profile:s.makeProfileThumbnailUrl(e.profileImageUrl)}}))}}))})).flatten(!0).value()},serializeData:function(){var e=this.model.get("startAt"),t=e?r.tz(e,this.model.get("timeZoneId")).format("YYYY-MM-DD"):null,n=this._bandData.getBandCore().showProfileAsPageStyle()?this._bandData.getBandCore().profileImage:this._bandData.getBandCore().cover;return{bandCover:s.make(n,s.TYPE.s75),bandName:this._bandData.getBandName(),title:this.model.get("title"),startDate:a.format.date(t,"year_month_day"),tasks:this._tasks,needShowPageProfileStyle:this._bandData.getBandCore().showProfileAsPageStyle()}},getTitle:function(){return this.model.get("title")},getDate:function(){return a.format.date(this.model.get("startAt"),"year_month_day")}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="rsvpDetail">\n    <% _.each(tasks, function(task) { %>\n    <section class="type -signup">\n        <div class="titleWrap -signup">\n            <h3 class="title"><%- task.subject %> <span class="memberNum"><%- task.checkedAttendeeCount %> / <%- task.attendeeLimit %></span></h3>\n            <% if (task.time) { %>\n            <p class="dateTime"><time><%- task.time %></time></p>\n            <% } %>\n        </div>\n\n        <ul class="memberList">\n            <% _.each(task.attendees, function(attendee) { %>\n            <li class="memberItem">\n                <span class="thumb"><img src="<%- attendee.profile %>" alt="<%- IM(\'photo\') %>"></span>\n                <span class="txt">\n                    <strong class="name"><%- attendee.name %></strong>\n                    <span class="info3"><%- attendee.description %></span>\n                </span>\n            </li>\n            <% }); %>\n        </ul>\n    </section>\n    <% }); %>\n</div>\n'},function(e,t,n){var i=n(0),o=n(1262);e.exports=function(e,t,n){o.setCreateAtToExcelData(n,e.get("createdAt"));var s=function(e,t){var n=[{A:IM("attachments.excel_download.header.created_date"),B:IM("attachments.excel_download.header.title"),C:IM("attachments.excel_download.header.sign_up.item_title"),D:IM("attachments.excel_download.header.sign_up.time"),E:IM("attachments.excel_download.header.sign_up.attendee_limit"),F:IM("attachments.excel_download.header.sign_up.member")}];return i.each(e.getTaskGroups(),(function(s){s.tasks.each((function(a){if(!t.taskIds||i.contains(t.taskIds,a.get("taskId"))){var r=a.attributes,l=o.formatStartAndEnd(e.get("startAt")||e.get("createdAt"),e.get("endedAt"));n.push({A:1===n.length?l:"",B:e.get("title"),C:r.subject,D:s.time,E:IM("signup.excel.attendee_count",{attendeeLimit:r.attendeeLimit,checkedAttendeeCount:r.checkedAttendeeCount||"0"}),F:i.pluck(r.attendees,"name").join(",")})}}))})),{name:e.get("title"),data:n,opts:{header:["A","B","C","D","E","F"],skipHeader:!0}}}(e,t);return o.addSheetToExcelData(n,s,t),n}},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(10),s=n(4),a=n(2485),r=n(1566),l=n(637),c=n(159),d=n(653),u=n(13),h=n(937),p=n(2038),m=n(2036),_=n(2037),g=n(26),f=n(523),b=n(1647),v=n(154),A=n(158),E=n(491),T=n(9),C=n(153),y=n(1567),M=n(1648),I=n(531),S=n(2040);return s.View.extend({options:{bandData:null,postModel:null},tagName:"div",className:"uWidget",attributes:{"data-viewname":"DPostScheduleDetailView","data-widget":"expanded"},behaviors:[c],onMessages:(t={},t[c.MSG.SCHEDULE_RSVP_CHANGED]=function(){g.getDGlobalChannel().trigger(g.EVENT.SCHEDULE_UPDATED,{bandNo:this._bandNo,exScheduleId:this.model.getScheduleId(),scheduleId:this.model.getScheduleId(),postDetailNoReload:!0})},t),getTemplate:function(){return this.model.isDelete()?i.template(r):i.template(a)},templateContext:function(){var e=this.model.getOwnerName(),t=this.model.getCalendar();t&&!t.isInternalCalendar()&&(e=t.getServiceProvider());var n=this.model.getStartAtMoment(),s={formattedCommentCount:o.numberFormat(this.model.get("commentCount")),scheduleCreatorName:e,remainingTimeMsg:this._getRemainingTimeMsg(),attendeeLimitMsg:this._getAttendeeLimitMsg(),day:o.lpad(n.format("D"),2,"0"),dayName:!!n&&n.format(T.isKoreanLanguage()?"dddd":"ddd"),scheduleDateTime:"",showSaveOrPrintSchedule:!!this.model.getScheduleId()&&this._bandData.canAccessCalendar(),scheduleDetailUri:this.model.getScheduleId()?C.GROUP_BAND_SCHEDULE.makeUrl({band_no:this._bandNo,schedule_id:this.model.getScheduleId()}):null,isTitledAsLocalMeetup:this.model.isLocalMeetup()&&this._bandData.canDisplayScheduleAsLocalMeetup()};return this.model.isDelete()||(s.htmlDescription=A.convertPostText(this.model.get("description")),s.hasRsvp=!i.isEmpty(this.model.getRsvp()),s.hasPhotoAttachment=!this.model.isEmptyPhotos(),s.hasFileAttachment=this.model.isNotEmptyAllFiles(),s.scheduleDateTime=d.multilineMessageForString(this.model.toJSON()),s.alarmMessage=this.model.get("alarms").getSortedAlarmMessage(this.model.get("startAt"),this.model.get("isAllDay")),s.hasAlarm=this.model.get("alarms").hasAlarm(),s.recurrenceInfo=this._getRecurrence(),s.location=this._getLocation(),s.isDetailEmpty=!(s.htmlDescription||s.hasRsvp||s.showSaveOrPrintSchedule||s.hasPhotoAttachment||s.hasPhotoAttachment||s.location)),s},ui:{rsvpRegion:"._rsvpRegion",photoCollageRegion:"._photoCollageRegion",fileRegion:"._fileRegion",attachmentSchedule:"._attachmentSchedule",postScheduleAttachedMap:"._postScheduleAttachedMap",btnSaveSchedule:"._btnSaveSchedule",btnPrintSchedule:"._btnPrintSchedule",btnScheduleSharer:"._btnScheduleSharer"},regions:{rsvpRegion:{el:"@ui.rsvpRegion",replaceElement:!0},photoCollageRegion:"@ui.photoCollageRegion",fileRegion:{el:"@ui.fileRegion",replaceElement:!0}},events:function(){return this._clickDisabledPostTypeOnDetail?{}:{"click @ui.attachmentSchedule":function(e){return this._openScheduleDetail(),!1},"click @ui.postScheduleAttachedMap":"_openMap","click @ui.btnSaveSchedule":"_onClickBtnSaveSchedule","click @ui.btnPrintSchedule":"_onClickBtnPrintSchedule","click @ui.btnScheduleSharer":"_showScheduleSharer"}},initialize:function(e){this.model=e.model.getFirstScheduleModel(),this._bandData=e.bandData,this._richPostModel=e.postModel,this._bandNo=e.bandNo,this._clickDisabledPostTypeOnDetail=e.clickDisabledPostTypeOnDetail},serializeData:function(){return this.model.toJSON()},onAttach:function(){this._showRsvpRegion(),this._showPhotoRegion(),this._showFileRegion(),this._listenToScheduleEvent()},_listenToScheduleEvent:function(){this.listenTo(g.getDGlobalChannel(),g.EVENT.SCHEDULE_DELETED,i.bind((function(e){this._triggerPostUpdatedByScheduleChanged(e.bandNo,e.scheduleId)}),this)),this.listenTo(g.getDGlobalChannel(),g.EVENT.SCHEDULE_UPDATED,i.bind((function(e){1!=e.postDetailNoReload&&this._triggerPostUpdatedByScheduleChanged(e.bandNo,e.exScheduleId)}),this))},_triggerPostUpdatedByScheduleChanged:function(e,t){e===this.model.getBandNo()&&t===this.model.getScheduleId()&&g.getPostChannel().trigger(g.EVENT.POST_UPDATED,this._richPostModel.getPostNo())},_getRecurrence:function(){var e=null;if(this.model.getRecurrence()){var t=this.model.getRecurrence(),n=this.model.getStartAtMoment(),i=this.model.isLunar();e={repeatMessage:t.getMessage(n,i)}}return e},_getLocation:function(){var e=null;return this.model.getLocation()&&!this.model.getLocation().isEmpty()&&((e=this.model.getLocation().toJSON()).staticMapUrl=l.getStaticMapUrl(e.latitude,e.longitude)),e},_showScheduleSharer:function(){S.openAsLayer({model:this.model,bandCore:this._bandData.getBandCore()})},_showRsvpRegion:function(){i.isEmpty(this.model.getRsvp())||this.showChildView("rsvpRegion",p.buildDScheduleRsvpView({model:this.model.getRsvp(),scheduleId:this.model.getScheduleId(),bandNo:this._richPostModel?this._richPostModel.getBandNo():this._bandNo,loginUserNo:u.getUserData().getUserNo(),isAuthor:!!this._richPostModel&&this._richPostModel.get("isAuthor"),isSecret:this.model.isSecret(),bandData:this._bandData,clickDisabledPostTypeOnDetail:this._clickDisabledPostTypeOnDetail}))},_getRemainingTimeMsg:function(){var e=this.model.getRsvp();if(!e||e.isEmpty())return null;var t=e.getEndedAt();if(null==t)return null;var n=f.getRemainingTime(t);return n.close?IM("schedule.rsvp.close_attendance_due_date"):IM("rsvp.label.remaining_time_format_"+n.format,{value:n.value})},_getAttendeeLimitMsg:function(){var e=this.model.getRsvp();return e&&e.getAttendeeLimit()?IM("schedule.rsvp.attendee_limit",{attendeeLimitCount:e.get("attendeeLimit")}):null},_showPhotoRegion:function(){var e=this.model.getPhotos();if(e){var t=e.toJSON(),n={photos:t,total_count:t.length};if(n.photos.length>0){for(var i=this._richPostModel?this._richPostModel.getBandNo():this._bandNo,o=this._richPostModel?this._richPostModel.getPostNo():null,s=this.model.getScheduleId(),a=this.model.getOwner(),r=this.model.getRecurrence(),l=0;l<n.photos.length;l++){var c=n.photos[l];c.photo_url=c.url,delete c.url}var d={bandNo:i,postNo:o,scheduleId:s,photos:n,reportSupport:!0,owner:a,recurrence:r};this.getUI("photoCollageRegion").show();var u=m.buildDSchedulePhotoCollageView(d);this.showChildView("photoCollageRegion",u)}}},_showFileRegion:function(){if(this.model.isNotEmptyAllFiles()){var e=this._richPostModel?this._richPostModel.getBandNo():this._bandNo,t=_.buildDScheduleFileListView(e,this.model.getDropboxFiles(),this.model.getExternalFiles(),this.model.getFiles(),this._clickDisabledPostTypeOnDetail);this.showChildView("fileRegion",t)}},_openScheduleDetail:function(){!this.model.isDelete()&&this._bandData.canAccessCalendar()&&h.openScheduleDetailLayerView({bandNo:this._richPostModel.getBandNo(),scheduleId:this.model.getScheduleId()})},_openMap:function(){var e=this.model.getLocation(),t=e.get("latitude"),n=e.get("longitude"),i=l.getLargeMapUrl(t,n);return window.open(i,"_blank"),!1},_onClickBtnSaveSchedule:function(){this._fetchProgress||(this._fetchProgress=!0,v.wrapActivePromise(E.getCachedBandData(this._richPostModel.getBandNo()),this).then(i.bind((function(e){var t={bandData:e,isDetailView:!0,detailViewModel:this.model,calendarInfo:this.model.getCalendar()};b.openAsLayer(t)}),this)).always(i.bind((function(){this._fetchProgress=!1}),this)))},_onClickBtnPrintSchedule:function(){var e={bandNo:this._richPostModel.getBandNo(),scheduleId:this.model.getScheduleId()},t=this.model.getRsvp();if(t){var n=M.openAsLayer(I.RSVP.EXPORT_TYPE.PRINT,t.isMaybeEnabled(),t.getCustomRsvpStatusList());this.listenTo(n,"selected:item",(function(t){e.params={selectedRsvpInfo:t},y.openPrintWin(e)}))}else y.openPrintWin(e)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="item -calendar">\n    \x3c!-- 일정 Title 정보 --\x3e\n    <div class="addHead scheduleHead">\n        <span class="day">\n            <strong class="date"><%- day %></strong>\n            <span class="week sf_color"><%- dayName %></span>\n        </span>\n\n        <div class="contWrap">\n            <div class="scheduleContWrap">\n                <h2 class="title"><%- name %></h2>\n                <time class="date"><%= scheduleDateTime %></time>\n            </div>\n\n            <% // RSVP > 참석 종료일 및 참석 제한 인원 정보 %>\n            <% if (remainingTimeMsg || attendeeLimitMsg) { %>\n            <div class="scheduleContWrap data">\n                <% if (remainingTimeMsg) { %>\n                <span class="dataPeriod sf_color"><%= remainingTimeMsg %></span>\n                <% } %>\n                <% if (attendeeLimitMsg) { %>\n                <span class="dataMember sf_color"><%= attendeeLimitMsg %></span>\n                <% } %>\n            </div>\n            <% } %>\n\n            <% if (hasAlarm || recurrenceInfo) { %>\n            <div class="scheduleContWrap">\n                <% if (hasAlarm) { %>\n                <span class="notiPush"><%= alarmMessage %></span>\n                <% } %>\n                <% if (recurrenceInfo) { %>\n                <span class="repeat"><%- recurrenceInfo.repeatMessage %></span>\n                <% } %>\n            </div>\n            <% } %>\n\n\n\n            <% if (commentCount > 0) { %>\n            <div class="scheduleContWrap gMat7">\n                <a href="<%- scheduleDetailUri %>" class="scehduleCommentLink _attachmentSchedule">\n                    <span class="scheduleCommentInfo">\n                        <span class="scheduleCommentLabel"><%- IM(\'schedule.comment\') %></span>\n                        <span class="scheduleCommentValue sf_color"><%- formattedCommentCount %></span>\n                    </span>\n                </a>\n            </div>\n            <% } %>\n        </div>\n        <% if (scheduleDetailUri) { %>\n        <a href="<%- scheduleDetailUri %>" role="button" class="scehduleDetailLink _attachmentSchedule"></a>\n        <% } %>\n    </div>\n\n    <% if (!isDetailEmpty) { %>\n    \x3c!-- 일정 상세 정보  --\x3e\n    <div class="addDetail">\n        <div class="scheduleContWrap <%= !!calendar ? \'scheduleName\' : \'\' %>">\n            <% if (!!calendar) { %>\n            <span class="scehduleColor <%= !calendar.color ? \'sf_bg\' : \'\' %>" <%= !!calendar.color ? \'style="background:#\' + calendar.color + \'"\' : \'\' %>></span>\n            <span class="calendarName"><%- calendar.name %></span>\n            <% } %>\n            <% if (isTitledAsLocalMeetup) { %>\n            <span class="isOpenMeetup"><%- IM("schedule.local_meetup") %></span>\n            <% } %>\n            <span class="hostName"><%- scheduleCreatorName %></span>\n        </div>\n        <% if (isSecret) { %>\n        <div class="scheduleIsDisclosedWrap">\n            <button class="btnScheduleDisclosedMessage _btnScheduleSharer"><%= IM("schedule.secret.check_member.btn") %></button>\n        </div>\n        <% } %>\n        <% // 일정의 설명 %>\n        <% if (!!htmlDescription) { %>\n        <p class="bodyText"><%= htmlDescription %></p>\n        <% } %>\n\n        <% // RSVP %>\n        <% if (hasRsvp) { %>\n        <div class="_rsvpRegion" style="display: none;"></div>\n        <% } %>\n\n        <% // 일정 저장하기 %>\n        <% if (showSaveOrPrintSchedule) { %>\n        <div class="scheduleBottomBtns">\n            <button type="button" class="uButton -sizeL -save sf_color sf_tBorder _btnSaveSchedule">\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-down-15"></use>\n                </svg>\n                <%= IM("schedule.detail.button.save_schedule") %>\n            </button>\n\n            <button type="button" class="uButton -sizeL -cancel -w40 btnPrintSchedule _btnPrintSchedule">\n                <span class="gSrOnly"><%-IM("schedule.button.print_schedule") %></span>\n            </button>\n        </div>\n        <% } %>\n\n        <% // 첨부 사진 %>\n        <% if (hasPhotoAttachment) { %>\n        <div class="_photoCollageRegion photoArea" style="display: none;"></div>\n        <% } %>\n\n        <% // 첨부 파일 %>\n        <% if (hasFileAttachment) { %>\n        <div class="_fileRegion" style="display: none;"></div>\n        <% } %>\n\n        <% // 지도 %>\n        <% if (!!location) { %>\n        <div class="scheduleLocation _postScheduleAttachedMap">\n            <div class="mapLink">\n                    <span class="icon">\n                        <svg class="svgIcon sf_color" aria-hidden="true">\n                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-map-14"></use>\n                        </svg>\n                    </span>\n                <a href="#" class="text"><%- location.name || location.address %></a>\n            </div>\n            <a href="#" class="imgLink">\n                <div class="mapImage"><img src="<%- location.staticMapUrl %>" width="100%" alt="<%- location.name || location.address %>"></div>\n            </a>\n        </div>\n        <% } %>\n\n    </div>\n    <% } // end of if (isDetailEmpty) %>\n</div>'},function(e,t){e.exports='<div class="<%- lyClass() %> _scheduleArticle _lyContent" >\n    <% if (showBandNameTitle) { %>\n    <h2 class="feedTitBand">\n        <a href="<%- bandUrl %>" class="tit">\n            <% if (band.certified) { %><span class="uOfficialBand -sizeS"><%= IM(\'ui.official_band\') %></span><% } %><%- band.name %>\n        </a>\n    </h2>\n    <% } %>\n    <div class="scheduleSectionArea _scheduleRegion"></div>\n\n    <div class="scheduleCommentView _fixedCommentCountArea">\n        <div class="postCountLayer">\n            <div class="faceComment">\n                <button type="button" class="comment _writeCommentBtn"><%- IM(\'web.postdetail.comment.title\') %></button><button type="button" class="count -commentCount _goCommentAreaBtn _commentCountText"><%- commentCount %></button>\n            </div>\n        </div>\n    </div>\n    <div class="cScheduleCommentInfo _commentCountArea" >\n        <h2 class="cScheduleCommentTitle">\n            <span class="cScheduleCommentLabel"><%- IM(\'schedule.comment\') %></span>\n            <span class="cScheduleCommentValue _commentCountText"><%- commentCount %></span>\n        </h2>\n    </div>\n\n    <div class="scheduleCommentArea _commentRegion"></div>\n\n    <% if (showBtnGotoTop) { %>\n    <button type="button" class="uBtnGoToTop -scheduleViewer _btnGoToTop"><span class="gSrOnly"><%- IM(\'ui.label.go_to_top\') %></span></button>\n    <% } %>\n</div>\n'},function(e,t){e.exports='<div class="<%- lyClass() %> _scheduleArticle _lyContent">\n    <header class="gSrOnly">\n        <h1><%=IM("schedule.detail.title")%></h1>\n    </header>\n    <div class="main"><%=loadingContent %></div>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(16),s=n(4),a=n(2489),r=n(653),l=n(1644),c=n(526),d=n(545),u=n(2033),h=n(26),p=n(13),m=n(158),_=n(154),g=(n(549),n(2036)),f=n(2496),b=n(2037),v=n(2499),A=n(2038),E=n(2516),T=n(2006),C=n(849),y=n(2518),M=n(159),I=n(1567),S=n(2520),w=n(9),N=n(487),D=n(1648),L=n(531),O=n(2040),P=s.View.extend({attributes:{"data-viewname":"DScheduleView"},behaviors:function(){return[M,{behaviorClass:u,moreOptionListRegionName:"moreOptionListRegion",moreOptionList:[u.SCHEDULE_MORE_OPTION.MODIFY,u.SCHEDULE_MORE_OPTION.SEND_AN_ALERT,u.SCHEDULE_MORE_OPTION.WRITE_POST,u.SCHEDULE_MORE_OPTION.COPY,u.SCHEDULE_MORE_OPTION.COPY_URL,u.SCHEDULE_MORE_OPTION.EXPORT,u.SCHEDULE_MORE_OPTION.REPORT,u.SCHEDULE_MORE_OPTION.DELETE,u.SCHEDULE_MORE_OPTION.SET_ALARM],scheduleModel:this.options.model},N]},onMessages:(t={},t[M.MSG.SCHEDULE_WRITE_LINKED_POST]=function(){this._canNotUseScheduleFunctions()||this.trigger(u.LISTENING_EVENTS.DO_ACTION,u.SCHEDULE_MORE_OPTION.WRITE_POST.id)},t[M.MSG.SCHEDULE_RSVP_CHANGED]=function(){h.getDGlobalChannel().trigger(h.EVENT.SCHEDULE_UPDATED,{bandNo:this.model.get("bandNo"),exScheduleId:this.model.getScheduleId(),scheduleId:this.model.getScheduleId(),scheduleDetailNoReload:!0})},t),templateContext:function(){var e=this._getCalendarInfo(),t=!!this.model.get("location"),n=l.getRsvpRemainingTimeMsg(this.model.getRsvp()),i=l.getRsvpAttendeeLimitMsg(this.model.getRsvp()),s=w.isKoreanLanguage()?"dddd":"ddd";return{scheduleDay:o(this.model.get("startAt")).format("DD"),scheduleDayName:o(this.model.get("startAt")).format(s),calendarInfo:e,hasAlarm:!this.model.get("alarms").isEmpty(),hasRepeat:this.model.has("recurrence"),alarmMessage:this.model.get("alarms").getSortedAlarmMessage(this.model.get("startAt"),this.model.get("isAllDay")),repeatMessage:this.model.has("recurrence")?this.model.get("recurrence").getMessage(this.model.getStartAtMoment(),this.model.get("isLunar")):"",hasLocation:t,ScheduleType:c,userNo:p.getUserData().getUserNo(),htmlDescription:m.convertPostText(this.model.get("description")),isMemberSelectableForChat:this.bandData.isMemberSelectableForChat(),msg_remainingTime:n,msg_attendeeLimit:i,hasRsvp:this.model.hasRsvp(),scheduleTimeHtml:this._makeSchedulePeriodHtml(),isTitledAsLocalMeetup:this.model.isLocalMeetup()&&this.bandData.canDisplayScheduleAsLocalMeetup()}},ui:{moreButton:"._moreButton",btnSaveSchedule:"._btnSaveSchedule",btnPrintSchedule:"._btnPrintSchedule",btnModifiedSchedule:"._btnModifiedSchedule",scheduleHead:"._scheduleHead",moreOptionListRegion:"._moreOptionListRegion",photoCollageRegion:"._photoCollageRegion",locationRegion:"._locationRegion",fileRegion:"._fileRegion",birthdayUsersRegion:"._birthdayUsersRegion",rsvpRegion:"._rsvpRegion",personalAlarmRegion:"._personalAlarmRegion",btnClose:"._btnClose",linkedPostInfoRegion:"._linkedPostInfoRegion",btnScheduleSelectMember:"._btnScheduleSelectMember"},regions:{moreOptionListRegion:"@ui.moreOptionListRegion",photoCollageRegion:"@ui.photoCollageRegion",locationRegion:{el:"@ui.locationRegion",replaceElement:!0},fileRegion:"@ui.fileRegion",birthdayUsersRegion:{el:"@ui.birthdayUsersRegion",replaceElement:!0},rsvpRegion:{el:"@ui.rsvpRegion",replaceElement:!0},personalAlarmRegion:{el:"@ui.personalAlarmRegion",replaceElement:!0},linkedPostInfoRegion:{el:"@ui.linkedPostInfoRegion",replaceElement:!0}},events:{"click @ui.moreButton":function(e){e.stopPropagation(),this.getRegion("moreOptionListRegion").hasView()?this._hideMoreOptionList():(h.getDGlobalChannel().trigger(h.EVENT.HTML_CLICK),this._showMoreOptionList())},"click @ui.btnClose":"_notifyDestroy","click @ui.btnSaveSchedule":function(){this.trigger(u.LISTENING_EVENTS.DO_ACTION,u.SCHEDULE_MORE_OPTION.EXPORT.id)},"click @ui.btnPrintSchedule":"_onClickBtnPrintSchedule","click @ui.btnModifiedSchedule":"_showScheduleHistory","click @ui.btnScheduleSelectMember":"_showSelectedMember"},initialize:function(e){this.bandData=e.bandData,this._postNo=e.postNo,this._scrollToFileOnInit=e.scrollToFile,this._token=e.token},getTemplate:function(){return i.template(a)},serializeData:function(){return this.model.toJSON()},onRender:function(){if(this.model.isNotEmptyPhotos()){var e=this.model.get("bandNo"),t=this._postNo?this._postNo:"",n=this.model.get("photos").toJSON(),o=T.convertPhotosForImageViewer(n,this.model.getOwner().toJSON()),s={bandNo:e,postNo:t,scheduleId:this.model.get("scheduleId"),photos:o,reportSupport:!0,owner:this.model.getOwner(),recurrence:this.model.get("recurrence")};this.getUI("photoCollageRegion").show();var a=g.buildDSchedulePhotoCollageView(s);this.showChildView("photoCollageRegion",a)}if(this.model.isNotEmptyAllFiles()){var r=b.buildDScheduleFileListView(this.model.getBandNo(),this.model.getDropboxFiles(),this.model.getExternalFiles(),this.model.getFiles());this.showChildView("fileRegion",r),this.getUI("fileRegion").show(),this._scrollToFile()}if(this.model.get("location")&&this.showChildView("locationRegion",f.buildDScheduleLocationView(this.model.get("location"))),this.model.get("birthdayUsers").isEmpty()||this.showChildView("birthdayUsersRegion",v.buildDScheduleBirthdayMemberListView(this.model.get("birthdayUsers"),{isMemberSelectableForChat:this.bandData.isMemberSelectableForChat()})),!i.isEmpty(this.model.get("rsvp"))){var l=A.buildDScheduleRsvpView({model:this.model.get("rsvp"),scheduleId:this.model.get("scheduleId"),bandNo:this.model.get("bandNo"),loginUserNo:p.getUserData().getUserNo(),isAuthor:this.model.get("owner").get("userNo")==p.getUserData().getUserNo(),isSecret:this.model.isSecret(),bandData:this.bandData});this.showChildView("rsvpRegion",l)}this.model.get("scheduleType")!=c.NORMAL&&this.model.get("scheduleType")!=c.EXTERNAL||this._canNotUseScheduleFunctions()||(this._personalAlarmView=E.build({scheduleModel:this.model}),this.showChildView("personalAlarmRegion",this._personalAlarmView)),this._renderLinkedPostArea()},onAttach:function(){this._initMoreOptionButton(),this.listenTo(h.getDGlobalChannel(),h.EVENT.HTML_CLICK,this._hideMoreOptionList)},_resetModelAndRender:function(){this.trigger(u.LISTENING_EVENTS.RESET_SCHEDULE_INFO,this.model),this.render()},fetchScheduleAndRender:function(e){return this.model.setScheduleIdSilently(e),this.model.clearEditableAttrsSilently(),_.wrapActivePromise(this.model.fetchSchedule(),this).then(i.bind(this._resetModelAndRender,this))},getScheduleHeadHeight:function(){return this.ui.scheduleHead.outerHeight()},_scrollToFile:function(){this._scrollToFileOnInit&&_.wrapActiveSetTimeout(200,this).then(i.bind((function(){this.getUI("fileRegion")[0].scrollIntoView(!1),this._scrollToFileOnInit=!1}),this))},_getCalendarInfo:function(){var e=null;return this.model.get("calendar")&&(e={isInternalCalendar:this.model.get("calendar").get("type")==d.TYPE.INTERNAL,name:this.model.get("calendar").get("name"),color:this.model.get("calendar").get("color"),serviceProvider:this.model.get("calendar").get("serviceProvider")?this.model.get("calendar").get("serviceProvider"):""}),e},_initMoreOptionButton:function(){this.listenTo(this,u.TRIGGERING_EVENTS.SCHEDULE_INFO_UPDATED,(function(e){this.model.isDelete()||(i.isEmpty(e)?this.getUI("moreButton").hide():this.getUI("moreButton").show())}))},_showMoreOptionList:function(){this.getUI("moreOptionListRegion").addClass("lyMenu"),this.trigger(u.LISTENING_EVENTS.OPTION_LIST_OPEN)},_hideMoreOptionList:function(){this.getUI("moreOptionListRegion").removeClass("lyMenu"),this.trigger(u.LISTENING_EVENTS.OPTION_LIST_CLOSE)},_onClickBtnPrintSchedule:function(){var e={bandNo:this.model.getBandCore().bandNo,scheduleId:this.model.getScheduleId(),params:{token:this._hasSpecialLinkOrCanUseSchedule()?this._token:null}};if(this.model.get("rsvp")){var t=D.openAsLayer(L.RSVP.EXPORT_TYPE.PRINT,this.model.get("rsvp").isMaybeEnabled(),this.model.get("rsvp").getCustomRsvpStatusList(),this.model.getBandCore().getSkinColorClass());this.listenTo(t,"selected:item",(function(t){e.params={selectedRsvpInfo:t},I.openPrintWin(e)}))}else I.openPrintWin(e)},_showScheduleHistory:function(){if(this._canNotUseScheduleFunctions())return!1;y.openAsLayer({bandNo:this.model.get("bandNo"),scheduleId:this.model.get("scheduleId")})},_showSelectedMember:function(){O.openAsLayer({model:this.model,bandCore:this.bandData.getBandCore()})},_notifyDestroy:function(){this.spawn(M.MSG.SCHEDULE_CLOSE_LAYER)},_renderLinkedPostArea:function(){var e=S.buildDScheduleLinkedPostInfoView({bandNo:this.model.get("bandNo"),scheduleId:this.model.getScheduleId(),linkedPostModel:this.model.get("linkedPost"),hasMoreLinkedPosts:this.model.get("hasMoreLinkedPosts")});this.showChildView("linkedPostInfoRegion",e)},_hasSpecialLinkOrCanUseSchedule:function(){return!!this.options.token||this.bandData.getBandCore().supportSchedule()},_canNotUseScheduleFunctions:function(){return!this.bandData.canUseScheduleFunctions()},_makeSchedulePeriodHtml:function(){var e=r.multilineMessage(this.model.toJSON()),t=this._makePeriodHtml(e);if(!this.model.hasDifferentTimezone()||this.model.isAllDay())return t;var n=r.multilineMessage(this.model.toJSON(),{timeZone:this.model.getScheduleTimeZoneId()}),i=" (GMT"+this.model.getStartAtMoment().format("Z")+")";return t+this._makePeriodHtml(n,i)},_makePeriodHtml:function(e,t){t=t||"";var n=e[0],i=e[1];switch(this.model.getScheduleType()){case c.NORMAL:case c.EXTERNAL:case c.HOLIDAY:return this._wrapDateTextInTimeTag(n+" "+i+t);case c.BIRTHDAY:case c.BAND_OPEN:return this._wrapDateTextInTimeTag(n+t)}return""},_wrapDateTextInTimeTag:function(e){return'<time class="date">'+e+"</time>"},moveToMemberTab:function(){this.spawn(M.MSG.SCHEDULE_GO_MEMBER_TAB)}});return P.buildDScheduleView=function(e){return new P({model:e.model,bandData:e.bandData,postNo:e.postNo||!1,scrollToFile:e.scrollTo==C.FILE,token:e.token})},P}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<header class="gSrOnly">\n    <h1><%=IM("schedule.detail.title")%></h1>\n</header>\n<div class="main">\n    <div class="cScheduleView">\n        <div class="scheduleHead _scheduleHead">\n            <span class="day">\n                <strong class="date"><%- scheduleDay %></strong>\n                <span class="week sf_color"><%- scheduleDayName %></span>\n            </span>\n\n            <div class="contWrap">\n                <h2 class="title"><%- name %></h2>\n            <%= scheduleTimeHtml %>\n            <% if (calendarInfo) { %>\n            <%\n                var writer = \'\';\n\n                if (calendarInfo.isInternalCalendar && owner) {\n                    writer = owner.name;\n                } else if (!calendarInfo.isInternalCalendar && calendarInfo.serviceProvider != \'\') {\n                    writer = calendarInfo.serviceProvider;\n                }\n            %>\n                <div class="scheduleContWrap scheduleName">\n                <% if (calendarInfo.color) { %>\n                    <span class="scehduleColor" style="background:#<%- calendarInfo.color %>"></span>\n                <% } else { %>\n                    <span class="scehduleColor sf_bg"></span>\n                <% } %>\n                    <span class="calendarName"><%- calendarInfo.name %></span>\n                <% if (isTitledAsLocalMeetup) { %>\n                    <span class="isOpenMeetup"><%= IM("schedule.local_meetup") %></span>\n                <% } %>\n                    <span class="hostName"><%- writer %></span>\n                </div>\n            <% } %>\n            <% if (hasAlarm || hasRepeat) { %>\n                <div class="scheduleContWrap">\n                <% if (hasAlarm) { %>\n                    <span class="notiPush"><%= alarmMessage %></span>\n                <% } %>\n                <% if (hasRepeat) { %><span class="repeat"><%=repeatMessage %></span><% } %>\n                </div>\n            <% } %>\n            <% if (isUpdated) { // 일정의 수정 내역 조회 %>\n                <a href="#" role="button" class="btnModified _btnModifiedSchedule"><%= IM("schedule.detail.text.modify_schedule") %></a>\n            <% } %>\n            </div>\n        <%\n            // 일반 일정이거나 외부 캘린더 구독인 경우만 옵션 버튼을 노출한다.\n            if (scheduleType == ScheduleType.NORMAL || scheduleType == ScheduleType.EXTERNAL) {\n        %>\n            <div class="option">\n                <button type="button" class="postSet _moreButton" style="display: none;"><%=IM("schedule.detail.button.more") %></button>\n                <div class="_moreOptionListRegion"></div>\n            </div>\n        <%\n            }\n        %>\n        </div>\n\n        <div class="scheduleMain">\n            <% if (isSecret) { %>\n            <div class="scheduleIsDisclosedWrap">\n                <button class="btnScheduleDisclosedMessage _btnScheduleSelectMember"><%= IM("schedule.secret.check_member.btn") %></button>\n            </div>\n            <% } %>\n            <% // 참석 종료일 및 참석 제한 인원 정보 %>\n            <% if (msg_remainingTime || msg_attendeeLimit) { %>\n            <div class="noti sf_color">\n                <% if (msg_remainingTime) { %><span><%= msg_remainingTime %></span><% } %>\n                <% if (msg_attendeeLimit) { %><span><%= msg_attendeeLimit %></span><% } %>\n            </div>\n            <% } %>\n\n        <% if(htmlDescription && htmlDescription != \'\') { %>\n            <p class="bodyText">\n                <%= htmlDescription %>\n            </p>\n        <% } %>\n\n            <% // RSVP %>\n            <div class="_rsvpRegion" style="display: none;"></div>\n\n            <div class="_birthdayUsersRegion" style="display: none;"></div>\n\n            <% // 개인별 미리 알림 %>\n            <div class="_personalAlarmRegion" style="display: none;"></div>\n\n            <div class="scheduleBottomBtns">\n                <button type="button" class="uButton -sizeL -save sf_color sf_tBorder _btnSaveSchedule">\n\n                    <svg class="svgIcon" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-down-15"></use>\n                    </svg>\n                    <%=IM("schedule.detail.button.save_schedule") %>\n                </button>\n                <button type="button" class="uButton -sizeL -cancel -w40 btnPrintSchedule _btnPrintSchedule">\n                    <span class="gSrOnly"><%-IM("schedule.button.print_schedule") %></span>\n                </button>\n            </div>\n            <div class="_photoCollageRegion photoArea" style="display: none;"></div>\n            <div class="_fileRegion" style="display: none;"></div>\n            <div class="_locationRegion" style="display: none;"></div>\n            <div class="_linkedPostInfoRegion" style="display: none;"></div>\n       </div>\n    </div>\n</div>\n\n<button type="button" class="btnCloseLyPost _btnClose"><span class="gSrOnly"><%- IM("ui.label.close_layer") %></span></button>'},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent">\n        <header class="header -noTitlebar">\n            <h1 class="title"><%= title %></h1>\n        </header>\n        <div class="main">\n            <div class="selectArea">\n                <label for="checkbox" class="uCheck -checkbox">\n                    <input type="checkbox" id="checkbox" class="checkInput _checkInput">\n                    <span class="checkLabel">\n                        <span class="shape "></span>\n                        <span class="text"><%= checkMessage %></span>\n                    </span>\n                </label>\n            </div>\n        </div>\n        <footer class="footer">\n            <button type="button" class="uButton -cancel _btnCancel"><%= IM("ui.label.cancel") %></button>\n            <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n        </footer>\n    </div>\n</section>'},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="header">\n        <h1 class="title"><%-msg_title%></h1>\n    </header>\n    <div class="main">\n        <% if ( !isDetailView ) { %>\n        <p class="p"><%=IM(\'bandsetting.calendar_url.guide.description\')%></p>\n        <% } %>\n\n        <p class="sDesc gMat4"><%=msg_desc%></p>\n\n        <ul class="boxList -icon gMat10">\n            <li><a href="<%- msg_icalUrl %>" class="btnWebcal <%-osName%> _btnWebcal">\n                <% if ( osName === \'mac\' || osName === \'ios\' ) { %>\n                    <%-IM(\'calendar.export.service.btn_open_label\', {service: \'Apple\'})%>\n                <% } else { %>\n                    <%-IM(\'calendar.export.service.btn_open_label\', {service: \'Outlook\'})%>\n                <% } %>\n            </a></li>\n            <% if( (countryCode === "KR" || languageCode === "ko") && naverCalendarUrl !== null ) { %>\n            <li><a href="<%- naverCalendarUrl %>" class="btnNaver _btnNaver" target="_blank"><%-IM(\'calendar.export.service.btn_label\', {service: naverTxt})%></a></li>\n            <% } %>\n            <li><a href="<%- googleCalendarUrl %>" class="btnGoogle" target="_blank"><%-IM(\'calendar.export.service.btn_label\', {service: \'Google\'})%></a></li>\n            <% if( countryCode !== "JP" || languageCode !== "ja" ) { %>\n            <li><a href="<%- outlookCalendarUrl %>" class="btnOutlook" target="_blank"><%-IM(\'calendar.export.service.btn_label\', {service: \'Outlook\'})%></a></li>\n            <% } %>\n            <% if( countryCode === "EN" || languageCode === "en" || countryCode === "TW" || languageCode === "zh-TW" ) { %>\n            <li><a href="<%- yahooCalendarUrl %>" class="btnYahoo" target="_blank"><%-IM(\'calendar.export.service.btn_label\', {service: \'Yahoo\'})%></a></li>\n            <% } %>\n        </ul>\n\n        <% if ( !isDetailView ) { %>\n            <div class="scheduleUrlCopy">\n                <h1 class="title"><%-IM(\'calendar.export.url_copy.title\')%></h1>\n                <div class="urlTextWrap">\n                    <span class="urlText">\n                        <input value="<%- msg_icalUrl %>" readonly>\n                    </span>\n                    <% if (isClipboardSupported) { %>\n                    <span class="btnCopyUrlText">\n                        <button type="button" class="_btnCopyUrlText" data-clipboard-text="<%- msg_icalUrl %>"><%-IM(\'ui.label.copy2\')%></button>\n                    </span>\n                    <% } %>\n                </div>\n\n                <% if (msg_isAlreadyCreated) { %>\n                <p class="desc">\n                    <%-IM(\'bandsetting.calendar_url.delete_guide1\')%> <a href="#" role="button" class="_btnDeleteUrl"><%-IM(\'bandsetting.calendar_url.delete_guide2\')%></a>\n                </p>\n                <% } %>\n            </div>\n            <dl class="urlCopyGuide">\n                <dt class="title"><%- IM(\'calendar.url_copy.guide1.title\') %></dt>\n                <dd class="desc"><%= IM(\'calendar.url_copy.guide1.desc\') %></dd>\n                <dt class="title"><%- IM(\'calendar.url_copy.guide2.title\') %></dt>\n                <dd class="desc"><%- IM(\'calendar.url_copy.guide2.desc\') %></dd>\n            </dl>\n        <% } %>\n\n        <% if ( isDetailView ) { %>\n        <p class="gTaC gMat20 gMab16 gColorBk1 gFs13">\n            <button class="uButton -textUnderline _btnDownloadICal"><%-IM(\'calendar.export.download_ical\')%></button>\n        </p>\n        <% } %>\n    </div>\n    <footer class="footer -h0">\n        <button type="button" class="uButton -iconClose btnLyClose _btnClose"><span class="gSrOnly"><%-IM("ui.label.close")%></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(593),s=n(2004),a=n(2493),r=t.View.extend({className:"gMat4",attributes:{"data-viewname":"DScheduleAlarmOptionListView"},template:i.template(a),ui:{radioAlarmValue:"._radioAlarmValue",customAlarmRegion:"._customAlarmRegion"},regions:{customAlarmRegion:{el:"@ui.customAlarmRegion",replaceElement:!1}},events:{"click @ui.radioAlarmValue":"_selectAlarmValue"},initialize:function(e){this.model=e.model,this.isAllDay=e.isAllDay,this.alarms=e.alarms,this.personalAlarms=e.personalAlarms,this.updateTargetAlarm=e.updateTargetAlarm,this.alarmOptions=this._makeAlarmOptions()},serializeData:function(){return{alarmType:this._getAlarmType(),alarmOptions:this.alarmOptions}},onRender:function(){this.updateTargetAlarm&&!o.isPredefinedAlarm(this.isAllDay,this.updateTargetAlarm.model.toJSONForSave())&&this._showCustomAlarmRegion()},_getAlarmType:function(){return this.updateTargetAlarm?o.isPredefinedAlarm(this.isAllDay,this.updateTargetAlarm.model.toJSONForSave())?this.updateTargetAlarm.key:"custom":"no_alarm"},_makeAlarmOptions:function(){var e=[];e.push({key:"no_alarm",value:"",message:o.getNoneAlarmMessage()});var t=this.isAllDay,n=o.getPredefinedAlarms(t);return i.each(n,(function(n){var i=n.duration_type+"_"+n.amount;t&&(i+="_"+n.alarm_time),e.push({key:i,value:i,message:o.getMessage(t,n),alarmJson:n})})),e.push({key:"custom",value:"custom",message:o.getCustomAlarmMessage()}),e},_selectAlarmValue:function(e){var t=$(e.currentTarget).data("key"),n=i.find(this.alarmOptions,(function(e){return t==e.key}));if("custom"!=t&&o.isExistingAlarm(i.union(this.alarms.models,this.personalAlarms.models),n))return alert(IM("schedule.alarm.set_personal_alarm.notice.existing_alarm")),!1;"no_alarm"==t?(this.model.setAlarm(null),this.getRegion("customAlarmRegion").empty()):"custom"==t?(this.model.setAlarm(n.alarmJson),this._showCustomAlarmRegion()):(this.model.setAlarm(n.alarmJson),this.getRegion("customAlarmRegion").empty()),this.trigger("alarmOption:selectAlarm")},_showCustomAlarmRegion:function(){var e=this.updateTargetAlarm?this.updateTargetAlarm.model:this.model,t=new s({isAllDay:this.isAllDay,alarm:e.has("durationType")?e.toJSONForSave():null});this.listenTo(t,s.EVENT.CUSTOM_ALARM_CHANGED,i.bind((function(e){this.model.setAlarm(e),this.trigger(s.EVENT.CUSTOM_ALARM_CHANGED)}),this)),this.getRegion("customAlarmRegion").show(t)}});return r.build=function(e){return new r({model:e.model,isAllDay:e.isAllDay,alarms:e.alarms,personalAlarms:e.personalAlarms,updateTargetAlarm:e.updateTargetAlarm})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<ul class="selectArea">\n<% _.each(alarmOptions, function(alarm) { %>\n    <li>\n        <label for="option_<%- alarm.key %>" class="uCheck -radio">\n            <input type="radio" id="option_<%- alarm.key %>" name="radio" class="checkInput _radioAlarmValue" data-key="<%- alarm.key %>" value="<%- alarm.value %>" <% if (alarm.key == alarmType) { %> checked<% } %>>\n            <span class="checkLabel">\n                    <span class="shape sf_afterBg"></span>\n                    <span class="text"><%- alarm.message %></span>\n                </span>\n        </label>\n    </li>\n<%}); %>\n</ul>\n<div class="_customAlarmRegion customAlarmRegion -viewPage"></div>'},function(e,t){e.exports='<div class="lyContent <%- layerWidth %>">\n    <header class="header -subDescType">\n        <h1 class="title"><%= IM("schedule.detail.button.set_schedule_alarm") %></h1>\n    <% if (isPersonalAlarm) { %>\n        <p class="desc"><%= IM("schedule.alarm.set_personal_alarm.notice") %></p>\n    <% } %>\n    </header>\n    <div class="main">\n        <div class="_alarmSelectRegion"></div>\n    </div>\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _btnCancel"><%= IM("ui.label.cancel") %></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<a href="#" role="button" class="collageImage _clickarea">\n    <img src="<%- photoUrl %>" alt="" <% if(contentClass) { %>class="<%=contentClass%>"<% } %>>\n</a>\n<% if(lastItem && moreImageCount > 0) { %>\n<a href="#" class="moreMedia"><span><%-IM("schedule.photo_collage.label.more", {count : moreImageCount}) %></span></a>\n<% } %>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2497),s=n(487),a=n(637),r=i.View.extend({attributes:{"data-viewname":"DScheduleLocationView"},template:t.template(o),templateContext:function(){return{staticMapUrl:a.getStaticMapUrl(this.model.get("latitude"),this.model.get("longitude")),largeMapUrl:a.getLargeMapUrl(this.model.get("latitude"),this.model.get("longitude"))}},behaviors:[s],onRender:function(){this.model.has("latitude")&&this.model.has("longitude")?this.$el.attr("class","scheduleLocation"):this.$el.attr("class","mapLink")}});return r.buildDScheduleLocationView=function(e){return new r({model:e})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% if (staticMapUrl) { %>\n\n<div class="mapLink">\n    <span class="icon">\n        <svg class="svgIcon sf_color" aria-hidden="true">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-map-14"></use>\n        </svg>\n    </span>\n    <span class="text"><%-name || address%></span>\n</div>\n<a href="<%- largeMapUrl %>" class="imgLink" target="_blank">\n    <div class="mapImage"><img src="<%- staticMapUrl%>" width="100%" alt="<%-name || address%>"></div>\n</a>\n\n<% } else { %>\n\n<span class="icon">\n    <svg class="svgIcon sf_color" aria-hidden="true">\n        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-map-14"></use>\n    </svg>\n</span>\n<a href="<%=largeMapUrl %>" class="text" target="_blank"><%-name || address%></a>\n\n<% } %>\n'},function(e,t){e.exports='<div class="icon">\n    <svg class="svgIcon sf_color" aria-hidden="true">\n        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-file"></use>\n    </svg>\n</div>\n<div class="cont">\n    <span class="text"><%- attachFileName %></span>\n    <span class="info">\n        <span><%- attachFileSize %></span>\n        <% if( attachFileInfo ) {%>\n        <span><%- attachFileInfo %></span>\n        <% } %>\n        <% if ( isQuotaStatus ) { %>\n        <span><button type="button" class="buttonSetting _settingSave"><%= IM(\'web.postdetail.attachfile.settingSave\') %></button></span>\n        <% } %>\n    </span>\n</div>\n<button class="btnDown _downloadFile" ><span class="gSrOnly"><%= IM("schedule.attach_file.download") %></span></button>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2500),s=n(82),a=n(589),r=n(720),l=i.View.extend({tagName:"li",className:"uFlexItem",attributes:{"data-viewname":"DScheduleBirthdayMemberItemView"},template:t.template(o),templateContext:function(){var e=s.makeProfileImageUrl(this.model.getContentAuthorProfileImageUrl());return{isMemberSelectableForChat:this.getOption("isMemberSelectableForChat"),isMyself:this.model.isMyself(),profileThumbnail:e,profileInnerClass:s.makeProfileInnerClass(e),memberDescription:this.model.getContentAuthorDescription()}},ui:{birthdayUserProfile:"._birthdayUserProfile",openChatButton:"._openChatButton"},events:{"click @ui.birthdayUserProfile":function(e){e.preventDefault(),a.openProfileView(this.model.get("bandNo"),this.model.get("userNo"))},"click @ui.openChatButton":function(e){e.preventDefault(),r.startChattingWithUsers([this.model.toJSON()],this.model.get("bandNo"))}}}),c=i.CollectionView.extend({tagName:"ul",className:"cMemberList",attributes:{"data-viewname":"DScheduleBirthdayMemberListView"},childView:l,childViewOptions:function(){return{isMemberSelectableForChat:this.getOption("isMemberSelectableForChat")}}});return c.buildDScheduleBirthdayMemberListView=function(e,t){return new c({collection:e,isMemberSelectableForChat:t.isMemberSelectableForChat})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<a href="#" class="uProfile -size50 -border _birthdayUserProfile" role="button">\n    <span class="profileInner <%- profileInnerClass %>">\n        <img src="<%- profileThumbnail %>" alt="<%-name %>">\n    </span>\n</a>\n<span class="body">\n    <span class="text -flex"><span class="ellipsis"><%-name %></span></span>\n    <span class="subText -ellipsis"><%-memberDescription %></span>\n</span>\n\n<% if (isMemberSelectableForChat && !isMyself) { %>\n<span class="etc">\n    <button type="button" class="bntChatting _openChatButton">\n        <span class="gSrOnly"><%=IM("schedule.detail.button.open_chat") %></span>\n        <svg class="svgIcon sf_color" aria-hidden="true">\n            <use xlink:href="#ico-chat"></use>\n        </svg>\n    </button>\n</span>\n<% } %>\n'},function(e,t,n){var i=n(4),o=n(0),s=n(2502),a=n(511),r=i.View.extend({tag:"section",className:"lyWrap",attributes:{"data-viewname":"DRsvpStatusItemSelectView"},ui:{rsvpStatus:"._rsvpStatus",cancelButton:"._cancel",confirmButton:".-confirm"},events:{"click @ui.cancelButton":function(){this.destroy()},"click @ui.confirmButton":function(){this.ui.rsvpStatus.filter(":checked").val()&&(this.trigger("selected:rsvpState",{rsvpState:this.ui.rsvpStatus.filter(":checked").val(),customStateId:this.ui.rsvpStatus.filter(":checked").data("customStateId")}),this.destroy())},"change @ui.rsvpStatus":function(){this.ui.confirmButton.hasClass("-disabled")&&this.ui.confirmButton.removeClass("-disabled")}},template:o.template(s),templateContext:function(){return{rsvpStatusList:this._rsvpStatusList,needChecked:function(e){return e==a.ATTENDANCE}}},initialize:function(e){this._rsvpStatusList=e.rsvpStatusList},onAttach:function(){this.ui.rsvpStatus.filter(":checked").val()||this.ui.confirmButton.addClass("-disabled")}});r.buildDRsvpStatusItemSelectView=function(e){return new r({rsvpStatusList:e})},e.exports=r},function(e,t){e.exports='<div class="lyContent">\n    <header class="header">\n        <h1 class="title"><%= IM("rsvp.item.select.title") %></h1>\n    </header>\n\n    <div class="main -mH360">\n        <ul class="listLine">\n            <% _.each(rsvpStatusList, function(item) { %>\n            <li class="tLine">\n                <label class="flexList" for="<%= item.itemName%><%= item.customStateId%>" class="uCheck -radio">\n                    <span class="text"><%- item.text %></span>\n                    <span class="etc">\n                        <span class="uCheck -radio -noLabel">\n                            <input type="radio" id="<%= item.itemName%><%= item.customStateId%>" name="radio" class="checkInput _rsvpStatus" value="<%= item.itemName%>" data-custom-state-id="<%= item.customStateId %>" <% if (needChecked(item.itemName)) { %> checked <% } %>>\n                            <span class="checkLabel">\n                                <span class="shape sf_afterBg"></span>\n                            </span>\n                        </span>\n                    </span>\n                </label>\n            </li>\n            <% }) %>\n        </ul>\n    </div>\n\n    <footer class="footer">\n        <button type="button" class="uButton -confirm"><%= IM("ui.label.confirm") %></button>\n        <button type="button" class="btnLyClose uButton -iconClose _cancel"><span class="gSrOnly"><%= IM("ui.label.close_layer") %></span></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(4),o=n(0),s=n(2),a=n(52),r=n(486),l=n(499),c=n(498),d=n(503),u=n(167),h=n(166),p=n(26),m=n(159),_=n(160),g=n(2039),f=n(511),b=n(2504),v=n(2507),A=n(2509),E=n(907),T=n(527),C=n(589),y=n(1567),M=n(1648),I=n(2514),S=n(531),w=n(488),N=n(154),D=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DRsvpPresentStateView"},getTemplate:function(){return this._loading?o.template(I):o.template(c)},behaviors:{CourierBehavior:""},ui:{stateTabRegion:"._stateTabRegion",memberListRegion:"._memberListRegion",btnConfirm:"._btnConfirm",btnRsvpLyMore:"._btnRsvpLyMore",rsvpLyMore:"._rsvpLyMore",btnExcelDownload:"._btnExcelDownload",btnPrint:"._btnPrint",btnChangeRsvpState:"._btnChangeRsvpState",rsvpStateHelpGuide:"._rsvpStateHelpGuide",btnCloseLayer:"._btnCloseLayer",btnSelectCustomState:"._btnSelectCustomState",dropDownWrapper:"._dropDownWrapper",btnDropDownItem:".btnDropDownItem",selectedCustomItemText:"._selectedCustomItemText",selectedCustomItemCount:"._selectedCustomItemCount"},regions:{stateTabRegion:{el:"@ui.stateTabRegion",replaceElement:!0},memberListRegion:{el:"@ui.memberListRegion",replaceElement:!0}},events:{"click @ui.btnConfirm":"destroy","click .dimmed":"destroy","click @ui.btnChangeRsvpState":"_showMemberRsvpStateList","click @ui.btnRsvpLyMore":"_onClickBtnRsvpLyMore","click @ui.btnPrint":"_onClickBtnPrint","click @ui.btnExcelDownload":"_onBtnExcelDownload","click @ui.btnCloseLayer":"_closeRsvpStateHelpGuide","click @ui.dropDownWrapper ":function(){this.ui.dropDownWrapper.hasClass("-dropDownOn")?this.ui.dropDownWrapper.removeClass("-dropDownOn"):this.ui.dropDownWrapper.addClass("-dropDownOn")},"click @ui.btnDropDownItem":function(e){var t=e.target,n=s(t).data("customStateId");n!=this.customStateId&&(this.customStateId=n,this._fetchRsvpMembers())}},onMessages:(t={},t[m.MSG.SCHEDULE_RSVP_STATE_TAB_CLICK]=function(e){this.rsvpState=e.rsvpState,this.customStateId=this.rsvpState==f.CUSTOM?this.model.getCustomRsvpStatusList()[0].customStateId:null,this._fetchRsvpMembers()},t[m.MSG.SCHEDULE_RSVP_MEMBER_STATE_CHANGE]=function(e){this.rsvpState=e.rsvpState,this.customStateId=this.rsvpState==f.CUSTOM?e.customStateId:null,this.model.refreshRsvpData(e.updatedRsvpInfo.toJSON()),this._fetchRsvpMembers().then(o.bind((function(){e.pendingAttendanceMembers&&e.pendingAttendanceMembers.length>0&&this._showPendingMemberView(e.pendingAttendanceMembers)}),this)),this._triggerScheduleUpdateEvent()},t[m.MSG.SCHEDULE_RSVP_STATE_SHOW_GUIDE]=function(e){if(e.noNeedHelpGuide)this.getUI("rsvpStateHelpGuide").hide();else{var t=u.getCurrentUserEnvStorage();if(t.get([h.RsvpStateChangeHelpGuide]))return this.getUI("rsvpStateHelpGuide").hide(),!1;t.set([h.RsvpStateChangeHelpGuide],!0),this.getUI("rsvpStateHelpGuide").css("top",e.position),this.getUI("rsvpStateHelpGuide").show()}},t),initialize:function(e){this._loading=!1,this.model=e.model,this.bandNo=e.bandNo,this.scheduleId=e.scheduleId,this.rsvpState=e.openWithType,this.isAuthor=e.isAuthor,this.isMaxAttendeeCount=e.isMaxAttendeeCount,this._afterRsvpEndedAt=e.afterRsvpEndedAt,this._bandData=e.bandData,this._changeOthersRsvpStatePermitted=e.changeOthersRsvpStatePermitted,this.customStateId=e.customStateId},serializeData:function(){return this._loading?(this.showTabArea=this.rsvpState!=f.NONRESPONSE,{title:this._getTitleMessage(),canShowAddMemberButton:this._canShowAddMemberButton(),addMemberButtonLabel:this._getRsvpStateText(),needShowCustomInfo:this.rsvpState==f.CUSTOM,customStateList:this.model.getCustomRsvpStatusList()}):{_loading_size:l.Size.MEDIUM,middleClass:w.ELEMENT.AREA_VERTICAL_MIDDLE}},onAttach:function(){this._fetchRsvpMembers()},onDomRefresh:function(){this.getUI("rsvpStateHelpGuide").hide(),this._loading&&(this.showTabArea&&this.showChildView("stateTabRegion",A.build({bandNo:this.bandNo,scheduleId:this.scheduleId,rsvpState:this.rsvpState,rsvpList:this.model.getRsvpStatusListForAttendeeViewTab(),rsvpStateCountInfo:this.model.getRsvpCountInfo()})),this.showChildView("memberListRegion",b.buildDRsvpMemberListView({scheduleRsvpModel:this.model,rsvpMemberCollection:this.rsvpMemberCollection,bandNo:this.bandNo,scheduleId:this.scheduleId,rsvpState:this.rsvpState,isAuthor:this.isAuthor,isMaxAttendeeCount:this.isMaxAttendeeCount,afterRsvpEndedAt:this._afterRsvpEndedAt,bandData:this._bandData,customStateId:this.customStateId})),this.rsvpState==f.CUSTOM&&(this._drawSelectedCustomInfo(),this.stopListening(p.getDGlobalChannel(),p.EVENT.HTML_CLICK),this.listenTo(p.getDGlobalChannel(),p.EVENT.HTML_CLICK,(function(e){this.ui.dropDownWrapper.hasClass("-dropDownOn")&&!this.ui.dropDownWrapper[0].contains(e.target)&&this.ui.dropDownWrapper.removeClass("-dropDownOn")}))))},onBeforeDetach:function(){this.stopListening(p.getDGlobalChannel(),p.EVENT.HTML_CLICK)},_fetchRsvpMembers:function(){return this._loading=!1,N.wrapActivePromise(g.buildWithMemberList(this.bandNo,this.scheduleId,this.rsvpState,this.customStateId),this).then(o.bind((function(e){this.rsvpMemberCollection=e,this._loading=!0,this.render()}),this))},_getRsvpStateText:function(){return this.rsvpState==f.ATTENDANCE||this.rsvpState==f.CUSTOM?IM("schedule.rsvp.state.add_attendee"):this.rsvpState==f.ABSENCE?IM("schedule.rsvp.state.add_absentee"):this.rsvpState==f.MAYBE?IM("schedule.rsvp.state.add_maybe"):void 0},_drawSelectedCustomInfo:function(){var e=this.model.getCustomStateItem(this.customStateId),t=e.count>=99?"99+":e.count;this.ui.selectedCustomItemText.text(o.unescape(e.title)),this.ui.selectedCustomItemCount.text(t)},_showMemberRsvpStateList:function(){var e=E.openDMemberSelectionView({wideView:!0,titleText:this._getRsvpStateText(),submitBtnText:IM("schedule.rsvp.change_state.member_list.add_member")}),t=T.buildBandMemberWithFilterDataCollection(this.bandNo,_.RSVP,100),n=T.buildBandMemberWithFilterDataCollection(this.bandNo,_.RSVP,100);N.wrapActivePromise(s.when(d.getScheduleRsvpStatesOfMembers(this.bandNo,this.scheduleId),t.fetchBandMemberWithFilterDataCollection()),this).then(o.bind((function(n){var i=a.camelizeKeys(n);this._rsvpStatesOfMembers=i.rsvpStates;var o=t.toMemberSelectionViewModels();this._currentRsvpStatesOfMembers=this._extractCurrentTypeMembers(),this._makeSameTypeMemberDisabled(o),this._addRsvpStateTo(o),this._memberModels=o,e.renderMemberListToSelect({memberModels:this._memberModels,showSearchMoreMemberBtn:t.hasMoreMember()})}),this)),this.listenTo(e,E.EVENT.MEMBER_SELECTION_MEMBER_SELECT_CLICK,(function(t){e.getSelectedMemberCount()>=50?alert(IM("member_list.rsvp.selected_member.max_count",{maxCount:50})):e.selectMember(t.selectedMember)})),this.listenTo(e,E.EVENT.MEMBER_SELECTION_MEMBER_DESELECT_CLICK,(function(t){e.deselectMember(t)})),this.listenTo(e,E.EVENT.MEMBER_SELECTION_MEMBER_PROFILE_CLICK,(function(e){C.openMembershipProfileLayer({name:e.name,profileImageUrl:e.profileImageUrl,userNo:e.userNo,bandNo:this.bandNo})})),this.listenTo(e,E.EVENT.MEMBER_SELECTION_SEARCH,(function(t){N.wrapActivePromise(n.searchBandMemberWithFilterDataCollection(t),this).then(o.bind((function(){var t=n.toMemberSelectionViewModels();this._makeSameTypeMemberDisabled(t),this._addRsvpStateTo(t),e.renderMemberListToSelect({memberModels:t,showSearchMoreMemberBtn:n.hasMoreMember()})}),this))})),this.listenTo(e,E.EVENT.MEMBER_SELECTION_INPUT_EMPTY,(function(){e.renderMemberListToSelect({memberModels:this._memberModels,showSearchMoreMemberBtn:t.hasMoreMember()})})),this.listenTo(e,E.EVENT.MEMBER_SELECTION_COMPLETE,(function(t){if(confirm(IM("schedule.rsvp.confirm.change_state.member_list"))){var n=o.map(t.selectedMembers,(function(e){return e.getUserNo()})),i={bandNo:this.bandNo,scheduleId:this.scheduleId,rsvpState:this.rsvpState,userNoList:n};return i.rsvpState==f.CUSTOM&&(i.customStateId=this.customStateId),this.rsvpMemberCollection.setScheduleRsvpStates(i).then(o.bind((function(t){this.model.refreshRsvpData(t.updatedRsvpInfo.toJSON()),this._triggerScheduleUpdateEvent(),this._fetchRsvpMembers().then(o.bind((function(){t.pendingAttendanceMemberList&&t.pendingAttendanceMemberList.length>0&&this._showPendingMemberView(t.pendingAttendanceMemberList),e.destroyView()}),this))}),this))}}))},_extractCurrentTypeMembers:function(){return o.chain(this._rsvpStatesOfMembers).pairs().filter((function(e){var t=e[1];return t.rsvpState==this.rsvpState&&(this.rsvpState!=f.CUSTOM||this.customStateId==t.customStateId)}),this).object().value()},_makeSameTypeMemberDisabled:function(e){o.each(e,(function(e){o.has(this._currentRsvpStatesOfMembers,e.getUserNo())&&e.setDisabled(!0)}),this)},_addRsvpStateTo:function(e){o.each(e,(function(e){var t=this._rsvpStatesOfMembers[e.getUserNo()]||{rsvpState:f.NONRESPONSE};t.rsvpState!=f.CUSTOM?e.setExtraText(f.getRsvpStateText(t.rsvpState)):e.setExtraText(t.title)}),this)},_closeRsvpStateHelpGuide:function(){this.getUI("rsvpStateHelpGuide").hide()},_onClickBtnRsvpLyMore:function(){var e=!1;this.getUI("rsvpLyMore").toggle(),this.getUI("rsvpLyMore").is(":visible")&&(e=!0),this.getUI("btnRsvpLyMore").attr("aria-expanded",e)},_onClickBtnPrint:function(){var e=M.openAsLayer(S.RSVP.EXPORT_TYPE.PRINT,this.model.isMaybeEnabled(),this.model.getCustomRsvpStatusList());this.listenTo(e,"selected:item",(function(e){y.openPrintWin({bandNo:this.options.bandNo,scheduleId:this.options.scheduleId,params:{selectedRsvpInfo:e,onlyPrintRsvpAttendeeInfo:!0}})})),this._onClickBtnRsvpLyMore()},_onBtnExcelDownload:function(){var e=M.openAsLayer(S.RSVP.EXPORT_TYPE.DOWNLOAD,this.model.isMaybeEnabled(),this.model.getCustomRsvpStatusList());this.listenTo(e,"selected:item",(function(e){y.excelDownload({bandNo:this.options.bandNo,scheduleId:this.options.scheduleId,selectedRsvpInfo:e})})),this._onClickBtnRsvpLyMore()},_canShowAddMemberButton:function(){return!!this._changeOthersRsvpStatePermitted&&(this.rsvpState==f.ATTENDANCE||this.rsvpState==f.ABSENCE||this.rsvpState==f.MAYBE||this.rsvpState==f.CUSTOM)},_getTitleMessage:function(){return this.rsvpState==f.NONRESPONSE?IM("schedule.rsvp.nonresponse_member")+" "+this.model.getNonResponseCount():IM("schedule.rsvp.title")},_showPendingMemberView:function(e){var t=v.openDRsvpPendingMemberViewAsLayer({pendingMemberList:e});this.listenTo(t,"rsvpState:refreshStateInfo",(function(){this.destroy()}))},_triggerScheduleUpdateEvent:function(){p.getDGlobalChannel().trigger(p.EVENT.SCHEDULE_UPDATED,{bandNo:this.bandNo,exScheduleId:this.scheduleId,scheduleId:this.scheduleId,scheduleDetailNoReload:!0})}});return D.openDRsvpPresentStateViewAsLayer=function(e,t){var n=new D({model:e,openWithType:t.openWithType,bandNo:t.bandNo,scheduleId:t.scheduleId,isAuthor:t.isAuthor,isMaxAttendeeCount:t.isMaxAttendeeCount,afterRsvpEndedAt:t.afterRsvpEndedAt,bandData:t.bandData,changeOthersRsvpStatePermitted:t.changeOthersRsvpStatePermitted,customStateId:t.customStateId});return r.openWithoutHiding(n),n},D}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(4),o=n(0),s=n(159),a=(n(2039),n(2505)),r=i.View.extend({className:"uEmpty -flexibleHeight",template:o.template("<span>"+IM("schedule.rsvp.msg.no_member")+"</span>")}),l=i.CollectionView.extend({tagName:"ul",className:"listLine rScroll -lrSpace -flexibleHeight",attributes:{"data-viewname":"DRsvpMemberListView"},emptyView:r,childView:a,childViewOptions:function(){return{scheduleRsvpModel:this.scheduleRsvpModel,bandNo:this.bandNo,scheduleId:this.scheduleId,rsvpState:this.rsvpState,isAuthor:this.isAuthor,isMaxAttendeeCount:this.isMaxAttendeeCount,afterRsvpEndedAt:this._afterRsvpEndedAt,bandData:this._bandData,customStateId:this.customStateId}},behaviors:{CourierBehavior:""},onMessages:(t={},t[s.MSG.SCHEDULE_RSVP_STATE_SHOW_GUIDE]=function(e){this._closeAllOptionLayer(e.viewCid)},t),initialize:function(e){this.collection=e.collection,this.scheduleRsvpModel=e.scheduleRsvpModel,this.bandNo=e.bandNo,this.scheduleId=e.scheduleId,this.rsvpState=e.rsvpState,this.isAuthor=e.isAuthor,this.isMaxAttendeeCount=e.isMaxAttendeeCount,this._afterRsvpEndedAt=e.afterRsvpEndedAt,this._bandData=e.bandData,this.customStateId=e.customStateId},_closeAllOptionLayer:function(e){var t=this.children.reject((function(t){return t.cid==e}));o.each(t,(function(e){e.closeAllOptionLayer()}))}});return l.buildDRsvpMemberListView=function(e){return new l({collection:e.rsvpMemberCollection,scheduleRsvpModel:e.scheduleRsvpModel,bandNo:e.bandNo,scheduleId:e.scheduleId,rsvpState:e.rsvpState,isAuthor:e.isAuthor,isMaxAttendeeCount:e.isMaxAttendeeCount,afterRsvpEndedAt:e.afterRsvpEndedAt,bandData:e.bandData,customStateId:e.customStateId})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(2),s=n(26),a=n(159),r=n(626),l=n(13),c=n(9),d=n(511),u=n(589),h=n(889),p=n(2506),m=n(1642),_=n(486),g=n(82);return t.View.extend({tagName:"li",className:"tLine flexList",attributes:{"data-viewname":"DRsvpMemberItemView"},template:i.template(p),behaviors:{CourierBehavior:""},ui:{profileImageUrl:"._profileImageUrl",rsvpStateWrapper:"._rsvpStateWrapper",rsvpStateSelectbox:"._rsvpStateSelectbox",selectedRsvpState:"._selectedRsvpState",btnMoreMenu:"._btnMoreMenu",contextMenuRegion:"._contextMenuRegion",showHistory:"._showHistory"},regions:{contextMenuRegion:"@ui.contextMenuRegion"},events:{"click @ui.profileImageUrl":"_showUserProfile","click @ui.rsvpStateWrapper":"_toggleRsvpStateSelectbox","click @ui.selectedRsvpState":"_setBandMemberRsvpState","click @ui.btnMoreMenu":"_toggleMoreMenu","click @ui.showHistory":function(){m.buildForRsvpHistory(this.bandNo,this.scheduleId,this.model.getUserNo(),this.model.getChildMembershipId()).then(i.bind((function(e){_.openWithoutHiding(e)}),this))}},initialize:function(e){this.model=e.model,this.scheduleRsvpModel=e.scheduleRsvpModel,this.bandNo=e.bandNo,this.scheduleId=e.scheduleId,this.rsvpState=e.rsvpState,this.isAuthor=e.isAuthor,this.isMaxAttendeeCount=e.isMaxAttendeeCount,this._bandData=e.bandData,this._afterRsvpEndedAt=e.afterRsvpEndedAt,this.customStateId=e.customStateId},serializeData:function(){this.actor=this.model.get("actor"),this.member=this.model.get("member");var e=this.model.get("repliedAt"),t=this.actor.get("userNo")==l.getUserData().getUserNo(),n=d.getRsvpStateText(this.rsvpState),o=this.scheduleRsvpModel.getCustomRsvpStatusList();return this.rsvpState==d.CUSTOM&&(n=this.scheduleRsvpModel.getCustomStateTitle(this.customStateId)),{STATE_ATTENDANCE:d.ATTENDANCE,STATE_PENDING_ATTENDANCE:d.PENDING_ATTENDANCE,STATE_ABSENCE:d.ABSENCE,STATE_MAYBE:d.MAYBE,STATE_NONRESPONSE:d.NONRESPONSE,isMyself:this.actor.get("userNo")==this.member.get("userNo"),isChildMember:this.member.get("childMembershipId")&&this.member.get("childMembershipId")>0,actorName:i.escape(this.actor.get("name")),memberName:this.member.get("name"),memberDescription:this.member.getMemberDescription(),memberProfileImageUrl:this.member.get("faceThumb"),profileInnerClass:g.makeProfileInnerClass(this.member.get("faceThumb")),repliedAt:c.format.date(e,"short_date_time"),rsvpState:this.rsvpState,rsvpStateText:n,canChangeBandMemberRsvpState:this._bandData.canChangeBandMemberRsvpItem(this.isAuthor),canDeleteRsvpChildMember:this._bandData.canDeleteRsvpChildMember(this.isAuthor,this._afterRsvpEndedAt,t),maybeOptionHidden:"STATE_MAYBE"===this.rsvpState||!this.scheduleRsvpModel.isMaybeEnabled(),customStateList:o,needShowRsvpReplyHistory:this.model.isUpdated()}},onAttach:function(){this.listenTo(s.getDGlobalChannel(),s.EVENT.HTML_CLICK,this.closeAllOptionLayer)},_showUserProfile:function(e){e.preventDefault();var t=this.member.get("bandNo"),n=this.member.get("userNo");u.openProfileView(t,n)},_toggleRsvpStateSelectbox:function(e){e.stopPropagation();var t=o(e.currentTarget);t.hasClass("-dropDownOn")?(t.removeClass("-dropDownOn"),t.prop("aria-expanded","false")):(t.addClass("-dropDownOn"),t.prop("aria-expanded","true"));var n=this.$el.scrollParent(),i=this.getUI("rsvpStateSelectbox");r.adjustSelectboxPosition(n,i,"-up");var s=this.$el.position().top,l=this.$el.height(),c=parseInt(s+l/2,10)-30;this.spawn(a.MSG.SCHEDULE_RSVP_STATE_SHOW_GUIDE,{viewCid:this.cid,position:c})},_closeStateSelectbox:function(){this.getUI("rsvpStateWrapper").removeClass("-dropDownOn"),this.getUI("rsvpStateWrapper").prop("aria-expanded","false")},_toggleMoreMenu:function(e){e.stopPropagation(),this.getRegion("contextMenuRegion").hasView()?this._closeMoreMenu():(this.spawn(a.MSG.SCHEDULE_RSVP_STATE_SHOW_GUIDE,{noNeedHelpGuide:!0}),this._showMoreOptions())},_closeMoreMenu:function(){this.getUI("contextMenuRegion").removeClass("lyMenu").css("min-width","");var e=this.getRegion("contextMenuRegion");e.hasView()&&e.empty()},_showMoreOptions:function(){this.getUI("contextMenuRegion").addClass("lyMenu").css("min-width","145px");var e=this.getRegion("contextMenuRegion");if(!e.hasView()){var t={id:"DELETE",title:IM("ui.label.delete")},n=h.build([t]);this.listenTo(n,h.EVENTS.MENU_SELECTED,i.bind((function(e){switch(e){case t.id:this._cancelRsvpAttend()}}),this)),e.show(n);var o=this.$el.scrollParent(),s=this.getUI("contextMenuRegion");r.adjustLayerPosition(o,s,"lyTop")}},closeAllOptionLayer:function(){this._closeStateSelectbox(),this._closeMoreMenu()},_cancelRsvpAttend:function(){this.model.setChildMemberModel({childMembershipId:this.model.get("member").get("childMembershipId"),userNo:this.model.get("member").get("userNo"),bandNo:this.model.get("member").get("bandNo")});var e=this.scheduleRsvpModel.get("attendeeLimit"),t=this.scheduleRsvpModel.get("attendeeCount"),n=this.scheduleRsvpModel.get("pendingAttendeeCount"),o=IM("schedule.rsvp.cancel_attendance_with_child_member");if(this.rsvpState==d.ATTENDANCE&&t==e&&n>0&&(o=IM("schedule.rsvp.cancel_attendance_with_pending_member")),!confirm(o))return!1;var s={bandNo:this.bandNo,scheduleId:this.scheduleId,rsvpState:d.NONRESPONSE};return this.model.setUserRsvpState(s).then(i.bind((function(e){i.each(e.updatedMemberList,i.bind((function(e){e.get("userNo")==this.model.get("member").get("userNo")&&e.get("childMembershipId")==this.model.get("member").get("childMembershipId")&&this.model}),this)),this.spawn(a.MSG.SCHEDULE_RSVP_MEMBER_STATE_CHANGE,{rsvpState:this.rsvpState,customStateId:this.customStateId,updatedRsvpInfo:e.updatedRsvpInfo})}),this))},_setBandMemberRsvpState:function(e){e.preventDefault();var t=o(e.currentTarget).data("rsvpState"),n=this.model.get("member").get("userNo");if(this.isMaxAttendeeCount&&this.rsvpState==d.ATTENDANCE&&(t==d.ABSENCE||t==d.NONRESPONSE)){var s=d.getRsvpStateText(t);if(!confirm(IM("schedule.rsvp.change_state.notice.about_changed_state",{rsvpState:s})))return}var r={bandNo:this.bandNo,scheduleId:this.scheduleId,userNo:n,rsvpState:t};return t==d.CUSTOM&&(r.customStateId=o(e.currentTarget).data("customStateId")),this.model.setUserRsvpState(r).then(i.bind((function(e){i.each(e.updatedMemberList,i.bind((function(e){e.get("userNo")==this.model.get("member").get("userNo")&&this.model}),this)),this.spawn(a.MSG.SCHEDULE_RSVP_MEMBER_STATE_CHANGE,{rsvpState:t,customStateId:r.customStateId,pendingAttendanceMembers:e.pendingAttendanceMembers,updatedRsvpInfo:e.updatedRsvpInfo})}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='        <span class="thumb">\n        <% if (isChildMember) { %>\n                <span class="uProfile -size40">\n                    <span class="profileInner <%- profileInnerClass %>">\n                        <img src="<%- memberProfileImageUrl %>" width="40" height="40" alt="<%- memberName %>">\n                    </span>\n                </span>\n        <% } else { %>\n            <a href="#" class="_profileImageUrl" role="button">\n                <span class="uProfile -size40">\n                    <span class="profileInner <%- profileInnerClass %>">\n                        <img src="<%- memberProfileImageUrl %>" width="40" height="40" alt="<%- memberName %>">\n                    </span>\n                </span>\n            </a>\n        <% } %>\n        </span>\n        <span class="text">\n            <span class="ellipsis"><%- memberName %></span>\n        <% if (memberDescription) { %>\n            <span class="sub2 -ellipsis"><%- memberDescription %></span>\n        <% } %>\n        <% if (!isMyself || (isMyself && isChildMember)) { %>\n            <span class="sub2"><%- repliedAt %></span>\n            <span class="sub2">\n            <% if (isChildMember) { %>\n                <span class="outsiderPoint"><%- IM("schedule.view.rsvp.child_member.title") %></span>\n            <% } %>\n            <% if (actorName) { %>\n                <%= IM(\'schedule.rsvp.state.change_actor\', {actorName: actorName}) %>\n            <% } %>\n            </span>\n        <% } %>\n        <% if (needShowRsvpReplyHistory) { %>\n            <button type="button" class="status gFs12 _showHistory"><%= IM("schedule.detail.text.modify_schedule") %></button>\n        <% } %>\n        </span>\n\n<% // 권한자만 멤버의 RSVP 참석 상태를 변경할 수 있음 %>\n<%\n    // 밴드 멤버는 상태 선택 selectbox 제공함\n    //\n    // 1) 일정 작성자 또는 일정 수정 권한자일 때\n    // 2) 참석 종료일 마감 이전일 때\n    //\n    if (!isChildMember && canChangeBandMemberRsvpState) {\n%>\n        <span class="etc">\n            <div class="uInput -h32 -dropDown -bgNone _rsvpStateWrapper" style="min-width:110px">\n                <button type="button" aria-haspopup="listbox" aria-expanded="true" class="dropdownToggle -flexible" title="<%- rsvpStateText %>"><span class="customText -ellipsis"><%- rsvpStateText %></span></button>\n                <ul class="dropDown _rsvpStateSelectbox" style="left:auto;right:0;max-width: 250px;max-height:180px">\n                    <li role="option" class="dropDownItem _selectedRsvpState" data-rsvp-state="<%= STATE_ATTENDANCE %>" <% if (rsvpState == STATE_ATTENDANCE || rsvpState == STATE_PENDING_ATTENDANCE) { %> hidden<% } %>>\n                        <button class="btnDropDownItem" type="button"><%= IM("schedule.rsvp.attendance") %></button>\n                    </li>\n                    <li role="option" class="dropDownItem _selectedRsvpState" data-rsvp-state="<%= STATE_ABSENCE %>" <% if (rsvpState == STATE_ABSENCE) { %> hidden<% } %>>\n                        <button class="btnDropDownItem" type="button"><%= IM("schedule.rsvp.absentee") %></button>\n                    </li>\n                    <li role="option" class="dropDownItem _selectedRsvpState" data-rsvp-state="<%= STATE_MAYBE  %>" <% if (maybeOptionHidden ) { %> hidden<% } %>>\n                        <button class="btnDropDownItem" type="button"><%= IM("schedule.rsvp.maybe") %></button>\n                    </li>\n                    <li role="option" class="dropDownItem _selectedRsvpState" data-rsvp-state="<%= STATE_NONRESPONSE %>" <% if (rsvpState == STATE_NONRESPONSE) { %> hidden<% } %>>\n                        <button class="btnDropDownItem" type="button"><%= IM("schedule.rsvp.nonresponse") %></button>\n                    </li>\n                    <% _.each(customStateList, function(customStateItem) { %>\n                        <li role="option" class="dropDownItem _selectedRsvpState" data-rsvp-state="<%= customStateItem.rsvpState %>" data-custom-state-id="<%= customStateItem.customStateId %>" title="<%- customStateItem.title %>">\n                            <button class="btnDropDownItem" type="button"><%- customStateItem.title %></button>\n                        </li>\n                    <% }); %>\n                </ul>\n            </div>\n        </span>\n<%\n    // 외부 멤버는 더보기 메뉴를 제공함\n    //\n    // 1) 일정 작성자 또는 일정 수정 권한자 또는 외부 멤버를 추가한 사람일 때\n    // 2) 참석 종료일 마감 이전일 때\n    //\n    } else if (isChildMember && canDeleteRsvpChildMember) {\n%>\n        <span class="etc gPr">\n            <button type="button" class="btnOption _btnMoreMenu">\n                <span class="gSrOnly"><%- IM("schedule.detail.rsvp.child_member.button.more") %></span>\n            </button>\n            <div class="_contextMenuRegion"></div>\n        </span>\n<%\n    }\n%>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(486),s=n(589),a=n(2508),r=t.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DRsvpPendingMemberView"},template:i.template(a),ui:{profileImageUrl:"._profileImageUrl",btnConfirm:"._btnConfirm"},events:{"click @ui.profileImageUrl":"_showUserProfile","click @ui.btnConfirm":"_refreshRsvpState"},initialize:function(e){this.pendingMemberList=e.pendingMemberList},serializeData:function(){return{pendingMemberList:this.pendingMemberList}},_showUserProfile:function(e){e.preventDefault();var t=$(e.currentTarget).data("index"),n=this.pendingMemberList[t].get("bandNo"),i=this.pendingMemberList[t].get("userNo");s.openProfileView(n,i)},_refreshRsvpState:function(){this.trigger("rsvpState:refreshStateInfo"),this.destroy()}});return r.openDRsvpPendingMemberViewAsLayer=function(e){var t=new r({pendingMemberList:e.pendingMemberList});return o.openWithoutHiding(t),t},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="header">\n        <h1 class="gSrOnly"><%= IM("schedule.rsvp.pending_attendance") %></h1>\n        <p class="desc -onlyDesc"><%= IM("schedule.rsvp.change_state.desc.pending_member", {memberCount: pendingMemberList.length || "0"}) %></p>\n    </header>\n    <div class="main -tSpaceNone">\n        <ul class="listLine rScroll" style="max-height:284px;">\n        <% _.each(pendingMemberList, function(memberModel, index) { %>\n            <li class="tLine flexList">\n                <span class="thumb">\n                    <%\n                        var _class = "";\n                        var _role = "";\n\n                        if (memberModel.get(\'role\').leader) {\n                            _class = " -leader";\n                            _role = "리더";\n                        } else if (memberModel.get(\'role\').coleader) {\n                            _class = " -coleader";\n                            _role = "공동리더";\n                        }\n                    %>\n                    <a href="#" role="button" class="_profileImageUrl" data-index="<%= index %>">\n                        <span class="uProfile -size40 <%= _class %>">\n                            <span class="profileInner">\n                                <span class="gSrOnly"><%= _role %></span>\n                                <img src="<%= memberModel.get(\'faceThumb\') %>" width="40" height="40" alt="<%= memberModel.get(\'name\') %>">\n                            </span>\n                        </span>\n                    </a>\n                </span>\n                <span class="text -ellipsis"><%= memberModel.get(\'name\') %></span>\n            </li>\n        <% }); %>\n        </ul>\n    </div>\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n    </footer>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(159),s=n(511),a=n(2510),r=t.View.extend({attributes:{"data-viewname":"DRsvpStateTabView"},template:i.template(a),behaviors:{CourierBehavior:""},events:{"click button._rsvpState":"_refreshRsvpState"},initialize:function(e){this.bandNo=e.bandNo,this.scheduleId=e.scheduleId,this.rsvpState=e.rsvpState,this.rsvpList=e.rsvpList,this.rsvpStateCountInfo=e.rsvpStateCountInfo},templateContext:function(){return{tabList:this.rsvpList.map(i.bind((function(e){return{isShow:this.rsvpState===e,rsvpState:e,title:s.getRsvpStateText(e),memberCount:this._getMemberCount(e)}}),this))}},_refreshRsvpState:function(e){e.preventDefault();var t=$(e.currentTarget).data("state");this.spawn(o.MSG.SCHEDULE_RSVP_STATE_TAB_CLICK,{rsvpState:t})},_getMemberCount:function(e){switch(e){case s.ATTENDANCE:return this.rsvpStateCountInfo.attendeeCount;case s.PENDING_ATTENDANCE:return this.rsvpStateCountInfo.pendingAttendeeCount;case s.ABSENCE:return this.rsvpStateCountInfo.absenteeCount;case s.MAYBE:return this.rsvpStateCountInfo.maybeCount;case s.CUSTOM:return this.rsvpStateCountInfo.customStateTotalCount>=99?"99+":this.rsvpStateCountInfo.customStateTotalCount}}});return r.build=function(e){return new r({bandNo:e.bandNo,scheduleId:e.scheduleId,rsvpState:e.rsvpState,rsvpList:e.rsvpList,rsvpStateCountInfo:e.rsvpStateCountInfo})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="tab">\n<% _.each(tabList, function (tab) { %>\n    <span class="cell sf_color <% if(tab.isShow) {%> -on<% } %>"><button type="button" class="_rsvpState" data-state="<%- tab.rsvpState %>"><%= tab.title %> <span class="sf_color"><%- tab.memberCount %></span></button></span>\n<% }); %>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2512),s=n(82),a=n(653),r=n(526),l=n(549),c=n(545),d=n(523),u=n(511),h=n(9),p=n(26),m=n(491),_=n(490),g=n(637),f=[r.NORMAL,r.EXTERNAL,r.HOLIDAY],b=i.View.extend({attributes:{"data-viewname":"DBandSchedulePrintView"},className:"sPrint skin",getTemplate:function(){return this._loading?t.template(""):t.template(o)},templateContext:function(){if(!this._loading){var e=a.multilineMessage(this.model.toJSON()),n=this._getCalendarInfo(),i=this._getRemainingTimeMsg(),o=this._getAttendeeLimitMsg(),l=this.model.get("location"),c=l?g.getStaticMapUrl(l.get("latitude"),l.get("longitude")):null,d=!t.isEmpty(this.model.get("rsvp")),u=e[0];return f.indexOf(this.model.getScheduleType())>=0&&(u=e[0]+" "+e[1]),{bandSkin:this._bandCore.getSkinColorClass(),bandName:this._bandCore.name,coverImg:s.make(this._bandCore.cover,s.TYPE.s75),scheduleDateInfoToString:u,repeatMessage:this.model.has("recurrence")?this.model.get("recurrence").getMessage(this.model.getStartAtMoment(),this.model.get("isLunar")):"",calendarInfo:n,hasRsvp:d,writer:t.bind((function(){return!!n&&(n.isInternalCalendar&&this.model.get("owner")?this.model.get("owner").get("name"):n.isInternalCalendar||""==n.serviceProvider?void 0:n.serviceProvider)}),this),msg_remainingTime:i,msg_attendeeLimit:o,hasPhotos:!!this.model.get("photos").length,profileThumbnailWithDefault:function(e){return s.makeProfileThumbnailUrl(e)},getRepliedAt:function(e){return h.format.date(e,"short_date_time")},rsvpItemInfoArr:this._generateRsvpInfoArray(),staticMapUrl:c,showScheduleInfo:r.isNormal(this.model.getScheduleType())||r.isExternal(this.model.getScheduleType()),onlyPrintRsvpAttendeeInfo:this._onlyPrintRsvpAttendeeInfo}}},ui:{btnPrint:"._btnPrint"},events:{"click @ui.btnPrint":function(){window.print()}},initialize:function(e){this._selectedRsvpInfo=e.selectedRsvpInfo,this._rsvpTypes=e.rsvpTypes,this._bandNo=e.bandNo,this._loading=!0,this._onlyPrintRsvpAttendeeInfo=!!e.onlyPrintRsvpAttendeeInfo,$("body").css("background-color","#FFF"),this.listenTo(p.getDGlobalChannel(),p.EVENT.WINDOW_RESIZE,t.throttle((function(){this._adjustPositionBtnPrint()})))},onAttach:function(){this.model.get("band")?(this._bandCore=this.model.getBandCore(),this._loading=!1,this.render()):this._setBandData().then(t.bind((function(){this._loading=!1,this.render()}),this))},onDomRefresh:function(){this._loading||(this._adjustPosition&&clearTimeout(this._adjustPosition),this._adjustPosition=setTimeout(t.bind((function(){this._adjustPositionBtnPrint()}),this),300))},_generateRsvpInfoArray:function(){if(t.isEmpty(this._selectedRsvpInfo))return[];var e=t.map(this._selectedRsvpInfo.normalRsvpType,(function(e){var t={count:this._getRsvpMemberCount(e),memberInfoArr:this._sortByMemberName(this._rsvpTypes[e]),membersNameToString:this._getRsvpItemCheckedMembersName(e),sortTitle:IM("member_list.sort.abc")};switch(e){case u.ATTENDANCE:t.title=IM("schedule.rsvp.attendance");break;case u.ABSENCE:t.title=IM("schedule.rsvp.absentee");break;case u.MAYBE:t.title=IM("schedule.rsvp.maybe");break;case u.PENDING_ATTENDANCE:t.title=IM("schedule.rsvp.pending_attendance"),t.sortTitle=IM("member_list.sort.queue")}return t}),this),n=t.map(this._selectedRsvpInfo.customRsvpType,(function(e){var n=t.find(this.model.get("rsvp").getCustomRsvpStatusList(),(function(t){return t.customStateId==e}));return{count:n?n.count:0,memberInfoArr:this._getCustomRsvpSortedMemberName(e),membersNameToString:this._findCustomRsvpMemberNameListBy(e),sortTitle:IM("member_list.sort.abc"),title:n?n.title:""}}),this);return(e||[]).concat(n||[])},_setBandData:function(){return m.getCachedBandData(this._bandNo).then(t.bind((function(e){this.model.set("band",e),this._bandCore=e.getBandCore()}),this))},_adjustPositionBtnPrint:function(){var e=$(window).height(),t=$("body").prop("scrollHeight");this.getUI("btnPrint").removeClass("-fixed"),e<t&&this.getUI("btnPrint").addClass("-fixed")},_sortByMemberName:function(e){return this.model.getRsvp().isRsvpVisibleToViewer()&&null!=e?t.sortBy(e.members,(function(e){return e.member.name})):null},_getCustomRsvpSortedMemberName:function(e){var t=this._findTargetCustomRsvp(e);return null==t?[]:this._sortByMemberName(t)},_getRsvpMemberCount:function(e){switch(e){case u.ATTENDANCE:return this.model.get("rsvp").get("attendeeCount");case u.PENDING_ATTENDANCE:return this.model.get("rsvp").get("pendingAttendeeCount");case u.ABSENCE:return this.model.get("rsvp").get("absenteeCount");case u.MAYBE:return this.model.get("rsvp").get("maybeCount")}},_findTargetCustomRsvp:function(e){return t.find(this._rsvpTypes[u.CUSTOM],(function(t){return t.custom_state_id==e}))},_getRsvpItemCheckedMembersName:function(e){if(!this._onlyPrintRsvpAttendeeInfo&&this.model.getRsvp().isRsvpVisibleToViewer()){var n=t.pluck(this._rsvpTypes[e].members,"member");return t.pluck(n,"name").join(", ")}},_findCustomRsvpMemberNameListBy:function(e){if(!this._onlyPrintRsvpAttendeeInfo&&this.model.getRsvp().isRsvpVisibleToViewer()){var n=this._findTargetCustomRsvp(e);return null==n?"":t.map(n.members,(function(e){return e.member.name})).join(", ")}},_getCalendarInfo:function(){var e=null;return this.model.get("calendar")&&(e={isInternalCalendar:this.model.get("calendar").get("type")==c.TYPE.INTERNAL,name:this.model.get("calendar").get("name"),color:this.model.get("calendar").get("color"),serviceProvider:this.model.get("calendar").get("serviceProvider")?this.model.get("calendar").get("serviceProvider"):""}),e},_getRemainingTimeMsg:function(){var e=this.model.get("rsvp");if(e&&!e.isEmpty()){var t=e.get("endedAt");if(null==t)return null;var n=d.getRemainingTime(t);return n.close?IM("schedule.rsvp.close_attendance_due_date"):IM("rsvp.label.remaining_time_format_"+n.format,{value:n.value})}return null},_getAttendeeLimitMsg:function(){var e=this.model.get("rsvp");return e&&e.get("attendeeLimit")?IM("schedule.rsvp.attendee_limit",{attendeeLimitCount:e.get("attendeeLimit")}):null}});return b.build=function(e){var t=l.createScheduleModelByJSON(e.schedule);return new b({options:e,bandNo:e.bandNo,selectedRsvpInfo:_.convertUriQueryJsonToObject(e.params.selectedRsvpInfo),onlyPrintRsvpAttendeeInfo:e.params.onlyPrintRsvpAttendeeInfo,rsvpTypes:e.rsvp||null,model:t})},b}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="inner">\n    <header class="header">\n        <p class="bandName">\n            <img src="<%- coverImg %>" width="24" alt="">\n            <span class="name"><%-bandName%></span>\n        </p>\n\n        <h1 class="title"><%-name%></h1>\n\n        <h2 class="scheduleDate">\n            <time>\n              <%- scheduleDateInfoToString %>\n            </time>\n        </h2>\n\n        <% if (showScheduleInfo) { %>\n        <dl class="scheduleInfo">\n            <dt class="gSrOnly"><%-IM(\'calendar.band_calendar.txt.calendar_name\')%></dt>\n            <dd class="scheduleName">\n                <%\n                if (!!calendarInfo && !!calendarInfo.color) { %>\n                <span class="color" style="border-color:#<%- calendarInfo.color %>"></span>\n                <% } else { %>\n                <span class="color sf_border  <%-bandSkin%>"></span>\n                <% } %>\n\n                <% if (!!calendarInfo) { %>\n                <span class="name"><%- calendarInfo.name %></span>\n                <% } %>\n            </dd>\n            <dt class="gSrOnly"><%-IM(\'post.writer.label\')%></dt>\n            <dd class="writer"><%- writer() %></dd>\n            <% if(recurrence) { %>\n            <dt class="gSrOnly"><%-IM(\'schedule.edit.recurrence.interval.label\')%></dt>\n            <dd class="repeat">\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-schedule-repeat"></use>\n                </svg>\n                <%-repeatMessage%>\n            </dd>\n            <% } %>\n        </dl>\n        <% } %>\n    </header>\n\n    <main class="main">\n        <% if (!onlyPrintRsvpAttendeeInfo) { %>\n        <div class="infoWrap">\n            <% if (msg_remainingTime || msg_attendeeLimit) { %>\n            <p class="rsvpInfo">\n                <% if (msg_remainingTime) { %><span><%= msg_remainingTime %></span><% } %>\n                <% if (msg_attendeeLimit) { %><span><%= msg_attendeeLimit %></span><% } %>\n            </p>\n            <% } %>\n\n            <% if(!!description) { %>\n            <p class="desc"><%-description%></p>\n            <% } %>\n\n            <% if(hasRsvp) { %>\n            <ul class="rsvpList">\n                <% _.each(rsvpItemInfoArr, function(rsvpItemInfo) { %>\n                <li>\n                    <h3 class="title"><%- rsvpItemInfo.title %> <span><%- rsvpItemInfo.count %></span></h3>\n                    <p class="members"><%- rsvpItemInfo.membersNameToString %></p>\n                </li>\n                <% }); %>\n            </ul>\n            <% } %>\n\n            <% if(!!location){ %>\n            <div class="location">\n                <p class="info">\n                    <svg class="svgIcon" aria-hidden="true">\n                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-location"></use>\n                    </svg>\n                    <span id="location"><%-location.get(\'address\')%></span>\n                </p>\n\n                <div class="map"><img src="<%-staticMapUrl%>" alt="" aria-labelledby="location"></div>\n            </div>\n            <% } %>\n\n            <% if(hasPhotos) { %>\n            <div class="images">\n                <% _.each(photos.models, function(value, index) { %>\n                <img src="<%-value.get(\'url\')%>" alt="">\n                <% }); %>\n            </div>\n            <% } %>\n        </div>\n\n        <% } else { %>\n\n        <div class="rsvpDetail">\n            <% _.each(rsvpItemInfoArr, function(rsvpItemInfo) { %>\n            <section class="type">\n                <div class="titleWrap">\n                    <h3 class="title"><%-rsvpItemInfo.title%> <span><%-rsvpItemInfo.count%></span></h3>\n                    <p class="sort"><%-rsvpItemInfo.sortTitle%></p>\n                </div>\n\n                <% if(rsvpItemInfo.count > 0) { %>\n                <ul class="memberList">\n                    <% _.each(rsvpItemInfo.memberInfoArr, function(memberInfo) { %>\n                    <li>\n                        <span class="thumb">\n                            <img src="<%-profileThumbnailWithDefault(memberInfo.member.profile_image_url)%>" alt="<%-memberInfo.member.name%>">\n                        </span>\n                        <span class="txt">\n                            <strong class="name"><%-memberInfo.member.name%></strong>\n                            <% if(!!memberInfo.member.description){ %>\n                            <span class="info4"><%-memberInfo.member.description%></span>\n                            <% } %>\n                            <time class="gMat1"><%-getRepliedAt(memberInfo.replied_at)%></time>\n                        </span>\n                    </li>\n                    <% }); %>\n                </ul>\n                <% } %>\n            </section>\n            <% }); %>\n        </div>\n\n        <% } %>\n    </main>\n\n    <div class="btnPrintWrap">\n        <button class="btnPrint _btnPrint"><span class="gSrOnly"><%-IM(\'schedule.button.print_schedule\')%></span></button>\n    </div>\n</div>'},function(e,t){e.exports='<div class="lyContent <%- skinColorClass %>">\n    <header class="header -noTitlebar">\n        <h1 class="title"><%-IM(\'schedule.rsvp.select_print_item.title\')%></h1>\n    </header>\n\n    <div class="main">\n        <p class="p"><%-msgDesc%></p>\n\n        <ul class="selectArea gMat20">\n            <li class="rsvpPrintItem">\n                <label for="rsvpPrintItem1_<%- cid %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="rsvpPrintItem1_<%- cid %>" class="checkInput _btnAllSelect">\n                    <span class="checkLabel">\n                        <span class="shape sf_afterBg"></span>\n                        <span class="text -multiEllipsis"><%-IM(\'ui.label.all_select\')%></span>\n                    </span>\n                </label>\n            </li>\n            <li class="rsvpPrintItem">\n                <label for="rsvpPrintItem2_<%- cid %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="rsvpPrintItem2_<%- cid %>" value="<%-ATTENDANCE%>" class="checkInput _inputRsvpTypes _fixedRsvpInput">\n                    <span class="checkLabel">\n                        <span class="shape sf_afterBg"></span>\n                        <span class="text -multiEllipsis"><%-IM(\'schedule.rsvp.attendance\')%></span>\n                    </span>\n                </label>\n            </li>\n            <li class="rsvpPrintItem">\n                <label for="rsvpPrintItem3_<%- cid %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="rsvpPrintItem3_<%- cid %>" value="<%-ABSENCE%>" class="checkInput _inputRsvpTypes _fixedRsvpInput">\n                    <span class="checkLabel">\n                        <span class="shape sf_afterBg"></span>\n                        <span class="text -multiEllipsis"><%-IM(\'schedule.rsvp.absentee\')%></span>\n                    </span>\n                </label>\n            </li>\n            <% if (isMaybeEnabled) { %>\n            <li class="rsvpPrintItem">\n                <label for="rsvpPrintItem4_<%- cid %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="rsvpPrintItem4_<%- cid %>" value="<%-MAYBE%>" class="checkInput _inputRsvpTypes _fixedRsvpInput">\n                    <span class="checkLabel">\n                        <span class="shape sf_afterBg"></span>\n                        <span class="text -multiEllipsis"><%-IM(\'schedule.rsvp.maybe\')%></span>\n                    </span>\n                </label>\n            </li>\n            <% } %>\n            <li class="rsvpPrintItem">\n                <label for="rsvpPrintItem5_<%- cid %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="rsvpPrintItem5_<%- cid %>" value="<%-PENDING_ATTENDANCE%>" class="checkInput _inputRsvpTypes _fixedRsvpInput">\n                    <span class="checkLabel">\n                        <span class="shape sf_afterBg"></span>\n                        <span class="text -multiEllipsis"><%-IM(\'schedule.rsvp.pending_attendance\')%></span>\n                    </span>\n                </label>\n            </li>\n            <% _.each(customStateList, function(eachCustomState) { %>\n            <li class="rsvpPrintItem">\n                <label for="<%- eachCustomState.targetId %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="<%- eachCustomState.targetId %>" value="<%- eachCustomState.customStateId %>" class="checkInput _inputRsvpTypes _customRsvpInput">\n                    <span class="checkLabel">\n                        <span class="shape sf_afterBg"></span>\n                        <span class="text -multiEllipsis"><%- eachCustomState.title %></span>\n                    </span>\n                </label>\n            </li>\n            <% }); %>\n        </ul>\n    </div>\n\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _btnCancel"><%-IM("ui.label.cancel")%></button>\n        <button type="button" class="uButton -confirm _btnConfirm" disabled><%-IM("ui.label.confirm")%></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n\n        <h1 class="title"><%- title %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <% // 참석 상태 tab %>\n            <div class="_stateTabRegion"></div>\n\n            <% // 참석자 목록 %>\n            <div class="presentStateBox">\n\n                <% if ( needShowCustomInfo ) { %>\n                <div class="customItemBox gMat12 gPab18">\n                    <div class="uInput -h32 -dropDown -bgNone _dropDownWrapper" style="width:250px">\n                        <button type="button" aria-haspopup="listbox" aria-expanded="true" class="dropdownToggle -flexible">\n                            <span class="customText -ellipsis _selectedCustomItemText"></span>\n                            <span class="attendantsCount sf_color _selectedCustomItemCount"></span></button>\n                        <ul class="dropDown" style="left:auto;right:0;max-width: 250px;max-height: none">\n                            <% _.each(customStateList, function(customStateItem) { %>\n                            <li class="dropDownItem" role="option"><button class="btnDropDownItem" type="button" data-custom-state-id="<%= customStateItem.customStateId %>" title="<%- customStateItem.title %>"><%- customStateItem.title %></button></li>\n                            <% }); %>\n                        </ul>\n                    </div>\n                </div>\n                <% } %>\n\n                <% // 참석자/불참석자/미정자 목록인 경우만 멤버 추가 버튼 노출 %>\n                <% if (canShowAddMemberButton) { %>\n                <div class="addMemberAttend _btnChangeRsvpState"><a href="#" class="button" role="button"><%= addMemberButtonLabel %></a></div>\n                <% } %>\n                <div class="_memberListRegion"></div>\n                <p class="guide _rsvpStateHelpGuide" style="top:171px">\n                    <strong class="gSrOnly"><%- IM(\'schedule.rsvp.change_state.help_guide.title\') %></strong>\n                    <%- IM(\'schedule.rsvp.change_state.help_guide.desc\') %>\n                    <button type="button" class="close _btnCloseLayer"><span class="gSrOnly"><%- IM(\'ui.label.close_layer\') %></span></button>\n                </p>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n        <div class="rsvpOptions">\n            <button type="button" class="uButton -iconExport _btnRsvpLyMore" aria-haspopup="true" aria-expanded="false" aria-controls="rsvpLyMore">참석자 옵션 메뉴</button>\n            <ul class="lyMenu _rsvpLyMore" id="rsvpLyMore">\n                <li><button type="button" class="_btnExcelDownload"><%-IM(\'ui.label.excel_download\')%></button></li>\n                <li><button type="button" class="_btnPrint"><%-IM(\'ui.label.print\')%></button></li>\n            </ul>\n        </div>\n    </footer>\n</div>'},function(e,t){e.exports='<% // RSVP %>\n<%\nvar viewUniqueId = _.uniqueId("view_");\n%>\n\n<% if ( needShowRsvpVisibleDescription ) { %>\n<div class="scheduleGuideText">\n    <%= IM("schedule.rsvp.visible_qualification.description") %>\n</div>\n<% } %>\n\x3c!-- 외부 멤버 추가 버튼 --\x3e\n<% if (canAddChildMember) { %>\n<div class="outsidersAdd gPat21 gPab20">\n    <button type="button" class="btnAdd _addChildMember" data-statusType="<%= statusType.ATTENDANCE %>"><%- IM(\'schedule.view.rsvp.add_child_member.title\') %></button>\n</div>\n<% } %>\n\n<ul class="attend">\n    <% // 참석 %>\n    <li class="uTableList">\n        <label for="<%= viewUniqueId %>_attend" class="cell">\n            <span class="uCheck -checkbox -noLabel <% if (!canCheckRsvpItem(statusType.ATTENDANCE)) { %> -disabled<% } %>">\n                <input class="checkInput _radioAttend" id="<%= viewUniqueId %>_attend" type="checkbox" value="<%= statusType.ATTENDANCE %>" <% if (!canCheckRsvpItem(statusType.ATTENDANCE)) { %> disabled="disabled"<% } %>>\n                <span class="checkLabel">\n                    <span class="shape sf_afterBg"></span>\n                </span>\n            </span>\n        </label>\n        <label for="<%= viewUniqueId %>_attend" class="cell">\n            <span class="checkInfo">\n                <strong class="labelTitle"><%- IM("schedule.rsvp.attendance") %></strong>\n                <% if ( canShowRsvpUser) { %>\n                <span class="labelDesc"><%- getRsvpUserList(attendeeList) %></span>\n                <% } %>\n            </span>\n        </label>\n        <span class="cell">\n            <a href="#" role="button" class="link sf_color _btnOpenAttendee <% if (!canShowRsvpStateMember(statusType.ATTENDANCE)) { %> -disabled <% } %>" data-statusType="<%= statusType.ATTENDANCE %>">\n                <% if (attendeeCount > 0) { %><%= attendeeCount %><% } %>\n                <span class="gSrOnly"><%= IM("schedule.rsvp.title") %></span>\n            </a>\n        </span>\n    </li>\n\n    <% // 참석 대기 %>\n    <li class="uTableList _pendingAttendArea" style="display: none;">\n        <label for="<%= viewUniqueId %>_pendingAttend" class="cell">\n            <span class="uCheck -checkbox -noLabel <% if (!canCheckRsvpItem(statusType.PENDING_ATTENDANCE)) { %> -disabled<% } %>">\n                <input class="checkInput _radioPendingAttend" id="<%= viewUniqueId %>_pendingAttend" type="checkbox" value="<%= statusType.PENDING_ATTENDANCE %>" <% if (!canCheckRsvpItem(statusType.PENDING_ATTENDANCE)) { %> disabled="disabled"<% } %>>\n                <span class="checkLabel">\n                    <span class="shape sf_afterBg"></span>\n                </span>\n            </span>\n        </label>\n        <label for="<%= viewUniqueId %>_pendingAttend" class="cell">\n           <span class="checkInfo">\n                <strong class="labelTitle"><%- IM("schedule.rsvp.pending_attendance") %></strong>\n                <% if (viewerPendingNumber) { %>\n                <span class="labelStatus sf_color"><%= IM("schedule.rsvp.viewer_pending_order", {viewerPendingNumber: viewerPendingNumber}) %></span>\n                <% } %>\n               <% if ( canShowRsvpUser) { %>\n                <span class="labelDesc"><%- getRsvpUserList(pendingAttendeeList) %></span>\n                <% } %>\n            </span>\n        </label>\n        <span class="cell">\n            <a href="#" role="button" class="link sf_color _btnOpenPendingAttendee <% if (!canShowRsvpStateMember(statusType.PENDING_ATTENDANCE)) { %> -disabled <% } %>" data-statusType="<%= statusType.PENDING_ATTENDANCE %>">\n                <% if (pendingAttendeeCount > 0) { %><%= pendingAttendeeCount %><% } %>\n                <span class="gSrOnly"><%= IM("schedule.rsvp.title") %></span>\n            </a>\n        </span>\n    </li>\n\n    <% // 불참 %>\n    <li class="uTableList">\n        <label for="<%= viewUniqueId %>_absence" class="cell">\n            <span class="uCheck -checkbox -noLabel <% if (!canCheckRsvpItem(statusType.ABSENCE)) { %> -disabled<% } %>">\n                <input class="checkInput _radioAbsent" id="<%= viewUniqueId %>_absence" type="checkbox" value="<%= statusType.ABSENCE %>" <% if (!canCheckRsvpItem(statusType.ABSENCE)) { %> disabled="disabled"<% } %>>\n                <span class="checkLabel">\n                    <span class="shape sf_afterBg"></span>\n                </span>\n            </span>\n        </label>\n        <label for="<%= viewUniqueId %>_absence" class="cell">\n            <span class="checkInfo">\n                <strong class="labelTitle"><%- IM("schedule.rsvp.absentee") %></strong>\n                <% if ( canShowRsvpUser) { %>\n                <span class="labelDesc"><%- getRsvpUserList(absenteeList) %></span>\n                <% } %>\n            </span>\n        </label>\n        <span class="cell">\n            <a href="#" role="button" class="link sf_color _btnOpenAbsentee <% if (!canShowRsvpStateMember(statusType.ABSENCE)) { %> -disabled <% } %>" data-statusType="<%= statusType.ABSENCE %>">\n                <% if (absenteeCount > 0) { %><%= absenteeCount %><% } %>\n                <span class="gSrOnly"><%= IM("schedule.rsvp.title") %></span>\n            </a>\n        </span>\n    </li>\n\n    <% if (isMaybeEnabled) { %>\n    <li class="uTableList">\n        <label for="<%= viewUniqueId %>_maybe" class="cell">\n            <span class="uCheck -checkbox -noLabel <% if (!canCheckRsvpItem(statusType.MAYBE)) { %> -disabled<% } %>">\n                <input class="checkInput _radioMaybe" id="<%= viewUniqueId %>_maybe" type="checkbox" value="<%= statusType.MAYBE %>" <% if (!canCheckRsvpItem(statusType.MAYBE)) { %> disabled="disabled"<% } %>>\n                <span class="checkLabel">\n                    <span class="shape sf_afterBg"></span>\n                </span>\n            </span>\n        </label>\n        <label for="<%= viewUniqueId %>_maybe" class="cell">\n            <span class="checkInfo">\n                <strong class="labelTitle"><%- IM("schedule.rsvp.maybe") %></strong>\n                <% if ( canShowRsvpUser) { %>\n                <span class="labelDesc"><%- getRsvpUserList(maybeList) %></span>\n                <% } %>\n            </span>\n        </label>\n        <span class="cell">\n            <a href="#" class="link sf_color _btnOpenMaybe <% if (!canShowRsvpStateMember(statusType.MAYBE)) { %> -disabled <% } %>" data-statusType="<%= statusType.MAYBE %>">\n                <% if (maybeCount > 0) { %><%= maybeCount %><% } %>\n                <span class="gSrOnly"><%= IM("schedule.rsvp.title") %></span>\n            </a>\n        </span>\n    </li>\n    <% } %>\n\n    <% _.each(customRsvpList, function(customRsvpItem) {%>\n    <li class="uTableList">\n        <label for="view_<%= customRsvpItem.customStateId %>" class="cell">\n            <span class="uCheck -checkbox -noLabel <% if (!canCheckRsvpItem(statusType.CUSTOM)) { %> -disabled<% } %>">\n                <input class="checkInput _replyCustomStatus" id="view_<%= customRsvpItem.customStateId %>" data-custom-state-id="<%= customRsvpItem.customStateId %>" type="checkbox" value="<%= customRsvpItem.rsvpState %>" <% if (!canCheckRsvpItem(statusType.CUSTOM)) { %> disabled="disabled"<% } %>>\n                <span class="checkLabel">\n                    <span class="shape sf_afterBg"></span>\n                </span>\n            </span>\n        </label>\n        <label for="view_<%= customRsvpItem.customStateId %>" class="cell">\n            <span class="checkInfo">\n                <strong class="labelTitle"><%- customRsvpItem.title %></strong>\n                <% if ( canShowRsvpUser) { %>\n                <span class="labelDesc"><%- getRsvpUserList(customRsvpItem.members) %></span>\n                <% } %>\n            </span>\n        </label>\n        <span class="cell">\n            <a href="#" role="button" class="link sf_color _btnOpenRsvpUserList <% if (!canShowRsvpStateMember(statusType.CUSTOM)) { %> -disabled <% } %>" data-statustype="<%= customRsvpItem.rsvpState %>" data-custom-state-id="<%= customRsvpItem.customStateId %>">\n                <% if (customRsvpItem.count > 0) { %><%= customRsvpItem.count %><% } %>\n                <span class="gSrOnly"><%= IM("web.schedulersvp.topbar.text.title") %></span>\n            </a>\n        </span>\n    </li>\n    <% }); %>\n</ul>\n\n<% // 미참여 인원 %>\n<% if (!isSecret) { %>\n<p class="pollNonInfo">\n    <a href="#" class="link _btnOpenNonresponse <% if (!canShowRsvpStateMember(statusType.NONRESPONSE)) { %> -disabled <% } %>" data-statusType="<%= statusType.NONRESPONSE %>">\n        <%= IM("schedule.rsvp.nonresponse_member") %>\n        <% if (nonresponseCount > 0) { %><strong class="sf_color"><%= nonresponseCount %></strong><% } %>\n    </a>\n</p>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(2),s=n(531),a=n(593),r=n(2035),l=n(2517),c=t.View.extend({className:"btnRemindWrap",attributes:{"data-viewname":"DSchedulePersonalAlarmView"},template:i.template(l),ui:{alarmMessage:"._alarmMessage",btnAddAlarm:"._btnAddAlarm"},events:{"click @ui.alarmMessage":"_updateAlarm","click @ui.btnAddAlarm":"_createAlarm"},initialize:function(e){this.scheduleModel=e.scheduleModel},serializeData:function(){return{MAX_COUNT:s.MAX_COUNT_FOR_PERSONAL_ALARM,alarmList:this._getAlarmList()}},_getAlarmList:function(){var e=this.scheduleModel.get("isAllDay"),t=this.scheduleModel.get("personalAlarms").getSortedInTimeList(this.scheduleModel.get("startAt")),n=[];return i.each(t,(function(t){var o=t.get("durationType")+"_"+t.get("amount");i.isNull(t.get("alarmTime"))||(o+="_"+t.get("alarmTime")),a.isValidAlarm(t)&&n.push({key:o,message:a.getFullMessage(e,t),cid:t.cid})})),n},_updateAlarm:function(e){var t=o(e.currentTarget).data("key"),n=o(e.currentTarget).data("cid"),i=this.scheduleModel.get("personalAlarms").findAlarmItemByCid(n);this._showEditAlarmLayer(t,i)},_createAlarm:function(){this._showEditAlarmLayer()},_showEditAlarmLayer:function(e,t){var n={bandNo:this.scheduleModel.get("bandNo"),scheduleId:this.scheduleModel.get("scheduleId"),isAllDay:this.scheduleModel.get("isAllDay"),personalAlarms:this.scheduleModel.get("personalAlarms")?this.scheduleModel.get("personalAlarms"):null,alarms:this.scheduleModel.get("alarms")?this.scheduleModel.get("alarms"):null,isPersonalAlarm:!0};e&&t&&(n.updateTargetAlarm={key:e,model:t}),r.openAsLayer(n)}});return c.build=function(e){return new c({scheduleModel:e.scheduleModel})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% _.each(alarmList, function(alarm) { %>\n    <button type="button" class="_alarmMessage" data-key="<%- alarm.key %>" data-cid="<%= alarm.cid %>"><%- alarm.message %></button>\n<% }); %>\n<% if (alarmList.length < MAX_COUNT) { %>\n    <button type="button" class="_btnAddAlarm"><%= IM("schedule.detail.button.add_schedule_alarm") %></button>\n<% } %>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(0),o=n(16),s=n(486),a=n(9),r=n(503),l=n(589),c=n(2519),d=n(82),u=t.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DScheduleHistoryView"},template:i.template(c),templateContext:{getTextDate:function(e){return o(e).format(o.defaultFormat)},getRelativeTime:function(e){return a.format.relative(e,"month_day_time")},makeProfileThumbnailUrl:function(e){return d.makeProfileThumbnailUrl(e)},makeProfileInnerClass:function(e){return d.makeProfileInnerClass(d.makeProfileThumbnailUrl(e))}},ui:{profileImage:"._profileImage",btnConfirm:"._btnConfirm"},events:{"click @ui.profileImage":"_openProfileLayer","click @ui.btnConfirm":"destroy"},initialize:function(e){this._loading=!1,this.scheduleHistory=[],this.bandNo=e.bandNo,this.scheduleId=e.scheduleId},serializeData:function(){return this._loading?{isLoading:this._loading,historyList:this._getHistoryList()}:{isLoading:this._loading}},onAttach:function(){return r.fetchScheduleHistory(this.bandNo,this.scheduleId).then(i.bind((function(e){this._loading=!0,this.scheduleHistory=e.schedule_history,this.render()}),this))},_getHistoryList:function(){return this.scheduleHistory},_openProfileLayer:function(e){var t=$(e.currentTarget).data("userNo");t&&l.openProfileView(this.bandNo,t)}});return u.openAsLayer=function(e){var t=new u({bandNo:e.bandNo,scheduleId:e.scheduleId});return s.open(t),t},u}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="header">\n        <h1 class="title"><%= IM("schedule.modify_history.title") %></h1>\n    </header>\n    <div class="main -tSpaceNone">\n        <ul class="listLine rScroll -h360">\n\t\t<% if (isLoading) { %>\n\t\t\t<% _.each(historyList, function(history, index) { %>\n\t\t\t\t<li class="tLine flexList">\n\t\t\t\t\t<span class="text">\n\t\t\t\t\t\t<span class="ellipsis2">\n\t\t\t\t\t\t\t<%- IM("schedule.detail.modify_history.desc", {editor: history.editor.name}) %>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<time class="blockTime" datetime="<%- getTextDate(history.created_at) %>"><%- getRelativeTime(history.created_at) %></time>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="thumb -alignT">\n\t\t\t\t\t\t<a href="#" role="button" class="_profileImage" data-user-no="<%- history.editor.user_no %>">\n\t\t\t\t\t\t<span class="uProfile -size40">\n\t\t\t\t\t\t\t<span class="profileInner <%- makeProfileInnerClass(history.editor.profile_image_url) %>">\n\t\t\t\t\t\t\t\t<% if (history.editor.profile_image_url) { %>\n\t\t\t\t\t\t\t\t<img src="<%- makeProfileThumbnailUrl(history.editor.profile_image_url) %>" alt="<%= IM(\'web.profile.title\') %>">\n\t\t\t\t\t\t\t\t<% } %>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t<% }); %>\n\t\t<% } %>\n        </ul>\n    </div>\n    <footer class="footer -tLine">\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM("ui.label.confirm") %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=(n(10),n(4)),o=n(2521),s=n(159),a=(n(153),i.View.extend({className:"scheduleOtherAttachInfo",attributes:{"data-viewname":"DScheduleLinkedPostInfoView"},template:t.template(o),templateContext:function(){var e={linkedPostExist:this._linkedPostExist};return this._linkedPostExist?e.linkedPostMessage=IM("schedule.linked_post_exist"):e.linkedPostMessage=IM("schedule.write_schedule_attached_post"),e},behaviors:{CourierBehavior:""},ui:{linkedPostAnchor:"._linkedPostAnchor"},events:{"click @ui.linkedPostAnchor":function(){return this._linkedPostExist?(this._hasMoreLinkedPosts?this.spawn(s.MSG.SCHEDULE_GO_LINKED_POSTS,this._scheduleId):this.spawn(s.MSG.SCHEDULE_GO_LINKED_POST,this._linkedPostModel.get("postNo")),!1):(this.spawn(s.MSG.SCHEDULE_WRITE_LINKED_POST),!1)}},initialize:function(e){this._bandNo=e.bandNo,this._scheduleId=e.scheduleId,this._linkedPostModel=e.linkedPostModel,this._linkedPostExist=null!=this._linkedPostModel,this._hasMoreLinkedPosts=e.hasMoreLinkedPosts},serializeData:function(){return this._linkedPostExist?this._linkedPostModel.toJSON():{}}}));return a.buildDScheduleLinkedPostInfoView=function(e){return new a(e)},a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<a href="#" class="scheduleOtherAttachLink _linkedPostAnchor">\n    <div class="scheduleAttachWrap">\n        <p class="scheduleAttachText"><%- linkedPostMessage %></p>\n    </div>\n</a>'},function(e,t,n){var i=n(0),o=n(4),s=n(2523),a=n(618),r=o.View.extend({tagName:"li",className:"tLine flexList",template:i.template(s),ui:{profileImageRegion:"._profileImageRegion"},regions:{profileImageRegion:"@ui.profileImageRegion"},templateContext:function(){return{escapedName:i.escape(this.model.getName()),escapedDesc:i.escape(this.model.getDescription())}},initialize:function(e){this.bandCore=e.bandCore},onDomRefresh:function(){var e=a.buildContentCreatorProfileImageView({memberProfile:this.model.getMemberProfile(),bandCore:this.bandCore,userNoOrMemberKey:this.model.getUserNo()});this.showChildView("profileImageRegion",e)}});e.exports=r},function(e,t){e.exports='<span class="thumb">\n    <div class="_profileImageRegion"></div>\n</span>\n<span class="text">\n    <span class="ellipsis"><%=escapedName %></span>\n    <span class="sub2 -ellipsis"><%=escapedDesc %></span>\n</span>'},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%= IM("schedule.secret.check_member.title") %> <span><%= memberCount %></span></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="memberListBox">\n                <form class="searchWrap _searchForm">\n                    <label for="searchMember5" class="searchIcon"><span class="gSrOnly"><%=IM("web.bandmember.search_member") %></span></label>\n                    <span class="inputWrap">\n                        <input type="search" id="searchMember5" class="inputSearch _searchInput" placeholder="<%=IM("band_member_select.label.name") %>">\n                    </span>\n                    <button type="submit" class="btnSearch uButton -sizeS -default _searchBtn"><%=IM("ui.label.search") %></button>\n                </form>\n                <div class="memberListStatusBar">\n                    <p class="count"><%= IM("web.bandmember.title") %></p>\n                </div>\n                <div class="_memberListRegion"></div>\n            </div>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <div class="memberDisclosedText"><%=IM("schedule.secret.visible_to_leader") %></div>\n        <button type="button" class="btnLyBack uButton -iconLyBack _backBtn"><span class="gSrOnly"><%=IM("ui.label.back") %></span></button>\n        <button type="button" class="uButton -confirm _confirmBtn"><%=IM("ui.label.confirm") %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(4),s=n(623),a=n(508),r=n(159),l=n(154),c=n(592),d=n(26),u=n(1049),h=n(487),p=n(560),m=n(509),_=n(2041),g=n(1037),f=o.View.extend({template:i.template('<h1 class="gSrOnly">'+IM("discover.post.comment.title")+'</h1><div class="_scheduleCommentListRegion"></div><div class="cCommentWrite _commentInputRegion"></div>'),attributes:{"data-viewname":"DScheduleCommentMainView","data-type":"comment"},behaviors:[r,h],ui:{scheduleCommentListRegion:"._scheduleCommentListRegion",commentInputRegion:"._commentInputRegion"},regions:{scheduleCommentListRegion:{el:"@ui.scheduleCommentListRegion",replaceElement:!0},commentInputRegion:"@ui.commentInputRegion"},onMessages:(t={},t[r.MSG.MESSAGE_INPUT_TEXTAREA_FOCUS]=function(e){this._mostRecentlyFocusedInputView=e},t[r.MSG.COMMENT_SUMMON_AUTHOR]=function(e){this._summonAuthor(e)},t[r.MSG.COMMENT_CHANGE_TO_MODIFICATION_MODE]=function(){this._hideInputView()},t[r.MSG.COMMENT_CANCEL_MODIFICATION]=function(){this._showInputView()},t[r.MSG.COMMENTLIST_SHOW_INPUT]=function(){this._showInputView()},t[r.MSG.MESSAGE_INPUT_SUBMIT]=function(e){var t=e.submitData;p.writeComment(this._bandNo,m.buildScheduleKey(this._scheduleId).toApiParams(!0),e.isSecret,t,e.memberType,this).then(i.bind((function(t){var n=t.comment.comment_id;this._scheduleCommentListView.fetchAroundComment(n).then(i.bind((function(){d.getCommentChannel().trigger(d.EVENT.BAND_FILE_UPDATED),this._scheduleCommentListView.scrollToCommentWithDelay(n),this._sendCreateConfirmLog(e)}),this))}),this)).always(i.bind((function(){this._messageInputView.releaseStandByMode()}),this))},t),initialize:function(e){this._bandData=e.bandData,this._bandNo=this._bandData.getBandNo(),this._scheduleId=e.scheduleId,this._isCommentingPermitted=this._bandData.canWriteComment(),this._commentCollection=this._createCommentCollection(),this._canWriteComment=this._bandData.canWriteComment(),this._initCommentId=e.initCommentId,this._initCommentReplyId=e.initCommentReplyId,this._mentionOption=e.mentionOption,this._domHeightDectector=new c},onAttach:function(){this._scheduleCommentListView=_.buildDScheduleCommentListView({bandData:this._bandData,scheduleId:this._scheduleId,initCommentId:this._initCommentId,initCommentReplyId:this._initCommentReplyId,mentionOption:this._mentionOption}),this.showChildView("scheduleCommentListRegion",this._scheduleCommentListView),this._isCommentingPermitted&&(this._messageInputView=this._createCommentInputView(),this.showChildView("commentInputRegion",this._messageInputView))},scrollToMessageInput:function(){this._isCommentingPermitted&&this._canWriteComment&&!this.isDestroyed()&&(this._scrollToInputAndFocus(),this.stopListening(this._domHeightDectector),this.listenTo(this._domHeightDectector,c.EVENT.HEIGHT_CHANGED,this._scrollToInputAndFocus),this._domHeightDectector.startDetecting(this._messageInputView.getScrollParent(),100,5))},scrollToCommentArea:function(){l.wrapActiveSetTimeout(200,this).then(i.bind((function(){var e=this.$el.scrollParent(),t=this.$el.position().top-200;e.scrollTop(t)}),this))},isModificationStatus:function(){return!(this.isDestroyed()||!this._scheduleCommentListView)&&this._scheduleCommentListView.isModificationStatus()},hasWritingComment:function(){return!(!this._messageInputView||!this._messageInputView.hasInputContent())||g.hasWritingInputDescendantOf(this.$el)},_sendCreateConfirmLog:function(e){var t=i.extend({band_no:this._bandNo,schedule_id:this._scheduleId},e.jplExtra);this.jplClick(h.CLASSIFIER.COMMENT_CREATE_CONFIRM,t)},_createCommentInputView:function(){return u.buildDCommentInputView({messageLabel:IM("comment.write_comment"),textareaPlaceHolder:IM("comment.write_comment"),buttonLabel:IM("ui.label.send"),maxMessageLength:a.MAX_LENGTH,overMaxLengthAlertMessage:IM("comment.over_max_message",{count:a.MAX_LENGTH}),bandNo:this._bandNo,standByMessage:IM("ui.label.sending"),readOnlyTextarea:!this._canWriteComment,preventAllEvent:!this._canWriteComment,currentProfileMemberType:this._bandData.getCurrentSelectedMemberProfileMemberTypeAtComment(),memberProfileArray:this._bandData.getSelectableMemberProfilesAtComment(),isStickerOnTop:!0,mentionOption:this._mentionOption})},_scrollToInputAndFocus:function(){clearTimeout(this._scrollTimer);var e=l.wrapActiveSetTimeout(100,this).then(i.bind((function(){this._messageInputView.scrollToInput(this._getInputPosition()).then(i.bind((function(){this._messageInputView.focusMessageTextArea()}),this))}),this));this._scrollTimer=e.timer},_getInputPosition:function(){var e=this.getUI("commentInputRegion");return{isInLayer:!!e.closest(".lyWrap").length,position:e.position(),offset:e.offset()}},_hideInputView:function(){this.ui.scheduleCommentListRegion.attr("data-status","commentHide"),this.ui.commentInputRegion.hide()},_showInputView:function(){this.ui.scheduleCommentListRegion.removeAttr("data-status"),this.ui.commentInputRegion.show()},_summonAuthor:function(e){this._bandData.canWriteComment()&&this._messageInputView&&!this._messageInputView.isDestroyed()&&(this._mostRecentlyFocusedInputView&&!this._mostRecentlyFocusedInputView.isDestroyed()?this._mostRecentlyFocusedInputView.appendMention(e.userNo,e.userName):this._messageInputView.appendMention(e.userNo,e.userName))},_createCommentCollection:function(){return s.buildDetailCommentCollection({bandNo:this._bandNo,ownerContentKey:m.buildScheduleKey(this._scheduleId),contentKeyButCommentId:m.buildScheduleCommentKey(this._scheduleId,null)})}});return f.buildDScheduleCommentMainView=function(e){return new f(e)},f}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(1566),a=n(2527),r=n(152),l=n(9),c=n(153),d=n(653),u=n(26),h=n(937);return o.View.extend({tagName:"div",className:"uWidget",attributes:function(){var e={"data-viewname":"DPostScheduleGroupDetailView"};return this.options.attachmentDisplayType===r.ATTACHMENT_DISPLAY_TYPE.DETAIL&&(e["data-widget"]="expanded"),e},getTemplate:function(){return this.model.isAllScheduleDeleted()?t.template(s):t.template(a)},templateContext:function(){return{scheduleCount:this.model.getScheduleCount(),getScheduleDay:t.bind((function(e){var t=this.model.getScheduleModelAt(e).getStartAtMoment();return i.lpad(t.format("D"),2,"0")}),this),getScheduleDayName:t.bind((function(e){var t=this.model.getScheduleModelAt(e).getStartAtMoment();return!!t&&t.format(l.isKoreanLanguage()?"dddd":"ddd")}),this),getScheduleDateTime:t.bind((function(e){var t=this.model.getScheduleModelAt(e);return d.multilineMessageForString(t.toJSON())}),this),getScheduleDetailUrl:t.bind((function(e){var t=this.model.getScheduleModelAt(e);return c.GROUP_BAND_SCHEDULE.makeUrl({band_no:this._bandNo,schedule_id:t.getScheduleId()})}),this)}},events:{"click ._linkScheduleDetail":function(e){if(this._clickDisabledPostTypeOnDetail)return!1;var t=this.model.getScheduleModelAt($(e.currentTarget).data("index"));return this._openScheduleDetail(t),!1}},initialize:function(e){this.model=e.model,this._bandData=e.bandData,this._richPostModel=e.postModel,this._bandNo=e.bandNo,this._clickDisabledPostTypeOnDetail=e.clickDisabledPostTypeOnDetail},serializeData:function(){return this.model.toJSON()},onAttach:function(){this._listenToScheduleEvent()},_listenToScheduleEvent:function(){this.listenTo(u.getDGlobalChannel(),u.EVENT.SCHEDULE_DELETED,t.bind((function(e){this._triggerPostUpdatedByScheduleChanged(e.bandNo,e.scheduleId)}),this)),this.listenTo(u.getDGlobalChannel(),u.EVENT.SCHEDULE_UPDATED,t.bind((function(e){this._triggerPostUpdatedByScheduleChanged(e.bandNo,e.exScheduleId)}),this))},_triggerPostUpdatedByScheduleChanged:function(e,t){this.model.getSchedules().find((function(n){return e===n.getBandNo()&&t===n.getScheduleId()}))&&u.getPostChannel().trigger(u.EVENT.POST_UPDATED,this._richPostModel.getPostNo())},_openScheduleDetail:function(e){!e.isDelete()&&this._bandData.canAccessCalendar()&&h.openScheduleDetailLayerView({bandNo:this._richPostModel.getBandNo(),scheduleId:e.getScheduleId()})}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="item -multiSchedule">\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-mutiSchedule sf_color" aria-hidden="true">\n                <use xlink:href="#ico-attach-mutiSchedule"></use>\n            </svg>\n            <span class="status sf_color"><%= IM(\'post.schedule_group.schedule_count\', {scheduleCount: scheduleCount}) %></span>\n        </p>\n        <p class="addTitle"><%- title %></p>\n    </div>\n    <div class="addDetail">\n        <ul class="multiScheduleList">\n            <% _.each(schedules, function(schedule, index) { %>\n            <li class="multiScheduleItem">\n\n                <% if (!schedule.isDelete) { %>\n                <div class="dateInfo">\n                    <span class="date"><%= getScheduleDay(index) %></span>\n                    <span class="dayOfWeek sf_color"><%= getScheduleDayName(index) %></span>\n                </div>\n                <div class="scheduleInfoBox">\n                    <div class="scheduleItemTitle"><%- schedule.name %></div>\n                    <div class="scheduleItemDate"><%= getScheduleDateTime(index) %></div>\n                    <a href="<%- getScheduleDetailUrl(index) %>" class="detailViewLink _linkScheduleDetail" data-index="<%= index %>"></a>\n                </div>\n                <% } %>\n\n                <% if (schedule.isDelete) { %>\n                <div class="dateInfo"></div>\n                <div class="scheduleInfoBox">\n                    <div class="deletedSchedule"><%= IM(\'web.postlist.attachschedule.title.deleted_or_secret_schedule\') %></div>\n                </div>\n                <% } %>\n\n            </li>\n            <% }); %>\n        </ul>\n    </div>\n</div>'},function(e,t){e.exports='<div <% if (showDetail) { %>class="item -todo"<% } else { %>class="item -todo _attachmentTodo" tabindex="-1"<% } %>>\n<% // 할 일 Title 정보 (글 목록과 글 상세에서 모두 노출) %>\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-todo sf_color" aria-hidden="true">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-todo<% if (!showDetail) { %>-22<% } %>"></use>\n            </svg>\n            <span class="status sf_color"><%= IM("web.postlist.todo.txt.title") %></span>\n            <%= isAllDone ? IM("web.postlist.todo.txt.done") : IM("web.postlist.todo.txt.in_progress", {doneCount: doneCount, taskCount: taskCount}) %>\n        </p>\n        <p class="addTitle"><%- title %></p>\n        <% if (remainingTime) { %>\n        <time class="timeSUp sf_color"><%= remainingTime %></time>\n        <% } %>\n        <% if (showDetail && isOpen && condition.isCheckableOnlyByAuthor) { %>\n        <span class="alert"><%- IM("web.postdetail.todo.message.isCheckableOnlyByAuthor") %></span>\n        <% } %>\n        <% if (!showDetail && todoCount > 1) { %>\n        <p class="guideText"><%- IM("web.postlist.todo.txt.more_todo_exist", {count: todoCount - 1}) %></p>\n        <% } %>\n    </div>\n\n<% // 할 일 상세 (글 상세에서 노출) %>\n<% if (showDetail) { %>\n    <div class="addDetail">\n        <ul class="todoCheckList">\n            <% _.each(tasks, function(task, index) { %>\n            <li class="todoCheckItem  <% if (task.isChecked) { %> active <% } %>">\n                <div class="flexList">\n                    <label class="etc gMar15" for="task_<%- task.taskId + \'_\' + index %>">\n                        <span class="uCheck -checkbox -noLabel">\n                            <input type="checkbox" id="task_<%- task.taskId + \'_\' + index %>" class="checkInput _todoCheck" name="task" data-taskid="<%- task.taskId %>" data-index="<%- index %>"<% if (task.isChecked) { %> checked="checked"<% } %><% if (!condition.isCheckboxClickable) { %> disabled="disabled"<% } %>>\n                            <span class="checkLabel">\n                                <span class="shape sf_tAfterBg"></span>\n                            </span>\n                        </span>\n                    </label>\n                    <div class="text">\n                        <strong class="labelTitle"><%- task.subject %></strong>\n                        <% // 수정되었거나 추가된 할 일 항목인 경우 %>\n                        <% if (task.isUpdated || task.isAdded) { %>\n                        <button type="button" class="status _btnTodoHistory" data-taskid="<%- task.taskId %>"><%= task.isUpdated ? IM("web.postdetail.todo.label.updated") : IM("web.postdetail.todo.label.added") %></button>\n                        <% } %>\n                        <% if (task.isChecked && task.actor) { %>\n                        <span class="labelDesc gMat3"><span class="name"><strong><%- task.actor.name %></strong></span></span>\n                        <span class="labelDesc"><span class="date"><%- Localize.format.date(task.checkedAt, \'short_date_time\') %></span></span>\n                        <% } %>\n                    </div>\n                    <div class="thumb gMal46">\n                        <% if (task.isChecked && task.actor) { %>\n                        <a href="#" role="button" class="uProfile -size34 _todoFaceThumb" data-index="<%- index %>">\n                            <span class="profileInner <%- makeProfileInnerClass(task.actor.faceThumb) %>">\n                                <% if (task.actor.profileImageUrl) { %>\n                                <img src="<%- task.actor.faceThumb %>" width="34" height="34" alt="<%- task.actor.name %>">\n                                <% } %>\n                            </span>\n                        </a>\n                        <% } %>\n                    </div>\n                </div>\n            </li>\n            <% }); %>\n        </ul>\n\n    <%\n        // 항목 추가\n        if (isOpen && condition.isTaskAddible) {\n    %>\n        <div class="addListItem _btnAddTodoTaskWrap">\n            <button type="button" class="btnAdd _btnAddTodoTask"><%- IM("web.postdetail.todo.add_task") %></button>\n        </div>\n        <div class="addListItem _addTodoTaskWrap" style="display:none;">\n            \x3c!-- max-height:96px; / min-height: 42px; --\x3e\n            <div class="uTextarea">\n                <label for="todo_add_task" class="gSrOnly"><%- IM("web.postdetail.todo.add_task") %></label>\n                <input type="text" class="_textAddTodoTask" maxlength="<%- condition.todoTaskMaxLength %>" id="todo_add_task" placeholder="<%- IM(\'web.postdetail.todo.add_task\') %>" autocomplete="off">\n                <span class="border"></span>\n            </div>\n            <button type="button" class="btnCancel _btnCancelAddTodoTask"><%- IM("web.postdetail.btn.cancel") %></button><button type="button" class="btnConfirm _btnConfirmAddTodoTask"><%- IM("web.postdetail.btn.add") %></button>\n        </div>\n    <% } %>\n    </div>\n<% } %>\n</div>\n'},function(e,t){e.exports='<div <% if (!showDetail) { %>class="item -n _attachmentBillSplit" tabindex="-1"<% } else { %>class="item -n"<% } %>>\n<% // N빵 Title 정보 (글 목록과 글 상세에서 모두 노출) %>\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-nbang sf_color" aria-hidden="true">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-nbang<% if (!showDetail) { %>-22<% } %>"></use>\n            </svg>\n            <span class="status sf_color"><%= IM(\'web.postlist.billsplit.title\') %></span> <%- IM(\'web.postlist.billsplit.txt.paid_member_count\', {count: paidMemberCount}) %>\n        </p>\n        <p class="addTitle"><%= currencyLabel %><%- totalPrice %> <i>/ <%= IM(\'web.postlist.billsplit.txt.member_count\', {count: memberCount}) %></i></p>\n    </div>\n\n<% // N빵 상세 (글 상세에서 노출) %>\n<% if (showDetail) { %>\n    <div class="addDetail _attachmentBillSplitDetail">\n        <ul class="billCheckList">\n        <%\n            // members : N빵 멤버 목록 (Array)\n            _.each(members, function(member, index) {\n        %>\n            <li<% if (member.isPaid) { %> class="active"<% } %>>\n                <div class="uTableList">\n                    <span class="cell">\n                        <button type="button" class="uProfile -size50 _btnProfile" data-user-no="<%- member.userNo %>">\n                            <span class="profileInner <%- makeProfileInnerClass(member.faceThumb) %>">\n                                <% if (member.profileImageUrl) { %>\n                                <img src="<%- member.faceThumb %>" width="50" height="50" alt="<%- member.name %>">\n                                <% } %>\n                            </span>\n                        </button>\n                    </span>\n                    <label for="bill_<%- cid + \'_\' + index %>" class="cell">\n                        <strong class="labelTitle"><%- member.name %></strong>\n                        <em><%= currencyLabel %> <%- member.price %></em>\n                    </label>\n                    <label for="bill_<%- cid + \'_\' + index %>" class="cell">\n                        <span class="uCheck -radio -noLabel">\n                            <input type="checkbox" id="bill_<%- cid + \'_\' + index %>" class="checkInput _billCheck" data-index="<%-index%>" <%if(member.isPaid){%> checked <%}%> <% if (!isCheckboxClickable) { %> disabled <% } %>>\n                            <% if (!member.isPaid && (isAuthor || member.isCurrentUser)) { %>\n                            <span class="checkLabel">\n                                <span class="shape sf_tAfterBg"></span>\n                            </span>\n                            <% } %>\n                        </span>\n                    </label>\n                </div>\n            </li>\n        <% }); %>\n        </ul>\n    </div>\n<% } %>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1649),s=n(2531),a=n(516),r=n(697),l=n(1051),c=n(487),d=n(1054),u=n(2054),h=n(156);return i.View.extend({options:{bandData:null},behaviors:[c],attributes:{"data-viewname":"DPostVideoView","data-widget":"expanded"},className:"uWidget",template:t.template(s),ui:{postMediaItem:"._postMediaItem",player:"._player",image:"._image"},templateContext:function(){return{expiresMessage:h.makeRemainExpiresForStorageQuotaMessage(this.videoModel.get("expiresAt")),isExpiredVideo:h.isExpiredFile(this.videoModel.get("expiresAt"))}},regions:function(){return{player:{el:"@ui.player",replaceElement:this.options.model.get("isLive")}}},childViewEvents:{"videoPlayer:openMediaViewer":"_openMediaViewer","videoPlayer:play":function(e,t){this.jplOccur(c.CLASSIFIER.VIDEO_PLAY_START,{band_no:this.postModel.getBandNo(),post_no:this.postModel.getPostNo(),is_auto:t.isAutoPlayed,type:"uploaded",video_url:e.model.get("source"),total_duration_ms:1e3*t.duration,start_position_ms:1e3*t.currentTime})},"videoPlayer:pause":function(e,t){this.jplOccur(c.CLASSIFIER.VIDEO_PLAY_STOP,{band_no:this.postModel.getBandNo(),post_no:this.postModel.getPostNo(),is_auto:t.isAutoPlayed,type:"uploaded",video_url:e.model.get("source"),total_duration_ms:1e3*t.duration,stop_position_ms:1e3*t.currentTime})},openMedia:"_openMediaViewer"},initialize:function(e){this.videoModel=e.model,this.postModel=e.postModel,this._bandData=e.bandData},onAttach:function(){this.videoModel.get("isGif")?this.showChildView("player",this._buildGifVideoPlayer()):this.videoModel.get("isLive")?this.showChildView("player",this._buildDLiveVodCardPlayView()):this.showChildView("player",this._buildBlurFullfillPlayer())},_buildGifVideoPlayer:function(){var e=this._createVideoPlayerModel(),t=Math.min(Math.max(this.videoModel.get("width"),50),this.$el.width()),n=Math.max(t/this.videoModel.get("width")*this.videoModel.get("height"),40);return l.buildGifVideoPlayer({model:e,poster:this.videoModel.get("logoImage"),videoWidth:this.videoModel.get("width"),videoHeight:this.videoModel.get("height"),playerWidth:t,playerHeight:n,noplay:this.options.clickDisabledPostTypeOnDetail})},_buildBlurFullfillPlayer:function(){var e=this._createVideoPlayerModel();return l.buildBlurFullfillPlayer({model:e,poster:this.videoModel.get("logoImage"),videoWidth:this.videoModel.get("width"),videoHeight:this.videoModel.get("height"),playerWidth:this.$el.width(),playerHeight:Math.max(Math.min(this.$el.width()/this.videoModel.get("width")*this.videoModel.get("height"),this.$el.width()),150),noplay:this.options.clickDisabledPostTypeOnDetail})},_createVideoPlayerModel:function(){var e=this.postModel.getBandNo(),t=this.postModel.getPostNo(),n=this.videoModel.get("id"),i=r.createVideoPlayerModel({videoId:n,sources:function(){return a.getVideoUrlByPost(e,t,n)},expiresAt:this.videoModel.get("expiresAt")});return this.videoModel.get("isGif")||i.enablePostVideoViewingProgressLogging(e,t,n),i},_buildDLiveVodCardPlayView:function(){return u.buildDLiveVodCardPlayView({videoId:this.videoModel.get("id"),poster:this.videoModel.get("logoImage"),expiresAt:this.videoModel.get("expiresAt"),bandNo:this.postModel.getBandNo(),postNo:this.postModel.getPostNo(),noplay:this.options.clickDisabledPostTypeOnDetail,noclick:this.options.clickDisabledPostTypeOnDetail})},_openMediaViewer:function(){return this.videoModel.get("isLive")?d.openVodLiveViewerLayer(this.postModel.getBandNo(),this.postModel.getPostNo(),this.videoModel.get("id")):o.openDPostMediaViewer(this.postModel,this.videoModel.get("photoNo")),!1}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<ul class="uCollage _player" data-collage="1">\n</ul>\n<% if(!isExpiredVideo && expiresMessage) { %>\n<div class="videoSaveExpire gMat10 gMab12">\n    <span class="expireText"><%- expiresMessage %></span>\n</div>\n<% } %>'},function(e,t){e.exports='<header class="gSrOnly">\n    <h1>Video Live</h1>\n</header>\n\n<div class="videoLiveSection">\n    <div class="videoSection">\n        <div class="_liveVideo"></div>\n\n        \x3c!-- 동영상 하단 종료영역이 보여야 할 경우 -liftUp 추가 해주세요.--\x3e\n        <div class="videoSideArea _bottomSection" style="display:none">\n            <div class="infoLeftBox">\n                <a href="<%- bandHomeUrl %>" class="gotoBandLink" target="_blank"><%- bandHomeBtnLabel %></a>\n            </div>\n            <div class="infoRightBox">\n                <% if (enabled.offBtn) { %>\n                <button class="btnBroadcastFinish _offBtn" style="display:none;"><%= IM(\'live.off_live\') %></button>\n                <% } %>\n            </div>\n        </div>\n\n        <% if (enabled.closeBtn) { %>\n        <button class="btnLIveClose _closeBtn"><span class="gSrOnly"><%= IM(\'ui.label.close\')%></span></button>\n        <% } %>\n\n        <% if (!isExpiredVideo && expiresAt) { %>\n        <div class="videoSaveExpire _expiresText">\n            <span class="expireText"><%- expiresAt %></span>\n        </div>\n        <% } %>\n        \x3c!--동영상 영역 에러메시지 및 종료 종료시 에는 -fullDark 추가 해주세요.--\x3e\n        <div class ="livefullMessageArea _liveStatus" style="display:none"></div>\n    </div>\n\n    <div class="chattingSection _chatSection" style="width:363px;display:none">\n        <div class="resizeEl _chatSectionLine"></div>\n        <div class="liveIntroArea gPar17 gPal17 gPab16 _liveIntro"></div>\n        <div class="chattingWrapArea _liveChat"></div>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(6),s=n(52),a=n(529),r=n(520),l=n(156),c=n(506),d=o.Model.extend({defaults:function(){return{bandNo:null,author:null,commentCount:0,createdAt:null,emotionCount:0,expiresAt:null,fileSize:{},hasChat:!1,height:null,id:null,isLive:!0,isRestricted:!1,liveId:null,logoImage:null,photoNo:null,postNo:null,width:null,savableState:null}},parse:function(e,t){var n=s.camelizeKeys(e);return n.author=a.buildContentAuthorModel(n.author),n.bandNo=t.bandNo,n},getLiveVodBandNo:function(){return this.get("bandNo")},getLiveVodAuthor:function(){return this.get("author")},getLiveVodPostNo:function(){return this.get("postNo")},getLiveVodPhotoNo:function(){return this.get("photoNo")},getLiveVodLiveId:function(){return this.get("liveId")},getLiveVodLogoImage:function(){return this.get("logoImage")},getLiveVodWidth:function(){return this.get("width")},getLiveVodHeight:function(){return this.get("height")},isRestrictedLiveVod:function(){return this.get("isRestricted")},isExpiredLiveVod:function(){return l.isExpiredFile(this.getLiveVodExpiresAt())},getLiveVodExpiresAt:function(){return this.get("expiresAt")},getLiveVodSize:function(){return i.result(this.get("fileSize"),"360p")},getLiveVodVideoId:function(){return this.get("id")},hasChatLiveVod:function(){return this.get("hasChat")||!1},getSavableState:function(){return this.get("savableState")}});return d.buildLiveVodModel=function(e,n,i){return r.getRichPostQuietly(e,n).then((function(o){var s=c.get(o,"post.attachment.video."+i);return s?new d(s,{bandNo:e,postNo:n,videoId:i,parse:!0}):t.Deferred().reject().promise()}))},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(877),s=n(1405),a=n(529),r=n(506),l=i.Object.extend({initialize:function(e){this._liveViewerModel=e.liveViewerModel,this._vodModel=e.vodModel,this._messageCollection=e.messageCollection,this._bandData=e.bandData,this._bandNo=this._bandData.getBandCore().bandNo,this._videoId=this._vodModel.getLiveVodVideoId(),this._hasChat=!!this._vodModel.hasChatLiveVod(),this._creator=null,this._messageModels=[],this._startOffset=0,this._endOffset=0,this._fetching=!1,this._videoOffset=0},onDestroy:function(){},getLiveVodCreator:function(){return this._creator},isLiveVodMessageEnabled:function(){return this._hasChat},updateLiveVodVideoOffset:function(e){this._hasChat&&(this._startOffset<=e&&e<=this._endOffset?e<this._videoOffset?this._rewindMessages(e):this._playMessages(e):this._resetMessages(e),this._videoOffset=e)},hideLiveVodMessage:function(e){var n=e.getLiveChatMessageSender().getContentAuthorMemberKey(),i=e.getLiveChatMessageMessageTime();o.hideLiveMessage(this._bandNo,this._videoId,n,i).then(t.bind((function(){e.setLiveChatMessageStatusType(s.MESSAGE_STATUS_TYPE.HIDDEN)}),this),t.bind(this._alertResultDataMessage,this))},showHiddenLiveVodMessage:function(e){var n=e.getLiveChatMessageSender().getContentAuthorMemberKey(),i=e.getLiveChatMessageMessageTime();o.showHiddenLiveMessage(this._bandNo,this._videoId,n,i).then(t.bind((function(){e.setLiveChatMessageStatusType(s.MESSAGE_STATUS_TYPE.NORMAL)}),this),t.bind(this._alertResultDataMessage,this))},_alertResultDataMessage:function(e){var n=r.get(e,"result_data.message");n&&this._liveViewerModel.requestLiveContentMessageAlert(t.escape(n))},_rewindMessages:function(e){var n=this._messageCollection.findLastIndex((function(e){return e.getLiveChatMessageVideoOffset()<=this.videoOffset}),{videoOffset:e}),i=-1!=n?this._messageCollection.slice(n+1):null;t.isEmpty(i)||(this._messageCollection.remove(i),this._messageModels.unshift.apply(this._messageModels,i))},_playMessages:function(e){this._addMessages(e),this._loadNextMessages(e)},_resetMessages:function(e){var n=this._resetId=Date.now();this._messageCollection.reset(),this._messageModels.splice(0,this._messageModels.length),this._startOffset=Math.max(0,e-1e4),this._endOffset=this._startOffset+3e4,this._fetchMessages(n,this._startOffset,this._endOffset).then(t.bind((function(){n==this._resetId&&this._addMessages(e)}),this))},_addMessages:function(e){for(;this._messageModels.length>0&&this._messageModels[0].getLiveChatMessageVideoOffset()<=e;)this._messageCollection.add(this._messageModels.shift())},_loadNextMessages:function(e){!this._fetching&&this._endOffset-e<=1e4&&(this._endOffset=this._endOffset+3e4,this._fetchMessages(Date.now(),this._startOffset,this._endOffset))},_fetchMessages:function(e,n,i){return this._fetchId=e,this._fetching=!0,o.getLiveMessages(this._bandNo,this._videoId,n,i).then(t.bind((function(n){var o,r=n.live_creator,l=this._removeDuplicateMessages(n.messages),c=t.map(l,s.buildFromLiveVodMessage,s);e==this._fetchId&&(!this._creator&&r&&(this._creator=a.buildContentAuthorModel(r)),c.length>0&&(this._messageModels.push.apply(this._messageModels,c),(o=t.last(c).getLiveChatMessageVideoOffset())<i&&!this.isDestroyed()))?this._fetchMessages(e,o,i):this._fetching=!1}),this),t.bind((function(){this._fetching=!1}),this))},_removeDuplicateMessages:function(e){var n,i;return t.isEmpty(e)?[]:(n=t.last(this._messageModels))&&n.getLiveChatMessageVideoOffset()==e[0].video_offset&&-1!=(i=t.findIndex(e,(function(e){return e.creator.member_key==this.memberKey&&e.message_time==this.messageTime}),{memberKey:n.getLiveChatMessageSender().getContentAuthorMemberKey(),messageTime:n.getLiveChatMessageMessageTime()}))?e.slice(i+1):e}});return l.buildLiveVodController=function(e){return new l(e)},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=n(4),a=n(2536),r=n(1405),l=n(2043),c=n(13),d=n(9),u=n(34),h=n(506),p=n(59),m="NOT_USE",_="WAITING",g="CONNECTED",f="CONNECT_FAILED",b="CLOSED",v="NONE",A="CHAT",E="BAND",T="PAGE",C=s.Object.extend({initialize:function(e){this._liveViewerModel=e.liveViewerModel,this._liveModel=e.liveModel,this._messageCollection=e.messageCollection,this._bandData=e.bandData,this._bandNo=this._bandData.getBandCore().bandNo,this._useChannelMessage=this._liveModel.useChannelMessageLive(),this._channelId=this._liveModel.getLiveChannelId(),this._chatStatus=this._useChannelMessage&&this._channelId?_:m,this._memberKey=null,this._pinMessage=null,this._chatBlockType=v,this._blockedUsers={},this._connectFailedReason=null},onDestroy:function(){this.closeLiveChat(),this._chatClient&&this._chatClient.destroy()},connectLiveChat:function(){this._chatStatus!=m&&this._connectChat()},closeLiveChat:function(){this.isLiveChatConnected()&&(this._chatClient.close(),this._chatStatus=b)},isLiveChatConnectWait:function(){return this._chatStatus===_},isLiveChatConnected:function(){return this._chatStatus===g},isLiveChatConnectFailed:function(){return this._chatStatus===f},getLiveChatConnectFailedReason:function(){return this._connectFailedReason},isLiveChatBlockedUser:function(e){return this._blockedUsers[e]===A},isChatBlockedLiveChat:function(){return this._chatBlockType===A},isPageBlockedLiveChat:function(){return this._chatBlockType===T},isBandBlockedLiveChat:function(){return this._chatBlockType===E},isBlockedLiveChat:function(){return this._chatBlockType!=v},hasLiveChatPinMessage:function(){return!!this._pinMessage},getLiveChatPinMessage:function(){return this._pinMessage},sendLiveChatMessage:function(e){return this._chatStatus===g?this._chatClient.sendMsg(this._buildChatMessage(e)).then(i.bind((function(){this._liveViewerModel.notifyLiveContentChatMessageSent()}),this)):t.Deferred().reject()},pinLiveChatMessage:function(e){this._togglePinChatMessage(e,!0)},unpinLiveChatMessage:function(e){this._togglePinChatMessage(e,!1)},hideLiveChatMessage:function(e){this._toggleHideChatMessage(e,!0)},unhideLiveChatMessage:function(e){this._toggleHideChatMessage(e,!1)},blockLiveChatUser:function(e){return this._chatClient.sendBlock({targetMemberKey:e,block:!0})},unblockLiveChatUser:function(e){return this._chatClient.sendBlock({targetMemberKey:e,block:!1})},_togglePinChatMessage:function(e,t){this._chatStatus===g&&this._chatClient.sendPinMessage({targetMemberKey:e.getLiveChatMessageSender().getContentAuthorMemberKey(),messageTime:e.getLiveChatMessageMessageTime(),pin:t})},_toggleHideChatMessage:function(e,t){this._chatStatus===g&&this._chatClient.sendHide({targetMemberKey:e.getLiveChatMessageSender().getContentAuthorMemberKey(),messageTime:e.getLiveChatMessageMessageTime(),hide:t})},_buildChatMessage:function(e){return{msg:e,msgTypeCode:1,offset:this._liveViewerModel.getLiveContentCurrentVideoOffset(),msgTime:Date.now(),extras:this._buildExtras(),profile:this._buildChatProfile()}},_buildExtras:function(){var e={language:d.lang};return u.stringify(e)},_buildChatProfile:function(){var e=this._liveModel.getLiveMe(),t=e.getContentAuthorRealName(),n=e.getContentAuthorProfileImageUrl(),i={member_key:e.getContentAuthorMemberKey(),name:e.getContentAuthorName(),role:e.getContentAuthorRole(),member_type:e.getContentAuthorMemberType()};return o.isBlank(t)||(i.real_name=t),o.isBlank(n)||(i.profile_image_url=n),u.stringify(i)},_connectChat:function(){this._chatClient||(this._chatClient=a.buildWsChatClient({bandNo:this._bandNo,userNo:c.getUserData().getUserNo(),channelId:this._channelId,autoReconnect:!0}),this._chatClient.on("all",i.bind((function(e,t){switch(e){case a.EVENT.CONNECTED:this._handleChatConnectedEvent(t),this._fetchRecentMessages();break;case a.EVENT.CONNECT_FAILED:this._handleChatConnectFailedEvent(t);break;case a.EVENT.NOTI_BLIND:this._handleChatBlindEvent(t);break;case a.EVENT.NOTI_BLOCK:this._handleChatBlockEvent(t);break;case a.EVENT.NOTI_KICK:this._handleChatKickEvent(t);break;case a.EVENT.NOTI_PIN_MESSAGE:this._handleChatPinMessageEvent(t);break;case a.EVENT.NOTI_SEND:this._handleChatSendEvent(t)}}),this))),this._chatClient.connect()},_fetchRecentMessages:function(){this._messageCollection.length>0||this._chatClient.getMessageListRecent().then(i.bind((function(e){var t=i.map(e.messageList,(function(e){return r.buildFromLiveChatMessage(e)}));this._addRecentMessages(t)}),this))},_addRecentMessages:function(e){var t=i.last(e,1),n=i.first(e,e.length-t.length);this._messageCollection.add(t,{at:0}),n.length>0&&setTimeout(i.bind((function(){this._addRecentMessages(n)}),this),30)},_setChatBlockType:function(e){this._chatBlockType=e||v,this._liveViewerModel.notifyLiveContentChatBlockChanged()},_handleChatConnectedEvent:function(e){var t=e.pinMsg;this._memberKey=e.mbrKey,this._pinMessage=t?r.buildFromLiveChatMessage(t):null,this._setChatBlockType(e.blockType),this._chatStatus=g,this._liveViewerModel.notifyLiveContentChatStatusChanged()},_handleChatConnectFailedEvent:function(e){var t=h.get(e,"response.retCode");this._chatStatus=f,this._connectFailedReason=this._parseConnectFailedReason(t),this._liveViewerModel.notifyLiveContentChatStatusChanged(),this._sendChatConnectFailedLog(e)},_sendChatConnectFailedLog:function(e){var t={band_no:this._bandNo,live_id:this._liveModel.getLiveId(),channel_id:this._channelId,client:{url:this._chatClient.getUrl(),parameters:this._chatClient.getParameters()},event_data:e};p.sendWarn({body:"live chat connect failed\n"+u.stringify(t,null,4)})},_parseConnectFailedReason:function(e){switch(e){case 102:return l.INTERNAL_ERROR;case 104:return l.NOT_DEFINED_COMMAND;case 105:return l.INVALID_PARAMETER;case 106:return l.AUTHENTICATION_FAIL;case 1034:return l.CLOSED_LIVE_FAIL;case 1056:return l.EXCEEDED_ALLOWED_LIMIT;default:return l.UNKNOWN_ERROR}},_handleChatBlindEvent:function(e){var t=this._messageCollection.get(e.messageTime+"_"+e.memberKey);t&&t.setLiveChatMessageStatusType(e.blindType)},_handleChatBlockEvent:function(e){var t=e.blockMemberKey,n=e.blockType;this._blockedUsers[t]=n,t===this._memberKey&&this._setChatBlockType(n)},_handleChatKickEvent:function(e){e.memberKey===this._memberKey&&this._setChatBlockType(E)},_handleChatPinMessageEvent:function(e){var t=e.pin?e.message:null;this._pinMessage=t?r.buildFromLiveChatMessage(t):null,this._liveViewerModel.notifyLiveContentChatPinMessageChanged()},_handleChatSendEvent:function(e){var t=r.buildFromLiveChatReceivedMessage(e);this._messageCollection.add(t)}});return C.buildLiveChatController=function(e){return new C(e)},C}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2537),s=n(186),a={BEFORE_SEND:"beforeSend",BEFORE_SEND_JSON:"beforeSendJson",CLOSED:"closed",CONNECTED:"connected",CONNECT_FAILED:"connectFailed",CONNECTING:"connecting",ERROR:"error",LOST_RESPONSE:"lostResponse",MESSAGE:"message",MESSAGE_JSON:"messageJson",NOTI_BLIND:"notiBlind",NOTI_BLOCK:"notiBlock",NOTI_EVENT:"notiEvent",NOTIFICATION:"notification",NOTI_KICK:"notiKick",NOTI_PIN_MESSAGE:"notiPinMessage",NOTI_SEND:"notiSend",NOTI_SYSTEM:"notiSystem",WEB_SOCKET_CLOSED:"webSocketClosed",WEB_SOCKET_CONNECTED:"webSocketConnected",WEB_SOCKET_CONNECTING:"webSocketConnecting"},r=i.Object.extend({initialize:function(e){this._bandNo=e.bandNo,this._userNo=e.userNo,this._channelId=e.channelId,this._parameters={svcid:"band",ctgrno:this._bandNo,cid:this._channelId,uno:this._userNo,accTkn:s.getSession(),accTknType:"Bearer",autoReconnect:e.autoReconnect||!1},this._client=new o.WSChatClient(window.liveChatUrl,this._parameters),t.each(a,(function(e){this._client.on(e,t.bind(this.trigger,this,e))}),this)},onDestroy:function(){this.close(),t.each(a,(function(e){this._client.off(e,t.bind(this.trigger,this,e))}),this)},getUrl:function(){return window.liveChatUrl},getParameters:function(){return t.clone(this._parameters)},close:function(e){this._client.close(e)},connect:function(){return this._client.connectAsync()},sendBlock:function(e){return this._client.sendBlockAsync(e)},sendConnect:function(e){return this._client.sendConnectAsync(e)},sendEvent:function(e){return this._client.sendEventAsync(e)},sendHide:function(e){return this._client.sendHideAsync(e)},sendMsg:function(e){return this._client.sendMsgAsync(e)},sendPing:function(){this._client.sendPing()},sendPinMessage:function(e){return this._client.sendPinMessageAsync(e)},sendPong:function(){this._client.sendPong()},sendRequest:function(e){return this._client.sendRequestAsync(e)},getMessageListRecent:function(){return this._client.getMessageListRecentAsync()}});return r.EVENT=a,r.buildWsChatClient=function(e){return new r(e)},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){(function(e){(function(t){"use strict";var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function i(e,t){return e(t={exports:{}},t.exports),t.exports}var o=i((function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function r(e,t,n,i){var o=t&&t.prototype instanceof d?t:d,s=Object.create(o.prototype),a=new T(i||[]);return s._invoke=function(e,t,n){var i="suspendedStart";return function(o,s){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw s;return{value:void 0,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var r=v(a,n);if(r){if(r===c)continue;return r}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var d=l(e,t,n);if("normal"===d.type){if(i=n.done?"completed":"suspendedYield",d.arg===c)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(i="completed",n.method="throw",n.arg=d.arg)}}}(e,n,a),s}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=r;var c={};function d(){}function u(){}function h(){}var p={};p[o]=function(){return this};var m=Object.getPrototypeOf,_=m&&m(m(C([])));_&&_!==t&&n.call(_,o)&&(p=_);var g=h.prototype=d.prototype=Object.create(p);function f(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function b(e,t){var i;this._invoke=function(o,s){function a(){return new t((function(i,a){!function i(o,s,a,r){var c=l(e[o],e,s);if("throw"!==c.type){var d=c.arg,u=d.value;return u&&"object"==typeof u&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,r)}),(function(e){i("throw",e,a,r)})):t.resolve(u).then((function(e){d.value=e,a(d)}),(function(e){return i("throw",e,a,r)}))}r(c.arg)}(o,s,i,a)}))}return i=i?i.then(a,a):a()}}function v(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,v(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var i=l(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,c;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return s.next=s}}return{next:y}}function y(){return{value:void 0,done:!0}}return u.prototype=g.constructor=h,h.constructor=u,h[a]=u.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===u||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},f(b.prototype),b.prototype[s]=function(){return this},e.AsyncIterator=b,e.async=function(t,n,i,o,s){void 0===s&&(s=Promise);var a=new b(r(t,n,i,o),s);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},f(g),g[a]="Generator",g[o]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=C,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var r=n.call(s,"catchLoc"),l=n.call(s,"finallyLoc");if(r&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(r){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var s=o;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,c):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));function s(e,t,n,i,o,s,a){try{var r=e[s](a),l=r.value}catch(e){return void n(e)}r.done?t(l):Promise.resolve(l).then(i,o)}var a=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function r(e){s(a,i,o,r,l,"next",e)}function l(e){s(a,i,o,r,l,"throw",e)}r(void 0)}))}},r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e},d=i((function(e){function t(n,i){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(n,i)}e.exports=t})),u=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)},h=i((function(e){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=t=function(e){return typeof e}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(n)}e.exports=t})),p=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},m=function(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?p(e):t},_=i((function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(n)}e.exports=t})),g=i((function(e){!function(t){function n(){}var i=n.prototype,o=t.EventEmitter;function s(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function a(e){return function(){return this[e].apply(this,arguments)}}i.getListeners=function(e){var t,n,i=this._getEvents();if(e instanceof RegExp)for(n in t={},i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n]);else t=i[e]||(i[e]=[]);return t},i.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},i.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},i.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!(!t||"object"!=typeof t)&&e(t.listener)}(t))throw new TypeError("listener must be a function");var n,i=this.getListenersAsObject(e),o="object"==typeof t;for(n in i)i.hasOwnProperty(n)&&-1===s(i[n],t)&&i[n].push(o?t:{listener:t,once:!1});return this},i.on=a("addListener"),i.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},i.once=a("addOnceListener"),i.defineEvent=function(e){return this.getListeners(e),this},i.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},i.removeListener=function(e,t){var n,i,o=this.getListenersAsObject(e);for(i in o)o.hasOwnProperty(i)&&-1!==(n=s(o[i],t))&&o[i].splice(n,1);return this},i.off=a("removeListener"),i.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},i.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},i.manipulateListeners=function(e,t,n){var i,o,s=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)s.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(o=t[i])&&("function"==typeof o?s.call(this,i,o):a.call(this,i,o));return this},i.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"===n)delete i[e];else if(e instanceof RegExp)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},i.removeAllListeners=a("removeEvent"),i.emitEvent=function(e,t){var n,i,o,s,a=this.getListenersAsObject(e);for(s in a)if(a.hasOwnProperty(s))for(n=a[s].slice(0),o=0;o<n.length;o++)!0===(i=n[o]).once&&this.removeListener(e,i.listener),i.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,i.listener);return this},i.trigger=a("emitEvent"),i.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},i.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},i._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},i._getEvents=function(){return this._events||(this._events={})},n.noConflict=function(){return t.EventEmitter=o,n},e.exports?e.exports=n:t.EventEmitter=n}("undefined"!=typeof window?window:n||{})}));function f(e){return function(){var t,n=_(e);if(b()){var i=_(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return m(this,t)}}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var v=function(e){u(g,e);var t,n,i,s,l,d,h,p,m,_=f(g);function g(e,t){var n;return r(this,g),t||(t={}),(n=_.call(this)).url=e,n.jsonClient=null,n.state="closed",n.autoReconnect=E(t.autoReconnect,!1),n.callbackTimeout=E(t.callbackTimeout,5e3),n.noPingPong=E(t.noPingPong,!1),n.pingInterval=E(t.pingInterval,2e4),n.pingTimeout=E(t.pingTimeout,1e4),n.debug=E(t.debug,!1),n._pingTimer=null,n.connectRetryCount=0,n._nextTidValue=1,n.callbacks={},n.svcid=t.svcid,n.cid=t.cid,n.cno=t.cno,n.ctgrno=t.ctgrno,n.uid=t.uid,n.uno=t.uno,n.accTkn=t.accTkn,n.accTknType=t.accTknType,n.sid=null,n.ssid=null,n.uuid=null,n.mbrKey=null,n}return c(g,[{key:"close",value:function(e){this._clearPingTimer(),this._dropJsonClient(),"closed"!==this.state&&(this.state="closed",e||(e={reason:"intended"}),this.emit("closed",e))}},{key:"connect",value:function(e){this.connectAsync().then((function(t){return e(t,null)})).catch((function(t){return e(null,t)}))}},{key:"connectAsync",value:(m=a(o.mark((function e(){var t,n,i,s,a;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.close(),this.state="connecting";case 2:if("connecting"!==this.state){e.next=34;break}return e.prev=3,this.jsonClient=new A(this.url),this._registerJsonClientHandlers(),this.emit("connecting",{retryCount:this.connectRetryCount}),e.next=9,this.jsonClient.connectAsync();case 9:return n={svcid:this.svcid,cid:this.cid,cno:this.cno,ctgrno:this.ctgrno,uid:this.uid,uno:this.uno,accTkn:this.accTkn,accTknType:this.accTknType,devType:2001},e.next=12,this.sendConnectAsync(n);case 12:return t=e.sent,this.connectRetryCount=0,this.state="connected",this.emit("connected",t),e.abrupt("return",t);case 19:if(e.prev=19,e.t0=e.catch(3),this.emit("connectFailed",{code:e.t0.code,reason:e.t0.reason,wasClean:e.t0.wasClean,response:e.t0.response}),this.autoReconnect&&!e.t0.response){e.next=27;break}throw i=void 0,i=e.t0.code?"webSocketClosed":e.t0.response?"failureResponse":"error",this.close({reason:i,cause:e.t0,code:e.t0.code,wasClean:e.t0.wasClean,response:e.t0.response}),e.t0;case 27:return this.connectRetryCount++,s=Math.random()/2+.5,a=Math.floor(1e3*this.connectRetryCount*s),e.next=32,T(Math.min(a,5e3));case 32:e.next=2;break;case 34:case"end":return e.stop()}}),e,this,[[3,19]])}))),function(){return m.apply(this,arguments)})},{key:"sendRequest",value:function(e,t){if("connected"===this.state||100===e.cmd){var n=this._nextTid();e.tid=n,this.jsonClient.send(e),this._registerCallback(n,t)}else t(null,new Error("Invalid state: ".concat(this.state)))}},{key:"sendRequestAsync",value:function(e){var t=this;return new Promise((function(n,i){t.sendRequest(e,(function(e,t){if(t)i(t);else if(0!==e.retCode){var o=new Error("Error response: retCode = ".concat(e.retCode,", retMsg = ").concat(e.retMsg));o.response=e,i(o)}else n(e.bdy)}))}))}},{key:"sendConnect",value:function(e,t){this.sendConnectAsync(e).then((function(e){return t(e,null)})).catch((function(e){return t(null,e)}))}},{key:"sendConnectAsync",value:(p=a(o.mark((function e(t){var n,i;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={ver:"2",cmd:100,svcid:t.svcid,cid:t.cid,cno:t.cno,ctgrno:t.ctgrno,bdy:{uid:t.uid,uno:t.uno,accTkn:t.accTkn,accTknType:t.accTknType,devType:t.devType}},e.next=3,this.sendRequestAsync(n);case 3:return i=e.sent,this.sid=i.sid,this.ssid=i.ssid,this.uuid=i.uuid,this.mbrKey=i.mbrKey,e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"sendMsg",value:function(e,t){this.sendMsgAsync(e).then((function(e){return t(e,null)})).catch((function(e){return t(null,e)}))}},{key:"sendMsgAsync",value:(h=a(o.mark((function e(t){var n;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={ver:"2",cmd:3001,svcid:this.svcid,cid:this.cid,cno:this.cno,ctgrno:this.ctgrno,sid:this.sid,mbrKey:this.mbrKey,bdy:t},e.next=3,this.sendRequestAsync(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"sendEvent",value:function(e,t){this.sendEventAsync(e).then((function(e){return t(e,null)})).catch((function(e){return t(null,e)}))}},{key:"sendEventAsync",value:(d=a(o.mark((function e(t){var n;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={ver:"2",cmd:3006,svcid:this.svcid,cid:this.cid,cno:this.cno,sid:this.sid,mbrKey:this.mbrKey,bdy:t},e.next=3,this.sendRequestAsync(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"sendHide",value:function(e,t){this.sendHideAsync(e).then((function(e){return t(e,null)})).catch((function(e){return t(null,e)}))}},{key:"sendHideAsync",value:(l=a(o.mark((function e(t){var n;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={ver:"2",cmd:3008,svcid:this.svcid,cid:this.cid,cno:this.cno,sid:this.sid,mbrKey:this.mbrKey,bdy:t},e.next=3,this.sendRequestAsync(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"sendPinMessage",value:function(e,t){this.sendPinMessageAsync(e).then((function(e){return t(e,null)})).catch((function(e){return t(null,e)}))}},{key:"sendPinMessageAsync",value:(s=a(o.mark((function e(t){var n;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={ver:"2",cmd:3009,svcid:this.svcid,cid:this.cid,cno:this.cno,sid:this.sid,mbrKey:this.mbrKey,bdy:t},e.next=3,this.sendRequestAsync(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"sendBlock",value:function(e,t){this.sendBlockAsync(e).then((function(e){return t(e,null)})).catch((function(e){return t(null,e)}))}},{key:"sendBlockAsync",value:(i=a(o.mark((function e(t){var n;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={ver:"2",cmd:3010,svcid:this.svcid,cid:this.cid,cno:this.cno,sid:this.sid,mbrKey:this.mbrKey,bdy:t},e.next=3,this.sendRequestAsync(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getMessageListRecent",value:function(e,t){this.getMessageListRecentAsync(e).then((function(e){return t(e,null)})).catch((function(e){return t(null,e)}))}},{key:"getMessageListRecentAsync",value:(n=a(o.mark((function e(t){var n;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={ver:"2",cmd:5003,svcid:this.svcid,cid:this.cid,cno:this.cno,sid:this.sid,mbrKey:this.mbrKey,bdy:t},e.next=3,this.sendRequestAsync(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getUserCount",value:function(e){this.getUserCountAsync().then((function(t){return e(t,null)})).catch((function(t){return e(null,t)}))}},{key:"getUserCountAsync",value:(t=a(o.mark((function e(){var t;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={ver:"2",cmd:5010,svcid:this.svcid,cid:this.cid,cno:this.cno,sid:this.sid},e.next=3,this.sendRequestAsync(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"sendPing",value:function(){this.jsonClient.send({ver:"2",cmd:0})}},{key:"sendPong",value:function(){this.jsonClient.send({ver:"2",cmd:1e4})}},{key:"_nextTid",value:function(){var e=this._nextTidValue;return this._nextTidValue++,e}},{key:"_registerCallback",value:function(e,t){var n=this;t&&(this.callbacks[e]={callback:t,timer:setTimeout((function(){delete n.callbacks[e],t(null,new Error("timeout"))}),this.callbackTimeout)})}},{key:"_registerJsonClientHandlers",value:function(){var e=this,t=this.jsonClient;t.removeAllListeners(),t.on("connecting",(function(){return e.emit("webSocketConnecting")})),t.on("connected",(function(){return e.emit("webSocketConnected")})),t.on("closed",(function(t){e.emit("webSocketClosed",t),"connected"===e.state&&(e.close({reason:"A websocket is closed: ".concat(JSON.stringify(t))}),e.autoReconnect&&e.connectAsync())})),t.on("error",(function(t){t instanceof Error?e.emit("error",t):e.emit("error",new Error(JSON.stringify(t)))})),t.on("beforeSend",(function(t){return e.emit("beforeSend",t)})),t.on("beforeSendJson",(function(t){return e.emit("beforeSendJson",t)})),t.on("messageJson",(function(t){return e.emit("messageJson",t)})),t.on("message",(function(t){e.emit("message",t),e._runPingTimer();var n=t.cmd;if(0===n)e.noPingPong||e.sendPong();else if(90102===n)e.close({reason:"server"});else if(1e4===n);else if(1e4<n&&n<2e4){var i=parseInt(t.tid),o=e.callbacks[i];o?(delete e.callbacks[i],clearTimeout(o.timer),o.callback(t,null)):e.emit("lostResponse",t)}else switch(e.emit("notification",t),n){case 93001:e.emit("notiSend",t.bdy);break;case 94005:e.emit("notiKick",t.bdy);break;case 94008:e.emit("notiBlind",t.bdy);break;case 93010:e.emit("notiBlock",t.bdy);break;case 93006:e.emit("notiEvent",t.bdy);break;case 93009:e.emit("notiPinMessage",t.bdy);break;case 94003:e.emit("notiSystem",t.bdy)}}))}},{key:"_runPingTimer",value:function(){var e=this;this._clearPingTimer(),this.noPingPong||(this._pingTimer=setTimeout((function(){e._pingTimer=null,"connected"===e.state&&(e.noPingPong||(e.sendPing(),e._pingTimer=setTimeout((function(){e._pingTimer=null,"connected"===e.state&&(e.noPingPong||e.jsonClient.close())}),e.pingTimeout)))}),this.pingInterval))}},{key:"_clearPingTimer",value:function(){this._pingTimer&&(clearTimeout(this._pingTimer),this._pingTimer=null)}},{key:"_dropJsonClient",value:function(){var e=this;this.jsonClient&&(this.jsonClient.removeEvent(),this.jsonClient.on("closed",(function(t){return e.emit("webSocketClosed",t)})),this.jsonClient.close(),this.jsonClient=null)}}]),g}(g),A=function(e){u(n,e);var t=f(n);function n(e){var i;return r(this,n),(i=t.call(this)).url=e,i.state="beforeconnect",i.socket=null,i}return c(n,[{key:"close",value:function(){this.socket?this.socket.close():(this.state="closed",this.emit("closed",{code:null,reason:null,wasClean:!1}))}},{key:"connectAsync",value:function(){var e=this;return new Promise((function(t,n){if("beforeconnect"===e.state){var i=new WebSocket(e.url);e.socket=i,i.addEventListener("open",(function(n){e.state="connected",t(),e.emit("connected")})),i.addEventListener("close",(function(t){e.state="closed";var i=new Error("closed");i.code=t.code,i.reason=t.reason,i.wasClean=t.wasClean,n(i),e.emit("closed",{code:t.code,reason:t.reason,wasClean:t.wasClean})})),i.addEventListener("error",(function(t){e.emit("error",t)})),i.addEventListener("message",(function(t){var n=t.data;e.emit("messageJson",n);var i=JSON.parse(n);e.emit("message",i)})),e.state="connecting",e.emit("connecting")}else n(new Error("Invalid state: ".concat(e.state)))}))}},{key:"send",value:function(e){this.emit("beforeSend",e);var t=JSON.stringify(e);this.emit("beforeSendJson",t),this.socket.send(t)}}]),n}(g);function E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=0,o=t;i<o.length;i++){var s=o[i];if(null!=s)return s}}function T(e){return new Promise((function(t,n){setTimeout((function(){return t()}),e)}))}t.VERSION="1.6.0",t.WSChatClient=v,t.WSJsonClient=A,Object.defineProperty(t,"__esModule",{value:!0})})(t)}).call(this,n(5))},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(877),a=n(1404),r=n(26),l=o.Object.extend({initialize:function(e){this._liveViewerModel=e.liveViewerModel,this._liveModel=e.liveModel,this._bandData=e.bandData,this._controllable=e.controllable,this._bandNo=this._bandData.getBandCore().bandNo,this._liveId=this._liveModel.getLiveId(),this._fetchTimeerId=null,this._watchingIntervalId=null,this._viewerCountIntervalId=null,this._endMessage=null,this._isWatching=!1},onDestroy:function(){this.stopWatchingLive()},startLiveBroadcasting:function(){!this._starting&&this._controllable&&(this._starting=!0,s.onLive(this._bandNo,this._liveId).then(i.bind((function(){this._liveViewerModel.setLiveContentStatus(a.STARTING),this._fetchLiveAfterOnLive()}),this),i.bind((function(){this._starting=!1}),this)))},stopLiveBroadcasting:function(e){if(!this._stopping&&this._controllable)return this._stopping=!0,s.offLive(this._bandNo,this._liveId,e).then(i.bind((function(){r.getLiveChannel().trigger(r.EVENT.LIVE_CLOSED,{bandNo:this._bandNo,liveId:this._liveId}),this._setLiveStatusEnded(a.ENDED,IM("live.status_ended"))}),this),i.bind((function(){this._stopping=!1}),this))},startWatchingLive:function(){var e=this._liveModel.getLiveViewPeriodSecs(),t=this._liveModel.getLiveViewerCountPeriodSecs();this._isWatching=!0,this._controllable||(this._sendWatchingSignal(),e&&(this._watchingIntervalId=setInterval(i.bind(this._sendWatchingSignal,this),1e3*e))),t&&(this._viewerCountIntervalId=setInterval(i.bind(this._updateLiveViewerCount,this),1e3*t))},stopWatchingLive:function(){this._isWatching&&(this._isWatching=!1,this._fetchTimeerId&&(clearTimeout(this._fetchTimeerId),this._fetchTimeerId=null),this._watchingIntervalId&&(clearInterval(this._watchingIntervalId),this._watchingIntervalId=null),this._viewerCountIntervalId&&(clearInterval(this._viewerCountIntervalId),this._viewerCountIntervalId=null),this._controllable||this._liveViewerModel.getLiveContentStatus()!=a.PLAYING||s.quitLive(this._bandNo,this._liveId))},validateLiveBroadcasting:function(){this._validating||(this._validating=!0,s.validateLive(this._bandNo,this._liveId).then(i.bind((function(){this._validating=!1}),this),i.bind((function(e){e.result_code;var t=e.result_data||{},n=t.off_type,o=t.actor,s=IM("live.status_ended"),r=a.ENDED;if(this._controllable)switch(n){case"reserve_timeout":case"preview_timeout":s=IM("live.status_preview_time_over"),r=a.PREVIEW_TIME_OVER;break;case"user":s=IM("live.status_force_ended",{name:i.escape(o.name)}),r=a.FORCE_ENDED;break;case"punishment":s=IM("live.status_restricted_ended"),r=a.FORCE_ENDED;break;case"creator":case"on_air_timeout":case"no_publishing_timeout":s=IM("live.status_ended"),r=a.ENDED}this._setLiveStatusEnded(r,s)}),this)))},getLiveEndMessage:function(){return this._endMessage},_fetchLiveAfterOnLive:function(){this._liveModel.fetchLiveAfterOnLive().then(i.bind((function(){this._liveViewerModel.notifyLiveContentFetchedAfterOnLive(),this._fetchTimeerId=null}),this),i.bind((function(){this._fetchTimeerId=setTimeout(i.bind(this._fetchLiveAfterOnLive,this),500)}),this))},_sendWatchingSignal:function(){s.viewLive(this._bandNo,this._liveId)},_updateLiveViewerCount:function(){s.getLiveViewerCount(this._bandNo,this._liveId).then(i.bind((function(e){this._liveModel.setLiveViewerCount(e.viewer_count),this._liveViewerModel.notifyLiveContentViewerCountUpdated()}),this))},_setLiveStatusEnded:function(e,n){var o=t.when();!this._controllable||e!=a.ENDED&&e!=a.FORCE_ENDED||(this._bandData.resetBandDataState(),o=this._bandData.loadBandData()),o.always(i.bind((function(){this._endMessage=n,this._liveViewerModel.setLiveContentStatus(e)}),this))}});return l.buildLiveBroadcastController=function(e){return new l(e)},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(877),a=n(506),r=n(784),l=n(493),c={BLOCK_LIVE_CHAT:{id:"BLOCK_LIVE_CHAT",title:IM("live.block_live_chat")},UNBLOCK_LIVE_CHAT:{id:"UNBLOCK_LIVE_CHAT",title:IM("live.unblock_live_chat")},BLOCK_COMMENT_AND_CHAT:{id:"BLOCK_COMMENT_AND_CHAT",title:IM("live.block_comment_and_chat")},BAN_MEMBER:{id:"BAN_MEMBER",title:IM("profile_layer.label.ban_member")},BAN_MEMBER_AND_BLOCK:{id:"BAN_MEMBER_AND_BLOCK",title:IM("bandsetting.member_withdrawal.label.compulsory_withdrawal_and_block")}},d=o.Object.extend({initialize:function(e){this._liveViewerModel=e.liveViewerModel,this._bandData=this._liveViewerModel.getLiveContentBandData()},onDestroy:function(){},getLiveCreatorProfileMenuList:function(){var e=[c.BLOCK_COMMENT_AND_CHAT,c.BAN_MEMBER,c.BAN_MEMBER_AND_BLOCK];return this._filterProfileMenuList(this._liveViewerModel.getLiveContentCreator(),e)},getLiveMessageProfileMenuList:function(e){var t=[];return this._liveViewerModel.isChatAvailableLiveContent()&&(this._liveViewerModel.isLiveContentChatBlockedUser(e.getContentAuthorMemberKey())?t.push(c.UNBLOCK_LIVE_CHAT):t.push(c.BLOCK_LIVE_CHAT)),t.push(c.BLOCK_COMMENT_AND_CHAT,c.BAN_MEMBER,c.BAN_MEMBER_AND_BLOCK),this._filterProfileMenuList(e,t)},handleSelectedLiveCreatorProfileMenu:function(e){this._handleSelectedProfileMenu(e,this._liveViewerModel.getLiveContentCreator())},handleSelectedLiveMessageProfileMenu:function(e,t){this._handleSelectedProfileMenu(e,t)},_handleSelectedProfileMenu:function(e,t){var n,i=this._bandData.getBandCore().bandNo,o=t.getContentAuthorMemberKey();switch(e){case c.BLOCK_LIVE_CHAT.id:n=this._liveViewerModel.blockLiveContentChatUser(o);break;case c.UNBLOCK_LIVE_CHAT.id:n=this._liveViewerModel.unblockLiveContentChatUser(o);break;case c.BLOCK_COMMENT_AND_CHAT.id:n=r.addPenaltyMember(i,o,r.PENALTY_TYPE.BLOCK_COMMENT_AND_CHAT,!0);break;case c.BAN_MEMBER.id:n=l.doWithdrawBandMember(i,o,!1,!0);break;case c.BAN_MEMBER_AND_BLOCK.id:n=l.doWithdrawBandMember(i,o,!0,!0)}this._alertRequestCompleted(n)},_alertRequestCompleted:function(e){e&&e.then(i.bind((function(){this._alertMessage(IM("ui.alert.request_completed"))}),this),i.bind(this._alertResultDataMessage,this))},_alertResultDataMessage:function(e){var t=a.get(e,"result_data.message");t||(t=IM("ui.alert.temporary_error")),this._alertMessage(i.escape(t))},_alertMessage:function(e){this._liveViewerModel.requestLiveContentMessageAlert(e)},_filterProfileMenuList:function(e,n){var o=this._bandData.getBandCore(),a=this._liveViewerModel.getLiveContentLiveModel(),r=o.bandNo,l=a.getLiveId(),d=e.getContentAuthorMemberKey();return s.getMemberInLive(r,l,d).then(i.bind((function(e){var o=e.member||{},s=o.permitted_operation,a=i.intersection(n,this._convertToProfileMenuList(s)),r=t.Deferred().reject().promise();return i.isEmpty(a)?r:!o.is_member&&i.includes(a,c.BAN_MEMBER)?(this._alertMessage(IM("web.profile.leave")),r):o.is_blocked_comment_and_chat&&i.includes(a,c.BLOCK_COMMENT_AND_CHAT)?(this._liveViewerModel.requestLiveContentCommentAndChatBlockRemove(d),r):a}),this),i.bind(this._alertResultDataMessage,this))},_convertToProfileMenuList:function(e){return i.chain(e).map((function(e){switch(e){case"block_live_chat":return[c.BLOCK_LIVE_CHAT,c.UNBLOCK_LIVE_CHAT];case"block_comment_and_chat":return c.BLOCK_COMMENT_AND_CHAT;case"ban_member":return[c.BAN_MEMBER,c.BAN_MEMBER_AND_BLOCK]}})).flatten(!0).compact().value()}});return d.buildLiveProfileMenuController=function(e){return new d(e)},d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1405),s=n(877),a=n(493),r=n(784),l=n(9),c=n(34),d=n(514),u=n(506),h={PIN:{id:"PIN",title:IM("ui.label.pin_message")},UNPIN:{id:"UNPIN",title:IM("ui.label.unpin_message")},HIDE:{id:"HIDE",title:IM("chat.message.menu.set_message_hidden")},VIEW_ORIGINAL:{id:"VIEW_ORIGINAL",title:IM("ui.label.view_original")},UNHIDE:{id:"UNHIDE",title:IM("chat.message.menu.set_message_hidden_restore")},REPORT:{id:"REPORT",title:IM("ui.label.report")}},p=i.Object.extend({initialize:function(e){this._liveViewerModel=e.liveViewerModel,this._bandData=this._liveViewerModel.getLiveContentBandData()},onDestroy:function(){},getLiveMessageMenuList:function(e){return t.filter([h.PIN,h.UNPIN,h.HIDE,h.VIEW_ORIGINAL,h.UNHIDE,h.REPORT],(function(t){return this._isMenuEnabled(t,e)}),this)},handleSelectedLiveMessageMenu:function(e,t){switch(e){case h.PIN.id:this._liveViewerModel.pinLiveContentChatMessage(t);break;case h.UNPIN.id:this._liveViewerModel.unpinLiveContentChatMessage(t);break;case h.HIDE.id:this._liveViewerModel.hideLiveContentChatMessage(t);break;case h.VIEW_ORIGINAL.id:this._liveViewerModel.requestLiveContentOriginalMessageView(t);break;case h.UNHIDE.id:this._liveViewerModel.unhideLiveContentChatMessage(t);break;case h.REPORT.id:this._openReport(t)}},_isMenuEnabled:function(e,t){switch(e){case h.PIN:return this._isPinMenuEnabled(t);case h.UNPIN:return this._isUnpinMenuEnabled(t);case h.HIDE:return this._isHideMenuEnabled(t);case h.VIEW_ORIGINAL:case h.UNHIDE:return this._isUnhideMenuEnabled(t);case h.REPORT:return this._isReportMenuEnabled(t);default:return!1}},_isPinnedMessage:function(e){return e.isSameLiveChatMessage(this._liveViewerModel.getLiveContentPinMessage())},_isPageMessage:function(e){var t=this._liveViewerModel.getLiveContentCreator(),n=e.getLiveChatMessageSender();return t.isPageProfileContentAuthor()&&n.isPageProfileContentAuthor()},_isPinMenuEnabled:function(e){return this._liveViewerModel.canPinLiveContentChatMessage()&&e.isNormalLiveChatMessage()&&!this._isPinnedMessage(e)},_isUnpinMenuEnabled:function(e){return this._liveViewerModel.canPinLiveContentChatMessage()&&this._isPinnedMessage(e)},_isHideMenuEnabled:function(e){return this._liveViewerModel.canHideLiveContentChatMessage()&&e.isNormalLiveChatMessage()},_isUnhideMenuEnabled:function(e){return this._liveViewerModel.canRecoverHiddenLiveContentChatMessage()&&e.isHiddenLiveChatMessage()},_isReportMenuEnabled:function(e){var t=this._liveViewerModel.getOnAirLiveContentUser(),n=e.getLiveChatMessageSender();return!!this._liveViewerModel.isOnAirLiveContent()&&(!!l.spec.canReport()&&(!n.isContentAuthorMe()&&!n.isSameMemberKeyContentAuthor(t)&&(!!e.isTextLiveChatMessage()&&((!this._isPageMessage(e)||!this._bandData.canShowPageProfileRealName())&&(e.isNormalLiveChatMessage()||this._isUnhideMenuEnabled(e))))))},_openReport:function(e){var n=this._bandData.getBandCore(),i=this._liveViewerModel.getLiveContentLiveModel(),s=i.getLiveCreator(),a=i.getLiveMe();d.openChatReportPopup({bandNo:n.bandNo,isPage:s.isPageProfileContentAuthor(),isPageOwner:a.isPageProfileContentAuthor(),channelId:i.getLiveChannelId(),liveId:i.getLiveId(),messageTime:e.getLiveChatMessageMessageTime(),channelDeletePermission:!1,reportData:this._buildReportData(e),fnCallback:t.bind((function(){e.setLiveChatMessageStatusType(o.MESSAGE_STATUS_TYPE.BLIND),this._handleReportedMessageSender(e)}),this)})},_handleReportedMessageSender:function(e){var n=this._bandData.getBandCore(),i=this._liveViewerModel.getLiveContentLiveModel(),o=e.getLiveChatMessageSender(),l=n.bandNo,c=i.getLiveId(),d=o.getContentAuthorMemberKey();s.getMemberInLive(l,c,d).then(t.bind((function(e){var n=u.get(e,"member.permitted_operation");t.includes(n,"ban_member")&&(this._liveViewerModel.blockLiveContentChatUser(d),a.doWithdrawBandMember(l,d,!0,!0)),t.includes(n,"block_comment_and_chat")&&(this._liveViewerModel.blockLiveContentChatUser(d),r.addPenaltyMember(l,d,r.PENALTY_TYPE.BLOCK_COMMENT_AND_CHAT,!0))}),this))},_buildReportData:function(e){var t=this._bandData.getBandCore(),n=this._liveViewerModel.getLiveContentLiveModel(),i=e.getLiveChatMessageSender(),o={channel:{name:t.name,type:"live",buid:n.getLiveChannelId(),band_name:t.name,band_no:t.bandNo},messages:[{message_time:e.getLiveChatMessageMessageTime(),type:e.getLiveChatMessageTypeCode(),body:e.getLiveChatMessageContent(),extras:e.getLiveChatMessageExtras(),created_at:e.getLiveChatMessageCreatedAt(),writer:{face:i.getContentAuthorProfileImageUrl(),name:i.getContentAuthorName(),updated_at:e.getLiveChatMessageUpdatedAt(),member_key:i.getContentAuthorMemberKey()}}]};return c.stringify(o)}});return p.buildLiveMessageMenuController=function(e){return new p(e)},p}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(2542),a=n(1156),r=n(1404),l=n(158),c=n(154),d=n(2044),u="-type2",h="-type3",p=o.View.extend({tagName:"div",className:"livefullMessageArea",attributes:{"data-viewname":"DLiveViewerStatusView"},template:t.template(s),ui:{loading:"._loading",timer:"._timer",startBtn:"._startBtn",postBtn:"._postBtn",closeBtn:"._closeBtn"},events:{"click @ui.startBtn":function(){this.model.startLiveContentBroadcasting()},"click @ui.postBtn":"_createPost","click @ui.closeBtn":function(){this.model.closeLiveContentViewer()}},modelEvents:{all:"_onTriggerLiveViewerModel"},initialize:function(e){this._liveStatus=this.model.getLiveContentStatus(),this._bandData=this.model.getLiveContentBandData(),this._expires=this._liveStatus==r.PREVIEW?t.now()+299e3:null},serializeData:function(){return{enabled:{loading:this._liveStatus==r.PREVIEW},mainMessageClass:this._getMainMessageClass(),mainMessage:l.nl2br(this._getMainMessage()),subMessage:l.nl2br(this._getSubMessage()),timer:this._getTimerValue(),startBtn:this._isStartBtnEnabled(),postBtn:this._isPostBtnEnabled(),closeBtn:this._isCloseBtnEnabled(),bottomMessage:l.nl2br(this._getBottomMessage())}},onBeforeRender:function(){this.isRendered()&&this._stopTimer()},onRender:function(){this.$el.toggleClass("-fullDark",this._isFullDark()),this._startTimer()},onBeforeDetach:function(){this._stopTimer()},_getTimerValue:function(){var e=this._expires?Math.ceil((this._expires-t.now())/1e3):null;return t.isNumber(e)?i.lpad(Math.floor(e/60),2,"0")+":"+i.lpad(Math.floor(e%60),2,"0"):null},_startTimer:function(){this._expires&&(this._timer=setInterval(t.bind((function(){if(this._expires<=t.now())return this._stopTimer(),void this.model.notifyLiveContentPreviewTimeOver();this.ui.timer.html(this._getTimerValue())}),this),1e3))},_stopTimer:function(){this._timer&&(clearInterval(this._timer),this._timer=null)},_getMainMessageClass:function(){switch(this._liveStatus){case r.PREVIEW:return" "+u;case r.ENDED:return" "+h;default:return""}},_getMainMessage:function(){switch(this._liveStatus){case r.PREVIEW:return IM("live.status_preview");case r.PREVIEW_TIME_OVER:return IM("live.status_preview_time_over");case r.STARTING:return IM("live.status_starting");case r.FORCE_ENDED:case r.ENDED:return this.model.getLiveContentEndMessage();default:return null}},_getSubMessage:function(){switch(this._liveStatus){case r.ENDED:return this.model.canOffLiveContent()?IM("live.status_stored_in_encoder"):null;default:return null}},_isStartBtnEnabled:function(){switch(this._liveStatus){case r.PREVIEW:return!0;default:return!1}},_isPostBtnEnabled:function(){return this._liveStatus==r.ENDED&&this.model.canUploadLiveContent()},_isFullDark:function(){switch(this._liveStatus){case r.PREVIEW_TIME_OVER:case r.ENDED:case r.FORCE_ENDED:return!0;default:return!1}},_isCloseBtnEnabled:function(){switch(this._liveStatus){case r.PREVIEW_TIME_OVER:case r.ENDED:case r.FORCE_ENDED:return!0;default:return!1}},_getBottomMessage:function(){switch(this._liveStatus){case r.PREVIEW:return this.model.getLiveContentBandData().isShowMessagePublicBandContentAccessByAnyone()?IM("live.status_anyone_can_watch_public_band_live"):null;default:return null}},_toggleLoading:function(e){this.ui.loading.css("display",e?"":"none")},_onTriggerLiveViewerModel:function(e,t){switch(e){case a.EVENT.LIVE_VIDEO_LOADING_TOGGLED:this._toggleLoading(t)}},_createPost:function(){var e=this.model.getLiveContentLiveId(),n=this.model.getLiveContentDescription(),i=d.createLivePost(this._bandData,e,n);c.wrapActivePromise(i,this).then(t.bind((function(){this.model.closeLiveContentViewer()}),this))}});return p.buildPreviewLiveViewerStatusView=function(e){return new p({model:e})},p}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="liveMessageBox">\n    <% if (enabled.loading) { %>\n    <span class="liveLoading _loading" style="display:none"><span class="gSrOnly"><%= IM(\'ui.label.loading\')%></span></span>\n    <% } %>\n    <% if (mainMessage) { %>\n    <div class="liveMessageText<%- mainMessageClass %>"><%= mainMessage /* 개행 태그 있음 */ %></div>\n    <% } %>\n    <% if (subMessage) { %>\n    <div class="liveMessageText -subStyle"><%= subMessage /* 개행 태그 있음 */ %></div>\n    <% } %>\n    <% if (timer) { %>\n    <div class="timerView"><time class="timeText _timer"><%- timer %></time></div>\n    <% } %>\n    <% if (startBtn || postBtn) { %>\n    <div class="btnWrap gMat20">\n        <% if (startBtn) { %>\n        <button class="buttonLive -bgGreen gPal30 gPar30 _startBtn"><%= IM(\'live.start_button\') %></button>\n        <% } %>\n        <% if (postBtn) { %>\n        <button class="buttonLive -bgGreen _postBtn"><i class="iconPost gMar9"></i><%= IM(\'live.post_button\') %></button>\n        <% } %>\n    </div>\n    <% } %>\n</div>\n<% if (closeBtn) { %>\n<div class="liveVideoCloseWrap"><button class="uButton -iconLiveViewClose _closeBtn"><span class="gSrOnly"><%= IM(\'ui.label.close_layer\') %></span></button></div>\n<% } %>\n<% if (bottomMessage) { %>\n<div class="bottomTextBox">\n    <span class="bottomText"><%= bottomMessage /* 개행 태그 있음 */ %></span>\n</div>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2544),s=n(1156),a=n(618),r=n(1569),l=n(833),c=n(26),d=n(889),u=n(154),h=n(1558),p=n(2548),m=n(159),_="-ellipsis",g=[r.LIVE_MORE_OPTION.SEE_LIVE_VIEWERS,r.LIVE_MORE_OPTION.COPY_LIVE_URL,r.LIVE_MORE_OPTION.SHARE_LIVE,r.LIVE_MORE_OPTION.REPORT_LIVE,r.LIVE_MORE_OPTION.OFF_LIVE_FORCIBLY],f=[l.MEDIA_MORE_OPTION.SHOW_VIDEO_VIEWER_LIST,l.MEDIA_MORE_OPTION.CHANGE_STORAGE_QUOTA,l.MEDIA_MORE_OPTION.DOWNLOAD,l.MEDIA_MORE_OPTION.COPY_URL,l.MEDIA_MORE_OPTION.REPORT],b=f.concat([l.MEDIA_MORE_OPTION.DELETE]),v=i.View.extend({tagName:"div",className:"liveIntroArea gPar17 gPal17 gPab16",attributes:{"data-viewname":"DLiveViewerIntroView"},template:t.template(o),ui:{profile:"._profile",profileMenu:"._profileMenu",viewerCount:"._viewerCount",description:"._description",descriptionEnd:"._descriptionEnd",descriptionBtn:"._descriptionBtn",moreMenuBtn:"._moreMenuBtn",moreMenu:"._moreMenu"},regions:{profile:{el:"@ui.profile",replaceElement:!0},profileMenu:{el:"@ui.profileMenu",replaceElement:!1},viewerCount:{el:"@ui.viewerCount",replaceElement:!0},moreMenu:{el:"@ui.moreMenu",replaceElement:!0}},events:{"intersect @ui.descriptionEnd":"_handleDescriptionEndIntersectEvent","click @ui.descriptionBtn":"_toggleDescription","click @ui.moreMenuBtn":"_toggleMoreMenu"},modelEvents:{all:"_onLiveViewerModelAllEvent"},childViewEvents:{clickProfileImageView:function(){this._toggleProfileMenu(),c.getDGlobalChannel().trigger(c.EVENT.HTML_CLICK)}},behaviors:function(){var e=[m],t=this.options.model;if(e.push({behaviorClass:h,observations:[{elements:"._descriptionEnd"}]}),(t.isOnAirLiveContent()||t.isPreviewLiveContent())&&e.push({behaviorClass:r,moreOptionListRegionName:"moreMenu"}),t.isVodLiveContent()){var n=t.getLiveContentVodModel();e.push({behaviorClass:l,moreOptionListRegionName:"moreMenu",moreOptionList:n.isExpiredLiveVod()?b:f,menuStyleClasses:{listClass:"moreMenuList -active",listItemClass:"moreMenuItem",btnClass:"btnMoreMenu"},photoInfo:{bandNo:n.getLiveVodBandNo(),photoNo:n.getLiveVodPhotoNo(),mediaAuthor:n.getLiveVodAuthor(),photoUrl:n.getLiveVodLogoImage(),width:n.getLiveVodWidth(),height:n.getLiveVodHeight(),isRestrictedMedia:n.isRestrictedLiveVod(),isVideoExist:!0,isGifVideo:!1,isGiphy:!1,videoId:n.getLiveVodVideoId(),liveId:n.getLiveVodLiveId(),isVideoExpired:n.isExpiredLiveVod(),videoExpiresAt:n.getLiveVodExpiresAt(),videoFileSize:n.getLiveVodSize(),getSavableState:function(){return n.getSavableState()}}})}return e},initialize:function(e){this._bandData=this.model.getLiveContentBandData(),this._profileMenuController=this.model.getLiveContentProfileMenuController(),this._collapsible=this.model.isChatMessageEnabledLiveContent(),this._collapsed=this._collapsible,this._descProps={ellipsisMaxHeight:null,isIntersecting:null}},serializeData:function(){var e=this.model.canViewLiveContentViewingMember();return{enabled:{profileMenu:this.model.isLiveContentCreatorProfileMenuEnabled(),viewerCount:this.model.isOnAirLiveContent(),simpleViewerCount:!e},title:this._getTitle(),subtitle:this._getSubtitle(),description:this.model.getLiveContentDescription(),collapsed:this._collapsed,collapsible:this._collapsible}},onRender:function(){this._renderProfile(),this._renderViewerCount()},onAttach:function(){this.listenTo(c.getDGlobalChannel(),c.EVENT.HTML_CLICK,this._hideAllLayer),this._toggleDescriptionBtn({ellipsisMaxHeight:parseInt(this.ui.description.css("max-height"))}),this._initDeleteMoreOptionButton()},onBeforeDetach:function(){this.stopListening(c.getDGlobalChannel())},_initDeleteMoreOptionButton:function(){this.on(l.TRIGGERING_EVENTS.MEDIA_DELETED,(function(){console.log("aa"),this.spawn(m.MSG.EXPIRED_LIVE_VOD_DELETED)}))},_renderProfile:function(){var e=this.model.getLiveContentAuthor();this.showChildView("profile",a.buildDProfileImageView({bandCore:this._bandData.getBandCore(),memberProfile:e.getContentAuthorMemberProfile(),role:e.getContentAuthorRole(),disableClick:!this.model.isLiveContentCreatorProfileMenuEnabled(),size:40}))},_renderViewerCount:function(){this.model.isOnAirLiveContent()&&this.showChildView("viewerCount",p.buildLiveViewerCountView(this.model))},_getTitle:function(){var e=this.model.getLiveContentAuthor();return IM("live.viewer_title",{name:t.escape(e.getContentAuthorName())})},_getSubtitle:function(){var e=this.model.getLiveContentAuthor();return e.isPageProfileContentAuthor()?this._bandData.canShowPageProfileRealName()?IM("live.viewer_subtitle",{name:t.escape(e.getContentAuthorRealName())}):null:t.escape(this._bandData.getBandCore().name)},_hideAllLayer:function(){this._hideProfileMenu(),this._hideMoreMenu()},_toggleProfileMenu:function(){var e=this.getRegion("profileMenu");e.hasView()||u.wrapActivePromise(this._profileMenuController.getLiveCreatorProfileMenuList(),this).then(t.bind((function(t){var n=d.build(t,{listClass:"moreMenuList -active",listItemClass:"moreMenuItem",btnClass:"btnMoreMenu"});this.listenTo(n,d.EVENTS.MENU_SELECTED,(function(e){this._profileMenuController.handleSelectedLiveCreatorProfileMenu(e)})),this.ui.profileMenu.css("display",""),e.show(n)}),this))},_hideProfileMenu:function(){this.ui.profileMenu.css("display","none"),this.getRegion("profileMenu").empty()},_toggleMoreMenu:function(){this.getChildView("moreMenu")||(this.model.isOnAirLiveContent()||this.model.isPreviewLiveContent()?this.trigger(r.LISTENING_EVENTS.OPTION_LIST_OPEN,{liveModel:this.model.getLiveContentLiveModel(),moreOptionList:this._getLiveMenuList()}):this.model.isVodLiveContent()&&this.trigger(l.LISTENING_EVENTS.OPTION_LIST_OPEN))},_getLiveMenuList:function(){return this.model.canViewLiveContentViewingMember()?g:t.without(g,r.LIVE_MORE_OPTION.SEE_LIVE_VIEWERS)},_hideMoreMenu:function(){this.model.isOnAirLiveContent()||this.model.isPreviewLiveContent()?this.trigger(r.LISTENING_EVENTS.OPTION_LIST_CLOSE):this.model.isVodLiveContent()&&this.trigger(l.LISTENING_EVENTS.OPTION_LIST_CLOSE)},_toggleDescription:function(){this._collapsed=!this._collapsed,this.ui.description.toggleClass(_,this._collapsed),this.ui.descriptionBtn.html(this._collapsed?"..."+IM("ui.label.more.long"):IM("ui.label.collapse")),this.model.notifyLiveContentDescriptionToggled()},_handleDescriptionEndIntersectEvent:function(e,t){this._toggleDescriptionBtn({isIntersecting:t.isIntersecting})},_toggleDescriptionBtn:function(e){var n=t.extend(this._descProps,e),i=n.ellipsisMaxHeight,o=n.isIntersecting;this._collapsible&&t.isNumber(i)&&t.isBoolean(o)&&this.ui.descriptionBtn.css("display",o&&this.ui.description.height()<=i?"none":"")},_onLiveViewerModelAllEvent:function(e,t){switch(e){case s.EVENT.LIVE_CHAT_SECTION_SIZE_CHANGED:this._toggleDescriptionBtn();break;case s.EVENT.LIVE_STATUS_CHANGED:this.model.isLiveContentEnded()&&(this._renderViewerCount(),this._hideMoreMenu())}}});return v.buildLiveViewerIntroView=function(e){return new v({model:e})},v}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="profileBox gPat21">\n    <div class="profileThumb">\n        <span class="_profile"></span>\n        <% if (enabled.profileMenu) { %>\n        <div class="moreFunctionBox _profileMenu" style="display:none"></div>\n        <% } %>\n    </div>\n    <div class="profileInfoBox">\n        <span class="nameInfo">\n            <%= title /* 태그 있음 */ %>\n        </span>\n        <% if (subtitle || enabled.viewerCount) { %>\n        <div class="etcInfo">\n            <% if (subtitle) { %>\n            <span class="bandNameInfo"><%= subtitle /* 이스케이프 되어 있음 */ %></span>\n            <% } %>\n            <div class="_viewerCount" style="display:none"></div>\n        </div>\n        <% } %>\n    </div>\n</div>\n<% if (description) { %>\n<div class="explainBox gMat10">\n    <div class="explainText<%- collapsed ? \' -ellipsis\' : \'\' %> _description"><%- description %><% if (collapsible) { %><span class="_descriptionEnd" style="display:inline-block"></span><% } %></div>\n    <% if (collapsible) { %>\n    <button class="btnExplainMore _descriptionBtn" style="display:none">...<%= IM(\'ui.label.more.long\') %></button>\n    <% } %>\n</div>\n<% } %>\n<div class="moreFunctionBox">\n    <button class="btnMoreFunctionView _moreMenuBtn"><%= IM(\'web.uicomponent.topbar.button.menuopen\') %></button>\n    <ul class="moreMenuList _moreMenu"></ul>\n</div>'},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title"><%- title %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap">\n            <p class="sDesc gFs14 gColorBk2 gTaC gMat14 gPab15 -bLine">\n                <%= desc /* 줄바꿈 태그 있을 수 있음 */ %>\n            </p>\n            <div class="_memberList"></div>\n            <p class="sDesc -tLine gPat10 gPab10 _descMaxWatcherCountOver" style="display: none;"></p>\n        </div>\n    </div>\n    <div class="modalButton">\n        <button type="button" class="uButton -iconClose btnLyClose _closeBtn"><span class="gSrOnly"><%- IM(\'ui.label.close_layer\') %></span></button>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2547),s=n(618);return i.View.extend({tagName:"li",className:"tLine flexList",attributes:{"data-viewname":"DLiveOnAirMemberView"},template:t.template(o),ui:{profile:"._profile"},regions:{profile:{el:"@ui.profile",replaceElement:!1}},initialize:function(e){this._liveModel=e.liveModel,this._bandData=this._liveModel.getLiveBandData()},serializeData:function(){return{name:this.model.getContentAuthorName(),desc:this.model.getContentAuthorDescription()}},onRender:function(){this._renderProfile()},_renderProfile:function(){var e=s.buildDProfileImageView({bandCore:this._bandData.getBandCore(),memberProfile:this.model.getContentAuthorMemberProfile(),role:this.model.getContentAuthorRole(),disableClick:!0,size:40});this.showChildView("profile",e)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<span class="thumb _profile"></span>\n<span class="text">\n    <span class="ellipsis"><%- name %></span>\n    <span class="sub2 ellipsis"><%- desc %></span>\n</span>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(4),s=n(2549),a=n(1156),r=n(2045),l=o.View.extend({tagName:function(){return this._isButtonView()?"button":"span"},className:function(){var e=["viewCountInfo"];return this._isButtonView()&&e.push("-arrow"),e.join(" ")},attributes:function(){var e={"data-viewname":"DLiveViewerCountView"};return this._isButtonView()&&(e.type="button"),e},template:t.template(s),events:{click:function(){this._isButtonView()&&r.openOnAirMemberListLayer(this.model.getLiveContentLiveModel())}},modelEvents:{all:"_onLiveViewerModelAllEvent"},initialize:function(e){},serializeData:function(){return{count:i.numberFormat(this.model.getLiveContentViewerCount()||0)}},_isButtonView:function(){return this.model.canViewLiveContentViewingMember()},_onLiveViewerModelAllEvent:function(e,t){switch(e){case a.EVENT.LIVE_VIEWER_COUNT_UPDATED:this.render()}}});return l.buildLiveViewerCountView=function(e){return new l({model:e})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<i class="iconViewCount"></i><%- count %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2551),s=n(2552),a=n(1156),r=n(2554),l=n(2556),c=n(2558),d=n(1404),u=n(513),h=n(798),p=n(2560),m=n(1558),_=n(553),g="-active",f=i.CollectionView.extend({tagName:"div",className:"messageWrap",childView:s,childViewOptions:function(){return t.clone(this.options)},initialize:function(e){}}),b=i.View.extend({tagName:"div",className:"chattingWrapArea",attributes:{"data-viewname":"DLiveViewerChatLayoutView"},template:t.template(o),ui:{scrollWrap:"._scrollWrap",pinMessage:"._pinMessage",welcomeMessage:"._welcomeMessage",messageList:"._messageList",messageBottom:"._messageBottom",chatStatus:"._chatStatus",downArrowBtn:"._downArrowBtn",messageInput:"._messageInput",bandJoinBtnWrap:"._bandJoinBtnWrap",bandJoinBtn:"._bandJoinBtn"},regions:{pinMessage:{el:"@ui.pinMessage",replaceElement:!0},messageList:{el:"@ui.messageList",replaceElement:!0},chatStatus:{el:"@ui.chatStatus",replaceElement:!0},messageInput:{el:"@ui.messageInput",replaceElement:!0}},events:{"intersect @ui.messageBottom":"_handleMessageBottomIntersectEvent","click @ui.downArrowBtn":"_scrollToBottom","click @ui.bandJoinBtn":"_handleBandJoinBtnClickEvent"},modelEvents:{all:"_handleLiveViewerModelEvent"},behaviors:[{behaviorClass:m,observations:[{elements:"._messageBottom"}]}],initialize:function(e){this._bandData=this.model.getLiveContentBandData(),this._isAutoScroll=!0},serializeData:function(){return{enabled:{pinMessage:this.model.isChatEnabledLiveContent(),messageList:this.model.isChatMessageEnabledLiveContent(),messageInput:this.model.isChatEnabledLiveContent()},welcomeMessage:this._getWelcomeMessage(),bandJoinBtnLabel:this._getBandJoinBtnLabel()}},onRender:function(){this._renderLayout()},_renderLayout:function(){this._renderChatStatus(),this._renderPinMessage(),this._toggleWelcomeMessage(),this._renderMessageList(),this._toggleBandJoinBtn(),this._renderMessageInput()},_renderChatStatus:function(){var e=c.buildLiveViewerChatStatusView(this.model);this.showChildView("chatStatus",e)},_renderPinMessage:function(){this.model.isChatAvailableLiveContent()&&(this.model.hasLiveContentPinMessage()?this._showPinMessage():this._removePinMessage())},_renderMessageList:function(){var e=this.getRegion("messageList");if(this.model.isChatMessageAvailableLiveContent()){var t=new f({collection:this.model.getLiveContentMessageCollection(),liveViewerModel:this.model});return this.listenToOnce(t,"before:add:child",this._renderChatStatus),this._bindAutoScroll(t,"add:child"),void e.show(t)}e.hasView()&&e.empty()},_renderMessageInput:function(){var e=this.getRegion("messageInput");this.model.isChatAvailableLiveContent()?e.show(l.buildLiveViewerChatMessageInputView(this.model)):e.hasView()&&e.empty()},_showPinMessage:function(){var e=r.buildLiveViewerChatPinMessageView(this.model);this._bindAutoScroll(e,"attach"),this.showChildView("pinMessage",e)},_removePinMessage:function(){var e=this.getChildView("pinMessage");e&&(this._bindAutoScroll(e,"detach"),e.destroy())},_bindAutoScroll:function(e,t){this.listenTo(e,"before:"+t,(function(){this._isAutoScroll&&this.listenToOnce(e,t,this._scrollToBottom)}))},_getBandJoinBtnLabel:function(){return this.model.isOnAirLiveContent()?this._bandData.isUserJoinApplied()?IM("band.already_applied.btn.label"):this._bandData.canJoin()?this.model.getLiveContentCreator().isPageProfileContentAuthor()?IM("ui.label.subscribe"):IM("band.open_join_form.btn.label"):"":null},_getWelcomeMessage:function(){if(this.model.isChatMessageEnabledLiveContent()){if(this.model.isVodLiveContent())return IM("live.chat_welcome_replay");if(this.model.isOnAirLiveContent()&&this._bandData.canJoin())return this.model.getLiveContentCreator().isPageProfileContentAuthor()?IM("live.chat_welcome_page_join"):IM("live.chat_welcome_band_join")}return""},_toggleWelcomeMessage:function(){var e=this._getWelcomeMessage();this.ui.welcomeMessage.css("display",this.model.isChatMessageAvailableLiveContent()&&e?"":"none").html(e)},_handleMessageBottomIntersectEvent:function(e,t){this._isAutoScroll=t.isIntersecting,this.ui.downArrowBtn.css("display",this._isAutoScroll?"none":"")},_scrollToBottom:function(){this.ui.scrollWrap.scrollTop(this.ui.scrollWrap.get(0).scrollHeight),this._isAutoScroll=!0},_toggleBandJoinBtn:function(){var e=this._getBandJoinBtnLabel();this.ui.bandJoinBtnWrap.toggleClass(g,!!e),this.ui.bandJoinBtn.html(e)},_handleBandJoinBtnClickEvent:function(){var e=this._bandData.getBandCore(),t=_.home(e).url;this._bandData.isUserJoinApplied()?u.openWindowXSSSafely(t,"_blank"):this._joinBand()},_joinBand:function(){var e=t.bind((function(e){this.model.checkLiveContentBandJoin(),e&&this.model.requestLiveContentMessageAlert(t.escape(e))}),this);h.build({onBandJoinCompleted:e,onRefreshPage:e}).startJoinFromBand(this._bandData.getBandCore().bandNo)},_handleLiveViewerModelEvent:function(e,t){switch(e){case a.EVENT.LIVE_STATUS_CHANGED:this._handleLiveStatusChange(t);break;case a.EVENT.LIVE_CHAT_CONNECT_STATUS_CHANGED:this._renderLayout();break;case a.EVENT.LIVE_CHAT_PIN_MESSAGE_CHANGED:this._renderPinMessage();break;case a.EVENT.LIVE_BAND_JOIN_STATUS_CHANGED:this._renderMessageInput(),this._toggleBandJoinBtn(),this._toggleWelcomeMessage();break;case a.EVENT.LIVE_CHAT_MESSAGE_MENU_OPENED:this._isAutoScroll=!1;break;case a.EVENT.LIVE_CHAT_MESSAGE_MENU_CLOSED:this._isAutoScroll="none"===this.ui.downArrowBtn.css("display");break;case a.EVENT.LIVE_CHAT_MESSAGE_HEIGHT_CHANGED:break;case a.EVENT.LIVE_CHAT_MESSAGE_SENT:this._scrollToBottom();break;case a.EVENT.LIVE_ORIGINAL_MESSAGE_VIEW_REQUESTED:p.openLiveViewerChatOriginalMessageViewLayer(t,this.model);break;case a.EVENT.LIVE_CHAT_SECTION_SIZE_CHANGED:case a.EVENT.LIVE_DESCRIPTION_TOGGLED:case a.EVENT.LIVE_CHAT_PIN_MESSAGE_TOGGLED:case a.EVENT.LIVE_CHAT_MESSAGE_INPUT:this._isAutoScroll&&this._scrollToBottom()}},_handleLiveStatusChange:function(e){switch(e){case d.PLAYING:this._renderLayout()}}});return b.buildLiveViewerChatLayoutView=function(e){return new b({model:e})},b}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="chattingMessageArea">\n    <% if (enabled.pinMessage) { %>\n    <div class="noticeMessageBox _pinMessage"></div>\n    <% } %>\n\n    <div class="chattingBox gPab1 _scrollWrap">\n        <% if (welcomeMessage) { %>\n        <div class="alertMessage _welcomeMessage" style="display:none"><%= welcomeMessage %></div>\n        <% } %>\n        <% if (enabled.messageList) { %>\n        <div class="messageWrap _messageList" style="display:none"></div>\n        <div class="_messageBottom"></div>\n        <% } %>\n        <div class="_chatStatus" style="display:none"></div>\n    </div>\n    <% if (enabled.messageList) { %>\n    <button class="btnNewlyMessage _downArrowBtn" style="display:none"><%= IM(\'ui.label.go_to_bottom\') %></button>\n    <% } %>\n</div>\n<% if (enabled.messageInput) { %>\n<div class="chattingWriteArea _messageInput" style="display:none"></div>\n<% } %>\n\n<% if (bandJoinBtnLabel) { %>\n<div class="joinBandBtnBox _bandJoinBtnWrap">\n    <button class="btnJoinBand sf_bg _bandJoinBtn"><%= bandJoinBtnLabel %></button>\n</div>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=n(4),a=n(2553),r=(n(1405),n(618)),l=n(889),c=n(9),d=n(26),u=n(154);n(185);var h={PROFILE:"profileMenu",MESSAGE:"messageMenuList"};return s.View.extend({tagName:"div",className:"messageSection",attributes:{"data-viewname":"DLiveViewerChatMessageView","data-marker-type":"message"},template:i.template(a),ui:{profile:"._profile",profileMenu:"._profileMenu",messageMenuBtn:"._messageMenuBtn",messageMenuList:"._messageMenuList"},regions:{profile:{el:"@ui.profile",replaceElement:!0},profileMenu:{el:"@ui.profileMenu",replaceElement:!1},messageMenuList:{el:"@ui.messageMenuList",replaceElement:!0}},events:{"click @ui.messageMenuBtn":function(){this._toggleMenu(h.MESSAGE)}},modelEvents:{change:"render"},childViewEvents:{clickProfileImageView:function(){this._toggleMenu(h.PROFILE),d.getDGlobalChannel().trigger(d.EVENT.HTML_CLICK)}},initialize:function(e){this._liveViewerModel=e.liveViewerModel,this._profileMenuController=this._liveViewerModel.getLiveContentProfileMenuController(),this._messageMenuController=this._liveViewerModel.getLiveContentMessageMenuController()},serializeData:function(){var e=this._liveViewerModel.getLiveContentCreator(),t=this.model.getLiveChatMessageSender();return{enabled:{profileMenu:this._liveViewerModel.isLiveContentMessageProfileMenuEnabled(this.model.getLiveChatMessageSender())},name:t.getContentAuthorName(),realName:this._isPageMessage()&&this._liveViewerModel.getLiveContentBandData().canShowPageProfileRealName()?t.getContentAuthorRealName():null,hidden:!this.model.isNormalLiveChatMessage(),content:this._getContent(),live:this._isPageMessage()||e.isSameMemberKeyContentAuthor(t),menu:!i.isEmpty(this._messageMenuController.getLiveMessageMenuList(this.model)),time:this._getTime()}},onRender:function(){this._renderProfile()},onAttach:function(){this.listenTo(d.getDGlobalChannel(),d.EVENT.HTML_CLICK,this._hideAllLayer)},onBeforeDetach:function(){this.stopListening(d.getDGlobalChannel())},_renderProfile:function(){var e=this.model.getLiveChatMessageSender();this.showChildView("profile",r.buildDProfileImageView({bandCore:this._liveViewerModel.getLiveContentBandData().getBandCore(),memberProfile:e.getContentAuthorMemberProfile(),role:e.getContentAuthorRole(),disableClick:!this._liveViewerModel.isLiveContentMessageProfileMenuEnabled(this.model.getLiveChatMessageSender()),size:21}))},_isPageMessage:function(){var e=this._liveViewerModel.getLiveContentCreator(),t=this.model.getLiveChatMessageSender();return e.isPageProfileContentAuthor()&&t.isPageProfileContentAuthor()},_getContent:function(){return this.model.isNormalLiveChatMessage()?this.model.getLiveChatMessageContent():this.model.isBlindLiveChatMessage()?IM("chat.message.blind_message.txt"):this.model.isHiddenLiveChatMessage()?IM("live.chat_hidden_message"):""},_getTime:function(){return this._liveViewerModel.isVodLiveContent()?this._getOffsetTime():c.format.time(this.model.getLiveChatMessageCreatedAt(),"hour_minute")},_getOffsetTime:function(){var e=Math.floor(this.model.getLiveChatMessageVideoOffset()/1e3),t=Math.floor(e/3600),n=o.lpad(Math.floor(e%3600/60),2,"0"),s=o.lpad(e%60,2,"0");return i.compact([t,n,s]).join(":")},_hideAllLayer:function(){this._hideAllMenus()},_toggleMenu:function(e){this._getMenuRegion(e).hasView()||(this._liveViewerModel.notifyLiveContentChatMessageMenuOpened(),u.wrapDeferPromise(this).then(i.bind(this._showMenu,this,e)))},_showMenu:function(e){u.wrapActivePromise(this._getMenuList(e),this).then(i.bind((function(t){var n=this._getMenuRegion(e),i=l.build(t,{listClass:"moreMenuList -active",listItemClass:"moreMenuItem",btnClass:"btnMoreMenu"});this.listenTo(i,l.EVENTS.MENU_SELECTED,(function(t){this._handleSelectedMenu(e,t)})),i.$el.css({visibility:"hidden"}),this.listenToOnce(i,"attach",(function(){var e=this.$el.scrollParent().get(0).getBoundingClientRect(),t=i.el.getBoundingClientRect(),n=t.left-e.left,o=t.bottom-e.bottom;i.$el.css({right:n<0?Math.floor(n):"",top:o>=0?"auto":"",bottom:o>=0?21:"",visibility:""})})),this._handleMenuToggle(e,!0),n.show(i)}),this))},_getMenuRegion:function(e){return this.getRegion(e)},_getMenuList:function(e){switch(e){case h.PROFILE:return this._profileMenuController.getLiveMessageProfileMenuList(this.model.getLiveChatMessageSender());case h.MESSAGE:return t.Deferred().resolve(this._messageMenuController.getLiveMessageMenuList(this.model)).promise();default:return t.Deferred().reject().promise()}},_handleSelectedMenu:function(e,t){switch(this._hideAllMenus(),e){case h.PROFILE:this._profileMenuController.handleSelectedLiveMessageProfileMenu(t,this.model.getLiveChatMessageSender());break;case h.MESSAGE:this._messageMenuController.handleSelectedLiveMessageMenu(t,this.model)}},_handleMenuToggle:function(e,t){switch(e){case h.PROFILE:this.ui.profileMenu.css("display",t?"":"none")}},_hideAllMenus:function(){i.each(h,(function(e){var t=this._getMenuRegion(e);t.hasView()&&(this._liveViewerModel.notifyLiveContentChatMessageMenuClosed(),t.empty(),this._handleMenuToggle(e,!1))}),this)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="messageBox">\n    <div class="writerPhoto">\n        <span class="_profile"></span>\n        <% if (enabled.profileMenu) { %>\n        <div class="moreFunctionBox _profileMenu" style="display:none"></div>\n        <% } %>\n    </div>\n    <div class="message">\n        <span class="writerInfo<%- realName ? \' -pageProfile\' : \'\' %>"><em class="mainText"><%- name %></em><% if (realName) { %><em class="subText"><%- realName %></em><% } %></span>\n        <span class="messageText<%- hidden ? \' -hidden\' : \'\' %>"><%- content %></span>\n    </div>\n</div>\n<div class="messageInfoBox">\n    <div class="messageInfoBox _messageMenu">\n        <% if (live) { %>\n        <div class="gMarkLive -w27 gMal6 gBlock">Live</div>\n        <% } %>\n        <div class="moreFunctionBox">\n            <% if (menu) { %>\n            <button class="btnMoreFunctionView _messageMenuBtn"><%= IM(\'web.uicomponent.topbar.button.menuopen\') %></button>\n            \x3c!-- 더보기 클릭시 -active클래스 추가 /messageBox의 넓이가 140px이 넘지 않을경우 style에 right: auto값을 넣어주세요--\x3e\n            <ul class="moreMenuList _messageMenuList" style="display:none"></ul>\n            <% } %>\n        </div>\n        <time class="chatTime"><%- time %></time>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2555),s=n(82),a=n(9),r="-shortcut",l="-opened",c=i.View.extend({tagName:"div",className:"noticeMessageBox -show "+r,attributes:{"data-viewname":"DLiveViewerChatPinMessageView"},template:t.template(o),ui:{toggleBtn:"._toggleBtn",foldBtn:"._foldBtn",unpinBtn:"._unpinBtn"},events:{"click @ui.toggleBtn":"_toggleMessage","click @ui.foldBtn":"_foldMessage","click @ui.unpinBtn":"_unpinMessage"},initialize:function(e){this._liveViewerModel=e.liveViewerModel},templateContext:function(){var e=this.model.getLiveChatMessageSender(),t=s.make(e.getContentAuthorProfileImageUrl(),s.TYPE.s75);return{enabled:{unpinBtn:this._liveViewerModel.canPinLiveContentChatMessage()},name:e.getContentAuthorName(),profile:t,profileInnerClass:s.makeProfileInnerClass(t),content:this.model.getLiveChatMessageContent(),time:a.format.time(this.model.getLiveChatMessageCreatedAt(),"hour_minute")}},_toggleMessage:function(){this.$el.toggleClass(r),this.ui.toggleBtn.toggleClass(l,!this.$el.hasClass(r)),this._liveViewerModel.notifyLiveContentChatPinMessageToggled()},_foldMessage:function(){this.$el.addClass(r),this.ui.toggleBtn.removeClass(l),this._liveViewerModel.notifyLiveContentChatPinMessageToggled()},_unpinMessage:function(){this._liveViewerModel.unpinLiveContentChatMessage(this.model)}});return c.buildLiveViewerChatPinMessageView=function(e){return new c({model:e.getLiveContentPinMessage(),liveViewerModel:e})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="noticeMessageInfo">\n    <span class="noticeLeaderPhoto">\n        <span class="uProfile -border -size25 -pinned">\n            <span class="profileInner <%- profileInnerClass %>">\n                <% if (profile) { %>\n                    <img src="<%- profile %>" width="25" height="25" alt="<%- IM(\'web.profile.basic.title\') %>">\n                    <% } %>\n            </span>\n        </span>\n    </span>\n    <div class="noticeMessageText">\n        <span class="noticeLeaderName"><%- name %></span>\n        <span class="noticeLeaderMessage"><%- content %></span>\n        <time class="noticeCreateTime"><%- time %></time>\n    </div>\n    \x3c!--열기 일 땐-opened 클래스 추가 해주세요. 아이콘이 변경됩니다.--\x3e\n    <button class="btnNoticeView _toggleBtn"><%= IM(\'ui.label.unfold\') %></button>\n</div>\n<div class="noticeMessageFooter">\n    <button class="btnTextSmall _foldBtn"><%= IM(\'ui.label.collapse\') %></button>\n    <% if (enabled.unpinBtn) { %>\n    <button class="btnTextSmall _unpinBtn"><%= IM(\'ui.label.unpin_message\') %></button>\n    <% } %>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(10),s=n(4),a=n(2557),r=n(1156),l=n(82),c=n(154),d=n(559),u=n(167),h=n(166),p=n(801),m=n(57),_=n(555),g=n(562),f=n(158),b="-active",v=s.View.extend({tagName:"div",className:"chattingWriteArea",attributes:{"data-viewname":"DLiveViewerChatMessageInputView"},template:i.template(a),ui:{editor:"._editor",sendBtn:"._sendBtn"},events:{"click @ui.sendBtn":"_sendMessage","click @ui.editor":"_onEditorClickEvent","input @ui.editor":"_onEditorInputEvent","keydown @ui.editor":"_onEditorKeyDownEvent","paste @ui.editor":"_onEditorPasteEvent","cut @ui.editor":"_onEditorCutEvent"},modelEvents:{all:"_onTriggerLiveViewerModel"},initialize:function(e){this._bandData=this.model.getLiveContentBandData(),this._sendKey=this._getSendKey()},templateContext:function(){var e=this.model.getOnAirLiveContentUser(),t=l.make(e.getContentAuthorProfileImageUrl(),l.TYPE.s75);return{profile:t,profileInnerClass:l.makeProfileInnerClass(t)}},_getSendKey:function(){return u.getCurrentUserEnvStorage().get([h.MessageSendKey,p.MESSAGE_SEND_KEY.API_KEY_NAME.CHAT])?d.ENTER:d.CONTROL_ENTER},_sendMessage:function(){var e=o.trim(this._getMessage()),t=this.model.isChatAvailableLiveContent();this._bandData.canChatInLive()&&!this._sending&&e&&t&&this._canSendMessage()&&(this._sending=!0,c.wrapActivePromise(this.model.sendLiveContentChatMessage(e),this).then(i.bind((function(){this.ui.editor.empty().trigger("input"),this._sending=!1}),this),i.bind((function(){this._sending=!1,this._alert(IM("chat.failed_to_send"))}),this)))},_getMessage:function(){return this.ui.editor.text()||""},_onEditorClickEvent:function(){this.model.isChatAvailableLiveContent()&&this._canSendMessage()},_onEditorInputEvent:function(){var e,t=this._getMessage();this.model.notifyLiveContentChatMessageInput(),t.length>200&&(e=this._getEditorCaretPosition(),t=t.substring(0,200),this.ui.editor.text(t),this._setEditorCaratPosition(e)),this._toggleSendBtn()},_toggleSendBtn:function(){var e=this.model.isChatAvailableLiveContent(),t=this.model.isChatBlockedLiveContent(),n=!o.isBlank(this._getMessage()),i=this._bandData.canChatInLive()&&e&&!t&&n;this.ui.sendBtn.toggleClass(b,i)},_onEditorKeyDownEvent:function(e){if(e.keyCode==_.ENTER&&(e.preventDefault(),!e.shiftKey))switch(this._sendKey){case d.ENTER:if(!(m.isMac()&&e.ctrlKey||e.altKey))return void this._sendMessage();break;case d.CONTROL_ENTER:if(m.isMac()&&e.metaKey||e.ctrlKey)return void this._sendMessage()}t.browser.msie&&i.defer(i.bind((function(){this.ui.editor.trigger("input")}),this))},_onEditorPasteEvent:function(e){var n,i=e.originalEvent;e.preventDefault(),i.clipboardData&&i.clipboardData.getData?(n=i.clipboardData.getData("text/plain"),n=this._convertPastedText(n),document.execCommand("insertText",!1,n)):window.clipboardData&&window.clipboardData.getData&&(n=window.clipboardData.getData("Text"),n=this._convertPastedText(n),this._insertTextToInputAtCursor(n)),t.browser.msie&&this.ui.editor.trigger("input")},_onEditorCutEvent:function(){t.browser.msie&&i.defer(i.bind((function(){this.ui.editor.trigger("input")}),this))},_insertTextToInputAtCursor:function(e){var t=window.getSelection().getRangeAt(0);t.deleteContents(),t.insertNode(document.createTextNode(e))},_convertPastedText:function(e){return e?e.trim().replace(/\r?\n/g,"").substring(0,200):""},_getEditorCaretPosition:function(){var e=window.getSelection().getRangeAt(0),t=e.cloneRange();return t.selectNodeContents(this.ui.editor.get(0)),t.setEnd(e.endContainer,e.endOffset),t.toString().length},_setEditorCaratPosition:function(e){e>200&&(e=200),window.getSelection().collapse(this.ui.editor.get(0).firstChild,e)},_canSendMessage:function(){return this.model.isPageBandChatBlockedLiveContent()?(this._alert(IM("chat.message.blocked_page_band_chat")),!1):this.model.isGroupBandChatBlockedLiveContent()?(this._alert(IM("live.band_chat_blocked")),!1):!this.model.isOnAirChatBlockedLiveContent()||(this._alert(IM("live.chat_blocked")),!1)},_onTriggerLiveViewerModel:function(e,t){switch(e){case r.EVENT.LIVE_STATUS_CHANGED:case r.EVENT.LIVE_CHAT_BLOCK_CHANGED:this._toggleSendBtn()}},_alert:function(e){return g.openLayer({bodyTitle:f.nl2br(e),withoutHiding:!0})}});return v.buildLiveViewerChatMessageInputView=function(e){return new v({model:e})},v}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="chattingWriteBox">\n    <div class="chattingWrite">\n        <div class="writerPhoto">\n            <span class="uProfile -border -size25">\n                <span class="profileInner <%- profileInnerClass %>">\n                    <% if (profile) { %>\n                    <img src="<%- profile %>" width="25" height="25" alt="<%- IM(\'web.profile.basic.title\') %>">\n                    <% } %>\n                </span>\n            </span>\n        </div>\n        <div class="writtingArea _editor" contenteditable="true" placeholder="<%= IM(\'web.chatroom.messageinput.placeholder.input_comment\') %>"></div>\n    </div>\n    \x3c!--writtingArea에 포커싱 되면 -active클래스를 추가해주세요.--\x3e\n    <button class="btnSendMessage _sendBtn"><span class="gSrOnly"><%= IM(\'ui.label.send\') %></span></button>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2559),s=n(2043),a=n(158),r=i.View.extend({tagName:"div",className:"uEmpty -fdColumn",attributes:{"data-viewname":"DLiveViewerChatStatusView"},template:t.template(o),ui:{connectBtn:"._connectBtn"},events:{"click @ui.connectBtn":function(){this.model.connectLiveContentChat()}},initialize:function(e){this._message=this._getMessage()},serializeData:function(){return{enabled:{connectBtn:this.model.isChatUnAvailableLiveContent()},message:a.nl2br(this._message||"")}},onRender:function(){this.$el.css("display",this._message?"":"none")},_getMessage:function(){if(!this.model.isChatMessageEnabledLiveContent())return IM("live.chat_status_without_chat");if(this.model.isChatAvailableLiveContent())return this.model.isEmptyLiveContentMessageCollection()?IM("live.chat_status_send_message"):null;if(this.model.isChatUnAvailableLiveContent())switch(this.model.getLiveContentChatConnectFailedReason()){case s.CLOSED_LIVE_FAIL:return null;case s.EXCEEDED_ALLOWED_LIMIT:return IM("live.chat_status_member_exceeded");default:return IM("ui.alert.temporary_error")}return this.model.isOnAirLiveContent()?IM("ui.desc.loading"):null}});return r.buildLiveViewerChatStatusView=function(e){return new r({model:e})},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% if (enabled.connectBtn) { %>\n<button type="button" class="buttonRefresh _connectBtn"><span class="gSrOnly"><%- IM(\'ui.label.retry\') %></span></button>\n<% } %>\n<% if (message) { %>\n<%= message /* 개행 태그 있음 */ %>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2561),s=n(618),a=n(9),r=n(486),l=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DLiveViewerChatOriginalMessageView"},template:t.template(o),ui:{profile:"._profile",cancelBtn:"._cancelBtn",unhideBtn:"._unhideBtn"},regions:{profile:{el:"@ui.profile",replaceElement:!0}},events:{"click @ui.cancelBtn":"destroy","click @ui.unhideBtn":function(){this._liveViewerModel.unhideLiveContentChatMessage(this.model),this.destroy()}},initialize:function(e){this._liveViewerModel=e.liveViewerModel},templateContext:function(){var e=this._liveViewerModel.getLiveContentCreator(),t=this.model.getLiveChatMessageSender(),n=e.isPageProfileContentAuthor()&&t.isPageProfileContentAuthor();return{name:t.getContentAuthorName(),realName:n&&this._liveViewerModel.getLiveContentBandData().canShowPageProfileRealName()?t.getContentAuthorRealName():null,content:this.model.getLiveChatMessageContent(),time:a.format.time(this.model.getLiveChatMessageCreatedAt(),"hour_minute")}},onRender:function(){this._renderProfile()},_renderProfile:function(){var e=this.model.getLiveChatMessageSender();this.showChildView("profile",s.buildDProfileImageView({bandCore:this._liveViewerModel.getLiveContentBandData().getBandCore(),memberProfile:e.getContentAuthorMemberProfile(),role:e.getContentAuthorRole(),disableClick:!0,size:21}))}});return l.openLiveViewerChatOriginalMessageViewLayer=function(e,t){var n=new l({model:e,liveViewerModel:t});r.openWithoutHiding(n)},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent" style="width:360px">\n    <header class="modalHeader">\n        <h1 class="title"><%= IM(\'ui.label.view_original\') %></h1>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gMat12 gPal12 gPar12">\n            <div class="messageBox">\n                <div class="writerPhoto"><span class="_profile"></span></div>\n                <div class="message">\n                    <span class="writerInfo<%- realName ? \' -pageProfile\' : \'\' %>"><em class="mainText"><%- name %></em><% if (realName) { %><em class="subText"><%- realName %></em><% } %><time class="subText"><%- time %></time></span>\n                    <span class="messageText"><%- content %></span>\n                </div>\n            </div>\n\n        </div>\n    </div>\n\n    <div class="modalFooter">\n        <button type="button" class="uButton -cancel _cancelBtn"><%= IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _unhideBtn"><%= IM(\'chat.message.menu.set_message_hidden_restore\') %></button>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2563),s=n(2564),a=n(2047),r=n(1650),l=n(2048),c=n(1572),d=n(2572),u=n(2574),h=n(1180),p=n(2050),m=n(2577),_=n(1571),g=n(2051),f=n(82),b=n(1156),v=n(2052),A=n(154),E=i.View.extend({behaviors:[{behaviorClass:a,regionName:"volumeUI"},{behaviorClass:r,regionName:"btnFullscreen"},{behaviorClass:l,regionName:"chatButton"},{behaviorClass:c,regionName:"livePlayTimeUI",playController:"playController"},{behaviorClass:d,protocolRegionName:"protocolConfigMenu",regionName:"configMenu",playController:"playController"},{behaviorClass:u,regionName:"protocolConfigMenu",playController:"playController",uiToggleEventName:"toggleControlUI"},{behaviorClass:h,uiToggleEventName:"toggleControlUI"},{behaviorClass:p,regionName:"loading"},{behaviorClass:g,bigPlayRegion:"bigPlay",playbackRegion:"btnPlayback",playController:"playController"},{behaviorClass:v,playController:"playController",playerUIContainer:"playerUIContainer"},{behaviorClass:m,playController:"playController"}],attributes:{"data-viewname":"DLiveVideoPlayerView"},className:"videoArea",template:t.template(o),templateContext:function(){return{poster:f.make(this.model.getLiveContentLiveModel().getLiveThumbnail(),f.TYPE.e1280_std),startWithMute:this.model.getLiveContentLiveModel().isLiveCreatorMe(),maxRunningTime:this._getMaxRunningTime()}},ui:{video:"video",playerUIContainer:"._playerUIContainer",volumeUI:"._volumeUI",livePlayTimeUI:"._livePlayTime",chatButton:"._chatButton",bigPlay:"._bigPlay",btnPlayback:"._btnPlayback",btnPlay:"._btnPlay",btnPause:"._btnPause",btnResolution:"._btnResolution",btnFullscreen:"._btnFullscreen",btnConfig:"._btnConfig",protocolConfigContainer:"._protocolConfigContainer",configContainer:"._configContainer",playerControls:"._playerControls",loading:"._loading",maxRunningTime:"._maxRunningTime"},regions:{livePlayTimeUI:{el:"@ui.livePlayTimeUI",replaceElement:!0},btnPlayback:{el:"@ui.btnPlayback",replaceElement:!0},bigPlay:{el:"@ui.bigPlay",replaceElement:!0},volumeUI:{el:"@ui.volumeUI",replaceElement:!0},btnFullscreen:{el:"@ui.btnFullscreen",replaceElement:!0},chatButton:{el:"@ui.chatButton",replaceElement:!0},protocolConfigMenu:{el:"@ui.protocolConfigContainer",replaceElement:!0},configMenu:{el:"@ui.configContainer",replaceElement:!0},loading:{el:"@ui.loading",replaceElement:!0}},initialize:function(){this._currentResolution="AUTO",this.listenTo(this,"toggleControlUI",this._toggleControls)},onRender:function(){this.playController=new s({video:this.getUI("video")[0],playInfo:this.model.getLiveContentLiveModel().getLivePlayInfo(),startDateTime:this.model.getLiveContentLiveModel().getLiveStartAt()}),this._toggleControls(!1)},onAttach:function(){this.listenTo(this.playController,s.EVENT.READY_PLAYING,(function(){this.trigger(_.PLAY_READY)})),this.listenTo(this.playController,s.EVENT.COMPLETED_PLAYING,(function(){this.trigger(_.PLAY_ENDED)})),this.listenTo(this.playController,s.EVENT.ERROR_OCCURRED,(function(){this.trigger(_.ERROR_OCCURRED)})),this.listenTo(this.playController,s.EVENT.ERROR_RECOVERED,(function(){this.trigger(_.ERROR_RECOVERED)})),this.listenTo(this.playController,s.EVENT.FATAL_ERROR_OCCURRED,(function(e){s.FATAL_ERROR.NOT_SUPPORT_BROWSER_ERROR===e&&alert(IM("live.not_support_browser"))})),this.playController.play(),this.getUI("video").on("timeupdate",t.bind((function(){if(this.model.isOnAirLiveContent()&&(this.trigger(_.PLAY_TIME_UPDATE,Math.round(this.playController.getPlayTimeMilli())),this.getLiveModel().getLiveStartAt())){var e=this.getLiveModel().getLiveMaxRunningTimeMins(),t=this.getLiveModel().getLiveStartAt()+60*e*1e3;Date.now()>t&&this.model.stopLiveContentBroadcasting(!0)}}),this))},modelEvents:function(){var e={};return e[b.EVENT.LIVE_FETCHED_AFTER_ON_LIVE]="_changeLiveSource",e[b.EVENT.LIVE_STARTED_PLAYING]="_showMaxRunningTime",e},onBeforeDetach:function(){this.playController.destroy()},_toggleControls:function(e){this.getUI("playerControls").toggle(e&&this.model.isOnAirLiveContent())},_changeLiveSource:function(){this.playController.changePlayInfo(this.model.getLiveContentLiveModel().getLivePlayInfo())},_showMaxRunningTime:function(){A.wrapActiveSetTimeout(1e3,this).then(t.bind((function(){this.ui.maxRunningTime.show(),A.wrapActiveSetTimeout(1e4,this).then(t.bind((function(){this.ui.maxRunningTime.fadeOut()}),this))}),this))},_getMaxRunningTime:function(){if(this.model.isStreamerModeLiveContent()){var e=Math.round(this.model.getLiveContentMaxRunningTimeMins()/60);if(e>0)return IM("live.max_running_time",{hours:e})}return null},getLiveModel:function(){if(this.model.isOnAirLiveContent())return this.model.getLiveContentLiveModel()}});return E.buildDLiveVideoPlayerView=function(e){return new E({model:e})},E}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="videoBox _playerUIContainer">\n    <div class="_bigPlay"></div>\n    <div class="liveStateBox">\n        <div class="_livePlayTime"></div>\n        <% if (maxRunningTime) { %>\n        <div class="liveGuideText _maxRunningTime" style="display:none"><%- maxRunningTime %></div>\n        <% } %>\n    </div>\n\n    \x3c!-- 종료시 -finished 클래스를 넣어주시면 컨트롤러 재정렬됩니다. --\x3e\n    <div class="liveControlBox _playerControls">\n        <div class="liveProgressBar">\n            <span class="currentBar"></span>\n            <span class="loadedBar"></span>\n        </div>\n        <div class="controlBoxL">\n            <button class="_btnPlayback"></button>\n            <div class="_volumeUI"></div>\n        </div>\n\n        <div class="controlBoxR">\n            <div class="_protocolConfigContainer"></div>\n            <div class="_configContainer"></div>\n            <div class="_chatButton"></div>\n            <button class="_btnFullscreen"></button>\n        </div>\n    </div>\n    <span class="_loading"></span>\n    <video poster="<%=poster%>" <% if (startWithMute) { %>muted<% } %>></video>\n</div>'},function(e,t,n){var i=n(0),o=n(10),s=n(4),a=n(2565),r=n(1570),l=n(2566),c=n(1406),d=n(167),u=n(166),h=c.EVENT,p=c.FATAL_ERROR,m=s.Object.extend({initialize:function(){this._currentProtocol=this._getDefaultProtocol(),this._loadPlayController("AUTO")},_getDefaultProtocol:function(){var e;return(e=o.include(location.href,"mode=hls")?"hls":d.getCurrentUserEnvStorage().get([u.LiveProtocol]))||(e="dash"),"hls"===e||this.isSupportProtocol("dash")||(e="hls"),e},_loadPlayController:function(e){var t;e=e||"AUTO",t="hls"===this._currentProtocol?new r({quality:e,video:this.options.video,source:this.options.playInfo.hls.adaptivePlaybackInfo.url,startDateTime:this.options.startDateTime}):new a({quality:e,video:this.options.video,source:this.options.playInfo.dash.url,startDateTime:this.options.startDateTime}),this._runningLiveVideoPlayController=t,i.each(h,(function(e){this.listenTo(t,e,(function(){this.trigger.apply(this,[e].concat(i.toArray(arguments)))}))}),this)},play:function(){this._runningLiveVideoPlayController.play()},pause:function(){this._runningLiveVideoPlayController.pause()},isPlaying:function(){return this._runningLiveVideoPlayController.isPlaying()},destroy:function(){this.stopListening(this._runningLiveVideoPlayController),this._runningLiveVideoPlayController.destroy()},changePlayInfo:function(e){this.options.playInfo=e,this.changeProtocol(this._currentProtocol)},getVideoResolution:function(){return this._runningLiveVideoPlayController.getVideoResolution()},getPlayTimeMilli:function(){return this._runningLiveVideoPlayController.getPlayTimeMilli()},isSupportProtocol:function(e){return!("dash"===e&&!l.supportLiveDash())},changeProtocol:function(e){if(this.isSupportProtocol(e)){var t=this._runningLiveVideoPlayController.isPlaying(),n=this._runningLiveVideoPlayController.getQualityInfo();this.stopListening(this._runningLiveVideoPlayController),this._runningLiveVideoPlayController.destroy(),this._currentProtocol=e,this._loadPlayController(n&&n.current),d.getCurrentUserEnvStorage().set([u.LiveProtocol],e),t&&this._runningLiveVideoPlayController.play(),this.trigger(h.PROTOCOL_CHANGED,e)}},changeQuality:function(e){this._runningLiveVideoPlayController.changeQuality(e)},getCurrentProtocol:function(){return this._currentProtocol},getQualityInfo:function(){return this._runningLiveVideoPlayController.getQualityInfo()}});m.EVENT=h,m.FATAL_ERROR=p,e.exports=m},function(e,t,n){var i=n(0),o=n(2),s=n(4),a=n(1406),r=void 0,l=a.EVENT,c=a.FATAL_ERROR,d=s.Object.extend({initialize:function(e){this._sourceRetriedCount=0,this._maxSourceRetryCount=8,this._retryInterval=500,this._stallingTimeout=5e3,this._video=e.video,this._setSource(e.source),this._currentQuality=e.quality,this._dashPlayer=void 0,this._isDestroyed=!1,this._startDateTime=e.startDateTime,this._availabilityStartTime=void 0,this._triggerEnded=i.bind((function(){this.trigger(l.COMPLETED_PLAYING)}),this),this._playContext={playing:!1,step:0}},_setSource:function(e){i.isFunction(e)?this._source=e:e&&i.isFunction(e.then)?this._source=i.constant(e):this._source=i.constant(o.Deferred().resolve(e).promise())},play:function(){this._playContext.playing||(this._changePlaying(!0),this._run())},pause:function(){this._playContext.playing&&(this._changePlaying(!1),this._run())},_moveToStep:function(e){if(!isFinite(e))throw Error("step is required");this._playContext.step=e,this._run()},_run:function(){if(r)switch(this._playContext.step){case 0:this._source.call().then(i.bind((function(e){this._url=e,this._moveToStep(1)}),this));break;case 1:if(!this._playContext.playing)return;var e=i.bind((function(){this._sourceRetriedCount>this._maxSourceRetryCount?(console.log("------------------------------------------- source retrieve failed"),this.trigger(l.FATAL_ERROR_OCCURRED,c.SOURCE_ERROR)):(this._sourceRetriedCount++,console.log("------------------------------------------- invalid manifest, wait for",this._retryInterval),this._dashPlayer.reset(),this._dashPlayer=void 0,i.delay(i.bind((function(){this._moveToStep(1)}),this),this._retryInterval))}),this),t=i.bind((function(){this._dashPlayer.off(r.MediaPlayer.events.STREAM_INITIALIZED,t),i.isEmpty(this._dashPlayer.getBitrateInfoListFor("video"))?e():(this._dashPlayer.setLowLatencyEnabled(!0),this._dashPlayer.setScheduleWhilePaused(!1),this._dashPlayer.useDefaultABRRules(!1),this._dashPlayer.setCatchUpPlaybackRate(.5),this._dashPlayer.setLowLatencyMinDrift(.02),this.changeQuality(this._currentQuality),this._moveToStep(2))}),this),s=i.bind((function(e){this.trigger(l.SLOW_NETWORK_DETECTED),this._dashPlayer.retrieveManifest(this._url,(function(){console.log("-------------------------------------------\x3e>>>  onRetrived")}))}),this),a=i.bind((function(){this._dashPlayer.retrieveManifest(this._url,(function(){console.log("-------------------------------------------\x3e>>>  onRetrived")}))}),this);this._dashPlayer=r.MediaPlayer().create(),this._dashPlayer.getDebug().setLogLevel(r.Debug.LOG_LEVEL_INFO),this._dashPlayer.getDebug().setLogToBrowserConsole(!1),this._dashPlayer.initialize(o(this._video)[0],this._url,!1),o(this._video).one("ended",this._triggerEnded),this._dashPlayer.on(r.MediaPlayer.events.STREAM_INITIALIZED,t),this._dashPlayer.on(dashjs.MediaPlayer.events.MANIFEST_LOADED,i.bind((function(e){this._availabilityStartTime=e.data.availabilityStartTime.getTime()}),this)),this._dashPlayer.on(r.MediaPlayer.events.FRAGMENT_LOADING_ABANDONED,s),this._dashPlayer.on(r.MediaPlayer.events.SEGMENT_NOT_FOUND_AGAIN_REPEAT,a),this._dashPlayer.on(r.MediaPlayer.events.ERROR,i.bind((function(t){if(console.log("error -------------------------------",t),1===this._playContext.step&&"download"===t.error&&t.event&&"manifest"===t.event.id)return console.log("------------------------------------------- source retrieve failed"),void e();this.trigger(l.ERROR_OCCURRED)}),this));break;case 2:var d=this.getVideoResolution();if(d&&d.height===d.width&&o(this._video).css("transform","matrix(1, 0, 0, 0.56, 0, 0)"),this._playContext.playing)return void(this._dashPlayer.isPaused()&&(this._dashPlayer.play(),setTimeout(i.bind((function(){this._dashPlayer.isPaused()?this._video.muted?(this._dashPlayer.pause(),o(this._video).trigger("pause"),this._changePlaying(!1)):(this._video.muted=!0,this._moveToStep(2)):this._moveToStep(3)}),this),200)));this._moveToStep(4);break;case 3:if(this.trigger(l.READY_PLAYING),this._playContext.playing)return;this._dashPlayer.pause(),this._moveToStep(4);break;case 4:if(!this._playContext.playing)return;this._dashPlayer.play(),this._dashPlayer.seek(this._dashPlayer.duration()),this._moveToStep(3)}else n.e(171).then(n.t.bind(null,3104,7)).then(i.bind((function(e){r=e.default,this._moveToStep(0)}),this))},_changePlaying:function(e){var t=this._playContext.playing!==e;this._playContext.playing=e,t&&this.trigger(l.CHANGE_PLAYING,this._playContext.playing)},isPlaying:function(){return this._playContext.playing},destroy:function(){this._changePlaying(!1),this._video.pause(),this._dashPlayer&&(this._dashPlayer.reset(),this._dashPlayer=void 0),o(this._video).off("ended",this._triggerEnded),o(this._video).css("transform",""),this._isDestroyed=!0,this._playContext.playing=!1,this._playContext.step=0},getVideoResolution:function(){if(this._dashPlayer){var e=this._dashPlayer.getBitrateInfoListFor("video")[this._dashPlayer.getQualityFor("video")];return{width:e.width,height:e.height}}},getPlayTimeMilli:function(){if(this._dashPlayer)return 1e3*this._dashPlayer.durationAsUTC()-this._startDateTime},getQualityInfo:function(){return{supports:["AUTO"].concat(a.VIDEO_QUALITY),current:this._currentQuality}},changeQuality:function(e){if("AUTO"===e)this._dashPlayer.setAutoSwitchQualityFor("video",!0);else{var t=i.findIndex(a.VIDEO_QUALITY,(function(t){return t===e}));if(t<0)return;this._dashPlayer.setAutoSwitchQualityFor("video",!1),this._dashPlayer.setQualityFor("video",t)}this._currentQuality=e}});d.EVENT=l,d.FATAL_ERROR=c,e.exports=d},function(e,t,n){var i=n(57);t.supportLiveDash=function(){return!i.isMSIE()}},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2568);return o.View.extend({options:{muted:!1,volume:.5},initialize:function(e){this._volume=e.volume,this._muted=e.muted},className:"volumeBox",attributes:{"data-viewname":"DPlayerVolumeUIView"},template:t.template(s),ui:{button:"._volumeButton",slider:"._volumeSlider",total:"._volumeSliderTotal",current:"._volumeSliderCurrent",handle:"._volumeSliderHandle"},events:{"click @ui.button":function(){this._muted?this.trigger("changeVolumeUI",this._volume,!1):this.trigger("changeVolumeUI",this._volume,!0)}},onRender:function(){var e=t.bind(this._handleVolumeMove,this);this.getUI("slider").on("mousedown",t.bind((function(t){e(t);var n=i(document);return n.on("mousemove",e),n.one("mouseup",(function(){n.off("mousemove",e)})),!1}),this))},_handleVolumeMove:function(e){var t=this.getUI("total").offset(),n=this.getUI("total").width(),i=(e.pageX-t.left)/n;i=Math.max(0,i),i=Math.min(i,1),this.trigger("changeVolumeUI",i)},onAttach:function(){this.updateUI()},updateUI:function(){var e=this.getUI("total").position(),n=this.getUI("total").width()*(this._muted?0:this._volume);this.getUI("current").width(Math.round(n)),this.getUI("handle").css("left",Math.round(e.left+n-this.getUI("handle").width()/2)),this.$el.removeClass("-high -mid -low -mute"),0===this._volume||this._muted?(this.$el.addClass("-mute"),this.getUI("button").html(t.template('<span class="gSrOnly"><%=IM("unmute")%></span>'))):this._volume<.3?(this.$el.addClass("-low"),this.getUI("button").html(t.template('<span class="gSrOnly"><%=IM("mute")%></span>'))):this._volume<.6?(this.$el.addClass("-mid"),this.getUI("button").html(t.template('<span class="gSrOnly"><%=IM("mute")%></span>'))):(this.$el.addClass("-high"),this.getUI("button").html(t.template('<span class="gSrOnly"><%=IM("mute")%></span>')))},setVolume:function(e,t){this._volume=e,this._muted=t,this.updateUI()}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button class="liveBtn -volume _volumeButton"></button>\n<a href="javascript:void(0);" class="volumeProgressBar _volumeSlider">\n<span class="volumeHandle _volumeSliderHandle"></span>\n<span class="volumeCurrent _volumeSliderCurrent"></span>\n<span class="volumeTotal _volumeSliderTotal"></span>\n</a>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2570);return i.View.extend({attributes:{"data-viewname":"DLiveChatTooltipButtonView"},className:"chatBox",initialize:function(){this._isShowingChat=!0},template:t.template(o),templateContext:function(){return{isShowingChat:this._isShowingChat}},events:{"click ._button":function(){this._isShowingChat=!this._isShowingChat,this.trigger("changeChatToggle",this._isShowingChat),this.render()}}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% if (isShowingChat) { %>\n<div class="chatToolTip"><%-IM("live.display_chat.hide.description") %></div>\n<button class="liveBtn -chat _button"><span class="gSrOnly"><%-IM("live.display_chat.hide.btn")%></span></button>\n<% } else { %>\n<div class="chatToolTip"><%-IM("live.display_chat.show.description") %></div>\n<button class="liveBtn -unchat _button"><span class="gSrOnly"><%-IM("live.display_chat.show.btn")%></span></button>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=["<% if (isRemainTime) { %>",'<span class="liveFinishTime _liveLaptime"><%-timeText %></span>',"<% } else { %>",'<span class="liveStateImgLive -iconAni"><span class="gSrOnly">LIVE</span></span>','<time class="liveLaptime _liveLaptime" style="display:none;"><%-timeText %></time>',"<% } %>"].join(""),s=n(158),a=i.View.extend({attributes:{"data-viewname":"DLiveVideoTimeUIView"},className:"liveState",initialize:function(){this._timeMilli=0,this._isRemainTime=!1},ui:{liveLaptime:"._liveLaptime"},template:t.template(o),templateContext:function(){return{isRemainTime:this._isRemainTime,timeText:this._getLivePlayTimeText()}},setPlayTimeMilli:function(e,t){this._isRemainTime!==t&&(this._isRemainTime=t,this.render()),this._timeMilli=e,this._isRemainTime=t,t?this.render():this._isShowingLiveTime()&&this.getUI("liveLaptime").show().text(this._getLivePlayTimeText())},_getLivePlayTimeText:function(){if(this._isRemainTime)return this._timeMilli>6e4?IM("live.time.end_remain_message.by_min",{min:Math.round(this._timeMilli/6e4)}):IM("live.time.end_remain_message.by_second",{second:Math.round(this._timeMilli/1e3)});var e=this._timeMilli/1e3;return e<60?s.formatTimeAmount(e,"H:M:S"):s.formatTimeAmount(e,"H:M")},_isShowingLiveTime:function(){return this._timeMilli>0}});return a.buildDLiveVideoTimeUIView=function(){return new a},a}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(4),i=n(2049);return t.Behavior.extend({options:{regionName:"",playController:""},initialize:function(){this._currentResolution="AUTO"},onRender:function(){this.view.model.isStreamerModeLiveContent()||(this.view.showChildView(this.options.regionName,i.buildDLiveSettingMenuView(this._currentResolution)),this.listenTo(this._getControlView(),"changeQuality",(function(e){this._getPlayController().changeQuality(e)})),this.listenTo(this._getControlView(),"loadQualityInfo",(function(){this._getControlView().setQualityInfo(this._getPlayController().getQualityInfo())})))},_getControlView:function(){return this.view.getChildView(this.options.regionName)},_getPlayController:function(){return this.view[this.options.playController]}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button type="button" class="viewingBtn _btnConfig"><%- currentResolution %></button>\n<% // 설정 버튼 클릭 시 -active 클래스 추가 %>\n<div class="settingList _menuResolution">\n    <em class="settingTitle"><%-IM("live.resolution_setting.title")%></em>\n    <% _.each(supportedQualities, function(supportedQuality) { %>\n    <button class="btnText _btnResolution <% if(currentResolution === supportedQuality) { %> -active<% } %>" value="<%- supportedQuality %>"><%- supportedQuality %></button>\n    <% }) %>\n</div>'},function(e,t,n){var i=n(4),o=n(2575),s=n(1096),a=n(1406),r=i.Behavior.extend({options:{regionName:"",playController:"",uiToggleEventName:""},onRender:function(){this.view.model.isStreamerModeLiveContent()||(this.view.showChildView(this.options.regionName,o.buildDLiveProtocolSelectionMenuView()),this.listenTo(this._getControlView(),o.EVENT.CHANGE_PROTOCOL,(function(e){this._getPlayController().isSupportProtocol(e)?this._getPlayController().changeProtocol(e):s.openDUnsupportedBrowserLayer(),this._getControlView().setCurrentProtocol(this._getPlayController().getCurrentProtocol())})),this.listenTo(this._getPlayController(),a.EVENT.READY_PLAYING,(function(){this._getControlView().setCurrentProtocol(this._getPlayController().getCurrentProtocol())})),this.listenToOnce(this._getPlayController(),a.EVENT.SLOW_NETWORK_DETECTED,(function(){this._getControlView().showTooltip(IM("live.stream_suggestion.tooltip")),this.view.trigger(this.options.uiToggleEventName,!0),this.listenToOnce(this.view,this.options.uiToggleEventName,(function(e){e||this._getControlView().hideToolTip()})),this.listenToOnce(this._getControlView(),o.EVENT.MENU_OPEN,(function(){this._getControlView().hideToolTip()}))})))},_getControlView:function(){return this.view.getChildView(this.options.regionName)},_getPlayController:function(){return this.view[this.options.playController]}});e.exports=r},function(e,t,n){var i=n(0),o=n(4),s=n(2576),a={MENU_OPEN:"menuOpen",MENU_HIDE:"menuHide",CHANGE_PROTOCOL:"changeProtocol"},r=o.View.extend({className:"viewingBox",attributes:{"data-viewname":"DLiveProtocolSelectionMenuView"},template:i.template(s),ui:{protocol:"._protocolItem",selectedProtocol:"._selectedProtocol",tooltipToast:"._tooltipToast"},events:{mouseover:function(){this.$el.addClass("-active"),this.trigger(a.MENU_OPEN)},mouseout:function(){this.$el.removeClass("-active"),this.trigger(a.MENU_HIDE)},"click @ui.protocol":function(e){return this.trigger(a.CHANGE_PROTOCOL,this.$(e.currentTarget).attr("data-value")),!1}},_renderSelection:function(){var e="dash"===this.getUI("protocol").filter(".-active").attr("data-value")?IM("live.stream_mode.realtime.title"):IM("live.stream_mode.standard.title");this.getUI("selectedProtocol").text(e)},onRender:function(){this._renderSelection(),this.hideToolTip()},setCurrentProtocol:function(e){this.getUI("protocol").removeClass("-active"),this.getUI("protocol").filter("[data-value="+e+"]").addClass("-active"),this._renderSelection()},showTooltip:function(e){this.getUI("tooltipToast").show(),this.getUI("tooltipToast").html(e)},hideToolTip:function(){this.getUI("tooltipToast").hide()}});r.EVENT=a,r.buildDLiveProtocolSelectionMenuView=function(){return new r},e.exports=r},function(e,t){e.exports='<button type="button" class="viewingBtn _selectedProtocol"></button>\n<div class="tooltipToast _tooltipToast"></div>\n<div class="viewingMode">\n    <div class="viewingModeDesc"><%-IM("live.stream_mode.title") %></div>\n    <a href="#" role="button" class="viewingModeItem _protocolItem -active" data-value="dash">\n        <em class="labelTitle"><%-IM("live.stream_mode.realtime.title") %></em>\n        <span class="labelDesc"><%-IM("live.stream_mode.realtime.description") %></span>\n    </a>\n    <a href="#" role="button" class="viewingModeItem _protocolItem" data-value="hls">\n        <em class="labelTitle"><%-IM("live.stream_mode.standard.title") %></em>\n        <span class="labelDesc"><%-IM("live.stream_mode.standard.description") %></span>\n    </a>\n</div>'},function(e,t,n){var i=n(0),o=n(4),s=n(59),a=n(1406),r=o.Behavior.extend({options:{playController:""},attributes:{"data-viewname":"DVideoLoggingBehavior"},initialize:function(){var e=Date.now();this._playData={lastLoadingStart:void 0,loadingTime:0,loadingTimePerMin:0,firstLoading:!0,start:e,loadingLog:[],changeProtocolLog:[],protocolChanged:!1,detailLog:[]},this._loadingLogSplitUnit=6e4,this._detailSentUnit=3e5,this._logSent=!1,this._boundSendLog=i.bind(this._sendLog,this)},_getPlayController:function(){return this.view[this.options.playController]},_sendDetailLog:function(){var e=Date.now()-this._playData.start,t={body:"liveLoading liveLoadingQualityDetail_v4",LILiveId:this.view.model.getLiveContentLiveId(),curTime:e,loadingLog:this._playData.loadingLog};this._playData.loadingLog=[],s.sendInfo(t)},_loadingStarted:function(){this._playData.lastLoadingStart||(this._playData.lastLoadingStart=Date.now())},_loadingEnded:function(){if(this._playData.firstLoading)this._playData.firstLoading=!1;else if(this._playData.lastLoadingStart){var e=Date.now()-this._playData.lastLoadingStart;this._playData.loadingTime+=e,this._playData.loadingTimePerMin+=e}this._playData.lastLoadingStart=void 0},onAttach:function(){this._playData.changeProtocolLog.push([this._getPlayController().getCurrentProtocol(),Date.now()]),this.getUI("video").on("seeking waiting loadeddata",i.bind(this._loadingStarted,this)),this.getUI("video").on("play playing seeked pause canplay error",i.bind(this._loadingEnded,this)),this.listenTo(this._getPlayController(),a.EVENT.PROTOCOL_CHANGED,(function(e){this._playData.protocolChanged=!0,this._playData.changeProtocolLog.push([e,Date.now()])})),$(window).on("beforeunload",this._boundSendLog),this._sendDetailIndex=setInterval(i.bind(this._sendDetailLog,this),this._detailSentUnit),this._loadingLogSplitIndex=setInterval(i.bind((function(){this._playData.loadingLog.push(this._playData.loadingTimePerMin),this._playData.loadingTimePerMin=0}),this),this._loadingLogSplitUnit)},_sendLog:function(){if(!this._logSent){this._logSent=!0,$(window).off("beforeunload",this._boundSendLog);var e=Date.now()-this._playData.start;if(!(e<5e3)){this._loadingEnded(),this._sendDetailLog();var t=i.map(this._playData.changeProtocolLog,(function(e){return[e[0],e[1]-this._playData.start]}),this),n={body:"liveLoading liveLoading_v4",LILiveId:this.view.model.getLiveContentLiveId(),LIProtocolChanged:this._playData.protocolChanged,LIplayTime:e,LIloadingTime:this._playData.loadingTime,LIlpp:Math.round(100*this._playData.loadingTime/e),LIcpLogs:t};s.sendInfo(n)}}},onBeforeDetach:function(){clearInterval(this._loadingLogSplitIndex),clearInterval(this._sendDetailIndex),this._sendDetailIndex=void 0,this._loadingLogSplitIndex=void 0,this._sendLog()}});e.exports=r},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4).View.extend({tagName:"BUTTON",attributes:{"data-viewname":"DVideoPlaybackButton"},className:function(){return this._isPlaying?"liveBtn -pause":"liveBtn -play"},initialize:function(){this._isPlaying=!1},template:t.template('<span class="gSrOnly"><%=buttonMessage%></span>'),templateContext:function(){return{buttonMessage:this._isPlaying?"PAUSE":"PLAY"}},onRender:function(){this.$el.attr("class",this.className())},setPlaying:function(e){this._isPlaying=e,this.render()},triggers:{click:"clickPlayback"}});return i.buildDVideoPlaybackButton=function(){return new i},i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2580),a=n(2581),r=n(2584),l=n(1650),c=n(2047),d=n(2048),u=n(1180),h=n(2050),p=n(2051),m=n(2053),_=n(516),g=n(1571),f=n(82),b=n(2052),v=n(669),A=n(2049),E=n(154),T="720p",C="480p",y=o.View.extend({behaviors:function(){if(!this._isExpiredVideo()){var e=[{behaviorClass:a,regionName:"timeUI"},{behaviorClass:r,regionName:"progressbarUI"},{behaviorClass:l,regionName:"fullScreenButton"},{behaviorClass:c,regionName:"volumeUI"},{behaviorClass:d,regionName:"chatButton"},{behaviorClass:u,uiToggleEventName:"toggleControlUI"},{behaviorClass:h,regionName:"loading"},{behaviorClass:p,bigPlayRegion:"bigPlay",playbackRegion:"btnPlayback",playController:"playController"},{behaviorClass:b,playController:"playController",playerUIContainer:"playerUIContainer"}],t=this.options.model.getLiveContentVodModel();return e.push({behaviorClass:v,videoSelector:"video",bandNo:t.getLiveVodBandNo(),videoId:t.getLiveVodVideoId(),postNo:t.getLiveVodPostNo()}),e}},className:"videoArea",initialize:function(e){this._liveVodModel=this.model.getLiveContentVodModel(),this._quality=T,this.listenTo(this,"toggleControlUI",this._toggleControls)},template:t.template(s),templateContext:function(){return{poster:f.make(this._liveVodModel.getLiveVodLogoImage(),f.TYPE.e1280_std),isExpiredVideo:this._isExpiredVideo()}},ui:{video:"video",playerUIContainer:"._playerUIContainer",btnPlayback:"._btnPlayback",bigPlay:"._bigPlay",timeUI:"._timeUI",chatButton:"._chatButton",volumeUI:"._volumeUI",progressbarUI:"._progressbarUI",fullScreenButton:"._fullScreenButton",playerControls:"._playerControls",loading:"._loading",qualityMenu:"._qualityMenu"},regions:{btnPlayback:{el:"@ui.btnPlayback",replaceElement:!0},bigPlay:{el:"@ui.bigPlay",replaceElement:!0},timeUI:{el:"@ui.timeUI",replaceElement:!0},progressbarUI:{el:"@ui.progressbarUI",replaceElement:!0},fullScreenButton:{el:"@ui.fullScreenButton",replaceElement:!0},volumeUI:{el:"@ui.volumeUI",replaceElement:!0},chatButton:{el:"@ui.chatButton",replaceElement:!0},loading:{el:"@ui.loading",replaceElement:!0},qualityMenu:{el:"@ui.qualityMenu",replaceElement:!0}},onRender:function(){this._isExpiredVideo()||(this.playController=new m({video:this.getUI("video")[0],source:t.bind(this._fetchVideoUrl,this)}),this.listenTo(this.playController,m.EVENT.READY_PLAYING,(function(){this.trigger(g.PLAY_READY)})),this._toggleControls(!1),this.getUI("video").on("timeupdate",t.bind((function(){this.getUI("video").length<=0||this.trigger(g.PLAY_TIME_UPDATE,Math.round(1e3*this.getUI("video")[0].currentTime))}),this)))},onAttach:function(){this._isExpiredVideo()||this.playController.play()},_toggleControls:function(e){this.getUI("playerControls").toggle(e),this.trigger("showPlayerControls",e)},_isExpiredVideo:function(){return this.options.model.getLiveContentVodModel().isExpiredLiveVod()},_fetchVideoUrl:function(){if(this._isExpiredVideo()||this._liveVodModel.isRestrictedLiveVod())return i.Deferred().reject().promise();var e=this._liveVodModel.getLiveVodBandNo(),n=this._liveVodModel.getLiveVodPostNo(),o=this._liveVodModel.getLiveVodVideoId(),s=_.getVideoUrlByPost(e,n,o);return E.wrapActivePromise(s,this).then(t.bind((function(e){var t=e.download||{},n=t[this._quality];return n||(this._quality=C,n=t[C]),this._hasHighQuality=!!t[T],this._renderQualityMenu(),n||i.Deferred().reject().promise()}),this))},_renderQualityMenu:function(){var e=this.getRegion("qualityMenu");if(this._hasHighQuality){var n=A.buildDLiveSettingMenuView(this._quality);e.show(n),this.listenTo(n,"loadQualityInfo",(function(){n.setQualityInfo({current:this._quality,supports:[T,C]})})),this.listenTo(n,"changeQuality",(function(e){var n=this.ui.video.get(0)||{},i=n.currentTime||0;this._quality=e,this.playController.changeSource(t.bind(this._fetchVideoUrl,this)),i>0&&this.ui.video.one("canplay",(function(){n.currentTime=i}))}))}else e.empty()}});return y.buildDVodVideoPlayerView=function(e){return new y({model:e})},y}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="videoBox _playerUIContainer <%- (isExpiredVideo) ? \'-expiredVideo\': \'\' %>">\n    <% if(isExpiredVideo) { %>\n    <div class="uVideoExpired -size60"><span class="cont"><i></i><span><%= IM(\'storage_period.video.expired.msg\') %></span></span></div>\n    <% } %>\n\n    <% if(!isExpiredVideo) { %>\n    <div class="_bigPlay"></div>\n    <% } %>\n    <div class="liveState -finished">\n        <span class="liveStateText"><%= IM(\'ui.label.live_end\') %></span>\n    </div>\n\n    <% if(!isExpiredVideo) { %>\n    \x3c!-- 종료시 -finished 클래스를 넣어주시면 컨트롤러 재정렬됩니다. --\x3e\n    <div class="liveControlBox -finished _playerControls">\n        <div class="liveProgressBar _progressbarUI"></div>\n        <div class="controlBoxL">\n            <button class="_btnPlayback"></button>\n            <div class="_volumeUI"></div>\n            \x3c!--라이브 종료후 활성화--\x3e\n            <span class="_timeUI"></span>\n        </div>\n\n        <div class="controlBoxR">\n            <div class="_qualityMenu" style="display:none"></div>\n            <div class="_chatButton"></div>\n            <button class="_fullScreenButton"></button>\n        </div>\n    </div>\n    <span class="_loading"></span>\n    <video poster="<%-poster %>"></video>\n    <% } %>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2582);return i.Behavior.extend({options:{regionName:""},onRender:function(){this.view.showChildView(this.options.regionName,new o);var e=this.getUI("video");e.on("timeupdate",t.bind((function(){this.view.getChildView(this.options.regionName).setTime(e[0].currentTime,e[0].duration)}),this))}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2583),s=n(158),a=i.View.extend({attributes:{"data-viewname":"DVideoTimeUIView"},className:"timeView",initialize:function(){this._duration=0,this._currentTime=0},template:t.template(o),templateContext:function(){var e="m:s";return this._duration>=3600&&(e="h:m:s"),{currentTime:s.formatTimeAmount(this._currentTime,e),duration:s.formatTimeAmount(this._duration,e)}},setTime:function(e,t){this._currentTime=e,this._duration=t,this.render()}});return a.buildDVideoTimeUIView=function(){return new a},a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<time class="playTime"><%-currentTime%></time>\n<time class="setTime"><%-duration%></time>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2585);return i.Behavior.extend({options:{regionName:""},onRender:function(){this.view.showChildView(this.options.regionName,new o);var e=this.getUI("video");this.listenTo(this._getControlView(),"moveCurrentTime",(function(t){e[0].currentTime=t}));var n=t.bind((function(){var t=e[0].buffered,n=e[0].duration,i=0;t&&t.length>0&&t.end&&n&&(i=t.end(t.length-1),i=Math.min(n,Math.max(0,i))),this._getControlView().updateProgress(e[0].currentTime,n,i)}),this);e.on("progress",n),e.on("timeupdate",n)},_getControlView:function(){return this.view.getChildView(this.options.regionName)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(2),o=n(4),s=n(2586);return o.View.extend({attributes:{"data-viewname":"DVideoProgressbarUIView"},className:"liveProgressBar",template:t.template(s),templateContext:function(){return{current:Math.round(this._currentTime/this._duration*100),loaded:Math.round(this._loaded/this._duration*100)}},events:{mousedown:function(e){this._mouseDown=!0;var n=t.bind(this._handleProgressbarMove,this);n(e);var o=i(document);return o.on("mousemove",n),o.one("mouseup",(function(){o.off("mousemove",n)})),!1}},initialize:function(){this._duration=0,this._currentTime=0,this._mouseDown=!1},updateProgress:function(e,t,n){this._duration=t,this._currentTime=e,this._loaded=n,this.render()},_handleProgressbarMove:function(e){var t=this.$el.offset().left,n=this.$el.width(),i=e.pageX;i<t?i=t:i>n+t&&(i=n+t);var o=(i-t)/n*this._duration;return this.trigger("moveCurrentTime",o),!1}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="currentBar" style="width: <%-current%>%;"></div>\n<div class="loadedBar" style="width: <%-loaded%>%;"></div>\n'},function(e,t){e.exports='<div class="videoArea _videoArea">\n\t<div class="videoBox">\n\t\t<% if(isExpiredVideo) { %>\n\t\t<div class="uVideoExpired -size60"><span class="cont"><i></i><span><%= IM(\'storage_period.video.expired.msg\') %></span></span></div>\n\t\t<% } %>\n\t\t<div class="gaussianblur" style="background-image:url(<%- thumbnail %>);"></div>\n\t\t<div class="liveState -finished">\n\t\t\t<span class="liveStateText"><%= IM(\'ui.label.live_end\') %></span>\n\t\t</div>\n\n\t\t<div class="_bigPlay"></div>\n\t\t<div class="liveVideo">\n\t\t\t<video muted poster="<%- thumbnail %>"></video>\n\t\t</div>\n\t\t\x3c!-- [D] 종료된 라이브 방송 화면에 안내문구 노출 --\x3e\n\t\t<div class="liveMessageBox _liveMessage" style="display: none;">\n\t\t\t<div class="liveMessageText"><%-IM("live.status_ended")%></div>\n\t\t</div>\n\t</div>\n\t<div class="_mutedUI"></div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0);return n(4).View.extend({options:{muted:!0},tagName:"button",className:"iconMute",initialize:function(e){this._muted=e.muted},attributes:{"data-viewname":"DVideoPlayerVolumeMuteUIView",type:"button"},template:t.template('<%-IM("unmute")%>'),events:{click:function(e){e.stopPropagation(),this.trigger("changeMutedUI",!this._muted)}},onAttach:function(){this.updateUI()},updateUI:function(){var e=this.$el;e.removeClass("-active"),!0===this._muted?e.html(t.template('<%-IM("unmute")%>')):(e.addClass("-active"),e.html(t.template('<%-IM("mute")%>')))},setMuted:function(e){this._muted=e,this.updateUI()}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(156),s=n(82),a=n(1649),r=n(2590),l=n(9),c="photo",d="promotionPhoto";return i.View.extend({options:{bandData:null},attributes:{"data-viewname":"DPostPhotoView","data-widget":"expanded"},className:function(){return"uWidget expanded"},template:t.template(r),ui:{postMediaItem:"._postMediaItem"},events:{"click @ui.postMediaItem":"_showPhotoViewer"},initialize:function(e){this.photoModel=e.model,this.postModel=e.postModel,this.photoType=e.model.attachmentType,this._bandData=e.bandData},serializeData:function(){var e=this._getPhotoUrl(),t=o.isGif(this._getPhotoUrl()),n=this._getPhotoThumbnailType(t),i=void 0;return this.postModel.isMissionCertifiedPost()&&this.model.get("photographedAt")&&(i=l.format.date(this.model.get("photographedAt"),"short_date_time")),{isGif:t,displayPhotoUrl:s.make(e,n),emotionCount:this.model.get("emotionCount"),commentCount:this.model.get("commentCount"),photographedAtText:i}},_getPhotoThumbnailType:function(e){return e?s.TYPE.original:this._bandData.canUseOfficeBandThumbnailType()?s.TYPE.e1920_office:s.TYPE.e1920_std},_getPhotoUrl:function(){switch(this.photoType){case c:return this.photoModel.get("photoUrl");case d:return this.photoModel.get("url");default:return""}},_showPhotoViewer:function(){this.options.clickDisabledPostTypeOnDetail||(this.photoType===c?this._openPhotoViewer():this.photoType===d&&this._openPromotionPhotoViewer())},_openPhotoViewer:function(){return a.openDPostMediaViewer(this.postModel,this.photoModel.get("photoNo")),!1},_openPromotionPhotoViewer:function(){return a.openDPostPromotionPhotoViewer(this.postModel,this.photoModel),!1}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<ul class="uCollage" data-collage="1">\n    <li class="collageItem <%= (isGif ? \' gif\' : \'\') %>" tabindex="-1">\n        <a href="#" class="collageImage _postMediaItem">\n            <img src="<%- displayPhotoUrl %>" alt="">\n            <% if ( emotionCount > 0 || commentCount > 0 ) { %>\n            <div class="count">\n                <% if ( emotionCount > 0 ) { %><span class="emotion"><%= emotionCount %></span><% } %>\n                <% if ( commentCount > 0 ) { %><span class="comment"><%= commentCount %></span><% } %>\n            </div>\n            <% } %>\n        </a>\n    </li>\n</ul>\n<% if (photographedAtText) { %>\n\x3c!-- 미션 인증 사진 촬영일자 --\x3e\n<div class="creationDate gMat10 gMab12"><%-photographedAtText%></div>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(153),s=n(1651),a=n(1263),r=n(1264),l=n(2662),c=n(84),d=n(491),u=n(26),h=n(1048),p=n(152),m=n(487),_=n(17),g=n(1041),f=n(488);return i.View.extend({attributes:function(){var e={"data-viewname":"DPostSharedPostView"};return this.model.isSourcePostUnavailable()&&(e["data-widget"]="expanded"),e},className:function(){return this.model.isSourcePostUnavailable()?"uWidget":"sharePost"},template:t.template(l),templateContext:function(){return{overDimClass:f.ELEMENT.OVER_DIM}},ui:{dimArea:"._dimArea",attachSharedPost:"._attachSharedPost",sharedPostRegion:"._sharedPostRegion",btnShareOriginPost:"._btnShareOriginPost",postShareOptionListViewRegion:"._postShareOptionListViewRegion"},regions:{sharedPostRegion:"@ui.sharedPostRegion",postShareOptionListViewRegion:{el:"@ui.postShareOptionListViewRegion",replaceElement:!0}},events:function(){return this.options.clickDisabledPostTypeOnDetail?{}:{"click @ui.attachSharedPost":"_onClickSharedPost","click @ui.btnShareOriginPost":"_togglePostShareOptionListView"}},behaviors:[m,g.withUI("dimArea","clickDim",{modelFunction:function(){return this.model.getSourcePost()}})],initialize:function(e){this._richPostModel=e.postModel,this.sharedPostModel=this._richPostModel.getAttachment(p.POST_ATTACHMENT_TYPE.SHARED_POST_SNIPPET).getSourcePost(),this.listenTo(u.getDGlobalChannel(),u.EVENT.HTML_CLICK,this._closeLayers),this.listenTo(this,"clickDim",this._onClickSharedPost)},serializeData:function(){var e={isSourcePostUnavailable:this.model.isSourcePostUnavailable()};return e.isSourcePostUnavailable||t.extend(e,{bandName:this.sharedPostModel.get("band").name,bandCertified:this.sharedPostModel.get("band").certified,sharedCount:this.sharedPostModel.get("sharedCount")||"0",isShareable:this.sharedPostModel.get("isShareable")}),e},onAttach:function(){if(!this.model.isSourcePostUnavailable()){g.renderDimOfView(this);var e=s.buildRenderSharedPostMode(this.sharedPostModel);this.showChildView("sharedPostRegion",e),this.listenTo(e,"postItem:clickAttachment:showPostDetailLayer",this._gotoSharedPost),t.each(e.getRegions(),(function(e){e.currentView instanceof a||e.currentView instanceof r||!e.currentView||e.currentView.$el.find("[data-viewname]").off()}))}},_onClickSharedPost:function(){this._gotoSharedPost();var e=this.sharedPostModel.get("band").bandNo;this.jplClick(m.CLASSIFIER.SHARED_POST_AREA,{band_no:e,post_no:this.sharedPostModel.get("postNo"),container_band_no:this._richPostModel.getBandCore().bandNo,container_post_no:this._richPostModel.getPostNo()},e)},_gotoSharedPost:function(){if(this.options.clickDisabledPostTypeOnDetail)return!1;var e=this.sharedPostModel.get("band").bandNo,n=this.sharedPostModel.get("postNo");return d.getCachedBandData(this.options.postModel.getBandNo()).then(t.bind((function(t){t.isPreview()?window.open(this._makeLandingUrl(e,n),"_blank"):c.go(this._makeLandingUrl(e,n))}),this)),!1},_makeLandingUrl:function(e,t){return o.GROUP_BAND_POST_DETAIL.makeUrl({band_no:e,post_no:t})},_togglePostShareOptionListView:function(){var e=this.getRegion("postShareOptionListViewRegion"),n=e.hasView();return u.getDGlobalChannel().trigger(u.EVENT.HTML_CLICK),n||t.defer(t.bind((function(){var t=this.sharedPostModel.getBandCore().bandNo,n=this.sharedPostModel.get("postNo"),i=o.GROUP_BAND_POST_DETAIL.makeUrl({band_no:t,post_no:n});e.show(h.buildUrlShareView({shareUrl:_.appendCurrentDomainOnPathUrl(i),message:"",excludedBandNos:[t,this._richPostModel.getBandNo()],isSingleSelectionOnMoreBandSelection:!1}))}),this)),!1},_closeLayers:function(){t.each(["postShareOptionListViewRegion"],(function(e){var t=this.getRegion(e);null!=t&&t.hasView()&&t.empty()}),this)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="item -vote" tabindex="-1">\n<% // 투표 Title 정보 (글 목록과 글 상세에서 모두 노출) %>\n<div class="addHead">\n    <p class="addStatus">\n        <svg class="svgIcon ico-vote sf_color" aria-hidden="true">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-vote-22"></use>\n        </svg>\n        <span class="status sf_color">\n            <%= msg_pollProgressStatus %>\n        </span>\n\n        <%= IM("web.postlist.poll.txt.poll_count", {pollCount: count || \'0\' }) %>\n    </p>\n    <p class="addTitle"><%- title %></p>\n    <% if (msg_remainingTime) { %>\n    <time class="timeSUp sf_color"><%= msg_remainingTime %></time>\n    <% } %>\n\n    <% if (postPollAllCount > 1) { %>\n    <p class="guideText"><%- IM("web.postlist.poll.txt.more_poll_exist", {count: postPollAllCount - 1}) %></p>\n    <% } %>\n\n</div>\n\n<% if (bListPreview) { // 글 목록 preview %>\n<div class="addDetail">\n    <ul class="pollQuestionList<%= (isSubjectCountless || _.size(subjects) > 3 ? \' -more\' : \'\') %><%= (!isOpen ? \' -finish\' : \'\') %>">\n        <% _.each(_.first(subjects, 3), function(subject) { %>\n        <li><%- subject.title %></li>\n        <% }); %>\n    </ul>\n</div>\n<% } %>\n</div>\n'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(10),o=n(16),s=n(4),a=n(2594),r=n(1566),l=n(523),c=n(9),d=n(653),u=s.View.extend({tagName:"div",className:"uWidget",attributes:{"data-viewname":"DPostScheduleSimpleView"},getTemplate:function(){return this.model.isDeletedSchedule()?t.template(r):t.template(a)},templateContext:function(){var e=this.model.getStartAt(),t="";return this.model.isDeletedSchedule()||(t=d.multilineMessageForString(this.model.toJSON())),{day:i.lpad(o(e).format("D"),2,"0"),dayName:e?o(e).format(c.isKoreanLanguage()?"dddd":"ddd"):"",scheduleDateTime:t,remainingTimeMsg:this._getRemainingTimeMsg(),attendeeLimitMsg:this._getAttendeeLimitMsg(),getLPaddedString:function(e,t){return i.lpad(e,t,"0")}}},ui:{attachmentSchedule:"._attachmentSchedule"},events:{click:function(e){return this.trigger("attachment:showPostDetailLayer"),!1}},initialize:function(){},_getRemainingTimeMsg:function(){var e=this.model.get("rsvp");if(e&&!e.isEmpty()){var t=e.getEndedAt();if(null==t)return null;var n=l.getRemainingTime(t);return n.close?IM("schedule.rsvp.close_attendance_due_date"):IM("rsvp.label.remaining_time_format_"+n.format,{value:n.value})}return null},_getAttendeeLimitMsg:function(){var e=this.model.get("rsvp");return e&&e.get("attendeeLimit")?IM("schedule.rsvp.attendee_limit",{attendeeLimitCount:e.get("attendeeLimit")}):null}});return u.buildForPostListItem=function(e){return new u({model:e})},u}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="item -calendar" tabindex="-1">\n    <div class="addHead scheduleHead">\n        <span class="day">\n            <strong class="date"><%- day %></strong>\n            <span class="week sf_color"><%- dayName %></span>\n        </span>\n\n        <div class="contWrap">\n            <div class="scheduleContWrap">\n                <span class="addTitle"><%- name %></span>\n                <time class="date"><%= scheduleDateTime %></time>\n            </div>\n\n            <% if (remainingTimeMsg || attendeeLimitMsg) { %>\n            <div class="scheduleContWrap data">\n                <% if (remainingTimeMsg) { %>\n                <span class="dataPeriod sf_color"><%= remainingTimeMsg %></span>\n                <% } %>\n                <% if (attendeeLimitMsg) { %>\n                <span class="dataMember sf_color"><%= attendeeLimitMsg %></span>\n                <% } %>\n            </div>\n            <% } %>\n        </div>\n    </div>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(1566),s=n(2596),a=i.View.extend({tagName:"div",className:"uWidget",attributes:{"data-viewname":"DPostScheduleGroupSimpleView"},getTemplate:function(){return this.model.isAllScheduleDeleted()?t.template(o):t.template(s)},templateContext:function(){return{scheduleCount:this.model.getScheduleCount()}},events:{click:function(e){return this.trigger("attachment:showPostDetailLayer"),!1}},initialize:function(){}});return a.buildForPostListItem=function(e){return new a({model:e})},a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="item -multiSchedule">\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-mutiSchedule sf_color" aria-hidden="true">\n                <use xlink:href="#ico-attach-mutiSchedule-22"></use>\n                <use xlink:href="#ico-attach-mutiSchedule"></use>\n            </svg>\n            <span class="status sf_color"><%= IM(\'post.schedule_group.schedule_count\', {scheduleCount: scheduleCount}) %></span>\n        </p>\n        <p class="addTitle"><%- title %></p>\n    </div>\n</div>'},function(e,t){e.exports='<div class="item -album" <% if (!bPostDetail) { %>tabindex=-1<% } %>>\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-album sf_color" aria-hidden="true">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-photo<% if (!bPostDetail) { %>-22<% } %>"></use>\n            </svg>\n            <span class="status sf_color"><%= IM("web.postlist.attachphotoalbum.label") %></span><% if (!isDeleted) { %> <%= IM(\'web.postlist.attachphotoalbum.title\', {count: photoCount || "0"}) %><% } %>\n        </p>\n        <p class="addTitle"><%- isDeleted ? IM(\'web.postlist.attachphotoalbum.title.deleted_album\') : name %></p>\n    </div>\n</div>'},function(e,t){e.exports='<span class="_collage"></span>'},function(e,t){e.exports='<% if (isExpiredVideo) { %>\n<div class="uVideoExpired -size60"><span class="cont"><i></i><span><%= IM(\'storage_period.video.expired.msg\') %></span></span></div>\n<% } %>\n<button type="button" class="collageImage _imageButton">\n    <img src="<%- imageUrl %>" alt="" class="_image">\n    <% if (isLiveVideo) { %>\n    <div class="liveState -finished">\n        <span class="liveStateText"><%= IM(\'ui.label.live_end\') %></span>\n    </div>\n    <% } %>\n</button>\n<% if (showMore) { %>\n<button type="button" class="moreMedia _moreMedia"><span class="moreText"><%= IM("web.postlist.media.label.more_media") %></span></button>\n<% } %>\n'},function(e,t){e.exports='<% if (isSourcePostUnavailable) { // 공유 가능하지 않은 게시글인 경우 %>\n<div class="snippet" data-thumbnail="type0">\n    <span class="snippetInfo">\n        <span class="snippetTxt"><%= IM(\'web.postdetail.shared.not_exist_post\') %></span>\n    </span>\n</div>\n<% } else { %>\n<a href="<%- url %>" class="snippet _sharedPostSnippet" data-thumbnail="<%- thumbnailType %>">\n    <div class="_dimArea"></div>\n    <% if (thumbnailUrl) { %>\n    <span class="snippetThumb<%- isPlayButtonVisible ? \' player\' : \'\' %>">\n        <img src="<%- thumbnailUrl %>" alt="<%- bandName %>" class="thumb">\n    </span>\n    <% } %>\n    <span class="snippetInfo">\n        <span class="snippetTit <%= titleLineClass %>"><%- snippetContents %></span>\n        <span class="snippetLink">[BAND] <%- bandName %></span>\n    </span>\n</a>\n<% } %>'},function(e,t){e.exports='<% if (isSourcePostUnavailable) { // 공유 가능하지 않은 게시글인 경우 %>\n<div class="snippet" data-thumbnail="type0">\n    <span class="snippetInfo">\n        <span class="snippetTxt"><%= IM(\'web.postdetail.shared.not_exist_post\') %></span>\n    </span>\n</div>\n<% } else { %>\n<a href="<%- url %>" class="snippet _sharedPagePostSnippet" data-thumbnail="<%- thumbnailType %>">\n    <% if (thumbnailUrl) { %>\n    <span class="snippetThumb<%- isPlayButtonVisible ? \' player\' : \'\' %>">\n        <img src="<%- thumbnailUrl %>" alt="<%- bandName %>" class="thumb">\n    </span>\n    <% } %>\n    <span class="snippetInfo">\n        <span class="snippetTit <%= titleLineClass %>"><%- snippetContents %></span>\n        <span class="snippetLink"><%- bandName %> : BAND Page</span>\n    </span>\n</a>\n<% } %>'},function(e,t){e.exports='<% if (isOembedStyle) { %>\n<div class="snippet oembedSnippet">\n    <%= oembedHtml /* html */ %>\n</div>\n<% } else { %>\n<a <% if (linkUrl) { %>href="<%- linkUrl %>"<% } %> class="snippet _snippetLink" data-thumbnail="<%- imageType %>">\n    <% if (imageUrl) { %>\n    <span class="snippetThumb <%- isVideo ? \'player\' : \'\' %> _imageWrap">\n        <img src="<%- imageUrl %>" alt="" class="thumb">\n    </span>\n    <% if (isYoutubeStyle) { %>\n    <video class="_youtubeVideo" style="position:absolute;z-index:-1;top:0;" preload="auto">\n        <source src="<%- youtubeUrl %>" type="video/youtube" />\n    </video>\n    <% } %>\n    <% } %>\n    <span class="snippetInfo">\n        <span class="snippetTit <%- titleClass %>"><%- title %></span>\n        <% if (description) { %>\n        <span class="snippetTxt <%- descriptionClass %>"><%- description %></span>\n        <% } %>\n        <% if (footerText) { %>\n        <span class="snippetLink"><%- footerText %></span>\n        <% } %>\n    </span>\n</a>\n<% } %>'},function(e,t){e.exports='<a href="#" class="item -file <%- isExpiredFile ? \'-disabled\' : \'_attachmentFile\' %>">\n    <div class="addHead<%= (bPostDetail ? \' -downloadL\' : \'\') %>">\n        <p class="addStatus">\n            <svg class="svgIcon ico-file sf_color" aria-hidden="true">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-file<% if (!bPostDetail) { %>-22<% } %>"></use>\n            </svg>\n            <span class="status sf_color"><%= IM(\'file\') %></span>\n            <%= fileCountText %>\n        </p>\n        <p class="addTitle"><%- title %></p>\n        <% if (bPostDetail) { %>\n        <p class="addStatus"><span><%= fileSizeText %></span> <span><%= fileInfoText %></span><% if (isQuotaStatus) { %><span><button type="button" class="buttonSetting _settingSave"><%= IM(\'web.postdetail.attachfile.settingSave\') %></button></span><% } %></p>\n        <% } %>\n    </div>\n</a>\n'},function(e,t){e.exports='<a href="#" class="item -map _link">\n    <% if (isShowMapImage) { %>\n    <img src="<%- staticMapUrl %>" alt="<%- address %>">\n    <% }else { %>\n    <img src="/dres/images/e_images/ico-post-attach-location.png" srcset="/dres/images/e_images/2x/ico-post-attach-location.png 2x" alt="" class="imgMap">\n    <% } %>\n    <% if (placeName) { %>\n    <p class="addTitle"><%- placeName %></p>\n    <% } %>\n    <p class="subTxt"><%- address %></p>\n</a>'},function(e,t){e.exports='<a href="#" class="snippet _attachmentSubpost <% if(!subtitle){ %>-noLink<% } %>" data-thumbnail="<%- thumbnailType %>">\n<% if (snippetImage) { %>\n    <span class="snippetThumb">\n    <img src="<%- thumbnailUrl %>" alt="<%- title %>" class="thumb">\n    </span>\n<% } %>\n    <span class="snippetInfo">\n        <span class="snippetTit <%= titleLineClass %>"><%- title %></span>\n        <% if (description) { %>\n        <span class="snippetTxt <%= descriptionLineClass %>"><%- description %></span>\n        <% } %>\n        <span class="snippetLink"><%- subtitle %></span>\n    </span>\n</a>'},function(e,t){e.exports='<% // 작성자와 글 정보 영역 %>\n<div class="_postAuthorRegion"></div>\n\n<div class="postMain">\n    \x3c!-- 미션 인증 게시글--\x3e\n    <% if(missionTitle) {%>\n    <div class="missionCertification _missionInfo">\n        <span class="missonName -pointColor"><span class="iconMisson"></span><%- missionTitle %></span>\n    </div>\n    <% } %>\n\n    <% // 글 본문 영역 %>\n    <div class="_content"></div>\n</div>'},function(e,t){e.exports='<div class="item -attendance">\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-attendance sf_color" aria-hidden="true">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-attendance<% if (!bPostDetail) { %>-26<% } %>"></use>\n            </svg>\n            <span class="status sf_color"><%- IM(\'post.attendance_check.title\') %></span>\n            <em class="_doneCount"></em>\n        </p>\n        <p class="addTitle"><%- title %></p>\n        <% if (remainingTime || managerOnly) { %>\n        <p class="addStatus">\n            <% if (remainingTime) { %><span class="deadline sf_color"><%- remainingTime %></span><% } %>\n            <% if (managerOnly) { %><button type="button" class="btnDetailView _managersBtn"><%- IM(\'post.attendance_check.manager_only\') %></button><% } %>\n        </p>\n        <% } %>\n\n        <% if (showAttendanceStatusDesc) { %>\n        <p class="addStatus"><span class="statusDesc"><%- IM(\'post.attendance_check.result_view_permission.desc\') %></span></p>\n        <% } %>\n\n        <% if (moreCount) { %>\n        <p class="guideText"><%- IM(\'post.attendance_check.more\', {count: moreCount}) %></p>\n        <% } %>\n\n        <% if (menuAvailable) { %>\n        <div class="option">\n            <button type="button" class="menuSet _menuToggleBtn"><%- IM(\'web.uicomponent.topbar.button.menuopen\') %></button>\n            <div class="lyMenu _menuLayer" style="min-width:130px;display:none">\n                <ul>\n                    <li><a href="#" role="button" class="_excelLink"><%- IM(\'ui.label.excel_download\') %></a></li>\n                    <li><a href="#" role="button" class="_printLink"><%- IM(\'ui.label.print\') %></a></li>\n                </ul>\n            </div>\n        </div>\n        <% } %>\n    </div>\n    <% if (bPostDetail) { %>\n    <div class="addDetail">\n        <% if (isAttendanceVisibleToViewer && _.size(supportedStates) > 1) { %>\n        <div class="checkStatus">\n            <% _.each(supportedStates, function(state) { %>\n            <span class="statusType"><span class="statusText"><%= IM(\'attendance_check.state.\' + state) %></span><em class="statusNumber"><%= getAttendeeCount(state) %></em></span>\n            <% }); %>\n        </div>\n        <% } %>\n        <ul class="checkList _attendeesRegion"></ul>\n        <% if (canMoreMemberView) { %>\n        <div class="btnBox">\n            <button type="button" class="btnDetailView _allAttendeesBtn"><%- IM(\'post.attendance_check.all_attendees\') %></button>\n        </div>\n        <% } %>\n    </div>\n    <% } %>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(16),o=n(4),s=n(2609),a=n(714),r=n(82),l=n(9),c=n(13),d=n(159),u=n(589),h=n(2057),p=n(800),m=(n(802),n(532).ATTENDANCE_CHECK_STATE);return o.View.extend({tagName:"li",attributes:{"data-viewname":"DPostAttendanceCheckAttendeeView"},behaviors:[d],template:t.template(s),templateContext:function(){var e=this.model.get("attendee").get("profileImageUrl"),t=r.makeProfileThumbnailUrl(e);return{cid:this.cid,profile:e?t:null,profileInnerClass:r.makeProfileInnerClass(t),checkedTime:l.format.date(this.model.get("checkedAt"),"short_date_time"),checkbox:!this.options.clickDisabledPostTypeOnDetail&&(this._checkable||this.model.get("isChecked")),checkable:this._checkable,isAttendanceVisibleToViewer:this._isAttendanceVisibleToViewer||this.model.getAttendee().isMyself(),isChildMembership:this._isChildMembership(),isOnlyCheckedStateSupported:this._isOnlyCheckedStateSupported}},serializeData:function(){return this.model.toJSON()},ui:{checkbox:"._checkbox",btnProfile:"._btnProfile"},events:function(){return this.options.clickDisabledPostTypeOnDetail?{}:{"click @ui.btnProfile":"_showMemberProfile","click @ui.checkbox":function(){if(this._isBeforeCheckingAttendance()&&!this._isManager)return alert(IM("attendance_check.before_checking_attendance.click_msg")),!1;if(!this._checkable)return alert(IM("permission_deny")),!1;if(this._checkingInProgress)return!1;this._checkingInProgress=!0;var e=!this.model.isCheckStatus(),n=this._isChildMembership()||!this.model.getAttendee().isMyself();return this._isManager&&n&&!e&&!confirm(IM("ui.label.check_clear_confirm"))?(this._checkingInProgress=!1,!1):(this._handleAttendanceCheckState(e).done(t.bind(this._onStateChangeSucceeded,this)).always(t.bind((function(){this._checkingInProgress=!1}),this)),!1)}}},modelEvents:{change:"render"},initialize:function(e){this._checkingInProgress=!1,this._bandNo=e.bandNo,this._postNo=e.postNo,this._attendanceCheckId=e.attendanceCheckId,this._isManager=e.isManager,this._checkable=this._isManager||e.isCheckableByAttendee&&this.model.isUserNoSame(c.getUserData().getUserNo()),this._startAt=e.startAt,this._timeZoneId=e.timeZoneId,this._isAttendanceVisibleToViewer=e.isAttendanceVisibleToViewer,this._supportedStates=e.supportedStates,this._isOnlyCheckedStateSupported=e.isOnlyCheckedStateSupported},onRender:function(){this.ui.checkbox.prop("checked",this.model.get("isChecked"))},_showMemberProfile:function(){var e=this.model.getAttendee();this._isChildMembership()||u.openMemberProfileLayer(e.getMemberProfile(),e.getUserNo(),this._bandNo)},_isBeforeCheckingAttendance:function(){if(!this._startAt)return!1;var e=null,t=null;return this._timeZoneId?(e=i.tz(i(this._startAt),this._timeZoneId),t=i.tz(i(),this._timeZoneId)):(e=i(this._startAt),t=i()),t.isBefore(e)},_isChildMembership:function(){return!!this.model.getChildMembershipId()},_makeStateChangeBaseParams:function(){var e=this.model.get("attendee"),t=e.get("userNo"),n=e.get("childMembershipId"),i={band_no:this._bandNo,post_no:this._postNo,attendance_check_id:this._attendanceCheckId,target_user_no:t};return n&&(i.target_child_membership_id=n),i},_handleAttendanceCheckState:function(e){var t=this._makeStateChangeBaseParams(),n=$.Deferred();return e?this._handleCheck(t,n):this._handleUncheck(t,n),n.promise()},_handleCheck:function(e,t){if(this._isOnlyCheckedStateSupported)return e.state=m.CHECKED,void this._setAttendanceCheckState(e,t);this._selectCheckState(e,t)},_handleUncheck:function(e,n){if(this._isOnlyCheckedStateSupported)return e.state=m.UNCHECKED,void this._setAttendanceCheckState(e,n);p.openAsLayer({title:IM("attendance_check.change_check_state.title"),confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:[{label:IM("attendance_check.uncheck_option.cancel_selection"),value:"uncheck"},{label:IM("attendance_check.uncheck_option.change_selection"),value:"changeState"}],withoutHiding:!0}).once("modal:confirm",t.bind((function(t){"uncheck"===t?(e.state=m.UNCHECKED,this._setAttendanceCheckState(e,n)):this._selectCheckState(e,n)}),this)).once("modal:cancel",t.bind((function(){n.reject()}),this))},_selectCheckState:function(e,t){var n=this.model.isCheckStatus()?this.model.getState():null,i=h.openAsLayer(this._supportedStates,n,this.model.getStateDescription());this.listenToOnce(i,h.EVENT.CONFIRM,(function(n){e.state=n.selectedState,e.state_description=n.reason,this._setAttendanceCheckState(e,t)})),this.listenToOnce(i,h.EVENT.CANCEL,(function(){t.reject()}))},_setAttendanceCheckState:function(e,t){a.setAttendanceCheckState(e).done((function(){t.resolve(e)})).fail(t.reject)},_onStateChangeSucceeded:function(e){var n=e.state!=m.UNCHECKED,i=n?t.now():null;this.model.set({isChecked:n,checkedAt:i,state:e.state,stateDescription:e.state_description}),this.spawn(d.MSG.ATTENDANCE_CHECK_CLICK,{userNo:e.user_no,childMembershipId:e.target_child_membership_id,isChecked:n,checkedAt:i})}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="flexList">\n    <button type="button" class="thumb <%- (!isChildMembership) ? \'_btnProfile\' : \'\' %>" <%- (isChildMembership) ? \'disabled\': \'\' %>>\n        <span class="uProfile -size50">\n            <span class="profileInner <%- profileInnerClass %>">\n                <% if (profile) { %>\n                <img src="<%- profile %>" width="50" height="50" alt="<%- IM(\'photo\') %>">\n                <% } %>\n            </span>\n        </span>\n    </button>\n    <div class="text">\n        <strong class="labelTitle -ellipsis"><%- attendee.name %></strong>\n        <% if (attendee.desc) { %>\n        <span class="labelDesc -ellipsis gColorBk4"><%- attendee.desc %></span>\n        <% } %>\n\n        <% if (attendee.childMembershipId) { %>\n        <span class="labelDesc">\n            <span class="memberType"><%- IM(\'web.common.child_member\') %></span><span class="name"><%= IM(\'schedule.rsvp.state.change_actor\', {actorName: _.escape(attendeeOwner.name)}) %></span>\n        </span>\n        <% } %>\n\n        <% if (isAttendanceVisibleToViewer && isChecked && !isOnlyCheckedStateSupported) { %>\n        <span class="labelDesc">\n            <span class="statusType"><%= IM(\'attendance_check.state.\' + state) %></span>\n            <% if (!!stateDescription) { %>\n            <span class="reasonText"><%= IM(\'attendance_check.exist_check_state_reason\') %></span>\n            <% } %>\n        </span>\n        <% } %>\n\n        <% if (isAttendanceVisibleToViewer && checkedTime) { %>\n        <span class="labelDesc"><span class="date"><%- checkedTime %></span></span>\n        <% } %>\n    </div>\n\n    <% if (checkbox) { %>\n    <label for="attendee_<%- cid %>" class="etc">\n        <span class="uCheck -checkbox -noLabel">\n            <input type="checkbox" id="attendee_<%- cid %>" class="checkInput _checkbox" <%- (!checkable) ? \'disabled\': \'\' %>>\n            <span class="checkLabel">\n                <span class="shape sf_afterBg"></span>\n            </span>\n        </span>\n    </label>\n    <% } %>\n</div>'},function(e,t){e.exports='<div class="lyContent -w380">\n    <header class="modalHeader">\n        <h1 class="title"><%= IM(\'post.attendance_check.title\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <ul class="listLine gMal20 gMar20">\n                <% _.each(selectableStates, function(state) { %>\n                <li class="tLine">\n                    <label class="flexList -h50" for="state_<%= state %>">\n                        <span class="etc">\n                            <span class="uCheck -checkbox -noLabel">\n                                <input type="radio" id="state_<%= state %>" name="state" class="checkInput" value="<%= state %>" <%= selectedState === state ? \'checked="checked"\' : \'\' %>>\n                                <span class="checkLabel">\n                                    <span class="shape"></span>\n                                </span>\n                            </span>\n                        </span>\n                        <span class="text"><%= IM(\'attendance_check.state.\' + state) %></span>\n                    </label>\n                    <% if (state != ATTENDANCE_CHECK_STATE.CHECKED) { %>\n                    <div class="uTextareaBox gMat-6 _reasonWrap" style="<%= selectedState === state ? \'\' : \'display:none;\' %>">\n                        <div class="uTextarea" style="height:60px">\n                            <textarea class="_reason" maxlength="100" placeholder="<%= IM(\'attendance_check.state_reason.placeholder\') %>"><%- selectedState === state ? stateReason : \'\' %></textarea>\n                            <span class="border"></span>\n                        </div>\n                        <p class="noticeGuide gMat7 gMab10 gFs12 gColorGr1"><%= IM(\'attendance_check.state_reason.view_guide\') %></p>\n                    </div>\n                    <% } %>\n                </li>\n                <% }); %>\n            </ul>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="uButton -cancel _btnCancel"><%= IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _btnConfirm" disabled><%= IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2612),s=n(82),a=n(486),r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DAttendanceCheckManagersView"},template:t.template(o),ui:{closeBtn:"._closeBtn"},events:{"click @ui.closeBtn":function(){a.closeTop()},click:function(e){e.target==this.el&&a.closeTop()}},serializeData:function(){return{managers:this.model.get("managers").map((function(e){var t=e.get("profileImageUrl"),n=s.makeProfileThumbnailUrl(t);return{name:e.get("name"),desc:e.get("desc"),profile:t?n:null,profileInnerClass:s.makeProfileInnerClass(t)}}),this)}}});return r.openAsLayer=function(e){a.openWithoutHiding(new r(e))},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.add_managers.title\') %> <span><%- managers.length %></span></h1>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="memberListBox">\n                <ul class="listLine rScroll -lrSpace">\n                    <% _.each(managers, function(manager) { %>\n                    <li class="tLine flexList">\n                        <span class="thumb">\n                            <span class="uProfile -size40">\n                                <span class="profileInner <%- manager.profileInnerClass %>">\n                                    <% if (manager.profile) { %>\n                                    <img src="<%- manager.profile %>" width="40" height="40" alt="<%- IM(\'photo\') %>">\n                                    <% } %>\n                                </span>\n                            </span>\n                        </span>\n\n                        <span class="text">\n                            <span class="ellipsis"><%- manager.name %></span>\n                            <span class="sub2 -ellipsis"><%- manager.desc %></span>\n                        </span>\n                    </li>\n                    <% }); %>\n                </ul>\n            </div>\n        </div>\n    </div>\n\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="btnLyBack uButton -iconLyBack _closeBtn"><span class="gSrOnly"><%- IM(\'ui.label.close_layer\') %></span></button>\n        <button type="button" class="uButton -confirm _closeBtn"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(2),o=n(0),s=n(10),a=n(4),r=n(2614),l=n(2615),c=n(667),d=n(486),u=n(159),h=n(491),p=n(780),m=n(1004),_=n(720),g=n(532).ATTENDANCE_CHECK_STATE,f={STATE_CHANGE:"STATE_CHANGE"},b=a.CollectionView.extend({tagName:"ul",className:"listLine rScroll -lrSpace",childView:l,childViewOptions:function(){return this.options},emptyView:a.View.extend({tagName:"p",className:"uEmpty",attributes:{style:"height:100%"},template:o.template('<span class="gPar7 gPal7"><%= IM("ui.message.empty_conents") %></span>')}),initialize:function(e){this._state=e.state,this._filterWithReason=e.filterWithReason,this._query=e.query},filter:function(e,t,n){return(!this._state||this._state==e.getState())&&(!(this._filterWithReason&&!e.getStateDescription())&&(!this._query||s.include(e.getAttendee().get("name"),this._query)))},search:function(e,t,n){this._state=e,this._filterWithReason=t,this._query=n,this.render()}}),v=a.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DAttendanceCheckAttendeesView"},template:o.template(r),ui:{btnStateTab:"._btnStateTab",searchedAttendeeCount:"._searchedAttendeeCount",chatButtonWrap:"._chatButtonWrap",btnChatWithAttendee:"._btnChatWithAttendee",searchForm:"._searchForm",searchInput:"._searchInput",searchBtn:"._searchBtn",selectFilter:"._selectFilter",attendeesRegion:"._attendeesRegion",closeBtn:"._closeBtn"},regions:{attendeesRegion:{el:"@ui.attendeesRegion",replaceElement:!0}},events:{"click @ui.btnStateTab":function(e){this._activeState=i(e.currentTarget).data("state"),i(e.currentTarget).parent().addClass("-on").siblings().removeClass("-on"),this._stateTabChanged()},"click @ui.btnChatWithAttendee":function(e){var t=this._getChatableSimpleMemberViewModels(),n=m.openAsLayer(this._bandData,new Backbone.Collection(t,{parse:!0}));this.listenTo(n,"member:selected",(function(e){var t=e.map((function(e){return e.pick("userNo","name")}));_.startChattingWithUsers(t,this._bandNo)}))},"submit @ui.searchForm":function(){return this._searchAttendeesByAutocomplete(),!1},"input @ui.searchInput":function(){this._toggleSearchBtn(),this._searchAttendeesByAutocomplete()},"change @ui.selectFilter":"_searchAttendees","click @ui.closeBtn":"_closeSelf",click:function(e){e.target==this.el&&this._closeSelf()}},behaviors:{CourierBehavior:""},onMessages:(t={},t[u.MSG.ATTENDANCE_CHECK_CLICK]=function(e){this.trigger(f.STATE_CHANGE,e),this._toggleChatButton(),this._attendeeListCollectionView.render()},t),initialize:function(e){this._bandData=e.bandData,this._bandNo=e.bandNo,this._isAuthor=e.isAuthor,this._activeState=e.activeState,this.model.isAttendanceVisibleToViewer()&&!this._activeState&&(this._activeState=g.CHECKED),this._searchAttendeesByAutocomplete=o.debounce(this._searchAttendees,300)},templateContext:function(){return{cid:this.cid,isAttendanceVisibleToViewer:this.model.isAttendanceVisibleToViewer(),ATTENDANCE_CHECK_STATE:g,activeState:this._activeState,supportedStates:this.model.getSupportedStates(),isChatButtonVisible:this._isChatButtonVisible(),isFilterSelectable:this._isFilterSelectable()}},onRender:function(){this.$el.addClass(this._bandData.getBandCore().getSkinColorClass()),this._toggleSearchBtn(),this._searchAttendees()},_stateTabChanged:function(){this.getUI("searchInput").val(""),this._toggleSearchBtn(),this._toggleChatButton(),this._toggleFilterSelect(),this._searchAttendees()},_toggleChatButton:function(){this.getUI("chatButtonWrap").toggle(this._isChatButtonVisible())},_getChatableAttendeeModels:function(){return o.filter(this.model.get("attendees").getAttendeeModels(this._activeState),o.bind((function(e){return!e.getAttendee().isMyself()&&!e.getAttendee().isChildMember()}),this))},_getChatableSimpleMemberViewModels:function(){return o.map(this._getChatableAttendeeModels(),(function(e){return new p(e.getAttendee().toJSON(),{parse:!0})}))},_isChatButtonVisible:function(){return this._activeState==g.UNCHECKED&&!(this._getChatableAttendeeModels().length<=0)},_isFilterSelectable:function(){return!!this.model.isAttendanceVisibleToViewer()&&(this._activeState!==g.CHECKED&&this._activeState!==g.UNCHECKED)},_toggleFilterSelect:function(){this.getUI("selectFilter").val("all"),this.getUI("selectFilter").parent().toggle(this._isFilterSelectable())},_updateSearchedAttendeeCount:function(){var e=this._attendeeListCollectionView.children.filter((function(e){return"DAttendanceCheckAttendeeListItemView"===e.attributes["data-viewname"]})).length;this.getUI("searchedAttendeeCount").text(e)},_searchAttendees:function(){if(this.getRegion("attendeesRegion").hasView()){var e="reason"===this.getUI("selectFilter").find("option:selected").val(),t=this.getUI("searchInput").val();this._attendeeListCollectionView.search(this._activeState,e,t)}else this._attendeeListCollectionView=new b({collection:this.model.get("attendees"),bandNo:this._bandNo,postNo:this.model.get("postNo"),attendanceCheckId:this.model.get("attendanceCheckId"),isManager:this._isAuthor||this.model.isAttendanceCheckManager(),isCheckableByAttendee:this.model.isCheckableByAttendee(),startAt:this.model.getStartAt(),timeZoneId:this.model.getTimeZoneId(),isAttendanceVisibleToViewer:this.model.isAttendanceVisibleToViewer(),supportedStates:this.model.getSupportedStates(),isOnlyCheckedStateSupported:this.model.isOnlyCheckedStateSupported(),state:this._activeState}),this.listenTo(this._attendeeListCollectionView,"render",this._updateSearchedAttendeeCount),this.showChildView("attendeesRegion",this._attendeeListCollectionView)},_toggleSearchBtn:function(){var e=s.isBlank(this.ui.searchInput.val());this.ui.searchBtn.prop("disabled",e).toggleClass("-disabled",e).toggleClass("-active",!e)},_closeSelf:function(){d.closeTop()}});return v.EVENTS=f,v.openAsLayer=function(e){var t=i.when(c.fetchAttendanceCheck(e.bandNo,e.postNo,e.attendanceCheckId),h.getCachedBandData(e.bandNo)).then((function(t,n){return new v(o.extend({model:t,bandData:n},e))}));return d.openPromiseView(t,!0,{width:480,height:544}),t},v}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n\t<header class="modalHeader">\n\t\t<h1 class="title"><%- IM(\'web.postwrite.form_attendance_check.add_attendees.title\') %></h1>\n\t</header>\n\n\t<div class="modalBody">\n\t\t<div class="modalContentWrap gPal0 gPar0">\n\t\t\t<% if (isAttendanceVisibleToViewer) { %>\n\t\t\t<div class="tab">\n\t\t\t\t<% _.each(supportedStates, function(state) { %>\n\t\t\t\t<span class="cell sf_color <%= activeState === state ? \'-on\' : \'\' %>">\n\t\t\t\t\t<button type="button" class="_btnStateTab" data-state="<%= state %>"><%= IM(\'attendance_check.state.\' + state) %></button>\n\t\t\t\t</span>\n\t\t\t\t<% }); %>\n\t\t\t</div>\n\t\t\t<% } %>\n\t\t\t<div class="memberListBox">\n\t\t\t\t<form class="searchWrap _searchForm">\n\t\t\t\t\t<label for="searchMember_<%- cid %>" class="searchIcon"><span class="gSrOnly"><%- IM(\'web.bandmember.search_member\') %></span></label>\n\n\t\t\t\t\t<span class="inputWrap">\n\t\t\t\t\t<input type="search" id="searchMember_<%- cid %>" class="inputSearch _searchInput" placeholder="<%- IM(\'band_member_select.label.name\') %>">\n\t\t\t\t</span>\n\n\t\t\t\t\t<button type="submit" class="btnSearch uButton -sizeS -default -disabled _searchBtn" disabled><%- IM(\'ui.label.search\') %></button>\n\t\t\t\t</form>\n\n\t\t\t\t\x3c!-- 미응답 멤버와 채팅하기 --\x3e\n\t\t\t\t<div class="buttonMemberChatBox _chatButtonWrap" style="<%= isChatButtonVisible ? \'\' : \'display: none;\' %>">\n\t\t\t\t\t<button type="button" class="buttonMemberChat -arrow -borderBottom _btnChatWithAttendee">\n\t\t\t\t\t\t<span class="iconChatPlus"></span><span class="text"><%= IM(\'ui.label.chat_with_following_members\') %></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="memberListStatusBar">\n\t\t\t\t\t<p class="count"><%- IM(\'web.common.members\') %> <span class="_searchedAttendeeCount"></span></p>\n\n\t\t\t\t\t<div class="uSelect -textType -sizeS -taR" style="<%= isFilterSelectable ? \'\' : \'display:none;\' %>">\n\t\t\t\t\t\t<label for="filter_<%- cid %>" class="gSrOnly"><%- IM(\'member_list.sort.title\') %></label>\n\t\t\t\t\t\t<select id="filter_<%- cid %>" class="_selectFilter">\n\t\t\t\t\t\t\t<option value="all"><%= IM(\'ui.label.all\') %></option>\n\t\t\t\t\t\t\t<option value="reason"><%= IM(\'attendance_check.attendee_filter.with_reason\') %></option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<ul class="listLine rScroll -lrSpace _attendeesRegion"></ul>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n\t<footer class="modalFooter -tLine gMal0 gMar0">\n\t\t<button type="button" class="btnLyBack uButton -iconLyBack _closeBtn"><span class="gSrOnly"><%- IM(\'ui.label.close_layer\') %></span></button>\n\t\t<button type="button" class="uButton -confirm _closeBtn"><%- IM(\'ui.label.confirm\') %></button>\n\t</footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(16),o=n(4),s=n(2616),a=n(714),r=n(82),l=n(9),c=n(159),d=n(589),u=(n(802),n(26)),h=n(2057),p=n(800),m=n(532).ATTENDANCE_CHECK_STATE,_={CHECKBOX:"CHECKBOX",MORE_BUTTON:"MORE_BUTTON",NONE:"NONE"};return o.View.extend({tagName:"li",className:"tLine flexList",attributes:{"data-viewname":"DAttendanceCheckAttendeeListItemView"},behaviors:[c],template:t.template(s),templateContext:function(){var e=this.model.get("attendee").get("profileImageUrl"),t=r.makeProfileThumbnailUrl(e);return{cid:this.cid,profile:e?t:null,profileInnerClass:r.makeProfileInnerClass(t),checkedTime:l.format.date(this.model.get("checkedAt"),"short_date_time"),checkbox:this._checkable||this.model.get("isChecked"),checkable:this._checkable,isAttendanceVisibleToViewer:this._isAttendanceVisibleToViewer,isChildMembership:this._isChildMembership(),reasonText:this._getReasonText(),isOnlyCheckedStateSupported:this._isOnlyCheckedStateSupported,ATTENDANCE_CHECK_STATE:m,ACTION_TYPE:_,actionType:this._getActionType(),isMyself:this.model.getAttendee().isMyself()}},serializeData:function(){return this.model.toJSON()},ui:{btnProfile:"._btnProfile",checkbox:"._checkbox",btnMoreOption:"._btnMoreOption",moreOptionMenuWrap:"._moreOptionMenuWrap",btnUncheck:"._btnUncheck",btnChangeState:"._btnChangeState"},events:{"click @ui.btnProfile":"_showMemberProfile","click @ui.checkbox":function(){if(this._isBeforeCheckingAttendance()&&!this._isManager)return alert(IM("attendance_check.before_checking_attendance.click_msg")),!1;if(!this._checkable)return alert(IM("permission_deny")),!1;if(this._checkingInProgress)return!1;this._checkingInProgress=!0;var e=!this.model.isCheckStatus(),n=this._isChildMembership()||!this.model.getAttendee().isMyself();return this._isManager&&n&&!e&&!confirm(IM("ui.label.check_clear_confirm"))?(this._checkingInProgress=!1,!1):(this._handleAttendanceCheckState(e).done(t.bind(this._onStateChangeSucceeded,this)).always(t.bind((function(){this._checkingInProgress=!1}),this)),!1)},"click @ui.btnMoreOption":function(e){return this.getUI("moreOptionMenuWrap").is(":hidden")&&u.getDGlobalChannel().trigger(u.EVENT.HTML_CLICK),this.getUI("moreOptionMenuWrap").toggle(),!1},"click @ui.btnUncheck":function(e){var n=this._makeStateChangeBaseParams();n.state=m.UNCHECKED;var i=$.Deferred();this._setAttendanceCheckState(n,i),i.promise().done(t.bind(this._onStateChangeSucceeded,this))},"click @ui.btnChangeState":function(e){var n=this._makeStateChangeBaseParams(),i=$.Deferred();this._selectCheckState(n,i),i.promise().done(t.bind(this._onStateChangeSucceeded,this))}},modelEvents:{change:"render"},initialize:function(e){this._checkingInProgress=!1,this._bandNo=e.bandNo,this._postNo=e.postNo,this._attendanceCheckId=e.attendanceCheckId,this._isManager=e.isManager,this._checkable=this._isManager||e.isCheckableByAttendee&&this.model.getAttendee().isMyself(),this._startAt=e.startAt,this._timeZoneId=e.timeZoneId,this._isAttendanceVisibleToViewer=e.isAttendanceVisibleToViewer,this._supportedStates=e.supportedStates,this._isOnlyCheckedStateSupported=e.isOnlyCheckedStateSupported},onRender:function(){this.ui.checkbox.prop("checked",this.model.get("isChecked"))},onAttach:function(){this.listenTo(u.getDGlobalChannel(),u.EVENT.HTML_CLICK,(function(){this.getUI("moreOptionMenuWrap").hide()}))},_showMemberProfile:function(){var e=this.model.getAttendee();this._isChildMembership()||d.openMemberProfileLayer(e.getMemberProfile(),e.getUserNo(),this._bandNo)},_getActionType:function(){return this.model.isCheckStatus()?this._isOnlyCheckedStateSupported?this._checkable||this._isAttendanceVisibleToViewer&&this.model.isCheckStatus()?_.CHECKBOX:_.NONE:this._checkable?this._isAttendanceVisibleToViewer?_.MORE_BUTTON:_.CHECKBOX:this._isAttendanceVisibleToViewer?_.NONE:_.CHECKBOX:this._checkable?_.CHECKBOX:_.NONE},_getReasonText:function(){if(!this.model.isCheckStatus())return"";var e=this.model.getAttendee();if(!this._isAttendanceVisibleToViewer&&!e.isMyself())return"";var t=this.model.getStateDescription();return t?this._isManager||e.isMyself()?this._isAttendanceVisibleToViewer?IM("attendance_check.state_selection_reason")+" : "+t:IM("attendance_check.state."+this.model.getState())+" : "+t:IM("attendance_check.exist_check_state_reason"):""},_isChildMembership:function(){return"child_membership"===this.model.getAttendee().get("memberType")},_isBeforeCheckingAttendance:function(){if(!this._startAt)return!1;var e=null,t=null;return this._timeZoneId?(e=i.tz(i(this._startAt),this._timeZoneId),t=i.tz(i(),this._timeZoneId)):(e=i(this._startAt),t=i()),t.isBefore(e)},_makeStateChangeBaseParams:function(){var e=this.model.get("attendee"),t=e.get("userNo"),n=e.get("childMembershipId"),i={band_no:this._bandNo,post_no:this._postNo,attendance_check_id:this._attendanceCheckId,target_user_no:t};return n&&(i.target_child_membership_id=n),i},_handleAttendanceCheckState:function(e){var t=this._makeStateChangeBaseParams(),n=$.Deferred();return e?this._handleCheck(t,n):this._handleUncheck(t,n),n.promise()},_handleCheck:function(e,t){if(this._isOnlyCheckedStateSupported)return e.state=m.CHECKED,void this._setAttendanceCheckState(e,t);this._selectCheckState(e,t)},_handleUncheck:function(e,n){if(this._isOnlyCheckedStateSupported)return e.state=m.UNCHECKED,void this._setAttendanceCheckState(e,n);p.openAsLayer({title:IM("attendance_check.change_check_state.title"),confirm:IM("ui.label.confirm"),cancel:IM("ui.label.cancel"),radioItems:[{label:IM("attendance_check.uncheck_option.cancel_selection"),value:"uncheck"},{label:IM("attendance_check.uncheck_option.change_selection"),value:"changeState"}],withoutHiding:!0}).once("modal:confirm",t.bind((function(t){"uncheck"===t?(e.state=m.UNCHECKED,this._setAttendanceCheckState(e,n)):this._selectCheckState(e,n)}),this)).once("modal:cancel",t.bind((function(){n.reject()}),this))},_selectCheckState:function(e,t){var n=this.model.isCheckStatus()?this.model.getState():null,i=h.openAsLayer(this._supportedStates,n,this.model.getStateDescription());this.listenToOnce(i,h.EVENT.CONFIRM,(function(n){e.state=n.selectedState,e.state_description=n.reason,this._setAttendanceCheckState(e,t)})),this.listenToOnce(i,h.EVENT.CANCEL,(function(){t.reject()}))},_setAttendanceCheckState:function(e,t){a.setAttendanceCheckState(e).done((function(){t.resolve(e)})).fail(t.reject)},_onStateChangeSucceeded:function(e){var n=e.state!=m.UNCHECKED,i=n?t.now():null;this.model.set({isChecked:n,checkedAt:i,state:e.state,stateDescription:e.state_description}),this.spawn(c.MSG.ATTENDANCE_CHECK_CLICK,{userNo:e.user_no,childMembershipId:e.target_child_membership_id,isChecked:n,checkedAt:i})}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button type="button" class="thumb <%- (!isChildMembership) ? \'_btnProfile\' : \'\' %>" <%- (isChildMembership) ? \'disabled\': \'\' %>>\n    <span class="uProfile -size40">\n        <span class="profileInner <%- profileInnerClass %>">\n            <% if (profile) { %>\n            <img src="<%- profile %>" width="40" height="40" alt="<% IM(\'photo\') %>">\n            <% } %>\n        </span>\n    </span>\n</button>\n\n<span class="text">\n    <span class="ellipsis"><%- attendee.name %></span>\n    <span class="sub2 -ellipsis"><%- attendee.desc %></span>\n\n    <% if (attendee.childMembershipId) { %>\n    <span class="sub2">\n        <span class="memberType"><%- IM(\'web.common.child_member\') %></span><span class="name"><%= IM(\'schedule.rsvp.state.change_actor\', {actorName: _.escape(attendeeOwner.name)}) %></span>\n    </span>\n    <% } %>\n\n    <% if (!!reasonText) { %>\n    <span class="sub2">\n        <span class="reasonText">\n            <%- reasonText %>\n        </span>\n    </span>\n    <% } %>\n\n    <% if (isAttendanceVisibleToViewer && checkedTime) { %>\n    <span class="sub2">\n        <span class="date _checkedAt"><%- checkedTime %></span>\n    </span>\n    <% } %>\n</span>\n<% if (actionType != ACTION_TYPE.NONE) { %>\n<span class="etc">\n    <% if (actionType === ACTION_TYPE.CHECKBOX) { %>\n    <span class="uCheck -checkbox -noLabel">\n        <input type="checkbox" class="checkInput _checkbox" <%- (!checkable) ? \'disabled\': \'\' %>>\n        <span class="checkLabel">\n            <span class="shape sf_afterBg"></span>\n        </span>\n    </span>\n    <% } else if (actionType === ACTION_TYPE.MORE_BUTTON) { %>\n    <div class="option">\n        <button type="button" aria-haspopup="listbox" aria-expanded="false" class="memberSet _btnMoreOption"><%= IM(\'ui.label.more.short\') %></button>\n        <div class="lyMenu _moreOptionMenuWrap" style="min-width:158px;display: none">\n            <ul>\n                <li><a href="#" class="_btnUncheck"><%= IM(\'attendance_check.uncheck_option.cancel_selection\') %></a></li>\n                <li><a href="#" class="_btnChangeState"><%= IM(\'attendance_check.uncheck_option.change_selection\') %></a></li>\n            </ul>\n        </div>\n    </div>\n    <% } %>\n</span>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2618),s=n(486),a=(n(532).ATTENDANCE_CHECK_STATE,{SELECTED:"SELECTED"}),r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DAttendanceCheckFilterSelectionView"},template:t.template(o),ui:{checkboxAll:"._checkboxAll",checkbox:"._checkbox",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},events:{"change @ui.checkboxAll":function(){this.ui.checkbox.prop("checked",this.ui.checkboxAll.prop("checked")),this._toggleConfirmBtn()},"change @ui.checkbox":function(){this.ui.checkboxAll.prop("checked",0==this.ui.checkbox.filter(":not(:checked)").length),this._toggleConfirmBtn()},"click @ui.cancelBtn":"_closeSelf","click @ui.confirmBtn":function(){var e=[];e=this.getUI("checkboxAll").prop("checked")?this._supportedStates:t.map(this.getUI("checkbox").filter(":checked"),(function(e){return e.value})),this.trigger(a.SELECTED,e),this._closeSelf()}},initialize:function(e){this._supportedStates=e.supportedStates,this._description=e.description},serializeData:function(){var e=t.map(this._supportedStates,(function(e){return{value:e,label:IM("attendance_check.state."+e)}}));return{cid:this.cid,description:this._description,checkboxes:e}},_toggleConfirmBtn:function(){this.ui.confirmBtn.prop("disabled",0==this.ui.checkbox.filter(":checked").length)},_closeSelf:function(){s.closeTop()}});return r.EVENT=a,r.openAsLayer=function(e,t){var n=new r({supportedStates:e,description:t});return s.openWithoutHiding(n),n},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent">\n    <header class="header -subDescType">\n        <h1 class="title"><%- IM(\'schedule.rsvp.select_print_item.title\') %></h1>\n        <p class="desc"><%- description %></p>\n    </header>\n\n    <div class="main">\n        <ul class="selectArea">\n            <li>\n                <label for="check_<%- cid %>_all" class="uCheck -checkbox">\n                    <input type="checkbox" id="check_<%- cid %>_all" class="checkInput _checkboxAll">\n                    <span class="checkLabel">\n                        <span class="shape"></span>\n                        <span class="text"><%- IM(\'ui.label.all_select\') %></span>\n                    </span>\n                </label>\n            </li>\n            <% _.each(checkboxes, function(checkbox, index) { %>\n            <li>\n                <label for="check_<%- cid %>_<%- index %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="check_<%- cid %>_<%- index %>" class="checkInput _checkbox" value="<%- checkbox.value %>">\n                    <span class="checkLabel">\n                        <span class="shape"></span>\n                        <span class="text"><%- checkbox.label %></span>\n                    </span>\n                </label>\n            </li>\n            <% }); %>\n        </ul>\n    </div>\n\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn" disabled><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<% if (needShowHeaderView) { %>\n<div class="item -markdown">\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-markdown sf_color" aria-hidden="true">\n                <use xlink:href="<%= svgUrl %>"></use>\n            </svg>\n\n            <span class="status sf_color"><%- addonName %></span>\n        </p>\n        <p class="subTxt"><%- description %></p>\n    </div>\n</div>\n<% } else { %>\n<iframe src="<%- addonUri %>" class="addonIframe _addonIframe" scrolling="no"></iframe>\n<% } %>\n'},function(e,t){e.exports='<div class="item -signup">\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-signup sf_color" aria-hidden="true">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-attach-signup<% if (!bPostDetail) { %>-22<% } %>"></use>\n            </svg>\n            <span class="status sf_color"><%- IM(\'signup.type_name\') %></span><% if (doneCount) { %> <em><%- doneCount %></em><% } %>\n        </p>\n        <p class="addTitle"><%- title %></p>\n        <% if (remainingTime || headStartDate) { %>\n        <div class="addStatus">\n            <% if (headStartDate) { %>\n            <time class="date"><%- headStartDate %></time>\n            <% } %>\n            <% if (remainingTime) { %>\n            <span class="deadline sf_color"><%- remainingTime %></span>\n            <% } %>\n        </div>\n        <% } %>\n        <% if (moreCount) { %>\n        <p class="guideText"><%- IM(\'signup.n_more_signup\', {count: moreCount}) %></p>\n        <% } %>\n        <% if (menuAvailable) { %>\n        <div class="option">\n            <button type="button" class="memberSet _menuToggleBtn"><%- IM(\'web.uicomponent.topbar.button.menuopen\') %></button>\n            <div class="lyMenu _menuLayer" style="min-width:130px;display:none">\n                <ul>\n                    <li><a href="#" class="_excelLink"><%- IM(\'ui.label.excel_download\') %></a></li>\n                    <li><a href="#" class="_printLink"><%- IM(\'ui.label.print\') %></a></li>\n                </ul>\n            </div>\n        </div>\n        <% } %>\n    </div>\n    <% if (bPostDetail) { %>\n    <div class="addDetail">\n        <% if (detailStartDate) { %>\n        <h3 class="signupViewDate"><%- detailStartDate %></h3>\n        <% } %>\n        <% _.each(taskGroups, function(taskGroup, index) { %>\n        <div class="signupSameTimeWrap">\n            <% if (taskGroup.time) { %>\n            <div class="timeSetting">\n                <time class="timeInfoData" id="<%- cid %>_time_<%- index %>"><%- taskGroup.time %></time>\n                <% if (taskGroup.localTime) { %>\n                <button class="btnChangeTimezone _timeBtn" data-index="<%- index %>" aria-controls="<%- cid %>_time_<%- index %>"><%- IM(\'ui.label.view_in_my_time_zone\') %></button>\n                <% } %>\n            </div>\n            <% } %>\n            <ul class="signupViewList <%- taskGroup.className %>"></ul>\n        </div>\n        <% }); %>\n        <% if (childMemberGuidable) { %>\n        <div class="singupPlusFunc">\n            <span class="desc"><%- IM(\'signup.child_member_guide\') %></span>\n        </div>\n        <% } %>\n    </div>\n    <% } %>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2622),s=n(2623),a=n(13);return i.View.extend({tagName:"li",className:"signupViewItem",attributes:{"data-viewname":"DPostSignupTaskView"},template:t.template(o),ui:{checkboxLabel:"._checkboxLabel",checkbox:"._checkbox",attendeesLink:"._attendeesLink"},events:function(){return this.options.clickDisabledPostTypeOnDetail?{}:{"change @ui.checkbox":function(){var e=this.ui.checkbox.prop("checked");this.ui.checkbox.prop("disabled",!0),this._setSignupTaskStates(e).fail(t.bind((function(){this.ui.checkbox.prop({checked:!e,disabled:!1})}),this))},"click @ui.attendeesLink":function(){return this.ui.attendeesLink.data("disabled")||s.openAsLayer({model:this.model,postModel:this._postModel}),!1}}},modelEvents:{change:"render"},initialize:function(e){this._bandData=e.bandData,this._postModel=e.postModel,this._isAuthor=this.model.get("isAuthor")||this._bandData.isContentsDeletionPermitted()},serializeData:function(){var e=this.model.attributes;return{cid:this.cid,subject:e.subject,attendees:t.chain(this.model.get("attendees")).first(20).pluck("name").value().join(", "),attendeeLimit:e.attendeeLimit,checkedAttendeeCount:e.checkedAttendeeCount}},onRender:function(){var e=this.model.get("isViewerChecked"),t=this.model.get("checkedAttendeeCount"),n=this.model.get("attendeeLimit"),i=this.model.get("isChildMemberAddible"),o=this._isClosed(),s=this.options.clickDisabledPostTypeOnDetail&&!this._bandData.canTogglePostSignupState()||o,a=t==n,r=s||!e&&a,l=s||a,c=!this._bandData.canShowPostSignUpAttendees()||!(t||!o&&(this._isAuthor||i));this.ui.checkbox.prop({checked:e,disabled:r}),this.ui.checkboxLabel.toggleClass("-disabled",this.options.clickDisabledPostTypeOnDetail||!e&&l),this.ui.checkboxLabel.toggleClass("-lastChecked",e&&l),this.ui.attendeesLink.toggleClass("gCursorDefault",c).attr("aria-disabled",c).data("disabled",c)},_isClosed:function(){var e=this.model.get("endedAt");return!!e&&e<=(new Date).getTime()},_setSignupTaskStates:function(e){return this.model.setSignupTaskStates({checked:e,target_users:[{band_no:this._bandNo,user_no:a.getUserData().getUserNo()}]})}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="signupApplyInfo">\n    <div class="signupApplyItem">\n        <label for="<%- cid %>_task" class="uCheck -checkbox _checkboxLabel">\n            <input type="checkbox" id="<%- cid %>_task" class="checkInput _checkbox">\n            <span class="checkLabel">\n                <span class="shape sf_tAfterBg"></span>\n                <span class="text"><%- subject %></span>\n\n            </span>\n        </label>\n    </div>\n    <% if (checkedAttendeeCount) { %>\n    <div class="signupApplyAttend">\n        <span class="labelDesc"><%- attendees %></span>\n    </div>\n    <% } %>\n</div>\n<div class="signupApplyInfo">\n    <a href="#" class="signupAttendInfo _attendeesLink">\n        <span class="signupAttendNum  sf_color"><span class="gSrOnly"><%- IM(\'signup.task.checked_attendee_count\') %></span><%- checkedAttendeeCount %></span>\n        <span class="signupSettingNum"><span class="gSrOnly"><%- IM(\'signup.task.attendee_limit\') %></span><%- attendeeLimit %></span>\n    </a>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(2624),a=n(719),r=n(486),l=n(82),c=n(9),d=n(907),u=n(527),h=n(154),p=n(160),m=n(13),_=n(491),g=n(589),f=n(1629),b=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DPostSignupAttendeesView"},template:i.template(s),ui:{addBandMemberLink:"._addBandMemberLink",addChildMemberLink:"._addChildMemberLink",profileLink:"._profileLink",deleteBtn:"._deleteBtn",confirmBtn:"._confirmBtn"},events:{"click @ui.addBandMemberLink":function(){return this._openMemberSelectView(),!1},"click @ui.addChildMemberLink":function(){return this._openChildMemberInputView(),!1},"click @ui.profileLink":function(e){var n=i.propertyOf(this._attendees[t(e.currentTarget).data("index")])("attendee");return n&&!n.child_membership_id&&g.openProfileView(this._bandNo,n.user_no),!1},"click @ui.deleteBtn":function(e){var n=t(e.currentTarget),o=this._attendees[n.data("index")].attendee,s=o.user_no==this._userNo;if(!(s||this._isAuthor||this._bandData.canSetPostOthersSignupStates()))return!1;var a=[i.pick(o,"band_no","user_no","child_membership_id")],r=o.child_membership_id?IM("signup.attendee.delete_child_member_confirm"):IM("signup.attendee.delete_band_member_confirm");(s||confirm(r))&&(n.prop("disabled",!0),this._setSignupTaskStates(!1,a).fail(i.bind((function(){n.prop("disabled",!1)}),this)))},"click @ui.confirmBtn":function(){r.closeTop()}},initialize:function(e){this._editable=!1,this._bandData=e.bandData,this._postModel=e.postModel,this._bandNo=this.model.get("bandNo"),this._userNo=m.getUserData().getUserNo(),this._isAuthor=this.model.get("isAuthor"),this._setAttendees(e.attendees)},templateContext:function(){var e=this._isClosed();return this._addableCount=this.model.get("attendeeLimit")-this.model.get("checkedAttendeeCount"),{bandMemberAddable:!e&&this._addableCount>0&&(this._bandData.canSetPostOthersSignupStates()||this._isAuthor),childMemberAddable:!e&&this.model.get("isChildMemberAddible")&&this._addableCount>0,msg_addBandMemberBtn:this._postModel.getBand().showBandMemberTermAsSubscriber()?IM("ui.label.add.subscriber"):IM("ui.label.add_band_member"),emptyMessage:this._bandData.getBandCore().selectMcoResourceKey(IM("schedule.rsvp.msg.no_member"),IM("ui.message.empty_conents")),attendees:i.map(this._attendees,(function(t){var n=t.attendee,i=t.actor,o=!!n.child_membership_id,s=l.make(n.profile_image_url,l.TYPE.s75);return{profile:s,profileInnerClass:l.makeProfileInnerClass(s),name:n.name,description:n.description,checkedTime:c.format.date(t.checked_at,"short_date_time"),deletable:!e&&(this._isAuthor||this._bandData.canSetPostOthersSignupStates()||n.user_no==this._userNo),isExternalMember:o,isAdded:o||i.user_no!=n.user_no,addUserName:i.name}}),this)}},_isClosed:function(){var e=this.model.get("endedAt");return!!e&&e<=(new Date).getTime()},_setAttendees:function(e){this._attendees=i.sortBy(e,(function(e){var t=e.attendee;return t.child_membership_id||t.user_no!=this._userNo?2:1}),this)},_getChildMembers:function(){return i.filter(this._attendees,(function(e){return e.attendee.child_membership_id}))},_setSignupTaskStates:function(e,t){return this.model.setSignupTaskStates({checked:e,target_users:t}).then(i.bind((function(e){this._setAttendees(e),this.render()}),this))},_openMemberSelectView:function(){if(!this._isAuthor&&!this._bandData.canSetPostOthersSignupStates())return!1;var e=i.chain(this._attendees).filter((function(e){return!e.attendee.child_membership_id})).indexBy((function(e){return e.attendee.user_no})).value(),t=this._postModel.getBand().showBandMemberTermAsSubscriber()?IM("ui.label.add.subscriber"):IM("ui.label.add_band_member"),n=d.openDMemberSelectionView({wideView:!0,titleText:t,submitBtnText:IM("ui.label.add")}),o=u.buildBandMemberWithFilterDataCollection(this._bandNo,p.SIGNUP,1e3),s=u.buildBandMemberWithFilterDataCollection(this._bandNo,p.SIGNUP,1e3),a=[];h.wrapActivePromise(o.fetchBandMemberWithFilterDataCollection(),this).then(i.bind((function(){a=o.toMemberSelectionViewModels(),a=i.filter(a,(function(t){return!e[t.getUserNo()]})),n.renderMemberListToSelect({memberModels:a,emptyMessage:" ",showSearchMoreMemberBtn:o.hasMoreMember()})}),this)),this.listenTo(n,d.EVENT.MEMBER_SELECTION_MEMBER_SELECT_CLICK,(function(e){n.selectMember(e.selectedMember)})),this.listenTo(n,d.EVENT.MEMBER_SELECTION_MEMBER_DESELECT_CLICK,(function(e){n.deselectMember(e)})),this.listenTo(n,d.EVENT.MEMBER_SELECTION_MEMBER_PROFILE_CLICK,(function(e){g.openMembershipProfileLayer({name:e.name,profileImageUrl:e.profileImageUrl,userNo:e.userNo,bandNo:this._bandNo})})),this.listenTo(n,d.EVENT.MEMBER_SELECTION_SEARCH,(function(t){h.wrapActivePromise(s.searchBandMemberWithFilterDataCollection(t),this).then(i.bind((function(){var t=s.toMemberSelectionViewModels();t=i.filter(t,(function(t){return!e[t.getUserNo()]})),n.renderMemberListToSelect({memberModels:t,showSearchMoreMemberBtn:s.hasMoreMember(),emptyMessage:this._bandData.getBandCore().selectMcoResourceKey(IM("member_list.label.nobody_available"),IM("ui.message.no_search_result"))})}),this))})),this.listenTo(n,d.EVENT.MEMBER_SELECTION_INPUT_EMPTY,(function(){n.renderMemberListToSelect({memberModels:a,emptyMessage:" ",showSearchMoreMemberBtn:o.hasMoreMember()})})),this.listenTo(n,d.EVENT.MEMBER_SELECTION_COMPLETE,(function(e){var t=i.map(e.selectedMembers,(function(e){return{band_no:this._bandNo,user_no:e.getUserNo()}}),this),n=t[0],o=1==t.length&&n.user_no==this._userNo;t.length>this._addableCount?alert(IM("signup.attendee.exceed_alert",{count:this._addableCount})):(o||confirm(IM("signup.attendee.add_confirm")))&&(this._setSignupTaskStates(!0,t),r.closeTop())}))},_openChildMemberInputView:function(){var e=this._getChildMembers(),t=f.buildChildMemberListView({bandNo:this._bandNo,unselectableChildMembers:i.pluck(i.pluck(e,"attendee"),"child_membership_id")});r.open(t),this.listenTo(t,"confirm:addChildMembers",(function(e){var t=i.map(e,i.bind((function(e){return{band_no:this._bandNo,user_no:this._userNo,child_membership_id:e.childMembershipId}}),this));this._setSignupTaskStates(!0,t).then((function(){r.closeTop()}))}))}});return b.openAsLayer=function(e){var n=e.model,i=n.attributes,o=t.when(_.getCachedBandData(i.bandNo),a.getSignupAttendees(i.bandNo,i.postNo,i.signupId,i.taskId)).then((function(t,i){var o=i.attendees;return n.setSignupTaskAttendees(o),new b({attendees:o,model:n,bandData:t,postModel:e.postModel})}));r.openPromiseView(o,!1,{width:480,height:544})},b}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%- IM(\'signup.view_attendees\') %></h1>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n            <div class="memberListBox signupMember">\n\n                \x3c!-- [D] 출석멤버수정_멤버목록 --\x3e\n                <div class="topNoticeBar">\n                    <h3 class="itemInfo">\n                        <span class="itemTitle"><%- subject %></span>\n                        <span class="itemAttendInfo">\n\t\t\t\t\t\t\t<em class="itemAttendMem sf_color"><%- checkedAttendeeCount %></em>\n\t\t\t\t\t\t\t<span class="itemAttendAll"><%- attendeeLimit %></span>\n\t\t\t\t\t\t</span>\n                    </h3>\n                    \x3c!--<button type="button" class="btnDelet">모두 삭제</button>--\x3e\n                </div>\n\n                <% if (bandMemberAddable) { %>\n                <div class="addBandMember addMember"><a href="#" role="button" class="button _addBandMemberLink"><%- msg_addBandMemberBtn %></a></div>\n                <% } %>\n                <% if (childMemberAddable) { %>\n                <div class="addOuterMember addMember"><a href="#" role="button" class="button _addChildMemberLink"><%- IM(\'ui.label.add_child_member\') %></a></div>\n                <% } %>\n\n                <% if (checkedAttendeeCount) { %>\n                <ul class="listLine rScroll -lrSpace">\n                    <% _.each(attendees, function(attendee, index) { %>\n                    <li class="tLine flexList">\n                        <div class="thumb">\n                            <a href="#" role="button" class="profileLink _profileLink<%- attendee.isExternalMember ? \' gCursorDefault\' : \'\' %>" data-index="<%- index %>" aria-disabled="<%- attendee.isExternalMember %>">\n                            <span class="uProfile -size40">\n                                <span class="profileInner <%- attendee.profileInnerClass %>">\n                                    <% if (attendee.profile) { %>\n                                    <img src="<%- attendee.profile %>" width="40" height="40" alt="<% IM(\'photo\') %>">\n                                    <% } %>\n                                </span>\n                            </span>\n                            </a>\n                        </div>\n\n                        <div class="text">\n                            <p class="ellipsis attendName"><%- attendee.name %></p>\n                            <% if (attendee.description) { %>\n                            <p class="sub2 -ellipsis"><%- attendee.description %></p>\n                            <% } %>\n                            <% if (attendee.checkedTime) { %>\n                            <p class="sub2"><%- attendee.checkedTime %></p>\n                            <% } %>\n                            <% if (attendee.isAdded) { %>\n                            <p class="attendMemberInfo">\n                                <% if (attendee.isExternalMember) { %>\n                                <span class="memberType"><%- IM(\'web.common.child_member\') %></span>\n                                <% } %>\n                                <span class="name"><%= IM(\'schedule.rsvp.state.change_actor\', {actorName: _.escape(attendee.addUserName)}) %></span>\n                                <% } %>\n                            </p>\n                        </div>\n\n                        <% if (attendee.deletable) { %>\n                        <div class="etc">\n                            <button class="btnDelete uButton -sizeS -confirm2 _deleteBtn" data-index="<%- index %>"><%- IM(\'ui.label.delete\') %></button>\n                        </div>\n                        <% } %>\n                    </li>\n                    <% }); %>\n                </ul>\n                <% } else { %>\n                <p class="uEmpty">\n                    <span class="gWordKeep"><%- emptyMessage %></span>\n                </p>\n                <% } %>\n            </div>\n        </div>\n    </div>\n\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        \x3c!--<button type="button" class="btnLyBack uButton -iconLyBack"><span class="gSrOnly">돌아가기</span></button>--\x3e\n        <button type="button" class="uButton -confirm _confirmBtn"><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2626),s=n(486),a={SELECTED:"SELECTED"},r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DPostSignupTaskSelectionView"},template:t.template(o),ui:{checkboxAll:"._checkboxAll",checkbox:"._checkbox",cancelBtn:"._cancelBtn",confirmBtn:"._confirmBtn"},events:{"change @ui.checkboxAll":function(){this.ui.checkbox.prop("checked",this.ui.checkboxAll.prop("checked")),this._toggleConfirmBtn()},"change @ui.checkbox":function(){this.ui.checkboxAll.prop("checked",0==this.ui.checkbox.filter(":not(:checked)").length),this._toggleConfirmBtn()},"click @ui.cancelBtn":"_closeSelf","click @ui.confirmBtn":function(){var e=t.chain(this.ui.checkbox).filter((function(e){return e.checked})).map((function(e){return parseInt(e.value)})).value();this.trigger(a.SELECTED,e),this._closeSelf()}},initialize:function(e){this._description=e.description},serializeData:function(){return{cid:this.cid,description:this._description,tasks:this.model.getSignupTasks().toJSON()}},_toggleConfirmBtn:function(){this.ui.confirmBtn.prop("disabled",0==this.ui.checkbox.filter(":checked").length)},_closeSelf:function(){s.closeTop()}});return r.EVENT=a,r.openAsLayer=function(e){var t=new r(e);return s.openWithoutHiding(t),t},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent">\n    <header class="header -subDescType">\n        <h1 class="title"><%- IM(\'schedule.rsvp.select_print_item.title\') %></h1>\n        <p class="desc"><%- description %></p>\n    </header>\n\n    <div class="main">\n        <ul class="selectArea">\n            <li>\n                <label for="<%- cid %>_check_all" class="uCheck -checkbox">\n                    <input type="checkbox" id="<%- cid %>_check_all" class="checkInput _checkboxAll">\n                    <span class="checkLabel">\n                        <span class="shape"></span>\n                        <span class="text"><%- IM(\'ui.label.all_select\') %></span>\n                    </span>\n                </label>\n            </li>\n            <% _.each(tasks, function(task, index) { %>\n            <li>\n                <label for="<%- cid %>_check_<%- index %>" class="uCheck -checkbox">\n                    <input type="checkbox" id="<%- cid %>_check_<%- index %>" class="checkInput _checkbox" value="<%- task.taskId %>">\n                    <span class="checkLabel">\n                        <span class="shape"></span>\n                        <span class="text"><%- task.subject %></span>\n                    </span>\n                </label>\n            </li>\n            <% }); %>\n        </ul>\n    </div>\n\n    <footer class="footer">\n        <button type="button" class="uButton -cancel _cancelBtn"><%- IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _confirmBtn" disabled><%- IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="item -voice">\n    <div class="_audioPlayerWrapper"></div>\n</div>'},function(e,t){e.exports='<div class="item -quiz">\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-quiz sf_color" aria-hidden="true">\n                <use xlink:href="#ico-attach-quiz<% if (!showDetail) { %>-24<% } %>"></use>\n            </svg>\n            <span class="status sf_color"><%-IM("post.quiz.title")%></span> <em><%-takerCountText %></em>\n        </p>\n        <p class="addTitle"><%- title %></p>\n        <% if (remainingTime) { %>\n        <div class="addStatus"><time class="deadline sf_color gMat3"><%- remainingTime %></time></div>\n        <% } %>\n\n        <% if (!showDetail && moreCount) { %>\n        <p class="guideText"><%- IM(\'post.quiz.more_in_post\', {count: moreCount}) %></p>\n        <% } %>\n\n        <% if (isNotQuizRelated) { %>\n        \x3c!-- 이 퀴즈의 참여 대상이 아닙니다 --\x3e\n        <div class="addStatus"><p class="statusDesc gColorBk1"><%-IM("post.quiz.not_quiz_taker.msg")%></p></div>\n        <% } %>\n        <% if (showDetail && showManagerActions) { %>\n        <div class="headButtonBox">\n            \x3c!-- 응답자 보기 --\x3e\n            <button type="button" class="button _btnOpenTakerList"><%-IM("post.quiz.show_takers.btn")%></button>\n            \x3c!-- 퀴즈 보기 --\x3e\n            <button type="button" class="button _btnOpenManagerQuizView"><%-IM("post.quiz.open_quiz.btn")%></button>\n        </div>\n        <% } %>\n    </div>\n    <% if (showDetail && (showEndQuiz || showOpenTakerDetailView)) { %>\n    <div class="addDetail">\n        <% if (showEndQuiz) { %>\n        \x3c!-- 종료하기 --\x3e\n        <div class="detailButtonBox -borderTop">\n            <button class="uButton -sizeL -close sf_color sf_tBorder _btnEndQuiz">\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-end-check"></use>\n                </svg>\n                <%-IM("post.quiz.end_quiz.btn") %>\n            </button>\n        </div>\n        <% } %>\n        <% if (showOpenTakerDetailView) { %>\n        \x3c!-- [D] 답변 제출 가능한 경우 --\x3e\n        <div class="detailButtonBox -borderTop">\n            <button class="uButton -sizeL -close sf_color sf_tBorder _btnOpenTakerDetail">\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-end-check"></use>\n                </svg>\n                <%- openTakerDetailButtonLabel %>\n            </button>\n        </div>\n        <% } %>\n    </div>\n    <% } %>\n</div>'},function(e,t,n){var i=n(10),o=n(4),s=n(2630),a=n(486),r=n(2631),l=n(2633),c=n(562),d=n(658),u=n(2634),h=n(720),p=n(530),m=n(2636),g=n(2061),f=n(780),b=n(1004),v=n(1621),A=n(510),E=function(e){return e.get("gradedState")===p.GRADED_STATE.NOT_TAKEN_YET},T=function(e){return!E(e)},C={NOT_TAKEN:{filter:E,comparator:void 0},SORT_BY_NAME:{filter:T,comparator:function(e){return e.get("taker").get("name")}},SORT_BY_TAKEN_AT:{filter:T,comparator:function(e){return e.get("takenAt")}},FILTER_NEEDED:{filter:function(e){return e.get("gradedState")===p.GRADED_STATE.NEEDED},comparator:void 0},FILTER_FINISHED:{filter:function(e){return e.get("gradedState")===p.GRADED_STATE.FINISHED},comparator:void 0}},y={sortByName:C.SORT_BY_NAME,sortByTakenAt:C.SORT_BY_TAKEN_AT,filterNeeded:C.FILTER_NEEDED,filterFinished:C.FILTER_FINISHED},M=o.CollectionView.extend({tagName:"UL",className:"listLine rScroll -lrSpace",childViewOptions:function(){return{bandCore:this.options.bandCore,quizModel:this.options.quizModel}},changeSortAndFilter:function(e,t){this.viewComparator=e.comparator,this.filter=t?function(n){return e.filter(n)&&i.include(n.get("taker").get("name"),t)}:e.filter,this.resortView()}}),I="TAKEN",S="NOT_TAKEN",w=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DPostQuizTakerListLayerView"},initialize:function(){this._selectedFilter=void 0,this._currentTab=I},template:_.template(s),templateContext:function(){return{vid:this.cid}},ui:{searchForm:"._searchForm",searchInput:"._searchInput",searchBtn:"._searchBtn",wrapSelectFilter:"._wrapSelectFilter",selectFilter:"._selectFilter",btnClose:"._btnClose",btnRefresh:"._btnRefresh",btnHeaderMoreMenu:"._btnHeaderMoreMenu",btnDownloadGradingResult:"._btnDownloadGradingResult",headerMoreBox:"._headerMoreBox",searchedTakerCount:"._searchedTakerCount",wrapTabTaken:"._wrapTabTaken",wrapTabNotTaken:"._wrapTabNotTaken",btnTabTaken:"._btnTabTaken",btnTabNotTaken:"._btnTabNotTaken",btnTabStats:"._btnTabStats",wrapOpenQuizGrade:"._wrapOpenQuizGrade",btnOpenQuizGrade:"._btnOpenQuizGrade",wrapChatWithMembers:"._wrapChatWithMembers",btnChatWithMembers:"._btnChatWithMembers",noMember:"._noMember"},events:{click:function(){this.isDestroyed()||this.getUI("headerMoreBox").hide()},"click @ui.btnClose":"destroy","click @ui.btnRefresh":function(){this.model.fetchQuizModel()},"click @ui.btnTabStats":function(){this.model.isQuizStateOpened()?g.openWindowQuizStats(this.options.bandData.getBandCore(),this.model.get("postNo"),this.model.get("quizId")):c.openLayer({bodyTitle:IM("post.quiz.view_stats_error_msg"),withoutHiding:!0})},"click @ui.btnTabTaken":"_changeTabTaken","click @ui.btnTabNotTaken":"_changeTabNotTaken","click @ui.btnOpenQuizGrade":"_openQuizGrade","click @ui.btnChatWithMembers":"_openChatWithMembers","change @ui.selectFilter":function(){this._selectedFilter=this.getUI("selectFilter").val(),this._renderUIs()},"click @ui.btnHeaderMoreMenu":function(e){return e.stopPropagation(),this.getUI("headerMoreBox").toggle(!this.getUI("headerMoreBox").is(":visible")),!1},"click @ui.btnDownloadGradingResult":function(e){e.stopPropagation(),this.getUI("headerMoreBox").hide(),this.model.isTakenMemberExist()?l.downloadGradingResult(this.options.bandData.getBandCore(),this.model):c.openLayer({bodyTitle:IM("post_quiz.unable_to_download_grading_result"),withoutHiding:!0})},"input @ui.searchInput":function(){this._toggleSearchBtn(),""===this.ui.searchInput.val()&&this._renderUIs()},"submit @ui.searchForm":function(e){e.preventDefault(),this._renderUIs()}},regions:{list:{el:"._list",replaceElement:!0}},modelEvents:{change:"_renderUIs"},onRender:function(){this._renderUIs()},_toggleSearchBtn:function(){var e=i.isBlank(this.ui.searchInput.val());this.ui.searchBtn.prop("disabled",e).toggleClass("-disabled",e).toggleClass("-active",!e)},_renderUIs:function(){this._currentTab===I?(this.getUI("wrapTabTaken").addClass("-on"),this.getUI("wrapTabNotTaken").removeClass("-on")):(this.getUI("wrapTabTaken").removeClass("-on"),this.getUI("wrapTabNotTaken").addClass("-on")),this._toggleSearchBtn(),this._currentTab===I?this.showChildView("list",new M({childView:r,collection:this.model.get("takers"),bandCore:this.options.bandData.getBandCore(),quizModel:this.model})):this.showChildView("list",new M({childView:u,collection:this.model.get("takers"),bandCore:this.options.bandData.getBandCore(),quizModel:this.model}));var e=this.getUI("searchInput").val();if(this._currentTab===I){var t=y[this._selectedFilter]||C.SORT_BY_NAME;this.getChildView("list").changeSortAndFilter(t,e)}else this.getChildView("list").changeSortAndFilter(C.NOT_TAKEN,e);this.getUI("searchedTakerCount").html(IM("web.bandjoin.label.member_count",{count:String(this.getChildView("list").children.length)})),this.getChildView("list").children.length>0?this.getUI("noMember").css("display","none"):(this.getChildView("list").$el.hide(),this.getUI("noMember").css("display","")),this._currentTab===I?(this.getUI("wrapSelectFilter").show(),this.getUI("selectFilter").html(v({selectedValue:this._selectedFilter,options:[{value:"sortByName",text:IM("post.quiz.takers.filter.option.sort_by_name")},{value:"sortByTakenAt",text:IM("post.quiz.takers.filter.option.sort_by_taken_at")},{value:"filterNeeded",text:IM("post.quiz.takers.filter.option.filter_needed")},{value:"filterFinished",text:IM("post.quiz.takers.filter.option.filter_finished")}]})),this.getUI("selectFilter").prop("disabled",this.model.isQuizStateOpened()),this._isShowOpenQuizGrade()?this.getUI("wrapOpenQuizGrade").show():this.getUI("wrapOpenQuizGrade").hide(),this.getUI("wrapChatWithMembers").hide()):(this.getUI("wrapSelectFilter").hide(),this.getUI("wrapOpenQuizGrade").hide(),this.getChildView("list").children.length>0?this.getUI("wrapChatWithMembers").css("display",""):this.getUI("wrapChatWithMembers").css("display","none")),this.getUI("btnRefresh").toggle(!this.model.isQuizStateOpened())},_changeTabNotTaken:function(){this.getUI("searchInput").val(""),this._currentTab=S,this._selectedFilter=void 0,this._renderUIs()},_changeTabTaken:function(){this.getUI("searchInput").val(""),this._currentTab=I,this._selectedFilter=void 0,this._renderUIs()},_isShowOpenQuizGrade:function(){return this.model.get("takers").some((function(e){return e.get("gradedState")!==p.GRADED_STATE.OPENED&&e.get("gradedState")!==p.GRADED_STATE.NOT_TAKEN_YET}))},_openQuizGrade:function(){this.model.get("takers").some((function(e){return e.get("gradedState")===p.GRADED_STATE.NEEDED}))?c.openLayer({bodyTitle:IM("post.quiz.takers.all_taker_grade_required.alert"),withoutHiding:!0}):this.model.isPossibleToOpenGradeWithReview()?m.openLayer().once(m.EVENTS.CONFIRM,_.bind((function(e){this.model.openQuizGrade(e).then((function(){alert(IM("post.quiz.takers.open_quiz_grade.success.alert"))}))}),this)):A.openLayer({headerTitle:IM("post.quiz.takers.open_quiz_grade.confirm.title"),bodyTitle:IM("post.quiz.takers.open_quiz_grade.confirm.body"),confirm:IM("ui.label.yes"),cancel:IM("ui.label.no")}).once(A.EVENTS.CONFIRM,_.bind((function(){this.model.openQuizGrade().then((function(){alert(IM("post.quiz.takers.open_quiz_grade.success.alert"))}))}),this))},_openChatWithMembers:function(){var e=this.model.get("takers").filter(E),t=_.map(e,(function(e){return new f(e.get("taker").toJSON(),{parse:!0})})),n=b.openAsLayer(this.options.bandData,new Backbone.Collection(t,{parse:!0}));this.listenTo(n,"member:selected",(function(e){var t=e.map((function(e){return e.pick("userNo","name")}));h.startChattingWithUsers(t,this.options.bandData.getBandNo())}))}});w.openLayer=function(e){var t=d.createQuizModel(e.bandData.getBandCore().bandNo,e.quizModel.get("postNo"),e.quizModel.get("quizId"));t.fetchQuizModel();var n=new w({bandData:e.bandData,model:t});return a.openWithoutHiding(n),n},e.exports=w},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%-IM("post.quiz.takers.title") %></h1>\n        <button class="buttonRefresh _btnRefresh"><span class="gSrOnly"><%-IM("ui.label.refresh")%></span></button>\n        <div class="moreMenuWrap">\n            <button class="btnMoreMenu _btnHeaderMoreMenu"><%- IM(\'ui.label.more.short\') %></button>\n            <div class="menuBox _headerMoreBox" style="display: none;min-width: 145px;">\n                <ul class="menuList">\n                    <li class="menuItem"><button type="button" class="btnMenuText _btnDownloadGradingResult"><%- IM(\'post_quiz.download_grading_result\') %></button></li>\n                </ul>\n            </div>\n        </div>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n\n            <div class="tab">\n                <span class="cell sf_color _wrapTabTaken"><button type="button" class="_btnTabTaken"><%-IM("post.quiz.takers.tab.taken.label")%></button></span>\n                <span class="cell sf_color _wrapTabNotTaken"><button type="button" class="_btnTabNotTaken"><%-IM("post.quiz.takers.tab.not_taken.label")%></button></span>\n                <span class="cell sf_color"><button type="button" class="_btnTabStats"><%-IM("post.quiz.takers.tab.stats.label")%><span class="iconExport"></span></button></span>\n            </div>\n\n            <div class="memberListBox">\n                <form class="searchWrap _searchForm">\n                    <label for="searchMember_<%-vid%>" class="searchIcon"><span class="gSrOnly"><%-IM("web.bandmember.search_member")%></span></label>\n\n                    <span class="inputWrap">\n                        <input type="search" id="searchMember_<%-vid%>" class="inputSearch _searchInput" placeholder="<%-IM(\'band_member_select.label.name\')%>">\n    \t\t\t\t</span>\n\n                    <button type="submit" class="btnSearch uButton -sizeS -default _searchBtn"><%-IM("ui.label.search")%></button>\n                </form>\n\n                <div class="buttonMemberChatBox _wrapOpenQuizGrade">\n                    <button type="button" class="buttonMemberChat -arrow -borderBottom _btnOpenQuizGrade"><span class="text"><%-IM("post.quiz.takers.open_quiz_grade.btn")%></span></button>\n                </div>\n                <div class="buttonMemberChatBox _wrapChatWithMembers">\n                    <button type="button" class="buttonMemberChat -arrow -borderBottom _btnChatWithMembers"><span class="iconChatPlus"></span><span class="text"><%-IM("post.quiz.takers.chat_with_members.btn")%></span></button>\n                </div>\n\n                <div class="memberListStatusBar">\n                    <p class="count _searchedTakerCount"></p>\n\n                    <div class="uSelect -textType -taR -sizeS _wrapSelectFilter">\n                        <label for="filter_<%-vid%>" class="gSrOnly"><%-IM("post.quiz.takers.filter.label") %></label>\n                        <select id="filter_<%-vid%>" class="_selectFilter">\n                            <option value="sortByName"><%-IM("post.quiz.takers.filter.option.sort_by_name")%></option>\n                            <option value="sortByTakenAt"><%-IM("post.quiz.takers.filter.option.sort_by_taken_at")%></option>\n                            <option value="filterNeeded"><%-IM("post.quiz.takers.filter.option.filter_needed")%></option>\n                            <option value="filterFinished"><%-IM("post.quiz.takers.filter.option.filter_finished")%></option>\n                        </select>\n                    </div>\n                </div>\n\n                <div class="_list"></div>\n                <div class="uEmpty -h400 _noMember" style="display: none;">\n                    <span><%-IM("post.read_user_list.message.empty_list")%></span>\n                </div>\n            </div>\n        </div>\n\n    </div>\n\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="uButton -confirm _btnClose"><%-IM("ui.label.confirm")%></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(4),o=n(2632),s=n(9),a=n(618),r=n(530),l=n(168),c=n(153),d=i.View.extend({options:{bandCore:null,quizModel:null},tagName:"LI",className:"tLine flexList",attributes:{"data-viewname":"DPostQuizTakerListItemView"},template:_.template(o),templateContext:function(){return{taker:this.model.get("taker").toJSON(),pointGradedState:this.model.get("gradedState")===r.GRADED_STATE.NEEDED,gradedStateText:r.getGradedStateText(this.model.get("gradedState")),respondTime:s.format.date(this.model.get("takenAt"),"short_date_time")}},ui:{openQuizManagerDetail:"._openQuizManagerDetail"},events:{"click @ui.openQuizManagerDetail":function(){l.getMemberKeyByUserNo(this.options.bandCore.bandNo,this.model.get("taker").getUserNo()).then(_.bind((function(e){var t=c.GROUP_BAND_QUIZ_MANAGER_DETAIL.makeUrl({band_no:this.options.bandCore.bandNo,post_no:this.options.quizModel.get("postNo"),quiz_id:this.options.quizModel.get("quizId"),member_key:e});window.open(t)}),this))}},regions:{profileImage:{el:"._profileImage",replaceElement:!0}},onRender:function(){var e=this.model.get("taker");this.showChildView("profileImage",a.buildContentCreatorProfileImageView({memberProfile:e.getMemberProfile(),bandCore:this.options.bandCore,userNoOrMemberKey:this.model.get("taker").getUserNo()}))}});e.exports=d},function(e,t){e.exports='<span class="thumb">\n    <span class="_profileImage"></span>\n</span>\n\n<span class="text">\n    <span class="ellipsis"><%-taker.name %></span>\n    \x3c!-- [D] 채점 필요 상태만 -pointColor 클래스 추가 --\x3e\n    <span class="sub2"><span class="scoringState <% if (pointGradedState) { %>-pointColor <% } %>gFw5"><%-gradedStateText %></span><% if (takerPointTotal !== undefined) { %><span class="score"><%-IM("quiz.taker_point", {point: String(takerPointTotal)})%></span><% } %></span>\n    <time class="blockTime gMat2 gColorGr1" datetime="2017-07-10T14:54"><%-respondTime %></time>\n</span>\n\n<span class="etc">\n    <button class="uButton -sizeS -confirm2 _openQuizManagerDetail"><%-IM("post.quiz.takers.list.open_taker_answer.btn")%></button>\n</span>'},function(e,t,n){var i=n(0),o=n(16),s=n(9),a=n(1098),r=n(530),l={_makeFileName:function(){var e=[this._bandCore.name,IM("post_quiz.grade_result"),this._getQuizTitle()],t=this._getQuizPeriod("_");return t&&e.push(t),e.join("_")},_getQuizTitle:function(){return this._quizModel.get("title")},_getQuizPeriod:function(e){var t=this._quizModel.getTimeZoneId(),n=this._quizModel.getStartAt(),s=this._quizModel.getEndAt(),a=i.isNull(n)?"":o.tz(n,t).format("YYYYMMDD"),r=i.isNull(s)?"":o.tz(s,t).format("YYYYMMDD"),l=a;return e||(e="~"),a&&r?l+=e+r:r&&(l=r),l},_addHeader:function(e){e.push({A:IM("ui.label.title"),B:IM("attachments.excel_download.header.attendance_check.period"),C:IM("stats.total_score")}),e.push({A:this._getQuizTitle(),B:this._getQuizPeriod(),C:this._quizModel.getQuestions().getTotalPoints()})},_addGradingResult:function(e){e.push({A:IM("web.common.members"),B:IM("stats.score"),C:IM("post_quiz.answer_date")}),this._quizModel.getTakers().each((function(t){var n=IM("post_quiz.not_graded");i.isUndefined(t.get("takerPointTotal"))||-1==[r.GRADED_STATE.OPENED,r.GRADED_STATE.FINISHED].indexOf(t.get("gradedState"))||(n=t.get("takerPointTotal")),e.push({A:t.get("taker").getMemberProfile().name,B:n,C:i.isUndefined(t.get("takenAt"))?"":s.format.date(t.get("takenAt"),"short_date_time")})}))},_buildSheetData:function(e){this._bandCore=e.bandCore,this._quizModel=e.quizModel;var t=["A","B","C"],n=[];return this._addHeader(n),a.addBlankRow(n,t),this._addGradingResult(n),{filename:this._makeFileName(),sheetData:n,opts:{header:t}}}};t.downloadGradingResult=function(e,t){var n=l._buildSheetData({bandCore:e,quizModel:t});a.downloadAsExcelFile({sheets:[{data:n.sheetData,opts:{header:n.opts.header,skipHeader:!0}}],filename:n.filename})}},function(e,t,n){var i=n(4),o=n(2635),s=n(618),a=n(720),r=i.View.extend({options:{bandCore:null},tagName:"LI",className:"tLine flexList",attributes:{"data-viewname":"DPostQuizNotTakenTakerListItemView"},template:_.template(o),templateContext:function(){return{taker:this.model.get("taker").toJSON()}},ui:{openChat:"._openChat"},events:{"click @ui.openChat":function(){a.startChattingWithUsers([this.model.get("taker").toJSON()],this.options.bandCore.bandNo)}},regions:{profileImage:{el:"._profileImage",replaceElement:!0}},onRender:function(){var e=this.model.get("taker");this.showChildView("profileImage",s.buildContentCreatorProfileImageView({memberProfile:e.getMemberProfile(),bandCore:this.options.bandCore,userNoOrMemberKey:this.model.get("taker").getUserNo()}))}});e.exports=r},function(e,t){e.exports='<span class="thumb">\n    <span class="_profileImage"></span>\n</span>\n\n<span class="text">\n    <span class="ellipsis"><%-taker.name %></span>\n    <span class="sub2 -ellipsis"><%- taker.desc %></span>\n</span>\n\n<span class="etc">\n    <button type="button" class="buttonChatting _openChat">\n        <span class="gSrOnly"><%-IM("chat.btn.private_chat")%></span>\n            <svg class="svgIcon sf_color" aria-hidden="true">\n            <use xlink:href="#ico-chat"></use>\n        </svg>\n    </button>\n</span>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2637),s=n(486),a={CANCEL:"CANCEL",CONFIRM:"CONFIRM"},r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DQuizGradeOpenConfirmView"},template:t.template(o),ui:{radioReviewEnabled:"input[name=reviewEnabled]",btnCancel:"._btnCancel",btnConfirm:"._btnConfirm"},events:{"click @ui.btnCancel":function(e){this.trigger(a.CANCEL),this.destroy()},"click @ui.btnConfirm":function(e){var t=this.getUI("radioReviewEnabled").filter(":checked").val();this.trigger(a.CONFIRM,t),this.destroy()}}});return r.EVENTS=a,r.openLayer=function(){var e=new r;return s.openWithoutHiding(e),e},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent" style="width: 400px">\n    <header class="modalHeader">\n        <h1 class="title"><%= IM(\'post.quiz.takers.open_quiz_grade.btn\') %></h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap">\n            <p class="sDesc gFs14 gMat18 gPab18 -bLine"><%= IM(\'quiz.open_grade_confirm.description\') %></p>\n            <ul class="listLine">\n                <li class="tLine flexList">\n                    <div class="text">\n                        <span class="gFs14 gColorBk1"><%= IM(\'quiz.open_grade_confirm.open_without_review.title\') %></span>\n                        <span class="sub2"><%= IM(\'quiz.open_grade_confirm.open_without_review.desc\') %></span>\n                    </div>\n                    <span class="etc">\n                        <span class="uCheck -checkbox -noLabel">\n                            <input type="radio" id="oepnWithoutReview" name="reviewEnabled" class="checkInput" value="false" checked>\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                            </span>\n                        </span>\n                    </span>\n                </li>\n                <li class="tLine flexList">\n                    <div class="text">\n                        <span class="gFs14 gColorBk1"><%= IM(\'quiz.open_grade_confirm.open_with_review.title\') %></span>\n                        <span class="sub2"><%= IM(\'quiz.open_grade_confirm.open_with_review.desc\') %></span>\n                    </div>\n                    <span class="etc">\n                        <span class="uCheck -checkbox -noLabel">\n                            <input type="radio" id="oepnAfterReview" name="reviewEnabled" class="checkInput" value="true">\n                            <span class="checkLabel">\n                                <span class="shape"></span>\n                            </span>\n                        </span>\n                    </span>\n                </li>\n            </ul>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -cancel _btnCancel"><%= IM(\'ui.label.cancel\') %></button>\n        <button type="button" class="uButton -confirm _btnConfirm"><%= IM(\'ui.label.confirm\') %></button>\n    </footer>\n</div>'},function(e,t){e.exports='<div class="sPostQuizStats">\n    <div class="inner">\n        <header class="header">\n            <div class="titleWrap">\n                <h1 class="title"><%- quizTitle %></h1>\n                <p class="period"><%- quizPeriod %></p>\n            </div>\n\n\n            <div class="btnWrap">\n                <button type="button" class="btnQuizExcelDownload _btnQuizExcelDownload"><%- IM(\'ui.label.excel_download\') %></button>\n            </div>\n        </header>\n\n        <main class="main">\n            <h2 class="title"><%- IM(\'stats.total_respondents\') %> : <%- IM(\'stats.takers_total\', {takers: takersTotal}) %></h2>\n\n            <table class="table">\n                <tr>\n                    <th class="th" scope="col"><%- IM(\'stats.average\') %></th>\n                    <th class="th" scope="col"><%- IM(\'stats.median\') %></th>\n                    <th class="th" scope="col"><%- IM(\'stats.total_score\') %></th>\n                </tr>\n                <tr>\n                    <td class="td"><%- IM(\'quiz.taker_point\', {point: \'\' + printNumValue(takersPointAverage)}) %></td>\n                    <td class="td"><%- IM(\'quiz.taker_point\', {point: \'\' + takersPointMedian}) %></td>\n                    <td class="td"><%- IM(\'quiz.taker_point\', {point: \'\' + pointTotal}) %></td>\n                </tr>\n            </table>\n\n            <h2 class="title -bLine"><%- IM(\'stats.score_range\') %> : <%- IM(\'stats.score_range.value\', {value: takerPointMin + \'~\' + takerPointMax}) %></h2>\n\n            <div class="graphWrap">\n                <div class="_graph"></div>\n                <p class="legend">X : <%- IM(\'stats.score\') %>, Y : <%- IM(\'stats.number_of_people2\') %></p>\n            </div>\n\n            <h2 class="title gMat30"><%- IM(\'stats.summary_by_question\') %> : <%- IM(\'stats.total_questions_count\', {count: answerSummaries.length}) %></h2>\n\n            <ul class="questionsList">\n                <% _.each(answerSummaries, function(value, index) { %>\n                <li class="li">\n                    <div class="index"><%- index + 1 %>.</div>\n                    <div class="content">\n                        <p class="qTitle"><%- value.title %></p>\n                        <div class="info">\n                            <span class="score"><%- IM(\'stats.point\') %> <%- value.point %> / <%- IM(\'stats.average\') %> <%- printNumValue(value.average) %></span>\n                            <span class="dot"></span>\n                            <span class="incorrect"><%- IM(\'stats.incorrect_answer_rate\') %> <%- printNumValue(value.incorrectAnswerPercentage) %>%</span>\n                        </div>\n                    </div>\n\n                    <%\n                    var question = quizQuestions[index];\n                    if (question && (question.image || question.video || question.audio || question.file)) {\n                    %>\n                    <div class="thum">\n                        <% if (question.image) { %>\n                        <img src="<%- makeThumb(question.image.url) %>" class="img" width="60" height="60" alt="<%= IM(\'ui.label.photo\') %>">\n                        <% } else if (question.video) { %>\n                        <img src="<%- makeThumb(question.video.url) %>" class="img" width="60" height="60" alt="">\n                        <span class="iconPlay"><span class="gSrOnly"><%= IM(\'ui.label.video\') %></span></span>\n                        <% } else if (question.audio) { %>\n                        <span class="iconVoice"><span class="gSrOnly"><%= IM(\'ui.label.audio\') %></span></span>\n                        <% } else if (question.file) { %>\n                        <span class="iconFile"><span class="gSrOnly"><%= IM(\'ui.label.file\') %></span></span>\n                        <% } %>\n                    </div>\n                    <% } %>\n                </li>\n                <% }); %>\n            </ul>\n        </main>\n    </div>\n</div>'},function(e,t,n){var i=n(0),o=n(1098),s={_makeFileName:function(){var e=[this._bandData.getBandName(),IM("stats.quiz_stats_label"),this._quizModel.get("quiz").get("title")],t=this._quizModel.getQuizPeriod("_","YYYYMMDD");return t&&e.push(t),e.join("_")},_getQuestionType:function(e){return"multiple_choice"===e?IM("post.quiz.stats.question_type.multiple_choice"):IM("post.quiz.stats.question_type.essay")},_addScoreRangeDetails:function(e){e.push({A:IM("stats.score_range.detail"),B:IM("stats.score"),C:IM("stats.number_of_people"),D:"",E:"",F:""});var t=i.countBy(this._quizModel.get("takerPoints"));i.each(t,(function(t,n){e.push({A:"",B:Number(n),C:t,D:"",E:"",F:""})}))},_addStatisticsByQuestion:function(e){e.push({A:IM("stats.stats_by_question"),B:"",C:"",D:"",E:"",F:""}),e.push({A:IM("stats.question_number"),B:IM("stats.type"),C:IM("stats.point"),D:IM("stats.average_score"),E:IM("stats.incorrect_answer_rate"),F:IM("stats.question_content")});var t=this._quizModel.get("quiz").get("questions").toJSON();i.each(this._quizModel.get("answerSummaries"),i.bind((function(n,i){var o=this._getAttachedFileTypeLabel(t[i]),s=n.title+(o?"("+o+")":"");e.push({A:i+1,B:t[i]?this._getQuestionType(t[i].type):"",C:n.point,D:Number(this._printNumValue(n.average)),E:this._printNumValue(n.incorrectAnswerPercentage)+"%",F:s})}),this))},_getAttachedFileTypeLabel:function(e){return e.image?IM("ui.label.photo"):e.video?IM("ui.label.video"):e.audio?IM("ui.label.audio"):e.file?IM("ui.label.file"):""},_printNumValue:function(e){return e===parseInt(e)?e:e.toFixed(1)},_addScoreRange:function(e){e.push({A:IM("stats.score_range"),B:this._quizModel.get("takerPointMin")+"~"+this._quizModel.get("takerPointMax"),C:"",D:"",E:"",F:""})},_buildSheetData:function(e){this._bandData=e.bandData,this._quizModel=e.quizModel;var t=["A","B","C","D","E","F"],n=[];return n.push({A:IM("stats.summary"),B:"",C:"",D:"",E:"",F:""}),n.push({A:IM("stats.total_respondents"),B:this._quizModel.get("takersTotal"),C:"",D:"",E:"",F:""}),n.push({A:IM("stats.average"),B:this._printNumValue(this._quizModel.get("takersPointAverage")),C:"",D:"",E:"",F:""}),n.push({A:IM("stats.median"),B:this._quizModel.get("takersPointMedian"),C:"",D:"",E:"",F:""}),n.push({A:IM("stats.total_score"),B:this._quizModel.get("pointTotal"),C:"",D:"",E:"",F:""}),this._addScoreRange(n),this._addScoreRangeDetails(n),o.addBlankRow(n,t),this._addStatisticsByQuestion(n),{filename:this._makeFileName(),sheetData:n,opts:{header:t}}}};t.excelDownload=function(e){var t=s._buildSheetData({bandData:e.bandData,quizModel:e.quizModel});o.downloadAsExcelFile({sheets:[{data:t.sheetData,opts:{header:t.opts.header,skipHeader:!0}}],filename:t.filename})}},function(e,t,n){var i=n(6),o=n(52),s=n(742),a=n(16),r=n(658),l=i.Model.extend({defaults:function(){return{dataFetched:!1,takersTotal:null,answerSummaries:null,pointTotal:null,takerPoints:null,takersPointMedian:null,takersPointAverage:null,takerPointMin:null,takerPointMax:null,quiz:null}},parse:function(e,t){t=o.camelizeKeys(t);var n=this._getScoreRangeMinMax(t.takerPoints);return{dataFetched:!0,takersTotal:t.takersTotal,answerSummaries:t.answerSummaries,pointTotal:t.pointTotal,takerPoints:t.takerPoints,takersPointMedian:t.takersPointMedian,takersPointAverage:t.takersPointAverage,takerPointMin:n.min,takerPointMax:n.max,quiz:new r(e,{parse:!0})}},initialize:function(e,t){this._bandNo=t.bandNo,this._postNo=t.postNo,this._quizId=t.quizId},getPostQuizStats:function(){return s.getQuizStatistics(this._bandNo,this._postNo,this._quizId).then(_.bind((function(e){return this.set(this.parse(e.quiz,e.stats)),this}),this))},getDataFetched:function(){return this.get("dataFetched")},getQuizPeriod:function(e,t){var n=this.get("quiz"),i=n.getTimeZoneId(),o=n.getStartAt(),s=n.getEndAt(),r=_.isNull(o)?"":a.tz(o,i).format(t),l=_.isNull(s)?"":a.tz(s,i).format(t),c=r;return r&&l?c+=e+l:l&&(c=l),c},_getScoreRangeMinMax:function(e){return _.isEmpty(e)?"":(e=_.countBy(e)).length<2?_.keys(e)[0]:{min:_.keys(e)[0],max:_.keys(e).pop()}}});e.exports=l},function(e,t){e.exports='<div class="item -survey">\n    <div class="addHead">\n        <p class="addStatus">\n            <svg class="svgIcon ico-survey sf_color" aria-hidden="true">\n                <use xlink:href="<% if (!showDetail) { %>#ico-attach-survey-24<% } else { %>#ico-attach-survey<% } %>"></use>\n            </svg>\n            <span class="status sf_color"><%-IM("post.survey.title")%></span> <em><%-surveyeeCountText %></em>\n        </p>\n        <p class="addTitle"><%- title %></p>\n        <% if (remainingTime) { %>\n        <div class="addStatus"><time class="deadline sf_color gMat3"><%- remainingTime %></time></div>\n        <% } %>\n\n        <% if (!showDetail && moreCount) { %>\n        <p class="guideText"><%- IM(\'post.survey.more_in_post\', {count: moreCount}) %></p>\n        <% } %>\n\n        <% if (showNotSurveyRelated) { %>\n        \x3c!-- 이 설문의 참여 대상이 아닙니다 --\x3e\n        <div class="addStatus"><p class="statusDesc gColorBk1"><%-IM("post.survey.not_surveyee.msg")%></p></div>\n        <% } %>\n        <% if (showDetail && showManagerActions) { %>\n        <div class="headButtonBox">\n            \x3c!-- 응답자 보기 --\x3e\n            <button type="button" class="button _btnOpenSurveyeeList"><%-IM("post.survey.open_surveyee_list.btn")%></button>\n\n            \x3c!-- 설문 보기, 참여하기, 내 답변 보기 --\x3e\n            <button type="button" class="button _btnOpenSurveyeeDetail"><%- openSurveyeeDetailButtonLabel %></button>\n        </div>\n        <% } %>\n    </div>\n    <% if (showDetail && (showEndSurvey || showSurveyeeDetailAtBottom)) { %>\n    <div class="addDetail">\n        <% if (showEndSurvey) { %>\n        \x3c!-- 종료하기 --\x3e\n        <div class="detailButtonBox -borderTop">\n            <button class="uButton -sizeL -close sf_color sf_tBorder _btnEndSurvey">\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-end-check"></use>\n                </svg>\n                <%-IM("post.survey.end_survey.btn") %>\n            </button>\n        </div>\n        <% } %>\n        \x3c!--        설문은 종료하기와 참여하기가 둘다 가능한 경우가 있으므로 --\x3e\n        \x3c!--        종료하기가 가능한 사용자의 경우 여기서 참여하기를 노출하지 않고 --\x3e\n        \x3c!--        상단 \'설문보기\' 버튼 영역을 \'참여하기\' 버튼으로 바꿔 대신 노출한다.--\x3e\n        <% if (showSurveyeeDetailAtBottom) { %>\n        \x3c!-- [D] 답변 제출 가능한 경우 --\x3e\n        <div class="detailButtonBox -borderTop">\n            <button class="uButton -sizeL -close sf_color sf_tBorder _btnOpenSurveyeeDetail">\n                <svg class="svgIcon" aria-hidden="true">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ico-end-check"></use>\n                </svg>\n                <%- openSurveyeeDetailButtonLabel %>\n            </button>\n        </div>\n        <% } %>\n    </div>\n    <% } %>\n</div>'},function(e,t,n){var i=n(10),o=n(4),s=n(2643),a=n(602),r=n(486),l=n(2644),c=n(2646),d=n(1621),u=n(720),h=n(780),p=n(1004),m=n(13),g=n(2063),f=n(889),b=n(26),v=n(2660),A=n(562),E=function(e){return!e.get("respondedAt")},T=function(e){return!E(e)},C=function(e){return e.get("surveyee").get("name")},y=function(e){return-e.get("respondedAt")},M="RESPONDED",I="NOT_RESPONDED",S={DOWNLOAD_ANSWERS:{id:"DOWNLOAD_ANSWERS",title:IM("post.survey.download_answer")}},w=o.CollectionView.extend({tagName:"UL",className:"listLine rScroll -lrSpace",childViewOptions:function(){return{bandCore:this.options.bandCore,surveyModel:this.options.surveyModel}},changeSortAndFilter:function(e,t){this.viewComparator=e.comparator,this.filter=t?function(n){return e.filter(n)&&i.include(n.get("surveyee").get("name").toLowerCase(),t.toLowerCase())}:e.filter,this.resortView()}}),N=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DPostSurveySurveyeeListLayerView"},initialize:function(){this._comparator=C,this._currentTab=M,this.listenTo(b.getDGlobalChannel(),b.EVENT.HTML_CLICK,this._hideAllLayer)},template:_.template(s),templateContext:function(){return{vid:this.cid}},ui:{btnMoreOption:"._btnMoreOption",moreOptionListRegion:"._moreOptionListRegion",searchForm:"._searchForm",searchInput:"._searchInput",searchBtn:"._searchBtn",wrapSelectFilter:"._wrapSelectFilter",selectFilter:"._selectFilter",btnClose:"._btnClose",headerMoreBox:"._headerMoreBox",searchedSurveyeeCount:"._searchedSurveyeeCount",wrapMemberListStatus:"._wrapMemberListStatus",wrapTabResponded:"._wrapTabResponded",wrapTabNotResponded:"._wrapTabNotResponded",btnTabResponded:"._btnTabResponded",btnTabNotResponded:"._btnTabNotResponded",noMember:"._noMember",btnOpenStats:"._btnOpenStats",btnChatWithMembers:"._btnChatWithMembers"},events:{"click @ui.btnClose":"destroy","click @ui.btnMoreOption":function(e){e.stopPropagation(),this.getRegion("moreOptionListRegion").hasView()?this._hideMoreOptionList():(b.getDGlobalChannel().trigger(b.EVENT.HTML_CLICK),this._showMoreOptionList())},"click @ui.btnTabResponded":"_changeTabResponded","click @ui.btnTabNotResponded":"_changeTabNotResponded","change @ui.selectFilter":function(){"sortByName"===this.getUI("selectFilter").val()?this._comparator=C:this._comparator=y,this._renderUIs()},"input @ui.searchInput":function(){this._toggleSearchBtn(),""===this.ui.searchInput.val()&&this._renderUIs()},"submit @ui.searchForm":function(e){e.preventDefault(),this._renderUIs()},"click @ui.btnChatWithMembers":"_openChatWithMembers","click @ui.btnOpenStats":function(){this.model.isRespondedMemberExist()&&g.openWindowSurveyStats(this.options.bandData.getBandCore(),this.model.get("postNo"),this.model.get("surveyId"))}},regions:{moreOptionListRegion:"@ui.moreOptionListRegion",list:{el:"._list",replaceElement:!0}},modelEvents:{change:"_renderUIs"},onRender:function(){this._renderUIs()},_hideAllLayer:function(){this._hideMoreOptionList()},_showMoreOptionList:function(){this.getUI("moreOptionListRegion").addClass("menuBox");var e=this.getRegion("moreOptionListRegion");if(!e.hasView()){var t=f.build([S.DOWNLOAD_ANSWERS],{listClass:"menuList",listItemClass:"menuItem",btnClass:"btnMenuText"});this.listenToOnce(t,f.EVENTS.MENU_SELECTED,(function(e){switch(e){case S.DOWNLOAD_ANSWERS.id:this._downloadAnswers()}})),e.show(t)}},_hideMoreOptionList:function(){this.getUI("moreOptionListRegion").removeClass("menuBox");var e=this.getRegion("moreOptionListRegion");e.hasView()&&e.empty()},_downloadAnswers:function(){this.model.isRespondedMemberExist()?v.download(this.options.bandData,this.model):A.openLayer({bodyTitle:IM("post_quiz.unable_to_download_grading_result"),withoutHiding:!0})},_toggleSearchBtn:function(){var e=i.isBlank(this.ui.searchInput.val());this.ui.searchBtn.prop("disabled",e).toggleClass("-disabled",e).toggleClass("-active",!e)},_renderUIs:function(){this._currentTab===M?(this.getUI("wrapTabResponded").addClass("-on"),this.getUI("wrapTabNotResponded").removeClass("-on")):(this.getUI("wrapTabResponded").removeClass("-on"),this.getUI("wrapTabNotResponded").addClass("-on")),this._toggleSearchBtn(),this._renderList(),this.getUI("btnOpenStats").toggleClass("gHide",!(this._currentTab===M&&this.model.isRespondedMemberExist())),this.getUI("btnChatWithMembers").toggleClass("gHide",!(this._currentTab===I&&this.getChildView("list")&&this.getChildView("list").children.length>0))},_renderList:function(){if(this._currentTab!==I||this.model.getSurveyListCollection().isNonResponseIncluded()){this.showChildView("list",new w({childView:this._currentTab===M?l:c,collection:this.model.getSurveyListCollection(),bandCore:this.options.bandData.getBandCore(),surveyModel:this.model}));var e=this.getUI("searchInput").val();this.getChildView("list").changeSortAndFilter({comparator:this._comparator,filter:this._currentTab===M?T:E},e),this.getUI("searchedSurveyeeCount").html(IM("web.bandjoin.label.member_count",{count:String(this.getChildView("list").children.length)})),this.getChildView("list").children.length>0?(this.getChildView("list").$el.show(),this.getUI("noMember").css("display","none"),this.getUI("wrapMemberListStatus").show()):this._drawListEmpty(IM("post.read_user_list.message.empty_list"))}else this._drawListEmpty(IM("post.survey.surveyee_list.can_access_not_responded_surveyees"));this._currentTab===M&&this.model.getSurveyListCollection().isNonResponseIncluded()?(this.getUI("wrapSelectFilter").show(),this.getUI("selectFilter").html(d({selectedValue:this._comparator===C?"sortByName":"sortByRespondedAt",options:[{value:"sortByName",text:IM("post.survey.surveyee_list.sort.option.by_name")},{value:"sortByRespondedAt",text:IM("post.survey.surveyee_list.sort.option.by_responded_at")}]}))):this.getUI("wrapSelectFilter").hide()},_drawListEmpty:function(e){this.getRegion("list").empty(),this.getRegion("list").$el.hide(),this.getUI("noMember").css("display",""),this.getUI("noMember").find("span").html(e),this.getUI("wrapMemberListStatus").hide()},_changeTabNotResponded:function(){this.getUI("searchInput").val(""),this._currentTab=I,this._comparator=C,this._renderUIs()},_changeTabResponded:function(){this.getUI("searchInput").val(""),this._currentTab=M,this._comparator=C,this._renderUIs()},_openChatWithMembers:function(){var e=this.model.getSurveyListCollection().filter(E),t=_.chain(e).filter((function(e){return!m.isMe(e.get("surveyee").getUserNo())})).map((function(e){return new h(e.get("surveyee").toJSON(),{parse:!0})})).value(),n=p.openAsLayer(this.options.bandData,new Backbone.Collection(t,{parse:!0}));this.listenTo(n,"member:selected",(function(e){var t=e.map((function(e){return e.pick("userNo","name")}));u.startChattingWithUsers(t,this.options.bandData.getBandNo())}))}});N.openLayer=function(e){var t=a.createSurveyModel(e.bandData.getBandCore().bandNo,e.surveyModel.get("postNo"),e.surveyModel.get("surveyId"));t.fetchSurveyModelWithSurveyeeList();var n=new N({bandData:e.bandData,model:t});return r.openWithoutHiding(n),n},e.exports=N},function(e,t){e.exports='<div class="lyContent -w480">\n    <header class="modalHeader">\n        <h1 class="title"><%-IM("post.survey.surveyee_list.title") %></h1>\n        <div class="moreMenuWrap">\n            <button class="btnMoreMenu _btnMoreOption"><%- IM(\'ui.label.more.short\') %></button>\n            <div class="_moreOptionListRegion">\n        </div>\n    </header>\n\n    <div class="modalBody">\n        <div class="modalContentWrap gPal0 gPar0">\n\n            <div class="tab">\n                <span class="cell sf_color _wrapTabResponded"><button type="button" class="_btnTabResponded"><%-IM("post.survey.surveyee_list.tab.responded.label")%></button></span>\n                <span class="cell sf_color _wrapTabNotResponded"><button type="button" class="_btnTabNotResponded"><%-IM("post.survey.surveyee_list.tab.not_responded.label")%></button></span>\n            </div>\n\n            <div class="memberListBox">\n                <form class="searchWrap _searchForm">\n                    <label for="searchMember_<%-vid%>" class="searchIcon"><span class="gSrOnly"><%-IM("web.bandmember.search_member")%></span></label>\n\n                    <span class="inputWrap">\n                        <input type="search" id="searchMember_<%-vid%>" class="inputSearch _searchInput" placeholder="<%-IM(\'band_member_select.label.name\')%>">\n    \t\t\t\t</span>\n\n                    <button type="submit" class="btnSearch uButton -sizeS -default _searchBtn"><%-IM("ui.label.search")%></button>\n                </form>\n                <div class="buttonMemberChatBox">\n                    \x3c!-- [D] 설문 통계 확인하기 버튼 --\x3e\n                    <button type="button" class="buttonMemberChat -arrow -borderBottom _btnOpenStats"><span class="iconStatisticsGraph"></span><span class="text"><%- IM(\'post.survey.surveyee_list.view_stats\') %></span></button>\n                    \x3c!-- [D] 미응답 탭에 노출 --\x3e\n                    <button type="button" class="buttonMemberChat -arrow -borderBottom _btnChatWithMembers"><span class="iconChatPlus"></span><span class="text"><%-IM("ui.label.chat_with_following_members")%></span></button>\n                </div>\n\n                <div class="memberListStatusBar _wrapMemberListStatus">\n                    <p class="count _searchedSurveyeeCount"></p>\n\n                    <div class="uSelect -textType -taR -sizeS _wrapSelectFilter">\n                        <label for="filter_<%-vid%>" class="gSrOnly"><%-IM("post.survey.surveyee_list.sort.label") %></label>\n                        <select id="filter_<%-vid%>" class="_selectFilter"></select>\n                    </div>\n                </div>\n\n                <div class="_list"></div>\n                <div class="uEmpty -h400 _noMember" style="display: none;">\n                    <span><%-IM("post.read_user_list.message.empty_list")%></span>\n                </div>\n            </div>\n        </div>\n\n    </div>\n\n    <footer class="modalFooter -tLine gMal0 gMar0">\n        <button type="button" class="uButton -confirm _btnClose"><%-IM("ui.label.confirm")%></button>\n    </footer>\n</div>'},function(e,t,n){var i=n(4),o=n(2645),s=n(9),a=n(618),r=n(168),l=n(553),c=i.View.extend({options:{bandCore:null,surveyModel:null},tagName:"LI",className:"tLine flexList",attributes:{"data-viewname":"DPostSurveySurveyeeListItemView"},template:_.template(o),templateContext:function(){return{surveyee:this.model.get("surveyee").toJSON(),respondedTime:this.model.get("respondedAt")&&s.format.date(this.model.get("respondedAt"),"short_date_time"),respondedISOTime:this.model.get("respondedAt")?new Date(this.model.get("respondedAt")).toISOString():""}},ui:{btnOpenSurveyManagerDetail:"._btnOpenSurveyManagerDetail"},events:{"click @ui.btnOpenSurveyManagerDetail":function(){r.getMemberKeyByUserNo(this.options.bandCore.bandNo,this.model.get("surveyee").getUserNo()).then(_.bind((function(e){var t=this.options.bandCore,n=this.options.surveyModel.get("postNo"),i=this.options.surveyModel.get("surveyId");window.open(l.surveyManagerDetail(t,n,i,e).url)}),this))}},regions:{profileImage:{el:"._profileImage",replaceElement:!0}},onRender:function(){var e=this.model.get("surveyee");this.showChildView("profileImage",a.buildContentCreatorProfileImageView({memberProfile:e.getMemberProfile(),bandCore:this.options.bandCore,userNoOrMemberKey:this.model.get("surveyee").getUserNo()}))}});e.exports=c},function(e,t){e.exports='<span class="thumb">\n    <span class="_profileImage"></span>\n</span>\n\n<span class="text">\n    <span class="ellipsis"><%-surveyee.name %></span>\n    <time class="blockTime gMat2 gColorGr1" datetime="<%-respondedISOTime%>"><%-respondedTime %></time>\n</span>\n\n<span class="etc">\n    <button class="uButton -sizeS -confirm2 _btnOpenSurveyManagerDetail"><%-IM("post.survey.surveyee_list.open_surveyee_answer.btn")%></button>\n</span>'},function(e,t,n){var i=n(4),o=n(2647),s=n(618),a=n(720),r=n(13),l=i.View.extend({options:{bandCore:null},tagName:"LI",className:"tLine flexList",attributes:{"data-viewname":"DPostSurveyNotRespondedSurveyeeListItemView"},template:_.template(o),templateContext:function(){return{surveyee:this.model.get("surveyee").toJSON(),showOpenChat:!r.isMe(this.model.get("surveyee").getUserNo())}},ui:{openChat:"._openChat"},events:{"click @ui.openChat":function(){a.startChattingWithUsers([this.model.get("surveyee").toJSON()],this.options.bandCore.bandNo)}},regions:{profileImage:{el:"._profileImage",replaceElement:!0}},onRender:function(){var e=this.model.get("surveyee");this.showChildView("profileImage",s.buildContentCreatorProfileImageView({memberProfile:e.getMemberProfile(),bandCore:this.options.bandCore,userNoOrMemberKey:this.model.get("surveyee").getUserNo()}))}});e.exports=l},function(e,t){e.exports='<span class="thumb">\n    <span class="_profileImage"></span>\n</span>\n\n<span class="text">\n    <span class="ellipsis"><%-surveyee.name %></span>\n    <span class="sub2 -ellipsis"><%- surveyee.desc %></span>\n</span>\n\n<span class="etc">\n    <% if (showOpenChat) { %>\n    <button type="button" class="buttonChatting _openChat">\n        <span class="gSrOnly"><%-IM("chat.btn.private_chat")%></span>\n            <svg class="svgIcon sf_color" aria-hidden="true">\n            <use xlink:href="#ico-chat"></use>\n        </svg>\n    </button>\n    <% } %>\n</span>'},function(e,t){e.exports='<div class="sPostQuizStats">\n    <div class="inner">\n        <header class="header">\n            <div class="titleWrap">\n                <h1 class="title"><%- title %></h1>\n                <p class="surveyStatus">\n                    <span class="respondent">\n                        <%= IM(\'stats.respondents\') %> : <%= IM(\'stats.respondents_count\', {count: \'\' + respondedMemberCount}) %>\n                        <% if(isSurveyeeQualified) { %>\n                        (<%= IM(\'stats.total_respondents_count\', {count: \'\' + surveyees.length}) %>)\n                        <% } %>\n                    </span><span class="period"><%- surveyPeriod %></span>\n                </p>\n            </div>\n\n            <div class="btnWrap">\n                <button type="button" class="btnQuizExcelDownload _btnSurveyExcelDownload"><%- IM(\'ui.label.excel_download\') %></button>\n            </div>\n        </header>\n\n        <main class="sQuestionsContent">\n            <div class="_contentRegion"></div>\n            <% // IO 디텍팅용 %>\n            <div class="_questionsContentBottom"></div>\n        </main>\n    </div>\n</div>\n\n<div class="_statsDataLoadingProgressRegion"></div>'},function(e,t,n){var i=n(0),o=n(1098),s=n(16),a=function(e,t,n){this._surveyModel=this._surveyModel||n;var o=this._surveyModel.get("timeZoneId"),a=this._surveyModel.get("startAt"),r=this._surveyModel.get("endAt"),l=i.isNull(a)?"":s.tz(a,o).format(t),c=i.isNull(r)?"":s.tz(r,o).format(t),d=l;return l&&c?d+=e+c:c&&(d=c),d},r=function(e,t){var n=[e.getBandName(),IM("stats.survey_stats_label"),t.get("title")],i=a("_","YYYYMMDD",t);return i&&n.push(i),n.join("_")},l={_getQuestionType:function(e){return e.isMultipleChoiceType()?IM("post.quiz.stats.question_type.multiple_choice"):IM("post.quiz.stats.question_type.essay")},_addStatisticsByQuestion:function(e){e.push({A:IM("stats.stats_by_question"),B:"",C:"",D:"",E:"",F:""}),e.push({A:IM("stats.question_number"),B:IM("stats.type"),C:IM("stats.question_content"),D:IM("stats.items"),E:IM("stats.respondents"),F:IM("stats.ratio")}),this._surveyModel.getQuestions().each(i.bind((function(t,n){var o=t.get("stats"),s=t.isEssayType()?o.getEssaySummaries():o.getOriginChoiceSummaries(),a=t.getChoices();t.isEssayType()||(s=s.reject((function(e){return i.isNull(e.get("choiceId"))})),s=new Backbone.Collection(s)),t.isEssayType()&&s.isEmpty()?e.push({A:n+1,B:this._getQuestionType(t),C:this._getQuestionTitleTxt(t),D:"",E:"",F:""}):(s.each(i.bind((function(i,s){var r="",l="",c="",d="",u="",h="";0===s&&(r=n+1,l=this._getQuestionType(t),c=this._getQuestionTitleTxt(t)),t.isEssayType()?d=this._getEssayItemTxt(o.getEssaySummaries().at(s)):(d=this._getChoiceItemTxt(a.get(i.get("choiceId")),s),u=Number(o.getChoiceChoosenCount(s,!1)),h=o.getChoiceChoosenPercentage(u)),e.push({A:r,B:l,C:c,D:d,E:u,F:h})}),this)),t.isEssayType()||0===o.getOtherChoiceCount()||(e.push({A:"",B:"",C:"",D:"("+(s.length+1)+") "+IM("stats.survey.other_choices.label"),E:"",F:""}),o.getOtherChoices().each(i.bind((function(t,n){e.push({A:"",B:"",C:"",D:t.get("otherChoiceContent"),E:"",F:""})}),this))))}),this))},_getQuestionTitleTxt:function(e){var t=[e.getTitle()];return e.getImage()&&t.push("("+IM("ui.label.photo")+")"),t.join(" ")},_getChoiceItemTxt:function(e,t){var n=["("+(t+1)+")",e.getTitle()];return e.getImage()&&n.push("("+IM("ui.label.photo")+")"),n.join(" ")},_getEssayItemTxt:function(e){var t=e.get("essay"),n=[t.content];return t.file&&n.push("("+IM("file")+")"),t.images&&n.push("("+IM("ui.label.photo")+")"),n.join(" ")},_printNumValue:function(e){return e===parseInt(e)?e:e.toFixed(1)},_buildSheetData:function(e){this._bandData=e.bandData,this._surveyModel=e.surveyModel;var t=["A","B","C","D","E","F"],n=[];return n.push({A:IM("stats.summary"),B:"",C:"",D:"",E:"",F:""}),n.push({A:IM("stats.total_respondents"),B:this._surveyModel.get("respondedMemberCount"),C:"",D:"",E:"",F:""}),o.addBlankRow(n,t),this._addStatisticsByQuestion(n),{filename:r(this._bandData,this._surveyModel),sheetData:n,opts:{header:t}}}};t.makeFileName=r,t.getSurveyPeriod=a,t.excelDownload=function(e){var t=l._buildSheetData({bandData:e.bandData,surveyModel:e.surveyModel});o.downloadAsExcelFile({sheets:[{data:t.sheetData,opts:{header:t.opts.header,skipHeader:!0},cols:i.pluck(o.makeMaxColumnWidthData(t.sheetData,t.opts.header,100),"wch")}],filename:t.filename})}},function(e,t,n){var i;void 0===(i=function(e){n(0);var t=n(4),i=n(2651),o=t.CollectionView.extend({tagName:"ul",className:"questionList",attributes:{"data-viewname":"DSurveyStatsQuestionListView"},childView:i,childViewOptions:function(e,t){return{surveyModel:this._surveyModel,questionViewIndex:t}},childViewEvents:function(){var e={};return e[i.EVENT.RENDERED]=function(e){this.trigger(i.EVENT.RENDERED),e>0||this.$el.css("min-height","auto")},e},initialize:function(e){this._surveyModel=e.surveyModel,this.$el.css("min-height",$(window).innerHeight())}});return o.EVENT=i.EVENT,o.buildDSurveyStatsQuestionListView=function(e,t){return new o({collection:t,surveyModel:e})},o}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2652),s=n(82),a=n(156),r=n(486),l=n(611),c=n(2653),d=n(583),u=n(2654),h=n(584),p=n(2656),m={QUESTION:"question",CHOICE:"choice",ESSAY:"essay"},_={RENDERED:"RENDERED"},g=i.View.extend({tagName:"li",className:"questionItem -viewOnly",attributes:{"data-viewname":"DSurveyStatsQuestionListItemView"},getTemplate:function(){return this._dataFetched?t.template(o):t.template('<div class="_loadingRegion"></div>')},templateContext:function(){if(this._dataFetched)return{questionImage:this.model.getImage(),makeBigThumb:function(e){return s.make(e,s.TYPE.e1280_std)},makeSquareThumb:function(e){return s.make(e,s.TYPE.s150)},choices:this.model.getChoices(),stats:this._statsModel,requiredMarkText:this.model.isResponseEssential()?'<span class="requiredMark">*</span>':"",getChoiceSummaries:this._statsModel.getChoiceSummaries(),respondedMemberCount:this._surveyModel.get("respondedMemberCount"),nonresponseCount:this._statsModel.getNonresponseCount(),IMAGE_TYPE:m,isEssayType:this.model.isEssayType(),toStringFileSize:a.toStringFileSize,makeExpirationText:a.makeExpirationText,isExpiredFile:a.isExpiredFile,isDropboxFile:function(e){return"dropbox"===e.externalSource},getChoiceItem:t.bind(this._getChoiceItem,this),CONTENT_LIMIT:20}},ui:{btnImage:"._btnImage",loadingRegion:"._loadingRegion",btnShowDetail:"._btnShowDetail",btnEssayFile:"._btnEssayFile",btnListMore:"._btnListMore"},regions:{loadingRegion:{el:"@ui.loadingRegion",replaceElement:!0}},events:{"click @ui.btnImage":"_onClickBtnImage","click @ui.btnShowDetail":"_onClickShowDetail","click @ui.btnEssayFile":"_onClickBtnEssayFile","click @ui.btnListMore":"_openListMoreView"},serializeData:function(){return this.model.toJSON()},initialize:function(e){this._dataFetched=!1,this._surveyModel=e.surveyModel,this._bandNo=this._surveyModel.get("bandNo"),this._postNo=this._surveyModel.get("postNo"),this._surveyId=this._surveyModel.get("surveyId"),this._questionId=this.model.getQuestionId(),this._questionViewIndex=e.questionViewIndex,this._type=this.model.getType(),this._statsModel=c.createSurveyStatsModel(this._bandNo,this._postNo,this._surveyId,this._questionId,this._surveyModel)},onRender:function(){this._dataFetched||this._renderLoading()},onDomRefresh:function(){this._dataFetched&&this.trigger(_.RENDERED,this._questionViewIndex)},onAttach:function(){this._fetchStats()},_getChoiceItem:function(e){return this.model.getChoices().get(e)},_onClickBtnImage:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget),n=t.data("choiceId"),i=t.data("type"),o=null;i===m.QUESTION?o=[this._convertPhotoViewerData(this.model.getImage())]:i===m.CHOICE&&(o=[this._convertPhotoViewerData(this.model.getChoices().get(n).getImage())]),this._openPhotoViewer(o)},_openPhotoViewer:function(e){var t=l.buildImageViewer({result_data:{photos:e,total_count:e.length}});r.open(t)},_convertPhotoViewerData:function(e){return{photo_url:e.url,width:e.width,height:e.height}},_renderLoading:function(){this.showChildView("loadingRegion",d.buildAsMediumAreaMiddle())},_fetchStats:function(){return this._statsModel.fetchPostSurveyStats().then(t.bind((function(e){this._dataFetched=!0,this.model.set("stats",this._statsModel),this.render()}),this))},_getSummariesListContent:function(){return this.model.isEssayType()?this._statsModel.getEssaySummaries():this._statsModel.getOtherChoices()},_onClickShowDetail:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget).data("index");this._openDetailView(this._getSummariesListContent().at(t))},_openDetailView:function(e){var n=u.openLayerView(e);this.listenTo(n,u.EVENT.FILE_DOWNLOAD,t.bind((function(e){this._fileDownload(e.file,e.surveyeeNo)}),this))},_openListMoreView:function(){var e=this._getSummariesListContent(),n=p.openLayerView(e);this.listenTo(n,p.EVENT.SHOW_DETAIL,t.bind((function(t){this._openDetailView(e.at(t))}),this)),this.listenTo(n,p.EVENT.FILE_DOWNLOAD,t.bind((function(e){this._fileDownload(e.file,e.surveyeeNo)}),this))},_onClickBtnEssayFile:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget).data("index"),n=this._statsModel.getEssaySummaries().at(t);this._fileDownload(n.get("essay").file,n.get("surveyeeNo"))},_fileDownload:function(e,n){e.externalSource?window.open(e.exteranlLink,"_blank"):this._downloading||(this._downloading=!0,h.getFileUrlBySurvey(this._bandNo,this._postNo,this._surveyId,this._questionId,n).then((function(e){window.location.href=e.file_url})).always(t.bind((function(){this._downloading=!1}),this)))}});return g.EVENT=_,g}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="questionTextBox">\n    <div class="questionText">\n        <span class="questionTitle"> <%= requiredMarkText %><%- title %></span>\n        <% if(isMultipleChoicesEnabled) { %>\n        <span class="questionInfo">\n            <span class="multiple"><%= IM(\'quiz.multiple_select.label\') %></span>\n        </span>\n        <% } %>\n    </div>\n</div>\n\n<% if (!!questionImage) { %>\n<div class="questionPhotoBox">\n    <a href="#" role="button" class="thumbnailImg _btnImage" data-type="<%= IMAGE_TYPE.QUESTION %>">\n        <img src="<%= makeBigThumb(questionImage.url) %>" alt="question image">\n    </a>\n</div>\n<% } %>\n\n<div class="optionCheckBox">\n    <div class="checkStatus">\n        <span class="respondent"><%= IM(\'stats.respondents\') %> <%= respondedMemberCount - nonresponseCount %></span>\n        <% if (nonresponseCount > 0) { %>\n        (<%= IM(\'post.quiz.takers.tab.not_taken.label\') %> <%= nonresponseCount %>)\n        <% } %>\n    </div>\n\n    <% if (isEssayType) { %>\n        <div class="commentsBox">\n            <% _.each(stats.getEssaySummaries().slice(0, CONTENT_LIMIT), function(item, index) { %>\n            <div tabindex="0" class="commentItem gCursorPointer _btnShowDetail" data-type="<%= IMAGE_TYPE.ESSAY %>" data-index="<%= index %>">\n                <div class="-flexible">\n                    <%\n                    var images = item.get(\'essay\').images;\n                    if (images && images.length > 0) {\n                    %>\n                    <div class="attachmentPhoto">\n                        <div class="thumbnailImg">\n                            <img src="<%= makeSquareThumb(images[0].url) %>" alt="">\n                            <% if (images.length > 1) { %>\n                            <span class="thumbnailNum">+<%= images.length - 1 %></span>\n                            <% } %>\n                        </div>\n                    </div>\n                    <% } %>\n                    <div class="commentText"><%- item.get(\'essay\').content %></div>\n                </div>\n\n                <%\n                var file = item.get(\'essay\').file;\n                if (!!file) {\n                %>\n                <div class="attachmentFile">\n                    <div class="fileItem">\n                        <button type="button" class="fileName _btnEssayFile" data-type="<%= IMAGE_TYPE.ESSAY %>" data-index="<%= index %>" <%= isExpiredFile(file.expiredAt) ? \'disabled\' : \'\' %>>\n                        <%- file.fileName %>\n                        </button>\n                        <% if (isDropboxFile(file)) { %>\n                        <span class="fileSize">dropbox</span>\n                        <% } else { %>\n                        <span class="fileSize"><%= toStringFileSize(file.fileSize) %></span>\n                        <span class="fileSaveExpire"><%= makeExpirationText(file.expiredAt) %></span>\n                        <% } %>\n                    </div>\n                </div>\n                <% } %>\n            </div>\n            <% }); %>\n\n            <% if (stats.getEssaySummaries().length > CONTENT_LIMIT) { %>\n            <div class="commentItem">\n                <button type="button" class="buttonMore _btnListMore" data-type="<%= IMAGE_TYPE.ESSAY %>"><%= IM(\'web.board.notice.more\') %></button>\n            </div>\n            <% } %>\n        </div>\n    <% } else { %>\n        <%\n        getChoiceSummaries.each(function(statsChoice, index) {\n            var graphPercent;\n            var choiceId = statsChoice.get(\'choiceId\');\n\n            // choiceId가 null 값인건 otherChoiceCount 임 (SurveyStatsModel 참고)\n            if (choiceId !== null) {\n                var choiceItem = getChoiceItem(choiceId);\n                var choiceChoosenCount = stats.getChoiceChoosenCount(index, true);\n                graphPercent = stats.getChoiceChoosenPercentage(choiceChoosenCount);\n        %>\n            <div class="optionCheck">\n                <div class="optionText"><%- choiceItem.getTitle() %></div>\n\n                <% if (!!choiceItem.getImage()) { %>\n                <div class="checkPhoto">\n                    <a href="#" role="button" class="thumbnailImg _btnImage" data-type="<%= IMAGE_TYPE.CHOICE %>" data-choice-id="<%= choiceId %>">\n                        <img src="<%= makeBigThumb(choiceItem.getImage().url) %>" alt="">\n                    </a>\n                </div>\n                <% } %>\n\n                <div class="optionGraph">\n                    <div class="barGraph"><span class="currentGraph" style="width: <%= graphPercent %>"></span></div>\n                    <div class="currentRatio"><%= choiceChoosenCount %>(<%= graphPercent %>)</div>\n                </div>\n            </div>\n        <%\n            } else if (stats.getOtherChoiceCount() > 0) {\n                graphPercent = stats.getChoiceChoosenPercentage(stats.getOtherChoiceCount());\n        %>\n            <div class="optionCheck">\n                <div class="optionText"><%= IM(\'stats.survey.other_choices.label\') %></div>\n                <div class="optionGraph">\n                    <div class="barGraph"><span class="currentGraph" style="width: <%= graphPercent %>"></span></div>\n                    <div class="currentRatio"><%= stats.getOtherChoiceCount() %>(<%= graphPercent %>)</div>\n                </div>\n            </div>\n        <%\n            }\n        });\n        %>\n\n        <% if (stats.getOtherChoices().size() > 0) { %>\n        <div class="optionCheck">\n            <div class="optionText -otherText"><%= IM(\'stats.survey.other_choices.label2\') %></div>\n            <div class="commentsBox">\n                <% _.each(stats.getOtherChoices().slice(0, CONTENT_LIMIT), function(other, index) { %>\n                <div class="commentItem">\n                    <a href="#" role="button" class="commentText _btnShowDetail" data-index="<%= index %>"><%- other.get(\'otherChoiceContent\') %></a>\n                </div>\n                <% }) %>\n\n                <% if (stats.getOtherChoiceCount() > CONTENT_LIMIT) { %>\n                <div class="commentItem">\n                    <button type="button" class="buttonMore _btnListMore" data-type="<%= IMAGE_TYPE.CHOICE %>"><%= IM(\'web.board.notice.more\') %></button>\n                </div>\n                <% } %>\n            </div>\n        </div>\n        <% } %>\n    <% } %>\n</div>'},function(e,t,n){var i=n(6),o=n(52),s=n(584),a=i.Model.extend({defaults:function(){return{questionId:null,essayCount:0,essaySummaries:new i.Collection([]),choiceSummaries:new i.Collection([]),originChoiceSummaries:new i.Collection([]),nonresponseCount:0,otherChoiceCount:0,otherChoices:[],totalChosenCount:0}},parse:function(e){return(e=o.camelizeKeys(e)).otherChoices=_.reject(e.otherChoices,(function(e){return""===e.otherChoiceContent})),e.originChoiceSummaries=new i.Collection(e.choiceSummaries),e.otherChoiceCount>0&&e.choiceSummaries.push({choiceId:null,chosenCount:e.otherChoiceCount}),_.extend(e,{totalChosenCount:this._calcTotalChosenCount(e),choiceSummaries:new i.Collection(e.choiceSummaries,{comparator:function(e){return-e.get("chosenCount")}}),otherChoices:new i.Collection(e.otherChoices,{comparator:function(e){return e.get("otherChoiceContent")}}),essaySummaries:new i.Collection(e.essaySummaries,{comparator:function(e){return e.get("essay").content}})}),e},initialize:function(e,t){this._bandNo=t.bandNo,this._postNo=t.postNo,this._surveyId=t.surveyId,this._questionId=t.questionId,this._surveyModel=t.surveyModel},fetchPostSurveyStats:function(){return s.getSurveyStatistics(this._bandNo,this._postNo,this._surveyId,this._questionId).then(_.bind((function(e){return this.set(this.parse(e)),this._dataFetched=!0,this}),this))},_calcTotalChosenCount:function(e){return _.reduce(e.choiceSummaries,(function(e,t){return e+t.chosenCount}),0)+e.otherChoiceCount},getTotalChosenCount:function(){return this.get("totalChosenCount")},getNonresponseCount:function(){return this.get("nonresponseCount")},getChoiceSummaries:function(){return this.get("choiceSummaries")},getOriginChoiceSummaries:function(){return this.get("originChoiceSummaries")},getOtherChoiceCount:function(){return this.get("otherChoiceCount")},getOtherChoices:function(){return this.get("otherChoices")},getEssayCount:function(){return this.get("essayCount")},getEssaySummaries:function(){return this.get("essaySummaries")},getChoiceChoosenPercentage:function(e){var t=this._surveyModel.get("respondedMemberCount");return 0===e||0===t?"0%":this._printNumValue(e/t*100)+"%"},getChoiceChoosenCount:function(e,t){return(t?this.getChoiceSummaries():this.getOriginChoiceSummaries()).at(e).get("chosenCount")},_printNumValue:function(e){return e===parseInt(e)?e:e.toFixed(1)}});a.createSurveyStatsModel=function(e,t,n,i,o){return new a(void 0,{bandNo:e,postNo:t,surveyId:n,questionId:i,surveyModel:o})},e.exports=a},function(e,t,n){var i=n(0),o=n(4),s=n(486),a=n(2655),r=n(82),l=n(156),c={FILE_DOWNLOAD:"FILE_DOWNLOAD"},d=o.View.extend({attributes:{"data-viewname":"DPostSurveyStatsDetailLayerView"},template:i.template(a),templateContext:function(){var e=this._viewData.get("essay")||{},t=e.file||null;return{makeThumb:function(e){return r.make(e,r.TYPE.e1280_std)},content:e.content||this._viewData.get("otherChoiceContent"),file:t,isDropboxFile:t&&"dropbox"===t.externalSource,isExpiredFile:l.isExpiredFile,toStringFileSize:l.toStringFileSize,makeExpirationText:l.makeExpirationText,images:e.images||null}},ui:{btnConfirm:"._btnConfirm",btnFile:"._btnFile"},events:{"click @ui.btnConfirm":"destroy","click @ui.btnFile":"_onClickEssayFile"},initialize:function(e){this._viewData=e.viewData},_onClickEssayFile:function(){var e=this._viewData.get("essay"),t=e&&e.file,n=this._viewData.get("surveyeeNo");t&&n&&this.trigger(c.FILE_DOWNLOAD,{file:t,surveyeeNo:n})}});d.EVENT=c,d.openLayerView=function(e){var t=new d({viewData:e});return s.open(t),t},e.exports=d},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent" style="width: 600px">\n        <header class="modalHeader">\n            <h1 class="title"><%= IM(\'stats.survey.answer.label\') %></h1>\n        </header>\n\n        <div class="modalBody">\n            <div class="surveyItemDetails">\n                <div class="commentsBox">\n                    <div class="commentItem">\n                        <% if (!!content) { %>\n                        <div class="commentText">\n                            <span class="text"><%- content %></span>\n                        </div>\n                        <% } %>\n\n                        <% if (!!images) { %>\n                            <% _.each(images, function(image) { %>\n                            <div class="attachmentPhoto">\n                                <div class="thumbnailImg">\n                                    <img src="<%= makeThumb(image.url) %>" alt="">\n                                </div>\n                            </div>\n                            <% }); %>\n                        <% } %>\n\n                        <% if (!!file) { %>\n                        <div class="attachmentFile">\n                            <div class="uWidget" data-widget="expanded">\n                                <a href="#"  role="button" class="item -file <%= isExpiredFile(file.expiredAt) ? \'-disabled\' : \'_btnFile\' %>">\n                                    <div class="addHead -downloadL">\n                                        <p class="addStatus">\n                                            <svg class="svgIcon ico-file sf_color" aria-hidden="true">\n                                                <use xlink:href="#ico-attach-file"></use>\n                                            </svg>\n                                            <span class="status sf_color"><%= IM(\'file\') %></span>\n                                        </p>\n                                        <p class="addTitle"><%- file.fileName %></p>\n                                        <p class="addStatus">\n                                            <% if (isDropboxFile) { %>\n                                            <span>dropbox</span>\n                                            <% } else { %>\n                                            <span><%- toStringFileSize(file.fileSize) %></span><span><%- makeExpirationText(file.expiredAt) %></span>\n                                            <% } %>\n                                        </p>\n                                    </div>\n                                </a>\n                            </div>\n                        </div>\n                        <% } %>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <footer class="modalFooter gMar0 gMal0 -tLine">\n            <button type="button" class="uButton -confirm _btnConfirm"><%= IM(\'ui.label.confirm\') %></button>\n            <button type="button" class="btnLyBack uButton -iconLyBack _btnConfirm"><span class="gSrOnly"><%= IM(\'web.bandsetting.bandleave.btn.go_back\') %></span></button>\n        </footer>\n    </div>\n</section>'},function(e,t,n){var i=n(0),o=n(4),s=n(486),a=n(2657),r=n(82),l=n(156),c={FILE_DOWNLOAD:"FILE_DOWNLOAD",SHOW_DETAIL:"SHOW_DETAIL"},d=o.View.extend({attributes:{"data-viewname":"DSurveyStatsListMoreLayerView"},template:i.template(a),templateContext:function(){return{makeThumb:function(e){return r.make(e,r.TYPE.s150)},isDropboxFile:function(e){return e&&"dropbox"===e.externalSource},isExpiredFile:l.isExpiredFile,toStringFileSize:l.toStringFileSize,makeExpirationText:l.makeExpirationText}},ui:{btnClose:"._btnClose",btnFile:"._btnFile",btnShowDetail:"._btnShowDetail"},events:{"click @ui.btnClose":"destroy","click @ui.btnFile":"_onClickEssayFile","click @ui.btnShowDetail":"_onClickShowDetail"},_onClickShowDetail:function(e){var t=$(e.currentTarget).data("index");this.trigger(c.SHOW_DETAIL,t)},_onClickEssayFile:function(e){e.stopPropagation();var t=$(e.currentTarget).data("index"),n=this.collection.at(t),i=n.get("essay")&&n.get("essay").file,o=n.get("surveyeeNo");i&&o&&this.trigger(c.FILE_DOWNLOAD,{file:i,surveyeeNo:o})}});d.EVENT=c,d.openLayerView=function(e){var t=new d({collection:e});return s.open(t),t},e.exports=d},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent" style="width: 600px">\n        <header class="modalHeader">\n            <h1 class="title"><%= IM(\'stats.survey.answer.label\') %></h1>\n        </header>\n\n        <div class="modalBody">\n            <div class="sPostQuizStats">\n                <div class="commentsBox">\n                    <% _.each(items, function(item, index) { %>\n                    <div tabindex="0" class="commentItem gCursorPointer _btnShowDetail" data-index="<%= index %>">\n                        <% if (item.otherChoiceContent) { %>\n                            <div class="commentText"><%- item.otherChoiceContent %></div>\n                        <% } else { %>\n                            <div class="-flexible">\n                                <%\n                                var images = item.essay.images;\n                                if (!!images) {\n                                %>\n                                <div class="attachmentPhoto">\n                                    <div class="thumbnailImg">\n                                        <img src="<%= makeThumb(images[0].url) %>" alt="">\n\n                                        <% if (images.length > 1) { %>\n                                            <span class="thumbnailNum">+<%= images.length - 1 %></span>\n                                        <% } %>\n                                    </div>\n                                </div>\n                                <% } %>\n\n                                <div class="commentText"><%- item.essay.content %></div>\n                            </div>\n\n                            <%\n                            var file = item.essay.file;\n                            if (!!file) {\n                            %>\n                            <div class="attachmentFile">\n                                <div class="fileItem">\n                                    <button type="button" class="fileName _btnFile" data-index="<%= index %>" <%= isExpiredFile(file.expiredAt) ? \'disabled\' : \'\' %>>\n                                    <%- file.fileName %>\n                                    </button>\n\n                                    <% if (isDropboxFile(file)) { %>\n                                        <span class="fileSize">dropbox</span>\n                                    <% } else { %>\n                                        <span class="fileSize"><%= toStringFileSize(file.fileSize) %></span>\n                                        <span class="fileSaveExpire"><%= makeExpirationText(file.expiredAt) %></span>\n                                    <% } %>\n                                </div>\n                            </div>\n                            <% } %>\n                        <% } %>\n                    </div>\n                    <% }); %>\n                </div>\n            </div>\n        </div>\n\n        <footer class="modalFooter gPa0">\n            <button type="button" class="uButton -iconClose btnLyClose _btnClose"><span class="gSrOnly"><%= IM(\'ui.label.close_layer\') %></span></button>\n        </footer>\n    </div>\n</section>'},function(e,t,n){var i=n(0),o=n(4),s=n(2659),a={STATS_LOADING_CANCEL:"STATS_LOADING_CANCEL"},r=o.View.extend({attributes:{"data-viewname":"DSurveyStatsExcelDownloadingView"},template:i.template(s),templateContext:function(){return{percent:this.options.percent,fileName:this.options.fileName}},ui:{percentWidth:"._percentWidth",percentTxt:"._percentTxt",btnCancel:"._btnCancel"},events:{"click @ui.btnCancel":function(){this.trigger(a.STATS_LOADING_CANCEL),this.destroy()}},initialize:function(e){this._percent=e.percent,this._fileName=e.fileName},updateView:function(e){this.getUI("percentTxt").text(e),this.getUI("percentWidth").css("width",e)}});r.EVENT=a,r.openLayerView=function(e,t){return new r({percent:e,fileName:t})},e.exports=r},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent -w360">\n        <header class="header">\n            <h1 class="title"><%= IM(\'ui.label.excel_download\') %></h1>\n        </header>\n\n        <div class="main">\n            <div class="progress">\n                <div class="inner">\n                    <p class="fileName"><%- fileName %></p>\n                    <span class="fileBy _percentTxt"><%- percent %></span>\n                    <div class="progressBar">\n                        <div class="bar sf_bg _percentWidth" style="width:<%= percent %>"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n       <footer class="footer">\n           <button type="button" class="uButton -cancel _btnCancel"><%= IM(\'ui.label.cancel\') %></button>\n       </footer>\n    </div>\n</section>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(16),o=n(1098),s=n(2661),a=n(1128);return{download:function(e,n){var i=n.get("bandNo"),a=n.get("postNo"),r=n.get("surveyId"),l=n.getQuestions(),c=s.build(i,a,r,l),d=this._openProgressModalView(l,c);c.on("progressed",(function(e){d.isDestroyed()||d.setProgress(e)})),c.fetchData().then(t.bind((function(){if(!d.isDestroyed()){var t=this._buildSheetData(c);try{o.downloadAsExcelFile({sheets:[t],filename:this._makeFileName(e,n)})}catch(e){throw alert(IM("error.wrong_request")),console.error(e),e}finally{d.destroy()}}}),this))},_openProgressModalView:function(e,t){var n=a.openProgressModal({title:IM("ui.label.excel_download"),desc:IM("ui.label.progress_all"),withoutHiding:!0,progressMode:a.MODE.COUNT,total:e.length});return n.setProgress(0),n.once("cancel",(function(){t.cancelFetching()})),n},_makeFileName:function(e,t){var n=t.get("timeZoneId");return o.makeFileName([{name:e.getBandCore().name,maxLength:20},{name:t.get("title"),maxLength:30},{name:i.tz(t.get("startAt"),n).format("YYYYMMDD")},{name:i.tz(t.get("endAt"),n).format("YYYYMMDD")}])},_buildSheetData:function(e){var n=[{A:IM("stats.question_number"),B:IM("stats.question_content"),C:IM("stats.respondents"),D:IM("stats.survey.answer.label")}];e.each((function(e){var i=e.get("answers");n.push({A:e.get("questionNumber"),B:e.get("questionTitle"),C:i[0]&&i[0].surveyeeName||"",D:i[0]&&i[0].answers.join("\n")||""}),t.each(t.rest(i,1),(function(e){n.push({A:"",B:"",C:e.surveyeeName,D:e.answers.join("\n")})}))}));var i=["A","B","C","D"];return{data:n,opts:{header:i,skipHeader:!0},cols:t.pluck(o.makeMaxColumnWidthData(n,i,100),"wch")}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(52),o=n(6),s=(n(803),n(584)),a=o.Collection.extend({initialize:function(e,t){this._bandNo=t.bandNo,this._postNo=t.postNo,this._surveyId=t.surveyId,this._surveyQuestionCollection=t.surveyQuestionCollection,this._surveyQuestionCollection.resetQuestionNumbers(),this._fetchCanceled=!1;var n=this._surveyQuestionCollection.map((function(e){return{id:e.getQuestionId(),questionNumber:e.getQuestionNumber(),questionTitle:this._makeQuestionTitle(e),questionType:e.getType(),answers:[]}}),this);this.set(n)},cancelFetching:function(){this._fetchCanceled=!0},fetchData:function(){var e=$.Deferred().resolve(),n=0;return this._surveyQuestionCollection.reduce((function(e,i){return e.then(t.bind((function(){return this._fetchCanceled?$.Deferred().reject():this._fetchQuestionAnswers(i).then(t.bind((function(e){this.get(i.getQuestionId()).set("answers",e),console.log("fetch question",i.getQuestionId()),this.trigger("progressed",++n)}),this))}),this))}),e,this)},_makeQuestionTitle:function(e){var t=e.getTitle();return e.getImage()&&(t="("+IM("ui.label.photo")+") "+t),t},_fetchQuestionAnswers:function(e){var n={band_no:this._bandNo,post_no:this._postNo,survey_id:this._surveyId,question_id:e.getQuestionId()},i={},o=[];e.isMultipleChoiceType()?(e.getChoices().each(t.bind((function(e){var s=t.extend({},n,{choice_id:e.getChoiceId()});o.push(this._fetchChoiceAnswers(s,i))}),this)),e.isOtherChoiceEnabled()&&o.push(this._fetchOtherChoiceAnswers(n,i))):o.push(this._fetchEssayAnswers(n,i));return $.when.apply($,o).then((function(){return t.each(i,(function(e){e.answers=t.sortBy(e.answers)})),t.sortBy(t.values(i),"surveyeeName")}))},_fetchEssayAnswers:function(e,n){return s.getSurveyEssays(e).then(t.bind((function(e){return this._appendEssayAnswers(i.camelizeKeys(e.items),n),e.paging.next_params?this._fetchEssayAnswers(e.paging.next_params,n):n}),this))},_appendEssayAnswers:function(e,n){t.each(e,(function(e){n[e.surveyeeNo]=n[e.surveyeeNo]||{surveyeeNo:e.surveyeeNo,surveyeeName:e.surveyeeName,answers:[]};var i=e.essay.content;t.isEmpty(e.essay.images)||(i="("+IM("ui.label.photo")+") "+i),t.isEmpty(e.essay.file)||(i="("+IM("file")+") "+i),n[e.surveyeeNo].answers.push(i)}),this)},_fetchChoiceAnswers:function(e,n){return s.getSurveyeesWithChoice(e).then(t.bind((function(t){return this._appendChoiceAnswers(e.question_id,e.choice_id,i.camelizeKeys(t.items),n),t.paging.next_params?this._fetchChoiceAnswers(t.paging.next_params,n):n}),this))},_appendChoiceAnswers:function(e,n,i,o){t.each(i,(function(t){o[t.surveyeeNo]=o[t.surveyeeNo]||{surveyeeNo:t.surveyeeNo,surveyeeName:t.surveyeeName,answers:[]};var i=this._surveyQuestionCollection.get(e).getChoices().get(n),s="("+(i.collection.indexOf(i)+1)+") "+i.getTitle();o[t.surveyeeNo].answers.push(s)}),this)},_fetchOtherChoiceAnswers:function(e,n){return s.getSurveyOtherChoiceContents(e).then(t.bind((function(e){return this._appendOtherChoiceAnswers(i.camelizeKeys(e.items),n),e.paging.next_params?this._fetchOtherChoiceAnswers(e.paging.next_params,n):n}),this))},_appendOtherChoiceAnswers:function(e,n){t.each(e,(function(e){n[e.surveyeeNo]=n[e.surveyeeNo]||{surveyeeNo:e.surveyeeNo,surveyeeName:e.surveyeeName,answers:[]};var t="("+IM("question.choice.other")+")";e.otherChoiceContent&&(t=t+" "+e.otherChoiceContent),n[e.surveyeeNo].answers.push(t)}),this)}});return a.build=function(e,t,n,i){return new a(null,{bandNo:e,postNo:t,surveyId:n,surveyQuestionCollection:i})},a}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% //TODO 차단된 사용자의 글을 딤드하는 태그 %>\n<div class="_dimArea"></div>\n<% if (isSourcePostUnavailable) { // 공유 가능하지 않은 게시글인 경우 %>\n    <div class="snippet" data-thumbnail="type0">\n        <span class="snippetInfo">\n            <span class="snippetTxt"><%= IM(\'web.postdetail.shared.not_exist_post\') %></span>\n        </span>\n    </div>\n<% } else { %>\n    <div class="_attachSharedPost">\n        <div class="header <%-overDimClass%>">\n            <% if (bandCertified) { %>\n            <span class="uOfficialBand -sizeS"><%= IM("ui.official_band") %></span>\n            <% } %>\n            <strong><%- bandName %></strong>\n        </div>\n        \x3c!-- 원글 영역 --\x3e\n        <div class="cContentsCard _sharedPostRegion"></div>\n        <div class="footer">\n            <p><%- IM("web.postdetail.shared.message", {count: sharedCount}) %></p>\n        <% if (isShareable) { %>\n            <button type="button" class="btnShare _btnShareOriginPost"><%= IM("web.postdetail.btn.share_post") %></button>\n            <div class="_postShareOptionListViewRegion"></div>\n        <% } %>\n        </div>\n    </div>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(162),s=n(1651),a=n(1263),r=n(1264),l=n(2664),c=n(84),d=n(491),u=n(26),h=n(1048),p=n(152),m=n(487),_=n(17);return i.View.extend({attributes:function(){var e={"data-viewname":"DSharedPagePostView"};return this.model.isSourcePostUnavailable()&&(e["data-widget"]="expanded"),e},className:function(){return this.model.isSourcePostUnavailable()?"uWidget":"sharePost"},template:t.template(l),ui:{attachSharedPost:"._attachSharedPost",sharedPostRegion:"._sharedPostRegion",btnShareOriginPost:"._btnShareOriginPost",postShareOptionListViewRegion:"._postShareOptionListViewRegion"},regions:{sharedPostRegion:"@ui.sharedPostRegion",postShareOptionListViewRegion:{el:"@ui.postShareOptionListViewRegion",replaceElement:!0}},events:function(){return this.options.clickDisabledPostTypeOnDetail?{}:{"click @ui.attachSharedPost":function(){this._gotoSharedPost();var e=this.sharedPostModel.get("band").bandNo;this.jplClick(m.CLASSIFIER.SHARED_POST_AREA,{band_no:e,post_no:this.sharedPostModel.get("postNo"),container_band_no:this._richPostModel.getBandCore().bandNo,container_post_no:this._richPostModel.getPostNo()},e)},"click @ui.btnShareOriginPost":"_togglePostShareOptionListView"}},behaviors:[m],initialize:function(e){this._richPostModel=e.postModel,this.sharedPostModel=this._richPostModel.getAttachment(p.POST_ATTACHMENT_TYPE.SHARED_PAGE_POST_SNIPPET).getSourcePost(),this.listenTo(u.getDGlobalChannel(),u.EVENT.HTML_CLICK,this._closeLayers)},serializeData:function(){var e={isSourcePostUnavailable:this.model.isSourcePostUnavailable()};return e.isSourcePostUnavailable||t.extend(e,{bandName:this.sharedPostModel.get("band").name,bandCertified:this.sharedPostModel.get("band").certified,sharedCount:this.sharedPostModel.get("sharedCount")||"0",isShareable:this.sharedPostModel.get("isShareable")}),e},onAttach:function(){if(!this.model.isSourcePostUnavailable()){var e=s.buildRenderSharedPostMode(this.sharedPostModel);this.showChildView("sharedPostRegion",e),this.listenTo(e,"postItem:clickAttachment:showPostDetailLayer",this._gotoSharedPost),t.each(e.getRegions(),(function(e){e.currentView instanceof a||e.currentView instanceof r||!e.currentView||e.currentView.$el.find("[data-viewname]").off()}))}},_gotoSharedPost:function(){if(this.options.clickDisabledPostTypeOnDetail)return!1;var e=this.sharedPostModel.get("band").bandNo,n=this.sharedPostModel.get("postNo");return d.getCachedBandData(this.options.postModel.get("band").bandNo).then(t.bind((function(t){t.isPreview()?window.open(this._makeLandingUrl(e,n),"_blank"):c.go(this._makeLandingUrl(e,n))}),this)),!1},_makeLandingUrl:function(e,t){return o.PAGE_BAND_POST_DETAIL.makeUrl({band_no:e,post_no:t})},_togglePostShareOptionListView:function(){var e=this.getRegion("postShareOptionListViewRegion"),n=e.hasView();return u.getDGlobalChannel().trigger(u.EVENT.HTML_CLICK),n||t.defer(t.bind((function(){var t=this.sharedPostModel.getBandCore().bandNo,n=this.sharedPostModel.get("postNo"),i=o.PAGE_BAND_POST_DETAIL.makeUrl({band_no:t,post_no:n});e.show(h.buildUrlShareView({shareUrl:_.appendCurrentDomainOnPathUrl(i),message:"",excludedBandNos:[t,this._richPostModel.getBandNo()],isSingleSelectionOnMoreBandSelection:!1}))}),this)),!1},_closeLayers:function(){t.each(["postShareOptionListViewRegion"],(function(e){var t=this.getRegion(e);null!=t&&t.hasView()&&t.empty()}),this)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% if (isSourcePostUnavailable) { // 공유 가능하지 않은 게시글인 경우 %>\n<div class="snippet" data-thumbnail="type0">\n        <span class="snippetInfo">\n            <span class="snippetTxt"><%= IM(\'web.postdetail.shared.not_exist_post\') %></span>\n        </span>\n</div>\n<% } else { %>\n<div class="_attachSharedPost">\n    \x3c!-- 원글 영역 --\x3e\n    <div class="cContentsCard _sharedPostRegion"></div>\n    <div class="footer">\n        <p><%- IM("web.postdetail.shared.message", {count: sharedCount}) %></p>\n        <% if (isShareable) { %>\n        <button type="button" class="btnShare _btnShareOriginPost"><%= IM("web.postdetail.btn.share_post") %></button>\n        <div class="_postShareOptionListViewRegion"></div>\n        <% } %>\n    </div>\n</div>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2058);return i.View.extend({attributes:{"data-viewname":"DPostUnknownView"},className:"uWidget",template:t.template(o)})}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% // 표정수, 댓글수, 공유수 영역 %>\n<%\nvar faceCommentShare = !bPostDetail && isShareable && sharedCount;\nvar faceComment = emotionCount || commentCount || isSimpleCountView || faceCommentShare;\nvar shareReadShare = bPostDetail && isShareable && sharedCount;\nvar shareReadRead = !bPostDetail && postReadCount;\nvar shareRead = shareReadShare || shareReadRead;\n%>\n<% if (faceComment || shareRead) { %>\n<div class="postCount">\n    <div class="postCountLeft">\n        <% if (faceComment) { %>\n        <span class="faceComment">\n            <div class="emotionCountWrap _emotionCountViewRegion"></div>\n            <% if (commentCount || isSimpleCountView) { %>\n            <% if (bPostDetail) { %>\n            <span class="comment _commentCountBtn"><%= IM(\'web.postdetail.comment.title\') %><span class="count"><%- commentCount %></span></span>\n            <% } else { %>\n            <button type="button" class="comment _commentCountBtn"><%= IM(\'web.postdetail.comment.title\') %><span class="count"><%- commentCount %></span></button>\n            <% } %>\n            <% } %>\n            <% if (faceCommentShare) { %>\n            <button class="share _sharedCountBtn"><%= IM(\'share\') %><span class="count"><%- sharedCount %></span></button>\n            <% } %>\n            <% if (!preventUnfoldEmotionCommentArea) { %>\n            <button type="button" class="commentToggle _commentToggleBtn"><%= IM(\'comment.fold_unfold\') %></button>\n            <% } %>\n        </span>\n        <% } %>\n        <% if (shareRead) { %>\n        <span class="shareRead">\n            <% if (shareReadShare) { %>\n            <button class="share _sharedCountBtn"><%= IM(\'share\') %><span class="count"><%- sharedCount %></span></button>\n            <% } %>\n        </span>\n        <% } %>\n    </div>\n\n    <div class="postCountRight">\n        <% if (shareRead) { %>\n        <span class="shareRead">\n            <% if (shareReadRead) { %>\n            <span class="read"><span class="gSrOnly"><%= IM(\'post.label.read\')%></span><span class="count"><%- postReadCount %></span></span>\n            <% } %>\n        </span>\n        <% } %>\n        <% if ( canDownloadPostComments ) { %>\n        <button class="btnCommentDownload _commentDownloadBtn"><%- IM(\'post.menu.download_comments\') %></button>\n        <% } %>\n    </div>\n\n</div>\n<% } %>\n\n<% /*\n    표정짓기 Label, 댓글쓰기 Label, 공유하기 Label 영역\n\n    _postAdded class는 DPostDetailLayerView에서 참조\n*/ %>\n<% if (showPostAdded) { %>\n<div class="postAdded _postAdded">\n    <div class="postAddBox">\n        <div class="addCol">\n            <a href="#" class="_emoteMainBtn addStatus -face<%= emotionByViewer ? \' -active\' : \'\' %>">\n                <% if (emotionByViewer) { %>\n                <span class="uFaceIcon -<%= emotionByViewer.iconName %>-s-22"></span>\n                <span><%= emotionByViewer.label %></span>\n                <% } else { %>\n                <span><%= IM(\'web.postlist.emotion.title_full\') %></span>\n                <% } %>\n            </a>\n\n            <% // 이모티콘 선택 레이어 %>\n            <div class="_emoticonSelectViewRegion"></div>\n        </div>\n        <% if (isCommentingPermitted) { %>\n        <div class="addCol">\n            <a href="#" class="_commentMainBtn addStatus -comment"><span><%= IM(\'web.postlist.comment.title_full\') %></span></a>\n        </div>\n        <% } %>\n        <% if (isShareable) { %>\n        <div class="addCol">\n            <div class="postShare">\n                <a href="#" class="_shareMainBtn addStatus -share"><span><%= IM(\'web.postdetail.btn.share_post\') %></span></a>\n                <div class="_postShareOptionListViewRegion"></div>\n            </div>\n        </div>\n        <% } %>\n    </div>\n\n    <% // 등록된 이모티콘 목록 영역 %>\n    <div class="_emotionViewRegion"></div>\n</div>\n<% } %>\n\n<% // 표정수, 댓글수, 공유수 영역 (스크롤 시 적용할 간략한 형태의 마크업) %>\n<% if (bPostDetail) { %>\n<div class="postCountLayer">\n    <div class="faceComment">\n        <div class="emotionSection">\n            <% if (!emotionCount) { %>\n            <button class="face _emoteLayerBtn"></button><button class="count _emotionCountLayerBtn">0</button>\n            <% } %>\n            <div class="_emotionCountViewLayerRegion"></div>\n            <div class="_emoticonSelectViewLayerRegion"></div>\n        </div>\n        <button type="button" class="comment _commentLayerBtn"><%= IM(\'web.postdetail.comment.title\') %></button><button type="button" class="count -commentCount _commentCountLayerBtn"><%- commentCount %></button>\n    </div>\n    <% if (isShareable) { %>\n    <div class="shareWrap">\n        <button class="share _shareLayerBtn"><%= IM(\'share\') %></button><% if (sharedCount) { %><button class="count -shareCount _sharedCountLayerBtn"><%- sharedCount %></button><% } %>\n        <div class="_postShareOptionListViewLayerRegion"></div>\n    </div>\n    <% } %>\n</div>\n\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(2),i=n(0),o=n(4),s=n(2668),a=n(1660),r=n(589),l=o.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DShareCountListView"},template:i.template(s),templateContext:function(){return{msg_allSharedCount:this.collection.reduce((function(e,t){return e+t.get("sharedCount")}),0)}},ui:{btnConfirm:"._btnConfirm",itemUser:"._itemUser"},events:{"click @ui.btnConfirm":"destroy","click @ui.itemUser":function(e){var n=t(e.currentTarget).data("index"),i=this.collection.at(n).get("user").get("userNo");return r.openProfileView(this.collection.bandNo,i),!1}},onAttach:function(){this.collection.fetchShareCount().then(i.bind((function(){this.render()}),this))},serializeData:function(){return{items:this.collection.toJSON()}}});return l.buildDShareCountListView=function(e,t){var n=new a([],{bandNo:e,postNo:t});return new l({collection:n})},l}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent -w360">\n    <header class="modalHeader">\n        <h1 class="title">\n            <% if (msg_allSharedCount > 0) { %>\n            <%-IM("web.postdetail.share_count_list.title", {count: msg_allSharedCount})%>\n            <% } else { %>\n            <%-IM("share")%>\n            <% } %>\n        </h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap">\n            <% if (items && items.length > 0) { %>\n            <ul class="listLine rScroll -h360">\n                <% _.each(items, function(item, index) { %>\n                <li class="tLine flexList">\n                <span class="thumb">\n                    <a href="#" role="button" class="_itemUser" data-index="<%-index%>">\n                        <span class="uProfile -size40">\n                            <span class="profileInner">\n                                <img src="<%-item.user.faceThumb%>" width="40" height="40" alt="<%-item.user.name%>">\n                            </span>\n                        </span>\n                    </a>\n                </span>\n                    <span class="text -ellipsis"><%-item.user.name%></span>\n                    <span class="etc -text"><%= IM("web.postdetail.share_count_list.user_share_count", {count: item.sharedCount})%></span>\n                </li>\n                <% }); %>\n            </ul>\n            <% } else { %>\n            <p class="uEmpty -h360">\n                <span><%-IM("post.share_count_list.message.none")%></span>\n            </p>\n            <% } %>\n        </div>\n    </div>\n    <footer class="modalFooter -tLine">\n        <button type="button" class="uButton -confirm _btnConfirm"><%-IM(\'ui.label.confirm\')%></button>\n    </footer>\n</div>'},function(e,t,n){var i;void 0===(i=function(e){var t,i=n(0),o=n(2),s=n(4),a=n(52),r=n(1094),l=n(508),c=n(159),d=n(1005),u=n(565),h=n(154),p=n(155),m=n(505),_=n(26),g=n(1038),f=n(1013),b=n(623),v=n(1032),A=n(509),E=n(560),T=s.View.extend({template:i.template('<h1 class="gSrOnly">'+IM("discover.post.comment.title")+'</h1><div class="_commentListRegion"></div>'),behaviors:[c],regions:{commentListRegion:{el:"._commentListRegion",replaceElement:!0}},onMessages:(t={},t[c.MSG.COMMENT_GO_FIRST_COMMENT]=function(){this._fetchFirstCommentList()},t[c.MSG.COMMENT_PREVIOUS_MORE]=function(){this._fetchPreviousAndNextAllCommentList()},t[c.MSG.COMMENT_NEXT_MORE]=function(){this._fetchNextCommentList()},t[c.MSG.COMMENT_DELETE_COMMENT]=function(e){this._deleteComment(e)},t[c.MSG.COMMENT_SUBMIT_MODIFICATION]=function(e){this._modifyComment(e)},t[c.MSG.COMMENT_SHOW_VIDEO_CLICK]=function(e){this._checkAndShowVideo(e)},t[c.MSG.EMOTIONLIST_LAYER_OPEN]=function(e){var t=null!=e.originCommentId?v.POST_COMMENT_COMMENT:v.POST_COMMENT,n=A.buildByAttributes({postNo:this._postNo,originCommentId:e.originCommentId,commentId:e.commentId,contentType:t.getContentTypeKey()});g.openDEmotionListView(this._bandNo,n)},t[c.MSG.EMOTION_SELECT_LAYER_OPEN]=function(e){this._openEmotionSelectLayer(e)},t[c.MSG.VIDEO_AUTO_PLAY]=function(e){e.processAutoPlay()},t),passMessages:function(){var e={};return e[c.MSG.COMMENT_AREA_CLICKED]=c.MSG.PROPAGATION_STOP,e}(),initialize:function(e){this._bandNo=e.bandNo,this._postNo=e.postNo,this._token=e.token,this._bandData=p.get(this._bandNo),this._commentCollection=this._createCommentCollection(),this._isCommentingPermitted=e.isCommentingPermitted,this._initCommentId=e.initCommentId,this._initCommentReplyId=e.initCommentReplyId,this._muteIgnoredAuthorUserNo=e.muteIgnoredAuthorUserNo,this._isHiddenFilterIgnored=e.isHiddenFilterIgnored,this._hideEmotion=e.hideEmotion},onAttach:function(){h.wrapActivePromise(this._bandData.loadBandData(),this).then(i.bind((function(){this._commentCollectionView=r.buildDCommentCollectionView({maxMessageLength:l.MAX_LENGTH,overMaxLengthAlertMessage:IM("comment.over_max_message",{count:l.MAX_LENGTH}),isCommentingPermitted:this._isCommentingPermitted,replySupport:this._bandData.canWriteReply(),canUsePaging:this._bandData.canMoveToMoreComment(),canExpressEmotion:this._bandData.canExpressEmotionOnComment(),canOpenMediaViewer:this._bandData.canOpenMediaViewerOnComment(),canDownloadFile:this._bandData.canDownloadFileOnComment(),canOpenSnippetUrl:this._bandData.canOpenSnippetUrlOnComment(),mentionOption:u.buildMentionOption({memberGroupMentionPossible:!0,dynamicSearchPossible:!0})}),this.showChildView("commentListRegion",this._commentCollectionView),this._fetchFirstViewCommentList()}),this))},fetchLastCommentList:function(){return this._commentCollection.fetchLastCommentList(this._token).then(i.bind((function(e){this._commentCollectionView.setOldestCommentShow(!1),this._populateFetchedCollectionWithReset(e)}),this))},fetchAroundComment:function(e){return this._commentCollection.fetchAroundCommentList(e).then(i.bind((function(e){this._commentCollectionView.setOldestCommentShow(!1),this._populateFetchedCollectionWithReset(e)}),this))},isModificationStatus:function(){return!(this.isDestroyed()||!this._commentCollectionView)&&this._commentCollectionView.isModificationMode()},scrollToCommentWithDelay:function(e){this._commentCollectionView.scrollToCommentWithDelay(e)},scrollToComment:function(e){this._commentCollectionView.scrollToComment(e)},getTotalCommentCount:function(){return this._commentCollection.getTotalCount()},_fetchFirstViewCommentList:function(){return this._initCommentId?this._bandData.canMoveToMoreComment()?this.fetchAroundComment(this._initCommentId).then(i.bind((function(){if(this._initCommentReplyId)return this._commentCollectionView.renderReplyListAndFocus(this._initCommentId,this._initCommentReplyId);this._commentCollectionView.scrollToComment(this._initCommentId)}),this)):this.fetchLastCommentList().then(i.bind((function(){this._commentCollectionView.scrollToComment(this._initCommentId)}),this)):this.fetchLastCommentList()},_populateFetchedCollection:function(e,t){if(!this._commentCollectionView.isDestroyed()){this._populatePagingParams(e,t);var n=this._convertCommentCollectionToViewArray(e);this._commentCollectionView.populateFetchedCollection(n,e.getTotalCount(),!1,null!=this._previousParams,null!=this._nextParams),this.spawn(c.MSG.COMMENTLIST_CHANGE_COLLECTION)}},_populatePagingParams:function(e,t){var n=e.getPagingData();t.previous&&(this._previousParams=n.previous_params,this._firstParams=n.first_params),t.next&&(this._nextParams=n.next_params,this._updateParams=n.update_param)},_populateFetchedCollectionWithReset:function(e){if(!this._commentCollectionView.isDestroyed()){this._populatePagingParams(e,{previous:!0,next:!0});var t=this._convertCommentCollectionToViewArray(e);this._commentCollectionView.populateFetchedCollection(t,e.getTotalCount(),!0,null!=this._previousParams,null!=this._nextParams),this.spawn(c.MSG.COMMENTLIST_CHANGE_COLLECTION)}},_populateFetchedCollectionAndChangeSortOrder:function(e,t,n){this.isDestroyed()||this._commentCollectionView.isDestroyed()||(this._commentCollectionView.isOldestCommentShow()!=t?(this._commentCollectionView.setOldestCommentShow(t),this._populateFetchedCollectionWithReset(e)):this._populateFetchedCollection(e,n))},_convertCommentCollectionToViewArray:function(e){var t=e.getContentKeyButCommentId();return e.map(i.bind((function(e){var n=d.buildByDetailDComment(e,this._bandData,t,!1,this._muteIgnoredAuthorUserNo,this._isHiddenFilterIgnored,!this._hideEmotion);return n.getTranslationChannel().setHighZIndex(!0),n}),this))},_deleteComment:function(e){var t=IM("web.commentdetail.comment.confirm.delete_comment");if(e.isReplyExist&&(t=IM("comment.delete_parent_confirm")),confirm(t)){var n=e.contentKey,o=n.getCommentId();h.wrapActivePromise(m.deleteComment(this._bandNo,n.toApiParams(!0)),this).then(i.bind((function(){this._commentCollectionView.deleteCommentOnView(o,null!=this._previousParams,null!=this._nextParams),this.spawn(c.MSG.COMMENTLIST_CHANGE_COLLECTION),_.getCommentChannel().trigger(_.EVENT.BAND_FILE_UPDATED),_.getCommentChannel().trigger(_.EVENT.COMMENT_DELETED,n)}),this))}},_fetchFirstCommentList:function(){return this._commentCollection.fetchCommentList(this._firstParams).then(i.bind((function(e){this._populateFetchedCollectionAndChangeSortOrder(e,!0,{previous:!0,next:!0})}),this))},_fetchPreviousAndNextAllCommentList:function(){o.when(this._fetchPreviousCommentList(),this._fetchNextAllCommentList())},_fetchPreviousCommentList:function(){return this._commentCollection.fetchCommentList(this._previousParams).then(i.bind((function(e){this._populateFetchedCollection(e,{previous:!0})}),this))},_fetchNextAllCommentList:function(){return this._commentCollectionView.isEmptyCollection()?this.fetchLastCommentList():this._nextParams?void 0:this._commentCollection.fetchCommentList(this._updateParams).then(i.bind((function(e){return this._populateFetchedCollection(e,{next:!0})}),this))},_fetchNextCommentList:function(){return this._commentCollection.fetchCommentList(this._nextParams).then(i.bind((function(e){return this._populateFetchedCollection(e,{next:!0})}),this))},_modifyComment:function(e){E.modifyComment(this._bandNo,e,this).then(i.bind((function(e){var t={};t.comments=a.camelizeKeys(e.comment),t.totalCount=this._commentCollection.getTotalCount(),_.getCommentChannel().trigger(_.EVENT.BAND_FILE_UPDATED);var n=this._createCommentCollection();this._populateFetchedCollection(n.populateDetailCommentData(t),{}),this.spawn(c.MSG.COMMENTLIST_SHOW_INPUT)}),this),(function(){e.modificationView.releaseModificationProgress()}))},_checkAndShowVideo:function(e){e.gifVideo&&e.view.showVideo()},_openEmotionSelectLayer:function(e){var t=null!=e.originCommentId?v.POST_COMMENT_COMMENT:v.POST_COMMENT,n=f.buildDEmotionSelectViewByContentKey({bandNo:this._bandNo,contentKey:A.buildByAttributes({postNo:this._postNo,originCommentId:e.originCommentId,commentId:e.commentId,contentType:t.getContentTypeKey()}),emotionTypeByViewer:e.emotionTypeByViewer});e.view.showEmotionSelectView(n)},_createCommentCollection:function(){return b.buildDetailCommentCollection({bandNo:this._bandNo,ownerContentKey:A.buildPostKey(this._postNo),contentKeyButCommentId:A.buildPostCommentKey(this._postNo,null)})}});return T.buildDPostCommentListView=function(e){return new T(e)},T}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<button type="button" class="btnPageSubscription _btnPageSubscription"><%- message %></button>\n<p class="subscribeMessage _subscribeMessage"><%- IM("web.pageband.subscribe_message") %></p>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2672),s=n(2673),a=n(26),r=n(153),l=n(1053),c=i.View.extend({attributes:{"data-viewname":"DPostPinnedHashtagsView"},className:"postHashTagAdd",template:t.template(o),templateContext:function(){var e=this.bandNo;return{hashTags:this._getHashtags(),isPermitted:this.bandData.canSetPostSetHashtags(),makeHashtagUrl:function(t){return t=l.decodeQuery(t.replace(/^\#/,"")),r.GROUP_BAND_HASHTAG.makeUrl({band_no:e,query:encodeURIComponent(t)})}}},ui:{btnSelectTag:"._btnSelectTag"},events:{"click @ui.btnSelectTag":"_openSelectTagView"},initialize:function(e){this.bandData=e.bandData,this.postModel=e.postModel,this.bandNo=this.postModel.getBandNo(),this.pinnedHashtagsInContent=this.postModel.getPinnedHashtagsInContent(),this.setHashtags=this.postModel.getSetHashtags()},_getHashtags:function(){return t.unique(this.pinnedHashtagsInContent.concat(this.setHashtags))},_openSelectTagView:function(){var e=s.buildAsLayer({postModel:this.postModel,contentPinnedHashtags:this.pinnedHashtagsInContent,setHashtags:this.setHashtags});this.listenTo(e,s.EVENT.UPDATED,t.bind((function(){a.getPostChannel().trigger(a.EVENT.POST_UPDATED,this.postModel.getPostNo())}),this))}});return c.build=function(e){return new c({bandData:e.bandData,postModel:e.postModel})},c}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<% if (isPermitted) { %>\n<button type="button" class="hashTagAdd _btnSelectTag" aria-label="<%= IM(\'post_hashtag.add_tag\') %>">\n    <svg class="svgIcon sf_color" aria-hidden="true">\n        <use xlink:href="#ico-plus-circle-18"></use>\n    </svg>\n\n    <% if (isPermitted && hashTags.length === 0) { %>\n    <span class="text sf_color"><%= IM(\'post_hashtag.add_tag\') %></span>\n    <% } %>\n</button>\n<% } %>\n\n<% if (hashTags.length > 0) { %>\n    <% _.each(hashTags, function(tag){ %>\n    <a href="<%- makeHashtagUrl(tag) %>" class="tag"><%= tag %></a>\n    <% }); %>\n<% } %>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2674),s=n(486),a=n(520),r=(n(562),n(725)),l=n(583),c={UPDATED:"UPDATED"},d=i.View.extend({attributes:{"data-viewname":"DPostPinnedHashtagsSelectView"},template:t.template(o),templateContext:function(){return{dataFetched:this.dataFetched,bandPinnedHashtags:this.bandPinnedHashtags,contentPinnedHashtags:this.contentPinnedHashtags,setHashtags:this.setHashtags}},ui:{btnCancel:"._btnCancel",btnConfirm:"._btnConfirm",checkInput:"._checkInput",loadingRegion:"._loadingRegion"},regions:{loadingRegion:{el:"@ui.loadingRegion"}},events:{"click @ui.btnCancel":"destroy","click @ui.btnConfirm":"_setPostHashtags","change @ui.checkInput":"_updateButtonState"},initialize:function(e){this.dataFetched=!1,this.postModel=e.postModel,this.bandTagsModel=e.bandTagsModel,this.contentPinnedHashtags=e.contentPinnedHashtags,this.setHashtags=e.setHashtags},onAttach:function(){this.showChildView("loadingRegion",l.buildAsMediumAreaMiddle()),this._fetchBandPinnedHashtags().then(t.bind((function(){var e=t.pluck(this.bandTagsModel.get("bandTags"),"hashtag");this.bandPinnedHashtags=t.unique(e.concat(this.setHashtags)),this.render()}),this))},_updateButtonState:function(){this.getUI("btnConfirm").attr("disabled",t.isEqual(this._getSelectedTags(),this.setHashtags))},_getSelectedTags:function(){var e=this.getUI("checkInput").filter(":checked").not(":disabled"),t=[];return e.each((function(e,n){t.push($(n).data("tag"))})),t},_fetchBandPinnedHashtags:function(){return this.bandTagsModel.fetchBandTagsWithPinned(this.postModel.getBandNo()).then(t.bind((function(){this.dataFetched=!0}),this))},_setPostHashtags:function(){var e=this._getSelectedTags().join(",");a.setHashtagsIntoPost(this.postModel.getBandNo(),this.postModel.getPostNo(),e).then(t.bind((function(){this.trigger(c.UPDATED),this.destroy()}),this))}});return d.EVENT=c,d.buildAsLayer=function(e){var t=new d({postModel:e.postModel,bandTagsModel:new r,contentPinnedHashtags:e.contentPinnedHashtags,setHashtags:e.setHashtags});return s.openWithoutHiding(t),t},d}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<section class="lyWrap">\n    <div class="lyContent -w380">\n        <header class="modalHeader">\n            <h1 class="title"><%= IM(\'post_hashtag.select_view.title\') %></h1>\n        </header>\n\n        <div class="modalBody">\n            <div class="modalContentWrap -mH360">\n            <% if (!dataFetched) { %>\n                <div class="_loadingRegion" style="height:360px"></div>\n            <% } else { %>\n                <p class="sDesc gMab12"><%= IM(\'post_hashtag.select_view.desc\') %></p>\n\n                <div class="hashTagSelect">\n                    <ul class="listLine">\n                        <%\n                        _.each(bandPinnedHashtags, function(tag, index) {\n                            var isIncludePostContentHashtag = _.contains(contentPinnedHashtags, tag);\n                            var isIncludeSetHashtag = _.contains(setHashtags, tag);\n                            var inputAttrs = (isIncludePostContentHashtag) ? \'checked disabled\' : (isIncludeSetHashtag) ? \'checked\' : \'\';\n                        %>\n                        <li class="bLine">\n                            <label class="flexList <%= (isIncludePostContentHashtag) ? \'-disabled\': \'\' %>">\n                                <span class="text"><%= tag %></span>\n                                <span class="etc">\n                                    <span class="uCheck -checkbox -noLabel <%= (isIncludePostContentHashtag) ? \'-disabled\': \'\' %>">\n                                        <input type="checkbox" id="uCheck" class="checkInput _checkInput" data-tag="<%- tag %>" <%= inputAttrs %>>\n                                        <span class="checkLabel">\n                                            <span class="shape"></span>\n                                        </span>\n                                    </span>\n                                </span>\n                            </label>\n                        </li>\n                        <% }) %>\n                    </ul>\n                </div>\n            <% } %>\n            </div>\n        </div>\n\n        <footer class="modalFooter">\n            <button type="button" class="uButton -cancel _btnCancel"><%= IM("ui.label.cancel") %></button>\n            <button type="button" class="uButton -confirm _btnConfirm" disabled><%= IM("ui.label.confirm") %></button>\n        </footer>\n    </div>\n</section>'},function(e,t){e.exports='<section class="lyWrap _scrollContainer">\n    <div class="printInfoWrap">\n        <div class="printInfo">\n            <img src="<%-printBandCover%>" width="24" height="24" alt="">\n            <span class="name"><%-printBandName%></span>\n        </div>\n    </div>\n    <div class="lyPostViewer _lyContent">\n        <div class="postViewer">\n            <header class="gSrOnly"><h1><%= IM(\'web.board.member_posts.post_tab_name\') %></h1></header>\n\n            <section class="cPostCard _postCard">\n                <h2 class="feedTitBand _feedTitBand"></h2>\n                <% //TODO 차단된 사용자의 글 표시하기 위해 \'-blockUserPost\' 클래스 추가  %>\n                <div class="cContentsCard _postWrapper" data-type="comment">\n                    <% //TODO 차단된 사용자의 글을 딤드하는 태그 \'gDimmed\' 클래스 추가 %>\n                    <div class="_dimArea"></div>\n\n                    <% // 작성자와 글 정보 영역 %>\n                    <div class="_postAuthorRegion"></div>\n\n                    <div class="postMain">\n                        <% // 글 읽음수 노출 %>\n                        <div class="readNotice _postReaderWrap" style="display: none;">\n                            <p class="_postReaders"></p>\n                        </div>\n\n                        <% // 미션 인증 글 > 미션 정보 %>\n                        <div class="missionCertification _missionInfo"></div>\n\n                        <% // 글 본문 (첨부 정보 포함) %>\n                        <div class="_contentListRegion"></div>\n\n                        <% // 번역 보기 %>\n                        <div class="_contentTranslationRegion" style="display:none"></div>\n\n                        <% // 대표태그 표시 %>\n                        <div class="_postPinnedHashtagsRegion"></div>\n                    </div>\n\n                    <% // 페이지 구독하기 버튼 %>\n                    <% if (showBtnSubscribe) { %>\n                    <div class="pageSubscribeWrap _pageSubscriptionRegion"></div>\n                    <% } %>\n\n                    <% // 더보기 옵션 메뉴 버튼과 레이어 %>\n                    <div class="_moreOptionListRegion" style="display: none;"></div>\n\n                    <% // 표정수, 댓글수 영역 및 글에 해당하는 이모티콘 목록 영역 %>\n                    <div class="_postCountAndEmotionRegion"></div>\n\n                    \x3c!-- 승인 대기 게시글인 경우 (게시글 승인 번호가 있는 경우) 게시글 거절/승인 버튼 노출 영역 --\x3e\n                    <% if (isApprovablePost) { %>\n                    <div class="postAdded">\n                        <div class="postAddBox">\n                            <div class="addCol">\n                                <a href="#" class="addStatus -delete _deleteApprovalPost"><span><%= IM("ui.label.del") %></span></a>\n                            </div>\n                            <div class="addCol">\n                                <a href="#" class="addStatus -confirm _approvePost"><span><%= IM("approve.post.btn") %></span></a>\n                            </div>\n                        </div>\n                    </div>\n                    <% } %>\n\n                    <% // 댓글 목록 영역 (댓글쓰기 Inputbox 포함) %>\n                    <div class="_commentRegion"></div>\n                </div>\n\n            </section>\n        </div>\n    </div>\n\n    <button type="button" class="uBtnGoToTop -postViewer _btnGoToTop"><span class="gSrOnly"><%- IM(\'ui.label.go_to_top\') %></span></button>\n\n    <button type="button" class="btnPrevPost _btnPrevPost" data-status="active" style="display: none;"><span class="gSrOnly"><%= IM("ui.label.prev") %></span></button>\n    <button type="button" class="btnNextPost _btnNextPost" style="display: none;"><span class="gSrOnly"><%= IM("ui.label.next") %></span></button>\n\n    <button type="button" class="btnCloseLyPost _btnClose"><span class="gSrOnly"><%= IM("ui.label.close_layer") %></span></button>\n</section>'},function(e,t,n){var i;void 0===(i=function(e){var t=n(0),i=n(4),o=n(2677),s=n(486),a=n(57),r=i.View.extend({tagName:"section",className:"lyWrap",attributes:{"data-viewname":"DShortcutGuideLayerView"},template:t.template(o),templateContext:function(){return{isMac:a.isMac()}},events:{"click ._btnClose":"destroy",click:function(e){e.target!==this.el||this.destroy()}},layerOnEscKeyDown:function(){this.destroy()}});return r.openLayer=function(){var e=s.getActiveLayerView();e&&e instanceof r||s.openWithoutHiding(new r)},r}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="lyContent" style="width: 480px">\n    <header class="modalHeader">\n        <h1 class="title">Keyboard shortcuts</h1>\n    </header>\n    <div class="modalBody">\n        <div class="modalContentWrap gMat14 gMab20">\n\n            <div class="modalContentTitle gPal5 gPar5 gPab15">\n                <h2 class="mainTitle">Navigation</h2>\n                <ul class="msgList gMat20">\n                    <li class="msgListItem -noBefore gFs16"><span class="shortCutSignBox">G</span> + <span class="shortCutSignBox">G</span> : Global Home</li>\n                    <li class="msgListItem -noBefore gFs16 gMat10"><span class="shortCutSignBox">G</span> + <span class="shortCutSignBox">1</span> ~ <span class="shortCutSignBox">9</span> : Go nth Band at Global Home</li>\n                    <li class="msgListItem -noBefore gFs16 gMat10"><span class="shortCutSignBox">G</span> + <span class="shortCutSignBox">F</span> : Global Feed</li>\n                    <li class="msgListItem -noBefore gFs16 gMat10"><span class="shortCutSignBox">G</span> + <span class="shortCutSignBox">B</span> : Global My Bookmarks</li>\n                    <li class="msgListItem -noBefore gFs16 gMat10"><span class="shortCutSignBox">G</span> + <span class="shortCutSignBox">N</span> : Show News</li>\n                    <li class="msgListItem -noBefore gFs16 gMat10"><span class="shortCutSignBox">G</span> + <span class="shortCutSignBox">C</span> : Show Chat Rooms</li>\n                    <li class="msgListItem -noBefore gFs16 gMat10"><span class="shortCutSignBox">G</span> + <span class="shortCutSignBox">H</span> : Band Home</li>\n                    <li class="msgListItem -noBefore gFs16 gMat10"><span class="shortCutSignBox">G</span> + <span class="shortCutSignBox">1</span> ~ <span class="shortCutSignBox">9</span> : Go nth Menu at Band Home</li>\n                </ul>\n            </div>\n\n            <div class="modalContentTitle gPat5 gPal5 gPar5 gPab10  listLine -tLine">\n                <h2 class="mainTitle">Actions</h2>\n                <ul class="msgList gMat10">\n                    <li class="msgListItem -noBefore gFs16"><span class="shortCutSignBox">?</span> : Show Shortcut Guide Layer</li>\n                    <li class="msgListItem -noBefore gFs16 gMat10"><span class="shortCutSignBox" style="width:48px;"><%= isMac ? \'Cmd\' : \'Ctrl\' %></span> + <span class="shortCutSignBox" style="width:48px;">Enter</span> : Send message</li>\n                    <li class="msgListItem -noBefore gFs16 gMat10"><span class="shortCutSignBox">B</span> : Bookmark Post</li>\n                </ul>\n            </div>\n\n        </div>\n    </div>\n    <div class="modalFooter -tLine" style="padding: 0;">\n        <div class="closeWrap">\n            <button type="button" class="btnLyClose uButton -iconClose _btnClose"><span class="gSrOnly">레이어 팝업 닫기</span></button>\n        </div>\n    </div>\n</div>'}])]);